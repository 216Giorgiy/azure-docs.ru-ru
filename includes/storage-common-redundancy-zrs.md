---
title: включение файла
description: включение файла
services: storage
author: tamram
ms.service: storage
ms.topic: include
ms.date: 07/11/2018
ms.author: tamram
ms.custom: include file
ms.openlocfilehash: 5f7477671e7be4e6e8fd736ab94fa7e7b1e99a6e
ms.sourcegitcommit: 63613e4c7edf1b1875a2974a29ab2a8ce5d90e3b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2018
ms.locfileid: "43184408"
---
Хранилище, избыточное в пределах зоны (ZRS), позволяет синхронно реплицировать данные в трех кластерах хранилища одного региона. Каждый кластер хранилища физически отделен от других и находится в собственной зоне доступности. Каждая зона доступности со входящим в нее кластером ZRS является автономной и содержит отдельные программы и сетевые возможности.

Хранение данных в учетной записи ZRS гарантирует, что у вас будет доступ к ним и вы сможете управлять ими, даже если зона будет недоступна. ZRS обеспечивает превосходную производительность и минимальную задержку. ZRS предлагает те же [целевые показатели масштабируемости](../articles/storage/common/storage-scalability-targets.md), что и [локально избыточное хранилище (LRS)](../articles/storage/common/storage-redundancy-lrs.md).

Используйте ZRS для сценариев, требующих строгой согласованности, надежной устойчивости и высокого уровня доступности, даже если в случае сбоя или стихийного бедствия зональный центр обработки данных будет отключен. ZRS обеспечивает устойчивость объектов хранилища как минимум на уровне 99,9999999999 % (12 девяток) в течение определенного года.

Дополнительные сведения о зонах доступности см. [здесь](https://docs.microsoft.com/azure/availability-zones/az-overview).

## <a name="support-coverage-and-regional-availability"></a>Доступность в регионах и действие поддержки
ZRS в настоящее время поддерживает типы учетных записей [общего назначения версии 2 (GPv2)](../articles/storage/common/storage-account-options.md#general-purpose-v2-accounts) класса Standard. ZRS доступно для блочных BLOB-объектов, бездисковых страничных BLOB-объектов, файлов, таблиц и очередей. А также для всех журналов [Аналитики Службы хранилища](../articles/storage/common/storage-analytics.md) и [метрик хранилища](../articles/storage/common/storage-enable-and-view-metrics.md).

ZRS общедоступно в следующих регионах:

- Восточная часть США
- Восточная часть США 2
- Западная часть США 2
- Центральная часть США
- Северная Европа
- Западная Европа
- Центральная Франция
- Юго-Восточная Азия

Корпорация Майкрософт продолжает запускать ZRS в других регионах Azure. Регулярно проверяйте страницу [обновлений служб Azure](https://azure.microsoft.com/updates/) для получения информации о новых регионах.

## <a name="what-happens-when-a-zone-becomes-unavailable"></a>Что будет, если зона отключена?

Если зона становится недоступной, хранилище данных остается отказоустойчивым. Корпорация Майкрософт предлагает следовать рекомендациям по обработке временных сбоев, таким как реализация политик повтора с экспоненциальной задержкой. Если зона отключена, Azure выполняет обновления сети, например перенаправление DNS. Доступ к данным до завершения процесса обновления может повлиять на ваше приложение.

ZRS не может защитить данные от региональной аварии, где постоянно затрагиваются несколько зон. Вместо этого хранилище ZRS обеспечивает устойчивость для данных, если оно становится временно недоступным. Для защиты от региональных аварий мы советуем использовать геоизбыточное хранилище (GRS). Дополнительные сведения о GRS см. в статье [Геоизбыточное хранилище (GRS). Межрегиональная репликация для службы хранилища Azure](../articles/storage/common/storage-redundancy-grs.md).

## <a name="converting-to-zrs-replication"></a>Преобразование в репликацию ZRS
В настоящее время для изменения типа избыточности учетной записи можно использовать портал Azure или API поставщика ресурсов хранилища, если вы выполняете перенос из LRS, GRS и RA-GRS или в них. Однако с ZRS миграция выполняется не так просто, потому что происходит перемещение физических данных из одной отметки хранилища в несколько меток в пределах региона. 

У вас есть два основных варианта для перемещения данных в хранилище ZRS или из него. Можно вручную скопировать или переместить данные в новую учетную запись ZRS из существующей. Можно также запросить динамическую миграцию. Корпорация Майкрософт настоятельно рекомендует выполнить миграцию вручную, так как нет никакой гарантии относительно времени завершения динамической миграции. Маршрут миграции вручную предоставляет большую гибкость, чем динамическая миграция, и вы контролируете время миграции.

Чтобы выполнить миграцию вручную, у вас есть различные варианты:
- Используйте такие существующие средства, как AzCopy, пакет SDK для службы хранилища, надежные сторонние инструменты и т. д.
- Если вы знакомы с Hadoop или HDInsight, вы можете подключить учетную запись источника и назначения (ZRS) к вашему кластеру и использовать средство, похожее на DistCp, для выполнения массового параллельного процесса копирования данных.
- Создайте собственный инструмент, используя одну версию пакета SDK для службы хранилища.

Однако если миграция вручную приведет к простою приложения и вы не сможете справиться с этим на вашей стороне, мы предоставляем такой вариант, как динамическая миграции. Динамическая миграция — миграция на месте, которая позволяет продолжить использование существующей учетной записи хранения во время переноса данных между отметками исходного и целевого хранилищ. Во время миграции у вас по-прежнему будет тот же уровень устойчивости и заявленная в Соглашении об уровне обслуживания доступность, что и обычно.

Тем не менее динамическая миграция имеет некоторые ограничения. Они перечислены ниже.

- Хотя корпорация Майкрософт незамедлительно отреагирует на запрос динамической миграции, нет никакой гарантии относительно времени его завершения. Если данные должны быть в ZRS к определенному времени, тогда необходимо выполнить миграцию вручную. Как правило, чем больше данных в вашей учетной записи, тем дольше будет выполняться их перенос. 
- Динамическую миграцию можно выполнять только из учетной записи, использующей репликацию LRS или GRS. Если учетная запись использует RA-GRS, то прежде чем продолжить, необходимо сначала перейти на один из этих типов репликации. Этот промежуточный шаг гарантирует, что вторичная конечная точка с доступом на чтение, предоставляемая RA-GRS, будет удалена перед миграцией.
- Учетная запись должна содержать данные.
- Поддерживаются только миграции внутри региона. Если вы хотите перенести данные в учетную запись ZRS, которая находится в регионе, отличном от учетной записи источника, тогда нужно выполнить миграцию вручную.
- Поддерживаются только типы учетных записей хранилища класса Standard. Невозможно перенести учетную запись хранения класса Premium.

Запросы динамической миграции поступают через портал поддержки Azure. На портале выберите учетную запись хранения, которую вы хотите преобразовать в ZRS.
1. Щелкните **Новый запрос на поддержку**.
2. Проверьте основные сведения. Щелкните **Далее**. 
3. В разделе **Проблема**: 
    - Оставьте уровень серьезности как есть.
    - Укажите тип проблемы **Миграция данных**.
    - Укажите категорию **Миграция в ZRS в пределах региона**.
    - Введите заголовок **Миграция учетной записи ZRS** (или что-то описательное).
    - В поле сведений укажите "Хочу перенести данные в ZRS из [LRS, GRS] в регионе ______". 
4. Щелкните **Далее**.
5. Проверьте правильность контактных данных в колонке "Контактные сведения".
6. Нажмите кнопку **Submit**(Отправить).

С вами свяжется специалист службы поддержки. Он окажет любую помощь, которая вам потребуется. 

## <a name="zrs-classic-a-legacy-option-for-block-blobs-redundancy"></a>Классическое хранилище ZRS. Устаревший вариант для обеспечения избыточности блочных BLOB-объектов.
> [!NOTE]
> Поддержка классических учетных записей ZRS планируется до 31 марта 2021 г., после чего необходимо будет выполнить перенос. Перед прекращением поддержки корпорация Майкрософт отправит дополнительные сведения клиентам классического хранилища ZRS. Корпорация Майкрософт планирует в будущем обеспечить автоматический процесс перемещения с классической учетной записи ZRS на обычную.

>[!NOTE]
> После того как хранилище ZRS станет [общедоступным](#support-coverage-and-regional-availability) в регионе, вы больше не сможете создавать классическую учетную запись ZRS на портале в этом же регионе. Однако ее можно создать другими способами, например с помощью Microsoft PowerShell и Azure CLI, пока классическое хранилище ZRS не станет нерекомендуемым.

В классическом хранилище ZRS данные асинхронно реплицируются в центрах обработки данных в пределах одного или двух регионов. Реплика будет недоступна, если корпорация Майкрософт не инициирует отработку отказа в дополнительном регионе. Классическое хранилище ZRS доступно только для **блочных BLOB-объектов** в учетных записях хранения [общего назначения версии 1 (GPv1)](../articles/storage/common/storage-account-options.md#general-purpose-v1-accounts). Классическую учетную запись ZRS невозможно преобразовать в учетную запись хранилища LRS или GRS и наоборот. Кроме того, она не поддерживает использование метрик или ведение журналов.

Классическую учетную запись ZRS невозможно преобразовать в учетную запись хранилища LRS, GRS или RA-GRS и наоборот. Кроме того, она не поддерживает использование метрик или ведение журналов.

Чтобы вручную перенести данные учетной записи ZRS в или из учетной записи LRS, классического хранилища ZRS, GRS или RA-GRS, используйте AzCopy, Обозреватель службы хранилища Azure, Azure PowerShell или Azure CLI. Можно также создавать собственные решения для миграции с использованием одной из клиентских библиотек службы хранилища Azure.
