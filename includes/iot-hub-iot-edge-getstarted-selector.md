> [!div class="op_single_selector"]
> * [Linux](../articles/iot-hub/iot-hub-linux-iot-edge-get-started.md)
> * [Windows](../articles/iot-hub/iot-hub-windows-iot-edge-get-started.md)
> 
> 

В этой статье содержится пошаговое руководство по [примеру кода Hello World][lnk-helloworld-sample] и демонстрируются основные компоненты архитектуры [Edge Интернета вещей Azure][lnk-iot-edge]. В примере Edge Интернета вещей Azure используется для сборки простого шлюза, который каждые пять секунд записывает в файл сообщение Hello World.

В этом руководстве рассматриваются следующие темы.

* **Основные понятия.** Общие сведения о компонентах любого шлюза, созданного с использованием Edge Интернета вещей.
* **Архитектура примера hello World**: описывает, каким образом основные понятия относятся к примеру Hello World и как компоненты работают вместе.
* **Сборка примера**: шаги, необходимые для сборки образца.
* **Запуск примера**: шаги, необходимые для запуска образца. 
* **Типовые выходные данные**: пример выходных данных, ожидаемых при выполнении примера.
* **Фрагменты кода.** Коллекция фрагментов кода, показывающая, каким образом пример Hello World реализует основные компоненты шлюза Edge Интернета вещей.

## <a name="azure-iot-edge-concepts"></a>Основные понятия Edge Интернета вещей Azure
Прежде чем изучать пример кода или создавать собственные поля шлюза с использованием Edge Интернета вещей, необходимо изучить основные понятия, которые лежат в основе архитектуры Edge Интернета вещей.

### <a name="iot-edge-modules"></a>Модули Edge Интернета вещей
Шлюз собирается с использованием Edge Интернета вещей Azure путем создания и сборки *модулей Edge Интернета вещей*. Модули обмениваются данным с помощью *сообщений* . Модуль получает сообщение, выполняет с ним определенное действие, при необходимости преобразует их в новое сообщение и публикует его для других модулей. Некоторые модули могут только создавать сообщения и никогда не обрабатывают входящие сообщения. Цепочка модулей создает конвейер обработки данных с каждым модулем, который выполняет преобразование данных в определенной точке этого конвейера.

![Цепочка модулей в шлюзе, созданном с помощью Edge Интернета вещей Azure][1]

Edge Интернета вещей содержит следующее:

* Предварительно написанные модули, которые выполняют общие функции шлюза.
* Интерфейсы, которые разработчик может использовать для написания пользовательских модулей.
* Инфраструктура, необходимая для развертывания и запуска набора модулей.

Пакет SDK включает слой абстракции, который позволяет собирать шлюзы для запуска в различных операционных системах и на разных платформах.

![Уровень абстракции Edge Интернета вещей Azure][2]

### <a name="messages"></a>Сообщения
Функционирование шлюза удобно представлять как передачу сообщений между модулями, однако, это не совсем так. Модули Edge Интернета вещей используют брокер для связи друг с другом: они публикуют сообщения в брокер (шина, Pub/Sub или другая схема обмена сообщениями), после чего брокер направляет сообщения в модули, подключенные к нему.

Чтобы опубликовать сообщение в брокер, модуль использует функцию **Broker_Publish**. Брокер доставляет сообщения в модуль, вызывая функцию обратного вызова. Сообщение состоит из набора пар ключ-значение, а содержимое передается как блок памяти.

![Роль брокера в Edge Интернета вещей Azure][3]

### <a name="message-routing-and-filtering"></a>Маршрутизация и фильтрация сообщений
Сообщения направляются в нужные модули Edge Интернета вещей двумя способами. В брокер может передаваться набор ссылок, в котором для брокера указывается источник и приемник для каждого модуля, либо модуль может выполнять фильтрацию по свойствам сообщения. Модуль обрабатывает сообщение, только если оно предназначено для него. Ссылки и фильтрация сообщений позволяют создать эффективный конвейер сообщений.

## <a name="hello-world-sample-architecture"></a>Архитектура примера hello World
Пример Hello World иллюстрирует основные понятия, описанные в предыдущем разделе. Пример Hello World реализует шлюз Edge Интернета вещей с конвейером, который состоит из двух модулей Edge Интернета вещей.

* Модуль *Hello World* создает сообщение каждые пять секунд и передает его в модуль ведения журнала.
* Модуль *ведения журнала* записывает полученные сообщения в файл.

![Архитектура примера приложения Hello World, созданного с помощью Edge Интернета вещей Azure][4]

Как описано в предыдущем разделе, модуль Hello World не передает сообщения непосредственно в модуль ведения журнала каждые пять секунд. Вместо этого он каждые пять секунд публикует сообщение в брокер.

Модуль ведения журнала получает сообщение из брокера и обрабатывают его, записывая содержимое сообщения в файл.

Модуль ведения журнала только обрабатывает сообщения из брокера и никогда не публикует сообщения в брокер.

![Брокер направляет сообщения между модулями в пакете Edge Интернета вещей Azure][5]

На представленной выше схеме показана архитектура примера Hello World и относительные пути к исходными файлам, которые реализуют различные части примера в [репозитории][lnk-iot-edge]. Изучите код самостоятельно или воспользуйтесь приведенными ниже фрагментами кода для справки.

<!-- Images -->
[1]: media/iot-hub-iot-edge-getstarted-selector/modules.png
[2]: media/iot-hub-iot-edge-getstarted-selector/modules_2.png
[3]: media/iot-hub-iot-edge-getstarted-selector/messages_1.png
[4]: media/iot-hub-iot-edge-getstarted-selector/high_level_architecture.png
[5]: media/iot-hub-iot-edge-getstarted-selector/detailed_architecture.png

<!-- Links -->
[lnk-helloworld-sample]: https://github.com/Azure/iot-edge/tree/master/samples/hello_world
[lnk-iot-edge]: https://github.com/Azure/iot-edge