# Использование CDN для Azure

Сеть доставки содержимого (CDN) Azure предоставляет разработчикам
глобальное решение для доставки содержимого, передаваемого по каналам с высокой пропускной способностью, путем кэширования BLOB-объектов
и статистического содержимого вычислительных операций на физических узлах в США,
Европе, Азии, Австралии и Южной Америке. Актуальный список
расположений узлов сети CDN см. в статье [Расположение узлов Azure CDN].

Эта задача включает следующие шаги:

* [Шаг 1. Создание учетной записи хранения](#Step1)
* [Шаг 2. Создание новой конечной точки CDN для учетной записи хранения](#Step2)
* [Шаг 3. Получение доступа к содержимому CDN](#Step3)
* [Шаг 4. Удаление содержимого CDN](#Step4)

Использование сети CDN для кэширования данных Azure приносит следующие преимущества.

-   Повышенная производительность и лучшие впечатления от использования для конечных пользователей, которые находятся далеко от источника содержимого и используют приложения, в которых для загрузки содержимого требуется множество  'internet trips'.
-   Крупномасштабное распределение для улучшения мгновенной обработки высокой нагрузки, например, в начале события, такого как запуск продукта.

Существующие клиенты сети CDN теперь могут использовать сеть Azure CDN на [портале управления Azure]. CDN является функцией расширения для подписки и имеет отдельный [план выставления счетов]

<a id="Step1"> </a>
<h2>Шаг 1. Создание учетной записи хранения</h2>

Ниже приведена процедура создания новой учетной записи хранения
для подписки Azure. Учетная запись хранения предоставляет доступ к 
службам хранилища Azure. Учетная запись хранения представляет собой наивысший уровень
пространства имен для доступа к каждому компоненту службы хранилища
Azure: службам BLOB-объектов, службам очередей и службам таблиц. Дополнительную
информацию о службе хранилища Azure см. в разделе [Службы
хранилища Azure](http://msdn.microsoft.com/library/azure/gg433040.aspx).

Чтобы создать учетную запись хранения, необходимо быть администратором
службы или соадминистратором связанной подписки.

> [AZURE.NOTE] Сведения о выполнении этой операции с помощью
API управления службами Azure см. в справочной статье [Создание учетной записи хранения](http://msdn.microsoft.com/library/windowsazure/hh264518.aspx).

**Создание учетной записи хранения для подписки Azure**

1.  Войдите на [портал управления Azure].
2.  В нижнем левом углу щелкните **Создать**. В диалоговом окне **Создать** выберите **Службы данных**, затем щелкните **Хранилище** и **Быстрое создание**.

    Откроется диалоговое окно **Создание учетной записи хранения**.

    ![Create Storage Account][create-new-storage-account]

4. В поле **URL-адрес** введите имя поддомена. Запись может содержать от 3 до 24 строчных букв и цифр.

    Это значение становится именем узла в универсальном коде ресурса (URI), который используется для
    адресации ресурсов BLOB-объектов, очередей или таблиц для подписки. Чтобы
    адресовать ресурс-контейнер службе BLOB-объектов, необходимо использовать
    универсальный код ресурса в следующем формате, где *&lt;StorageAccountLabel&gt;* ссылается
    на значение, введенное на этапе **ввода URL-адреса**:

    http://*&lt;StorageAcountLabel&gt;*.blob.core.windows.net/*&lt;mycontainer&gt;*

    **Важно!** Метка URL-адреса формирует поддомен для URI учетной записи хранения
    и должна иметь уникальное значение среди всех размещенных служб в 
    Azure.

	Это значение также используется как имя этой учетной записи хранения на портале или при доступе к данной учетной записи программным способом.

5.  В раскрывающемся списке **Регион или территориальная группа** выберите регион или территориальную группу для учетной записи хранения. Выберите территориальную группу вместо региона, если необходимо размещение служб хранилища в одном центре обработки данных с другими используемыми службами Microsoft Azure. Это может повысить производительность без дополнительных затрат на передачу данных.  

    **Примечание.** Чтобы создать территориальную группу, откройте на портале управления раздел **Параметры**, перейдите на страницу **Территориальные группы** и затем щелкните либо **Добавить территориальную группу**, либо **Добавить**. Можно также создавать территориальные группы и управлять ими с помощью API управления службами Microsoft Azure. Дополнительные сведения см. в разделе [Операции с территориальными группами].

6. В раскрывающемся списке **Подписка** выберите подписку, с которой будет использоваться данная учетная запись хранения.
7.  Щелкните **Создать учетную запись хранения**. Процесс создания учетной записи хранения может занять несколько минут.
8.  Чтобы удостовериться, что учетная запись хранения создана успешно, убедитесь, что эта учетная запись отображается в элементах списка **Хранилище** со статусом **В сети**.

<a id="Step2"> </a>
<h2>Шаг 2. Создание новой конечной точки CDN для учетной записи хранения</h2>

После включения доступа сети CDN к учетной записи хранилища или размещенной службе все
общедоступные объекты становятся доступными для пограничного кэширования CDN. Если вы
измените объект, который в данный момент кэширован в сети CDN, новое содержимое
не будет доступно через сеть CDN, пока не произойдет обновление ее содержимого
после истечения срока действия кэшированного объекта.

**Создание новой конечной точки CDN для учетной записи хранения**

1. На [портале управления Azure] в области навигации выберите **CDN**.

2. На ленте щелкните **Создать** В диалоговом окне **Создать** выберите **Служба приложений**, затем **CDN**, затем **Быстрое создание**.

3. В раскрывающемся списке **Исходный домен** выберите учетную запись хранения, созданную в предыдущем разделе, в списке доступных учетных записей хранения. 

4. Нажмите кнопку **Создать**, чтобы создать новую конечную точку.

5. После создания конечной точки, она отображается в списке конечных точек для этой подписки. В режиме списка отображается URL-адрес для доступа к кэшированному содержимому, а также исходному домену. 

	Исходный домен представляет собой расположение, содержимое из которого кэшируется в
    CDN. Исходный домен может быть учетной записью хранения или облачной службой; для целей этого примера используется учетная запись хранения. Содержимое хранилища кэшируется на пограничных серверах в соответствии с указанным параметром управления кэшем или эвристикой по умолчанию для сети кэширования. Дополнительные сведения см. в статье [Управление сроком годности содержимого BLOB в сети доставки контента (CDN) Azure](http://msdn.microsoft.com/library/gg680306.aspx). 


    > [AZURE.NOTE] Конфигурация, созданная для конечной точки,
    недоступна незамедлительно. Может потребоваться до 60 минут
    для распространения регистрации по сети CDN. Если пользователь попытается
    незамедлительно воспользоваться именем домена CDN, он может столкнуться с кодом состояния 400
    (неверный запрос), пока содержимое не станет доступно через CDN.

<a id="Step3"> </a>
<h2>Шаг 3. Получение доступа к содержимому CDN</h2> 

Для доступа к кэшированному содержимому в сети CDN воспользуйтесь URL-адресом CDN, отображаемым в портале. Адрес для кэшированного BLOB-объекта будет иметь следующий вид:

http://<*CDNNamespace*>.vo.msecnd.net/<*myPublicContainer*>/<*BlobName*>

<a id="Step4"> </a>
<h2>Шаг 4. Удаление содержимого из сети CDN</h2>

Если вы хотите приостановить кэширование объекта в сети
доставки содержимого (CDN) Azure, выполните один из следующих шагов:

-   BLOB-объект Azure можно удалить из общедоступного
    контейнера.
-   Можно сделать контейнер закрытым, а не общедоступным. Дополнительные сведения см. в статье [Ограничение доступа к контейнерам и большим двоичным объектам](http://msdn.microsoft.com/library/dd179354.aspx).
-   Вы можете отключить или удалить конечную точку CDN на портале
    управления.
-   Вы можете изменить размещенную службу, чтобы она перестала отвечать на запросы
    объекта.

Объект, который уже кэширован в сети CDN, останется в кэше до
истечения срока действия этого объекта. Когда срок действия
истекает, сеть CDN выполняет проверку действительности конечной точки CDN
и анонимной доступности объекта. Если это не так,
объект больше не будет кэшироваться.

В настоящее время возможность немедленной очистки содержимого на портале управления Azure не поддерживается. Для немедленной очистки содержимого обратитесь в [службу поддержки Azure](http://azure.microsoft.com/support/options/). 

## Дополнительные ресурсы

-   [Создание территориальной группы в Azure]
-   [Практическое руководство по управлению учетными записями хранения для подписки Azure]
-   [Об API управления службами]
-   [Сопоставление содержимого CDN с личным доменом]

  [Создание учетной записи хранения]: http://msdn.microsoft.com/library/windowsazure/hh264518.aspx
  [Расположение узлов сети CDN для Azure]: http://msdn.microsoft.com/library/windowsazure/gg680302.aspx
  [Портал управления Azure]: https://manage.windowsazure.com/
  [Тарифный план]: /pricing/calculator/?scenario=full
  [Регистрация имени пользовательского поддомена для доступа к BLOB-объектам в Azure]: http://msdn.microsoft.com/library/windowsazure/ee795179.aspx
  [Создание территориальной группы в Azure]: http://msdn.microsoft.com/library/azure/ee460798.aspx
  [Общие сведения о Azure CDN]: http://msdn.microsoft.com/library/windowsazure/ff919703.aspx
  [Практическое руководство по по управлению учетными записями хранения для подписки Azure]: http://msdn.microsoft.com/library/windowsazure/hh531567.aspx
  [Об API управления службами]: http://msdn.microsoft.com/library/windowsazure/ee460807.aspx
  [Сопоставление содержимого CDN с личным доменом]: http://msdn.microsoft.com/library/windowsazure/gg680307.aspx


[create-new-storage-account]: ./media/cdn/CDN_CreateNewStorageAcct.png
[Предыдущая версия портала управления]: ../../Shared/Media/previous-portal.png

<!--HONumber=49-->