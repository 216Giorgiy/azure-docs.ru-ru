# Использование CDN для Azure

Сеть доставки содержимого (CDN) Azure предоставляет разработчикам глобальное решение для доставки большого объема содержимого с возможностью кэширования больших двоичных объектов и статического содержимого на физических узлах в США, Европе, Азии, Австралии и Южной Америке. Для получения текущего списка расположений узлов CDN см. [Расположение узлов сети CDN для Azure].

Эта задача включает следующие шаги:

* [Шаг 1. Создание учетной записи хранения](#Step1)
* [Шаг 2. Создание новой конечной точки CDN для вашей учетной записи хранения](#Step2)
* [Шаг 3. Получение доступа к содержимому CDN](#Step3)
* [Шаг 4. Удаление содержимого CDN](#Step4)

Использование сети CDN для кэширования данных Azure приносит следующие преимущества.

-   Повышенная производительность и впечатления от использования для конечных пользователей, которые находятся далеко от источника содержимого и работают с приложениями, в которых для загрузки содержимого требуется множество обращений в Интернет.
-   Крупномасштабное распределение для улучшения мгновенной обработки высокой нагрузки, например, в начале события, такого как запуск продукта.

Существующие клиенты сети CDN теперь могут использовать сеть Azure CDN на [портале управления Azure]. CDN является функцией расширения для подписки и имеет отдельный [план выставления счетов].

<a id="Step1"> </a>
<h2>Шаг 1. Создание учетной записи хранения</h2>

Чтобы создать новую учетную запись хранения для подписки Azure, воспользуйтесь следующей процедурой. Учетная запись хранения предоставляет доступ к службам хранилища Azure. Учетная запись хранения представляет собой самый высокий уровень пространства имен для доступа ко всем компонентам служб хранилища Azure: службам BLOB-объектов, службам очередей и службам таблиц. Дополнительную информацию о службах хранилища Azure см. в разделе [Использование служб хранилища Azure](http://msdn.microsoft.com/ru-ru/library/azure/gg433040.aspx).

Чтобы создать учетную запись хранения, вы должны быть администратором службы или соадминистратором для связанной подписки.

<div class="dev-callout">
<strong>Примечание.</strong>
<p>Информацию о выполнении этой операции с помощью API управления службами Azure см. в справочном разделе <a href="http://msdn.microsoft.com/ru-ru/library/windowsazure/hh264518.aspx">Создание учетной записи хранения</a> .</p>
</div>

**Вот как можно создать учетную запись хранения для подписки Azure.**

1.  Войдите на [портал управления Azure].
2.  В нижнем левом углу щелкните**Создать**. В диалоговом окне **Создать** выберите **Службы данных**, затем щелкните **Хранилище** и **Быстрое создание**.

    Откроется диалоговое окно **Создание учетной записи хранения**.

    ![Create Storage Account][create-new-storage-account]

4. В поле **URL-адрес** введите имя поддомена. Запись может содержать от 3 до 24 строчных букв и цифр.

    Это значение станет именем узла в универсальном коде ресурса (URI), который используется для обращения к ресурсам больших двоичных объектов, очередей и таблиц для подписки. Чтобы обратиться по адресу ресурса контейнера в службе BLOB-объектов, следует использовать URI в следующем формате, где &lt;StorageAccountLabel&gt;* указывает значение, которое вы ввели в поле**Введите URL-адрес**:

    http://*<StorageAcountLabel>*.blob.core.windows.net/*<mycontainer>*

    **Важно!** Метка URL-адреса образует поддомен URI учетной записи хранения и должна быть уникальной на уровне всех размещенных служб в Azure.

	Это значение также используется как имя этой учетной записи хранения на портале или при доступе к данной учетной записи программным способом.

5.  В раскрывающемся списке **Регион или территориальная группа** выберите регион или территориальную группу для этой учетной записи хранения. Выберите территориальную группу вместо региона, если необходимо размещение служб хранилища в одном центре обработки данных с другими используемыми службами Microsoft Azure. Это может повысить производительность без дополнительных затрат на передачу данных.  

    **Примечание.** Чтобы создать территориальную группу, откройте раздел **Параметры** на портале управления, перейдите на страницу **Территориальные группы** и затем щелкните либо **Добавить территориальную группу**, либо **Добавить**. Можно также создавать территориальные группы и управлять ими с помощью API управления службами Microsoft Azure. Дополнительную информацию см. в разделе [Операции с территориальными группами].

6. В раскрывающемся списке **Подписка** выберите подписку, с которой будет использоваться данная учетная запись хранения.
7.  Щелкните **Создать учетную запись хранения**. Процесс создания учетной записи хранения может занять несколько минут.
8.  Чтобы удостовериться, что учетная запись хранения создана успешно, убедитесь, что эта учетная запись отображается в элементах списка **Хранилище** со статусом **В сети**.

<a id="Step2"> </a>
<h2>Шаг 2. Создание новой конечной точки CDN для вашей учетной записи хранения</h2>

После включения CDN-доступа к учетной записи хранения или размещенной службе все общедоступные объекты будут пригодны для пограничного кэширования CDN. Если изменить объект, находящийся в данный момент в кэше сети CDN, новое содержимое будет недоступно через сеть CDN до обновления содержимого CDN по истечении срока действия кэшированного содержимого.

**Чтобы создать новую конечную точку CDN для вашей учетной записи хранения выполните следующие действия.**

1. На [портале управления Azure] в области навигации выберите **CDN**.

2. На ленте щелкните **Создать**. В диалоговом окне **Создать** выберите **Служба приложений**, затем **CDN**, затем **Быстрое создание**.

3. В раскрывающемся списке **Исходный домен** выберите учетную запись хранения, созданную в предыдущем разделе, из списка доступных учетных записей хранения. 

4. Нажмите кнопку **Создать**, чтобы создать новую конечную точку.

5. После создания конечной точки, она отображается в списке конечных точек для этой подписки. В режиме списка отображается URL-адрес для доступа к кэшированному содержимому, а также исходному домену. 

	Исходный домен представляет собой расположение, содержимое из которого кэшируется в CDN. Исходный домен может быть учетной записью хранения или облачной службой; для целей этого примера используется учетная запись хранения. Содержимое хранилища кэшируется на пограничных серверах в соответствии с указанным параметром управления кэшем или эвристикой по умолчанию для сети кэширования. Дополнительную информацию см. в разделе [Управление сроком действия содержимого большого двоичного объекта](http://msdn.microsoft.com/ru-ru/library/gg680306.aspx) . 


    <div class="dev-callout">
    <strong>Note</strong>
    <p>The configuration created for the endpoint will not
    immediately be available; it can take up to 60 minutes for the
    registration to propagate through the CDN network. Users who try to
    use the CDN domain name immediately may receive status code 400
    (Bad Request) until the content is available via the CDN.</p>
    </div>

<a id="Step3"> </a>
<h2>Шаг 3. Получение доступа к содержимому CDN</h2> 

Для доступа к кэшированному содержимому в сети CDN воспользуйтесь URL-адресом CDN, отображаемым в портале. Адрес для кэшированного BLOB-объекта будет иметь следующий вид:

http://<*CDNNamespace*\>.vo.msecnd.net/<*myPublicContainer*\>/<*BlobName*\>

<a id="Step4"> </a>
<h2>Шаг 4. Удаление содержимого из сети CDN</h2>

Если вы хотите приостановить кэширование объекта в сети
доставки содержимого (CDN) Azure, выполните один из следующих шагов:

-   Для большого двоичного объекта Azure вы можете удалить этот объект из общедоступного контейнера. -   Можно сделать контейнер закрытым, а не общедоступным. Дополнительную информацию см. в разделе [Ограничение доступа к контейнерам и большим двоичным объектам](http://msdn.microsoft.com/ru-ru/library/dd179354.aspx) .
-   Вы можете отключить или удалить конечную точку CDN на портале управления.
-   Вы можете изменить размещенную службу, чтобы она перестала отвечать на запросы объекта.

Объект, уже кэшированный в сети CDN, останется в кэше до истечения срока действия этого объекта. По истечении срока действия CDN выполнит проверку конечной точки CDN, чтобы выяснить, что она еще действует и объект по-прежнему находится в анонимном доступе. Если это не так, объект больше не будет кэшироваться.

В настоящее время возможность немедленной очистки содержимого на портале управления Azure не поддерживается. Обратитесь в [службу поддержки Azure](http://azure.microsoft.com/ru-ru/support/options/)  , если вам необходимо немедленно очистить содержимое. 

## Дополнительные ресурсы

-   [Как создать территориальную группу в Azure]
-   [Практическое руководство. Управление учетными записями хранения для подписки Azure]
-   [Об API управления службами]
-   [Как сопоставить содержимое CDN с пользовательским доменом]

  [Создание учетной записи хранения]: http://msdn.microsoft.com/ru-ru/library/windowsazure/hh264518.aspx
  [Расположение узлов сети CDN для Azure]: http://msdn.microsoft.com/ru-ru/library/windowsazure/gg680302.aspx
  [Портал управления Azure]: https://manage.windowsazure.com/
  [план выставления счетов]: /ru-ru/pricing/calculator/?scenario=full
  [Как зарегистрировать имя пользовательского поддомена для доступа к большим двоичным объектам в Azure]: http://msdn.microsoft.com/ru-ru/library/windowsazure/ee795179.aspx
  [Как создать территориальную группу в Azure]: http://msdn.microsoft.com/library/azure/ee460798.aspx
  [Обзор Azure CDN]: http://msdn.microsoft.com/ru-ru/library/windowsazure/ff919703.aspx
  [Практическое руководство. Управление учетными записями хранения для подписки Azure]: http://msdn.microsoft.com/ru-ru/library/windowsazure/hh531567.aspx
  [Об API управления службами]: http://msdn.microsoft.com/ru-ru/library/windowsazure/ee460807.aspx
  [Как сопоставить содержимое CDN с пользовательским доменом]: http://msdn.microsoft.com/ru-ru/library/windowsazure/gg680307.aspx


[create-new-storage-account]: ./media/cdn/CDN_CreateNewStorageAcct.png
[Предыдущая версия портала управления]: ../../Shared/Media/previous-portal.png

<!--HONumber=35_1-->
