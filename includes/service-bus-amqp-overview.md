# Поддержка AMQP 1.0 в служебной шине


Облачная служба Azure Service Bus для Windows Server (Service Bus 1.1) поддерживает протокол AMQP 1.0 (улучшенный протокол очередей сообщений). AMQP позволяет создавать кроссплатформенные гибридные приложения, использующие протокол открытого стандарта. Можно создавать приложения, использующие компоненты, разработанные на разных языках и различных платформах и выполняемые в других операционных системах. Все эти компоненты могут подключаться к шине Service Bus и легко, эффективно и достоверно обмениваться структурированными бизнес-сообщениями.

## Введение. Что такое AMQP 1.0 и почему этот протокол так важен?

Обычно ориентированное на сообщения межплатформенное программное обеспечение использует собственные протоколы для обмена данными между клиентскими приложениями и брокерами. Это означает, что после выбора брокера сообщений конкретного поставщика для подключения клиентских приложениях к этому брокеру необходимо использовать библиотеки этого поставщика. Это приводит к определенной "привязке" к этому поставщику, так как перенос приложения в другой продукт потребует изменения кода всех подключенных приложений. 

Кроме того, подключение брокеров сообщений от различных поставщиков достаточно сложно реализовать. Обычно для этого требуется создание мостов на уровне приложений, чтобы перемещать сообщения из одной системы в другую, а также чтобы выполнять преобразование между собственными форматами сообщений этих брокеров. Это является общим требованием, например, при обеспечении нового унифицированного интерфейса для старых разрозненных систем или при интеграции ИТ-систем после слияния.

Индустрия программного обеспечения - это быстро меняющаяся отрасль, новые языки программирования и платформы приложений иногда появляются с ошеломляющей скоростью. Аналогично, со временем меняются требования ИТ-систем, и разработчики хотят пользоваться преимуществами новейших платформ. Но иногда выбранный поставщик системы обмена сообщениями не поддерживает эти платформы. Так как протоколы передачи сообщений являются закрытыми, невозможно предоставить библиотеки для этих новых платформ. Таким образом, чтобы продолжить использование продукта обмена сообщениями, необходимо применять такие подходы, как создание шлюзов или мостов.

Разработка протокола AMQP 1.0 (улучшенный протокол очередей сообщений) была вызвана именно этими проблемами. Первоначально он был разработан в компании JP Morgan, которая, как и большинство финансовых компаний, чрезвычайно активно использует ориентированное на сообщения межплатформенное программное обеспечение. Цель была проста - создать протокол обмена сообщениями на основе открытых стандартов, позволяющий создавать приложения на основе сообщений, используя компоненты, разработанные на разных языках программирования, на разных платформах и в различных операционных системах - лучшие компоненты от множества поставщиков.

## Технические характеристики AMQP 1.0

AMQP 1.0 - это эффективный и надежный протокол обмена сообщениями на уровне соединения, который можно использовать для создания надежных кроссплатформенных приложений для обмена сообщениями. Цель этого протокола проста - определить механизм безопасной, надежной и эффективной передачи сообщений между двумя сторонами. Сами сообщения кодируются, используя переносимое представление данных, позволяющее разнородным отправителям и получателям с полной достоверностью обмениваться структурированными бизнес-сообщениями. Ниже приведен перечень наиболее важных показателей.

*    **Эффективный**. AMQP 1.0 является протоколом с установлением соединения, который использует двоичное кодирование инструкций протокола и передаваемых с его помощью деловых сообщений. Для максимального использования сети и соединенных компонентов он поддерживает сложные схемы управления потоком. С другой стороны, этот протокол был разработан для обеспечения равновесия между эффективностью, гибкостью и возможностями взаимодействия.
*    **Надежный**. Протокол AMQP 1.0 позволяет обмениваться сообщениями с различными уровнями гарантии надежности, от "отправил и забыл" до надежной доставки с однократным подтверждением.
*    **Гибкий**. AMQP 1.0 является гибким протоколом, который можно использовать для поддержки различных топологий. Один и тот же протокол можно использовать для взаимодействия клиент-клиент, клиент-брокер и брокер-брокер.
*    **Независимый от модели брокера**. Спецификация 1.0 AMQP не предъявляет никаких требований к модели обмена сообщениями, используемой брокером. Это означает, что можно легко добавить поддержку AMQP 1.0 для существующих брокеров сообщений.

## AMQP 1.0 - это Стандарт (с заглавной буквы С)

AMQP 1.0 разрабатывался с 2008 г. активной группой, включающей свыше 20 компаний, среди которых были как поставщики технологий, так и конечные пользователи. В течение этого времени пользовательские компании внесли свой вклад, определив требования, предъявляемые реальным бизнесом, а поставщики технологий довели протокол до соответствия этим требованиям. На протяжении всего процесса поставщики участвовали в семинарах, сотрудничая для проверки возможности взаимодействия между разработанными реализациями.

В октябре 2011 г. функции разработки перешли к техническому комитету Организации продвижения структурированных информационных стандартов (Organization for the Advancement of Structured Information Standards, OASIS). В результате в октябре 2012 г. был выпущен Стандарт AMQP 1.0 OASIS. В разработке стандарта техническим комитетом принимали участие следующие компании:

*    **Поставщики технологий**: Axway Software, Huawei Technologies, IIT Software, INETCO Systems, Kaazing, Microsoft, Mitre Corporation, Primeton Technologies, Progress Software, Red Hat, SITA, Software AG, Solace Systems, VMware, WSO2, Zenika.
*    **Пользовательские компании**: Bank of America, Credit Suisse, Deutsche Boerse, Goldman Sachs, JPMorgan Chase.

Ниже приведены некоторые из часто упоминаемых преимуществ открытых стандартов:

*    Уменьшение вероятности привязки к поставщику
*    Возможность взаимодействия
*    Широкая доступность библиотек и инструментария
*    Защита от устаревания
*    Доступность опытного персонала
*    Снижение риска и возможность управления им

## Протокол AMQP 1.0 и служебная шина

Добавление AMQP 1.0 для поддержки Service Bus означает, что теперь с помощью эффективного двоичного протокола можно на различных платформах использовать возможности очередей и обмена сообщениями с публикацией/подпиской у брокера. Кроме того, можно создавать приложения, содержащие компоненты, созданные с использованием разнообразных языков, платформ и операционных систем.

На следующей схеме показан пример развертывания, в котором Java-клиенты, работающие в среде Linux и написанные с использованием стандартного API JMS (Java Message Service), и клиенты .NET, работающие под управлением Windows, обмениваются сообщениями по шине Service Bus с помощью AMQP 1.0.

![][0]

**Рисунок 1. Пример сценария развертывания с демонстрацией межплатформенного обмена сообщениями с использованием служебной шины и протокола AMQP 1.0**

В настоящее время для работы с шиной Service Bus доступны следующие клиентские библиотеки:

<table>
  <tr>
    <th>Язык</th>
    <th>Библиотека</th>
  </tr>
  <tr>
    <td>Java</td>
    <td>Клиент Apache Qpid Java Message Service (JMS)<br/>
        Java-клиент IIT Software SwiftMQ</td>
  </tr>
  <tr>
    <td>C</td>
    <td>Apache Qpid Proton-C</td>
  </tr>
  <tr>
    <td>PHP</td>
    <td>Apache Qpid Proton-PHP</td>
  </tr>
  <tr>
    <td>Python</td>
    <td>Apache Qpid Proton-Python</td>
  </tr>

</table>


**Рисунок 2. Таблица клиентских библиотек AMQP 1.0**

Дополнительную информацию о получении и использовании этих библиотек с шиной Service Bus см. в [руководстве разработчика AMQP для Service Bus][]. Для получения дополнительной информации см. ниже раздел "Ссылки".

## Сводка

*    AMQP 1.0 - это открытый и надежный протокол обмена сообщениями, который можно использовать для создания кроссплатформенных гибридных приложений. AMQP 1.0 является стандартом OASIS.
*    Теперь поддержка AMQP 1.0 доступна для Azure Service Bus и Windows Server Service Bus (Service Bus 1.1). Цены совпадают с ценами для существующих протоколов.

## Ссылки

*    [Использование протокола AMQP 1.0 с API служебной шины .NET](http://aka.ms/lym3vk)
*    [Использование API JMS со служебной шиной и AMQP 1.0](http://aka.ms/ll1fm3)
*    [Руководство разработчика AMQP для Service Bus](http://msdn.microsoft.com/library/jj841071.aspx)
*    [Спецификация протокола OASIS AMQP, версия 1.0](http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-complete-v1.0-os.pdf)

[0]: ./media/service-bus-amqp-overview/Example1.png
[руководстве разработчика AMQP для Service Bus]: http://msdn.microsoft.com/library/jj841071.aspx

<!--HONumber=47-->
