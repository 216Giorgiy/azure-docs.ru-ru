### Определение TextFormat

Если для свойства format задано значение **TextFormat**, в разделе **Format** вы можете указать следующие **необязательные** свойства.

| Свойство | Описание | Обязательно |
| -------- | ----------- | -------- |
| columnDelimiter | Символ, используемый в качестве разделителя столбцов в файле. В настоящее время допускается только один символ. Этот тег является необязательным. Значение по умолчанию — запятая (,). | Нет |
| rowDelimiter | Символ, используемый в качестве необработанного разделителя в файле. В настоящее время допускается только один символ. Этот тег является необязательным. По умолчанию используется одно из следующих значений: [\\r\\n, \\r, \\n]. | Нет |
| escapeChar | Специальный символ, используемый для экранирования разделителя столбцов в содержимом. Этот тег является необязательным. Значение по умолчанию отсутствует. Для этого свойства следует указывать не более одного знака.<br/><br/>Например, если в качестве разделителя столбцов используется запятая и в тексте встречается этот знак (например: Hello, world), назначьте $ escape-символом и используйте в исходном коде строку Hello$, world.<br/><br/>Обратите внимание, что для таблицы нельзя одновременно указывать свойства escapeChar и quoteChar. | Нет | 
| quoteChar | Специальный символ, который используется для заключения строкового значения в кавычки. Разделители столбцов и строк внутри кавычек будут рассматриваться как часть строкового значения. Этот тег является необязательным. Значение по умолчанию отсутствует. Для этого свойства следует указывать не более одного символа.<br/><br/>Например, если в качестве разделителя столбцов используется запятая (,) и нужно, чтобы этот символ встречался в тексте (например, <Hello  world>), назначьте в качестве символа кавычек прямые кавычки (") и используйте в исходном коде строку <"Hello, world">. Это свойство применимо к входным и выходным таблицам.<br/><br/>Обратите внимание, что для таблицы невозможно одновременно указывать свойства escapeChar и quoteChar. | Нет |
| nullValue | Один или несколько символов, используемых для обозначения нулевого значения в файле BLOB-объекта. Этот тег является необязательным. Значение по умолчанию — \\N.<br/><br/>Например, значение NaN (на основе приведенного выше примера) в большом двоичном объекте будет преобразовано в значение NULL при копировании, например, на сервер SQL Server. | Нет |
| encodingName | Имя кодировки. Список допустимых имен кодировок см. в описании свойства [Encoding.EncodingName](https://msdn.microsoft.com/library/system.text.encoding.aspx). Например: windows-1250 или shift\_jis. По умолчанию используется значение UTF-8. | Нет | 

#### Пример TextFormat
В следующем примере показаны некоторые свойства формата для TextFormat.

	"typeProperties":
	{
	    "folderPath": "mycontainer/myfolder",
	    "fileName": "myblobname"
	    "format":
	    {
	        "type": "TextFormat",
	        "columnDelimiter": ",",
	        "rowDelimiter": ";",
	        "quoteChar": """,
	        "NullValue": "NaN"
	    }
	},

Чтобы использовать escapeChar вместо quoteChar, вместо строки с quoteChar укажите следующее:

	"escapeChar": "$",

### Определение AvroFormat
Если для свойства format выбрано значение AvroFormat, вам не нужно указывать какие-либо свойства в подразделе Format раздела typeProperties. Пример:

	"format":
	{
	    "type": "AvroFormat",
	}

Сведения об использовании формата Avro в таблице Hive см. в [учебнике по Apache Hive](https://cwiki.apache.org/confluence/display/Hive/AvroSerDe).

### Указание JsonFormat

Если для свойства format задано значение **JsonFormat**, в разделе **Format** вы можете указать следующие **необязательные** свойства.

| Свойство | Описание | Обязательно |
| -------- | ----------- | -------- |
| filePattern | Шаблон данных, хранящихся в каждом JSON-файле. Допустимые значения: **setOfObjects** и **arrayOfObjects**. Значение **по умолчанию** — **setOfObjects**. Сведения об этих шаблонах см. в разделах ниже.| Нет |
| encodingName | Имя кодировки. Список допустимых имен кодировок см. в описании свойства [Encoding.EncodingName](https://msdn.microsoft.com/library/system.text.encoding.aspx). Например: windows-1250 или shift\_jis. **По умолчанию** используется значение **UTF-8**. | Нет | 
| nestingSeparator | Символ, используемый для разделения уровней вложенности. Значение **по умолчанию** — **точка (.)**. | Нет | 


#### Шаблон файла setOfObjects

Каждый файл содержит один объект или несколько разделенных строками или объединенных объектов. Если этот параметр выбран в выходном наборе данных, в результате копирования будет создан JSON-файл, где каждый объект находится в отдельной строке (файл с разделителем-строкой).

**один объект**

	{
		"time": "2015-04-29T07:12:20.9100000Z",
		"callingimsi": "466920403025604",
		"callingnum1": "678948008",
		"callingnum2": "567834760",
		"switch1": "China",
		"switch2": "Germany"
	}

**JSON с разделителем-строкой**

	{"time":"2015-04-29T07:12:20.9100000Z","callingimsi":"466920403025604","callingnum1":"678948008","callingnum2":"567834760","switch1":"China","switch2":"Germany"}
	{"time":"2015-04-29T07:13:21.0220000Z","callingimsi":"466922202613463","callingnum1":"123436380","callingnum2":"789037573","switch1":"US","switch2":"UK"}
	{"time":"2015-04-29T07:13:21.4370000Z","callingimsi":"466923101048691","callingnum1":"678901578","callingnum2":"345626404","switch1":"Germany","switch2":"UK"}
	{"time":"2015-04-29T07:13:22.0960000Z","callingimsi":"466922202613463","callingnum1":"789037573","callingnum2":"789044691","switch1":"UK","switch2":"Australia"}
	{"time":"2015-04-29T07:13:22.0960000Z","callingimsi":"466922202613463","callingnum1":"123436380","callingnum2":"789044691","switch1":"US","switch2":"Australia"}

**объединенный JSON**

	{
		"time": "2015-04-29T07:12:20.9100000Z",
		"callingimsi": "466920403025604",
		"callingnum1": "678948008",
		"callingnum2": "567834760",
		"switch1": "China",
		"switch2": "Germany"
	}
	{
		"time": "2015-04-29T07:13:21.0220000Z",
		"callingimsi": "466922202613463",
		"callingnum1": "123436380",
		"callingnum2": "789037573",
		"switch1": "US",
		"switch2": "UK"
	}
	{
		"time": "2015-04-29T07:13:21.4370000Z",
		"callingimsi": "466923101048691",
		"callingnum1": "678901578",
		"callingnum2": "345626404",
		"switch1": "Germany",
		"switch2": "UK"
	}


#### Шаблон файла arrayOfObjects. 

Каждый файл содержит массив объектов.

	[
	    {
	        "time": "2015-04-29T07:12:20.9100000Z",
	        "callingimsi": "466920403025604",
	        "callingnum1": "678948008",
	        "callingnum2": "567834760",
	        "switch1": "China",
	        "switch2": "Germany"
	    },
	    {
	        "time": "2015-04-29T07:13:21.0220000Z",
	        "callingimsi": "466922202613463",
	        "callingnum1": "123436380",
	        "callingnum2": "789037573",
	        "switch1": "US",
	        "switch2": "UK"
	    },
	    {
	        "time": "2015-04-29T07:13:21.4370000Z",
	        "callingimsi": "466923101048691",
	        "callingnum1": "678901578",
	        "callingnum2": "345626404",
	        "switch1": "Germany",
	        "switch2": "UK"
	    },
	    {
	        "time": "2015-04-29T07:13:22.0960000Z",
	        "callingimsi": "466922202613463",
	        "callingnum1": "789037573",
	        "callingnum2": "789044691",
	        "switch1": "UK",
	        "switch2": "Australia"
	    },
	    {
	        "time": "2015-04-29T07:13:22.0960000Z",
	        "callingimsi": "466922202613463",
	        "callingnum1": "123436380",
	        "callingnum2": "789044691",
	        "switch1": "US",
	        "switch2": "Australia"
	    },
	    {
	        "time": "2015-04-29T07:13:24.2120000Z",
	        "callingimsi": "466922201102759",
	        "callingnum1": "345698602",
	        "callingnum2": "789097900",
	        "switch1": "UK",
	        "switch2": "Australia"
	    },
	    {
	        "time": "2015-04-29T07:13:25.6320000Z",
	        "callingimsi": "466923300236137",
	        "callingnum1": "567850552",
	        "callingnum2": "789086133",
	        "switch1": "China",
	        "switch2": "Germany"
	    }
	]

### Пример JsonFormat

Если у вас есть JSON-файл со следующим содержимым:

	{
		"Id": 1,
		"Name": {
			"First": "John",
			"Last": "Doe"
		},
		"Tags": ["Data Factory”, "Azure"]
	}

и вы хотите скопировать его в таблицу SQL Azure в следующем формате:

Идентификатор | Name.First | Name.Middle | Name.Last | Теги
--- | ---------- | ----------- | --------- | ----
1 | Артем | null | Кузнецов | ["Data Factory", "Azure"]

Входной набор данных с типом JsonFormat определяется следующим образом (частичное определение только соответствующих частей):

	"properties": {
		"structure": [
			{"name": "Id", "type": "Int"},
			{"name": "Name.First", "type": "String"},
			{"name": "Name.Middle", "type": "String"},
			{"name": "Name.Last", "type": "String"},
			{"name": "Tags", "type": "string"}
		],
		"typeProperties":
		{
			"folderPath": "mycontainer/myfolder",
			"format":
			{
				"type": "JsonFormat",
				"filePattern": "setOfObjects",
				"encodingName": "UTF-8",
				"nestingSeparator": "."
			}
		}
	}

Если структура не определена, действие копирования сведет структуру по умолчанию и скопирует каждый элемент.

#### Поддерживаемая структура JSON
Обратите внимание на следующее:

- Каждый объект в коллекции пар "имя-значение" будет сопоставлен с одной строкой данных в табличном формате. Объекты могут быть вложенными, и вы можете определить, как свести структуру в наборе данных с разделителем вложения (.) по умолчанию. Пример см. в разделе [Пример JsonFormat](#jsonformat-example) выше.  
- Если структура не определена в наборе данных фабрики данных, действие копирования обнаружит схему из первого объекта и выполнит сведение всего объекта. 
- Если входной JSON-файл содержит массив, действие копирования преобразует все значение массива в строку. Это действие можно пропустить с помощью [сопоставления или фильтрации столбцов](#column-mapping-with-translator-rules).
- Если на том же уровне существует повторяющееся имя, действие копирования выберет последнее имя.
- В именах свойств учитывается регистр. Два свойства с одинаковым именем, но в разных регистрах будут рассматриваться как два отдельных свойства. 

