## <a name="virtual-network-basics"></a>Основные сведения о виртуальных сетях
### <a name="what-is-an-azure-virtual-network-vnet"></a>Что представляет собой виртуальная сеть Azure?
С помощью виртуальной сети можно подготовить VPN к работе в Azure и управлять ею. Кроме того, при необходимости можно связать виртуальную сеть с другими виртуальными сетями в Azure или с локальной ИТ-инфраструктурой для создания гибридных или распределенных решений. Каждая создаваемая виртуальная сеть имеет собственный блок CIDR. Ее можно связать с другими виртуальными сетями и локальными сетями при условии отсутствия конфликтов между блоками CIDR. Кроме того, существуют средства для настройки DNS-серверов для работы в виртуальных сетях, а также для сегментации виртуальных сетей на подсети.

Вы можете использовать виртуальные сети для указанных ниже целей.

* Создание выделенной виртуальной сети, действующей в пределах частного облака
  
    Иногда для вашего решения не нужна распределенная конфигурация. При создании виртуальной сети подключенные к ней службы и виртуальные машины могут безопасно обмениваться данными непосредственно друг с другом в облаке. Это позволяет безопасно ограничить трафик пределами виртуальной сети. При этом в рамках вашего решения вы можете настроить подключения конечных точек для виртуальных машин и служб, которым необходимо подключение к Интернету.
* Безопасное расширение центра обработки данных
  
    С помощью виртуальных сетей можно создавать традиционные VPN типа «сеть-сеть» (S2S) для безопасного масштабирования емкости центра обработки данных. Для создания безопасного подключения между корпоративным VPN-шлюзом и Azure в VPN-подключениях S2S используется IPsec.
* Поддержка сценариев гибридного облака
  
    Виртуальные сети предоставляют гибкие возможности для использования целого ряда сценариев гибридного облака. Вы можете безопасно подключать облачные приложения к локальным системам любого типа, например к большим ЭВМ и системам под управлением ОС Unix.

### <a name="how-do-i-know-if-i-need-a-virtual-network"></a>Как узнать, требуется ли виртуальная сеть?
На странице [Общие сведения о виртуальных сетях](../articles/virtual-network/virtual-networks-overview.md) есть таблица решений, с помощью которой можно подобрать лучший вариант сети.

### <a name="how-do-i-get-started"></a>Как начать работу?
Чтобы начать работу, посетите страницу [Документация по виртуальным сетям](https://azure.microsoft.com/documentation/services/virtual-network/) . На этой странице имеются ссылки на общие действия по настройке, а также сведения о том, что необходимо учесть при создании виртуальной сети.

### <a name="what-services-can-i-use-with-vnets"></a>Какие службы можно использовать в виртуальных сетях?
Совместно с виртуальными сетями можно использовать самые разные службы Azure, например облачные службы (платформа как услуга), виртуальные машины и веб-приложения. Тем не менее, существует несколько служб, которые не поддерживаются в виртуальной сети. Прежде чем использовать какие-либо службы, убедитесь, что они совместимы с виртуальными сетями.

### <a name="can-i-use-vnets-without-cross-premises-connectivity"></a>Можно ли использовать виртуальные сети без распределенных подключений?
Да. Вы можете использовать виртуальную сеть без использования подключений типа «сеть-сеть». Это особенно удобно, если вы хотите запустить контроллеры доменов и фермы SharePoint в Azure.

## <a name="virtual-network-configuration"></a>Настройка виртуальной сети
### <a name="what-tools-do-i-use-to-create-a-vnet"></a>Какие средства необходимо использовать для создания виртуальной сети?
Для создания или настройки виртуальной сети можно использовать указанные ниже средства.

* Портал Azure (для классических виртуальных сетей и виртуальных сетей Resource Manager).
* Файл конфигурации сети (netcfg — только для классических виртуальных сетей). См. статью [Настройка виртуальной сети с помощью файла конфигурации сети](../articles/virtual-network/virtual-networks-using-network-configuration-file.md).
* PowerShell (для классических виртуальных сетей и виртуальных сетей Resource Manager).
* Azure CLI (для классических виртуальных сетей и виртуальных сетей Resource Manager).

### <a name="what-address-ranges-can-i-use-in-my-vnets"></a>Какие диапазоны адресов можно использовать в виртуальных сетях?
Можно использовать диапазоны общедоступных IP-адресов и любые диапазоны IP-адресов, определенные в документе [RFC 1918](http://tools.ietf.org/html/rfc1918).

### <a name="can-i-have-public-ip-addresses-in-my-vnets"></a>Можно ли в виртуальных сетях использовать общедоступные IP-адреса?
Да. Дополнительные сведения о диапазонах общедоступных IP-адресов см. в статье [Общедоступное пространство IP-адресов в виртуальной сети (VNet)](../articles/virtual-network/virtual-networks-public-ip-within-vnet.md). Имейте в виду, что ваши общедоступные IP-адреса не будут доступны непосредственно из Интернета.

### <a name="is-there-a-limit-to-the-number-of-subnets-in-my-virtual-network"></a>Существует ли ограничение на количество подсетей в виртуальной сети?
Ограничения на количество подсетей в виртуальной сети нет. Все подсети должны полностью содержаться в адресном пространстве виртуальной сети и не должны перекрываться друг с другом.

### <a name="are-there-any-restrictions-on-using-ip-addresses-within-these-subnets"></a>Существуют ли ограничения на использование IP-адресов в пределах этих подсетей?
Azure резервирует некоторые IP-адреса в каждой подсети. Зарезервированы первый и последний IP-адреса подсетей (для соответствия требованиям протокола), а также еще 3 адреса, используемые для служб Azure.

### <a name="how-small-and-how-large-can-vnets-and-subnets-be"></a>Насколько большими или малыми могут быть виртуальные сети и подсети?
Самая маленькая поддерживаемая подсеть — /29, а самая большая — /8 (согласно определениям подсети CIDR).

### <a name="can-i-bring-my-vlans-to-azure-using-vnets"></a>Можно ли переносить виртуальные локальные сети в Azure с помощью виртуальных сетей?
Нет. Виртуальные сети представляют собой наложения Layer-3. Azure не поддерживает семантику Layer-2.

### <a name="can-i-specify-custom-routing-policies-on-my-vnets-and-subnets"></a>Можно ли в виртуальных сетях и подсетях задавать настраиваемые политики маршрутизации?
Да. Вы можете использовать пользовательскую маршрутизацию. Дополнительные сведения о пользовательской маршрутизации см. в статье [Что такое определяемые пользователем маршруты и IP-пересылка?](../articles/virtual-network/virtual-networks-udr-overview.md)

### <a name="do-vnets-support-multicast-or-broadcast"></a>Поддерживают ли виртуальные сети технологии многоадресной или широковещательной рассылки?
Нет. Технологии многоадресной или широковещательной рассылки не поддерживаются.

### <a name="what-protocols-can-i-use-within-vnets"></a>Какие протоколы можно использовать в рамках виртуальных сетей?
В виртуальных сетях можно использовать стандартные IP-протоколы. Тем не менее, в виртуальных сетях блокируются многоадресные и широковещательные рассылки, инкапсулированные пакеты IP-в-IP и пакеты, передаваемые по протоколу GRE. Ниже перечислены поддерживаемые стандартные протоколы.

* TCP
* UDP
* ICMP

### <a name="can-i-ping-my-default-routers-within-a-vnet"></a>Можно ли в виртуальной сети проверять связь с маршрутизаторами по умолчанию?
Нет.

### <a name="can-i-use-tracert-to-diagnose-connectivity"></a>Можно ли использовать команду tracert для диагностики подключения?
Нет.

### <a name="can-i-add-subnets-after-the-vnet-is-created"></a>Можно ли добавлять подсети после создания виртуальной сети?
Да. Вы можете в любое время добавлять подсети в виртуальные сети при условии, что адрес добавляемой подсети не принадлежит другой подсети виртуальной сети.

### <a name="can-i-modify-the-size-of-my-subnet-after-i-create-it"></a>Можно ли изменить размер подсети после ее создания?
Вы можете добавлять, удалять, расширять или уменьшать подсеть (если в ней не развернуты виртуальные машины и службы) с помощью командлетов PowerShell или файла NETCFG. Кроме того, можно добавлять, удалять, расширять и уменьшать любые префиксы при условии, что такие изменения не влияют на подсети, содержащие виртуальные машины или службы.

### <a name="can-i-modify-subnets-after-i-created-them"></a>Можно ли изменять подсети после их создания?
Да. Вы можете добавлять, удалять и изменять блоки CIDR, используемые виртуальной сетью.

### <a name="can-i-connect-to-the-internet-if-i-am-running-my-services-in-a-vnet"></a>Могут ли службы, работающие в виртуальной сети, подключиться к Интернету?
Да. Все службы, развернутые в виртуальной сети, могут подключаться к Интернету. У каждой облачной службы, развернутой в Azure, есть виртуальный IP-адрес. Чтобы эти службы могли принимать подключения из Интернета, необходимо определить входные конечные точки для ролей "платформа как услуга" и конечные точки для виртуальных машин.

### <a name="do-vnets-support-ipv6"></a>Поддерживают ли виртуальные сети протокол IPv6?
Нет. В настоящее время невозможно использовать протокол IPv6 в виртуальных сетях.

### <a name="can-a-vnet-span-regions"></a>Может ли виртуальная сеть охватывать несколько регионов?
Нет. Виртуальную сеть можно использовать только в пределах одного региона.

### <a name="can-i-connect-a-vnet-to-another-vnet-in-azure"></a>Можно ли подключить виртуальную сеть к другой виртуальной сети в Azure?
Да. Вы можете организовать обмен данными между виртуальными сетями с помощью REST API или Windows PowerShell. Между виртуальными сетями также можно установить пиринговую связь. Дополнительные сведения об этой связи см. [здесь](../articles/virtual-network/virtual-network-peering-overview.md).

## <a name="name-resolution-dns"></a>Разрешение имен (DNS)
### <a name="what-are-my-dns-options-for-vnets"></a>Каковы параметры DNS для виртуальных сетей?
Все доступные параметры DNS есть в таблице решений на странице [Разрешение имен для виртуальных машин и экземпляров ролей](../articles/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md) .

### <a name="can-i-specify-dns-servers-for-a-vnet"></a>Можно ли указать DNS-серверы для виртуальной сети?
Да. Вы можете указать IP-адреса DNS-сервера в параметрах виртуальной сети. Он будет использоваться в качестве DNS-сервера по умолчанию для всех виртуальных машин в виртуальной сети.

### <a name="how-many-dns-servers-can-i-specify"></a>Сколько DNS-серверов можно указать?
Можно указать до 12 DNS-серверов.

### <a name="can-i-modify-my-dns-servers-after-i-have-created-the-network"></a>Можно ли изменять DNS-серверы после создания сети?
Да. Вы можете в любое время изменить список DNS-серверов для виртуальной сети. После изменения списка DNS-серверов необходимо перезапустить все виртуальные машины в виртуальной сети, чтобы они начали использовать параметры нового DNS-сервера.

### <a name="what-is-azure-provided-dns-and-does-it-work-with-vnets"></a>Что такое DNS, предоставленная Azure, и работает ли она с виртуальными сетями?
DNS, предоставленная Azure, — это мультитенантная служба DNS, предлагаемая корпорацией Майкрософт. Azure регистрирует все ваши виртуальные машины и экземпляры ролей в этой службе. Эта служба выполняет разрешение имен по имени узла для виртуальных машин и экземпляров ролей, содержащихся в одной и той же облачной службе, и по FQDN для виртуальных машин и экземпляров ролей в одной и той же виртуальной сети.

> [!NOTE]
> В настоящее время имеется следующее ограничение: разрешение имен между клиентами с помощью DNS, предоставленной Azure, выполняется только для первых 100 облачных служб в виртуальной сети. Если вы используете собственный DNS-сервер, то это ограничение не применяется.
> 
> 

### <a name="can-i-override-my-dns-settings-on-a-per-vm--service-basis"></a>Можно ли переопределять параметры DNS для каждой виртуальной машины или службы?
Да. Чтобы переопределить параметры сети по умолчанию, можно задать DNS-серверы для каждой службы. Тем не менее, мы рекомендуем максимально широко использовать DNS уровня сети.

### <a name="can-i-bring-my-own-dns-suffix"></a>Можно использовать собственный суффикс DNS?
Нет. Невозможно указать пользовательский суффикс DNS для виртуальных сетей.

## <a name="vnets-and-vms"></a>Виртуальные сети и виртуальные машины
### <a name="can-i-deploy-vms-to-a-vnet"></a>Можно ли развертывать виртуальные машины в виртуальной сети?
Да.

### <a name="can-i-deploy-linux-vms-to-a-vnet"></a>Можно ли развертывать виртуальные машины Linux в виртуальной сети?
Да. Вы можете развернуть любой дистрибутив Linux, поддерживаемый Azure.

### <a name="what-is-the-difference-between-a-public-vip-and-an-internal-ip-address"></a>Какова разница между общедоступным виртуальным IP-адресом и внутренним IP-адресом?
* Внутренний IP-адрес — это IP-адрес, назначаемый DHCP-сервером каждой виртуальной машине в виртуальной сети. Он не является общедоступным. Если вы создали виртуальную сеть, внутренний IP-адрес будет назначен из диапазона, указанного в параметрах подсети виртуальной сети. Если у вас нет виртуальной сети, то внутренний IP-адрес все равно будет назначен. Внутренний IP-адрес закрепляется за виртуальной машиной на протяжении всего времени ее существования до тех пор, пока она не будет освобождена.
* Общедоступный виртуальный IP-адрес — это общедоступный IP-адрес, назначенный вашей облачной службе или подсистеме балансировки нагрузки. Он не назначается непосредственно сетевой карте виртуальной машины. Виртуальный IP-адрес закрепляется за облачной службой, которой он назначен, до тех пор, пока все виртуальные машины в ней не будут освобождены или удалены. В этот момент он будет освобожден.

### <a name="what-ip-address-will-my-vm-receive"></a>Какой IP-адрес получит виртуальная машина?
* **Внутренний IP-адрес.** При развертывании виртуальной машины в виртуальной сети она получает внутренний IP-адрес из пула указанных вами внутренних IP-адресов. В виртуальных сетях виртуальные машины обмениваются данными друг с другом с помощью внутренних IP-адресов. Несмотря на то что Azure назначает динамический внутренний IP-адрес, можно запросить статический адрес для виртуальной машины. Дополнительные сведения о статических внутренних IP-адресах см. в статье [Как задать статический внутренний частный IP-адрес с помощью PowerShell (классическая модель)](../articles/virtual-network/virtual-networks-reserved-private-ip.md).
* **Виртуальный IP-адрес.** Виртуальная машина сопоставлена с виртуальным IP-адресом, хотя он никогда не назначается ей напрямую. Виртуальный IP-адрес — это общедоступный IP-адрес, который можно назначить облачной службе. При необходимости можно зарезервировать виртуальный IP-адрес для облачной службы.
* **Общедоступный IP-адрес уровня экземпляра.** Вы можете настроить общедоступный IP-адрес уровня экземпляра. Общедоступные IP-адреса уровня экземпляра сопоставляются с виртуальной машиной, а не c облачной службой. Дополнительные сведения об общедоступных IP-адресах уровня экземпляра см. в [этой статье](../articles/virtual-network/virtual-networks-instance-level-public-ip.md).

### <a name="can-i-reserve-an-internal-ip-address-for-a-vm-that-i-will-create-at-a-later-time"></a>Можно ли зарезервировать внутренний IP-адрес для виртуальной машины, которую собираюсь создать позже?
Нет. Зарезервировать внутренний IP-адрес невозможно. Если внутренний IP-адрес доступен, DHCP-сервер назначит его виртуальной машине или экземпляру роли. Это может быть не та виртуальная машина, которой вы хотели бы назначить определенный внутренний IP-адрес. Тем не менее, можно изменить внутренний IP-адрес уже созданной виртуальной машины на любой доступный внутренний IP-адрес.

### <a name="do-internal-ip-addresses-change-for-vms-in-a-vnet"></a>Изменяются ли внутренние IP адреса виртуальных машин в виртуальной сети?
Да. Внутренние IP-адреса закрепляются за виртуальной машиной на все время ее существования, пока она не будет освобождена. Если виртуальная машина освобождена, внутренний IP-адрес также будет освобожден, если только для виртуальной машины не задан статический IP-адрес. Если виртуальная машина просто остановлена и не переведена в состояние **Остановлена (освобождена)**, то IP-адрес будет по-прежнему закреплен за ней.

### <a name="can-i-manually-assign-ip-addresses-to-nics-in-vms"></a>Можно ли вручную назначать IP-адреса сетевым картам виртуальных машин?
Нет. Изменять свойства интерфейсов виртуальных машин запрещено. Любые изменения могут привести к потере подключения к виртуальной машине.

### <a name="what-happens-to-my-ip-addresses-if-i-shut-down-a-vm"></a>Что происходит с IP-адресами при выключении виртуальной машины?
Ничего. IP-адреса (общедоступные виртуальные IP-адреса и внутренние IP-адреса) останутся закрепленными за облачной службой или виртуальной машиной.

> [!NOTE]
> Если вы хотите просто завершить работу виртуальной машины, не используйте для этого портал управления. В настоящее время нажатие кнопки завершения работы приводит к освобождению виртуальной машины.
> 
> 

### <a name="can-i-move-vms-from-one-subnet-to-another-subnet-in-a-vnet-without-re-deploying"></a>Можно ли перемещать виртуальные машины между подсетями виртуальной сети без повторного развертывания?
Да. Дополнительные сведения см. [здесь](../articles/virtual-network/virtual-networks-move-vm-role-to-subnet.md).

### <a name="can-i-configure-a-static-mac-address-for-my-vm"></a>Можно ли настроить статический MAC-адрес для виртуальной машины?
Нет. Настроить MAC-адрес статически невозможно.

### <a name="will-the-mac-address-remain-the-same-for-my-vm-once-it-has-been-created"></a>Остается ли MAC-адрес виртуальной машины неизменным после ее создания?
Да, MAC-адрес виртуальной машины останется тем же, несмотря на то что виртуальная машина была остановлена (освобождена) и запущена повторно.

### <a name="can-i-connect-to-the-internet-from-a-vm-in-a-vnet"></a>Можно ли подключиться к Интернету из виртуальной машины, находящейся в виртуальной сети?
Да. Все службы, развернутые в виртуальной сети, могут подключаться к Интернету. Кроме того, каждой облачной службе, развернутой в Azure, назначен общедоступный виртуальный IP-адрес. Чтобы эти службы могли принимать подключения из Интернета, необходимо определить входные конечные точки ролей PaaS (платформа как услуга) и конечные точки для виртуальных машин.

## <a name="vnets-and-services"></a>Виртуальные сети и службы
### <a name="what-services-can-i-use-with-vnets"></a>Какие службы можно использовать в виртуальных сетях?
В виртуальных сетях можно использовать только службы вычислений. Службы вычислений ограничены облачными службами (рабочая и веб-роль) и виртуальными машинами.

### <a name="can-i-use-web-apps-with-virtual-network"></a>Можно ли использовать веб-приложения совместно с виртуальной сетью?
Да. Вы можете развернуть веб-приложения внутри виртуальной сети, используя среду службы приложений (ASE). Кроме того, веб-приложения могут безопасно подключаться к виртуальной сети Azure и получать доступ к ее ресурсам, если для нее настроено подключение типа "точка-сеть". Дополнительную информацию см. в следующих разделах.

* [Создание веб-приложений в среде службы приложений](../articles/app-service-web/app-service-web-how-to-create-a-web-app-in-an-ase.md)
* [Интеграция виртуальной сети веб-сайтов Azure](https://azure.microsoft.com/blog/2014/09/15/azure-websites-virtual-network-integration/)
* [Использование интеграции виртуальной сети и гибридных подключений с веб-приложениями](https://azure.microsoft.com/blog/2014/10/30/using-vnet-or-hybrid-conn-with-websites/)
* [Интеграция веб-приложения с виртуальной сетью Azure](../articles/app-service-web/web-sites-integrate-with-vnet.md)

### <a name="can-i-deploy-cloud-services-with-web-and-worker-roles-paas-in-a-vnet"></a>Можно ли развернуть облачные службы с веб-ролями и рабочими ролями (платформа как услуга) в виртуальной сети?
Да. Вы можете развертывать службы модели «платформа как услуга» в виртуальных сетях.

### <a name="how-do-i-deploy-paas-roles-to-a-vnet"></a>Как развертывать роли «платформа как услуга» в виртуальной сети?
Это можно сделать, указав имя виртуальной сети и сопоставления роли или подсети в разделе конфигурации сети в конфигурации службы. Не нужно обновлять никакие двоичные файлы.

### <a name="can-i-move-my-services-in-and-out-of-vnets"></a>Можно ли перемещать службы в виртуальные сети и из них?
Нет. Невозможно перемещать службы в виртуальные сети и из них. Чтобы переместить службу в другую виртуальную сеть, потребуется удалить ее, а затем повторно развернуть.

## <a name="vnets-and-security"></a>Виртуальные сети и безопасность
### <a name="what-is-the-security-model-for-vnets"></a>Какова модель безопасности для виртуальных сетей?
Виртуальные сети полностью изолированы друг от друга и от других служб, размещенных в инфраструктуре Azure. Виртуальная сеть — это граница доверия.

### <a name="can-i-define-acls-or-nsgs-on-my-vnets"></a>Можно ли задать ACL или NSG в виртуальных сетях?
Нет. Невозможно сопоставить ACL или NSG с виртуальными сетями. Тем не менее, можно задать ACL на входных конечных точках для виртуальных машин, развернутых в виртуальных сетях, и сопоставить NSG с подсетями или сетевыми картами.

### <a name="is-there-a-vnet-security-whitepaper"></a>Существует ли технический документ, посвященный вопросам безопасности виртуальных сетей?
Да. Его можно скачать [здесь](http://go.microsoft.com/fwlink/?LinkId=386611).

## <a name="apis-schemas-and-tools"></a>Интерфейсы API, схемы и инструменты
### <a name="can-i-manage-vnets-from-code"></a>Можно ли управлять виртуальными сетями из кода?
Да. Для управления виртуальными сетями и распределенными подключениями можно использовать REST API. Дополнительные сведения см. [здесь](http://go.microsoft.com/fwlink/?LinkId=296833).

### <a name="is-there-tooling-support-for-vnets"></a>Существуют ли специальные программные средства для работы с виртуальными сетями?
Да. Вы можете использовать PowerShell и средства командной строки для различных платформ. Дополнительные сведения см. [здесь](http://go.microsoft.com/fwlink/?LinkId=317721).

