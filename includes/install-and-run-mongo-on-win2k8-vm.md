Выполните следующие действия, чтобы установить и запустить MongoDB на виртуальной машине Windows Server.

> [AZURE.IMPORTANT]Функции безопасности MongoDB, такие как проверка подлинности и привязка IP-адреса, не включены по умолчанию. Функции безопасности необходимо включить перед развертыванием MongoDB в рабочей среде. Дополнительные сведения см. в документе [Безопасность и проверка подлинности](http://www.mongodb.org/display/DOCS/Security+and+Authentication).

1. После подключения к виртуальной машине с помощью удаленного рабочего стола, откройте Internet Explorer из меню **Пуск**.
2. Нажмите кнопку **Сервис** в правом верхнем углу. В окне **Свойства браузера** выберите вкладку **Безопасность**, выберите значок **Надежные сайты**, а затем нажмите кнопку **Сайты**. Добавьте *http://*.mongodb.org* в список надежных сайтов.
3. Перейдите на страницу [Скачивания — MongoDB][MongoDownloads].
4. Найдите последний выпуск в разделе **Production Release (Recommended)** (Рабочая версия (рекомендуется)) и щелкните ссылку ***2008+** в столбце "Windows 64-bin" (64-разрядная версия Windows). Нажмите кнопку **Сохранить как** и сохраните ZIP-файл на рабочем столе.
5. Щелкните правой кнопкой мыши ZIP-файл и выберите **Извлечь все...** Введите "C:" и щелкните **Извлечь**. После извлечения файлов папку установки можно переименовать. Например, в "MongoDB".
6. Создайте каталоги данных и журналов MongoDB на диске данных (например, на диске **F:**), созданном на предыдущих этапах. В меню **Пуск** выберите **Командная строка**, чтобы открыть окно командной строки. Введите:

		C:\> F:
		F:> mkdir \MongoData
		F:> mkdir \MongoLogs

7. Чтобы запустить базу данных, введите:

		F:> C:
		C:\> cd \MongoDB\bin
		C:\my_mongo_dir\bin> mongod --dbpath F:\MongoData\ --logpath F:\MongoLogs\mongolog.log

	Все сообщения журнала будут направляться в файл *F:\MongoLogs\mongolog.log*, когда сервер mongod.exe запустится и выделит место для файлов журналов. Может пройти несколько минут, пока MongoDB выделит место для файлов журналов и начнет прослушивать подключения.

8. Чтобы запустить консоль управления MongoDB, откройте еще одно окно командной строки из меню **Пуск** и введите следующее:

		C:\> cd \my_mongo_dir\bin  
		C:\my_mongo_dir\bin> mongo  
		>db  
		test  	  
		> db.foo.insert( { a : 1 } )  
		> db.foo.find()  
		{ _id : ..., a : 1 }  
		> show dbs  
		...  
		> show collections  
		...  
		> help  

	База данных создается путем вставки.
9. (Дополнительно) mongod.exe поддерживает установку и выполнение в виде службы Windows. Чтобы установить mongod.exe в качестве службы, введите в командной строке следующую команду:

		C:\mongodb\bin>mongod --logpath "c:\mongodb\logs\logfile.log" --logappend --dbpath "c:\data" --install 

	Будет создана служба с именем "Mongo DB" и описанием "Mongo DB". Необходимо указать файл журнала с помощью параметра **--logpath**, поскольку у работающей службы нет командного окна для вывода данных. Параметр **--logpath** указывает, что после перезапуска службы выходные данные будут добавляться в существующий файл журнала. Параметр **--dbpath** указывает расположение каталога данных. Дополнительные сведения о параметрах командной строки, связанных со службами, см. в документе [Параметры командной строки, связанные со службами][MongoWindowsSvcOptions].
10. После установки и запуска MongoDB необходимо открыть порт в брандмауэре Windows для удаленного подключения к MongoDB. В меню **Пуск** выберите **Администрирование** и **Брандмауэр Windows в режиме повышенной безопасности**. 

11. В левой панели выберите **Правила для входящих подключений**. В панели **Действия** справа выберите **Создать правило...**.
	
	![Брандмауэр Windows][Image1]

	В окне **Мастер создания правила для нового входящего подключения** выберите **Порт** и нажмите кнопку **Далее**.
	
	![Брандмауэр Windows][Image2]

	Выберите **TCP** и **Определенные локальные порты**. Укажите порт "27017" (порт, прослушиваемый MongoDB) и нажмите кнопку **Далее**.

	![Брандмауэр Windows][Image3]

	Выберите **Разрешить подключение** и нажмите **Далее**.

	![Брандмауэр Windows][Image4]

	Нажмите **Далее** еще раз.
	
	![Брандмауэр Windows][Image5]

	Введите имя правила, например "MongoPort", и нажмите **Готово**.

	![Брандмауэр Windows][Image6]
	
12. Если вы не настроили конечную точку для MongoDB при создании виртуальной машины, можно сделать это сейчас. Для удаленного подключения к MongoDB потребуется правило брандмауэра и конечная точка. На портале управления щелкните **Виртуальные машины**, выберите имя новой виртуальной машины, а затем щелкните **Конечные точки**.

	![Конечные точки][Image7]
13. Щелкните **Добавить конечную точку** в нижней части страницы. Выберите **Добавить конечную точку** и нажмите **Далее**.
	
	![Конечные точки][Image8]

14. Добавьте конечную точку с именем Mongo, протоколом **TCP** и портами **Общий** и **Частный** со значением "27017". Это позволит получать удаленный доступ к MongoDB.

	![Конечные точки][Image9]

[MongoDownloads]: http://www.mongodb.org/downloads

[MongoWindowsSvcOptions]: http://www.mongodb.org/display/DOCS/Windows+Service


[Image1]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall1.png
[Image2]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall2.png
[Image3]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall3.png
[Image4]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall4.png
[Image5]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall5.png
[Image6]: ./media/install-and-run-mongo-on-win2k8-vm/WinFirewall6.png
[Image7]: ./media/install-and-run-mongo-on-win2k8-vm/WinVmAddEndpoint.png
[Image8]: ./media/install-and-run-mongo-on-win2k8-vm/WinVmAddEndpoint2.png
[Image9]: ./media/install-and-run-mongo-on-win2k8-vm/WinVmAddEndpoint3.png

<!----HONumber=July15_HO2-->