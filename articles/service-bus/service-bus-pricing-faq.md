<properties 
    pageTitle="Часто задаваемые вопросы о ценах на служебную шину | Microsoft Azure"
    description="Ответы на некоторые часто задаваемые вопросы о ценах на использование служебной шины."
    services="service-bus"
    documentationCenter="na"
    authors="sethmanheim"
    manager="timlt"
    editor="" />
<tags 
    ms.service="service-bus"
    ms.devlang="na"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="na"
    ms.date="03/16/2016"
    ms.author="sethm" />

# Часто задаваемые вопросы о расценках на служебную шину

В этой статье содержатся ответы на некоторые часто задаваемые вопросы о структуре цен на служебную шину. Также можно посетить страницу [часто задаваемых вопросов о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083), где содержатся общие сведения о структуре ценообразования Microsoft Azure. Дополнительные сведения о ценах на использование служебной шины см. на странице [цен на служебную шину](https://azure.microsoft.com/pricing/details/service-bus/).

>[AZURE.NOTE] Структура ценообразования для концентраторов событий описана в статье [Доступность и поддержка концентраторов событий: часто задаваемые вопросы](../event-hubs/event-hubs-availability-and-support-faq.md); дополнительные сведения см. в статье [Цены на концентраторы событий](https://azure.microsoft.com/pricing/details/event-hubs/).

- [Как выставляется цена на служебную шину?](#how-do-you-charge-for-service-bus)
- [Какое использование служебной шины считается передачей данных? А какое не считается?](#what-usage-of-service-bus-is-subject-to-data-transfer-what-is-not)
- [Что такое ретранслятор служебной шины?](#what-exactly-is-a-service-bus-quotrelayquot)
- [Как вычисляется количество часов ретрансляции?](#how-is-the-relay-hours-meter-calculated)
- [Что делать, если к определенному ретранслятору подключено несколько прослушивателей?](#what-if-i-have-more-than-one-listener-connected-to-a-given-relay)
- [Как вычисляется количество сообщений ретрансляторам?](#how-is-the-messages-meter-calculated-for-relays)
- [Взимает ли служебная шина плату за использование хранилища?](#does-service-bus-charge-for-storage)
- [Есть ли у служебной шины квоты использования?](#does-service-bus-have-any-usage-quotas)

## Как выставляется цена на служебную шину?

Дополнительные сведения о ценах на использование служебной шины см. в статье [Цены и выставление счетов при использовании шины обслуживания](service-bus-pricing-billing.md) и на странице [цен на служебную шину](https://azure.microsoft.com/pricing/details/service-bus/). Помимо указанной платы, также взимается плата за связанные операции передачи данных, исходящих из центра обработки данных, в котором подготавливается ваше приложение. Дополнительные сведения см. в разделе [Какое использование служебной шины считается передачей данных? А какое не считается?](#what-usage-of-service-bus-is-subject-to-data-transfer-what-is-not) ниже.

## Какое использование служебной шины считается передачей данных? А какое не считается?

Любая передача данных в пределах заданного региона Azure выполняется бесплатно. Любая передача исходящих данных за пределы региона оплачивается по тарифу 0,15 доллара США за 1 ГБ исходящих данных из Северной Америки и Европы и 0,20 доллара США за 1 ГБ для данных из Азиатско-Тихоокеанского региона. Передача входящих данных осуществляется бесплатно.

## Что такое ретранслятор служебной шины?

Ретранслятор — это сущность служебной шины, которая передает сообщения между клиентами и веб-службами. Ретранслятор предоставляет службе постоянный обнаруживаемый адрес служебной шины, надежное соединение с возможностями обхода брандмауэра/NAT и такие дополнительные функции, как автоматическая балансировка нагрузки. Ретранслятор неявно создается и открывается для адреса данной служебной шины (URL-адреса пространства имен) каждый раз, когда служба WCF с поддержкой ретрансляции (прослушиватель ретрансляции) подключается к этому адресу. Приложения создают прослушиватели ретрансляции с помощью интерфейсов API .NET служебной шины, которые предоставляют специальные версии стандартных привязок WCF с поддержкой ретрансляции.

## Как вычисляется количество часов ретрансляции?

Плата за ретрансляцию взимается на основе совокупного количества часов в рамках заданного периода выставления счетов, на протяжении которых каждый ретранслятор служебной шины остается открытым. Ретранслятор неявно создается и открывается для адреса данной служебной шины (URL-адреса пространства имен службы) каждый раз, когда служба WCF с поддержкой ретрансляции (прослушиватель ретрансляции) подключается к этому адресу. Ретранслятор закрывается только тогда, когда последний прослушиватель отключается от его адреса. Таким образом, при выставлении счетов ретранслятор считается открытым с момента подключения первого прослушивателя ретрансляции к адресу служебной шины, участвующей в данной ретрансляции, и до момента отключения последнего прослушивателя от этого адреса. Иначе говоря, ретранслятор считается открытым каждый раз, когда один или несколько прослушивателей ретрансляции остаются подключенными к адресу соответствующей служебной шины.

## Что делать, если к определенному ретранслятору подключено несколько прослушивателей?

В некоторых случаях к одному ретранслятору служебной шины могут подключаться несколько прослушивателей. Это может произойти при работе со службами балансировки нагрузки, использующими привязки WCF **netTCPRelay** или **HttpRelay**, или же широковещательными прослушивателями событий, использующими привязку WCF **netEventRelay**. Ретранслятор служебной шины считается открытым, если к нему подключен хотя бы один прослушиватель. Добавление дополнительных прослушивателей к открытому ретранслятору не влияет на его статус при выставлении счетов. Количество отправителей ретрансляции (клиентов, вызывающих или отправляющих сообщения ретрансляторам), подключенных к ретранслятору, также не влияет на подсчет часов ретрансляции.

## Как вычисляется количество сообщений ретрансляторам?

В целом количество подлежащих оплате сообщений ретрансляторам вычисляется так же, как и для посреднических сущностей — очередей, разделов и подписок (см. выше). Тем не менее существует несколько важных отличий.

1. Отправка сообщения ретранслятору служебной шины рассматривается как полностью осуществленная отправка прослушивателю ретрансляции, который получает сообщение, а не отправка сообщения ретранслятору служебной шины с последующей его доставкой прослушивателю ретрансляции. Следовательно, при вызове службы типа «запрос-ответ» (размером до 64 КБ) на уровне прослушивателя ретрансляции будут зафиксированы следующие сообщения: одно оплачиваемое сообщение для запроса и одно оплачиваемое сообщение для ответа (при условии, что размер ответа также не превышает 64 КБ). Это отличается от механизма использования очереди в качестве посредника между клиентом и службой. В последнем случае в рамках одного и того же алгоритма типа «запрос-ответ» предусмотрена отправка запроса в очередь с последующим изъятием из очереди и доставкой в службы, отправкой ответа в другую очередь, а также изъятием из очереди и доставкой клиенту. При размере вызова, не превышающем 64 КБ, использование схемы с посредником в виде очереди приведет к выставлению счета за четыре оплачиваемых сообщения. Это в два раза превышает плату за использование аналогичной схемы с ретранслятором. Конечно, использование такой схемы связано с определенными преимуществами, включая надежность и выравнивание нагрузки. Эти преимущества могут оправдать дополнительные расходы.

2. Ретрансляторы, открытые с помощью привязки WCF **netTCPRelay**, обрабатывают сообщения не как отдельные объекты, а как поток данных, передаваемых через систему. Другими словами, сведения о формировании отдельных сообщений, отправленных и полученных с помощью этой привязки, доступны только отправителю и прослушивателю. Таким образом, для ретрансляторов, использующих привязку **netTCPRelay**, все данные обрабатываются как поток при вычислении количества оплачиваемых сообщений. В этом случае служебная шина вычислит общий объем данных, отправленных или полученных в ходе отдельной ретрансляции с 5-минутными интервалами. Затем полученное значение будет поделено на 64 КБ. Это позволит определить количество оплачиваемых сообщений ретранслятору, обработанных за заданный период.

## Взимает ли служебная шина плату за использование хранилища?

Нет, служебная шина не взимает плату за использование хранилища. Тем не менее существует квота, ограничивающая максимальный объем данных, которые могут быть сохранены в каждой очереди или разделе. См. следующий раздел часто задаваемых вопросов.

## Есть ли у служебной шины квоты использования?

По умолчанию для любой облачной службы Майкрософт устанавливается квота совокупного месячного использования в рамках всех подписок клиента. Мы понимаем, что вам может потребоваться больше, чем разрешено этими ограничениями. В таком случае вы можете в любое время обратиться в службу поддержки пользователей, чтобы мы изменили эти ограничения на основе ваших потребностей. Для служебной шины установлены следующие квоты общего использования:

- 5 миллиардов сообщений;

- 2 миллиона часов ретрансляции.

Хотя мы оставляем за собой право отключить учетную запись клиента, превысившего свои месячные квоты использования, перед выполнением каких-либо действий мы отправим уведомления по электронной почте, а также предпримем несколько попыток, чтобы связаться с клиентом. Клиентам, превысившим свои квоты, будут выставлены соответствующие счета.

Как и в случае с другими службами в Azure, служебная шина использует набор особых [квот](service-bus-quotas.md) для обеспечения справедливого использования ресурсов. Ниже приведены квоты использования, применяемые службой.

- **Размер очереди или раздела**. Вы задаете максимальный размер очереди или раздела при создании очереди или раздела. Эта квота может иметь значение 1, 2, 3, 4 или 5 ГБ. При достижении максимального значения квоты последующие входящие сообщения отклоняются, а вызывающий код получает исключение.

- **Количество одновременных подключений**
	- **Очереди, разделы и подписки**. Максимально допустимое количество параллельных TCP-подключений в очереди, разделе или подписке равно 100. После достижения квоты запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. Для каждой фабрики обмена сообщениями служебная шина поддерживает одно TCP-подключение, если у любого из клиентов, созданного такой фабрикой обмена сообщениями, есть активная операция в состоянии ожидания или операция, завершенная менее 60 секунд назад. Операции REST не считаются параллельными TCP-подключениями.


- **Количество параллельных прослушивателей на один ретранслятор**. Максимально допустимое количество параллельных прослушивателей **netTcpRelay** и **netHttpRelay** на один ретранслятор равно 25 (для ретранслятора **NetOneway** — 1).

- **Количество параллельных прослушивателей ретрансляции на одно пространство имен**. Служебная шина применяет ограничение в 2000 параллельных прослушивателей ретрансляции на каждое пространство имен службы. После достижения квоты последующие запросы на открытие дополнительных прослушивателей ретрансляции отклоняются, а вызывающий код получает исключение.

- **Количество разделов или очередей на одно пространство имен службы**. Максимально допустимое количество разделов или очередей (сущностей долгосрочного резервного хранения) на одно пространство имен службы равно 10 000. После достижения этой квоты последующие запросы на создание нового раздела или очереди в пространстве имен службы будут отклонены. В таком случае на [классическом портале Azure][] появится сообщение об ошибке, или вызывающий код клиента получит исключение (в зависимости от того, выполнялась ли попытка создания с использованием портала или кода клиента).

- **Квоты на размер сообщения**
	- **Очередь, раздел и подписка**
		- **Размер сообщения**. Каждое сообщение ограничено суммарным размером 256 КБ, включая заголовки сообщения.
		- **Размер заголовка сообщения**. Каждый заголовок сообщения ограничен 64 КБ.

	- **Ретрансляторы NetOneway и NetEvent**. Каждое сообщение ограничено суммарным размером 64 КБ, включая заголовки.
	- **Ретрансляторы http и NetTcp**. В служебной шине отсутствует максимальное значение размера этих сообщений.

	Сообщения, размер которых превышает эти значения, будут отклонены, а вызывающий код получит исключение.

- **Количество подписок на раздел**. Максимально допустимое количество подписок на один раздел равно 2000. После достижения этой квоты последующие запросы на создание дополнительных подписок для раздела будут отклонены. В таком случае на [классическом портале Azure][] появится сообщение об ошибке, или вызывающий код клиента получит исключение (в зависимости от того, выполнялась ли попытка создания с использованием портала или кода клиента).

- **Количество фильтров SQL на раздел**. Максимально допустимое количество фильтров SQL на один раздел равно 2000. После достижения квоты последующие запросы на создание дополнительных фильтров для раздела отклоняются, а вызывающий код получает исключение.

- **Количество фильтров корреляции на раздел**. Максимально допустимое количество фильтров корреляции на один раздел равно 100 000. После достижения квоты последующие запросы на создание дополнительных фильтров для раздела отклоняются, а вызывающий код получает исключение.

Дополнительные сведения о квотах см. в статье [Квоты на служебную шину](service-bus-quotas.md).

## Дальнейшие действия

Дополнительную информацию об обмене сообщениями через служебную шину см. в следующих разделах.

- [Общие сведения об обмене сообщениями через служебную шину Azure уровня Premium (запись в блоге)](http://azure.microsoft.com/blog/introducing-azure-service-bus-premium-messaging/)
- [Общие сведения об обмене сообщениями через служебную шину Azure уровня Premium (Channel9)](https://channel9.msdn.com/Blogs/Subscribe/Introducing-Azure-Service-Bus-Premium-Messaging)
- [Основные сведения об обмене сообщениями через служебную шину](service-bus-messaging-overview.md)
- [Обзор архитектуры служебной шины Azure](service-bus-fundamentals-hybrid-solutions.md)
- [Как использовать очереди служебной шины](service-bus-dotnet-get-started-with-queues.md)

[классическом портале Azure]: http://manage.windowsazure.com

<!---HONumber=AcomDC_0608_2016-->