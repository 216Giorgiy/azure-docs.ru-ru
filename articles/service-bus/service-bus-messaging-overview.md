<properties
	pageTitle="Обмен сообщениями через служебную шину | Microsoft Azure"
	description="Обмен сообщениями через служебную шину: гибкая доставка данных в облаке"
	services="service-bus"
	documentationCenter=".net"
	authors="sethmanheim"
	manager="timlt"
	editor=""/>

<tags
	ms.service="service-bus"
	ms.workload="na"
	ms.tgt_pltfrm="na"
	ms.devlang="multiple"
	ms.topic="article"
	ms.date="12/09/2015"
	ms.author="sethm"/>


# Обмен сообщениями через служебную шину: гибкая доставка данных в облаке

Обмен сообщениями через служебную шину Azure — это надежная служба доставки информации. Она предназначена для упрощения связи. Если двум или более сторонам необходимо обмениваться информацией, им требуется механизм связи. Обмен сообщениями через Service Bus — это механизм обмена данными через посредника или третью сторону. Работа этой службы аналогична работе почтовой службы в реальном мире. Почтовая служба упрощает отправку писем и посылок разных типов и гарантирует доставку практически в любую точку мира.

Подобно доставке писем в почтовой службе, обмен сообщениями через служебную шину обеспечивает гибкую доставку информации как отправителя, так и получателя. Служба обмена сообщениями обеспечивает доставку информации, даже если обе стороны никогда не бывают в сети в то одно и то же время или если они недоступны в один момент времени. Таким образом, принцип обмена сообщениями аналогичен принципу отправки писем, а связь без посредников подобна телефонному звонку (или тому, каким звонок был раньше, когда не было ожидания звонка и идентификатора звонящего, из-за которых это больше напоминает обмен сообщениями через посредника).

Кроме того, у отправителя сообщения может быть множество требований к характеристикам доставки, в том числе к транзакциям, обнаружению повторений, прекращению действия на основе времени и пакетной обработке. У этих шаблонов также есть почтовые аналоги: повторная доставка, обязательная подпись, изменение адреса или отзыв.

Служебная шина поддерживает два различных шаблона обмена сообщениями: обмен сообщениями *с ретрансляцией* и обмен сообщениями *через посредника*.

## Обмен сообщениями с ретрансляцией

Компонент [ретрансляции](service-bus-relay-overview.md) служебной шины — это централизованная (но обладающая высокоэффективной балансировкой нагрузки) служба, поддерживающая различные транспортные протоколы и стандарты веб-служб. К ним относятся SOAP, WS-* и даже REST. [Служба ретрансляции](service-bus-dotnet-how-to-use-relay.md) предоставляет разнообразные варианты подключения для ретрансляции и позволяет согласовывать подключения одноранговой сети, если это возможно. Служебная шина оптимизирована для разработчиков .NET, использующих Windows Communication Foundation (WCF), как с точки зрения производительности, так и с точки зрения удобства и обеспечивает полный доступ к службе ретрансляции через интерфейсы SOAP и REST. Это позволяет интегрировать со служебной шиной любую программную среду SOAP или REST.

Служба ретрансляции поддерживает традиционную одностороннюю передачу сообщений, обмен сообщениями на основе запроса/ответа и децентрализованный обмен сообщениями. Она также поддерживает распространение событий по сети Интернет для поддержки сценариев публикации/подписки и двунаправленного обмена данными по сокетам, что позволяет повысить эффективность соединений типа «точка — точка». В схеме обмена сообщениями с ретрансляцией локальная служба подключается к службе ретрансляции через исходящий порт и создает сокет для двунаправленного обмена данными с привязкой к конкретному адресу встречи. После этого клиент может обмениваться данными с локальной службой, отправляя сообщения в службу ретрансляции, которая перенаправит их по нужному адресу. Служба ретрансляции "ретранслирует" сообщения в локальную службу через созданный сокет двунаправленного обмена данными. Клиенту не требуются прямое подключение к локальной службе и информация о ее местонахождении, а локальной службе не требуется открывать на брандмауэре входящие порты.

Подключение между локальной службой и службой ретрансляции создается с помощью привязок WCF для ретрансляции. Привязки для ретрансляции сопоставляются в фоновом режиме с элементами привязки транспорта, предназначенными для создания компонентов канала WCF, которые интегрируются со служебной шиной в облаке.

Обмен сообщениями с ретрансляцией предоставляет множество преимуществ, но требует, чтобы сервер и клиент находились в сети одновременно для отправки и получения сообщений. Это не является оптимальным ни для подключений типа HTTP, в которых запросы обычно не существуют достаточно долго, ни для клиентов, подключающихся лишь время от времени, например браузеров, мобильных приложений и т. д. Обмен сообщениями через посредника поддерживает разделенный обмен данными, и он имеет свои преимущества; клиенты и серверы могут подключаться по необходимости и выполнять свои операции в асинхронном режиме.

## Обмен сообщениями через посредника

В отличие от обмена сообщениями с ретрансляцией [обмен сообщениями через брокер](service-bus-fundamentals-hybrid-solutions.md) можно считать асинхронным или «временно разделенным». Производители (отправители) и потребители (получатели) не должны находиться в сети одновременно. Инфраструктура обмена сообщениями надежно хранит сообщения в «посреднике» (например, в очереди), пока принимающая сторона не будет готова к приему. Это позволяет разделять компоненты распределенного приложения как в плановых ситуациях, например для обслуживания, так и в экстренных случаях, чтобы исключить влияние сбоя одного компонента на систему в целом. Кроме того, принимающее приложение может подключаться к сети только в определенное время дня, например система управления запасами, которую необходимо запускать только в конце рабочего дня.

Основные компоненты инфраструктуры обмена сообщениями через посредника для служебной шины — это очереди, темы и подписки. Главное различие состоит в том, что темы поддерживают возможности публикации и подписки, которые могут использоваться для сложных логик маршрутизации и доставки на основе содержимого, в том числе для отправки нескольким получателям. Эти компоненты позволяют реализовать новые асинхронные сценарии обмена сообщениями, такие как временное отключение, публикация, подписка и балансировка нагрузки. Дополнительные сведения об этих компонентах см. в статье [Очереди, разделы и подписки служебной шины](service-bus-queues-topics-subscriptions.md).

Как и в случае с обменом сообщениями с ретрансляцией, возможности обмена сообщениями через посредника предоставляются для программистов WCF и .NET Framework, а также для REST.

## Дальнейшие действия

Дополнительную информацию об обмене сообщениями через служебную шину см. в следующих разделах.

- [Очереди, разделы и подписки служебной шины](service-bus-queues-topics-subscriptions.md)
- [Базовая информация о Service Bus](service-bus-fundamentals-hybrid-solutions.md)
- [Архитектура служебной шины](service-bus-architecture.md)
- [Использование очередей служебной шины](service-bus-dotnet-how-to-use-queues.md)
- [Использование разделов служебной шины](service-bus-dotnet-how-to-use-topics-subscriptions.md)
 

<!---HONumber=AcomDC_1217_2015-->