<properties
	pageTitle="Мониторинг учетной записи DocumentDB на портале Azure | Microsoft Azure"
	description="Узнайте, как отслеживать метрики производительности, например запросы и ошибки сервера, и метрики использования, такие как использованный объем хранилища, для учетной записи DocumentDB."
	services="documentdb"
	documentationCenter=""
	authors="mimig1"
	manager="jhubbard"
	editor="cgronlun"/>

<tags
	ms.service="documentdb"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="03/10/2016"
	ms.author="mimig"/>

# Отслеживание данных об использовании для учетной записи DocumentDB на портале Azure

Вы можете отслеживать свои учетные записи DocumentDB на [портале Microsoft Azure](https://portal.azure.com/). Для каждой учетной записи DocumentDB доступны метрики производительности, такие как запросы и ошибки сервера, и использования, например потребление памяти.

## Просмотр метрик производительности для учетной записи DocumentDB
1.	На [портале Azure](https://portal.azure.com/) выберите **Обзор**, затем **Учетные записи DocumentDB**, а затем щелкните имя той учетной записи DocumentDB, для которой хотите просмотреть метрики производительности.
2.	В области **мониторинга** по умолчанию можно просмотреть следующее:
	*	общее число запросов для текущего дня;
	*	данные об использовании хранилища для учетной записи.

	Если в таблице отображается сообщение **Нет данных**, см. раздел [Устранение неполадок](#troubleshooting).

	![Снимок экрана: представление "Мониторинг", где показано общее число запросов за сегодня и данные об использовании хранилища](./media/documentdb-monitor-accounts/documentdb-total-requests-and-usage.png)


3.	Если щелкнуть раздел **Всего запросов** или **Хранилище**, откроется колонка подробных сведений **Метрика**.
4.	Выноска **Метрика** содержит сведения о выбранных вами метриках. В верхнем разделе колонки содержится граф, а ниже — таблица со сводными значениями по выбранным метрикам, например среднее, минимум, максимум и всего. На выноске "Метрика" также отображается список заданных оповещений, отфильтрованных по метрикам, отображающимся в текущей выноске "Метрика" (таким образом при наличии большого числа оповещений вы увидите только те, которые относятся к представленным здесь метрикам).   

	![Снимок экрана: выноска "Метрика"](./media/documentdb-monitor-accounts/documentdb-metric-blade.png)


## Настройка представлений метрик производительности для учетной записи DocumentDB

1.	Чтобы настроить метрики, отображаемые в определенном разделе, щелкните правой кнопкой мыши диаграмму с метриками и выберите пункт **Изменить диаграмму**. ![Снимок экрана: диаграмма "Общее количество запросов" с выделенной кнопкой "Изменить диаграмму"](./media/documentdb-monitor-accounts/madocdb3.png)

2.	На выноске **Изменение диаграммы** присутствуют параметры для изменения метрик, отображаемых в данном разделе, и их временного диапазона. ![Снимок экрана: выноска "Изменение диаграммы"](./media/documentdb-monitor-accounts/madocdb4.png)

3.	Чтобы изменить отображаемые в этом разделе метрики, просто установите или снимите флажки для доступных метрик производительности, а затем нажмите кнопку **Сохранить** в нижней части выноски.
4.	Чтобы изменить временной диапазон, выберите новый диапазон (например, **Другой**), а затем нажмите кнопку **Сохранить** внизу колонки.  

	![Снимок экрана: часть диапазона времени выноски "Изменение диаграммы" с демонстрацией ввода настраиваемого временного диапазона](./media/documentdb-monitor-accounts/madocdb5.png)


## Создание параллельных диаграмм метрик производительности
На портале Azure можно создавать параллельные диаграммы метрик.

1.	Сначала щелкните ту диаграмму, которую вы хотите клонировать и изменить, и выберите **Настроить**.

	![Снимок экрана: диаграмма "Общее количество запросов" с выделенным параметром "Настроить"](./media/documentdb-monitor-accounts/madocdb6.png)

2.	Выберите в меню элемент **Клонировать**, чтобы скопировать раздел, а затем выберите **Настройка завершена**.

	![Снимок экрана: диаграмма "Общее количество запросов" с выделенным параметрами "Клонировать" и "Готово"](./media/documentdb-monitor-accounts/madocdb7.png)


Теперь этот раздел можно использовать как любой другой раздел метрик, настраивая отображаемые в этом разделе метрики и диапазон времени. После этого вы увидите две разные диаграммы метрики, отображаемые параллельно. ![Снимок экрана: диаграмма "Общее количество запросов" и новая диаграмма "Общее количество запросов" через час](./media/documentdb-monitor-accounts/madocdb8.png)

## Настройка оповещений метрик производительности для учетной записи DocumentDB
1.	На [портале Azure](https://portal.azure.com/) выберите **Просмотреть все**, затем **Учетные записи DocumentDB**, а затем щелкните имя учетной записи DocumentDB, для которой хотите настроить оповещения по метрикам производительности.

2.	Если колонка **Все параметры** не открыта, щелкните команду **Параметры** в верхнем левом углу, чтобы открыть эту колонку. ![Снимок экрана команды "Параметры" в колонке "Учетная запись базы данных"](./media/documentdb-monitor-accounts/madocdb10.png)

3.	В колонке **Все параметры** щелкните **Правила оповещения**, чтобы открыть колонку "Правила оповещения". ![Снимок экрана с выбранной частью "Правила оповещения"](./media/documentdb-monitor-accounts/madocdb10.5.png)

4.	В колонке «Оповещения» выберите команду **Добавить оповещение**. ![Снимок экрана: выноска "Правила оповещений" с выделенной кнопкой "Добавить оповещения"](./media/documentdb-monitor-accounts/madocdb11.png)

5.	На выноске **добавления правила оповещения** укажите следующее:
	*	имя настраиваемого правила оповещения;
	*	описание нового правила оповещения;
	*	метрику для правила оповещения;
	*	условие, пороговое значение и период для активации оповещения (например, более 5 ошибок сервера за последние 15 минут);
	*	следует ли оповещать администратора службы и соадминистраторов по электронной почте при срабатывании оповещения;
	*	дополнительные адреса для оповещений электронной почты. ![Снимок экрана: выноска "Добавление правила оповещения"](./media/documentdb-monitor-accounts/madocdb12.png)

## Другие способы мониторинга DocumentDB
Доступные на портале метрики уровня учетной записи, такие как данные об использовании хранилища учетной записи и общее число запросов, недоступны через API-интерфейсы DocumentDB. Тем не менее, можно получить данные об использовании на уровне коллекции. Чтобы получить данных на уровне коллекции, выполните следующие действия:

- Чтобы использовать REST API, [выполните запрос GET для коллекции](https://msdn.microsoft.com/library/mt489073.aspx). Квота и данные об использовании коллекции возвращаются в заголовке ответа x-ms-resource-quota и x-ms-resource-usage headers.
- Чтобы использовать пакет SDK для .NET, воспользуйтесь методом [DocumentClient.ReadDocumentCollectionAsync](https://msdn.microsoft.com/library/microsoft.azure.documents.client.documentclient.readdocumentcollectionasync.aspx), возвращающим объект [ResourceResponse](https://msdn.microsoft.com/library/dn799209.aspx), который содержит ряд свойств использования, например **CollectionSizeUsage**, **DatabaseUsage**, **DocumentUsage** и прочие.

## Устранение неполадок
Если в элементах отслеживания отображается сообщение **Нет данных**, при том что вы недавно выполняли запросы или добавляли данные в базу данных, можно изменить элементы для отражения последних данных об использовании.

### Изменение плитки для обновления текущих данных
1.	Чтобы настроить метрики, отображаемые в определенном разделе, щелкните правой кнопкой мыши диаграмму с метриками и выберите пункт **Изменить диаграмму**. ![Снимок экрана: плитка "Всего запросов" с сообщением "Нет данных"](./media/documentdb-monitor-accounts/documentdb-no-available-data.png)

2.	В колонке **Изменение диаграммы** в разделе **Диапазон времени** щелкните **за последний час**, а затем нажмите кнопку **Сохранить**. ![Снимок экрана: колонка "Изменение диаграммы" с выбранным вариантом "за последний час"](./media/documentdb-monitor-accounts/documentdb-no-available-data-past-hour.png)


3.	Элемент должен обновиться: теперь в нем должны отображаться текущие данные и сведения об использовании. ![Снимок экрана: обновленная плитка "Всего запросов" с данными за последний час](./media/documentdb-monitor-accounts/documentdb-no-available-data-fixed.png)

## Дальнейшие действия
Дополнительные сведения о емкости DocumentDB см. в разделе [Управление емкостью DocumentDB](documentdb-manage.md).

<!---HONumber=AcomDC_0316_2016-->