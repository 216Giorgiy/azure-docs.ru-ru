<properties 
	pageTitle="DocumentDB — пропускная способность — хранилище документов | Microsoft Azure" 
	description="Дополнительные сведения о хранилище данных и документов в DocumentDB и масштабировании DocumentDB в соответствии с требованиями вашего приложения." 
	keywords="хранилище документов"
	services="documentdb" 
	authors="mimig1" 
	manager="jhubbard" 
	editor="cgronlun" 
	documentationCenter=""/>

<tags 
	ms.service="documentdb" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/27/2016" 
	ms.author="mimig"/>

# Дополнительные сведения о хранилище документов и пропускной способности см. в DocumentDB
DocumentDB — это полностью управляемая, масштабируемая служба базы данных NoSQL для документов JSON. Благодаря DocumentDB вам не нужно арендовать виртуальные машины, развертывать программное обеспечение, отслеживать работу баз данных и беспокоиться об аварийном восстановлении. Система DocumentDB обслуживается и непрерывно контролируется инженерами корпорации Майкрософт, что позволяет добиться доступности, производительности и защиты данных мирового уровня.

Чтобы приступить к работе с DocumentDB, [создайте учетную запись базы данных](documentdb-create-account.md) на [портале Azure](https://portal.azure.com/). DocumentDB предлагается в виде единиц, представленных хранилищем на базе твердотельных накопителей (SSD) и пропускной способностью. Эти единицы настраиваются путем создания коллекций баз данных в учетной записи базы данных. Каждая коллекция включает 10 ГБ хранилища базы данных и зарезервированную пропускную способность. При изменении требований вашего приложения к пропускной способности динамически измените ее, выбрав подходящий [уровень производительности](documentdb-performance-levels.md) для каждой коллекции.

Если приложение превышает уровни производительности для одной или нескольких коллекций, будет выполнено регулирование запросов для каждой коллекции. Это значит, что некоторые запросы приложения могут выполняться успешно, а к другим может быть применено регулирование.

В этой статье содержится обзор ресурсов и показателей, доступных для управления пропускной способностью и планирования хранилища данных.

## Учетная запись базы данных и административные ресурсы
Являясь подписчиком Azure, вы можете подготовить к работе одну или несколько учетных записей базы данных DocumentDB. Для каждой учетной записи базы данных предусмотрены квоты на административные ресурсы, включая базы данных, пользователей и разрешения. На эти ресурсы распространяются [ограничения и квоты](documentdb-limits.md). Если вам нужны дополнительные административные ресурсы, [обратитесь в службу поддержки](documentdb-increase-limits.md).

Портал Azure предоставляет показатели использования для мониторинга учетных записей базы данных, баз данных и коллекций. Дополнительные сведения см. в разделе [Мониторинг учетной записи DocumentDB](documentdb-monitor-accounts.md).

## Базы данных с неограниченным хранилищем документов
Отдельная база данных DocumentDB может содержать практически неограниченное хранилище документов, разделенное на коллекции. Коллекции образуют домены транзакций для документов, содержащихся в них. Неотъемлемой чертой базы данных DocumentDB является гибкость, позволяющая использовать SSD-хранилище документов размером от нескольких гигабайт до нескольких терабайт и предусмотренную пропускную способность. В отличие от традиционных реляционных СУБД базы данных в DocumentDB не ограничены одним узлом.

Благодаря DocumentDB по мере роста вашего приложения вы можете создать больше коллекций или баз данных, либо и то, и другое. Различные собственные приложения корпорации Майкрософт используют DocumentDB в потребительском масштабе, создавая чрезвычайно большие базы данных DocumentDB, каждая из которых содержит сотни или тысячи коллекций с терабайтами хранимых документов. Вы можете увеличить или уменьшить базу данных, добавляя или удаляя коллекции для удовлетворения требований масштабности вашего приложения.

## Коллекции базы данных
Каждая база данных DocumentDB может содержать одну или несколько коллекций. Коллекции выступают в качестве высокодоступных разделов для хранения и обработки данных. В каждой коллекции могут храниться документы с разнородными схемами. Автоматическое индексирование DocumentDB и возможность выполнять запросы позволяют с легкостью фильтровать и извлекать документы. Коллекция обеспечивает область для хранения документов и выполнения запросов. Коллекция также является доменом транзакций для всех входящих в ее состав документов. Коллекции определяются пропускной способностью на основе указанного уровня производительности. Он может быть настроен динамически через портал Azure или один из пакетов SDK.

Вы можете создать любое количество коллекций в соответствии с требованиями масштабируемости к хранилищу данных и пропускной способности, предъявляемыми вашими приложениями. Коллекции можно создать на [портале Azure](https://portal.azure.com/) или с помощью любого [пакета SDK для DocumentDB](documentdb-sdk-dotnet.md).

>[AZURE.NOTE] Каждая коллекция поддерживает хранилище для данных документов объемом до 10 ГБ. Наборы данных большего размера необходимо разбивать на несколько коллекций. Дополнительные сведения см. в статье [Секционирование данных в DocumentDB с помощью пакета SDK для .NET](documentdb-sharding.md).
 
## Единицы запросов и операции базы данных
DocumentDB позволяет выполнять обширный набор операций базы данных, включая реляционные и иерархические запросы с использованием UDF, хранимых процедур и триггеров, для документов в коллекции базы данных. Затраты на обработку, связанные с каждой из этих операций, зависят от типа процессора, операций ввода-вывода и объема памяти для выполнения операции. Вместо того чтобы думать о закупке и управлении аппаратными ресурсами, вы можете думать о единице запроса (RU) как единой меры для ресурсов, необходимых для выполнения различных операций с базами данных и обслуживания запросов приложений.

Единицы запросов подготавливаются и назначаются в зависимости от установленного для коллекции уровня производительности. После создания для каждой коллекции определяется уровень производительности. Он определяет производительность обработки коллекции в количестве запросов в секунду. Для адаптации к меняющимся потребностям обработки и получения доступа к шаблонам вашего приложения уровни производительности можно настраивать на протяжении жизненного цикла коллекции. Дополнительные сведения см. в статье [Уровни производительности DocumentDB](documentdb-performance-levels.md).

>[AZURE.IMPORTANT] За коллекции взимается плата. Стоимость определяется уровнем производительности, назначенным коллекции.

Удельный расход единиц запросов оценивается в расчете на одну секунду. Для приложений, которые превышают подготовленный показатель единиц запросов для коллекции, будет применяться функция регулирования запросов до тех пор, пока их значение не станет ниже зарезервированного уровня. Если приложению требуется более высокий уровень пропускной способности, вы можете настроить уровень производительности существующих коллекций или распределить запросы приложений среди новых коллекций.

Единица запроса — это нормализованная мера стоимости обработки запросов. Одна единица запроса соответствует вычислительной мощности, необходимой для чтения (через ссылку self) документа JSON размером 1 КБ, состоящего из 10 уникальных значений свойств. Эти накладные расходы на единицу запроса предполагают, что установлен уровень согласованности по умолчанию Session и все документы индексируются автоматически. Запрос на вставку, замену или удаление того же документа будет использовать дополнительные вычислительные ресурсы службы и поэтому потребует больше единиц запросов. Каждый ответ от службы включает пользовательский заголовок (x-ms-request-charge), который измеряет количество затрачиваемых на данный запрос единиц запросов. Этот заголовок также доступен и в [пакетах SDK](documentdb-sdk-dotnet.md). В пакете .NET SDK RequestCharge является свойством объекта ResourceResponse.

>[AZURE.NOTE] Базовый план 1 единицы запроса для документа размером 1 КБ соответствует простой команде GET по ссылке self этого документа.

На расход единиц запросов на выполнение операций в учетной записи базы данных DocumentDB влияет несколько факторов. К ним относятся:

- Размер документа. По мере увеличения размера документа увеличивается и число единиц запросов, расходуемых на чтение или запись данных.
- Число свойств. Если все свойства индексируются, число единиц запросов, расходуемых на запись документа, увеличивается вместе с увеличением количества свойств.
- Согласованность данных. При использовании уровней согласованности данных Strong или Bounded Staleness на чтение документов расходуются дополнительные единицы запросов.
- Индексированные свойства. Свойства, которые индексируются по умолчанию, определяются политикой индексирования для каждой коллекции. Вы можете сократить потребление единиц запросов, ограничив количество индексируемых свойств. 
- Индексирование документов. По умолчанию каждый документ индексируется автоматически. Исключение некоторых документов из этого процесса позволяет сэкономить единицы запросов.

Запросы, хранимые процедуры и триггеры расходуют единицы запросов с учетом сложности выполняемых операций. При разработке приложения проверяйте заголовок со стоимостью в единицах запросов, чтобы лучше понять, как эти ресурсы используются каждой из операций.

## Выбор уровня согласованности и пропускной способности
Выбор уровня согласованности по умолчанию влияет на производительность и задержки. Вы можете установить уровень согласованности по умолчанию как с помощью программных средств, так и на портале Azure. Вы также можете переопределить уровень согласованности для каждого запроса. По умолчанию, уровень согласованности определен на уровне сеанса, что обеспечивает монотонное чтение/запись и гарантированное чтение записанных данных. Согласованность уровня Session отлично подходит для приложений, ориентированных на пользователей, и предлагает оптимальный компромисс между согласованностью и производительностью.

Инструкции по изменению уровня согласованности на портале Azure см. в разделе [Управление учетной записью DocumentDB](documentdb-manage-account.md#consistency). Дополнительные сведения об уровнях согласованности см. в разделе [Использование уровней согласованности](documentdb-consistency-levels.md).

## Подготавливаемое хранилище документов и затраты на индексирование
С каждой созданной коллекцией подготавливаются 10 ГБ резервного хранилища документов на базе SSD. В эти 10 ГБ включено как место для хранения собственно документов, так и место для хранения индекса. По умолчанию коллекция DocumentDB настроена на автоматическое индексирование всех документов без явного указания вторичных индексов или схем. В зависимости от приложения, использующего DocumentDB, обычные затраты на индекс составляют от 2 до 20 %. Технология индексирования, используемая DocumentDB, гарантирует, что, независимо от значений свойств, показатель накладных расходов не превышает 80 % от размера документов с параметрами по умолчанию.

По умолчанию все документы индексируются DocumentDB автоматически. Однако если вы хотите уменьшить расходы на индексирование, вы можете отменить индексацию некоторых документов. Это можно сделать при вставке или замене документа, следуя инструкциям в статье [Политики индексации DocumentDB](documentdb-indexing-policies.md). Вы можете настроить коллекцию DocumentDB чтобы исключить все документы в коллекции от индексации. Вы также можете настроить выборочную индексацию коллекции DocumentDB, например индексацию определенных свойств или путей в документах JSON (используются подстановочные знаки). См. раздел [Настройка политики индексации коллекции](documentdb-indexing-policies.md#configuring-the-indexing-policy-of-a-collection). Исключение свойств или документов их индексирования также улучшает пропускную способность записи, это значит, вы будете потреблять меньшее количество единиц запросов.
 
## Дальнейшие действия
Инструкции по мониторингу уровней производительности на портале Azure см. в статье [Мониторинг учетной записи DocumentDB](documentdb-monitor-accounts.md).

Дополнительные сведения о выборе уровней производительности коллекций см. в статье [Уровни производительности в DocumentDB](documentdb-performance-levels.md).
 

<!---HONumber=AcomDC_0128_2016-->