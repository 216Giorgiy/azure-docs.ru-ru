---
title: "Создание мобильных приложений с помощью Xamarin и Azure DocumentDB | Документация Майкрософт"
description: "В этом руководстве описывается создание приложений с помощью Xamarin iOS, Android или Forms, а также Azure DocumentDB. DocumentDB — это быстро растущая облачная база данных глобального масштаба для мобильных приложений."
services: documentdb
documentationcenter: .net
author: arramac
manager: monicar
editor: 
ms.assetid: ff97881a-b41a-499d-b7ab-4f394df0e153
ms.service: documentdb
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/20/2017
ms.author: arramac
translationtype: Human Translation
ms.sourcegitcommit: 424d8654a047a28ef6e32b73952cf98d28547f4f
ms.openlocfilehash: 4a783397b038b7545bbbfc45813db3d9973c5e19
ms.lasthandoff: 03/22/2017


---
# <a name="build-mobile-applications-with-xamarin-and-azure-documentdb"></a>Создание мобильных приложений с помощью Xamarin и Azure DocumentDB
Большинство мобильных приложений хранят данные в облаке, а Azure DocumentDB — одна из облачных баз данных для мобильных приложений. В ней есть все, что необходимо для разработчика мобильных приложений. Это полностью управляемая база данных NoSQL как услуга, которая масштабируется по запросу и может прозрачно передавать ваши данные пользователям, где бы они ни находились, непосредственно в ваше приложение. С помощью [пакета SDK Azure DocumentDB для .NET Core](documentdb-sdk-dotnet-core.md) можно настроить в мобильных приложениях Xamarin взаимодействие непосредственно с DocumentDB без служб среднего уровня.

В этой статье содержится руководство по созданию мобильных приложений с помощью Xamarin и DocumentDB. Полный исходный код для руководства можно найти в материалах по [Xamarin и DocumentDB на сайте GitHub](https://github.com/Azure/azure-documentdb-dotnet/tree/master/samples/xamarin). Помимо прочего, этот код включает возможности управления пользователями и разрешениями.

## <a name="documentdb-capabilities-for-mobile-apps"></a>Возможности DocumentDB для мобильных приложений
DocumentDB предоставляет следующие основные возможности для разработчиков мобильных приложений:

![Возможности DocumentDB для мобильных приложений](media/documentdb-mobile-apps-with-xamarin/documentdb-for-mobile.png)

* Широкие возможности запросов к данным без схемы. DocumentDB хранит данные в виде бессхемных документов JSON в разнородных коллекциях, а также предлагает [запросы с широкими возможностями и обеспечивает их быстрое выполнение](documentdb-sql-query.md), так что вам не нужно беспокоиться о схеме или индексах.
* Быстрота. Гарантия. Для чтения и записи документов с помощью DocumentDB достаточно нескольких миллисекунд. Разработчики могут указать необходимую пропускную способность, и DocumentDB учтет ее в 99,99 % соглашений об уровне обслуживания.
* Безграничные возможности масштабирования. Коллекции DocumentDB [увеличиваются по мере расширения приложения](documentdb-partition-data.md). Вы можете начать с данных небольшого объема и сотни запросов в секунду и достичь какой угодно пропускной способности (например, 10 или 100 миллионов запросов в секунду) и объема данных в несколько петабайт.
* Глобальное распределение. Пользователи мобильных приложений перемещаются по всему миру. DocumentDB — это [глобально распределенная база данных](documentdb-distribute-data-globally.md), и с помощью одного-единственного щелчка на карте она предоставит пользователям данные в любой точке мира.
* Встроенные средства для расширенной проверки подлинности. С помощью DocumentDB можно легко реализовать популярные возможности, например [данные пользователей](https://aka.ms/documentdb-xamarin-todouser) или многопользовательские общие данные без настраиваемого сложного кода проверки подлинности.
* Геопространственные запросы. Многие мобильные приложения включают геоконтекстные возможности уже сегодня. Благодаря первоклассной поддержке [геопространственных типов](documentdb-geospatial.md) DocumentDB позволяет с легкостью реализовать эти возможности.
* Двоичные вложения. Данные приложения часто включают большие двоичные объекты. Встроенная поддержка вложений упрощает использование DocumentDB как центра служб для данных приложения.

## <a name="documentdb-and-xamarin-tutorial"></a>Руководство по DocumentDB и Xamarin
В этом руководстве описывается создание мобильного приложения с помощью Xamarin и DocumentDB за пять простых шагов. Полный исходный код для руководства можно найти в [материалах по Xamarin и DocumentDB на сайте GitHub](https://github.com/Azure/azure-documentdb-dotnet/tree/master/samples/xamarin).

### <a name="get-started"></a>Приступая к работе
Начать работу с DocumentDB очень просто. Просто перейдите на портал Azure, создайте новую учетную запись DocumentDB, затем перейдите на вкладку быстрого запуска и скачайте пример списка дел Xamarin Forms, который уже подключен к учетной записи DocumentDB. 

![Быстрый запуск DocumentDB для мобильных приложений](media/documentdb-mobile-apps-with-xamarin/documentdb-quickstart.png)

Или же, если у вас есть приложение Xamarin, вы можете просто добавить этот [пакет NuGet для DocumentDB](documentdb-sdk-dotnet-core.md). DocumentDB поддерживает общие библиотеки для Xamarin.IOS, Xamarin.Android и Xamarin Forms.

### <a name="work-with-data"></a>Работа с данными
Записи данных хранятся в DocumentDB как бессхемные документы JSON в разнородных коллекциях. В одной коллекции можно хранить документы с разной структурой.

```cs
    var result = await client.CreateDocumentAsync(collectionLink, todoItem);
```

В проектах Xamarin можно использовать запросы LINQ к бессхемным данным:

```cs
    var query = await client.CreateDocumentQuery<ToDoItem>(collectionLink)
                    .Where(todoItem => todoItem.Complete == false)
                    .AsDocumentQuery();

    Items = new List<TodoItem>();
    while (query.HasMoreResults) {
        Items.AddRange(await query.ExecuteNextAsync<TodoItem>());
    }
```
### <a name="add-users"></a>Добавление пользователей
Как и многие примеры для начала работы, скачанный пример DocumentDB проходит проверку подлинности в службе с помощью главного ключа, жестко заданного в коде приложения. Это решение не подходит для приложения, которое должно выполняться за пределами локального эмулятора. Если злоумышленник получает главный ключ, все данные в учетной записи DocumentDB становятся скомпрометированными. Однако нам необходимо, чтобы у приложения был только доступ к записям пользователя, вошедшего в систему. DocumentDB позволяет разработчикам предоставлять приложениям доступ для чтения или чтения и записи в коллекции, наборе документов, сгруппированных по ключу раздела, или в конкретном документе. 

Ниже приведен пример того, как превратить наше приложение списка дел в многопользовательское приложение списка дел. 

* Добавьте функцию входа в свое приложение с помощью Facebook, Active Directory или любого другого поставщика.
* Создайте коллекцию DocumentDB UserItems с помощью ключа раздела /userId. Если указать ключ раздела для коллекции, DocumentDB сможет осуществлять неограниченное масштабирование по мере того, как растет количество пользователей приложения, а также выполнять быстрые запросы.
* Добавьте брокер маркера ресурса DocumentDB — простой веб-API, выполняющий проверку подлинности пользователей и выдающий временные маркеры для входа пользователей с правом доступа только к документам в разделе пользователя. В этом примере брокер маркера ресурса размещен в службе приложений.
* Измените приложение для проверки подлинности брокера маркера ресурса с помощью Facebook и запросите маркеры ресурса для вошедшего в систему пользователя Facebook, а затем получите доступ к данным пользователя в коллекции UserItems.  

Полный образец кода из этого примера можно найти в материалах по [брокеру маркера ресурса на сайте GitHub](http://aka.ms/documentdb-xamarin-todouser). Решение показано на схеме ниже.

![Пользователи DocumentDB и брокер разрешений](media/documentdb-mobile-apps-with-xamarin/documentdb-resource-token-broker.png)

Теперь, если нам нужно, чтобы два пользователя получили доступ к одному и тому же списку дел, мы добавим дополнительные разрешения к маркеру доступа в брокере маркера ресурса.

### <a name="scale-on-demand"></a>Масштабирование по необходимости
DocumentDB — это управляемая база данных как услуга. Вам не нужно беспокоиться о подготовке виртуальных машин или увеличении количества ядер по мере роста базы пользователей. Необходимо лишь указать для DocumentDB, сколько операций в секунду (пропускная способность) требуется для вашего приложения. Пропускную способность можно указать в единицах запроса в секунду (ЕЗ) на вкладке "Масштаб" на портале. Например, для чтения документа размером 1 КБ требуется 1 ЕЗ. Можно также настроить оповещения для метрики "Пропускная способность", чтобы отслеживать рост трафика и программно изменять пропускную способность при появлении предупреждений.

![Пропускная способность масштабирования по запросу в DocumentDB](media/documentdb-mobile-apps-with-xamarin/documentdb-scale.png)

### <a name="go-planet-scale"></a>Переход на глобальный масштаб
По мере роста популярности у вашего приложения могут появиться пользователи по всему миру. Или, возможно, вы просто не хотите потерять все данные, если вдруг в центр обработки данных Azure, в котором вы создали свою коллекцию DocumentDB, попадет метеорит. Перейдите на портал Azure. войдите в свою учетную запись DocumentDB, и, щелкнув по карте, настройте непрерывную репликацию своих данных в любое количество регионов по всему миру. Это гарантирует, что данные будут доступны везде, где находятся ваши пользователи, а вы сможете добавить политики отработки отказа, чтобы подготовиться к любым неожиданностям.

![Масштабирование DocumentDB в географических регионах](media/documentdb-mobile-apps-with-xamarin/documentdb-replicate-globally.png)

Поздравляем! Вы создали решение, и теперь у вас есть мобильное приложение, разработанное с помощью Xamarin и DocumentDB. Аналогичную схему работы можно применять в приложениях Cordova, в которых используется SDK JavaScript для DocumentDB, и собственных приложениях iOS или Android с использованием REST API для DocumentDB.

## <a name="next-steps"></a>Дальнейшие действия
* Просмотрите исходный код для [Xamarin и DocumentDB на сайте GitHub](https://github.com/Azure/azure-documentdb-dotnet/tree/master/samples/xamarin).
* Скачайте [пакет SDK DocumentDB для .NET Core](documentdb-sdk-dotnet-core.md).
* Ознакомьтесь с другими примерами кода для [приложений .NET](documentdb-dotnet-samples.md).
* Узнайте о [расширенных возможностях запросов в DocumentDB](documentdb-sql-query.md).
* Узнайте о [геопространственной поддержке в DocumentDB](documentdb-geospatial.md).




