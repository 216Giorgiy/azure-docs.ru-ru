<properties
	pageTitle="Восстановление баз данных с поддержкой переноса | Microsoft Azure"
	description="Узнайте, как восстанавливать базы данных с поддержкой переноса."
	services="sql-server-stretch-database"
	documentationCenter=""
	authors="douglaslMS"
	manager=""
	editor=""/>

<tags
	ms.service="sql-server-stretch-database"
	ms.workload="data-management"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="08/01/2016"
	ms.author="douglasl"/>

# Восстановление баз данных с поддержкой переноса

При необходимости можно восстановить резервную копию базы данных, чтобы восстановить данные после различного рода сбоев, ошибок и аварий.

Дополнительные сведения об архивации см. в разделе [Архивация баз данных с поддержкой переноса](sql-server-stretch-database-backup.md).

>   [AZURE.NOTE] Архивация — лишь часть полноценного решения, обеспечивающего высокий уровень доступности и непрерывность бизнес-процессов. Дополнительные сведения о высоком уровне доступности см. в разделе [Решения высокого уровня доступности (SQL Server)](https://msdn.microsoft.com/library/ms190202.aspx).

## Восстановление данных SQL Server
Для восстановления после сбоя или повреждения оборудования можно восстановить базу данных SQL Server с поддержкой переноса из резервной копии. Вы можете продолжить использовать методы восстановления SQL Server, применяемые в настоящее время. Дополнительные сведения см. в разделе [Обзор процессов восстановления (SQL Server)](https://msdn.microsoft.com/library/ms191253.aspx).

После восстановления базы данных SQL Server необходимо выполнить хранимую процедуру **sys.sp\_rda\_reauthorize\_db**, чтобы повторно установить подключение между базой данных SQL Server с поддержкой переноса и удаленной базой данных Azure. Дополнительные сведения см. в разделе [Восстановление подключения между базой данных SQL Server и удаленной базы данных Azure](#restore-the-connection-between-the-sql-server-database-and-the-remote-azure-database).

## Восстановление удаленных данных Azure

### Восстановление работающей базы данных Azure
Служба базы данных SQL Server Stretch в Azure создает моментальные снимки всех актуальных данных минимум каждые 8 часов, используя для этого моментальные снимки службы хранилища Azure. Эти снимки хранятся в течение семи дней. Это позволяет восстанавливать данные до одной из 21 точки во времени в пределах 7 дней до момента создания последнего моментального снимка.

Чтобы восстановить работающую базу данных Azure до более ранней точки во времени с помощью портала Azure, выполните следующие действия.

1. Войдите на портал Azure.
2. В левой части экрана выберите **ОБЗОР**, а затем — **Базы данных SQL**.
3. Перейдите к нужной базе данных и выберите ее.
4. В верхней части колонки базы данных щелкните **Восстановить**.
5. Укажите новое значение в поле **Имя базы данных**, выберите **точку восстановления**, а затем нажмите кнопку **Создать**.
6. Начнется процесс восстановления базы данных, который можно отслеживать с помощью **уведомлений**.

### Восстановление удаленной базы данных Azure
Служба базы данных SQL Server Stretch в Azure создает моментальный снимок базы данных перед ее удалением и хранит его в течение 7 дней. По истечении 7 дней моментальные снимки работающей базы данных больше не хранятся. Это позволяет восстановить удаленную базу данных до точки, когда она была удалена.

Чтобы с помощью портала Azure восстановить удаленную базу данных Azure до точки, когда она была удалена, выполните следующие действия.

1. Войдите на портал Azure.
2. В левой части экрана выберите **ОБЗОР**, а затем — **Серверы SQL**.
3. Перейдите к нужному серверу и выберите его.
4. Прокрутите вниз колонку сервера до раздела "Операции" и щелкните элемент **Удаленные базы данных**.
5. Выберите удаленную базу данных, которую хотите восстановить.
5. Укажите новое значение в поле **Имя базы данных** и нажмите кнопку **Создать**.
6. Начнется процесс восстановления базы данных, который можно отслеживать с помощью **уведомлений**.

## Восстановление подключения между базой данных SQL Server и удаленной базы данных Azure

1.  Если вы собираетесь подключиться к восстановленной базе данных Azure с другим именем или в другом регионе, выполните хранимую процедуру [sys.sp\_rda\_deauthorize\_db](https://msdn.microsoft.com/library/mt703716.aspx) для отключения от предыдущей базы данных Azure.

2.  Выполните хранимую процедуру [sys.sp\_rda\_reauthorize\_db](https://msdn.microsoft.com/library/mt131016.aspx) для повторного подключения локальной базы данных с поддержкой переноса к базе данных Azure.

	-   Укажите учетные данные, действующие в существующей базе данных, как значение sysname или varchar(128). (Не используйте тип varchar(max).) Для поиска имени учетных данных можно использовать представление **sys.database\_scoped\_credentials**.

	-   Укажите, следует ли создать копию удаленных данных и подключиться к ней (рекомендуется).

    ```tsql  
    USE <Stretch-enabled database name>;
	GO
	EXEC sp_rda_reauthorize_db
	    @credential = N'<existing_database_scoped_credential_name>',
		@with_copy = 1 ;  
	GO
	```  

## См. также

[Управляйте растяжением баз данных и устраняйте неполадки](sql-server-stretch-database-manage.md)

[sys.sp\_rda\_reauthorize\_db (Transact-SQL)](https://msdn.microsoft.com/library/mt131016.aspx)

[Архивация и восстановление баз данных SQL Server](https://msdn.microsoft.com/library/ms187048.aspx)

<!---HONumber=AcomDC_0803_2016-->