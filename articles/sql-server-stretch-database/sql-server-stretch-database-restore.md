---
title: "Восстановление баз данных с поддержкой Stretch | Документация Майкрософт"
description: "Узнайте, как восстанавливать базы данных с поддержкой переноса."
services: sql-server-stretch-database
documentationcenter: 
author: douglaslMS
manager: jhubbard
editor: 
ms.assetid: 97fdf8d4-1d91-409f-bfce-755e15c79498
ms.service: sql-server-stretch-database
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/01/2016
ms.author: douglasl
translationtype: Human Translation
ms.sourcegitcommit: 2ea002938d69ad34aff421fa0eb753e449724a8f
ms.openlocfilehash: 7f892604d863225625c8d3b05bb4c8b985be7d5f


---
# <a name="restore-stretch-enabled-databases"></a>Восстановление баз данных с поддержкой переноса
При необходимости можно восстановить резервную копию базы данных, чтобы восстановить данные после различного рода сбоев, ошибок и аварий.

Дополнительные сведения об архивации см. в статье [Резервное копирование баз данных с поддержкой Stretch ](sql-server-stretch-database-backup.md).

> [!NOTE]
> Архивация — лишь часть полноценного решения, обеспечивающего высокий уровень доступности и непрерывность бизнес-процессов. Дополнительные сведения о высоком уровне доступности см. в [этой статье](https://msdn.microsoft.com/library/ms190202.aspx).
> 
> 

## <a name="restore-your-sql-server-data"></a>Восстановление данных SQL Server
Чтобы восстановить базу данных SQL Server с поддержкой Stretch после сбоя или повреждения оборудования, можно воспользоваться ее резервной копией. Вы можете продолжить использовать методы восстановления SQL Server, применяемые в настоящее время. Дополнительные сведения см. в разделе [Обзор процессов восстановления (SQL Server)](https://msdn.microsoft.com/library/ms191253.aspx).

После восстановления базы данных SQL Server необходимо выполнить хранимую процедуру **sys.sp_rda_reauthorize_db**, чтобы повторно установить подключение между базой данных SQL Server с поддержкой Stretch и удаленной базой данных Azure. Дополнительные сведения см. в разделе [Восстановление подключения между базой данных SQL Server и удаленной базой данных Azure](#restore-the-connection-between-the-sql-server-database-and-the-remote-azure-database).

## <a name="restore-your-remote-azure-data"></a>Восстановление удаленных данных Azure
### <a name="recover-a-live-azure-database"></a>Восстановление работающей базы данных Azure
Служба базы данных SQL Server Stretch в Azure создает моментальные снимки всех актуальных данных минимум каждые 8 часов, используя для этого моментальные снимки службы хранилища Azure. Эти снимки хранятся в течение семи дней. Это позволяет восстанавливать данные до одной из 21 точки во времени в пределах 7 дней до момента создания последнего моментального снимка.

Чтобы восстановить работающую базу данных Azure до более ранней точки во времени с помощью портала Azure, выполните следующие действия.

1. Войдите на портал Azure.
2. В левой части экрана выберите **Обзор**, а затем — **Базы данных SQL**.
3. Перейдите к нужной базе данных и выберите ее.
4. В верхней части колонки базы данных щелкните **Восстановить**.
5. Укажите новое **имя базы данных**, выберите **точку восстановления**, а затем щелкните **Создать**.
6. Начнется процесс восстановления базы данных, который можно отслеживать с помощью **уведомлений**.

### <a name="recover-a-deleted-azure-database"></a>Восстановление удаленной базы данных Azure
Служба базы данных SQL Server Stretch в Azure создает моментальный снимок базы данных перед ее удалением и хранит его в течение 7 дней. По истечении 7 дней моментальные снимки работающей базы данных больше не хранятся. Это позволяет восстановить удаленную базу данных до точки, когда она была удалена.

Чтобы с помощью портала Azure восстановить удаленную базу данных Azure до точки, когда она была удалена, выполните следующие действия.

1. Войдите на портал Azure.
2. В левой части экрана выберите **Обзор**, а затем — **Серверы SQL**.
3. Перейдите к нужному серверу и выберите его.
4. Прокрутите вниз колонку сервера до раздела "Операции" и щелкните элемент **Удаленные базы данных** .
5. Выберите удаленную базу данных, которую хотите восстановить.
6. Укажите новое **имя базы данных** и щелкните **Создать**.
7. Начнется процесс восстановления базы данных, который можно отслеживать с помощью **уведомлений**.

## <a name="restore-the-connection-between-the-sql-server-database-and-the-remote-azure-database"></a>Восстановление подключения между базой данных SQL Server и удаленной базы данных Azure
1. Если вы собираетесь подключиться к восстановленной базе данных Azure с другим именем или в другом регионе, выполните хранимую процедуру [sys.sp_rda_deauthorize_db](https://msdn.microsoft.com/library/mt703716.aspx), чтобы отключится от предыдущей базы данных Azure.  
2. Выполните хранимую процедуру [sys.sp_rda_reauthorize_db](https://msdn.microsoft.com/library/mt131016.aspx), чтобы повторно подключить локальную базу данных с поддержкой Stretch к базе данных Azure.  
   
   * Укажите учетные данные, действующие в имеющейся базе данных, как значение sysname или varchar\(128\). \(Не используйте тип varchar\(max\).\) Чтобы найти имя учетных данных, можно использовать представление **sys.database\_scoped\_credentials**.  
   * Укажите, следует ли создать копию удаленных данных и подключиться к ней (рекомендуется).  
   
   ```tsql  
   USE <Stretch-enabled database name>;
   GO
   EXEC sp_rda_reauthorize_db
       @credential = N'<existing_database_scoped_credential_name>',
       @with_copy = 1 ;  
   GO
   ```  

## <a name="see-also"></a>Дополнительные материалы
[Управляйте растяжением баз данных и устраняйте неполадки](sql-server-stretch-database-manage.md)

[sys.sp_rda_reauthorize_db (Transact-SQL)](https://msdn.microsoft.com/library/mt131016.aspx)

[Архивация и восстановление баз данных SQL Server](https://msdn.microsoft.com/library/ms187048.aspx)




<!--HONumber=Nov16_HO3-->


