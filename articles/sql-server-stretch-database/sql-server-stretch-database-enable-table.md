<properties
	pageTitle="Включение растяжения базы данных для таблицы | Microsoft Azure"
	description="Узнайте, как настроить таблицу для растяжения базы данных."
	services="sql-server-stretch-database"
	documentationCenter=""
	authors="douglaslMS"
	manager=""
	editor=""/>

<tags
	ms.service="sql-server-stretch-database"
	ms.workload="data-management"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="02/26/2016"
	ms.author="douglasl"/>

# Включение растяжения базы данных для таблицы

Чтобы настроить растяжение базы данных для таблицы, выберите **Растяжение | Включить** для таблицы в SQL Server Management Studio. После этого откроется мастер **Включение растяжения для таблицы**. Кроме того, с помощью Transact-SQL вы можете включить базу данных Stretch для существующей таблицы или создать новую таблицу с поддержкой базы данных Stretch.

-   Если исторические данные хранятся в отдельной таблице, можно выполнить миграцию всей таблицы.

-   Если таблица содержит как исторические, так и текущие данные, можно указать предикат фильтра для выбора строк для миграции.

**Предварительные требования**. Если при выборе **Растяжение | Включить** для таблицы вы не включили базу данных Stretch для базы данных, то мастер сначала настроит базу данных для базы данных Stretch. В этом случае следуйте указаниям в [мастере включения растяжения базы данных](sql-server-stretch-database-wizard.md) вместо действий, описанных в этом разделе.

**Разрешения**. Для включения растяжения базы данных для базы данных или таблицы требуются разрешения db\_owner. Для включения растяжения базы данных для таблицы также требуются разрешения ALTER для таблицы.

## <a name="EnableWizardTable"></a>Включение базы данных Stretch для таблицы с помощью мастера
**Запуск мастера**

1.  В среде SQL Server Management Studio в обозревателе объектов выберите таблицу, для которой необходимо включить растяжение.

2.  Щелкните по этой таблице правой кнопкой мыши и выберите **Растяжение**, а затем **Включить** для запуска мастера.

**Введение**

Проверьте назначение мастера и необходимые компоненты.

**Выбор таблиц базы данных**

Убедитесь, что необходимая таблица отображается и выбрана.

В версии-кандидате 3 можно перенести всю таблицу или указать простой предикат фильтра на основе даты. Если вы хотите использовать другой предикат фильтра, чтобы выбрать строки для переноса, выполните одну из следующих процедур.

-   Закройте мастер и выполните инструкцию ALTER TABLE, чтобы применить режим Stretch для таблицы и указать предикат.

-   Выполните инструкцию ALTER TABLE, чтобы указать предикат после выхода из мастера.

Синтаксис инструкции ALTER TABLE описывается далее в этом разделе.

**Сводка**

Просмотрите введенные значения и параметры, выбранные в мастере. Затем нажмите кнопку **Готово**, чтобы включить базу данных Stretch.

**Результат**

Просмотрите результаты.

## <a name="EnableTSQLTable"></a> Включение базы данных Stretch для таблицы с помощью Transact-SQL
Вы можете включить базу данных Stretch для существующей таблицы или создать новую таблицу с поддержкой базы данных Stretch с помощью Transact-SQL.

### Параметры
При выполнении CREATE TABLE или ALTER TABLE для включения базы данных Stretch для таблицы используйте следующие параметры.

-   При необходимости, если таблица содержит как исторические, так и текущие данные, добавьте предложение `FILTER_PREDICATE = <predicate>`, чтобы указать предикат фильтра для выбора строк для переноса. Предикат должен вызывать встроенную функцию табличных значений. Подробнее об этом: [Выбор строк для переноса с помощью предиката фильтра (база данных Stretch)](sql-server-stretch-database-predicate-function.md). Если не указать предикат фильтра, будет выполнена миграция всей таблицы.

    >   [AZURE.NOTE] Если указать предикат фильтра, который работает неэффективно, миграция данных также будет выполняться неэффективно. При растяжении базы данных предикат фильтра применяется к таблице с помощью оператора CROSS APPLY.

-   Укажите `MIGRATION_STATE = OUTBOUND` для немедленного запуска миграции данных или `MIGRATION_STATE = PAUSED`, чтобы отложить начало миграции данных.

### Включение базы данных Stretch для существующей таблицы
Чтобы настроить существующую таблицу для использования базы данных Stretch, выполните инструкцию ALTER TABLE.

Ниже приведен пример, при котором немедленно начинается миграция всей таблицы.

```tsql
ALTER TABLE <table name>
    SET ( REMOTE_DATA_ARCHIVE = ON ( MIGRATION_STATE = OUTBOUND ) ) ;
```
Ниже приведен пример, который переносит только те строки, которые идентифицируются встроенной функцией с табличными значениями `dbo.fn_stretchpredicate`, при этом перенос данных откладывается. Подробнее о предикате фильтра см. в разделе [Выбор строк для переноса с помощью предиката фильтра (база данных Stretch)](sql-server-stretch-database-predicate-function.md).

```tsql
ALTER TABLE <table name>
    SET ( REMOTE_DATA_ARCHIVE = ON (
        FILTER_PREDICATE = dbo.fn_stretchpredicate(date),
        MIGRATION_STATE = PAUSED ) );
```

Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](https://msdn.microsoft.com/library/ms190273.aspx).

### Создание новой таблицы с поддержкой базы данных Stretch
Чтобы создать новую таблицу с поддержкой базы данных Stretch, выполните команду CREATE TABLE.

Ниже приведен пример, при котором немедленно начинается миграция всей таблицы.

```tsql
CREATE TABLE <table name> ...
    WITH ( REMOTE_DATA_ARCHIVE = ON ( MIGRATION_STATE = OUTBOUND ) ) ;
```
Ниже приведен пример, который переносит только те строки, которые идентифицируются встроенной функцией с табличными значениями `dbo.fn_stretchpredicate`, при этом перенос данных откладывается. Подробнее о предикате фильтра см. в разделе [Выбор строк для переноса с помощью предиката фильтра (база данных Stretch)](sql-server-stretch-database-predicate-function.md).

```tsql
CREATE TABLE <table name> ...
    WITH ( REMOTE_DATA_ARCHIVE = ON (
        FILTER_PREDICATE = dbo.fn_stretchpredicate(date),
        MIGRATION_STATE = PAUSED ) );
```

Дополнительные сведения см. в разделе [CREATE TABLE (Transact-SQL)](https://msdn.microsoft.com/library/ms174979.aspx).


## См. также

[ALTER TABLE (Transact-SQL)](https://msdn.microsoft.com/library/ms190273.aspx)

[CREATE TABLE (Transact-SQL)](https://msdn.microsoft.com/library/ms174979.aspx)

<!---HONumber=AcomDC_0420_2016-->