<properties
   pageTitle="Включение прозрачного шифрования данных (TDE) для базы данных SQL Server Stretch в Azure TSQL | Microsoft Azure"
   description="Включение прозрачного шифрования данных (TDE) для базы данных SQL Server Stretch в Azure TSQL"
   services="sql-server-stretch-database"
   documentationCenter=""
   authors="douglaslMS"
   manager=""
   editor=""/>

.<tags
   ms.service="sql-server-stretch-database"
   ms.workload="data-management"
   ms.tgt_pltfrm="na"
   ms.devlang="na"
   ms.topic="article"
   ms.date="06/14/2016"
   ms.author="douglaslMS"/>

# Включение прозрачного шифрования данных (TDE) для базы данных Stretch в Azure (Transact-SQL)
> [AZURE.SELECTOR]
- [Портал Azure](sql-server-stretch-database-encryption-tde.md)
- [TSQL](sql-server-stretch-database-tde-tsql.md)

Прозрачное шифрование данных (TDE) помогает защититься от угрозы вредоносных атак за счет шифрования и расшифровки базы данных, связанных резервных копий и файлов журналов транзакций при хранении в реальном времени, не внося изменения в само приложение.

При использовании TDE хранилище всей базы данных шифруется с помощью симметричного ключа, который называется ключом шифрования базы данных. Ключ шифрования базы данных защищается встроенным сертификатом сервера. Каждый сервер Azure обладает уникальным встроенным сертификатом. Корпорация Майкрософт автоматически изменяет эти сертификаты не реже, чем раз в 90 дней. Общее описание TDE см. в статье [Прозрачное шифрование данных (TDE)].

##Включение шифрования

Чтобы включить прозрачное шифрование для базы данных Azure, где хранятся данные, перенесенные из Базы данных SQL Server Stretch, выполните следующее.

1. Подключитесь к базе данных *master* на сервере Azure, где находится база данных, указав имя входа администратора или члена роли **dbmanager** в базе данных master.
2. Выполните следующий оператор для шифрования базы данных:

```sql
ALTER DATABASE [database_name] SET ENCRYPTION ON;
```

##Отключение шифрования

Чтобы отключить прозрачное шифрование для базы данных Azure, где хранятся данные, перенесенные из Базы данных SQL Server Stretch, выполните следующее.

1. Подключитесь к *главной* базе данных, указав логин администратора или члена роли **dbmanager** в главной базе данных.
2. Выполните следующий оператор для шифрования базы данных:

```sql
ALTER DATABASE [database_name] SET ENCRYPTION OFF;
```

##Проверка шифрования

Чтобы проверить состояние шифрования для базы данных Azure, где хранятся данные, перенесенные из Базы данных SQL Server Stretch, выполните следующее.

1. Подключитесь к *главной* базе данных или к экземпляру базы данных, указав логин администратора или члена роли **dbmanager** в главной базе данных.
2. Выполните следующий оператор для шифрования базы данных:

```sql
SELECT
	[name],
	[is_encrypted]
FROM
	sys.databases;
```

Результат ```1``` означает зашифрованную, а ```0``` — незашифрованную базу данных.


<!--Anchors-->
[Прозрачное шифрование данных (TDE)]: https://msdn.microsoft.com/library/bb934049.aspx


.<!--Image references-->

.<!--Link references-->

<!---HONumber=AcomDC_0810_2016-->