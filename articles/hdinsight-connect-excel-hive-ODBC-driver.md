<properties linkid="manage-services-hdinsight-connect-excel-with-hive-ODBC" urlDisplayName="Connect Excel to HDInsight" pageTitle="Connect Excel to Hadoop with the Hive ODBC Driver | Azure" metaKeywords="" description="Learn how to set up and use the Microsoft Hive ODBC driver for Excel to query data in an HDInsight cluster." metaCanonical="" services="hdinsight" documentationCenter="" title="Connect Excel to Hadoop with the Microsoft Hive ODBC Driver" authors="bradsev" solutions="" manager="paulettm" editor="cgronlun" />

<tags ms.service="hdinsight" ms.workload="big-data" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="bradsev" />

# Подключение Excel к Hadoop с помощью драйвера Microsoft Hive ODBC

Одной из ключевых особенностей решения Майкрософт для работы с данными большого размера является полная интеграция компонентов бизнес-аналитики Майкрософт с кластерами Apache Hadoop, которые были развернуты с помощью Azure HDInsight. Примером такой интеграции является возможность подключения Excel к хранилищу данных Hive на кластере Hadoop в HDInsight с помощью драйвера Microsoft Hive ODBC.

Можно также подключить данные, связанные с кластером HDInsight, и другими источниками данных, включая другие кластеры Hadoop (не HDInsight) из Excel с использованием надстройки Microsoft Power Query для Excel. Сведения об установке и использовании Power Query см. в разделе [Подключение Excel к HDInsight с использованием Power Query][Подключение Excel к HDInsight с использованием Power Query]

**Предварительные требования**:

Перед началом работы с этой статьей необходимо иметь следующее:

-   Кластер HDInsight. Для настройки кластера ознакомьтесь с разделом [Приступая к работе с Azure HDInsight][Приступая к работе с Azure HDInsight].
-   Компьютер под управлением Windows 8, Windows 7, Windows Server 2012 или Windows Server 2008 R2.
-   Office 2013 профессиональный плюс, Office 365 профессиональный плюс, Excel 2013 автономный или Office 2010 профессиональный плюс.

## Содержание

1.  [Установка драйвера Microsoft Hive ODBC][Установка драйвера Microsoft Hive ODBC]
2.  [Создание источника данных Hive ODBC][Создание источника данных Hive ODBC]
3.  [Импорт данных в Excel из кластера HDInsight][Импорт данных в Excel из кластера HDInsight]
4.  [Дальнейшие действия][Дальнейшие действия]

## <span id="InstallHiveODBCDriver"></span></a>Установка драйвера Microsoft Hive ODBC

Загрузите и установите драйвер Microsoft Hive ODBC из [Центра загрузок][Центра загрузок].

Этот драйвер может быть установлен на 32-разрядной или 64-разрядной версии Windows 7, Windows 8, Windows Server 2008 R2 и Windows Server 2012. Он обеспечит подключение к Azure HDInsight (версии 1.6 и выше) и эмулятору Azure HDInsight (версии 1.0.0.0 и выше). Необходимо установить версию, которая соответствует версии приложения, где будет использоваться драйвер ODBC. В этом учебнике драйвер будет использоваться в Office Excel.

## <span id="CreateHiveODBCDataSource"></span></a>Создание источника данных Hive ODBC

Ниже показано, как создать источник данных Hive ODBC.

1.  В Windows 8 нажмите клавишу Windows, чтобы открыть начальный экран, затем введите **источники данных**.
2.  Нажмите кнопку **Настройка источников данных ODBC (32-разр.)** или **Настройка источников данных ODBC (64-разр.)** в зависимости от версии Office. Если вы используете Windows 7, выберите **Источники данных ODBC (32-разр.)** или **Источники данных ODBC (64-разр.)** в разделе **Администрирование**. Это приведет к запуску диалогового окна **Администратор источника данных ODBC**.

    ![Администратор источника данных ODBC][Администратор источника данных ODBC]

3.  Из DNS пользователя щелкните **Добавить**, чтобы открыть мастер **Создать новый источник данных**.
4.  Выберите **Драйвер Microsoft Hive ODBC** и щелкните **Готово**. Это приведет к открытию диалогового окна **Настройка DNS драйвера Microsoft Hive ODBC**.

5.  Введите или выберите следующие значения:

    
    | **Свойство**         | **Описание**                                                                                                                                                                                                  |
|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | Имя источника данных | Присвойте имя источнику данных                                                                                                                                                                                |
    | Узел                 | Введите <hdinsightclustername>.azurehdinsight.net. Например, myHDICluster.azurehdinsight.net                                                                                                                  |
    | Порт                 | Используйте **443**. (Этот порт был изменен с 563 на 443.)                                                                                                                                                    |
    | База данных          | Используйте **значение по умолчанию**.                                                                                                                                                                        |
    | Тип сервера Hive     | Выберите **Hive Server 2**                                                                                                                                                                                    |
    | Механизм             | Выберите **Служба Azure HDInsight**                                                                                                                                                                           |
    | Путь HTTP            | Оставьте пустым.                                                                                                                                                                                              |
    | Имя пользователя     | Введите имя пользователя кластера HDInsight. Это имя пользователя, созданное во время подготовки кластера. При использовании параметра быстрого создания именем пользователя по умолчанию является **admin**. |
    | Пароль               | Введите пароль пользователя кластера HDInsight.                                                                                                                                                               |

    Существует несколько важных параметров, о которых следует помнить при выборе пункта **Расширенные параметры**.


    | Использовать исходный запрос          | При выборе этого параметра драйвер ODBC НЕ будет пытаться преобразовать TSQL в HiveQL. Следует использовать только при 100% уверенности в отправке действительных инструкций HiveQL. При подключении к серверу SQL Server или базе данных Azure SQL необходимо снять этот флажок. |
	|---------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | Строки, загружаемые для каждого блока | При получении большого объема записей включение этого параметра может обеспечить оптимальную производительность.                                                                                                                                                                  |
    | Длина столбца строки по умолчанию,          Длина столбца двоичного кода,               Масштаб столбца десятичных значений   | Длина и точность типа данных может повлиять на способ выведения данных. Это приведет к возврату недопустимой информации вследствие потери точности и (или) усечения.                                                                                                              |

    ![Дополнительные параметры][Дополнительные параметры]

6.  Нажмите **Тест** для проверки источника данных. При правильной настройке источника данных здесь отображается *ТЕСТЫ УСПЕШНО ЗАВЕРШЕНЫ!*
7.  Нажмите **OK**, чтобы закрыть диалоговое окно Тест. Новый источник данных не должен быть указан в **администраторе источника данных ODBC**.
8.  Нажмите **OK**, чтобы завершить работу мастера.

## <span id="ImportData"></span></a>Импорт данных в Excel из кластера HDInsight

Ниже описан способ импорта данных из таблицы hive в рабочую книгу Excel с помощью источника данных ODBC, созданного ранее.

1.  Откройте новую или существующую рабочую книгу в Excel.
2.  На вкладке **Данные** щелкните плитку **Получить внешние данные**, щелкните **Из других источников данных**, а затем щелкните **Из мастера подключения к данным**, чтобы запустить **Мастер подключения к данным**.

    ![Мастер подключения к данным][Мастер подключения к данным]

3.  Выберите **ODBC DSN** в качестве источника данных и затем щелкните **Далее**.
4.  В источниках данных ODBC выберите имя источника данных, которое было создано на предыдущем шаге, затем нажмите **Далее**.
5.  Повторно введите в мастере пароль для кластера, затем щелкните **Тест** для проверки конфигурации
6.  Нажмите **OK**, чтобы закрыть диалоговое окно Тест.
7.  Нажмите кнопку **ОК**. Подождите открытие диалогового окна **Выбор базы данных и таблицы**. Это может занять несколько секунд.
8.  Выберите таблицу, которую следует импортировать, и нажмите кнопку **Далее**. *hivesampletable* является примером таблицы hive, которая содержится в кластерах HDInsight. Можно выбрать ее, если такая таблица еще не была создана. Дополнительные сведения о выполнении запросов Hive и создании таблиц Hive см. в разделе [Использование Hive вместе с HDInsight][Использование Hive вместе с HDInsight].
9.  Нажмите кнопку **Готово**
10. В диалоговом окне **Импорт данных** можно изменить или указать запрос. Для этого щелкните **Свойства**. Это может занять несколько секунд.
11. Щелкните вкладку **Определение**, затем добавьте **LIMIT 200** к инструкции Hive select в текстовом поле **Текст команды**. Это изменение приведет к ограничению возвращаемого набора записей 200 шт.

    ![Свойства подключения][Свойства подключения]

12. Нажмите **OK**, чтобы закрыть диалоговое окно "Свойства подключения".
13. Нажмите **OK**, чтобы закрыть диалоговое окно **Импорт данных**.
14. Повторно введите пароль, затем нажмите кнопку **OK**. Пройдет несколько секунд, прежде чем данные будут импортированы в Excel.

## <span id="nextsteps"></span></a>Дальнейшие действия

В этой статье было рассмотрено, как использовать драйвер Microsoft Hive ODBC для получения данных из службы HDInsight в Excel. Аналогичным образом можно получать данные из службы HDInsight в базу данных SQL. Можно также передавать данные в службу HDInsight. Дополнительные сведения см. на следующих ресурсах:

-   [Анализ данных о задержке рейсов с помощью HDInsight][Анализ данных о задержке рейсов с помощью HDInsight]
-   [Отправка данных в HDInsight][Отправка данных в HDInsight]
-   [Использование Sqoop вместе с HDInsight][Использование Sqoop вместе с HDInsight]

  [Подключение Excel к HDInsight с использованием Power Query]: ../hdinsight-connect-excel-power-query/
  [Приступая к работе с Azure HDInsight]: ../hdinsight-get-started/
  [Установка драйвера Microsoft Hive ODBC]: #InstallHiveODBCDriver
  [Создание источника данных Hive ODBC]: #CreateHiveODBCDataSource
  [Импорт данных в Excel из кластера HDInsight]: #ImportData
  [Дальнейшие действия]: #nextsteps
  [Центра загрузок]: http://go.microsoft.com/fwlink/?LinkID=286698
  [Администратор источника данных ODBC]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveOdbc.DataSourceAdmin1.png
  [Дополнительные параметры]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.HiveOdbc.DataSource.AdvancedOptions1.png
  [Мастер подключения к данным]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveOdbc.Excel.DataConnection1.png
  [Использование Hive вместе с HDInsight]: ../hdinsight-use-hive/
  [Свойства подключения]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveODBC.Excel.ConnectionProperties1.png
  [Анализ данных о задержке рейсов с помощью HDInsight]: ../hdinsight-analyze-flight-delay-data/
  [Отправка данных в HDInsight]: ../hdinsight-upload-data/
  [Использование Sqoop вместе с HDInsight]: ../hdinsight-use-sqoop/
