<properties title="Troubleshooting and Q & A about Application Insights" pageTitle="Ответы на вопросы и устранение неполадок в Application Insights" description="Советы и устранение неполадок" metaKeywords="analytics monitoring" authors="awills"  manager="kamrani" />

<tags ms.service="application-insights" ms.workload="tbd" ms.tgt_pltfrm="ibiza" ms.devlang="na" ms.topic="article" ms.date="2014-09-24" ms.author="awills" />
 
# Устранение неполадок и ответы на вопросы: Application Insights в предварительной версии Microsoft Azure

+ [Нигде нет команды на добавление Application Insights в мой проект в Visual Studio](#q01)
+ [Мой новый веб-проект был создан, но добавить Application Insights не удалось.](#q02)
+ [Мне удалось успешно добавить Application Insights и запустить приложение, но данные не появились на портале.](#q03)
+ [В разделе "Аналитические сведения об использовании" нет данных](#q04)
+ [На экране открыта начальная панель предварительной версии Microsoft Azure. Как найти мои данные в Application Insights?](#q05)
+ [Как можно изменить ресурс Azure, в котором отображаются мои данные?](#update)
+ [Появляется сообщение об ошибке "ключ инструментирования не может быть пустым"](#emptykey)
+ [На домашнем экране предварительной версии Microsoft Azure состояние моего приложение показано на этой карте?](#q06)
+ [После добавления Application Insights в приложение и открытия портала Application Insights все выглядит совсем не так, как на снимках экрана.](#q07)
+ [Можно ли использовать Application Insights для мониторинга веб-сервера в интрасети??](#q08)
+ [Как получить данные для Windows Phone или для Магазина Windows?](#q09)
+ [Как просмотреть события и просмотры страниц, записанные в журнал в коде?](#q10)
+ [Почему существует две версии Application Insights?](#q11)
+ [Как вернуть все удобные функции версии Application Insights для Visual Studio Online?](#q13)
+ [Что Application Insights изменяет в моем проекте?](#q14)
+ [Как найти мои результаты в Application Insights?](#q15)
+ [Какие порты следует открыть в брандмауэре?](#q16)
+ [Все ли активировано в Application Insights?](#q17)
+ [Подробнее](#next)



## <a name="q01"></a>Нигде нет команды на добавление Application Insights в мой проект в Visual Studio

+ Убедитесь в том, что установлена версия[Visual Studio Update 3](http://go.microsoft.com/fwlink/?LinkId=397827). В состав этой версии входят предустановленные инструменты Application Insights Tools, которые должны отображаться в диспетчере расширений.
+ Application Insights в предварительной версии Microsoft Azure в настоящее время доступны только для веб-проектов ASP.NET на языке C# или Visual Basic.
+ Если у вас есть существующий проект, перейдите в обозреватель решений и щелкните именно этот веб-проект (а не другой проект или решение). Должен появиться элемент меню "Добавить телеметрию Application Insights в проект".
+ В случае создания нового проекта необходимо в Visual Studio выбрать "Файл" > "Создать проект", а затем {Visual C#|Visual Basic} > "Веб" > "Веб-приложение ASP.NET". Должен быть доступен вариант для добавления Application Insights в проект.

## <a name="q02"></a>Мой новый веб-проект был создан, но добавить Application Insights не удалось.

Это может произойти при сбое связи с порталом Application Insights или при наличии каких-либо неполадок с вашей учетной записью.

+ Убедитесь, что вы предоставили правильные учетные данные для соответствующей учетной записи Azure. Учетные данные Microsoft Azure, которые вы видите в диалоговом окне "Создание проекта", могут отличаться от учетных данных Visual Studio Online, которые отображаются в правом верхнем углу окна Visual Studio.
+ Подождите немного, затем [добавьте Application Insights в ваш существующий проект][start].
+ Перейдите к настройкам учетной записи Microsoft Azure и проверьте ограничения. Проверьте, можно ли вручную добавить приложение Application Insights.


## <a name="q03"></a>Мне удалось успешно добавить Application Insights и запустить приложение, но данные не появились на портале.

+ Нужно закрыть и снова открыть любой модуль, в котором вы ожидаете данные. В данной версии содержимое модулей автоматически не обновляется.
+ На начальном экране Microsoft Azure посмотрите на карту состояния службы. Если есть какие-либо оповещения, дождитесь возвращения всех модулей в состояние ОК, затем закройте и заново откройте модуль приложения Application Insights.
+ В вашем брандмауэре вам может потребоваться открыть TCP-порты 80 и 443 для исходящего трафика, идущего на сайты dc.services.visualstudio.com и f5.services.visualstudio.com.

## <a name="q04"></a>В разделе "Аналитические сведения об использовании" нет данных

+ Данные поступают из сценариев на веб-страницах. Если вы добавили Application Insights в существующий веб-проект, [нужно добавить сценарии вручную][start].


## <a name="q05"></a>На экране открыта начальная панель предварительной версии Microsoft Azure. Как найти мои данные в Application Insights?

Одно из двух:

* Выберите "Обзор", Application Insights, затем выберите свой проект. Если там еще нет проектов, нужно добавить [Application Insights в ваш веб-проект в Visual Studio][start].

* В обозревателе решений Visual Studio щелкните правой кнопкой мыши проект веб-приложения и выберите Открыть портал Application Insights.

## <a name="update"></a>Как можно изменить ресурс Azure, на который мой проект отправляет данные?

В обозревателе решений щелкните правой кнопкой мыши на `ApplicationInsights.config` и выберите **Обновить Application Insights**. Данные можно отправлять на существующий или новый ресурс в Azure. Мастер обновления изменяет ключ инструментирования в файле ApplicationInsights.config, который определяет, куда сервер SDK должен отправлять ваши данные. Если отменить выбор параметра "Обновить все", это также приведет к изменению ключа, отображаемого на ваших веб-страницах.

## <a name="emptykey"></a>Появляется сообщение об ошибке "ключ инструментирования не может быть пустым"

Вероятно, произошла ошибка при установке Application Insights или же адаптера ведения журнала.

В обозревателе решений щелкните правой кнопкой мыши на `ApplicationInsights.config` и выберите **Обновить Application Insights**. Появится диалоговое окно с предложением войти в Azure и создать новый ресурс Application Insights или повторно использовать уже существующий.

## <a name="q06"></a>На домашнем экране предварительной версии Microsoft Azure состояние моего приложение показано на этой карте?

Нет! Здесь отображается состояние службы Azure. Чтобы увидеть результаты веб-теста, выберите Обзор > Application Insights > (ваше приложение). 


## <a name="q07"></a>После добавления Application Insights в приложение и открытия портала Application Insights все выглядит совсем не так, как на снимках экрана.

Возможно, вы используете [более раннюю версию Application Insights Tools](http://msdn.microsoft.com/library/dn793604.aspx), которая подключается к версии Visual Studio Online.

Эти страницы справки относятся к [Application Insights для предварительной версии Microsoft Azure][start], которая поставляется с Visual Studio Update 3. 

## <a name="q08"></a>Можно ли использовать Application Insights для мониторинга веб-сервера в интрасети??

Да, можно отслеживать состояние и использование сервера, если сервер может отправлять данные в общедоступный Интернет.

Если же вы хотите запускать веб-тесты для вашей службы, она должна быть доступна из Интернета.

## <a name="q09"></a>Как получить данные для Windows Phone или для Магазина Windows?

Еще не поддерживается в версии Microsoft Azure. Используйте [версию Visual Studio Online][older].


## <a name="q10"></a>Как просмотреть события и просмотры страниц, записанные в журнал в коде?

В текущей версии Microsoft Azure такая возможность пока не поддерживается. Выпуск ожидается в ближайшее время. Пока можно попробовать [более раннюю версию][older].


## <a name="q11"></a>Почему существует две версии Application Insights?

Более старый портал - часть Visual Studio Online. Мы не будем вносить существенных изменений в эту версию. Если вы используете более раннюю версию Application Insights, она подключается к порталу Visual Studio Online.

Visual Studio Update 3 включает предустановленную версию новых инструментов Application Insights. Они подключаются к новому порталу Application Insights, который является компонентом предварительной версии Microsoft Azure. В настоящее время мы переносим Application Insights в эту новую среду. Работа еще не завершена.

## <a name="q13"></a>Как вернуть все удобные функции версии Application Insights для Visual Studio Online?

1. Перейдите в диспетчер расширений Visual Studio. 
2. Удалите Application Insights Tools.
3. Запустите [установщик для устаревшей версии инструментов Application Insights](http://visualstudiogallery.msdn.microsoft.com/82367b81-3f97-4de1-bbf1-eaf52ddc635a) и прочтите [руководство "Приступая к работе"][older].

## <a name="q14"></a>Что Application Insights изменяет в моем проекте?

Подробная информация отличается в зависимости от типа проекта. Для веб-приложения она обеспечивает следующие функции.


+ Добавляет в проект следующие файлы:

 + ApplicationInsights.config. 
 + ai.js


+ Устанавливает следующие пакеты NuGet:

 -  *API Application Insights* - основной API

 -  *API Application Insights для веб-приложений* - используется для отправки данных телеметрии с сервера

 -  *API Application Insights для приложений JavaScript* - используется для отправки данных телеметрии со стороны клиента

    Пакет включает эти сборки:

 - Microsoft.ApplicationInsights

 - Microsoft.ApplicationInsights.Platform

+ Вставляет элементы в:

 - Web.config

 - packages.config

+ (Только для новых проектов. Если [вы будете добавлять Application Insights в существующий проект][start], то придется делать это вручную.) Вставляет фрагменты в код клиента и сервера для их инициализации с идентификатором ресурса Application Insights. Например, в приложении MVC код вставляется на главную страницу Views/Shared/_Layout.cshtml.


## <a name="q15"></a>Как найти мои результаты в Application Insights?
1. Откройте Microsoft Azure:
 - В Visual Studio щелкните правой кнопкой мыши проект веб-приложения и выберите **Открыть портал Azure, предварительная версия**.
 - Или в веб-браузере откройте свою учетную запись в предварительной версии Microsoft Azure.

2. Выберите Browse и Application Insights, затем выберите свой проект.

## <a name="q16"></a>Между моим сервером или компьютером разработки и общедоступным Интернетом установлен брандмауэр. Какой трафик необходимо разрешить для работы Application Insights?

Данные об использовании и производительности отправляются через TCP-порты 80 и 443 на dc.services.visualstudio.com и f5.services.visualstudio.com.

Веб-тесты доступности зависят от доступа входа к вашему веб-серверу через порт 80.

## <a name="q17"></a> Все ли активировано в Application Insights?

<table border="1">
<tr><th>Что вы должны видеть</th><th>Как это получить</th><th>Зачем это нужно</th></tr>
<tr><td>Диаграммы доступности</td><td><a href="../app-insights-monitor-web-app-availability/">Веб-тесты</a></td><td>Узнать, что ваше веб-приложение запущено</td></tr>
<tr><td>Производительность приложения на сервере: время отклика...
</td><td><a href="../app-insights-start-monitoring-app-health-usage/">Добавить Application Insights в свой проект</a><br/>или <br/><a href="../app-insights-monitor-performance-live-website-now/">установить на сервер монитор состояния AI</a></td><td>Выявить проблемы производительности</td></tr>
<!-- ####future#### <tr><td>Телеметрия зависимости</td><td><a href="../app-insights-monitor-performance-live-website-now/">Установить монитор состояния AI на сервер</a></td><td>Выявить неполадки при работе с базами данных или другими внешними компонентами</td></tr> -->
<!-- #####74.1#### <tr><td>Глобальные параметры сервера: ЦП, память...</td><td><a href="../app-insights-monitor-performance-live-website-now/">Установить монитор состояния AI на сервер</a></td><td>Выявить проблемы емкости</td></tr> --> 
<tr><td>Поиск по журналам трассировки</td><td><a href="../app-insights-search-diagnostic-logs/">Добавить адаптер ведения журнала</a></td><td>Выявить исключения, проблемы производительности</td></tr>
<tr><td>Общие сведения об использовании клиента: просмотры страниц, возвраты...</td><td><a href="../app-insights-start-monitoring-app-health-usage/#webclient">Инициализатор JavaScript на веб-страницах</a></td><td>Аналитика использования</td></tr>
<tr><td>Настраиваемые метрики клиента</td><td><a href="../app-insights-web-track-usage-custom-events-metrics/">Трассировка вызовов на веб-страницах</a></td><td>Улучшить работу пользователей</td></tr>
<tr><td>Настраиваемые метрики сервера</td><td><a href="../app-insights-web-track-usage-custom-events-metrics/">Трассировка вызовов в программном коде сервера</a></td><td>Бизнес-аналитика</td></tr>
</table>

Если ваша веб-служба работает на виртуальной машине Azure, вы можете [получить данные диагностики][azurediagnostic] здесь.



[AZURE.INCLUDE [app-insights-learn-more](../includes/app-insights-learn-more.md)]




[azurediagnostic]: ../insights-how-to-use-diagnostics/

[older]: http://www.visualstudio.com/get-started/get-usage-data-vs

