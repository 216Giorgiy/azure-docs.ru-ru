<properties linkid="develop-php-sql-database" urlDisplayName="SQL Database" pageTitle="How to use SQL Database (PHP) - Azure feature guides" metaKeywords="Azure SQL Database PHP, SQL Database PHP" description="Learn how to create and connect to an Azure SQL Database from PHP." metaCanonical="" services="sql-database" documentationCenter="PHP" title="How to Access Azure SQL Database from PHP" authors="robmcm" solutions="" manager="wpickett" editor="mollybos" videoId="" scriptId="" />

<tags ms.service="sql-database" ms.workload="data-management" ms.tgt_pltfrm="na" ms.devlang="PHP" ms.topic="article" ms.date="01/01/1900" ms.author="robmcm"></tags>

# Доступ к базе данных SQL Azure из PHP

В этом руководстве описываются основные принципы использования базы данных SQL Azure из PHP. Примеры написаны на PHP. Приведенные здесь сценарии включают **создание базы данных SQL** и **подключение к базе данных SQL**. В этом руководстве освещается создание базы данных SQL с помощью [портала управления][портала управления]. Сведения о выполнении этих задач с помощью производственного портала см. в статье [Начало работы с PHP и базой данных SQL][Начало работы с PHP и базой данных SQL] Дополнительные сведения см. в разделе [Дальнейшие действия][Дальнейшие действия].

## Что такое база данных SQL Azure

База данных SQL Azure предоставляет собой систему управления реляционной базой данных для Azure и основана на технологии SQL Server. С базой данных SQL можно легко подготовить и развернуть решения реляционных баз данных в облаке и воспользоваться преимуществами центра распределенных данных, которые представляют собой корпоративные преимущества доступности, масштабируемости и безопасности вместе со встроенной защитой данных и возможностями самостоятельной регенерации.

## Оглавление

-   [Основные понятия][Основные понятия]
-   [Практическое руководство. Настройка среды][Практическое руководство. Настройка среды]
-   [Практическое руководство. Создание базы данных SQL][Практическое руководство. Создание базы данных SQL]
-   [Практическое руководство. Получение сведений о подключении к базе данных SQL][Практическое руководство. Получение сведений о подключении к базе данных SQL]
-   [Практическое руководство. Подключение к экземпляру базы данных SQL][Практическое руководство. Подключение к экземпляру базы данных SQL]
-   [Дальнейшие действия][Дальнейшие действия]

## <span id="Concepts"></span></a>Основные понятия

Поскольку база данных SQL Azure построена на основе технологий SQL Server, доступ к базе данных SQL из PHP очень похож на доступ из PHP к SQL Server. Можно разработать приложение локально (с использованием SQL Server), а затем подключиться к базе данных SQL, изменив только строку подключения. Но существует ряд различий между базой данных SQL и SQL Server, которые могут повлиять на работу приложения. Дополнительные сведения см. в разделе [Рекомендации и ограничения (база данных SQL)][Рекомендации и ограничения (база данных SQL)].

Для доступа к базе данных SQL из PHP рекомендуется использовать [драйверы корпорации Майкрософт для PHP и SQL Server][драйверы корпорации Майкрософт для PHP и SQL Server] (Эти драйверы будут использоваться в примерах этой статьи). Драйверы корпорации Майкрософт для PHP и SQL Server работают только в среде Windows.

## <span id="Setup"></span></a>Практическое руководство. Настройка среды

Для настройки среды разработки рекомендуется использовать [Установщик веб-платформы корпорации Майкрософт][Установщик веб-платформы корпорации Майкрософт]. Установщик веб-платформы позволит выбрать элементы веб-платформы разработки, а затем автоматически установит и настроит их. Если загрузить установщик веб-платформы и после его запуска выбрать установку WebMatrix, PHP для WebMatrix и SQL Server Express, автоматически будет установлена полная среда разработки.

Либо можно настроить среду вручную:

-   Установите PHP и настройте IIS: [][]<http://php.net/manual/en/install.windows.iis7.php></a>.
-   Загрузите и установите SQL Server Express: [][1]<http://www.microsoft.com/ru-ru/download/details.aspx?id=29062></a>
-   Загрузите и установите драйверы корпорации Майкрософт для PHP и SQL Server: [][2]<http://php.net/manual/en/sqlsrv.requirements.php></a>.

## <span id="CreateServer"></span></a>Практическое руководство. Создание базы данных SQL

Выполните следующие действия для создания базы данных SQL Azure.

1.  Войдите на [портал управления][портала управления].
2.  Щелкните **Создать** в нижнем левом углу портала.

    ![Создание нового веб-сайта Azure][Создание нового веб-сайта Azure]

3.  Выберите **СЛУЖБЫ ДАННЫХ**, **БАЗА ДАННЫХ SQL** и **НАСТРАИВАЕМОЕ СОЗДАНИЕ**.

    ![Настраиваемое создание новой базы данных SQL][Настраиваемое создание новой базы данных SQL]

4.  Введите значение **ИМЯ** для базы данных, выберите **ВЫПУСК** (WEB или BUSINESS), выберите для базы данных **МАКС. РАЗМЕР**, выберите значение параметра **СОРТИРОВКА**, а затем выберите **СОЗДАТЬ сервер базы данных SQL**. Щелкните стрелку в нижней части диалогового окна. (Обратите внимание, что если база данных SQL была создана ранее, можно выбрать существующий сервер в раскрывающемся списке **Выберите сервер**.)

    ![Заполните параметры базы данных SQL][Заполните параметры базы данных SQL]

5.  Введите имя и пароль администратора (и подтвердите пароль), выберите регион, где будет создана новая база данных SQL, и установите флажок `Allow Azure Services to access the server`.

    ![Создать новый сервер базы данных SQL][Создать новый сервер базы данных SQL]

Чтобы просмотреть сведения о сервере и базе данных, щелкните **Базы данных SQL** на портале управления. Затем для просмотра соответствующих сведений можно выбрать **БАЗЫ ДАННЫХ** или **СЕРВЕРЫ**.

![Просмотр сведений о сервере и базе данных][Просмотр сведений о сервере и базе данных]

## <span id="ConnectionInfo"></span></a>Практическое руководство. Получение сведений о подключении к базе данных SQL

Чтобы получить сведения о подключении к базе данных, щелкните **БАЗЫ ДАННЫХ SQL** на портале, затем щелкните имя базы данных.

![Просмотр сведений о базе данных][Просмотр сведений о базе данных]

Затем щелкните **Просмотр строк подключения к базе данных SQL для ADO.NET, ODBC, PHP и JDBC**.

![Показать строки подключения][Показать строки подключения]

В разделе PHP появившегося окна обратите внимание на значения **СЕРВЕР**, **БАЗА ДАННЫХ** и **ИМЯ ПОЛЬЗОВАТЕЛЯ**. Ваш пароль – это пароль, который вы использовали при создании базы данных SQL.

## <span id="Connect"></span></a>Практическое руководство. Подключение к экземпляру базы данных SQL

Следующие примеры показывают, как использовать расширения **SQLSRV** и **PDO\_SQLSRV** для подключения к базе данных SQL с именем `testdb`. Понадобятся сведения, полученные в вышеприведенном разделе. Замените `SERVER_ID` идентификатором своего сервера из 10 знаков (первые 10 знаков значения "СЕРВЕР", полученного в вышеприведенном разделе) и назначьте правильные значения (свои значения имени и пароля пользователя) переменным `$user` и `$pwd`.

##### SQLSRV

    $server = "tcp:<value of SERVER from section above>";
    $user = "<value of USERNAME from section above>"@SERVER_ID;
    $pwd = "password";
    $db = "testdb";

    $conn = sqlsrv_connect($server, array("UID"=>$user, "PWD"=>$pwd, "Database"=>$db));

    if($conn === false){
        die(print_r(sqlsrv_errors()));
    }

##### PDO\_SQLSRV

    $server = "tcp:<value of SERVER from section above>";
    $user = "<value of USERNAME from section above>"@SERVER_ID;
    $pwd = "password";
    $db = "testdb";

    try{
        $conn = new PDO( "sqlsrv:Server= $server ; Database = $db ", $user, $pwd);
        $conn->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
    }
    catch(Exception $e){
        die(print_r($e));
    }

## <span id="NextSteps"></span></a>Дальнейшие действия

Как уже упоминалось, использование базы данных SQL очень похоже на использование SQL Server. После подключения к базе данных SQL (как показано выше) для вставки, извлечения, обновления и удаления данных можно использовать интерфейс API **SQLSRV** или **PDO\_SQLSRV**. Сведения об интерфейсах API **SQLSRV** и **PDO\_SQLSRV** см. в [документации на драйверы корпорации Майкрософт для PHP и SQL Server][документации на драйверы корпорации Майкрософт для PHP и SQL Server]. Но существует ряд различий между базой данных SQL и SQL Server, которые могут повлиять на работу приложения. Дополнительные сведения см. в разделе [Рекомендации и ограничения (база данных SQL)][Рекомендации и ограничения (база данных SQL)].

Пример, показывающий, как использовать базу данных SQL с PHP на платформе Azure, доступен по адресу <https://github.com/WindowsAzure/azure-sdk-for-php-samples/tree/master/tasklist-sqlazure>.

  [портала управления]: https://manage.windowsazure.com
  [Начало работы с PHP и базой данных SQL]: http://blogs.msdn.com/b/brian_swan/archive/2010/02/12/getting-started-with-php-and-sql-azure.aspx
  [Дальнейшие действия]: #NextSteps
  [Основные понятия]: #Concepts
  [Практическое руководство. Настройка среды]: #Setup
  [Практическое руководство. Создание базы данных SQL]: #CreateServer
  [Практическое руководство. Получение сведений о подключении к базе данных SQL]: #ConnectionInfo
  [Практическое руководство. Подключение к экземпляру базы данных SQL]: #Connect
  [Рекомендации и ограничения (база данных SQL)]: http://msdn.microsoft.com/ru-ru/library/windowsazure/ff394102.aspx
  [драйверы корпорации Майкрософт для PHP и SQL Server]: http://www.microsoft.com/download/en/details.aspx?id=20098
  [Установщик веб-платформы корпорации Майкрософт]: http://go.microsoft.com/fwlink/?LinkId=253447
  []: http://php.net/manual/en/install.windows.iis7.php
  [1]: http://www.microsoft.com/ru-ru/download/details.aspx?id=29062
  [2]: http://php.net/manual/en/sqlsrv.requirements.php
  [Создание нового веб-сайта Azure]: ./media/sql-database-php-how-to-use-sql-database/plus-new.png
  [Настраиваемое создание новой базы данных SQL]: ./media/sql-database-php-how-to-use-sql-database/create_custom_sql_db-2.png
  [Заполните параметры базы данных SQL]: ./media/sql-database-php-how-to-use-sql-database/new-sql-db.png
  [Создать новый сервер базы данных SQL]: ./media/sql-database-php-how-to-use-sql-database/db-server-settings.png
  [Просмотр сведений о сервере и базе данных]: ./media/sql-database-php-how-to-use-sql-database/sql-dbs-portal.png
  [Просмотр сведений о базе данных]: ./media/sql-database-php-how-to-use-sql-database/go-to-db-info.png
  [Показать строки подключения]: ./media/sql-database-php-how-to-use-sql-database/show-connection-string-2.png
  [документации на драйверы корпорации Майкрософт для PHP и SQL Server]: http://msdn.microsoft.com/ru-ru/library/dd638075(SQL.10).aspx
