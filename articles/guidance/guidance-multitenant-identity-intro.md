<properties
   pageTitle="Управление удостоверениями для мультитенантных приложений | Microsoft Azure"
   description="Вводные сведения об управлении удостоверениями в мультитенантных приложениях"
   services=""
   documentationCenter="na"
   authors="MikeWasson"
   manager="roshar"
   editor=""
   tags=""/>

<tags
   ms.service="guidance"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="02/16/2016"
   ms.author="mwasson"/>

# Управление удостоверениями для мультитенантных приложений. Введение

Этот материал входит в [цикл статей]. К статьям прилагается полный [пример приложения].

Предположим, что вы разрабатываете корпоративное приложение SaaS, которое будет размещено в облаке. Конечно, в приложении будут существовать пользователи.

![Пользователи](media/guidance-multitenant-identity/users.png)

Эти пользователи принадлежат организациям.

![Пользователи организации](media/guidance-multitenant-identity/org-users.png)

Пример: Tailspin продает подписки на свое приложение SaaS. Contoso и Fabrikam регистрируются для использования приложения. Когда Элис (`alice@contoso`) выполняет вход, приложение должно знать, что она является пользователем Contoso.

- Элис _должна_ иметь доступ к данным компании Contoso.
- У Элис _не должно_ быть доступа к данным компании Fabrikam.

В этом руководстве содержатся сведения об управлении удостоверениями пользователей в мультитенантном приложении и использовании [Azure Active Directory][AzureAD] (Azure AD) для обработки действий входа и выполнения проверки подлинности.

## Что такое мультитенантность?

_Клиент_ — это группа пользователей. В приложении SaaS клиентом является подписчик или заказчик приложения. _Мультитенантность_ представляет собой архитектуру использования несколькими клиентами одного физического экземпляра приложения. Несмотря на то, что клиенты совместно используют физические ресурсы (например виртуальные машины и хранилище данных), каждый клиент получает собственный логический экземпляр приложения.

Как правило, данные приложения являются общими для пользователей в пределах конкретного клиента, но не в других клиентах.

![Мультитенантное приложение](media/guidance-multitenant-identity/multitenant.png)

Сравним эту архитектуру с однотенантной архитектурой, где клиент имеет выделенный физический экземпляр. В однотенантной архитектуре добавление клиентов осуществляется путем развертывания новых экземпляров приложения.

![Однотенантное приложение](media/guidance-multitenant-identity/single-tenant.png)

### Мультитенантность и горизонтальное масштабирование

Масштабирование в облаке чаще всего достигается за счет добавления дополнительных физических экземпляров. Это называется _горизонтальным масштабированием_ или _увеличением масштаба_. Рассмотрим веб-приложение. Для обработки большего объема трафика можно добавить дополнительные серверные виртуальные машины и разместить их за балансировщиком нагрузки. На каждой виртуальной машине запущен отдельный физический экземпляр веб-приложения.

![Балансировка нагрузки веб-сайта](media/guidance-multitenant-identity/load-balancing.png)

Запросы могут направляться в любой экземпляр. Вся система функционирует как единый логический экземпляр. Процессы удаления ВМ или запуска новой ВМ не нарушают работу пользователей. В этой архитектуре каждый физический экземпляр является мультитенантным, а масштабирование осуществляется путем добавления дополнительных экземпляров. Если какой-либо экземпляр выходит из строя, он не влияет на клиенты.

## Идентификация в мультитенантном приложении

В мультитенантном приложении пользователей необходимо рассматривать в контексте клиентов.

**Аутентификация**

- Пользователи входят в приложение с использованием учетных данных организации. Им не нужно создавать профили пользователей для приложения.
- Пользователи одной организации являются частью одного и того же клиента.
- Когда пользователь входит в систему, приложение знает, какому клиенту он принадлежит.

**Авторизация**

- При авторизации действий пользователя (например просмотра ресурса) приложение должно учитывать клиент пользователя.
- Пользователям могут быть назначены роли в приложении, такие как "Администратор" или "Обычный пользователь". Назначениями ролей должен управлять клиент, а не поставщик SaaS.

**Пример.** Элис, сотрудник компании Contoso, переходит к приложению в браузере и нажимает кнопку "Вход". Она перенаправляется на экран входа, где вводит свои корпоративные учетные данные (имя пользователя и пароль). Она выполнила вход в приложение как `alice@contoso.com`. Приложению также известно, что Элис является администратором этого приложения. Так как она имеет права администратора, она может просмотреть список всех ресурсов, принадлежащих компании Contoso. Однако она не может просмотреть ресурсы компании Fabrikam, так как является администратором только в рамках своего клиента.

В этом руководстве мы отдельно рассмотрим использование Azure AD для управления удостоверениями.

- Предполагается, что клиент хранит профили пользователей в Azure AD (включая клиенты Office 365 и Dynamics CRM).
- Клиенты с локальной службой Active Directory (AD) могут применять [Azure AD Connect][ADConnect] для синхронизации локальной службы AD с Azure AD.

Если клиент с локальной службой AD не может использовать Azure AD Connect (ввиду особенностей корпоративной ИТ-политики или по другим причинам), поставщик SaaS может создать федерацию с AD с помощью служб федерации Active Directory (AD FS). Эта возможность описана в статье [Федерация со службой AD FS клиента].

В этом руководстве не рассматриваются другие аспекты мультитенантности, такие как секционирование данных, конфигурации отдельных клиентов и т. д.

<!-- Links -->
[ADConnect]: ../active-directory/active-directory-aadconnect.md
[AzureAD]: https://azure.microsoft.com/documentation/services/active-directory/
[цикл статей]: guidance-multitenant-identity.md
[Федерация со службой AD FS клиента]: guidance-multitenant-identity-adfs.md
[пример приложения]: https://github.com/Azure-Samples/guidance-identity-management-for-multitenant-apps

<!---HONumber=AcomDC_0302_2016-->