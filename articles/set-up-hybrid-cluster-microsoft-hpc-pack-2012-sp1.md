\<properties" pageTitle="Установка гибридного кластера вычислений с помощью пакета Microsoft HPC" metaKeywords="" description="Узнайте, как использовать пакет Microsoft HPC и Azure для настройки небольшого гибридного кластера для высокопроизводительных вычислительных систем (HPC)" metaCanonical="" services="" documentationCenter="" title="Настройка гибридного кластера с пакетом Microsoft HPC" authors="danlep" solutions="" manager="timlt" editor="mattshel" /\> \<p\>\<tags ms.service="cloud-services" ms.workload="big-compute" ms.tgt\_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="09/16/2014" ms.author="danlep" /\>\</p\> \<h1 id="set-up-a-hybrid-compute-cluster-with-microsoft-hpc-pack"\>Установка гибридного кластера вычислений с помощью пакета Microsoft HPC Pack\</h1\> \<p\>В этом учебнике показано, как использовать пакет Microsoft HPC 2012 R2 и Azure для установки небольшого гибридного кластера высокопроизводительных вычислительных систем (HPC). Кластер будет состоять из локального головного узла (компьютер под управлением операционной системы Windows Server и пакета HPC) и нескольких вычислительных узлов, развертываемых по требованию в качестве экземпляров рабочих ролей в облачной службе Azure. Затем вы сможете выполнять вычислительные задания в гибридном кластере.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/hybrid\_cluster\_overview.png" alt="Hybrid HPC cluster" /\>\</p\> \<p\>В этом учебнике демонстрируется один из способов использования масштабируемых вычислительных ресурсов в Azure, доступных по требованию, для запуска ресурсоемких приложений, который также называют "ускорением в облако".\</p\> \<p\>В этом учебнике предполагается, что у читателя нет опыта работы с вычислительными кластерами или пакетом HPC. Оно предназначено только для того, чтобы помочь вам быстро развернуть кластер вычислений для демонстрационных целей. Рекомендации и действия для развертывания гибридного кластера с пакетом HPC большего масштаба в производственной среде см. в подробном руководстве \<a href="http://go.microsoft.com/fwlink/p/?LinkID=200493"\>detailed guidance\</a\>.\</p\> \<blockquote\> \<p\>[WACOM.NOTE] Azure предлагает \<a href="http://go.microsoft.com/fwlink/p/?LinkId=389844"\>различные размеры\</a\> для вычислительных ресурсов, подходящие для разных рабочих нагрузок. Например, экземпляры A8 и A9 обеспечивают высокую производительность и доступ к сети приложений с малой задержкой и высокой пропускной способностью, что необходимо для некоторых приложений HPC. Для получения более подробной информации см. раздел \<a href="http://go.microsoft.com/fwlink/p/?Linkid=328042"\>О ресурсоемких вычислительных экземплярах A8 и A9\</a\>.\</p\> \</blockquote\> \<p\>В этом учебнике рассматриваются следующие основные действия:\</p\> \<ul\> \<li\>\<a href="\#BKMK\_Prereq"\>Предварительные требования\</a\>\</li\> \<li\>\<a href="\#BKMK\_DeployHN"\>Установка пакета HPC на головном узле\</a\>\</li\> \<li\>\<a href="\#BKMK\_Prpare"\>Подготовка подписки Azure\</a\>\</li\> \<li\>\<a href="\#BKMK\_ConfigHN"\>Настройка головного узла\</a\>\</li\> \<li\>\<a href="\#BKMK\_worker"\>Добавление узлов Azure в кластер\</a\>\</li\> \<li\>\<a href="\#BKMK\_start"\>Запуск узлов Azure\</a\>\</li\> \<li\>\<a href="\#BKMK\_RunCommand"\>Выполнение команды в кластере\</a\>\</li\> \<li\>\<a href="\#BKMK\_RunJob"\>Выполнение тестового задания\</a\>\</li\> \<li\>\<a href="\#BKMK\_stop"\>Остановка узлов Azure\</a\>\</li\> \</ul\> \<h2 id="BKMK\_Prereq"\>Предварительные требования\</h2\> \<blockquote\> \<p\>[WACOM.NOTE]Чтобы выполнить работу с этим учебником, необходимо использовать учетную запись Azure. Если ее нет, можно создать бесплатную пробную учетную запись всего за несколько минут. Дополнительные сведения см. в разделе \<a href="http://www.windowsazure.com/ru-ru/develop/php/tutorials/create-a-windows-azure-account/"\>Создание учетной записи Azure\</a\>.\</p\> \</blockquote\> \<p\>Кроме того, для работы с этим учебником потребуется следующее.\</p\> \<ul\> \<li\>\<p\>Локальный компьютер под управлением Windows Server 2012 R2 или Windows Server 2012. Этот компьютер будет головным узлом кластера HPC. Если вы еще не установили Windows Server, вы можете загрузить и установить \<a href="http://technet.microsoft.com/evalcenter/dn205286.aspx"\>ознакомительную версию\</a\>.\</p\> \<ul\> \<li\>\<p\>Компьютер должен быть присоединен к домену Active Directory.\</p\>\</li\> \<li\>\<p\>Убедитесь, что не установлены дополнительные роли сервера или службы ролей.\</p\>\</li\> \<li\>\<p\>Чтобы операционная система могла поддерживать пакет HPC, она должна быть установлена на одном из трех языков: английский, японский или китайский (упрощенное письмо).\</p\>\</li\> \<li\>\<p\>Убедитесь, что установлены важные и критические обновления.\</p\>\</li\> \</ul\>\</li\> \<li\>\<p\>Установочные файлы пакета HPC 2012 R2, доступные бесплатно. \<a href="http://go.microsoft.com/fwlink/p/?linkid=389557"\>Загрузите\</a\> полный пакет установки и скопируйте файлы на компьютер головного узла или в сетевую папку. Выберите установочные файлы на языке установленной системы Windows Server.\</p\>\</li\> \<li\>\<p\>Учетная запись домена с разрешениями локального администратора на головном узле.\</p\>\</li\> \<li\>\<p\>Подключение по протоколу TCP через порт 443 из головного узла в Azure.\</p\>\</li\> \</ul\> \<h2 id="BKMK\_DeployHN"\>Установка пакета HPC на головном узле\</h2\> \<p\>Сначала установите пакет Microsoft HPC на локальном компьютере, использующем Windows Server, который будет головным узлом кластера.\</p\> \<ol\> \<li\>\<p\>Войдите на головной узел с помощью доменной учетной записи с правами локального администратора.\</p\>\</li\> \<li\>\<p\>Откройте мастер установки пакета HPC, запустив файл Setup.exe из пакета HPC.\</p\>\</li\> \<li\>\<p\>На экране \<strong\>Установка пакета HPC 2012 R2 Setup\</strong\> нажмите кнопку \<strong\>Новая изолированная установка или добавление новых компонентов к существующему экземпляру\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc1.png" alt="Установка пакета HPC 2012" /\>\</p\>\</li\> \<li\>\<p\>На \<strong\>странице пользовательского соглашения по программному обеспечению Microsoft\</strong\>, нажмите кнопку \<strong\>Далее\</strong\>.\</p\>\</li\> \<li\>\<p\>На странице\>Выбор типа установки\</strong\> выберите опцию \<strong\>Создание кластера HPC с головным узлом\</strong\> и нажмите кнопку \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc2.png" alt="Выбор типа установки" /\>\</p\>\</li\> \<li\>\<p\>Мастер выполняет несколько тестов перед установкой. Нажмите кнопку \<strong\>Далее\</strong\> на странице \<strong\>Правила установки\</strong\> если все тесты пройдены. В противном случае ознакомьтесь с предоставленной информацией и внесите необходимые изменения в вашей среде. Затем повторите тесты или, при необходимости, запустите мастер установки еще раз.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc3.png" alt="Правила установки" /\>\</p\>\</li\> \<li\>\<p\>На странице \<strong\>Настройки базы данных HPC\</strong\> убедитесь, что выбран \<strong\>Головной узел\</strong\> для всех баз данных HPC, а затем нажмите кнопку \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc4.png" alt="Конфигурация базы данных" /\>\</p\>\</li\> \<li\>\<p\>Примите параметры по умолчанию на оставшихся страницах мастера. На странице \<strong\>Установка обязательных компонентов\</strong\> нажмите кнопку \<strong\>Установить\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc6.png" alt="Установка\</li\> \<li\>\<p\>После завершения установки снимите флажок \<strong\>Запустить диспетчер кластеров HPC\</strong\> и нажмите кнопку \<strong\>Готово\</strong\>. (Вы запустите диспетчер кластеров HPC позднее для завершения настройки головного узла.)\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc7.png" alt="Готово" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_Prepare"\>Подготовка подписки Azure\</h2\> \<p\>Используйте \<a href="https://manage.windowsazure.com"\>портал управления\</a\> для выполнения следующих действий с подпиской Azure. Они необходимы для развертывания узлов Azure из локального головного узла.\</p\> \<ul\> \<li\>\<p\>Загрузка сертификата управления (необходим для безопасных соединений между головным узлом и службами Azure)\</p\>\</li\> \<li\>\<p\>Создание облачной службы Azure, в которой будут работать узлы Azure (экземпляры рабочей роли)\</p\>\</li\> \<li\>\<p\>Создание учетной записи хранения Azure\</p\> \<blockquote\> \<p\>[WACOM.NOTE]Также запишите идентификатор подписки Azure, которая понадобится позже. Его можно найти в \<a href="[https://account.windowsazure.com/Subscriptions"\>сведениях об учетной записи Azure\</a\>.\</p\> \</blockquote\>\</li\> \</ul\> \<h3\>Загрузка сертификата управления по умолчанию\</h3\> \<p\>Пакет HPC устанавливает самозаверяющий сертификат на головном узле с именем "Сертификат управления Microsoft HPC Azure по умолчанию", который можно загрузить как сертификат управления Azure. Этот сертификат предназначен для тестирования и экспериментальных развертываний.\</p\> \<ol\> \<li\>\<p\>На компьютере головного узла войдите на \<a href="https://manage.windowsazure.com"\>портал управления\</a\>.\</p\>\</li\> \<li\>\<p\>Нажмите кнопку \<strong\>Параметры\</strong\> и щелкните \<strong\>Сертификаты управления\</strong\>.\</p\>\</li\> \<li\>\<p\>На панели команд нажмите \<strong\>Загрузить\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/upload\_cert1.png" alt="Параметры сертификата" /\>\</p\>\</li\> \<li\>\<p\>На головном узле перейдите к файлу C:\\Program Files\\Microsoft HPC Pack 2012\\Bin\\hpccert.cer. Затем нажмите на кнопку \<strong\>Установить флажок\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc10.png" alt="Отправка сертификата" /\>\</p\>\</li\> \</ol\> \<p\>В списке сертификатов управления вы увидите \<strong\>Default HPC Azure Management\</strong\> сертификат управления Azure HPC по умолчанию.\</p\> \<h3\>Создание облачной службы Azure\</h3\> \<blockquote\> \<p\>[WACOM.ПРИМЕЧАНИЕ]Для лучшей производительности рекомендуется создавать облачные службы и учетную запись хранения в одном географическом регионе.\</p\> \</blockquote\> \<ol\> \<li\>\<p\>На панели команд портала управления нажмите кнопку \<strong\>Создать\</strong\>.\</p\>\</li\> \<li\>\<p\>Нажмите кнопку \<strong\>Среда выполнения приложений\</strong\>, нажмите \<strong\>Облачная служба\</strong\>, затем нажмите кнопку \<strong\>Быстрое создание\</strong\>.\</p\>\</li\> \<li\>\<p\>Введите URL-адрес облачной службы и нажмите кнопку \<strong\>Создать облачную службу\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/createservice1.png" alt="Создание службы" /\>\</p\>\</li\> \</ol\> \<h3\>Создание учетной записи хранения Azure\</h3\> \<ol\> \<li\>\<p\>На панели команд портала управления нажмите кнопку \<strong\>Создать\</strong\>.\</p\>\</li\> \<li\>\<p\>Последовательно выберите \<strong\>Службы данных\</strong\>, затем \<strong\>Хранилище\</strong\> и \<strong\>Быстрое создание\</strong\>.\</p\>\</li\> \<li\>\<p\>Введите URL-адрес учетной записи и нажмите кнопку \<strong\>Создать учетную запись хранения\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/createstorage1.png" alt="Создание хранилища" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_ConfigHN"\>Настройка головного узла\</h2\> \<p\>Чтобы развернуть узлы Azure с помощью диспетчера кластеров HPC и отправлять задания, необходимо выполните некоторые действия для настройки кластера.\</p\> \<ol\> \<li\>\<p\>На головном узле запустите диспетчер кластеров HPC. Если откроется диалоговое окно\>Выбор головного узла\</strong\>, щелкните \<strong\>Локальный компьютер\</strong\>. Появится \<strong\>список дел развертывания\</strong\> appears.\</p\>\</li\> \<li\>\<p\>В разделе \<strong\>Необходимые задачи развертывания\</strong\>, щелкните \<strong\>Настроить сеть\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc2.png" alt="Настройка сети" /\>\</p\>\</li\> \<li\>\<p\>В мастере настройки сети выберите параметр \<strong\>Все узлы только в корпоративной сети\</strong\> (топология 5).\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc3.png" alt="Топология 5" /\>\</p\> \<blockquote\> \<p\>WACOM.ПРИМЕЧАНИЕ]Это простейшая конфигурация для демонстрационных целей, поскольку головному узлу для подключения к Active Directory и Интернету требуется только один сетевой адаптер. В этом учебнике не рассматриваются сценарии, в которых кластеру требуются дополнительные сети.\</p\> \</blockquote\>\</li\> \<li\>\<p\>Нажмите кнопку \<strong\>Далее\</strong\>, чтобы принять значения по умолчанию на оставшихся страницах мастера. Затем на вкладке \<strong\>Просмотр\</strong\> щелкните \<strong\>Настройка\</strong\> для завершения настройки сети.\</p\>\</li\> \<li\>\<p\>В \<strong\>списке дел развертывания\</strong\> нажмите \<strong\>Ввести учетные данные установки\</strong\>.\</p\>\</li\> \<li\>\<p\>В диалоговом окне \<strong\>Учетные данные установки\</strong\> введите учетные данные доменной учетной записи, которая использовалась для установки пакета HPC. Нажмите кнопку \<strong\>ОК\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc6.png" alt="Учетные данные установки" /\>\</p\> \<blockquote\> \<p\>[WACOM.NOTE]Службы пакета HPC используют учетные данные установки только для развертывания локальных вычислительных узлов.\</p\> \</blockquote\>\</li\> \<li\>\<p\>В \<strong\>списке дел развертывания\</strong\>, нажмите \<strong\>Настроить именование новых узлов\</strong\>.\</p\>\</li\> \<li\>\<p\>В диалоговом окне \<strong\>Указать серию именования узлов\</strong\> примите значения по умолчанию и нажмите кнопку \<strong\>ОК\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc8.png" alt="Именование узлов" /\>\</p\> \<blockquote\> \<p\>[WACOM.ПРИМЕЧАНИЕ]Серия именования формирует только имена для вычислительных узлов, присоединенных к домену. Узлы Azure именуются автоматически.\</p\> \</blockquote\>\</li\> \<li\>\<p\>В \<strong\>списке дел развертывания\</strong\> щелкните \<strong\>Создать шаблон узла\</strong\>. Этот шаблон будет использоваться для добавления узлов Azure в кластер.\</p\>\</li\> \<li\>\<p\>В окне мастера создания узла шаблона выполните следующие действия:\</p\> \<p\>a. На странице \<strong\>Выбор типа шаблона узла\</strong\> щелкните \<strong\>Шаблон узла Azure\</strong\> и нажмите кнопку \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc10.png" alt="Шаблон узла" /\>\</p\> \<p\>б. Нажмите кнопку \<strong\>Далее\</strong\> чтобы принять имя шаблона по умолчанию.\</p\> \<p\>cв. На странице \<strong\>Укажите сведения о подписке\</strong\> введите свой идентификатор подписки Azure (он доступен в \<a href="[https://account.windowsazure.com/Subscriptions"\>сведениях об учетной записи Azure\</a\>). Затем в разделе \<strong\>Сертификат управления\</strong\> нажмите кнопку \<strong\>Browse\</strong\> и выберите \<strong\>Управление HPC Azure по умолчанию.\</strong\> Затем выберите \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc12.png" alt="Шаблон узла" /\>\</p\> \<p\>г. На странице Укажите сведения о службе выберите облачную службу и учетную запись хранения, созданную на предыдущем шаге. Затем щелкните стрелку\<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc13.png" alt="Шаблон узла" /\>\</p\> \<p\>д. Нажмите кнопку \<strong\>Далее\</strong\>, чтобы принять значения по умолчанию на оставшихся страницах мастера. Затем на вкладке \<strong\>Просмотр\</strong\> нажмите кнопку \<strong\>Создать\</strong\>, чтобы создать шаблон узла.\</p\> \<blockquote\> \<p\>[WACOM.ПРИМЕЧАНИЕ]По умолчанию шаблон узла Azure содержит параметры для запуска (подготовки) и остановки узлов вручную. Вы также можете настроить расписание для автоматического запуска и остановки узлов Azure.\</p\> \</blockquote\>\</li\> \</ol\> \<h2 id="\#BKMK\_worker"\>Добавление узлов Azure в кластер\</h2\> \<p\>Этот шаблон будет использоваться для добавления узлов Azure в кластер. При добавлении узлов в кластер сведения об их конфигурации сохраняется, что позволяет запускать (настраивать) их в любое время в качестве экземпляров ролей в облачной службе. Плата за узлы Azure взимается с вашей подписки только после запуска экземпляров ролей в облачной службе.\</p\> \<p\>В этом учебнике вы добавите два мелких узла.\</p\> \<ol\> \<li\>\<p\>В диспетчере кластеров HPC в разделе \<strong\>Управление узлами\</strong\>, в области \<strong\>Действия\</strong\> нажмите \<strong\>Добавить узел\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node1.png" alt="Добавить узел" /\>\</p\>\</li\> \<li\>\<p\>В окне мастера добавления узла на странице \<strong\>Выбор метода развертывания\</strong\> нажмите кнопку \<strong\>Добавить узлы Azure\</strong\>, а затем \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node1\_1.png" alt="Добавление узла Azure" /\>\</p\>\</li\> \<li\>\<p\>На странице \<strong\>Укажите новые узлы\</strong\> выберите созданный ранее шаблон узла Azure (который по умолчанию называется \<strong\>Шаблон узла Azure по умолчанию\</strong\>). Затем укажите узлы \<strong\>2\</strong\> мелких \<strong\>Small\</strong\>, узла и нажмите кнопку \<strong\>Далее\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node2.png" alt="Указание узлов" /\>\</p\> \<p\>Сведения о доступных размерах виртуальных машин см. в разделе \<a href="http://msdn.microsoft.com/library/windowsazure/dn197896.aspx"\>Размеры виртуальных машин и облачных служб в Azure\</a\>.\</p\>\</li\> \<li\>\<p\>На \<strong\>последней странице мастера добавления узла\</strong\> нажмите кнопку \<strong\>Готово\</strong\>.\</p\> \<p\>Два узла Azure с именем \<strong\>AzureCN-0001\</strong\> и \<strong\>AzureCN-0002\</strong\> появятся в диспетчере кластеров HPC. Они находятся в состоянии \<strong\>Не развернуто\</strong\> state.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node3.png" alt="Добавление узлов" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_Start"\>Запуск узлов Azure\</h2\> \<p\>При необходимости использовать ресурсы кластера в Azure используйте диспетчер кластеров HPC, чтобы запустить (подготовить) узлы Azure и перевести их в оперативный режим.\</p\> \<ol\> \<li\>\<p\>В диспетчере кластеров HPC, в разделе \<strong\>Управление узлами\</strong\>, выберите один или оба узла, а затем в области \<strong\>действий\</strong\> нажмите кнопку \<strong\>Пуск\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node4.png" alt="Запуск узлов" /\>\</p\>\</li\> \<li\>\<p\>В диалоговом окне \<strong\>Запуск узлов Azure\</strong\> нажмите кнопку \<strong\>Пуск\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node5.png" alt="Запуск узлов" /\>\</p\> \<p\>Узлы перейдут в состояние \<strong\>подготовки\</strong\>. Для отслеживания хода подготовки можно просматривать журнал подготовки.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node6.png" alt="Подготовка узлов" /\>\</p\>\</li\> \<li\>\<p\>Через несколько минут подготовка узлов Azure завершится, и они перейдут в \<strong\>автономное\</strong\> состояние. В этом состоянии экземпляры ролей выполняются, но еще не принимают задания кластера.\</p\>\</li\> \<li\>\<p\>Чтобы убедиться, что экземпляры ролей выполняются, на \<a href="https://manage.windowsazure.com"\>портале управления\</a\> нажмите \<strong\>Облачные службы\</strong\>, затем выберите имя вашей облачной службы и нажмите \<strong\>Экземпляры\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_instances1.png" alt="Запущенные экземпляры" /\>\</p\> \<p\>Вы увидите два запущенных экземпляра рабочей роли в службе. Пакет HPC также автоматически развертывает два экземпляра \<strong\>HpcProxy\</strong\> (среднего размера) для обработки взаимодействия между головным узлом и Azure.\</p\>\</li\> \<li\>\<p\>Чтобы перевести узлы Azure в оперативный режим для выполнения заданий кластера, выберите узлы, щелкните правой кнопкой мыши и выберите команду \<strong\>Перевести в оперативный режим\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node7.png" alt="Автономные узлы" /\>\</p\> \<p\>Диспетчер кластеров HPC покажет, что узлы находятся в \<strong\>оперативном\</strong\> состоянии.\</p\>\</li\> \</ol\> \<h2 id="BKMK\_RunCommand"\>Выполнение команды в кластере\</h2\> \<p\>Команду \<strong\>clusrun\</strong\> пакета HPC можно использовать для выполнения команды или запуска приложения в одном или нескольких узлах кластера. В качестве простого примера выполните команду \<strong\>clusrun\</strong\> чтобы получить конфигурацию IP-адресов узлов Azure.\</p\> \<ol\> \<li\>\<p\>На головном узле откройте командную строку.\</p\>\</li\> \<li\>\<p\>Введите следующую команду:\</p\> \<p\>\<code data-inline="1"\>clusrun /nodes:azurecn\* ipconfig\</code\>\</p\>\</li\> \<li\>\<p\>Должен появиться результат, аналогичный приведенному ниже.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/clusrun1.png" alt="Clusrun" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_RunJob"\>Выполнение тестового задания\</h2\> \<p\>Вы можете отправить тестовое задание, которое выполняется на гибридном кластере. Это пример простого задания "параметрического анализа" (тип классических параллельных вычислений), которое выполняется подзадачи, добавляющие целое число с помощью команды \<strong\>set /a\</strong\> command. Все узлы в кластере участвуют в выполнения подзадач для целых чисел от 1 до 100.\</p\> \<ol\> \<li\>\<p\>В диспетчере кластеров HPC в разделе \<strong\>Управление заданиями\</strong\>, в области \<strong\>Действия\</strong\> нажмите \<strong\>Создать задание параметрического анализа\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/test\_job1.png" alt="Новое задание" /\>\</p\>\</li\> \<li\>\<p\>В диалоговом окне \<strong\>Создание задания параметрического анализа\</strong\> в \<strong\>командной строке\</strong\>, введите \<code data-inline="1"\>set /a \*+\*\</code\> (замените команду, которая отображается по умолчанию). Оставьте значения по умолчанию для остальных параметров и нажмите кнопку \<strong\>Отправить\</strong\>, чтобы отправить задание.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/param\_sweep1.png" alt="Параметрический анализ" /\>\</p\>\</li\> \<li\>\<p\>После завершения задания дважды щелкните задание \<strong\>Моя задача анализа\</strong\>.\</p\>\</li\> \<li\>\<p\>Нажмите кнопку \<strong\>Просмотреть задачи\</strong\> и щелкните подзадачу, чтобы просмотреть результаты выполнения подзадачи.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_job361.png" alt="Результаты выполнения задачи" /\>\</p\>\</li\> \<li\>\<p\>Для просмотра узла, который выполняет расчет для этой подзадачи, щелкните \<strong\>Выделенные узлы\</strong\>. (Кластер может показывать другое имя узла).\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_job362.png" alt="Результаты выполнения задачи" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_stop"\>Остановка узлов Azure\</h2\> \<p\>После тестирования кластера вы можете использовать диспетчер кластеров HPC для остановки узлов Azure, чтобы избежать ненужных расходов для вашей учетной записи. При этом облачная служба будет остановлена, а экземпляры ролей Azure будут удалены.\</p\> \<ol\> \<li\>\<p\>В диспетчере кластеров HPC, в разделе \<strong\>Управление узлами,\</strong\> выберите оба узла Azure. Затем в панели \<strong\>Действия\</strong\> щелкните \<strong\>Остановить\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node1.png" alt="Остановка узлов" /\>\</p\>\</li\> \<li\>\<p\>В диалоговом окне \<strong\>Остановка узлов Azure\</strong\> нажмите кнопку \<strong\>Остановить\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node2.png" alt="Остановка узлов" /\>\</p\>\</li\> \<li\>\<p\>Узлы перейдут в состояние \<strong\>Остановка\</strong\>. Через несколько минут диспетчер кластеров HPC покажет, что узлы находятся в состоянии \<strong\>Не развернуто\</strong\>.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node4.png" alt="Неразвернутые узлы" /\>\</p\>\</li\> \<li\>\<p\>Чтобы убедиться, что экземпляры ролей больше не выполняются в Azure, на \<a href="https://manage.windowsazure.com"\>портале управления\</a\> нажмите \<strong\>Облачные службы\</strong\>, затем выберите имя вашей облачной службы и нажмите \<strong\>Экземпляры\</strong\>. В рабочей среде будут отсутствовать развернутые экземпляры.\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_instances2.png" alt="Нет экземпляров" /\>\</p\> \<p\>На этом учебник завершен.\</p\>\</li\> \</ol\> \<h2 id=""\>Связанные ресурсы\</h2\> \<ul\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkID=263697"\>Пакет HPC 2012 R2 и HPC 2012\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkID=200493"\>Ускорение в Azure с помощью пакета Microsoft HPC\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkId=325317"\>Развертывание приложений на узлах Azure\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?linkid=330375"\>Пакет Microsoft HPC на виртуальных машинах Azure\</a\>\</li\> \</ul\>
