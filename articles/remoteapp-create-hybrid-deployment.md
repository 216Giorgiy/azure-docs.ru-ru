<properties title="How to create a hybrid deployment of RemoteApp" pageTitle="Как создать гибридное развертывание RemoteApp" description="Узнайте, как создать развертывание удаленного приложения RemoteApp, которое подключается к внутренней сети." metaKeywords="" services="" solutions="" documentationCenter="" authors="elizapo" manager="kathyw" />

<tags ms.service="remoteapp" ms.workload="tbd" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="09/12/2014" ms.author="elizapo" ms.manager="kathyw" />

#Как создать гибридное развертывание RemoteApp

Существует два типа развертывания RemoteApp. 

- Облачное: размещается полностью в Azure и создается с помощью параметра **Быстрое создание** на портале управления Azure.  
- Гибридное: включает виртуальную сеть для локального доступа и создается с помощью параметра **Создать с VPN** на портале управления.

В этом учебнике содержится пошаговое руководство по гибридному развертыванию. Для этого необходимо выполнить семь шагов: 

1.	создать [пользовательский образ шаблона для RemoteApp](http://azure.microsoft.com/ru-ru/documentation/articles/remoteapp-create-custom-image/);
2.	Создание службы RemoteApp.
2.	связаться с виртуальной сетью.
3.	связаться с образом шаблона.
4.	Настроить синхронизацию каталога. Для использования RemoteApp требуется интеграция с Azure Active Directory. Для этого можно: 1) настроить DirSync с возможностью синхронизации паролей; (2) настроить DirSync без синхронизации паролей, но с использованием имени домена, объединенного в федерацию со службами AD FS.
5.	Публикация программ RemoteApp.
6.	Настройка доступа пользователей.

**Перед началом работы**

Перед созданием службы необходимо выполнить следующие действия.

- Зарегистрироваться для предварительной версии RemoteApp. Это можно сделать на странице [http://azure.microsoft.com/ru-ru/services/remoteapp/](http://azure.microsoft.com/ru-ru/services/remoteapp/).
- Создать учетную запись пользователя в Active Directory для использования в качестве учетной записи службы RemoteApp. Ограничить разрешения для этой учетной записи, чтобы она могла только присоединять машины к домену.
- Собрать информацию о своей локальной сети: информацию об IP-адресе и сведения о VPN-устройстве.
- Установить модуль [Azure PowerShell](http://azure.microsoft.com/ru-ru/documentation/articles/install-configure-powershell/).
- Собрать сведения о пользователях и группах, которым требуется предоставить доступ. Это могут быть сведения об учетных записях Майкрософт или о рабочих учетных записях в Active Directory для пользователей и групп.
- Создание образа шаблона Образ шаблона RemoteApp содержит приложения программы, которыми вы хотите поделиться с пользователями. Подробные инструкции см. в разделе [Создание пользовательского шаблона для RemoteApp](http://azure.microsoft.com/ru-ru/documentation/articles/remoteapp-create-custom-image/). 






## **Шаг 1: создание службы RemoteApp** ##



1. На [портале управления Azure](http://manage.windowsazure.com) перейдите на страницу RemoteApp.
2. Нажмите **Новая > Создать с VPN**.
3. Введите имя для службы и нажмите **Создать службу RemoteApp**.

После создания службы RemoteApp перейдите на страницу **быстрого запуска** RemoteApp, чтобы продолжить действия по настройке.

## **Шаг 2: установка связи с виртуальной сетью** ##

Виртуальная сеть позволяет пользователям получать доступ к данным в локальной сети через удаленные ресурсы RemoteApp. Чтобы установить связь с виртуальной сетью, выполните следующие четыре шага:

1. На странице быстрого запуска нажмите **Связаться с виртуальной сетью remoteapp**. 
2. Выберите создание новой виртуальной сети или использование существующей. В этом учебнике мы создадим новую виртуальную сеть.
3. Предоставьте следующую информацию для своей сети:  
      - Имя
      - Адресное пространство виртуальной сети
      - Локальное адресное пространство
      - IP-адрес DNS-сервера
      - IP-адрес VPN

 Дополнительную информацию см. в разделе [Настройка VPN "сеть-сеть" на портале управления](http://msdn.microsoft.com/library/azure/dn133795.aspx).

4. Далее снова на странице быстрого запуска нажмите **Получить скрипт**, чтобы загрузить скрипт для настройки VPN-устройства и подключиться к виртуальной сети, которая была только что создана. Вам понадобится следующая информация о VPN-устройстве: 
	- поставщик
	- платформа
	- операционная система

  Сохраните скрипт и выполните его на VPN-устройстве. 

	**Примечание.** после выполнения этого скрипта виртуальная сеть перейдет в состояние "Готово" - на это может уйти 5-7 минут. До тех пор, пока сеть не готова, вы не сможете ее использовать.

5. И, наконец, снова на странице быстрого запуска нажмите **Присоединить локальный домен**. Добавьте учетную запись службы RemoteApp в локальный домен Active Directory. Вам понадобится имя домена, организационное подразделение, имя пользователя и пароль учетной записи службы.


## **Шаг 3: связь с образом шаблона RemoteApp** ##

Образ шаблона RemoteApp содержит программы, которыми вы хотите поделиться с пользователями. Можно отправить созданный образ шаблона (инструкции см. в разделе [Создание пользовательского образа шаблона для RemoteApp](http://azure.microsoft.com/ru-ru/documentation/articles/remoteapp-create-custom-image/)) или ссылку на существующий образ (который уже отправлен на Azure).

Если передается новый шаблон, необходимо ввести имя и выбрать местоположение для образа. На следующей странице мастера находится набор командлетов PowerShell. Чтобы передать выбранный образ, необходимо скопировать эти командлеты и выполнить их из строки с повышенными привилегиями Azure PowerShell.

При установке связи с существующим образом шаблона достаточно просто указать имя, местоположение и связанную подписку Azure.



## **Шаг 4: настройка синхронизации каталога Active Directory** ##

Для использования RemoteApp требуется интеграции с Azure Active Directory. Для этого можно: 1) настроить DirSync с возможностью синхронизации паролей; (2) настроить DirSync без синхронизации паролей, но с использованием имени домена, объединенного в федерацию со службами AD FS. Сведения о планировании и подробные действия см. в статье [Стратегия синхронизации каталогов](http://msdn.microsoft.com//library/azure/hh967642.aspx).

## **Шаг 5: публикация программ RemoteApp** ##

Программа RemoteApp - приложение или программа, которая предоставляется пользователям. Она располагается в образе шаблона, отправленном для службы. Когда пользователь вызывает программу RemoteApp, эта программа появляется как запущенная в локальной среде, но на самом деле запускается в Azure. 

Прежде чем пользователи смогут получить доступ к программам RemoteApp, необходимо их опубликовать в канале для конечных пользователей - списке доступных программ, доступ к которым пользователи получают через портал Azure.
 
В службе RemoteApp можно опубликовать несколько программ. На странице программ RemoteApp нажмите **Опубликовать**, чтобы добавить программу. Публиковать программу можно либо из меню "Пуск" образа шаблона, либо путем задания пути в образе шаблона для программы. Если решено использовать меню "Пуск", выберите программу для публикации. Если выбран вариант указания пути к программе, предоставьте имя программы и путь, по которому эта программа устанавливается в образе шаблона.

## **Шаг 6: настройка доступа пользователей** ##

После создания службы RemoteApp необходимо добавить пользователей и группы, которым требуется предоставить доступ к удаленным ресурсам. Пользователи или группы, которым предоставляется доступ, должны существовать в клиенте Active Directory, связанном с подпиской, используемой для создания службы RemoteApp.

1.	На странице быстрого запуска щелкните элемент **Настроить доступ пользователей**. 
2.	Введите данные рабочей учетной записи, имя группы (для Active Directory) или данные учетной записи Майкрософт, для которой планируется предоставить доступ.

  Для пользователей используйте формат user@domain.com. Для групп укажите имя группы.

3.	После проверки пользователей или групп нажмите кнопку **Сохранить**.


## Дальнейшие действия ##
Вы успешно создали и развернули гибридное развертывание RemoteApp. Далее пользователи должны загрузить и установить клиент удаленного рабочего стола. URL-адрес для клиента можно найти на странице быстрого запуска RemoteApp. Затем пользователи должны выполнить вход в клиент и вызвать опубликованные программы RemoteApp.


