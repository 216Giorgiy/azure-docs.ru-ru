<properties title="Step 3: Create a new Azure Machine Learning experiment" pageTitle="Step 3: Create a new Machine Learning experiment | Azure" description="Step 3: Create a new training experiment in Azure Machine Learning Studio" metaKeywords="" services="" solutions="" documentationCenter="" authors="garye" videoId="" scriptId="" />

<tags ms.service="machine-learning" ms.workload="tbd" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="garye"></tags>

Это третий шаг из пошагового руководства [Разработка прогнозирующего решения с помощью Azure ML][Разработка прогнозирующего решения с помощью Azure ML].

1.  [Создание рабочего пространства ML][Создание рабочего пространства ML]
2.  [Отправка существующих данных][Отправка существующих данных]
3.  **Создание нового эксперимента**
4.  [Подготовка и оценка моделей][Подготовка и оценка моделей]
5.  [Публикация веб-службы][Публикация веб-службы]
6.  [Доступ к веб-службе][Доступ к веб-службе]

------------------------------------------------------------------------

# Шаг 3. Создание нового эксперимента машинного обучения Azure

Нам необходимо создать новый эксперимент в ML Studio с использованием отправленного набора данных.

1.  В ML Studio нажмите **+СОЗДАТЬ** внизу окна.
2.  Выберите **ЭКСПЕРИМЕНТ**.
3.  На палитре модулей слева от полотна эксперимента разверните **Saved Datasets** (Сохраненные наборы данных).
4.  Найдите созданный набор данных и перетащите его на полотно. Набор данных можно также отыскать, введя имя в поле **Поиск** над палитрой.

## Подготовка данных

Можно просмотреть первые 100 строк данных и некоторую статистическую информацию для всего набора данных, щелкнув правой кнопкой мыши выходной порт набор данных и выбрав элемент **Визуализировать**. Обратите внимание, что в ML Studio уже определены типы данных для каждого столбца. Присвоены также универсальные заголовки столбцам, так как файл данных поступил без заголовков столбцов.

Заголовки столбцов не имеют существенного значения, однако они облегчат работу с данными в модели. Кроме того, при последующей публикации этой модели в веб-службе заголовки помогут определять столбцы пользователям службы.

Заголовки столбцов можно добавить с помощью модуля **Редактор метаданных**.

1.  В палитре модуля введите "metadata" в поле **Поиск**. В списке модуля будет присутствовать **Редактор метаданных**.
2.  Щелкните и перетащите модуль **Редактор метаданных** на полотно и вставьте его под набором данных.
3.  Подключите набор данных к **редактору метаданных**: щелкните выходной порт набора данных, перетащите во входной порт **редактора метаданных** и отпустите кнопку мыши. Набор данных и модуль останутся подключенными даже при их перемещении на полотне.
4.  На панели **Свойства** справа от полотна щелкните элемент **Запустить средство выбора столбцов**.
5.  Убедитесь, что в раскрывающемся списке установлен флажок «Все столбцы» и щелкните **OK**. В этом случае **редактор метаданных** будет работать со всеми столбцами данных.
6.  Для параметра **Имя нового столбца** введите список имен 21 столбца набоpa данных, разделенные запятыми и в порядке расположения столбцов. Имена столбцов можно получить из документации по наборам данных на веб-сайте UCI или для удобства можно скопировать и вставить следующее:

    состояние проверки счета, длительность в месяцах, кредитная история, цель, сумма кредита, сберегательный счет/ обязательства, действительный сотрудник с, величина взноса в процентах от располагаемого дохода, семейное положение и пол, другие должники, настоящее место жительства, собственность, возраст в годах, другие планы погашения, жилищные условия, количество существующих кредитов, работа, количество иждивенцев, телефон, иностранный рабочий, кредитный риск

Панель свойств будет выглядеть следующим образом:

![Свойства редактора метаданных][Свойства редактора метаданных]

> Подсказка: если необходимо проверить заголовки столбцов, запустите эксперимент (щелкните **ЗАПУСК** под полотном эксперимента), щелкните правой кнопкой мыши выходной порт модуля **редактор метаданных** и выберите элемент **Визуализировать**. Аналогичным образом можно просматривать выход любого модуля, чтобы следить за ходом использования данных в эксперименте.

Эксперимент теперь должен приблизительно выглядеть так:

![Добавление редактора метаданных][Добавление редактора метаданных]

## Создание обучающих и тестовых наборов данных

На следующем шаге эксперимента создаются отдельные наборы данных, которые будут использоваться для обучения и тестирования модели. Для этого используется модуль **Разделение**.

1.  Отыщите модуль **Разделение** перетащите его на полотно и подключите к последнему модулю **редактор метаданных**.
2.  По умолчанию коэффициент разделения равен 0,5 и задан параметр **Randomized split** (Случайное разделение). Это означает, что случайная половина данных будет выходить через один порт модуля **Разделение**, а вторая половина — через другой. Можно это отрегулировать, а также использовать параметр **Псевдослучайные числа**, чтобы изменить соотношение между данными для обучения и оценки. Для этого примера оставим их «как есть».

    > Подсказка: по существу, коэффициент разделения определяет сколько данных будет выходить через левый выходной порт. Например, если коэффициент установлен на 0,7, то 70% данных выходит через левый порт, а 30% — через правый.

Выходы модуля **Разделение** можно использовать по своему усмотрению. Однако предлагаем использовать левый выход для данных для обучения, а правый — для данных для оценки.

Как отмечалось на веб-сайте UCI, стоимость неверной классификации высокого кредитного риска как низкого в 5 раз выше, чем стоимость неверной классификации низкого кредитного риска как высокого. Чтобы это учесть, создадим новый набор данных, отражающий эту функцию стоимости. В новом наборе данных каждый высокий пример реплицируется 5 раз, а каждый низкий пример не реплицируется.

Эту репликацию можно выполнить с помощью кода R:

1.  Отыщите и перетащите модуль **Выполнение скрипта R** на полотно эксперимента и подключите к левому выходному порту модуля **Разделение**.
2.  На панели **Свойства** удалите текст по умолчанию в параметре **Скрипт** и введите следующий скрипт:

        dataset1 <- maml.mapInputPort(1)
        data.set<-dataset1[dataset1[,21]==1,]
        pos<-dataset1[dataset1[,21]==2,]
        for (i in 1:5) data.set<-rbind(data.set,pos)
        maml.mapOutputPort("data.set")

Необходимо проделать ту же операцию репликации для каждого выхода модуля **Разделение**, чтобы данные для обучения и оценки получили одинаковую корректировку стоимости.

1.  Щелкните правой кнопкой мыши модуль **Выполнение скрипта R** и выберите **Копировать**.
2.  Щелкните правой кнопкой мыши полотно эксперимента и выберите **Вставить**.
3.  Подключите модуль **Выполнение скрипта R** к правому выходному порту модуля **Разделение**.

> Подсказка: копия модуля Выполнение скрипта R содержит тот же скрипт, что и оригинальный модуль. При копировании и вставке модуля на полотно копия сохраняет все свойства оригинала.
>
> На эксперимент теперь выглядит приблизительно так:

![Добавление модуля Разделение и скриптов R][Добавление модуля Разделение и скриптов R]

  [Разработка прогнозирующего решения с помощью Azure ML]: ../machine-learning-walkthrough-develop-predictive-solution/
  [Создание рабочего пространства ML]: ../machine-learning-walkthrough-1-create-ml-workspace/
  [Отправка существующих данных]: ../machine-learning-walkthrough-2-upload-data/
  [Подготовка и оценка моделей]: ../machine-learning-walkthrough-4-train-and-evaluate-models/
  [Публикация веб-службы]: ../machine-learning-walkthrough-5-publish-web-service/
  [Доступ к веб-службе]: ../machine-learning-walkthrough-6-access-web-service/
  [Свойства редактора метаданных]: ./media/machine-learning-walkthrough-3-create-new-experiment/create1.png
  [Добавление редактора метаданных]: ./media/machine-learning-walkthrough-3-create-new-experiment/create2.png
  [Добавление модуля Разделение и скриптов R]: ./media/machine-learning-walkthrough-3-create-new-experiment/create3.png
