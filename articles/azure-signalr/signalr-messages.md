---
title: Сообщения и подключения в службе Azure SignalR
description: Обзор основных понятий относительно сообщений и подключений в службе Azure SignalR.
author: sffamily
ms.service: signalr
ms.topic: overview
ms.date: 09/13/2018
ms.author: zhshang
ms.openlocfilehash: c2348df7a1a55584807a03216e294486ddadfc52
ms.sourcegitcommit: a1cf88246e230c1888b197fdb4514aec6f1a8de2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/16/2019
ms.locfileid: "54352603"
---
# <a name="message-and-connection-in-azure-signalr-service"></a>Сообщения и подключения в службе Azure SignalR

Модель выставления счетов службы Azure SignalR основана на количестве подключений и сообщений. В следующих разделах объясняется, как сообщения и подключения определяются и учитываются при выставлении счетов.

## <a name="message-formats-supported"></a>Поддерживаемые форматы сообщений

Служба Azure SignalR поддерживает те же форматы, что и служба SignalR для ASP.NET Core: [JSON](https://www.json.org/) и [MessagePack](/aspnet/core/signalr/messagepackhubprotocol).

## <a name="message-size"></a>Размер сообщения

Служба Azure SignalR не имеет ограничений на размер сообщений.

На практике большое сообщение разбивается на более мелкие сообщения размером не более 2 КБ и передается в виде отдельных сообщений. Разбиение и соединение сообщений обрабатываются с помощью пакетов SDK. При этом усилия со стороны разработчиков не требуются.

Однако большой размер сообщений негативно влияет на производительность обмена сообщениями. Используйте сообщения меньшего размера всегда, когда это возможно, и выполняйте тестирование, чтобы выбрать оптимальный размер сообщения для каждого сценария использования.

## <a name="how-to-count-messages-for-billing-purpose"></a>Как подсчитать сообщения, которые учитываются при выставлении счетов?

Мы считаем только сообщения, исходящие из службы SignalR, и игнорируем сообщения проверки связи между клиентами и серверами.

Сообщение размером более 2 КБ считается как несколько сообщений по 2 КБ. Диаграмма числа сообщений на портале Azure будет обновляться при поступлении каждых 100 сообщений на концентратор.

Например, у вас есть три клиента и один сервер приложений. Один клиент отправляет одно сообщение размером 4 КБ, чтобы сервер мог передавать данные всем клиентам. Количество сообщений равно 8: 1 сообщение от службы к серверу приложений, 3 сообщения от службы к клиентам; каждое сообщение учитывается как 2 сообщения по 2 КБ.

На портале Azure для количества сообщений будет отображаться значение 0, пока их не накопится больше 100.

## <a name="how-to-count-connections"></a>Как подсчитать количество подключений?

Существуют серверные и клиентские подключения. По умолчанию каждый сервер приложения имеет 5 подключений для каждого концентратора при использовании Службы SignalR. Каждый клиент имеет 1 клиентское подключение к Службе SignalR.

Число подключений, отображаемое на портале Azure, включает в себя как серверные, так и клиентские подключения.

Например, вы имеете два сервера приложений и определяете 5 концентраторов в коде. Количество подключений к серверу равно 50: 2 сервера приложений * 5 концентраторов * 5 подключений или концентраторов.

ASP.NET SignalR отличается в расчете подключений к серверу. Он имеет один концентратор по умолчанию в дополнение к определенным пользователем концентраторам. Каждому серверу приложений требуется еще 5 подключений к серверу по умолчанию. Число соединений для концентратора по умолчанию остается согласованным с другими концентраторами.

## <a name="how-to-count-inbound-traffic--outbound-traffic"></a>Подсчитывание входящего и исходящего трафика

Входящий и исходящий с точки зрения службы SignalR. Трафик вычисляется в байтах. Как и число сообщений, трафик также имеет частоту выборки. Диаграмма входящего и исходящего трафика на портале Azure обновляется каждые 100 КБ на концентратор.

## <a name="related-resources"></a>Связанные ресурсы

- [Метрики, поддерживаемые Azure Monitor](/azure/azure-monitor/platform/metrics-supported#microsoftsignalrservicesignalr )
- [Конфигурация SignalR для ASP.NET Core](/aspnet/core/signalr/configuration)
- [JSON](https://www.json.org/)
- [MessagePack](/aspnet/core/signalr/messagepackhubprotocol)