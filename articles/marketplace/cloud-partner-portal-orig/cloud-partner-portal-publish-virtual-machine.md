---
title: Создание предложения виртуальной машины | Документация Майкрософт
description: Опубликуйте виртуальную машину в Azure Marketplace.
services: Azure, Marketplace, Cloud Partner Portal,
documentationcenter: ''
author: dan-wesley
manager: Patrick.Butler
editor: ''
ms.assetid: ''
ms.service: marketplace
ms.workload: ''
ms.tgt_pltfrm: ''
ms.devlang: ''
ms.topic: conceptual
ms.date: 09/18/2018
ms.author: pbutlerm
ms.openlocfilehash: 519867b1e0607a769948c86af263c172e810d107
ms.sourcegitcommit: fbf0124ae39fa526fc7e7768952efe32093e3591
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2019
ms.locfileid: "54078122"
---
# <a name="publish-a-virtual-machine-to-azure-marketplace"></a>Публикация виртуальной машины в Azure Marketplace

В этой статье описываются шаги, необходимые для публикации предложения виртуальной машины в Azure Marketplace.

## <a name="prerequisites"></a>Предварительные требования

К публикации виртуальной машины в Azure Marketplace применяются следующие технические и другие требования

### <a name="technical"></a>Технические требования

-   [Технические компоненты, необходимые для создания образа виртуальной машины для Azure Marketplace](../cloud-partner-portal/virtual-machine/cpp-create-technical-assets.md)
-   [Создание и загрузка Linux VHD](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-create-upload-generic?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
-   [Создание и тестирования виртуальной машины Linux из образа](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-upload-vhd)
-   [Создание и передача виртуального жесткого диска Windows ](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-prepare-for-upload-vhd-image?toc=/azure/virtual-machines/windows/toc.json)
-   [Создание и тестирования виртуальной машины Windows из образа](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-create-vm-generalized-managed?toc=/azure/virtual-machines/windows/toc.json)
-   [Как устранить распространенные неполадки, возникающие в процессе создания виртуального жесткого диска](../cloud-partner-portal/virtual-machine/cpp-common-vhd-creation-issues.md)
-   [Рекомендации по обеспечению безопасности для образов Azure Marketplace](https://docs.microsoft.com/azure/security/security-recommendations-azure-marketplace-images)


### <a name="non-technical-business-requirements"></a>Требования нетехнического характера (бизнес-требования)

 -   Ваша компания (или ее филиал) находится в стране, на территории которой могут осуществляться продажи в Azure Marketplace.
-   Продукт должен иметь лицензию, совместимую с моделями выставления счетов, которые поддерживает Azure Marketplace.
-   Вы должны предоставить клиентам техническую поддержку экономически обоснованным образом. Поддержка может быть платной, бесплатной или обеспечиваться посредством поддержки от сообщества.
-   Вы несете ответственность за лицензирование программного обеспечения, а также любых зависимостей от стороннего программного обеспечения.
-   Вам нужно предоставить маркетинговые материалы, отвечающие критериям для вашего предложения, соблюдение которых требуется для добавления приложения в Azure Marketplace и на портал Azure.
-   Подтвердите согласие с условиями политик участия и соглашения для издателей Azure Marketplace.
-   Примите [условия использования](https://azure.microsoft.com/support/legal/website-terms-of-use/), [заявление о конфиденциальности Майкрософт](https://www.microsoft.com/privacystatement/default.aspx) и [соглашение по программе сертификации Microsoft Azure](https://azure.microsoft.com/support/legal/marketplace/certified-program-agreement/).

## <a name="before-you-begin"></a>Перед началом работы

После удовлетворения всех предварительных требований можно приступить к созданию предложения шаблона решения. Прежде чем начать, просмотрите следующее сведения о предложении и номере SKU.

**ПРЕДЛОЖЕНИЕ**

Предложение приложения Azure соответствует классу предложения продукта от издателя. Если у вас есть новый тип решения или приложения, которое вы хотели бы добавить в Azure Marketplace, можно разместить его в качестве нового предложения. Предложение — это коллекция SKU. Каждое предложение отображается в виде отдельной сущности в Azure Marketplace.

**SKU**

SKU — это наименьшая единица предложения, доступная для приобретения. Номера SKU в одном классе продуктов (предложении) позволяют разделить разные поддерживаемые функции. Например, предложение может быть управляемым или неуправляемым, а также поддерживать разные модели выставления счетов.

Используйте несколько номеров SKU в следующих сценариях:
- Если нужна поддержка разных моделей выставления счетов, таких как использование собственной лицензии (BYOL) или оплата по мере использования (PAYG).
- Каждый номер SKU поддерживает разные наборы функций с разными ценами.

В Azure Marketplace номер SKU отображается внутри родительского предложения, а на портале Azure — в качестве отдельной сущности, доступной для приобретения.

## <a name="to-create-a-new-offer"></a>Создание предложения

1.  Войдите на [портал Cloud Partner](http://cloudpartner.azure.com/).

2.  В левой панели навигации щелкните **+ New offer** (+ Создать предложение) и выберите **Виртуальные машины**.

    ![Новое предложение по виртуальным машинам](./media/cloud-partner-portal-publish-virtual-machine/publishvm1.png)

3.  В области **Новое предложение** выберите **Редактор**.

![Новое предложение редактора](./media/cloud-partner-portal-publish-virtual-machine/publishvm2.png)

4.  В разделе **Редактор** необходимо предоставить сведения в следующих представлениях:
    - Параметры предложения
    - Номера SKU
    - Marketplace
    - Поддержка. Каждое предоставление содержит набор полей для заполнения. Обязательные для заполнения поля отмечены красной звездочкой (\*).

## <a name="to-configure-offer-settings"></a>Настройка параметров предложения

1. Настройте следующие поля **идентификатора предложения** в параметрах предложения.

    **Идентификатор предложения**

     Уникальный идентификатор для предложения в профиле издателя. Он отображается в URL-адресах продукта, шаблонах Azure Resource Manager и отчетах о выставлении счетов. Идентификатор может содержать только строчные буквы, цифры или дефисы (-). Он не может заканчиваться дефисом, а его длина не должна превышать 50 знаков. Например, если издатель **contoso** публикует предложение с идентификатором **sample-vm**, оно появится в Azure Marketplace как **https://azuremarketplace.microsoft.com/marketplace/apps/contoso.sample-vm?tab=Overview**  
    >[!Note]
    >После активации предложения это поле блокируется.

    **Идентификатор издателя**

    Раскрывающийся список профилей издателей. Выберите здесь профиль издателя, от имени которого будет опубликовано предложение. 
    >[!Note]
    >После активации предложения это поле блокируется.

    **Имя**

    Отображаемое имя для предложения. Это имя отображается в Azure Marketplace и на портале Azure. Его длина не должна превышать 50 символов. Для имени предложения следует учесть следующие рекомендации:
    -  Укажите для своего продукта узнаваемое название торговой марки. 
    - Не включайте в него название организации, если это не входит в стратегию продвижения продукта.
    - Если вы продвигаете продукт через свой веб-сайт, убедитесь, что данное имя полностью совпадает с используемым на сайте.

2. Нажмите кнопку **Сохранить**, чтобы завершить установку параметров предложения.

## <a name="to-create-a-sku"></a>Создание номера SKU

1. Выберите **Номера SKU**. 
2. Выберите **Add a SKU** (Добавить номер SKU), чтобы ввести идентификатор номера SKU. Идентификатор номера SKU — это уникальный идентификатор номера SKU в рамках предложения. Он отображается в URL-адресах продукта, шаблонах Azure Resource Manager и отчетах о выставлении счетов. Для идентификатора номера SKU действуют такие требования:
    - Его длина не должна превышать 50 символов.
    - Идентификатор может содержать только строчные буквы, цифры или дефисы (-).
    - Идентификатор не может заканчиваться дефисом.

    ![Добавление номера SKU](./media/cloud-partner-portal-publish-virtual-machine/publishvm4.png)


## <a name="configure-sku-details"></a>Настройка сведений о номере SKU

После добавления номера SKU он появится в списке номеров SKU в представлении номеров SKU. Чтобы просмотреть сведения о номере SKU, выберите его имя. Вы можете использовать представление сведений для добавления информации в следующие поля.

### <a name="hide-this-sku"></a>Hide this SKU (Скрыть этот SKU)

Используйте этот параметр для управления видимостью номера SKU. Если параметр Hide this SKU (Скрыть этот SKU) отключен, клиентам будет доступен номер SKU в [Azure Marketplace](https://azuremarketplace.microsoft.com) и на [портале Azure](https://portal.azure.com/). Вы можете скрыть SKU, чтобы он был доступен только через шаблоны решений и недоступен для отдельного приобретения.

### <a name="cloud-availability"></a>Cloud Availability (Доступность в облаках)

Это поле позволяет определить доступность SKU в разных облаках Azure.

**Общедоступное облако Azure**

Этот номер SKU будет доступен для развертывания клиентами во всех общедоступных регионах Azure с интеграцией Marketplace.

**Облако Azure для государственных организаций**.

Этот номер SKU можно развернуть в облаке Azure для государственных организаций. Перед публикацией в [Azure для государственных организаций](https://docs.microsoft.com/azure/azure-government/documentation-government-manage-marketplace-partners) мы рекомендуем издателям протестировать и проверить работу своего решения. Для этого [запросите пробную учетную запись](https://azure.microsoft.com/offers/ms-azr-usgov-0044p). 

>[!Note]
>Microsoft Azure для государственных организаций — это облако сообщества государственных организаций с контролируемым доступом для клиентов из федеральных, государственных, местных или племенных органов, а также обслуживающих их партнеров.

### <a name="countryregion-availability"></a>Country/Region availability (Доступность в стране или регионе)

Это поле определяет регионы, в которых ваш номер SKU можно будет приобрести. Необходимо тщательно продумать, для каких регионов должны быть доступны ваши номера SKU. Некоторые страны классифицируются как страны, где перечисление налогов осуществляет корпорация Майкрософт (Microsoft Tax Remitted Country).

-   В странах с такой классификацией корпорация Майкрософт осуществляет сбор налогов с клиентов и оплачивает (перечисляет) их правительству.

-   В других странах ответственность за те же действия несут партнеры (независимые поставщики программного обеспечения). Если вы принимаете решение осуществлять продажи в таких странах, нужно иметь возможность рассчитывать и оплачивать налоги в них.

![Выбор доступности по странам и регионам](./media/cloud-partner-portal-publish-virtual-machine/publishvm5.png)

### <a name="pricing"></a>Цены

В настоящее время поддерживаются две модели ценообразования.

#### <a name="bring-your-own-license-byol"></a>С использованием собственной лицензии (BYOL)

Вы управляете лицензиями на программное обеспечение, выполняемое на виртуальной машине. Корпорация взимает только плату за инфраструктуру.

#### <a name="usage-based-monthly-billed-sku"></a>SKU с ежемесячной оплатой по объему используемых ресурсов

С клиента взимается плата на почасовой основе в зависимости от тарифов, установленных издателями для размеров виртуальных машин. При использовании **почасовой модели выставления счетов** общая цена будет суммой затрат на программное обеспечение, выставляемых в счете издателем, и затрат на инфраструктуру, выставляемых в счете корпорацией Майкрософт. Эта общая стоимость будет отображаться для клиентов в виде почасовой или помесячной цены, когда они планируют покупку. В этом случае счета будут выставляться ежемесячно.

В модели на основе использования есть дополнительные параметры, которые вам нужно задать.

**бесплатной пробной версии**

Вы можете указать, следует ли предоставлять клиентам бесплатную пробную версию.
Согласно этой модели клиенту не выставляются счета за использование программного обеспечения в течение первых 30 или 90 дней (в зависимости от выбранного варианта) после развертывания виртуальной машины. По истечении периода бесплатной пробной версии с клиента взимается плата на почасовой основе по ставкам, установленным издателями в почасовой модели.

**Оплата за ядро**

Для своего SKU вы можете установить цены "на ядро". Для этого параметра нужно ввести базовую цену за одно ядро, и мы автоматически рассчитаем цены для остальных ядер. Введите цены в долларах США на портале, и мы автоматически рассчитаем цены для других регионов. Цены в других регионах можно проверить с помощью функции **Export Pricing Data** (Экспорт данных о ценах)

![Оплата за ядро](./media/cloud-partner-portal-publish-virtual-machine/publishvm6.png)


**Дискретные цены**

Можно установить индивидуальную цену для каждого набора ядер, если вы хотите взимать плату отдельно за каждое ядро.

![Дискретные цены](./media/cloud-partner-portal-publish-virtual-machine/publishvm7.png)

**Экспорт и импорт сведений о ценах**

Вы можете экспортировать сведения о ценах, настроенные на портале, для внесения изменений через интерфейс Excel. Эта функция также позволяет проверить цены для регионов и цены в местной валюте.
При щелчке элемента **Export-Pricing** (Экспорт цен) скачивается файл Excel, заполненный сведениями о ценах. Вы можете изменить эти данные в электронной таблице, а затем использовать **Import-Pricing** (Импорт цен) для импорта внесенных изменений.
Импортированные сведения о ценах отражаются и на портале.

В этом файле Excel цены для разных регионов указаны в местной валюте. Используемый курс обмена обновляется ежедневно.

![Экспорт и импорт сведений о ценах с примерами курса обмена](./media/cloud-partner-portal-publish-virtual-machine/publishvm8.png)

>[!IMPORTANT]
>-   После активации предложения цены нельзя изменить. Однако вы можете добавить или удалить поддерживаемые регионы.
>-   Эта плата взимается с пользователя в дополнение к  [ценам на виртуальные машины Azure](https://aka.ms/vmpricingdetails).
>-   Для всех регионов цены устанавливаются в местной валюте по курсу, актуальному на момент установки.
>-   Чтобы задать или просмотреть цену для каждого региона в отдельности, экспортируйте электронную таблицу цен и затем импортируйте с измененными ценами.

## <a name="vm-images"></a>Образы виртуальных машин

Следующим нужно заполнить раздел образов виртуальных машин. Перед переходом к нему нужно подготовить VHD, который вы хотите опубликовать. Ниже приведены некоторые ссылки, где описано создание VHD:

-   [Технические компоненты, необходимые для создания образа виртуальной машины для Azure Marketplace](../cloud-partner-portal/virtual-machine/cpp-prerequisites.md)
-   [Создание и отправка диска VHD Linux](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-create-upload-generic?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
-   [Создание и тестирования виртуальной машины Linux из образа](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-upload-vhd)
-   [Создание и передача виртуального жесткого диска Windows ](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-prepare-for-upload-vhd-image?toc=/azure/virtual-machines/windows/toc.json)
-   [Создание и тестирования виртуальной машины Windows из образа](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-create-vm-generalized-managed?toc=/azure/virtual-machines/windows/toc.json)
-   [Как устранить распространенные неполадки, возникающие в процессе создания виртуального жесткого диска](../cloud-partner-portal/virtual-machine/cpp-common-vhd-creation-issues.md)

Когда ваш VHD готов, можете приступить к заполнению этого раздела.  Ниже приведены сведения о некоторых полях.

### <a name="recommended-vm-sizes"></a>Рекомендуемые размеры виртуальных машин

Выберите до шести рекомендуемых размеров виртуальных машин. Эти рекомендации отображаются для клиентов в Azure Marketplace и в колонке "Ценовая категория" на портале Azure, когда они примут решение приобрести и развернуть ваш образ. *Эти размеры приведены в качестве рекомендаций. Клиент может выбрать любой размер виртуальной машины, который соответствует дискам, указанным в образе.*  На следующем снимке экрана показаны рекомендуемые размеры виртуальных машин, которые клиент увидит на портале Azure.


![Рекомендуемые размеры виртуальных машин](./media/cloud-partner-portal-publish-virtual-machine/publishvm9.png)


### <a name="open-ports"></a>Открытие портов

Укажите порты, которые нужно сделать доступными. Эти порты открываются во время развертывания виртуальных машин.

### <a name="adding-vm-images"></a>Добавление образов виртуальных машин

Следующим шагом является добавление образа виртуальной машины для вашего номера SKU. Можно добавить до восьми версий диска на номер SKU. В Azure Marketplace будет отображаться только наибольший номер версии диска для конкретного SKU. Другие можно просмотреть посредством API.

В разделе **версии диска** выберите **+ New version** (+ Новая версия). В этом разделе появятся поля, которые необходимо заполнить.

#### <a name="vm-image-version"></a>VM image version (Версия образа виртуальной машины)

Версия образа виртуальной машины должна соответствовать формату [семантической версии](http://semver.org/). Формат версии должен иметь вид X.Y.Z, где X, Y и Z являются целыми числами. Образы в разных номерах SKU могут иметь различные основные и дополнительные версии. Версии в номере SKU должны изменяться только пошагово, увеличивая версию исправления (Z из X.Y.Z).

#### <a name="os-vhd-url"></a>OS VHD URL (URL-адрес VHD операционной системы)

Введите [URI подписанного URL-адреса](../cloud-partner-portal/virtual-machine/cpp-get-sas-uri.md), созданного для VHD с операционной системой.

Если с этим номером SKU сопоставлены диски данных, можно добавить их, выбрав ссылку **+ New data disk** (+ Новый диск данных). Появятся дополнительные поля для заполнения.

#### <a name="lun-vhd-url"></a>LUN VHD URL (URL-адрес VHD LUN)

Введите [URI подписанного URL-адреса](../cloud-partner-portal/virtual-machine/cpp-get-sas-uri.md) для диска данных.

#### <a name="lun-number"></a>LUN Number (Номер LUN)

Назначьте номер для LUN. Такой номер будет зарезервирован для этого диска данных в рамках этого номера SKU.

>[!Note]
>После публикации номера SKU с заданными значениями для версии виртуальной машины и дисков данных эти сведения блокируются и не могут быть изменены. Для любых дополнительных версий виртуальной машины, добавляемых в номер SKU, число поддерживаемых дисков данных изменяться не может.

#### <a name="common-sas-url-issues--fixes"></a>Распространенные проблемы с URL-адресом SAS и способы их устранения

| Проблема                                                                 | Сообщение                                                                           | Исправление                                                           |  Ссылка на документацию                                                                                |
|---------------------------------------------------------------------  |-------------------------------------------------------------------------------    |-----------------------------------------------------------    |---------------------------------------------------------------------------------------------------    |
| Сбой при копировании образов: знак "?" не найден в URL-адресе SAS.                | сбой: копирование образов. Не удалось скачать большой двоичный объект с помощью указанного URI SAS.       | Обновите URL-адрес SAS с помощью рекомендуемых средств.                    | https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/     |
| Сбой при копировании образов: параметры st и se отсутствуют в URL-адресе SAS.   | сбой: копирование образов. Не удалось скачать BLOB-объект с помощью указанного URI SAS.        | Обновите URL-адрес SAS, указав правильные даты начала и окончания срока действия.             | https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/     |
| Сбой при копировании образов: параметр sp=rl отсутствует в URL-адресе SAS.                    | сбой: копирование образов. Не удалось скачать BLOB-объект с помощью указанного URI SAS.         | Обновите URL-адрес SAS, указав разрешения на чтение и создание списка.     | https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/     |
| Сбой при копировании образов: URL-адрес SAS в имени VHD-файла содержит пробелы.     | сбой: копирование образов. Не удалось скачать BLOB-объект с помощью указанного URI SAS.        | Обновите URL-адрес, удалив пробелы.                       | https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/     |
| Сбой при копировании образов: ошибка авторизации URL-адреса SAS.               | сбой: копирование образов. Не удалось скачать BLOB-объект из-за ошибки авторизации.     | Создайте URL-адрес SAS повторно.                                        | https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/     |


## <a name="to-configure-the-marketplace"></a>Настройка Marketplace

В представлении Marketplace можно настроить поля, которые отображаются для предложения в [Azure Marketplace](https://azuremarketplace.microsoft.com) и на [портале Azure](https://portal.azure.com/).

### <a name="preview-subscription-ids"></a>Preview Subscription Ids (Идентификаторы подписок для предварительного просмотра)

Список идентификаторов подписок Azure, которые должны получить доступ к предложению после его публикации. Эти разрешенные подписки позволяют протестировать предложение перед его активацией. Партнерский портал позволяет разрешить до 100 подписок.

### <a name="suggested-categories"></a>Suggested Categories (Предлагаемые категории)

Выберите из предоставленного списка до пяти категорий, которые точнее всего описывают ваше предложение. Выбранные категории будут использоваться для сопоставления вашего предложения с категориями продуктов, доступными в [Azure Marketplace](https://azuremarketplace.microsoft.com) и на [портале Azure](https://portal.azure.com/).

В следующих примерах показаны сведения о Marketplace в Azure Marketplace и на портале Azure.

**Azure Marketplace**


![publishvm10](./media/cloud-partner-portal-publish-virtual-machine/publishvm10.png)


![publishvm11](./media/cloud-partner-portal-publish-virtual-machine/publishvm11.png)


![publishvm15](./media/cloud-partner-portal-publish-virtual-machine/publishvm15.png)


**портал Azure**


![publishvm12](./media/cloud-partner-portal-publish-virtual-machine/publishvm12.png)


![publishvm13](./media/cloud-partner-portal-publish-virtual-machine/publishvm13.png)


### <a name="logo-guidelines"></a>Рекомендации по логотипам

Следуйте приведенным ниже указаниям для логотипов, передаваемых на портал Cloud Partner.

-   Дизайн Azure отличается простой цветовой палитрой. Используйте в логотипах небольшое число основных и дополнительных цветов.

-   Цвета темы портала Azure — белый и черный. Старайтесь не использовать эти цвета для фона своих логотипов. Используйте цвета, которые сделают ваши логотипы четко видимыми на портале Azure. Мы рекомендуем простые основные цвета.

    >[!Note] 
    >Если вы используете прозрачный фон, логотип и текст не должны быть белого, черного или синего цвета.

-   Не используйте в логотипе градиентный фон.

-   Старайтесь не размещать в логотипе текст, включая название компании или торговую марку.  Логотип должен быть *плоским*. Также избегайте градиентов.

-   Логотип не должен быть растянутым.

#### <a name="hero-logo"></a>Имиджевый логотип

Имиджевый логотип использовать необязательно. Издатель может не загружать такой логотип. После передачи логотип нельзя удалить. Партнер также должен следовать рекомендациям для имиджевых логотипов Azure Marketplace.

#### <a name="guidelines-for-the-hero-logo-icon"></a>Рекомендации для значка имиджевого логотипа

-   Отображаемое имя издателя, название плана и развернутая сводка предложения отображаются в белом цвете. Не используйте светлые цвета для фона. Фон имиджевого значка не может быть черным, белым или прозрачным.

-   Как только предложение вносится в список, в имиджевый логотип программно вставляется отображаемое имя издателя, название плана, развернутая сводка предложения и кнопка "Создать". Не вводите текст при разработке имиджевого логотипа. Оставьте справа от логотипа пустое место размером 415 x 100 пикселей, смещенное на 370 пикселей от левого края.

![Пример имиджевого логотипа](./media/cloud-partner-portal-publish-virtual-machine/publishvm14.png)

### <a name="lead-management"></a>Управление интересами

Чтобы настроить параметры управления интересами для предложения, следуйте приведенным [здесь](./cloud-partner-portal-get-customer-leads.md) инструкциям.

## <a name="to-configure-support"></a>Настройка поддержки

Используйте представление поддержки, чтобы указать следующие сведения:

- контактные данные службы поддержки компании, например инженеров;
- контактные данные службы поддержки клиентов.

## <a name="to-publish-the-offer"></a>Публикация предложения

Последним шагом является публикация предложения. Выполните [приведенные ниже инструкции, чтобы опубликовать предложение](./cloud-partner-portal-make-offer-live-on-azure-marketplace.md).
