.<properties
    pageTitle="Свойства роли Azure"
    description="Узнайте, как использовать набор средств Azure для Eclipse для настройки роли Azure."
    services=""
    documentationCenter="java"
    authors="rmcmurray"
    manager="wpickett"
    editor=""/>

.<tags
    ms.service="multiple"
    ms.workload="na"
    ms.tgt_pltfrm="multiple"
    ms.devlang="Java"
    ms.topic="article"
    ms.date="08/11/2016" 
    ms.author="robmcm"/>

<!-- Legacy MSDN URL = https://msdn.microsoft.com/library/azure/hh690945.aspx -->

# Свойства роли Azure #

В наборе средств Azure для Eclipse можно задать различные параметры конфигурации роли Azure.

## Настройка свойств роли Azure ##

Для настройки свойств роли Azure используются диалоговые окна свойств рабочей роли. На панели обозревателя проектов Eclipse откройте контекстное меню для роли и выберите подменю **Azure**. (Если в обозревателе проектов Eclipse роль не отображается, разверните в нем проект Azure.)

![][ic789599]

В этом разделе содержатся сведения о различных свойствах, которые можно задать в диалоговых окнах **Свойства**. Обратите внимание, что многие свойства заполняются автоматически при создании проекта развертывания Azure.

Для ролей Azure доступны следующие страницы свойств.

* [Свойства виртуальной машины](#virtual_machine_properties)
* [Свойства кэширования](#caching_properties)
* [Свойства сертификатов](#certificates_properties)
* [Свойства компонентов](#components_properties)
* [Свойства отладки](#debugging_properties)
* [Свойства конечных точек](#endpoints_properties)
* [Свойства переменных среды](#environment_variables_properties)
* [Свойства балансировки нагрузки и свойства сходства сеансов (называемые также прикрепленными сеансами)](#session_affinity_properties)
* [Свойства локального хранилища](#local_storage_properties)
* [Свойства конфигурации сервера](#server_configuration_properties)
* [Свойства разгрузки SSL](#ssl_offloading_properties)
	
<a name="virtual_machine_properties"></a>
### Свойства виртуальной машины ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Свойства**. В открывшемся окне можно изменить размер виртуальной машины и количество экземпляров, как показано на следующем рисунке.

![][ic719499]

>[AZURE.NOTE] Только для Windows. Если для количества экземпляров задать значение больше 1, а также настроить сервер приложений, набор средств позволит запустить в эмуляторе только один экземпляр роли независимо от этого параметра. Это позволяет избежать конфликтов привязки портов между разными экземплярами сервера (например, все экземпляры пытаются выполнить привязку к порту 8080) при их запуске на одном компьютере. Указанное значение количества экземпляров сохраняется, но вступает в силу только при развертывании в облаке.

<a name="caching_properties"></a>
### Свойства кэширования ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Кэширование**. В этом диалоговом окне можно включать именованные совместно размещенные кэши, совместимые с memcache, позволяющие ускорить выполнение веб-приложений.

![][ic719483]

На странице свойств **Кэширование** можно задать следующие общие параметры:

* включено ли совмещенное кэширование;
* размер кэша в виде процента от объема памяти;
* имя учетной записи хранения для сохранения состояния кэша при запуске приложения в качестве облачной службы (если сохранять состояние кэша не требуется, учетную запись задавать не нужно). (При выполнении приложения в эмуляторе вычислений имя учетной записи хранения не используется.) Если задать для имени учетной записи хранения значение **(автоматически)** (значение по умолчанию), конфигурация кэша будет автоматически использовать ту же учетную запись хранения, которая выбрана в диалоговом окне **Публикация в Azure**.

>[AZURE.NOTE] Параметр **(автоматически)** подействует нужным образом, только если публикация развертывания выполняется с помощью мастера публикации из набора средств Eclipse. Если CSPKG-файл публикуется вручную с помощью внешнего механизма, такого как [портал управления Azure][], развертывание будет работать неправильно.

В следующем диалоговом окне отображаются свойства кэша.

![][ic719501]

* **Имя**. Имя совместно размещенного кэша.
* **Номер порта**. Номер порта, используемого для кэша.
* **Политика истечения срока действия**. Для этого свойства задается одно из значений ниже, указывающих на время истечения срока действия ключа в кэше.
    * **Абсолютный**. Срок действия ключа истекает по достижении значения времени, заданного в параметре **Срок действия (мин.)**.
    * **Не имеет срока действия**. Ключ не имеет срока действия.
    * **Скользящее окно**. Срок действия ключа истекает, если доступ к нему не осуществлялся в течение времени, заданного в параметре **Срок действия (мин.)**. При каждом доступе к ключу происходит сброс срока.
* **Срок действия (мин.)**. Максимальное количество минут действия ключа memcached согласно политике истечения срока действия.
* **Высокая доступность с использованием реплицированных резервных копий в различных экземплярах ролей**. Если этот параметр включен, высокий уровень доступности обеспечивается за счет использования реплицированных резервных копий в различных экземплярах ролей. Обратите внимание, чтобы эта функция работала, в развертывании должны работать по крайней мере два экземпляра роли.

Чтобы добавить новый кэш, нажмите кнопку **Добавить** на странице свойств **Кэширование**, после чего откроется диалоговое окно **Настройка именованного кэша**. Укажите значения для свойств, которые описаны выше.

Чтобы изменить именованный кэш, выберите его и нажмите кнопку **Изменить** на странице свойств **Кэширование**. Откроется диалоговое окно для изменения свойств кэша. Нажмите кнопку **ОК**, чтобы сохранить значения кэша.

Чтобы удалить кэш, выберите его и нажмите кнопку **Удалить** на странице свойств **Кэширование**, а затем нажмите кнопку **Да** для подтверждения удаления.

Дополнительные сведения о том, как использовать кэширование, см. в разделе [Как использовать совмещенное кэширование][].

<a name="certificates_properties"></a>
### Свойства сертификатов ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Сертификаты**.

![][ic710964]

В этом диалоговом окне можно добавлять или удалять сертификаты, на которые ссылается проект Eclipse. Обратите внимание, что указанные здесь сертификаты не сохраняются автоматически в хранилище ключей Java и, следовательно, не являются автоматически доступными для использования в приложении Java. Они только зарегистрированы в Azure, поэтому их можно предварительно скачать в хранилище сертификатов Windows на виртуальных машинах, работающих в развертывании, и впоследствии использовать с другим программным обеспечением Windows. В настоящее время единственный компонент в наборе средств, который таким образом использует сертификаты в диалоговом окне **Сертификаты**, — [разгрузка SSL][]. Это связано с его зависимостью от служб IIS и маршрутизации запросов приложения (ARR), для которых требуется предоставить доступ к нужному сертификату указанным способом.

При развертывании проекта в Azure с помощью мастера публикации появится запрос на указание PFX-файлов, соответствующих этим сертификатам, и паролей для их автоматической отправки в службу Azure (но только если они не были отправлены туда ранее).

<a name="components_properties"></a>
### Свойства компонентов ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Компоненты**. В этом диалоговом окне можно добавлять, изменять или удалять компоненты роли, а также изменять порядок их обработки.

![][ic719502]

Этот компонент позволяет добавлять зависимости в проект развертывания Azure, например проекты приложений Java, специальные файлы и исполняемые операторы командной строки, необходимые для развертывания.

Для каждого компонента указываются следующие данные:

* шаг, выполняемый при импорте компонента в проект развертывания Azure при его создании;
* шаг, выполняемый при развертывании этого компонента в облаке Azure.

>[AZURE.NOTE] Указывая файлы компонентов или командные строки, имейте в виду, что развертывание будет опубликовано на виртуальной машине Windows, поэтому дополнительные действия должны поддерживаться в операционной системе Windows.

Компоненты содержат следующие свойства.

* **Импорт**. Метод, который указывает способ импорта компонента в проект при создании проекта. Он может принимать одно из перечисленных ниже значений.
    * **copy**. Компонент копируется из локального пути, указанного свойством **Из**, в каталог роли **approot**.
    * **EAR**. Компонент является корпоративным архивом Java (EAR), импортированным из проекта корпоративного приложения по локальному пути, указанному свойством **Из**. (Набор средств определяет этот момент автоматически с учетом характера проекта в этом расположении.)
    * **JAR**. Компонент является архивом Java (JAR), который импортируется из проекта Java по локальному пути, указанному свойством **Из**. (Набор средств определяет этот момент автоматически с учетом характера проекта в этом расположении.)
    * **none**. Никаких действий для импорта компонента не предпринимается. Этот метод применим, если предполагается, что компонент уже находится в каталоге роли **approot** или компонент является просто исполняемым оператором командной строки, как указано в свойстве **Как**, если для метода **Развертывание** задано значение **exec**.
    * **WAR**. Компонент является архивом веб-приложения Java (JAR), который импортируется из динамического веб-проекта по локальному пути, указанному свойством **Из**. (Набор средств определяет этот момент автоматически с учетом характера проекта в этом расположении.)
    * **zip**. Компонент является ZIP-файлом, который импортируется путем сжатия каталога или файла, указанного свойством **Из**.
* **Из**. Исходный путь на локальном компьютере к папке или файлу, представляющему элементы для импорта в развертывание. В этом свойстве можно использовать переменные среды Windows. Все импортируемые компоненты будут импортированы в каталог роли **approot** при создании проекта.
	
	Обратите внимание, что компонент можно развертывать из пакета скачивания при развертывании в облаке (не в эмуляторе вычислений). См. соответствующие сведения о добавлении компонента ниже.
	
* **Как**. Имя файла, с которым компонент будет импортирован в каталог роли **approot** и в конечном итоге развернут в облаке Azure. Оставьте это свойство пустым, чтобы сохранить такое же имя, как и на локальном компьютере. (Для исполняемых компонентов, то есть для которых используется метод **Развертывание** со значением **exec**, это может быть произвольный оператор командной строки Windows.)

	>[AZURE.IMPORTANT] Пробелы, используемые для этого значения, будут обрабатываться по-разному в зависимости от метода развертывания. В методе развертывания **exec** пробелы будут интерпретироваться как разделители аргументов командной строки, а не часть имени файла. Для остальных методов развертывания пробелы будут интерпретироваться как часть имени файла.
	
* **Развертывание**. Метод, который указывает действие, примененное к компоненту при начале развертывания. Он может принимать одно из перечисленных ниже значений.
    * **copy**. Компонент копируется в целевой путь, указанный свойством **В**.
    * **exec**. Компонент является исполняемым оператором командной строки Windows, выполняемым в контексте пути, указанном свойством **В**, во время запуска развертывания.
    * **none**. При запуске развертывания к компоненту не применяются никакие действия.
    * **zip**. Компонент распаковывается в целевом пути, указанном свойством **В**. Этот метод доступен, только если для свойства **Импорт** задано значение **zip**.
* **В**. Целевой путь на виртуальной машине, на которой будет развернут компонент. В этом свойстве можно использовать переменные среды Windows, а пути к файлам указываются относительно **approot**.
	
Чтобы добавить новый компонент, нажмите кнопку **Добавить** на странице свойств **Компоненты**, после чего откроется диалоговое окно **Компонент роли Azure**. Укажите значения для свойств, которые описаны выше.

Ниже приведен пример добавления нового компонента WAR.

![][ic719503]

Если при развертывании в облаке (не в эмуляторе вычислений), необходимо развернуть компонент из пакета скачивания, убедитесь, что установлен флажок **При развертывании в облаке не включать в пакет, а развернуть из**. Чтобы выполнить скачивание из учетной записи хранения Azure, выберите учетную запись хранения в раскрывающемся списке **Учетная запись хранения** (для изменения содержимого списка можно щелкнуть ссылку **Учетные записи**), которая частично заполнит поле **URL-адрес**, а затем допишите оставшуюся часть URL-адреса. Если использовать службу хранилища Azure не требуется, выберите пункт **(нет)** в раскрывающемся списке **Учетная запись хранения** и в поле **URL-адрес** введите URL-адрес компонента. Укажите один из следующих методов.

* **copy**. Компонент скачивания копируется в целевой путь, указанный в свойстве **Целевой каталог**.
* **same**. Для параметра **Развернуть из пакета скачивания** используется тот же метод, что и для параметра **Развернуть из пакета**.
* **zip**. Компонент скачивания распаковывается в целевой путь, указанный в свойстве **Целевой каталог**.

Чтобы изменить компонент, выберите его и нажмите кнопку **Изменить** на странице свойств **Компоненты**. Откроется диалоговое окно для изменения свойств компонента. Нажмите кнопку **ОК**, чтобы сохранить значения компонента.

Чтобы удалить компонент, выберите его и нажмите кнопку **Удалить** на странице свойств **Компоненты**, а затем нажмите кнопку **Да** для подтверждения удаления.

Компоненты обрабатываются в указанном порядке. Задайте нужный порядок с помощью кнопок **Вверх** и **Вниз**.

>[AZURE.NOTE] Конфигурация сервера также зависит от компонентов. Эти компоненты нельзя удалять или изменять без удаления соответствующей конфигурации сервера. При попытке внести изменения в такие компоненты появится соответствующий запрос.

<a name="debugging_properties"></a>
### Свойства отладки ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Отладка**. В этом диалоговом окне можно включать или отключать удаленную отладку, а также создавать конфигурации отладки, как показано на следующем рисунке.

![][ic719504]

Дополнительные сведения об отладке см. в статье [Отладка приложения Azure в Eclipse][].

<a name="endpoints_properties"></a>
### Свойства конечных точек ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Конечные точки**. В этом диалоговом окне можно создавать, изменять или удалять конечные точки, как показано на следующем рисунке.

![][ic719505]

Чтобы добавить конечную точку, нажмите кнопку **Добавить** на странице свойств **Конечные точки**, после чего откроется диалоговое окно **Добавление конечной точки**.

![][ic710897]

Введите имя для конечной точки, выберите тип (**Входная**, **Внутренняя** или **Входная конечная точка экземпляра**) и укажите общий и частный порты. Нажмите кнопку **ОК**, чтобы сохранить новые значения конечной точки.

В зависимости от типа конечной точки диапазоны портов используются следующим образом.

* Для общего порта входной конечной точки экземпляра можно указать диапазон портов (например, **2000–2010**), а для частного порта — фиксированное значение.
* Для внутренней конечной точки общий порт не используется, а для частного порта можно задать диапазон, оставить пустое значение или указать звездочку, что означает, что Azure автоматически назначит значение.
* Для входных конечных точек общий порт может иметь только фиксированное значение, а для частного порта можно задать фиксированное значение, оставить пустое значение или указать звездочку, что означает, что Azure автоматически назначит значение.

Если вместо диапазона номеров нужно использовать один номер порта, оставьте текстовое поле для конца диапазона пустым.

Чтобы определить, какой из автоматически устанавливаемых портов фактически используется во время выполнения, приложение может использовать API среды выполнения службы Azure, который описан на странице по адресу [com.microsoft.windowsazure.serviceruntime package summary][].

Сведения об использовании входных конечных точек экземпляров в процессе отладки развертывания из нескольких экземпляров см. в статье [Отладка конкретного экземпляра роли в развертывании из нескольких экземпляров][].

Чтобы изменить конечную точку, выберите ее и нажмите кнопку **Изменить** на странице свойств **Конечные точки**. Откроется диалоговое окно для изменения имени конечной точки, ее типа, а также общего и частного портов. Нажмите кнопку **ОК**, чтобы сохранить измененные значения конечной точки.

Чтобы удалить конечную точку, выберите ее и нажмите кнопку **Удалить** на странице свойств **Конечные точки**, а затем нажмите кнопку **Да** для подтверждения удаления.

Для правильной настройки некоторых функций (таких как кэширование, удаленная отладка, сходство сеансов или разгрузка SSL), включенных пользователем в роли, набор средств предусматривает автоматическую настройку специальных конечных точек, которые отображаются вместе с конечными точками, определяемыми пользователем. Набор средств предотвращает изменение или удаление автоматически созданных конечных точек в течение всего времени, пока включен связанный компонент.

<a name="environment_variables_properties"></a>
### Свойства переменных среды ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Переменные среды**. В этом диалоговом окне можно создавать, изменять или удалять переменные среды, как показано на следующем рисунке.

![][ic719506]

Переменные среды доступны для сценария запуска при запуске роли.

>[AZURE.NOTE] Указывая переменные среды, имейте в виду, что развертывание будет опубликовано на виртуальной машине Windows, поэтому переменные среды должны поддерживаться в операционной системе Windows.

В качестве примера переменной среды, доступной при запуске роли, создайте переменную среды, нажав кнопку **Добавить**. Далее показано создание переменной среды с именем **MyRoleVersion** и назначение ей значения **1.0**.

![][ic659268]

В коде jsp отобразить значение можно с помощью метода `System.getenv`:

    <body>
      <b> Hello World!</b>
      <p>Running role version: <%= System.getenv("MyRoleVersion") %></p>
    </body>

При запуске приложения получим следующий результат:

![][ic552233]

Чтобы изменить переменную среды, выберите ее и нажмите кнопку **Изменить** на странице свойств **Переменные среды**. Откроется диалоговое окно для изменения свойств переменной среды. Нажмите кнопку **ОК**, чтобы сохранить значения переменных среды.

Чтобы удалить переменную среды, выберите ее и нажмите кнопку **Удалить** на странице свойств **Переменные среды**, а затем нажмите кнопку **Да** для подтверждения удаления.

Для правильной настройки некоторых функций (таких как конфигурация сервера, удаленная отладка или локальное хранилище), включенных пользователем в роли, набор средств предусматривает автоматическую настройку специальных переменных среды, которые будут указываться вместе с переменными, определяемыми пользователями. Набор средств предотвращает изменение или удаление автоматически созданных переменных среды в течение всего времени, пока включен связанный компонент.

<a name="session_affinity_properties"></a>
### Свойства балансировки нагрузки и свойства сходства сеансов (называемые также прикрепленными сеансами) ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Балансировка нагрузки**. В этом диалоговом окне можно включать или отключать сходство сеансов, как показано на следующем рисунке.

![][ic719492]

Дополнительную информацию см. в статье [Сходство сеанса][]. Кроме того, обратите внимание на поведение этой функции в контексте разгрузки SSL, как описано в статье [Разгрузка SSL][].

<a name="local_storage_properties"></a>
### Свойства локального хранилища ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Локальное хранилище**. В этом диалоговом окне можно создавать, изменять или удалять временное локальное хранилище для виртуальной машины, на которой выполняется приложение. Для размера локального хранилища можно задать конкретные значения. Кроме того, можно указать необходимость сохранения содержимого во время перезапуска роли, как показано на следующем рисунке.

![][ic719508]

Можно также указать переменную среды, которая относится к локальному хранилищу.

По умолчанию все компоненты, развертываемые в Azure, размещаются (и распаковываются) в папке **approot** экземпляра роли. Несмотря на то, что большая часть простых развертываний помещается в папке даже после распаковки, пространство, выделенное для каталога **approot**, ограничено и не является четко определенным (целесообразно выделять не менее 1 ГБ). Таким образом, чтобы выделять в Azure достаточно дискового пространства для более крупных развертываний, размер которых может не соответствовать месту в папке **approot**, необходимо настроить локальный ресурс хранилища с помощью параметров в диалоговом окне **Локальное хранилище**. Простой способ выполнения этой задачи приведен в статье [Развертывание крупных развертываний][].

На ресурс хранилища можно легко ссылаться из сценариев запуска (например, из **startup.cmd**) с помощью переменной среды, автоматически связываемой набором средств Eclipse с ресурсом, как показано в диалоговом окне **Локальное хранилище**. Переменная среды будет содержать полный путь к локальному ресурсу, настроенному во время выполнения сценария запуска.

Чтобы изменить локальный ресурс хранилища, выберите его и нажмите кнопку **Изменить** на странице свойств **Локальное хранилище**. Откроется диалоговое окно для изменения свойств локального ресурса хранилища. Нажмите кнопку **ОК**, чтобы сохранить значения локального ресурса хранилища.

Чтобы удалить локальный ресурс хранилища, выберите его и нажмите кнопку **Удалить** на странице свойств **Локальное хранилище**, а затем нажмите кнопку **Да** для подтверждения удаления.

<a name="server_configuration_properties"></a>
### Свойства конфигурации сервера ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Конфигурация сервера**. В этом диалоговом окне можно добавлять, удалять и изменять сервер приложений JDK и Java, используемый для развертывания, а также добавлять или удалять приложения (такие как файлы WAR, JAR или EAR), используемые развертыванием.

### Конфигурация JDK ###

В этом диалоговом окне можно указать пакет JDK, который будет использоваться для развертывания. При использовании Eclipse в Windows можно указать пакет JDK для локального применения при выполнении в эмуляторе Azure. Кроме того, эту локальную установку можно развернуть в Azure. В операционных системах, отличных от Windows, параметр JDK эмулятора не применяется, а локально установленный JDK нельзя развернуть, так как он не совместим с Windows. Тем не менее, независимо от используемой операционной системы, всегда можно выбрать сторонние пакеты JDK для развертывания в Azure или указать собственный совместимый с Windows пакет JDK из расположения альтернативного скачивания.

Ниже приведен пример указания JDK в Windows:

![][ic780647]

При использовании Eclipse в Windows можно указать пакет JDK для использования с эмулятором вычислений. Для этого убедитесь, что в разделе **Развертывание эмулятора** установлен флажок **Использовать JDK по этому пути к файлу для локального тестирования**. Затем укажите локальный путь к JDK. Если нужный JDK не выбирается автоматически, можно перейти к другим JDK. Кроме того, JDK можно развернуть в облачной службе Azure. Для этого в разделе **Облачное развертывание** выберите параметр **Развернуть мой локальный JDK (автоматически отправить в облачное хранилище)**.

Примечание. В операционных системах, отличных от Windows, параметры **Развертывание эмулятора** и **Развернуть мой локальный JDK** недоступны. В следующем примере демонстрируется указание JDK на компьютере Mac или в другой поддерживаемой ОС, отличной от Windows:

![][ic789643]

Независимо от текущей операционной системы для источника и типа пакета JDK есть два следующих параметра **Облачное развертывание**:

* **Развернуть сторонний пакет JDK, доступный в Azure;**
* **Развернуть из пакета пользовательского скачивания.**

При использовании параметра **Развернуть сторонний пакет JDK, доступный в Azure** сделайте следующее:

1. Установите флажок **Развернуть сторонний пакет JDK, доступный в Azure**.
1. В раскрывающемся списке выберите сторонний пакет JDK, доступный в Azure.
1. Вкладка **JDK** в Windows будет выглядеть следующим образом: ![][ic780648]. В Mac OS или других поддерживаемых ОС, отличных от Windows, вкладка будет выглядеть следующим образом: ![][ic789643].
1. Нажмите кнопку **ОК**, чтобы сохранить изменения.
1. При отображении запроса на принятие лицензионного соглашения от стороннего поставщика пакета JDK ознакомьтесь с условиями лицензии. Если вы принимаете условия, нажмите кнопку **Да**, чтобы закрыть диалоговое окно **Принятие лицензионного соглашения**. Обратите внимание, что базовую логику, элементы для которой отображаются в раскрывающемся списке для параметра **Развернуть сторонний пакет JDK, доступный в Azure**, можно настроить. Чтобы настроить элементы, в диалоговом окне **JDK** щелкните ссылку **Настройка**. Страница свойств **JDK** закроется, а в Eclipse откроется файл **componentsets.xml**, который при необходимости можно изменить. Документация по файлу **componentsets.xml** находится в самом файле **componentsets.xml**.

При использовании параметра **Развернуть JDK из пакета пользовательского скачивания** сделайте следующее:

1. Создайте ZIP-файл каталога установки JDK, причем узел каталога должен быть дочерним элементом структуры ZIP, а не его содержимым. Запишите имя каталога, так как оно понадобится позже, и имейте в виду, что эта установка JDK будет развернута на виртуальной машине Windows.
1. Отправьте ZIP-файл в учетную запись хранения Azure в виде большого двоичного объекта. Это можно сделать с помощью внешнего средства для отправки больших двоичных объектов в службу хранилища Azure. Рекомендуется использовать частный большой двоичный объект. Запишите URL-адрес большого двоичного объекта содержимого ZIP-файла.
1. Установите флажок **Развернуть JDK из пакета пользовательского скачивания**. Чтобы выполнить скачивание из учетной записи хранения Azure, выберите учетную запись хранения в раскрывающемся списке **Учетная запись хранения** (для изменения содержимого списка можно щелкнуть ссылку **Учетные записи**), которая частично заполнит поле **URL-адрес**, а затем допишите оставшуюся часть URL-адреса. Если использовать службу хранилища Azure не требуется, выберите пункт **(нет)** в раскрывающемся списке **Учетная запись хранения** и в поле **URL-адрес** введите URL-адрес к скачиваемому пакету JDK. При использовании службы хранилища Azure имена больших двоичных объектов в URL-адресе должны состоять из строчных букв.
1. Убедитесь, что текстовое поле **JAVA\_HOME** ссылается на правильный каталог. По умолчанию оно будет совпадать с именем каталога JDK, выбранного для локального использования. Однако если каталог, содержащийся в ZIP-файле, имеет другое имя (например, из-за использования разных версий), соответствующим образом обновите имя каталога в текстовом поле **JAVA\_HOME**, так как этот параметр будет использоваться в облаке (не в эмуляторе вычислений).
1. Нажмите кнопку **ОК**, чтобы сохранить изменения.

Вот и все. Теперь, выполняя сборку для облака, вы заметите, что размер пакета будет намного меньше, процесс сборки обычно будет занимать меньше времени и само развертывание при публикации в облако также будет происходить быстрее. Обратите внимание, что параметры **Развернуть мой локальный JDK (автоматически отправить в облачное хранилище)** или **Развернуть JDK из пакета пользовательского скачивания** будут действовать, только если приложение развернуто в облаке. Они не влияют на работу эмулятора вычислений. При развертывании в эмуляторе вычислений будет по-прежнему использоваться локальная версия компонентов.

### Конфигурация сервера ###

Ниже приведен пример указания сервера приложений.

![][ic796926]

Убедитесь, что установлен флажок **Развернуть сервер этого типа**, а затем выберите тип сервера приложений, который нужно использовать.

Чтобы указать сервер для использования в облачном развертывании, можно воспользоваться следующими параметрами.

1. **Развернуть сторонний сервер, доступный в Azure**. Этот параметр хорошо подходит для сценариев разработки и тестирования, где эффективность и простота развертывания имеют наивысший приоритет, а для сервера не требуется выполнять пользовательскую настройку. Или если нужно использовать один из этих серверов в качестве отправной точки, и в тоже время включить действия по настройке соответствующего сервера в логику запуска развертывания.
1. **Развернуть из пакета пользовательского скачивания**. Этот параметр хорошо подходит для рабочих сценариев со специально подготовленным и настроенным сервером, который будет использоваться в облаке.
1. **Развернуть установку моего локального сервера**. Этот параметр особенно применим в случае, если установка локального сервера уже имеет пользовательские настройки для использования. Если выбран этот параметр, необходимо также указать путь локального сервера в текстовом поле **Путь локального сервера** ниже.

При использовании параметра **Развернуть сторонний сервер, доступный в Azure** сделайте следующее:

1. Установите флажок **Развернуть сторонний сервер, доступный в Azure**.
1. В раскрывающемся меню выберите нужное серверное программное обеспечение для использования в процессе развертывания в облаке. Обратите внимание, если тип сервера для использования уже указан, то выбор будет ограничен только облачным сервером из того же семейства, что и этот тип сервера. Но если тип сервера не выбран, можно выбрать любой из серверов, доступных в настоящий момент в Azure, и тип сервера будет выбран автоматически.
1. Нажмите кнопку **ОК**, чтобы сохранить изменения.

При использовании параметра **Развернуть из пакета пользовательского скачивания** сделайте следующее:

1. Убедитесь, что тип сервера выбран в соответствии с предыдущими шагами. Так подключаемый модуль узнает о развертывании сервера из пакета пользовательского скачивания, так как он должен быть из того же семейства, что и выбранный тип сервера.
1. Установите флажок **Развернуть из пакета пользовательского скачивания**. Чтобы выполнить скачивание из учетной записи хранения Azure, выберите учетную запись хранения в раскрывающемся списке **Учетная запись хранения** (для изменения содержимого списка можно щелкнуть ссылку **Учетные записи**), которая частично заполнит поле **URL-адрес**, а затем допишите оставшуюся часть URL-адреса к ZIP-файлу скачивания сервера (при использовании службы хранилища Azure имена больших двоичных объектов в URL-адресе должны состоять из строчных букв). Если использовать службу хранилища Azure не требуется, выберите пункт **(нет)** в раскрывающемся списке **Учетная запись хранения** и в поле **URL-адрес** введите URL-адрес к ZIP-файлу скачивания сервера. ZIP-файл будет содержать дочернюю папку, представляющую каталог установки сервера приложений. Например, при использовании ZIP-файла для Apache Tomcat 7.0.35 внутри файла будет находиться дочерняя папка, представляющая каталог установки, например **apache tomcat-7.0.35**.
1. Укажите значение для переменной среды домашнего каталога. По умолчанию выбирается значение, используемое для локального сервера приложений, если оно существует, но, если облачный сервер приложений отличается от локального сервера приложений, можно указать другое значение. Тем не менее необходимо убедиться, что облачный сервер приложений относится к тому же семейству, что и выбранный ранее тип сервера. При дальнейшем обновлении ZIP-файла облачного сервера приложений можно вручную изменить значение параметра домашнего каталога или сделать его снова соответствующим значению локального параметра (если локальный сервер приложений также изменен).
1. Нажмите кнопку **ОК**, чтобы сохранить изменения.

Базовую логику, элементы для которой отображаются на вкладке **Сервер** на странице свойств **Конфигурация сервера**, можно настроить. Эта дополнительная функция может потребоваться, если нужно выйти за пределы значений по умолчанию или если требуется добавить другие серверы. Чтобы настроить логику, в диалоговом окне **Сервер** щелкните ссылку **Настройка**. Страница свойств **Конфигурация сервера** закроется и в Eclipse откроется файл **componentsets.xml**, который при необходимости можно изменить, чтобы расширить шаблон конфигурации сервера. Документация по файлу **componentsets.xml** находится в самом файле **componentsets.xml**.

При использовании параметра **Развернуть мой локальный сервер (автоматически отправить в облачное хранилище)** сделайте следующее:

1. Установите флажок **Развернуть мой локальный сервер (автоматически отправить в облачное хранилище)**.
1. В раскрывающемся списке **Учетная запись хранения** выберите пункт **(автоматически)**. Если выбран параметр **(автоматически)**, набор средств Eclipse будет использовать ту же учетную запись хранения для сервера, которая выбрана для развертывания в диалоговом окне **Публикация в Azure**.
1. Нажмите кнопку **ОК**, чтобы сохранить изменения.

Выберите путь установки сервера на компьютере в текстовом поле **Путь локального сервера**, если выполняется любое из следующих условий.

* Нужно протестировать развертывание в эмуляторе (относится только к Windows).
* Нужно развернуть локально установленный сервер в облаке.
* Нужно использовать собственный пакет скачивания настраиваемого сервера в облаке. В этом случае необходимо убедиться, что установлен упомянутый выше флажок **Развернуть мой локальный сервер (автоматически отправить в облачное хранилище)**.

Если ни один из перечисленных выше вариантов не соответствует ситуации, параметр локального сервера будет необязательным.

### Конфигурация приложений ###

Ниже приведен пример указания приложения.

![][ic719512]

Нажмите кнопку **Добавить**, чтобы добавить другое приложение, или **Удалить**, чтобы удалить приложение. Если нужно повысить эффективность и использовать скачиваемый файл для источника приложения при развертывании в облаке, воспользуйтесь [свойствами компонентов](#components_properties) для указания URL-адреса, учетной записи хранения и т. д.

Начиная с выпуска, вышедшего в апреле 2014 г., приложения автоматически отправляются в ту же учетную запись хранения (в контейнере **eclipsedeploy**), которая выбрана для развертывания. В логике запуска развертывания предусмотрено действие по скачиванию этих приложений из учетной записи хранения. Это означает, что приложения в развертывании можно обновлять без перестроения и повторного развертывания всего пакета. Более новые версии приложения нужно вручную передать непосредственно в эту учетную запись хранения (например, с помощью портала Azure), заменяя WAR-файлы, изначально загруженные туда набором данных. Затем просто еще раз перезапустите все экземпляры роли с помощью портала управления Azure или с помощью программы командной строки. (В настоящее время перезапуск роли непосредственно из набора средств Eclipse не поддерживается.)

### Примечания о конфигурации сервера ###

Изменения, внесенные на странице свойств **Конфигурация сервера**, отражаются в элементах `<component>` файла package.xml.

Если используется параметр **Автоматически отправить...** или **Развернуть из пакета скачивания...** для JDK или сервера приложений, выполняется сборка для облака (не эмулятора вычислений) и при этом компьютер подключен к сети, при проверке доступности скачивания конструктором Ant в выходных данных консоли можно увидеть сообщения о сборке следующего вида:

`[windowsazurepackage] Verifying blob availability (https://example.blob.core.windows.net/temp/tomcat6.zip)...`

Если выбран параметр **Развернуть из пакета скачивания...**, без остановки процесса сборки может появиться следующее предупреждение:

`[windowsazurepackage] warning: Failed to confirm blob availability! Make sure the URL and/or the access key is correct (https://example.blob.core.windows.net/temp/tomcat6.zip).`

Это предупреждение является единственным указателем того, что доступность скачивания не проверена. Поэтому если по какой-либо причине развертывание в облаке завершается ошибкой, проверьте, не появилось ли это предупреждение.

Чтобы отключить проверку скачивания (например, если вы считаете, что она замедляет сборку), задайте для атрибута `verifydownloads` значение `false` в элементе `<windowsazurepackage>` файла package.xml:

`<windowsazurepackage verifydownloads="false" ...>`

Если выбран параметр **Автоматически отправить...**, в окне консоли будут отображаться сообщения о сборке, каждые 5 секунд информирующие о ходе выполнения процесса отправки.

<a name="ssl_offloading_properties"></a>
### Свойства разгрузки SSL ###

На панели обозревателя проектов Eclipse откройте контекстное меню для роли, выберите **Azure**, а затем щелкните **Разгрузка SSL**.

![][ic719481]

В этом диалоговом окне можно включить разгрузку SSL, что позволяет легко включать поддержку протокола HTTPS в развертывании Java в Azure без необходимости настройки SSL на сервере приложений Java. Дополнительные сведения см. в статьях [Разгрузка SSL][] и [Практическое использование разгрузки SSL][].

## См. также ##

[Набор средств Azure для Eclipse][]

[Установка набора средств Azure для Eclipse][]

[Создание приложения Hello World для Azure в Eclipse][]

[Свойства проекта Azure][]

[Список учетных записей хранения Azure][]

Дополнительные сведения об использовании Azure с Java см. в [центре разработчиков Java для Azure][].

<!-- URL List -->

[центре разработчиков Java для Azure]: http://go.microsoft.com/fwlink/?LinkID=699547
[портал управления Azure]: http://go.microsoft.com/fwlink/?LinkID=512959
[Набор средств Azure для Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699529
[Свойства проекта Azure]: http://go.microsoft.com/fwlink/?LinkID=699524
[Список учетных записей хранения Azure]: http://go.microsoft.com/fwlink/?LinkID=699528
[com.microsoft.windowsazure.serviceruntime package summary]: http://azure.github.io/azure-sdk-for-java/com/microsoft/windowsazure/serviceruntime/package-summary.html
[Создание приложения Hello World для Azure в Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699533
[Отладка конкретного экземпляра роли в развертывании из нескольких экземпляров]: http://go.microsoft.com/fwlink/?LinkID=699535#debugging_specific_role_instance
[Отладка приложения Azure в Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699535
[Развертывание крупных развертываний]: http://go.microsoft.com/fwlink/?LinkID=699536
[Как использовать совмещенное кэширование]: http://go.microsoft.com/fwlink/?LinkID=699542
[Практическое использование разгрузки SSL]: http://go.microsoft.com/fwlink/?LinkID=699545
[Установка набора средств Azure для Eclipse]: http://go.microsoft.com/fwlink/?LinkId=699546
[Сходство сеанса]: http://go.microsoft.com/fwlink/?LinkID=699548
[разгрузка SSL]: http://go.microsoft.com/fwlink/?LinkID=699549

.<!-- IMG List -->

[ic789599]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic789599.png
[ic719499]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719499.png
[ic719483]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719483.png
[ic719501]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719501.png
[ic710964]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic710964.png
[ic719502]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719502.png
[ic719503]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719503.png
[ic719504]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719504.png
[ic719505]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719505.png
[ic710897]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic710897.png
[ic719506]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719506.png
[ic659268]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic659268.png
[ic552233]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic552233.png
[ic719492]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719492.png
[ic719508]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719508.png
[ic780647]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic780647.png
[ic789643]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic789643.png
[ic780648]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic780648.png
[ic789643]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic789643.png
[ic796926]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic796926.png
[ic719512]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719512.png
[ic719481]: ./media/azure-toolkit-for-eclipse-azure-role-properties/ic719481.png

<!---HONumber=AcomDC_0817_2016-->