<properties 
	pageTitle="Перемещение ресурсов в новую группу ресурсов" 
	description="Перемещайте ресурсы в новую группу ресурсов для диспетчера ресурсов Azure с помощью Azure PowerShell или REST API." 
	services="azure-resource-manager" 
	documentationCenter="" 
	authors="tfitzmac" 
	manager="timlt" 
	editor="tysonn"/>

<tags 
	ms.service="azure-resource-manager" 
	ms.workload="multiple" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="04/18/2016" 
	ms.author="tomfitz"/>

# Перемещение ресурсов в новую группу ресурсов или подписку

В этом разделе показано, как перемещать ресурсы из одной группы ресурсов в другую. Можно также перемещать ресурсы в новую подписку (но подписка должна существовать в том же [клиенте](./active-directory/active-directory-howto-tenant.md)). Перемещение ресурсов может потребоваться в следующих случаях:

1. Для выставления счетов ресурс должен находиться в другой подписке.
2. Теперь жизненные циклы этого ресурса и ресурсов, с которыми он ранее был сгруппирован, не совпадают. Ресурс нужно переместить в новую группу ресурсов, чтобы управлять им отдельно от других ресурсов.
3. Теперь жизненные циклы ресурса и остальных ресурсов в другой группе ресурсов совпадают. Ресурс нужно переместить в группу ресурсов с другими ресурсами, чтобы управлять ими вместе.

При перемещении ресурсов группу источника и группа назначения блокируются на время операции. Операции записи и удаления для групп блокируются до завершения перемещения.

Расположение ресурса изменить невозможно. При перемещении ресурс всего лишь перемещается в новую группу ресурсов. Даже если новая группа ресурсов находится в другом расположении, расположение ресурса не меняется.

## Рекомендации перед перемещением ресурсов

Вот некоторые важные особенности, которые следует учитывать перед перемещением ресурса. Проверив эти условия, можно избежать ошибок.

1. Служба должна поддерживать возможность перемещения ресурсов. Ниже приведен список для получения информации о том, какие [службы поддерживают перемещение ресурсов](#services-that-support-move).
2. Подписка назначения должна быть зарегистрирована для перемещаемого поставщика ресурсов. В противном случае вы получите сообщение о том, что **подписка не зарегистрирована для типа ресурса**. Эта проблема может возникнуть при перемещении ресурса в новую подписку, которая никогда не использовалась с этим типом ресурса. Сведения о регистрации поставщиков ресурсов и о проверке состояния регистрации см. в статье [Поставщики и типы ресурсов](../resource-manager-supported-services/#resource-providers-and-types).
3. Если вы используете Azure PowerShell или интерфейс командной строки Azure, убедитесь, что у вас установлена последняя версия. Чтобы обновить текущую версию, запустите установщик веб-платформы Майкрософт и проверьте доступность более новой версии. Дополнительные сведения см. в статьях [Установка и настройка Azure PowerShell](powershell-install-configure.md) и [Установка интерфейса командной строки Azure](xplat-cli-install.md).
4. При перемещении приложения службы приложений необходимо ознакомиться с разделом [Ограничения службы приложений](#app-service-limitations).

## Службы, поддерживающие перемещение

Сейчас к службам, которые поддерживают перемещение в новую группу ресурсов и подписку, относятся:

- Управление API
- Приложения службы приложений (см. [ограничения службы приложений](#app-service-limitations) ниже)
- Автоматизация
- Пакетная служба
- CDN
- Фабрика данных
- DocumentDB
- Кластеры HDInsight
- хранилище ключей;
- Mobile Engagement;
- Центры уведомлений
- Operational Insights;
- Кэш Redis
- Поиск
- База данных SQL Server (см. [ограничения базы данных SQL](#sql-database-limitations) ниже)

## Службы, частично поддерживающие перемещение

Службы с поддержкой перемещения в новую группу ресурсов, но не в новую подписку:

- виртуальные машины (классические);
- служба хранилища (классическая).
- Виртуальные сети
- Облачные службы

## Службы, не поддерживающие перемещение

Службы, которые в настоящее время не поддерживают перемещение ресурсов:

- Виртуальные машины
- Хранилище
- ExpressRoute

## Ограничения службы приложений

При работе с приложениями службы приложений невозможно переместить только план службы приложений. Далее приводятся варианты перемещения приложений службы приложений.

- Переместите все ресурсы из одной группы ресурсов в другую, если в целевой группе нет ресурсов Microsoft.Web.
- Переместите веб-приложения в другую группу ресурсов, но сохраните план службы приложений в исходной группе.

## Ограничения базы данных SQL

Базу данных SQL нельзя переместить отдельно от сервера, на котором она размещается. База данных и сервер должны находиться в одной группе ресурсов. При перемещении сервера SQL Server все его базы данных также перемещаются.

## Перемещение ресурсов с помощью PowerShell

Чтобы переместить существующие ресурсы в другую группу ресурсов или подписку, используйте команду **Move-AzureRmResource**.

В первом примере показано, как переместить один ресурс в новую группу ресурсов.

    $resource = Get-AzureRmResource -ResourceName ExampleApp -ResourceGroupName OldRG
    Move-AzureRmResource -DestinationResourceGroupName NewRG -ResourceId $resource.ResourceId

Во втором примере показано, как переместить несколько ресурсов в новую группу ресурсов.

    $webapp = Get-AzureRmResource -ResourceGroupName OldRG -ResourceName ExampleSite
    $plan = Get-AzureRmResource -ResourceGroupName OldRG -ResourceName ExamplePlan
    Move-AzureRmResource -DestinationResourceGroupName NewRG -ResourceId $webapp.ResourceId, $plan.ResourceId

Чтобы переместить ресурс в новую подписку, добавьте значение параметра **DestinationSubscriptionId**.

## Перемещение ресурсов с помощью интерфейса командной строки Azure

Чтобы переместить существующие ресурсы в другую группу или подписку, используйте команду **azure resource move**. В следующем примере показано, как переместить кэш Redis в новую группу ресурсов. В параметре **-i** укажите разделенный запятыми список идентификаторов ресурсов для перемещения.

    azure resource move -i "/subscriptions/{guid}/resourceGroups/OldRG/providers/Microsoft.Cache/Redis/examplecache" -d "NewRG"
    info:    Executing command resource move
    Move selected resources in OldRG to NewRG? [y/n] y
    + Moving selected resources to NewRG
    info:    resource move command OK

## Перемещение ресурсов с помощью REST API

Чтобы переместить существующие ресурсы в другую группу ресурсов или подписку, выполните следующую команду:

    POST https://management.azure.com/subscriptions/{source-subscription-id}/resourcegroups/{source-resource-group-name}/moveResources?api-version={api-version} 

В тексте запроса укажите целевую группу ресурсов и ресурсы для перемещения. Дополнительные сведения об операции перемещения REST см. в разделе [Перемещение ресурсов](https://msdn.microsoft.com/library/azure/mt218710.aspx).

## Перемещение ресурсов с помощью портала

Некоторые ресурсы можно переместить с помощью портала. Однако такую возможность предоставляют не все поставщики ресурсов, поддерживающие операции перемещения.

Чтобы переместить ресурс, выберите его, а затем нажмите кнопку **Переместить**.

![перемещение ресурса](./media/resource-group-move-resources/move-resources.png)

Укажите конечное расположение ресурса. Если с этим ресурсом необходимо переместить другие ресурсы, они будут перечислены.

![выбор места назначения](./media/resource-group-move-resources/select-destination.png)

## Дальнейшие действия
- Сведения о командлетах PowerShell для управления подпиской см. в разделе [Использование Azure PowerShell с диспетчером ресурсов](powershell-azure-resource-manager.md).
- Сведения о командах CLI Azure для управления подпиской см. в разделе [Использование интерфейса командной строки Azure с диспетчером ресурсов](xplat-cli-azure-resource-manager.md).
- Сведения о функциях портала для управления подпиской см. в разделе [Управление ресурсами с помощью портала Azure](./azure-portal/resource-group-portal.md).
- Дополнительные сведения о логической организации ресурсов см. в статье [Использование тегов для организации ресурсов](resource-group-using-tags.md).

<!---HONumber=AcomDC_0420_2016-->