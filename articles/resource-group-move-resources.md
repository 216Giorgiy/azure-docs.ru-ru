<properties 
	pageTitle="Перемещение ресурсов в новую группу ресурсов" 
	description="Перемещайте ресурсы в новую группу ресурсов для диспетчера ресурсов Azure с помощью Azure PowerShell или REST API." 
	services="azure-resource-manager" 
	documentationCenter="" 
	authors="tfitzmac" 
	manager="wpickett" 
	editor=""/>

<tags 
	ms.service="azure-resource-manager" 
	ms.workload="multiple" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="03/04/2016" 
	ms.author="tomfitz"/>

# Перемещение ресурсов в новую группу ресурсов или подписку

В этом разделе показано, как перемещать ресурсы из одной группы ресурсов в другую. Можно также перемещать ресурсы в новую подписку (но подписка должна существовать в том же [клиенте](./active-directory/active-directory-howto-tenant.md)). Перемещение ресурсов может потребоваться в следующих случаях:

1. Для выставления счетов ресурс должен находиться в другой подписке.
2. Теперь жизненные циклы этого ресурса и ресурсов, с которыми он ранее был сгруппирован, не совпадают. Ресурс нужно переместить в новую группу ресурсов, чтобы управлять им отдельно от других ресурсов.
3. Теперь жизненные циклы ресурса и остальных ресурсов в другой группе ресурсов совпадают. Ресурс нужно переместить в группу ресурсов с другими ресурсами, чтобы управлять ими вместе.

## Рекомендации перед перемещением ресурсов

Вот некоторые важные особенности, которые следует учитывать перед перемещением ресурса:

1. Расположение ресурса изменить невозможно. При перемещении ресурс всего лишь перемещается в новую группу ресурсов. Даже если новая группа ресурсов находится в другом расположении, расположение ресурса не меняется.
2. Поставщик перемещаемого ресурса должен быть зарегистрирован в подписке назначения. Эта проблема может возникнуть при перемещении ресурса в новую подписку, которая никогда не использовалась с этим типом ресурса. Например, при перемещении экземпляра службы управления API в подписку, не имеющую зарегистрированного поставщика ресурсов **Microsoft.ApiManagement**, произойдет ошибка. Сведения о регистрации поставщиков ресурсов и о проверке состояния регистрации см. в статье [Поставщики и типы ресурсов](../resource-manager-supported-services/#resource-providers-and-types).
2. Группа ресурсов назначения должна содержать только те ресурсы, жизненные циклы приложений которых совпадают с аналогичными жизненными циклами перемещаемых ресурсов.
3. Если вы используете Azure PowerShell или интерфейс командной строки Azure, убедитесь, что у вас установлена последняя версия. Чтобы обновить текущую версию, запустите установщик веб-платформы Майкрософт и проверьте доступность более новой версии. Дополнительные сведения см. в статьях [Установка и настройка Azure PowerShell](powershell-install-configure.md) и [Установка интерфейса командной строки Azure](xplat-cli-install.md).
4. Операция перемещения может занять некоторое время. В это время командная строка будет ожидать ее завершения.
5. При перемещении ресурсов группу источника и группа назначения блокируются на время операции. Операции записи и удаления для групп блокируются до завершения перемещения.

## Поддерживаемые службы

В настоящее время в некоторых службах перемещение ресурсов не поддерживается.

Сейчас к службам, которые поддерживают перемещение в новую группу ресурсов и подписку, относятся:

- Управление API
- Приложения службы приложений (см. [ограничения службы приложений](#app-service-limitations) ниже)
- Автоматизация
- Пакетная служба
- Фабрика данных
- DocumentDB
- Кластеры HDInsight
- хранилище ключей;
- Mobile Engagement;
- Центры уведомлений
- Operational Insights;
- Кэш Redis
- Поиск
- База данных SQL Server (см. [ограничения базы данных SQL](#sql-database-limitations) ниже)

Службы с поддержкой перемещения в новую группу ресурсов, но не в новую подписку:

- виртуальные машины (классические);
- служба хранилища (классическая).
- Виртуальные сети
- Облачные службы

Службы, которые в настоящее время не поддерживают перемещение ресурсов:

- Виртуальные машины
- Хранилище
- ExpressRoute

## Ограничения службы приложений

При работе с приложениями службы приложений невозможно переместить только план службы приложений. Далее приводятся варианты перемещения приложений службы приложений.

- Переместите все ресурсы из одной группы ресурсов в другую, если в целевой группе нет ресурсов Microsoft.Web.
- Переместите веб-приложения в другую группу ресурсов, но сохраните план службы приложений в исходной группе.

## Ограничения базы данных SQL

Базу данных SQL нельзя переместить отдельно от сервера, на котором она размещается. База данных и сервер должны находиться в одной группе ресурсов. При перемещении сервера SQL Server все его базы данных также перемещаются.

## Перемещение ресурсов с помощью PowerShell

Чтобы переместить существующие ресурсы в другую группу ресурсов или подписку, используйте команду **Move-AzureRmResource**.

В первом примере показано, как переместить один ресурс в новую группу ресурсов.

    PS C:\> $resource = Get-AzureRmResource -ResourceName ExampleApp -ResourceGroupName OldRG
    PS C:\> Move-AzureRmResource -DestinationResourceGroupName NewRG -ResourceId $resource.ResourceId

Во втором примере показано, как переместить несколько ресурсов в новую группу ресурсов.

    PS C:\> $webapp = Get-AzureRmResource -ResourceGroupName OldRG -ResourceName ExampleSite
    PS C:\> $plan = Get-AzureRmResource -ResourceGroupName OldRG -ResourceName ExamplePlan
    PS C:\> Move-AzureRmResource -DestinationResourceGroupName NewRG -ResourceId $webapp.ResourceId, $plan.ResourceId

Чтобы переместить ресурс в новую подписку, добавьте значение параметра **DestinationSubscriptionId**.

## Перемещение ресурсов с помощью интерфейса командной строки Azure

Чтобы переместить существующие ресурсы в другую группу или подписку, используйте команду **azure resource move**. В следующем примере показано, как переместить кэш Redis в новую группу ресурсов. В параметре **-i** укажите разделенный запятыми список идентификаторов ресурсов для перемещения.

    azure resource move -i "/subscriptions/{guid}/resourceGroups/OldRG/providers/Microsoft.Cache/Redis/examplecache" -d "NewRG"
    info:    Executing command resource move
    Move selected resources in OldRG to NewRG? [y/n] y
    + Moving selected resources to NewRG
    info:    resource move command OK

## Перемещение ресурсов с помощью REST API

Чтобы переместить существующие ресурсы в другую группу ресурсов или подписку, выполните следующую команду:

    POST https://management.azure.com/subscriptions/{source-subscription-id}/resourcegroups/{source-resource-group-name}/moveResources?api-version={api-version} 

В тексте запроса укажите целевую группу ресурсов и ресурсы для перемещения. Дополнительные сведения об операции перемещения REST см. в разделе [Перемещение ресурсов](https://msdn.microsoft.com/library/azure/mt218710.aspx).

## Перемещение ресурсов с помощью портала

Некоторые ресурсы можно переместить с помощью портала. Однако такую возможность предоставляют не все поставщики ресурсов, поддерживающие операции перемещения.

Чтобы переместить ресурс, выберите его, а затем нажмите кнопку **Переместить**.

![перемещение ресурса](./media/resource-group-move-resources/move-resources.png)

Укажите конечное расположение ресурса. Если с этим ресурсом необходимо переместить другие ресурсы, они будут перечислены.

![выбор места назначения](./media/resource-group-move-resources/select-destination.png)

## Дальнейшие действия
- [Использование Azure PowerShell с диспетчером ресурсов](./powershell-azure-resource-manager.md)
- [Использование интерфейса командной строки Azure с диспетчером ресурсов](./xplat-cli-azure-resource-manager.md)
- [Управление ресурсами с помощью портала Azure](azure-portal/resource-group-portal.md)
- [Использование тегов для организации ресурсов](./resource-group-using-tags.md)

<!---HONumber=AcomDC_0309_2016-->