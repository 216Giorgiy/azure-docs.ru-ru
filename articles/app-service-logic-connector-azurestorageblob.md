<properties 
   pageTitle="Соединитель BLOB-объектов хранилища Azure" 
   description="Начало работы с соединителем BLOB-объектов хранилища Azure" 
   services="app-service\logic" 
   documentationCenter=".net,nodejs,java" 
   authors="rajeshramabathiran" 
   manager="dwrede" 
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration" 
   ms.date="03/18/2015"
   ms.author="rajram"/>
   
# Соединитель BLOB-объектов хранилища Azure

## Обзор
Соединитель BLOB-объектов хранилища Azure позволяет отправлять, загружать и удалять BLOB-объекты в контейнере BLOB-объектов.

## Создание нового соединителя BLOB-объектов хранилища Azure
Чтобы создать новый соединитель хранилища Azure, выполните приведенные ниже действия.
- Запустите портал Azure.
- Откройте Azure Marketplace, последовательно нажав +Создать (внизу страницы) -> Мобильные и веб-приложения -> Azure Marketplace.

![Launch Azure Marketplace][1]
- Щелкните пункт "Приложения API".
- Выполните поиск _Blob_ и выберите соединитель BLOB-объектов хранилища Azure.

![Select Azure Storage Blob Connector][2]
- Нажмите кнопку "Создать".
- В открывшейся колонке соединителя BLOB-объектов хранилища Azure предоставьте следующие данные.

![Create Azure Storage Blob Connector][3]

- **Расположение** - выберите географическое расположение, где планируется развернуть соединитель.
- **Подписка** - выберите подписку, в которой нужно создать соединитель.
- **Группа ресурсов** - выберите или создайте группу ресурсов, в которой следует разместить соединитель.
- **План размещения веб-сайтов** - выберите или создайте план размещения веб-сайтов.
- **Ценовая категория** - выберите ценовую категорию для соединителя.
- **Имя** - задайте имя для этого соединителя FTP.
- **Параметры пакета** 
	- **URI контейнера/SAS** - укажите URI контейнера BLOB-объектов. Этот URI может также включать SAS токен. Пример: http://storageaccountname.blob.core.windows.net/containername или http://storageaccountname.blob.core.windows.net/containername?sr=c&si=mypolicy&sig=signatureblah
	- **Ключ доступа** - укажите допустимый ключ доступа к основной/дополнительной учетной записи хранилища. Оставьте это поле пустым, если для проверки подлинности используется токен SAS.
- Нажмите кнопку "Создать". Будет создан новый соединитель BLOB-объектов хранилища Azure.

## Использование соединителя BLOB-объектов хранилища Azure в приложении логики
После создания соединителя BLOB-объектов хранилища Azure его можно использовать в потоке.

Создайте новый поток, последовательно выбрав +Создать -> Мобильные и веб-приложения -> Приложение логики. Предоставьте метаданные для потока, включая группу ресурсов.

![Create Logic App][4]

Щелкните *triggers and actions*. Откроется конструктор потока.

![Logic App empty flow designer][5]

Соединитель BLOB-объектов хранилища Azure может использоваться как триггер и как действие. 

### Триггер
В пустом конструкторе потока щелкните соединитель BLOB-объектов хранилища Azure в коллекции справа.

![Choose Blob Available Trigger][6]

Соединитель BLOB-объектов хранилища Azure имеет один триггер - _BlobAvailable_. Этот триггер выполняет опрос для обнаружения BLOB-объектов, присутствующих в указанном контейнере. Также поддерживается опрос на уровне каталога и фильтрация BLOB-объектов. Этот триггер удаляет BLOB-объекты из контейнера после того, как они будут выбраны.

Щелкните триггер _BlobAvailable_.

![Basic inputs Blob Available Trigger][7]

Эти входные параметры помогают настроить конкретный путь к папке, который должен опрашиваться с заданной частотой. Далее приводятся основные входные параметры.
- Частота - задает частоту опроса FTP.
- Интервал - интервал для запланированной частоты.
- Путь к папке - указывает путь к виртуальной папке для опроса. Используйте "." для корневой папки контейнера.
- Тип файла - указывает маску файла для сопоставления с именами файлов BLOB-объектов.  В опрос будут включаться только BLOB-объекты, имена файлов которых соответствуют этой маске файла. По умолчанию будут включаться все BLOB-объекты.

При нажатии на кнопку с многоточием (...) отображаются дополнительные входные параметры. 

![Advanced inputs Blob Available Trigger][8]

Далее приводятся дополнительные входные параметры.

- Маска файла - задает маску файла для сопоставления с именами файлов BLOB-объектов.  В опрос будут включаться только BLOB-объекты, имена файлов которых соответствуют этой маске файла. По умолчанию будут включаться все BLOB-объекты.
- Исключить маску файла - задает маску файла для сопоставления с именами файлов BLOB-объектов.  BLOB-объекты, соответствующие этой маске файла, будут исключаться. По умолчанию никакие BLOB-объекты не исключаются.

Предоставьте входные параметры и щелкните галочку, чтобы завершить настройку.

![Configured Blob Available Trigger][9]

Обратите внимание, что настроенный триггер _Blob Available_ отображает как настроенные входные параметры, так и выходные параметры. 

После создания приложения логики триггер _Blob Available_ выполняет следующие действия: 


- выполняет опрос по пути папки для обнаружения новых файлов;
- реализует поток логики каждый раз при появлении нового файла;
- удаляет файл из пути папки после реализации потока логики.

#### Использование выходных данных триггера Blob Available в последующих действиях
Выходные данные триггера _Blob Available_ могут использоваться в качестве входных данных некоторых других действий в потоке. 

Вы можете нажать знак "плюс" (+) во входном диалоговом окне действия и выбрать выходные данные FTP непосредственно в раскрывающемся списке.

Вы также можете записать выражение напрямую во входном поле действия. Ниже показано выражение потока для ссылки на выходные данные триггера.

	@triggers().outputs.body.Content

### Действия
Щелкните соединитель BLOB-объектов хранилища Azure в области слева. Соединитель перечисляет все поддерживаемые действия.

![List of Azure Storage Blob Actions][10]

Соединитель BLOB-объектов хранилища Azure поддерживает следующие шесть действий.

- **Получить BLOB-объект** - получает определенный BLOB-объект из контейнера.
- **Отправить BLOB-объект** - отправляет новый BLOB-объект или обновляет существующий BLOB-объект.
- **Удалить BLOB-объект** - удаляет определенный BLOB-объект из контейнера.
- **Список BLOB-объектов** - перечисляет все BLOB-объекты в каталоге.
- **Моментальный снимок BLOB-объекта** - создает моментальный снимок конкретного BLOB-объекта, предназначенный только для чтения.
- **Копировать BLOB-объект** - создает новый BLOB-объект путем копирования другого BLOB-объекта.  Исходный BLOB-объект может находиться в той же или в другой учетной записи.

Давайте рассмотрим один пример - отправку BLOB-объекта. Щелкните действие "Отправить BLOB-объект".

![Inputs of Upload Blob action][11]


- **Путь к BLOB-объекту** - задает путь к BLOB-объекту для отправки.  Путь интерпретируется относительно настроенного пути контейнера.
- **Содержимое BLOB-объекта для записи** - укажите содержимое и свойства BLOB-объекта для отправки.
- **Кодировка передачи контента** - укажите none или base64.
- **Перезаписать** - если задано значение true, существующий BLOB-объект будет перезаписан. В противном случае, если по тому же пути уже существует BLOB-объект, то будет возвращена ошибка.

Предоставьте входные параметры и щелкните галочку, чтобы завершить настройку.


Обратите внимание, что настроенное действие "Отправить BLOB-объект" BLOB-объекта хранилища Azure отображает как входные параметры, так и выходные параметры.

#### Использование выходных данных предыдущих действий в качестве входных данных для действия FTP
Обратите внимание, что на снимке экрана в качестве значения содержимого установлено выражение.

	@triggers().outputs.body.Content


Вы можете установить любое значение, которое вам нужно. Это только пример. Выражение принимает выходные данные триггера приложения логики и использует их в качестве содержимого файла для отправки. Предположим, что вам нужно использовать выходные данные предыдущего действия, например преобразования. В этом случае можно задать следующее выражение:

	@actions('transformservice').outputs.body.OutputXML


<!-- Image reference -->
[1]: ./media/app-service-logic-connector-azurestorageblob/LaunchAzureMarketplace.PNG
[2]: ./media/app-service-logic-connector-azurestorageblob/SelectAzureStorageBlobConnector.PNG
[3]: ./media/app-service-logic-connector-azurestorageblob/CreateAzureStorageBlobConnector.PNG
[4]: ./media/app-service-logic-connector-azurestorageblob/CreateLogicApp.PNG
[5]: ./media/app-service-logic-connector-azurestorageblob/LogicAppEmptyFlowDesigner.PNG
[6]: ./media/app-service-logic-connector-azurestorageblob/ChooseBlobAvailableTrigger.PNG
[7]: ./media/app-service-logic-connector-azurestorageblob/BasicInputsBlobAvailableTrigger.PNG
[8]: ./media/app-service-logic-connector-azurestorageblob/AdvancedInputsBlobAvailableTrigger.PNG
[9]: ./media/app-service-logic-connector-azurestorageblob/ConfiguredBlobAvailableTrigger.PNG
[10]: ./media/app-service-logic-connector-azurestorageblob/ListOfAzureStorageBlobActions.PNG
[11]: ./media/app-service-logic-connector-azurestorageblob/BasicInputsUploadBlob.PNG

<!--HONumber=49-->