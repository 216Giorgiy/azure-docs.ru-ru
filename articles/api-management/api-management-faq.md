.<properties 
	pageTitle="Часто задаваемые вопросы о службе управления API Azure | Microsoft Azure" 
	description="Ознакомьтесь с ответами на часто задаваемые вопросы, шаблонами и рекомендациями для службы управления API Azure." 
	services="api-management" 
	documentationCenter="" 
	authors="miaojiang" 
	manager="erikre" 
	editor=""/>

.<tags 
	ms.service="api-management" 
	ms.workload="mobile" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="08/09/2016" 
	ms.author="mijiang"/>

# Часто задаваемые вопросы о службе управления API Azure

Ознакомьтесь с ответами на часто задаваемые вопросы, шаблонами и рекомендациями для службы управления API Azure.

## Часто задаваемые вопросы

-	[Как задать вопрос команде разработчиков службы управления API?](#how-can-i-ask-a-question-to-the-api-management-team)
-	[Что означает, если компонент находится в предварительной версии?](#what-does-it-mean-if-a-feature-is-in-preview)
-	[Как можно защитить подключение шлюза службы управления API к моим службам серверной части?](#what-are-the-supported-options-to-secure-the-connection-between-the-api-management-gateway-and-my-backend-services)
-	[Как скопировать экземпляр службы управления API в новый экземпляр?](#how-can-i-copy-an-api-management-instance-to-a-new-instance)
-	[Можно ли управлять экземпляром службы управления API программными средствами?](#can-i-manage-my-api-management-instance-programmatically)
-	[Как добавить пользователя в группу администраторов?](#how-can-i-add-a-user-to-the-administrators-group)
-	[Почему политика, которую я хочу добавить, не включена в редакторе политик?](#why-is-the-policy-that-i-want-to-add-not-enabled-in-the-policy-editor)
-	[Как организовать управление версиями API с помощью службы управления API?](#how-can-i-achieve-api-versioning-with-api-management)
-	[Как настроить несколько сред API, например изолированную и рабочую?](#how-can-i-configure-multiple-environments-of-apis-for-example-sandbox-and-production)
-	[Поддерживается ли протокол SOAP службой управления API?](#is-soap-supported-in-api-management)
-	[Является ли IP-адрес шлюза управления API постоянным? Можно ли использовать его в правилах брандмауэра?](#is-the-api-management-gateway-ip-address-constant-can-i-use-it-in-firewall-rules)
-	[Можно ли настроить сервер авторизации OAUth 2.0 с помощью системы безопасности служб федерации Active Directory?](#can-i-configure-an-oauth-20-authorization-server-with-adfs-security)
-	[Какой метод маршрутизации используется службой управления API при развертывании в нескольких географических местоположениях?](#what-routing-method-does-api-management-use-when-deployed-to-multiple-geographic-locations)
-	[Можно ли создать экземпляр службы управления API с помощью шаблона ARM?](#can-i-create-an-api-management-service-instance-using-an-arm-template)
-	[Можно ли использовать самозаверяющий сертификат SSL для сервера?](#can-i-use-a-self-signed-ssl-certificate-for-a-backend)
-	[Почему я получаю ошибку проверки подлинности при попытке выполнить клонирование репозитория GIT?](#why-am-i-getting-authentication-failure-when-i-try-to-clone-the-git-repository)
-	[Работает ли управление API с Express Route?](#does-api-management-work-with-express-route)


### Как задать вопрос команде разработчиков службы управления API?

-	Свои вопросы вы можете разместить на нашем [форуме MSDN для службы управления API](https://social.msdn.microsoft.com/forums/azure/home?forum=azureapimgmt).
-	Вы можете отправить нам электронное письмо по следующему адресу: `apimgmt@microsoft.com`.
-	Вы можете отправить нам [запрос функции](https://feedback.azure.com/forums/248703-api-management).

### Что означает, если компонент находится в предварительной версии?

Компонент, находящийся в предварительной версии, функционально завершен, но все еще доступен, так как мы активно собираем отзывы о нем. Вполне возможно, что в ответ на отзывы клиентов мы внесем критические изменения, поэтому мы рекомендуем не использовать эту версию в производственной среде. Если вы хотите оставить отзыв о компонентах, доступных в предварительной версии, отправьте нам его одним из способов, описанных в разделе [Как задать вопрос команде разработчиков службы управления API?](#how-can-i-ask-a-question-to-the-api-management-team)

### Как можно защитить подключение шлюза службы управления API к моим службам серверной части?

Поддерживается несколько вариантов защиты.

1. Использование обычной проверки подлинности HTTP. Дополнительные сведения см. в разделе [Настройка параметров API](api-management-howto-create-apis.md#configure-api-settings).
2. Используйте взаимную проверку подлинности SSL, как описано в статье [Защита фоновых служб посредством проверки подлинности с помощью сертификата клиента в службе Azure API Management](api-management-howto-mutual-certificates.md).
3. Используйте утвержденный список IP-адресов в службах серверной части. Если у вас есть экземпляр службы управления API уровня "Стандартный" или "Премиум", IP-адрес шлюза остается постоянным, и его можно добавить в утвержденный список IP-адресов. IP-адрес экземпляра службы управления API можно узнать на **панели мониторинга** на классическом портале Azure.
4. Экземпляр службы управления API можно подключить к виртуальной сети (классической). Дополнительные сведения см. в статье [Настройка VPN-подключений в службе управления API Azure](api-management-howto-setup-vpn.md).

### Как скопировать экземпляр службы управления API в новый экземпляр?

Существует несколько вариантов копирования экземпляра службы управления API в новый экземпляр.

-	Используйте функцию архивации и восстановления службы управления API. Дополнительные сведения см. в статье [Реализация аварийного восстановления с помощью функций резервного копирования и восстановления службы в Azure API Management](api-management-howto-disaster-recovery-backup-restore.md).
-	Создайте собственную функцию резервного копирования и восстановления с помощью [API Management REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx) (REST API службы управления API), чтобы сохранять и восстанавливать нужные объекты из экземпляра службы.
-	Скачайте конфигурацию службы с помощью Git и отправьте ее в новый экземпляр. Дополнительные сведения см. в статье [Сохранение и настройка конфигурации службы управления API с помощью Git](api-management-configuration-repository-git.md).

### Можно ли управлять экземпляром службы управления API программными средствами?

Да, им можно управлять с помощью [REST API службы управления API](https://msdn.microsoft.com/library/azure/dn776326.aspx), [пакета SDK библиотеки управления службой управления API Microsoft Azure](http://aka.ms/apimsdk) и командлетов PowerShell для [развертывания службы](https://msdn.microsoft.com/library/mt619282.aspx) и [управления службой](https://msdn.microsoft.com/library/mt613507.aspx).

### Как добавить пользователя в группу администраторов?

Это можно сделать, выполнив следующие действия.

1. Войдите на новый [портал Azure](https://portal.azure.com).
2. Перейдите к группе ресурсов, которая содержит необходимый экземпляр управления API.
3. Добавьте нужного пользователя в роль "Участник управления Api".

После этого добавленный участник сможет использовать [командлеты](https://msdn.microsoft.com/library/mt613507.aspx) Azure PowerShell для входа с правами администратора.

1. Используйте командлет `Login-AzureRmAccount` для входа.
2. Задайте контекст для подписки, содержащей службу, используя `Set-AzureRmContext -SubscriptionID <subscriptionGUID>`.
3. Получите токен единого входа, используя `Get-AzureRmApiManagementSsoToken -ResourceGroupName <rgName> -Name <serviceName>`.
4. Скопируйте и вставьте URL-адрес в браузер, при этом пользователь должен иметь доступ к порталу администрирования.


### Почему политика, которую я хочу добавить, не включена в редакторе политик?

Если политика, которую требуется добавить, не включена, убедитесь, что вы находитесь в правильной области действия этой политики. Каждая инструкция политики предназначена для использования в определенных областях и разделах политики. Чтобы просмотреть разделы политики и области ее действия, ознакомьтесь с разделом **Использование** для этой политики в [справочнике по политикам](https://msdn.microsoft.com/library/azure/dn894080.aspx).


### Как организовать управление версиями API с помощью службы управления API?

-	В службе управления API можно настроить отдельные интерфейсы API, представляющие разные версии. Например, можно настроить `MyAPI v1` и `MyAPI v2` как два разных интерфейса API, и тогда разработчики смогут выбрать нужную версию.
-	Вы также можете настроить для API URL-адрес службы без сегмента версии, например `https://my.api`. Вы можете отдельно настроить сегмент версии в шаблоне [перезаписи URL-адреса](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) для каждой операции. Например, операция может иметь [шаблон URL-адреса](api-management-howto-add-operations.md#url-template) `/resource` и шаблон [перезаписи URL-адреса](api-management-howto-add-operations.md#rewrite-url-template) `/v1/Resource`. В этом случае вы можете изменять значение сегмента версии для каждой операции отдельно.
-	Если вы хотите оставить сегмент версии default в URL-адресе службы API, вы можете задать для выбранных операций политику, использующую политику [Set backend service](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService) (Задание внутренней службы) для изменения пути запроса к внутренней службе.

### Как настроить несколько сред API, например изолированную и рабочую?

В настоящее время доступны указанные ниже способы.

-	Вы можете разместить разные интерфейсы API в одном клиенте.
-	Вы можете разместить одни и те же интерфейсы API в разных клиентах.

### Поддерживается ли протокол SOAP службой управления API?

В настоящее время мы предлагаем ограниченную поддержку SOAP в службе управления API Azure, но рассматриваем возможность реализации этой функции. Нам было бы интересно получить примеры WSDL-файлов от ваших клиентов и описание нужных им функций. Это помогло бы нам направить усилия в нужное русло. Свяжитесь с нами с помощью контактных данных, приведенных в разделе [Как задать вопрос команде разработчиков службы управления API?](#how-can-i-ask-a-question-to-the-api-management-team)

Если вам нужно реализовать эту возможность сейчас, члены нашего сообщества предлагают обходные пути: см. запись блога [Azure API Management — APIM, consuming a SOAP WCF service over HTTP](http://mostlydotnetdev.blogspot.com/2015/03/azure-api-management-apim-consuming.html) (Служба управления API Azure — APIM, использование службы SOAP WCF по протоколу HTTP).

Для реализации такого решения потребуется настроить политики вручную. Кроме того, при этом не поддерживается импорт и экспорт файлов WSDL, а пользователям потребуется формировать тела запросов, выполняемых с помощью консоли тестирования на портале разработчика.

### Является ли IP-адрес шлюза управления API постоянным? Можно ли использовать его в правилах брандмауэра?

На уровнях Standard и Premium общедоступный (виртуальный) IP-адрес клиента управления API является статическим в течение всего времени существования клиента за несколькими исключениями, указанными ниже. Имейте в виду, что клиентам уровня Premium, для которых настроено развертывание в нескольких регионах, назначается один общедоступный IP-адрес на каждый регион.

IP-адрес изменяется в указанных ниже случаях.

-	Служба удаляется или создается повторно.
-	Действие подписки на службу приостанавливается (например, из-за неуплаты), а затем восстанавливается.
-	Виртуальная сеть добавляется или удаляется (виртуальная сеть поддерживается только на уровне Premium).
-	Региональный адрес меняется, если регион освобождается и заполняется повторно (развертывание в нескольких регионах поддерживается только на уровне Premium).

IP-адрес (или адреса в случае развертывания в нескольких регионах) можно найти на странице клиента на классическом портале Azure.

### Можно ли настроить сервер авторизации OAUth 2.0 с помощью системы безопасности служб федерации Active Directory?

Сведения о настройке этого сценария см. здесь: [Using ADFS in API Management](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/) (Использование служб федерации Active Directory в управлении API).

### Какой метод маршрутизации используется службой управления API при развертывании в нескольких географических местоположениях? 

Управление API использует [метод маршрутизации трафика для повышения производительности](../traffic-manager/traffic-manager-routing-methods.md#performance-traffic-routing-method). Входящие трафик маршрутизируется на ближайший шлюз API. Если регион становится недоступен, входящий трафик автоматически маршрутизируется на следующий ближайший шлюз. Дополнительные сведения о методах маршрутизации см. в статье [Методы маршрутизации трафика диспетчером трафика](../traffic-manager/traffic-manager-routing-methods.md).

### Можно ли создать экземпляр службы управления API с помощью шаблона ARM?

Да, используйте шаблоны быстрого запуска со страницы [службы управления API Azure](http://aka.ms/apimtemplate).

### Можно ли использовать самозаверяющий сертификат SSL для сервера?

Да. Выполните следующие действия:

1. Создайте [серверную](https://msdn.microsoft.com/library/azure/dn935030.aspx) сущность с помощью управления API.
2. Задайте для свойства skipCertificateChainValidation значение true
3. Если вы хотите запретить использование самозаверяющего сертификата, удалите серверную сущность или задайте для свойства skipCertificateChainValidation значение false

### Почему я получаю ошибку проверки подлинности при попытке выполнить клонирование репозитория GIT? 

Если вы используете диспетчер учетных данных GIT или пытаетесь клонировать репозиторий с помощью Visual Studio, вы можете столкнуться с известной проблемой: диалоговое окно учетных данных Windows ограничивает длину пароля 127 символами и, следовательно, усекает генерируемый нами пароль. Мы работаем над сокращением пароля. Пока для клонирования используйте GIT Bash.

### Работает ли управление API с Express Route?

Да!

<!---HONumber=AcomDC_0831_2016-->