<properties linkid="web-sites-create-web-jobs" urlDisplayName="Use WebJobs to run background tasks in Microsoft Azure Websites" pageTitle="Use WebJobs to run background tasks in Microsoft Azure Websites" metaKeywords="Microsoft Azure Web Sites, Web Jobs, background tasks" description="Learn how to run background tasks in Microsoft Azure Websites." metaCanonical="" services="web-sites" documentationCenter="" title="Use WebJobs to run background tasks in Microsoft Azure Websites" authors="cephalin"  solutions="" writer="timamm" manager="wpickett" editor="mollybos"  />

<tags ms.service="web-sites" ms.workload="web" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="cephalin" />

# Использование заданий WebJob для выполнения фоновых задач на веб-сайтах Microsoft Azure

Веб-сайты Microsoft Azure позволяют запускать программы или сценарии на веб-сайте одним из трех способов: по требованию, непрерывно или по расписанию. Дополнительные затраты для использования веб-заданий Microsoft Azure отсутствуют, если только вы не хотите включить возможность "Всегда включено", описанную далее в этой статье.

## Оглавление

-   [Применимые типы файлов для скриптов][Применимые типы файлов для скриптов]
-   [Создание задачи по требованию][Создание задачи по требованию]
-   [Создание непрерывно выполняющейся задачи][Создание непрерывно выполняющейся задачи]
-   [Создание запланированной задачи][Создание запланированной задачи]
    -   [Запланированные задания и планировщик Azure][Запланированные задания и планировщик Azure]
-   [Просмотр журнала заданий][Просмотр журнала заданий]
-   [Примечания][Примечания]
-   [Дальнейшие действия][Дальнейшие действия]
    -   [Расширенные возможности Microsoft Azure SDK для веб-заданий][Расширенные возможности Microsoft Azure SDK для веб-заданий]
    -   [Альтернативные методы развертывания][Альтернативные методы развертывания]
    -   [Дополнительные ресурсы][Дополнительные ресурсы]

<a name="acceptablefiles"></a>

## Применимые типы файлов для скриптов

В качестве запускаемых скриптов принимаются следующие типы файлов:

.cmd, .bat, .exe (с использованием командной строки windows)

.ps1 (с использованием powershell)

.sh (с использованием bash)

.PHP (с использованием php)

.py (с использованием python)

.js (с использованием node)

<a name="CreateOnDemand"></a>

## Создание задачи по требованию

1.  В командной строке на странице **Веб-задания** щелкните **Добавить**. Появится диалоговое окно **Новое задание**.

    ![Задача по требованию][Задача по требованию]

2.  В поле **Имя** укажите имя задачи. Имя должно начинаться с буквы или цифры и не может содержать специальные символы, отличные от "-" и "\_".

3.  В поле **Содержимое (ZIP-файлы – максимум 100 МБ)** перейдите к ZIP-файлу, в котором содержится сценарий. ZIP-файл должен содержать исполняемый файл (.exe .cmd .bat .sh .php .py .js), а также все вспомогательные файлы, необходимые для запуска программы или скрипта.

4.  В поле **Как выполнить** выберите пункт **Выполнять по требованию**.

5.  Установите флажок в правой нижней части диалогового окна для передачи сценария на веб-сайт. В списке отображается имя, указанное для задачи:

    ![Список задач][Список задач]

6.  Чтобы запустить скрипт, выберите его имя в списке и щелкните **Запустить один раз** на панели команд в нижней части страницы портала.

    ![Запустить один раз][Запустить один раз]

<a name="CreateContinuous"></a>

## Создание непрерывно выполняющейся задачи

1.  Чтобы создать непрерывно выполняемую задачу, выполните следующие действия для создания задачи, которая запускается один раз, однако в поле **Как выполнить** выберите значение **Выполняется непрерывно**.

    ![Новая непрерывная задача][Новая непрерывная задача]

2.  Чтобы запустить или остановить непрерывно выполняемую задачу, выберите задачу в списке и щелкните на панели команд **Запустить** или **Остановить**.

> [WACOM.NOTE] Если веб-сайт работает на нескольких экземплярах, непрерывно выполняемая задача будет работать на всех экземплярах. Задачи по требованию и запланированные задачи запускаются на отдельном экземпляре, выбранном Microsoft Azure для балансировки нагрузки.

> [WACOM.NOTE]
> Для непрерывно выполняемых задач рекомендуется включить параметр **Всегда включено** на странице «Настройки» для вашего веб-сайта. Функция «Всегда включено», доступная только в базовом и стандартном режимах, препятствует выгрузке веб-сайтов, даже если они были неактивны в течение некоторого времени. Если веб-сайт всегда загружен, непрерывно выполняемая задача может работать более стабильно.

<a name="CreateScheduled"></a>

## Создание запланированной задачи

1.  Чтобы создать запланированную задачу, выполните те же действия, что и раньше, но в поле **Как выполнить** выберите **Запуск по расписанию**.
	
	![Новое запланированное задание][Новое запланированное задание]
	
2.  Выберите **Регион планировщика** для задания и нажмите кнопку со стрелкой в правом нижнем углу диалогового окна, чтобы перейти к следующему экрану.

3.  В диалоговом окне **Создать задание** выберите нужный тип **Повторения**: **Разовое задание** или **Повторяющееся задание**.

    ![Запланированное повторение][Запланированное повторение]

4.  Кроме того, выберите время **запуска**: **Сейчас** или **В определенное время**.

    ![Время начала по расписанию][Время начала по расписанию]

5.  Если необходимо начать в определенное время, выберите значения времени запуска в поле **Начало в**.

    ![Расписание запуска в определенное время][Расписание запуска в определенное время]

6.  Если выбрано повторяющееся задание, с помощью параметра **Повторять каждые** можно указать частоту повторения, а с помощью параметра **Заканчивается** – время завершения.

    ![Запланированное повторение][1]

7.  При выборе значения **Недели** можно выбрать поле **В определенном расписании** и указать дни недели, в которые должно запускаться это задание.

    ![Запланированные дни недели][Запланированные дни недели]

8.  При выборе значения **Месяцы** и выбора поля **В определенном расписании** можно определить запуск задания в определенные, пронумерованные **дни** месяца.

    ![Планирование определенных дат месяца][Планирование определенных дат месяца]

9.  При выборе значения **Дни недели** можно выбрать, в какой день или в какие дни недели месяца необходимо запускать задание.

    ![Планирование определенных дней недели в месяце][Планирование определенных дней недели в месяце]

10. Наконец, можно также использовать параметр **Вхождения** для выбора недели месяца (первая, вторая, третья и т. д.), во время которой задание должно выполняться в указанные дни недели.

    ![Планирование определенных дней недели в определенные недели месяца][Планирование определенных дней недели в определенные недели месяца]

11. Имена созданных заданий будут отображаться на вкладке «Веб-задания» вместе с данными об их состоянии, типе расписания и прочей информацией. Сохраняются журнальные данные для последних 30 выполненных задач.

    ![Список заданий][Список заданий]

<a name="Scheduler"></a>

### Запланированные задания и планировщик Azure

На портале планировщика Azure можно выполнить дополнительную настройку запланированных заданий.

1.  Чтобы перейти на страницу портала планировщика Azure, щелкните **расписание** задания на странице "Веб-задания".

    ![Ссылка на планировщик Azure][Ссылка на планировщик Azure]

2.  Выберите задание на странице планировщика.

    ![Задание на странице портала планировщика][Задание на странице портала планировщика]

3.  Откроется страница **Действие задания**, на которой можно выполнить дополнительную настройку задания.

    ![Страница "Действие задания" в планировщике][Страница "Действие задания" в планировщике]

<!-- ================ ViewJobHistory ================= -->

<a name="ViewJobHistory"></a>

## Просмотр журнала заданий

1.  Чтобы просмотреть журнал выполнения задания, включая задания, созданные с помощью пакета SDK для заданий WebJob, щелкните соответствующую ссылку в столбце **Журналы**. Можно также использовать значок буфера обмена для копирования URL-адреса страницы файла журнала в буфер обмена.

    ![Ссылка на журналы][Ссылка на журналы]

2.  При щелчке ссылки открывается страница информации о заданиях WebJob для задачи. На этой странице отображаются имя выполненной команды, время ее последнего выполнения, а также сведения об успешности выполнения. Укажите время в разделе **Недавно выполненные задания**, чтобы просмотреть дополнительные сведения.

    ![Сведения о веб-задании][Сведения о веб-задании]

3.  Откроется страница **Сведения о выполнении WebJob**. Щелкните **Переключить вывод**, чтобы просмотреть текст журнала. Журнал выводится в текстовом формате.

    ![Сведения о выполнении веб-задания][Сведения о выполнении веб-задания]

4.  Чтобы просмотреть текст вывода в отдельном окне браузера, щелкните ссылку **скачать**. Чтобы загрузить текст, щелкните ссылку правой кнопкой мыши и выберите команду для сохранения содержимого файла в контекстном меню браузера.

    ![Загрузка выходных данных журнала][Загрузка выходных данных журнала]

5.  Чтобы получить список заданий WebJob на панели мониторинга журнала, вы можете воспользоваться ссылкой **WebJobs** вверху страницы.

    ![Ссылка на список веб-заданий][Ссылка на список веб-заданий]

    ![Список заданий в панели мониторинга журнала][Список заданий в панели мониторинга журнала]

    При щелчке одной из этих ссылок открывается страница "Сведения о веб-задании" для выбранного задания.

<a name="WHPNotes"></a>

## Примечания

-   По состоянию на март 2014 г. в бесплатном режиме веб-сайтов время ожидания может истекать, если в течение 20 минут не поступали запросы к сайту SCM (развертывание), а в Azure не был открыт портал веб-сайта. При этом такое поведение наблюдается даже при наличии запросов к фактическому сайту.

-   Код непрерывно выполняющегося задания должен выполняться в бесконечном цикле.

-   Задания выполняются непрерывно только во время работы сайта.

-   В базовом и стандартном режимах реализована функция «Всегда включено», которая позволяет предотвратить переход сайта в неактивное состояние.

<a name="NextSteps"></a>

## Дальнейшие действия

<!-- ======= Do More with the Microsoft Azure WebJobs SDK ======== -->

<a name="WebJobsSDK"></a>

### Расширенные возможности Microsoft Azure SDK для веб-заданий

Пакет SDK для Microsoft Azure WebJobs упрощает задачу программирования WebJob, которое работает с очередями службы хранилища Azure, большими двоичными объектами, таблицами или очередями Azure Service Bus. Благодаря интеграции панели мониторинга с порталом Azure реализуются эффективные функции мониторинга и диагностики программ, написанных с помощью этого пакета SDK. Компоненты мониторинга и диагностики встроены в пакет SDK и не требуют добавления в программу какого-либо специального кода.

Дополнительные сведения см. в учебнике [Приступая к работе с Microsoft Azure SDK для веб-заданий][Приступая к работе с Microsoft Azure SDK для веб-заданий].

<!-- =========== Alternative Methods of Deployment ============= -->

<a name="AlternateDeployments"></a>

### Альтернативные методы развертывания

Visual Studio 2013 предоставляет возможности, которые автоматизируют развертывание проектов консольных приложений как заданий WebJob. Дополнительную информацию см. в разделе [Как развернуть задания Azure WebJob на веб-сайтах Azure][Как развернуть задания Azure WebJob на веб-сайтах Azure].

Для развертывания заданий WebJob вы также можете использовать FTP, Git или веб-развертывание. Дополнительную информацию см. в разделах [Развертывание приложения консоли .NET в Azure через Git с помощью заданий WebJob][Развертывание приложения консоли .NET в Azure через Git с помощью заданий WebJob] и [Как развернуть задания Windows Azure WebJob][Как развернуть задания Windows Azure WebJob].

<a name="AdditionalResources"></a>

### Дополнительные ресурсы

-   Дополнительные ресурсы см. в списке аннотированных ссылок по функции заданиям WebJob [Задания Azure WebJob — рекомендуемые ресурсы][Задания Azure WebJob — рекомендуемые ресурсы].

-   Видео, посвященные заданиям WebJob:

    [Задания Azure WebJob 101 — стандартные задания WebJob, Джейми Эспиноза (Jamie Espinosa)][Задания Azure WebJob 101 — стандартные задания WebJob, Джейми Эспиноза (Jamie Espinosa)]

    [Задания Azure WebJob 102 — запланированные задания WebJob и панель мониторинга заданий WebJob, Джейми Эспиноза (Jamie Espinosa)][Задания Azure WebJob 102 — запланированные задания WebJob и панель мониторинга заданий WebJob, Джейми Эспиноза (Jamie Espinosa)]

    [Планировщик Azure 101 — планирование ресурсов, Кевин Лам (Kevin Lam)][Планировщик Azure 101 — планирование ресурсов, Кевин Лам (Kevin Lam)]

### Приступая к работе

Чтобы начать работу с Azure, см. раздел [Бесплатная пробная версия Microsoft Azure][Бесплатная пробная версия Microsoft Azure].



  [Применимые типы файлов для скриптов]: #acceptablefiles
  [Создание задачи по требованию]: #CreateOnDemand
  [Создание непрерывно выполняющейся задачи]: #CreateContinuous
  [Создание запланированной задачи]: #CreateScheduled
  [Запланированные задания и планировщик Azure]: #Scheduler
  [Просмотр журнала заданий]: #ViewJobHistory
  [Примечания]: #WHPNotes
  [Дальнейшие действия]: #NextSteps
  [Расширенные возможности Microsoft Azure SDK для веб-заданий]: #WebJobsSDK
  [Альтернативные методы развертывания]: #AlternateDeployments
  [Дополнительные ресурсы]: #AdditionalResources
  [Задача по требованию]: ./media/web-sites-create-web-jobs/01aOnDemandWebJob.png
  [Список задач]: ./media/web-sites-create-web-jobs/02aWebJobsList.png
  [Запустить один раз]: ./media/web-sites-create-web-jobs/13RunOnce.png
  [Новая непрерывная задача]: ./media/web-sites-create-web-jobs/03aNewContinuousJob.png
  [Новое запланированное задание]: ./media/web-sites-create-web-jobs/04aNewScheduledJob.png
  [Запланированное повторение]: ./media/web-sites-create-web-jobs/05SchdRecurrence.png
  [Время начала по расписанию]: ./media/web-sites-create-web-jobs/06SchdStart.png
  [Расписание запуска в определенное время]: ./media/web-sites-create-web-jobs/07SchdStartOn.png
  [1]: ./media/web-sites-create-web-jobs/08SchdRecurEvery.png
  [Запланированные дни недели]: ./media/web-sites-create-web-jobs/09SchdWeeksOnParticular.png
  [Планирование определенных дат месяца]: ./media/web-sites-create-web-jobs/10SchdMonthsOnPartDays.png
  [Планирование определенных дней недели в месяце]: ./media/web-sites-create-web-jobs/11SchdMonthsOnPartWeekDays.png
  [Планирование определенных дней недели в определенные недели месяца]: ./media/web-sites-create-web-jobs/12SchdMonthsOnPartWeekDaysOccurences.png
  [Список заданий]: ./media/web-sites-create-web-jobs/13WebJobsListWithSeveralJobs.png
  [Ссылка на планировщик Azure]: ./media/web-sites-create-web-jobs/31LinkToScheduler.png
  [Задание на странице портала планировщика]: ./media/web-sites-create-web-jobs/32SchedulerPortal.png
  [Страница "Действие задания" в планировщике]: ./media/web-sites-create-web-jobs/33JobActionPageInScheduler.png
  [Ссылка на журналы]: ./media/web-sites-create-web-jobs/14WebJobLogs.png
  [Сведения о веб-задании]: ./media/web-sites-create-web-jobs/15WebJobDetails.png
  [Сведения о выполнении веб-задания]: ./media/web-sites-create-web-jobs/16WebJobRunDetails.png
  [Загрузка выходных данных журнала]: ./media/web-sites-create-web-jobs/17DownloadLogOutput.png
  [Ссылка на список веб-заданий]: ./media/web-sites-create-web-jobs/18WebJobsLinkToDashboardList.png
  [Список заданий в панели мониторинга журнала]: ./media/web-sites-create-web-jobs/19WebJobsListInJobsDashboard.png
  [Приступая к работе с Microsoft Azure SDK для веб-заданий]: http://asp.net/aspnet/overview/developing-apps-with-windows-azure/getting-started-with-windows-azure-webjobs
  [Как развернуть задания Azure WebJob на веб-сайтах Azure]: http://azure.microsoft.com/ru-ru/documentation/articles/websites-dotnet-deploy-webjobs
  [Развертывание приложения консоли .NET в Azure через Git с помощью заданий WebJob]: http://blog.amitapple.com/post/73574681678/git-deploy-console-app
  [Как развернуть задания Windows Azure WebJob]: http://blog.amitapple.com/post/74215124623/deploy-azure-webjobs
  [Задания Azure WebJob — рекомендуемые ресурсы]: http://go.microsoft.com/fwlink/?LinkId=390226
  [Задания Azure WebJob 101 — стандартные задания WebJob, Джейми Эспиноза (Jamie Espinosa)]: http://www.windowsazure.com/ru-ru/documentation/videos/azure-webjobs-basics/
  [Задания Azure WebJob 102 — запланированные задания WebJob и панель мониторинга заданий WebJob, Джейми Эспиноза (Jamie Espinosa)]: http://www.windowsazure.com/ru-ru/documentation/videos/azure-webjobs-schedule-and-dashboard/
  [Планировщик Azure 101 — планирование ресурсов, Кевин Лам (Kevin Lam)]: http://www.windowsazure.com/ru-ru/documentation/videos/azure-scheduler-how-to/
  [Бесплатная пробная версия Microsoft Azure]: http://azure.microsoft.com/ru-ru/pricing/free-trial/
