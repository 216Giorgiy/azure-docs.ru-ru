<properties 
	pageTitle="Развертывание приложений Node.js с помощью Cloud9 - Учебник Azure" 
	description="Узнайте, как использовать Cloud9 IDE для разработки, построения и развертывания приложений Node.js в Azure." 
	services="cloud-services" 
	documentationCenter="nodejs" 
	authors="" 
	manager="wpickett" 
	editor=""/>

<tags 
	ms.service="cloud-services" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="na" 
	ms.devlang="nodejs" 
	ms.topic="article" 
	ms.date="09/17/2014" 
	ms.author="wpickett"/>






# Развертывание приложения Azure из Cloud9

В этом учебном курсе рассматривается разработка, сборка и
развертывание приложения Node.js в Azure с помощью Cloud9 IDE.

Из этого учебного курса вы узнаете следующее:

-   Создание проекта интегрированной среды разработки Cloud9
-   Развертывание проекта в Azure
-   Обновление существующего развертывания Azure
-   Перемещение проектов из развертывания промежуточного хранения в рабочее развертывание

[Cloud9 IDE][] предоставляет межплатформенную среду разработки на основе веб-браузера
. Одна из возможностей, поддерживаемых Cloud9 для проектов Node.js, -
это развертывание проектов в Azure непосредственно из интегрированной среды разработки.
Cloud9 также интегрируется со службами репозитория GitHub и BitBucket,
что позволяет легко обмениваться данными проекта с другими пользователями.

С помощью Cloud9 можно разрабатывать и развертывать приложения в Azure
из многих современных браузеров и операционных систем без необходимости
локально устанавливать инструменты разработки или пакеты SDK. В следующих шагах
относятся к Google Chrome на Макинтоше.

## Регистрация

Чтобы использовать Cloud9, сначала необходимо посетить их веб-сайт и [зарегистрироваться для
подписки][Cloud9 IDE]. Вы можете войти в систему под любой существующей
учетной записью GitHub или BitBucket или создать учетную запись Cloud9. Доступна как бесплатная
подписка, так и платная версия, которая
обеспечивает дополнительные функциональные возможности. Дополнительные сведения см. в разделе [Интегрированная среда разработки Cloud9][].

## Создание проекта Node.js

1.  Выполните вход в Cloud9, щелкните символ **+** рядом с разделом **Мои проекты**,
    а затем выберите **Создать проект**.

	![create new Cloud9 project](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_create_project.png)

2.  В диалоговом окне **Создать новый проект** введите имя проекта,
    параметры доступа и тип проекта. Нажмите кнопку **Создать**, чтобы создать проект.

	![create new project dialog Cloud9](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_new_project.png)

	> [AZURE.NOTE] Некоторые параметры требуют платной подписки Cloud9.
	   
	> [AZURE.NOTE] Имя вашего проекта Cloud9 не используется при развертывании в Azure.

3.  После создания проекта нажмите кнопку **Начать редактирование**. Если интегрированная среда разработки Cloud9 используется в первый раз, будет предложено пройти обучение работе с этой службой. Если вы хотите пропустить этот шаг и вернуться к нему позже, выберите **Только редактор**.

	![start editing the Cloud9 project](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_startediting.png)

4.  Для создания нового приложения Node выберите **Файл** и **Создать
    Файл**.

	![create new file in the Cloud9 project](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_filenew.png)

5.  Будет открыта новая вкладка под названием **Untitled1**. Введите
    следующий код на вкладке **Untitled1**, чтобы создать приложение Node
    приложения.

        var http = require('http');
        var port = process.env.PORT;
        http.createServer(function(req,res) {
            res.writeHead(200, { 'Content-Type': 'text/plain' });
            res.end('hello azure\n');
        }).listen(port);
	
	> [AZURE.NOTE] Использование process.env.PORT гарантирует, что приложение выберет правильный порт как при запуске в отладчике Cloud9, так и при развертывании в Azure.

6.  Чтобы сохранить код, выберите команды **Файл** и **Сохранить как**. В
    диалоговом окне **Сохранить как** введите в качестве имени файла **server.js**, а затем
    щелкните **Сохранить**.


	> [AZURE.NOTE] Вы можете заметить значок предупреждения, который указывает, что переменная req не используется. Это предупреждение можно без сомнений проигнорировать.

	![save the server.js file](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_saveas.png)

## Запуск приложения

> [AZURE.NOTE] Хотя действий, приведенных в этом разделе, достаточно для приложения Hello World, для приложений, использующих внешние модули, может потребоваться выбрать нужную версию Node.js в среде отладки. Для этого выберите пункт **Настройка...** в раскрывающемся списке для отладки, а затем выберите конкретную версию Node.js. Например, могут возникнуть ошибки проверки подлинности при использовании модуля 'azure', если не выбрана версия Node.js 0.6.x.


1.  Нажмите кнопку **Отладка**, чтобы запустить приложение в отладчике Cloud9.
	
	![run in the debugger](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_debug.png)

2.  Откроется окно вывода. Щелкните URL-адрес в списке, чтобы
    открыть приложение в окне браузера.

	![output window](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_output.png)

	Полученное приложение будет иметь следующий вид:

	![application running in browser](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_debug_browser.png)

3.  Чтобы остановить отладку приложения, нажмите кнопку **Остановить**

## Создание учетной записи Azure

Для развертывания приложения в Azure необходимо иметь учетную запись. Если у вас
еще нет подписки Azure, можно зарегистрироваться бесплатно
ознакомительную версию, выполнив следующие шаги.

[AZURE.INCLUDE [create-azure-account](../includes/create-azure-account.md)]


## Создание развертывания

1.  Чтобы создать новое развертывание, выберите **Развернуть**, а затем нажмите кнопку **+** для создания сервера развертывания.

    ![create a new deployment][create a new deployment]

2.  В диалоговом окне **Добавление целевого объекта развертывания** введите имя развертывания и выберите **Azure** в списке **Выберите тип**. Это имя развертывания будет использоваться для идентификации развертывания в Cloud9; оно не будет соответствовать имени развертывания в Azure.

3.  При первом создании развертывания Cloud9 с использованием Azure необходимо настроить параметры публикации в Azure. Чтобы загрузить и установить эти параметры в Cloud9, выполните следующие действия:

    1.  Нажмите кнопку **Загрузить параметры Azure**.

        ![download publish settings](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_choosetypeandcert.png)

        Будет открыт портал управления Azure с приглашением загрузить параметры публикации Azure. Для начала работы потребуется войти в систему под учетной записью Azure.

    2.  Сохраните файл параметров публикации на локальном диске.

    3.  В диалоговом окне **Добавление целевого объекта развертывания** выберите **Выбрать файл**,
        а затем выберите файл, скачанный на предыдущем шаге.

    4.  После выбора файла нажмите кнопку **Загрузить**.

4.  Щелкните **+ Создать**, чтобы создать новую размещенную службу.  *hosted service* - это контейнер, в котором размещается приложение при его развертывании в Azure. Дополнительные сведения см. в разделе [Обзор создания размещенной службы для Azure][].

	![create a new deployment](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_createdeployment.png)

5.  Появится приглашение ввести имя новой размещенной службы и параметры конфигурации, такие как количество экземпляров, ОС хост-компьютера и центр обработки данных. Указанное имя развертывания будет использоваться в Azure как имя размещенной службы. Имя должно быть уникальным в пределах системы Azure.
	
	![create a new hosted service](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_new_hosted_service_settings.png)

	> [AZURE.NOTE] В диалоговом окне **Добавление целевого объекта развертывания** будут перечислены все существующие размещенные службы Azure в разделе **Выбор существующего развертывания**, при выборе существующей размещенной службы проект будет развернут для этой службы.

	> [AZURE.NOTE] При выборе параметра **Включить RDP** с указанием имени пользователя и пароля будет включен удаленный рабочий стол для развертывания.


## Развертывание в рабочей среде Azure

1.  Выберите развертывание, созданное в предыдущих действиях. Откроется диалоговое
    окно с данными об этом развертывании, а также
    URL-адресом рабочей среды, который будет использоваться после развертывания в Microsoft
    Azure.

	![select a deployment](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_select_deployment.png)

2.  Выберите **Развернуть в рабочей среде**.

3.  Нажмите кнопку **Развернуть**, чтобы начать развертывание.

4.  Если развертывание проекта в Azure выполняется в первый раз, будет выведена ошибка **Не найден файл web.config**. Выберите **Да**, чтобы создать этот файл. В результате в проект будет добавлен файл  'Web.cloud.config'.
	
	![no web.config file found message](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_no_web_config.png)

5.  Если развертывание проекта в Azure выполняется в первый раз, будет выведена ошибка **Не найден  'csdef'-файл**. Выберите **Да**, чтобы создать CSDEF-файл. В результате в проект будет добавлен файл "ServiceDefinition.csdef".    Файл "ServiceDefinition.csdef" используется только в Azure для публикации приложения. Дополнительные сведения см. в разделе [Обзор создания размещенной службы для Azure][].

6.  Появится приглашение выбрать размер экземпляра для этого приложения. Выберите **Малый** и нажмите кнопку **Создать**. Дополнительные сведения о размерах виртуальных машин Azure см. в материале [Практическое руководство по настройке размеров виртуальных машин][].

	![specify csdef file values](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_createcsdef.png)

7.  Запись развертывания будет отображать состояние процесса развертывания. После завершения развертывания оно будет отображаться **Активное**

	![deployment status](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_deployment_status.png)

	> [AZURE.NOTE] Проектам развертывания через Cloud 9 IDE присваивается идентификатор GUID в качестве имени развертывания в Azure.

8.  Диалоговое окно развертывания содержит ссылку на URL-адрес рабочей среды. После завершения развертывания щелкните URL-адрес, чтобы перейти к приложению, выполняющемуся в Azure.

	![Azure production URL link](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_production_url.png)

## Обновление приложения

При внесении изменений в приложение можно использовать Cloud9 для развертывания обновленного приложения в той же размещенной службе Azure.

1.  В файле server.js обновите код таким образом, чтобы на экран было выведено "hello Azure v2". Можно заменить существующий код на следующий обновленный код:

        var http = require('http');
        var port = process.env.PORT;
        http.createServer(function(req,res) {
            res.writeHead(200, { 'Content-Type': 'text/plain' });
            res.end('hello azure v2\n');
        }).listen(port);

2.  Чтобы сохранить код, выберите команды **Файл** и **Сохранить**.

## Развертывание обновления в среде промежуточного хранения Azure

1.  Выберите **Развернуть в промежуточное хранилище**.

2.  Нажмите кнопку **Развернуть**, чтобы начать развертывание.

	Каждая размещенная служба Azure поддерживает две среды: промежуточного хранения и рабочую. Промежуточная среда в точности схожа с рабочей средой за исключением того, доступ к приложению в промежуточной среде возможен только с использованием затененного URL-адреса на основе GUID, который создается Azure. Промежуточная среда служит для тестирования приложения, после проверки изменений можно переместить промежуточную версию в рабочую среду, выполнив подмену виртуального IP (VIP), как описано далее в этом руководстве.

3.  При развертывании приложения в промежуточной среде промежуточный URL-адрес на основе GUID будет отображаться в выходных данных в консоли, как показано на следующем снимке экрана. Щелкните URL-адрес, чтобы открыть промежуточную версию приложения в браузере.

	![console output showing staging URL](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_staging_console_output.png)

## Перемещение обновления в рабочую среду с помощью подмены VIP

При развертывании службы в рабочей или промежуточной
среде ей назначается виртуальный IP-адрес в
этой среде. Если вам необходимо переместить службу из промежуточной
среды в рабочую, это можно сделать без
повторного развертывания, выполнив переключения виртуальных IP-адресов, в ходе которого эти среды меняются местами.
развертывания. Переключение виртуальных IP-адресов позволяет перенести протестированное приложение из промежуточной среды в рабочую среду без простоя в последней. Дополнительную
информацию см. в разделе [Обзор управления развертываниями в Azure.][]

1.  В диалоговом окне развертывания щелкните ссылку **Открыть портал**, чтобы открыть
    портал управления Azure.

	![Link from deploy dialog to Azure Management Portal][Link from deploy dialog to Azure Management Portal]

2.  Войдите на портал под своими учетными данными.

3.  В левой части веб-страницы выберите **Размещенные службы, учетные записи
    хранения и сеть кэширующих серверов**, а затем щелкните **Размещенные службы**.

	![Azure Management Portal][Azure Management Portal]

	В области результатов будут отображены размещенная служба с именем, указанным в Cloud9, а также два развертывания, одно из которых    Для параметра **Среда** одного развертывания будет задано значение **Промежуточная**, а другого - **Рабочая**.

4.  Для переключения VIP выберите размещенную службу и нажмите кнопку **Переключить VIP** на ленте.

	![VIP SWAP](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_portal_vipswap.png)

5.  Нажмите кнопку **ОК** в открывшемся диалоговом окне "Переключение VIP".

6.  Перейдите в приложение рабочей среды. Вы увидите, что версия приложения, ранее развернутого в промежуточной среде, теперь находится в рабочей среде.

	![Production application running on Azure](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_production_on_azure.png)

## Использование удаленного рабочего стола

Если при создании развертывания был включен RDP и указаны имя пользователя и пароль, для подключения к размещенной службе можно использовать удаленный рабочий стол, выбрав конкретный экземпляр и нажав кнопку "Подключиться" на
ленте.

![Connect to an instance](./media/cloud-services-nodejs-develop-deploy-cloud9/connect.png)

При нажатии кнопки "Подключиться" будет предложено открыть или загрузить RDP-файл. Этот файл содержит сведения, необходимые для подключения к сеансу удаленного рабочего стола. При запуске этого файла в Windows система выведет запрос на ввод имени имя пользователя и пароля, которые были введены при создании развертывания, а затем создаст подключение с рабочим столом выбранного
роли.

> [AZURE.NOTE] RDP-файл для подключения к размещенному экземпляру приложения будет работать только с приложением удаленного рабочего стола в
Windows.

## Остановка и удаление приложения

Azure предусматривает взимание платы за час использованного рабочего времени, а серверное время потребляется, когда приложение развернуто, даже если экземпляры не выполняются и находятся в состоянии остановки. Кроме того,
серверное время используется и в промежуточном, и в рабочем развертываниях.

Cloud9 специализируется на предоставлении интегрированной среды разработки и не предоставляет прямые способы для останова или удаления приложения после его развертывания в Azure. Чтобы удалить приложение, размещенное в Azure, выполните следующие действия:

1.  В диалоговом окне развертывания щелкните ссылку **Открыть портал**, чтобы открыть портал управления Azure.

	![Link from deploy dialog to Azure Management Portal](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_portal_link.png)

2.  Войдите на портал под своими учетными данными.

3.  В левой части веб-страницы выберите **Размещенные службы, учетные записи хранения и CDN**, а затем щелкните **Размещенные службы**.

4.  Выберите промежуточную версию развертывания (обозначается значением параметра **Среда**). Чтобы удалить приложение, нажмите кнопку **Удалить** на ленте.

	![delete the deployment](./media/cloud-services-nodejs-develop-deploy-cloud9/cloud9_deletedeployment.png)

5.  Выберите развертывание в рабочей среде и нажмите кнопку **Удалить**, чтобы удалить и это приложение.

## Дополнительные ресурсы

-   [Документация по Cloud9][]


  [Интегрированная среда разработки Cloud9]: http://cloud9ide.com/ 
  [Cloud9 IDE]: http://cloud9ide.com/ 
  [Обзор создания размещенной службы для Azure]: http://msdn.microsoft.com/library/windowsazure/jj155995.aspx
  [Практическое руководство по настройке размеров виртуальных машин]: http://msdn.microsoft.com/library/windowsazure/ee814754.aspx
  [Обзор управления развертываниями в Azure.]: http://msdn.microsoft.com/library/windowsazure/gg433027.aspx
  [Документация по Cloud9]: http://go.microsoft.com/fwlink/?LinkId=241421&clcid=0x409

<!--HONumber=45--> 
