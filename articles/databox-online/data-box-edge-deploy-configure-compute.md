---
title: Преобразование данных с помощью Azure Data Box Edge | Документация Майкрософт
description: Узнайте, как настроить роль вычислений в Data Box Edge и использовать ее для преобразования данных перед отправкой в Azure.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: tutorial
ms.date: 11/27/2018
ms.author: alkohli
Customer intent: As an IT admin, I need to understand how to configure compute on Data Box Edge so I can use it to transform the data before sending it to Azure.
ms.openlocfilehash: c0901f22e4941fdfaa21138153a06e97c2d6095f
ms.sourcegitcommit: c94cf3840db42f099b4dc858cd0c77c4e3e4c436
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/19/2018
ms.locfileid: "53630382"
---
# <a name="tutorial-transform-data-with-azure-data-box-edge-preview"></a>Руководство. Преобразование данных с помощью Azure Data Box Edge (предварительная версия)

В этом руководстве описывается, как настроить роль вычислений в устройстве Azure Data Box Edge. После того как роль вычислений настроена, Data Box Edge может преобразовывать данные перед отправкой в ​​Azure.

Эта процедура может занять от 30 до 45 минут.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание ресурса Центра Интернета вещей
> * Настройка роли вычислений.
> * Добавление модуля вычислений.
> * Проверка преобразования и передачи данных.

> [!IMPORTANT]
> В данный момент решение Data Box Edge находится в состоянии предварительной версии. Ознакомьтесь со статьей [Дополнительные условия использования Предварительных версий Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/), а затем закажите и разверните это решение.
 
## <a name="prerequisites"></a>Предварительные требования

Прежде чем вы настроите роль вычисления на устройстве Data Box Edge, убедитесь, что:

* Устройство Data Box Edge активировано, как описано в статье [Руководство. Подключение, настройка и активация Azure Data Box Edge (предварительная версия)](data-box-edge-deploy-connect-setup-activate.md).


## <a name="create-an-iot-hub-resource"></a>Создание ресурса центра Интернета вещей

Прежде чем настраивать роль вычислений в Data Box Edge, вы должны создать ресурс Центра Интернета вещей.

Подробные инструкции см. в разделе [Создание Центра Интернета вещей](https://docs.microsoft.com/azure/iot-hub/iot-hub-create-through-portal#create-an-iot-hub). Используйте ту же подписку и группу ресурсов, что и для вашего ресурса Data Box Edge.

![Создание ресурса центра Интернета вещей](./media/data-box-edge-deploy-configure-compute/create-iothub-resource-1.png)

Если роль пограничных вычислений не была настроена, применяются следующие предупреждения:

- В ресурсе Центра Интернета вещей отсутствуют устройства Интернета вещей и устройства Azure IoT Edge.
- Вы не можете создавать локальные общие ресурсы Edge. Когда вы добавляете общий ресурс, возможность создания локального общего ресурса для вычисления Edge не включена.


## <a name="set-up-compute-role"></a>Настройка роли вычислений.

При настройке роли вычислений Edge на устройстве Edge создается два устройства — устройство Интернета вещей и устройство IoT Edge. Оба устройства можно просмотреть в ресурсе Центра Интернета вещей.

Чтобы настроить роль вычислений на устройстве, выполните следующее:

1. Перейдите к ресурсу Data Box Edge, а затем выберите **Обзор** и нажмите кнопку **Set up compute role** (Настроить роль вычислений). 

    ![Ссылка "Обзор" в левой области](./media/data-box-edge-deploy-configure-compute/setup-compute-1.png)
   
    При необходимости вы можете перейти в раздел **Модули** и выбрать **Настройка вычислений**.

    ![Ссылки "Модули" и "Настройка вычислений"](./media/data-box-edge-deploy-configure-compute/setup-compute-2.png)
 
1. В раскрывающемся списке выберите **ресурс Центра Интернета вещей**, который вы создали на предыдущем шаге.  
    На данный момент доступна только платформа Linux для устройства IoT Edge. 
    
1. Нажмите кнопку **Создать**.

    ![Кнопка "Создать"](./media/data-box-edge-deploy-configure-compute/setup-compute-3.png)
 
    Для создания роли вычислений требуется несколько минут. Из-за ошибки в этом выпуске даже при создании роли вычислений экран не обновляется. Чтобы убедиться, что роль пограничных вычислений была настроена, перейдите в раздел **Модули**.  

    ![Список устройств "Настройка пограничных вычислений"](./media/data-box-edge-deploy-configure-compute/setup-compute-4.png)

1. Перейдите на вкладку **Обзор** снова.  
    Теперь экран обновлен и на нем указано, что настроена роль вычислений.

    ![Настройка роли вычислений](./media/data-box-edge-deploy-configure-compute/setup-compute-5.png)
 
1. В Центре Интернета вещей, используемом при создании роли пограничных вычислений, перейдите к разделу **Устройства Интернета вещей**.  
    Устройство Интернета вещей теперь включено. 

    ![Страница "Устройства Интернета вещей"](./media/data-box-edge-deploy-configure-compute/setup-compute-6.png)

1. В левой области щелкните **IoT Edge**.  
    Устройство IoT Edge также включено.

    ![Настройка роли вычислений](./media/data-box-edge-deploy-configure-compute/setup-compute-7.png)
 
1. Выберите и щелкните устройство IoT Edge.  
    Агент Edge работает на этом устройстве IoT Edge. 

    ![Страница сведений об устройстве](./media/data-box-edge-deploy-configure-compute/setup-compute-8.png) 

    На этом устройстве Edge отсутствуют пользовательские модули, однако сейчас вы можете добавить такой модуль. Чтобы узнать, как создать пользовательский модуль, ознакомьтесь со статьей [Разработка на C# модуля IoT Edge для перемещения файлов в Data Box Edge (предварительная версия)](data-box-edge-create-iot-edge-module.md).


## <a name="add-a-custom-module"></a>Добавление настраиваемого модуля

В этом разделе вы добавите пользовательский модуль к устройству IoT Edge, которое было создано с помощью руководства [Разработка на C# модуля IoT Edge для перемещения файлов в Data Box Edge (предварительная версия)](data-box-edge-create-iot-edge-module.md). 

В этой процедуре используется пример, в котором настраиваемый модуль берет файлы из локального ресурса на устройстве Edge и переносит их в облачный файловый ресурс на устройстве. Затем облачный ресурс переносит файлы в учетную запись Azure, связанную с облачным ресурсом. 

1. Добавьте локальный ресурс на устройство Edge следующим образом:

    a. В ресурсе Data Box Edge перейдите на вкладку **Общие папки**. 
    
    b. Выберите **Добавление общего файлового ресурса**, а затем укажите имя общего ресурса и выберите его. 
    
    c. Чтобы создать локальный общий ресурс, установите флажок **Настройка в качестве локальной общей папки Edge**. 
    
    d. Выберите **Создать** или **Использовать имеющееся**, а затем щелкните **Создать**.

    ![Добавление настраиваемого модуля](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-1.png) 

    Если вы создали локальный общий ресурс NFS, используйте следующую команду удаленной синхронизации (rsync) для копирования в него файлов:

    `rsync --inplace <source file path> < destination file path>`

    Дополнительные сведения о команде rsync см. в [документации по Rsync](https://www.computerhope.com/unix/rsync.htm). 

    Будет создан локальный общий ресурс, и вы получите уведомление об успешном создании. Список общих ресурсов может быть обновлен, однако вам нужно дождаться завершения создания общего ресурса.
    
1. Перейдите к списку общих ресурсов. 

    ![Добавление настраиваемого модуля](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-2.png) 
 
1. Выберите созданный локальный общий ресурс, чтобы просмотреть его свойства. 

1. Скопируйте значение, соответствующее этому ресурсу, в поле **Локальная точка подключения для модулей пограничных вычислений**.  
    Эта локальная точка подключения используется при развертывании модуля.

    ![Поле "Локальная точка подключения для модулей пограничных вычислений"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-3.png) 
 
1. В существующем общем облачном ресурсе, созданном на устройстве Data Box Edge, в поле **Локальная точка подключения для модулей пограничных вычислений** скопируйте локальную точку подключения для модулей пограничного вычисления этого общего облачного ресурса.  
    Эта локальная точка подключения используется при развертывании модуля.

    ![Добавление настраиваемого модуля](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-4.png)  

1. Для добавления настраиваемого модуля в устройство IoT Edge перейдите в ресурс Центра Интернета вещей,а затем к **устройству IoT Edge**. 

1. Выберите устройство, а затем в разделе **Сведения об устройстве** выберите **Задание модулей**. 

    ![Ссылка "Задание модулей"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-5.png) 

1. В разделе **Добавить модули** выполните следующее:

    a. Введите имя, адрес, имя пользователя и пароль для параметров реестра контейнеров для настраиваемого модуля.  
    Имя, адрес и перечисленные учетные данные используются для извлечения модулей с соответствующим URL-адресом. Чтобы развернуть этот модуль, в разделе **Модули развертывания** выберите **Модуль IoT Edge**. Этот модуль IoT Edge является контейнером docker, который можно развернуть на устройстве IoT Edge, связанном с устройством Data Box Edge.

    ![Страница "Задание модулей"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-6.png) 
 
    b. Укажите параметры для пользовательского модуля IoT Edge, введя имя своего модуля и URI изображения для соответствующего образа контейнера. 
    
    ![Страница "Пользовательские модули IoT Edge"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-7.png) 

    c. В поле **Параметры создания контейнера** введите локальные точки подключения для модулей Edge, которые вы скопировали на предыдущих шагах для облачного и локального общих ресурсов.
    > [!IMPORTANT]
    > Используйте скопированные пути. Не создавайте новые. Локальные точки подключения сопоставляются с соответствующими значениями **InputFolderPath** и **OutputFolderPath**, которые вы указали в модуле при его [обновлении с помощью пользовательского кода](data-box-edge-create-iot-edge-module.md#update-the-module-with-custom-code). 
    
    В поле **Параметры создания контейнера** можно вставить следующий пример: 
    
    ```
    {
        "HostConfig": {
        "Binds": [
        "/home/hcsshares/mysmblocalshare:/home/LocalShare",
        "/home/hcsshares/mysmbshare1:/home/CloudShare"
        ]
        }
    }
    ```

    Здесь также укажите любые переменные среды для вашего модуля.

    ![Поле "Параметры создания контейнера"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-8.png) 
 
    d. При необходимости настройте расширенные параметры Edge, а затем нажмите кнопку **Далее**.

    ![Добавление настраиваемого модуля](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-9.png) 
 
1.  В разделе **Укажите маршруты** настройте маршруты между модулями.  
    В этом случае введите имя локального общего ресурса, который будет отправлять данные в облачный общий ресурс.

    *Маршрут* можно заменить следующей строкой маршрута:       `"route": "FROM /* WHERE topic = 'mysmblocalshare' INTO BrokeredEndpoint(\"/modules/filemovemodule/inputs/input1\")"`

    ![Раздел "Укажите маршруты"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-10.png) 

1. Щелкните **Далее**. 

1.  В разделе **Проверка развертывания** просмотрите все параметры, а затем выберите **Отправить**, чтобы отправить модуль для развертывания.

    ![Страница "Задание модулей"](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-11.png) 
 
    Это действие запускает развертывание модуля, как показано на следующем рисунке:

    ![Добавление настраиваемого модуля](./media/data-box-edge-deploy-configure-compute/add-a-custom-module-12.png) 

### <a name="verify-data-transform-and-transfer"></a>Проверка преобразования и передачи данных

Последний шаг — убедиться, что модуль подключен и работает как ожидалось. Состояние выполнения модуля должно быть "Работает" для вашего устройства IoT Edge в ресурсе Центра Интернета вещей.

![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-1.png) 
 
Чтобы убедиться, что модуль работает, выполните следующее:

1. Выберите модуль и просмотрите вкладку "Двойник удостоверения модуля".  
    Должно отображаться состояние *Подключено* для клиента модуля и устройства Edge.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-2.png) 
 
    После запуска модуля он также появится в списке модулей Edge в вашем ресурсе Data Box Edge. Состояние среды выполнения модуля, который вы добавили, — *Запущен*.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-3.png) 
 
1.  С помощью проводника подключитесь к локальным и облачным общим ресурсам, созданным ранее.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-4.png) 
 
1.  Добавьте данные в локальную общую папку.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-5.png) 
 
    Данные переносятся в облачную общую папку.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-6.png)  

    Затем данные переносятся из облачного ресурса в учетную запись хранения. Чтобы просмотреть данные, перейдите в Обозреватель службы хранилища.

    ![Проверка преобразования данных](./media/data-box-edge-deploy-configure-compute/verify-data-transform-7.png) 
 
Вы завершили процесс проверки.


## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

> [!div class="checklist"]
> * Создание ресурса центра Интернета вещей
> * Настройка роли вычислений.
> * Добавление модуля вычислений.
> * Проверка преобразования и передачи данных

Чтобы узнать, как администрировать устройство Data Box Edge, перейдите к следующему руководству.

> [!div class="nextstepaction"]
> [Use local web UI to administer a Data Box Edge](https://aka.ms/dbg-docs) (Использование локального веб-интерфейса для администрирования Data Box Edge)


