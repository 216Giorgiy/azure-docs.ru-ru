---
title: Запуск скриптов U-SQL из Azure Data Lake на локальном компьютере | Документация Майкрософт
description: Узнайте, как запускать задания U-SQL с помощью Средств Azure Data Lake для Visual Studio.
services: data-lake-analytics
documentationcenter: ''
author: yanancai
manager: ''
editor: ''
ms.assetid: 66dd58b1-0b28-46d1-aaae-43ee2739ae0a
ms.service: data-lake-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 07/03/2018
ms.author: yanacai
ms.openlocfilehash: a7f43c7e17f36d9b4e0767744eee9604c2628ea8
ms.sourcegitcommit: 11321f26df5fb047dac5d15e0435fce6c4fde663
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2018
ms.locfileid: "37888972"
---
# <a name="run-u-sql-script-on-your-local-machine"></a>Запуск скриптов U-SQL на локальном компьютере

Разрабатываемые скрипты U-SQL часто запускаются в локальной среде для экономии времени и ресурсов. Средства Azure Data Lake для Visual Studio позволяют запускать скрипты U-SQL на локальных компьютерах. 

## <a name="basic-concepts-for-local-run"></a>Основные понятия, связанные с локальным запуском

На схеме ниже показаны компоненты, требуемые для запуска в локальной среде и облачной средах.

|Компонент|Запуск в локальной среде|Запуск в облачной среде|
|---------|---------|---------|
|Служба хранилища|Корневая папка локальных данных|Учетная запись Azure Data Lake Storage по умолчанию|
|Службы вычислений|Модуль запуска U-SQL в локальной среде|Служба Azure Data Lake Analytics|
|Среда выполнения|Рабочая папка на локальном компьютере|Кластер Azure Data Lake Analytics|

Подробное описание компонентов, требуемых для локального запуска:

### <a name="local-data-root-folder"></a>Корневая папка локальных данных

Корневая папка данных — это локальное хранилище для локальной учетной записи среды вычислений. Любая папка в локальной файловой системе на локальном компьютере может быть локальной корневой папкой данных. Она соответствует учетной записи Azure Data Lake Storage по умолчанию в учетной записи Data Lake Analytics. Переход в другую корневую папку данных аналогичен переходу в другую учетную запись хранения по умолчанию. 

Корневая папка данных используется следующим образом:
- для хранения метаданных, включая базы данных, таблицы, функции с табличным значением и сборки;
- для поиска путей ввода-вывода, которые определяются как относительные пути в скриптах U-SQL. Использование относительных путей упрощает развертывание скриптов U-SQL в Azure.

### <a name="u-sql-local-run-engine"></a>Модуль запуска U-SQL в локальной среде

Модуль запуска U-SQL в локальной среде — это локальная учетная запись среды вычислений для заданий U-SQL. Пользователи могут запускать задания U-SQL в локальной среде с помощью Средств Azure Data Lake для Visual Studio. Выполнение в локальной среде также поддерживается с использованием командной строки или программных интерфейсов пакета SDK Azure Data Lake для U-SQL. См. дополнительные сведения о [пакете SDK Azure Data Lake для U-SQL](https://www.nuget.org/packages/Microsoft.Azure.DataLake.USQL.SDK/).

### <a name="working-directory"></a>Рабочий каталог

При выполнении скрипта U-SQL требуется рабочая папка для кэширования результатов компиляции, журналов выполнения и т. д. В Средствах Azure Data Lake для Visual Studio рабочая папка — это соответствующая папка проекта U-SQL, которая обычно расположена в `<U-SQL project root path>/bin/debug>`. Рабочая папка очищается при каждой активации нового запуска.

## <a name="local-run-in-visual-studio"></a>Выполнение в локальной среде в Visual Studio

Средства Azure Data Lake для Visual Studio имеют встроенный модуль для запуска в локальной среде, который можно использовать в локальной учетной записи среды вычислений. Чтобы запустить скрипт U-SQL локально, выберите учетную запись (Local-machine) или (Local-project) в соответствующем поле в раскрывающемся списке редактора скриптов и нажмите кнопку **Отправить**.

![Отправка скриптов в локальную учетную запись с помощью Средств Data Lake для Visual Studio](./media/data-lake-analytics-data-lake-tools-local-run/data-lake-tools-submit-script-to-local-account.png) 
 
## <a name="local-run-with-local-machine-account"></a>Запуск в локальной среде с помощью с учетной записи (Local-machine)

Учетная запись (Local-machine) — это общая локальная учетная запись среды вычислений с одной локальной папкой данных в качестве локальной учетной записи хранения. Корневая папка по умолчанию расположена здесь: C:\Users\<имя_пользователя>\AppData\Local\USQLDataRoot. Ее можно настроить, выбрав **Средства > Data Lake > Параметры и настройки**.

![Настройка локальной рабочей папки с помощью Средств Data Lake для Visual Studio](./media/data-lake-analytics-data-lake-tools-local-run/data-lake-tools-configure-local-data-root.png)
  
Для выполнения в локальной среде требуется проект U-SQL. Рабочая папка проекта U-SQL используется в качестве рабочей папки U-SQL для выполнения в локальной среде. Результаты компиляции, журналы выполнения и другие файлы, связанные с выполнением задания, создаются и хранятся в рабочей папке в ходе выполнения в локальной среде. Обратите внимание: при каждом повторном запуске скрипта все эти файлы в рабочей папке будут очищены и созданы заново.

## <a name="local-run-with-local-project-account"></a>Запуск в локальной среде с помощью с учетной записи (Local-project)

Учетная запись (Local-project) — это локальная учетная запись среды вычислений, используемая в пределах каждого проекта с изолированной локальной корневой папкой данных. Каждый активный проект U-SQL, открываемый в обозревателе решений, имеет соответствующую учетную запись `(Local-project: <project name>)`, включенную в поле редактора скриптов U-SQL и обозревателя серверов. 

Учетная запись (Local-project) предоставляет чистую и изолированную среду разработки для разработчиков. В отличие от учетной записи (Local-machine), которая содержит общую локальную корневую папку данных с метаданными и входящими и исходящими данными для всех локальных заданий, учетная запись (Local-project) создает временную локальную корневую папку данных в рабочей папке проекта U-SQL при каждом запуске скрипта U-SQL. Эта временная папка очищается при повторном создании или выполнении. 

Проект U-SQL предоставляет удобные возможности для управления изолированной локальной средой с помощью ссылки на проект и его свойства. Вы можете настроить источники входных данных для скриптов U-SQL в проекте, а также среды баз данных, на которые указывает ссылка.

### <a name="manage-input-data-source-for-local-project-account"></a>Управление источником входных данных для учетной записи (Local-project)

Проект U-SQL автоматически создает локальную корневую папку данных и настраивает данные для учетной записи (Local-project). Временная корневая папка данных очищается и заново создается в рабочей папке проекта U-SQL при каждом повторном создании и выполнении в локальной среде. Все источники данных, настроенные в проекте U-SQL, копируются в эту временную локальную корневую папку данных перед выполнением заданий в локальной среде. 

Можно настроить корневую папку для источников данных, щелкнув правой кнопкой мыши **проект U-SQL > Свойства > Источник тестовых данных**. При запуске скрипта U-SQL в учетной записи (Local-project) все файлы и вложенные папки (включая файлы во вложенных папках) в папке **источника тестовых данных** копируются во временную локальную корневую папку данных. После выполнения задания в локальной среде результаты можно найти в этой временной папке в рабочей папке проекта. Обратите внимание, что все эти выходные данные будут удалены и очищены при повторном создании и очистке проекта. 

![Настройка источника тестовых данных проекта с помощью Средств Data Lake для Visual Studio](./media/data-lake-analytics-data-lake-tools-local-run/data-lake-tools-configure-project-test-data-source.png)

### <a name="manage-referenced-database-environment-for-local-project-account"></a>Управление средой базы данных, на которую указывает ссылка, для учетной записи (Local-project) 

Если U-SQL-запрос использует объекты базы данных U-SQL или обращается к ним, вам нужно локально подготовить среды баз данных, прежде чем запускать этот скрипт U-SQL в локальной среде. В учетной записи (Local-project) зависимостями базы данных U-SQL можно управлять, используя ссылки на проект U-SQL. Можно добавить ссылки на проект базы данных U-SQL в проект U-SQL. Перед запуском скриптов U-SQL в учетной записи (Local-project) все базы данных, на которую указывает ссылка, развертываются во временной локальной корневой папке данных. После каждого запуска эта папка очищается, обеспечивая новую изолированную среду.

Связанные статьи:
* [Сведения об управлении определением базы данных U-SQL с помощью проекта базы данных U-SQL](data-lake-analytics-data-lake-tools-develop-usql-database.md#reference-a-u-sql-database-project)
* [Сведения об управлении ссылками на базы данных U-SQL в проекте базы данных U-SQL](data-lake-analytics-data-lake-tools-develop-usql-database.md)

## <a name="difference-between-local-machine-and-local-project-account"></a>Разница между учетными записями (Local-machine) и (Local-project)

Учетная запись (Local-machine) имитирует учетную запись Azure Data Lake Analytics на локальном компьютере пользователя. Она предоставляет те же возможности, что и учетная запись Azure Data Lake Analytics. Учетная запись (Local-project) обеспечивает удобную локальную среду разработки, в которой пользователи могут развертывать ссылки на базы данных и входные данные перед запуском скрипта в локальной среде. Учетная запись (Local-machine) предоставляет общую постоянную среду, доступ к которой можно получить из любого проекта. Учетная запись (Local-project) предоставляет изолированную среду разработки для каждого проекта, которая обновляется при каждом запуске. Таким образом, учетная запись (Local-project) позволяет ускорить процесс разработки благодаря возможности быстрого применения изменений.

Разница между учетными записями (Local-machine) и (Local-project) приведена в таблице ниже.

|Разница|(Local-machine)|(Local-project)|
|----------------|---------------|---------------|
|Локальный доступ|Возможно для всех проектов.|Только соответствующий проект может получить доступ к этой учетной записи.|
|Корневая локальная папка данных|Постоянная локальная папка. Настраивается здесь: **Средства > Data Lake > Параметры и настройки**.|Временная папка, создаваемая при каждом запуске в локальной среде в рабочей папке проекта U-SQL. Эта папка очищается при повторном создании или выполнении.|
|Входные данные для скрипта U-SQL|Относительный путь к постоянной локальной корневой папке данных.|Настраивается здесь: **Свойство проекта U-SQL > Источник тестовых данных**. Все файлы и вложенные папки копируются во временную корневую папку данных перед запуском в локальной среде.|
|Выходные данные для скрипта U-SQL|Относительный путь к постоянной локальной корневой папке данных.|Выводятся во временную корневую папку данных. Результаты очищаются при повторном создании или выполнении.|
|Развертывание баз данных, на которые указывает ссылка|Базы данных, на которые указывает ссылка, не развертываются автоматически при запуске в учетной записи (Local-machine). Это же применимо и к учетной записи Azure Data Lake Analytics.|Базы данных, на которые указывает ссылка, развертываются автоматически в учетной записи (Local-project) перед запуском в локальной среде. Все среды базы данных очищаются и повторно развертываются при повторном создании или запуске.|

## <a name="local-run-with-u-sql-sdk"></a>Запуск в локальной среде с помощью пакета SDK для U-SQL

Запускать скрипты U-SQL в локальной среде можно с помощью Visual Studio и пакета SDK Azure Data Lake для U-SQL. В последнем случае используется интерфейс командной строки или программные интерфейсы. Эти интерфейсы позволяют автоматизировать запуск U-SQL и тестирование в локальной среде.

Узнайте больше о [пакете SDK Azure Data Lake для U-SQL](data-lake-analytics-u-sql-sdk.md).

## <a name="next-steps"></a>Дальнейшие действия

- [Пакет SDK Azure Data Lake для U-SQL](data-lake-analytics-u-sql-sdk.md)
- [Настройка конвейера CI/CD для Azure Data Lake Analytics](data-lake-analytics-cicd-overview.md)
- [Использование проекта базы данных U-SQL для разработки базы данных U-SQL](data-lake-analytics-data-lake-tools-develop-usql-database.md)
- [Тестирование кода Azure Data Lake Analytics](data-lake-analytics-cicd-test.md)
