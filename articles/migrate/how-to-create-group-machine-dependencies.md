---
title: "Группирование компьютеров на основе зависимостей с помощью службы \"Миграция Azure\" | Документация Майкрософт"
description: "В этой статье описывается, как создать оценку на основе зависимостей компьютера с помощью службы \"Миграция Azure\"."
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: article
ms.date: 12/25/2017
ms.author: raynew
ms.openlocfilehash: 720380fd14d9eaf4856ad75269a80f2b63a4725f
ms.sourcegitcommit: 85012dbead7879f1f6c2965daa61302eb78bd366
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/02/2018
---
# <a name="group-machines-using-machine-dependency-mapping"></a>Группирование компьютеров с помощью зависимостей

В этой статье описывается, как создать группу компьютеров для оценки с помощью службы [миграции Azure](migrate-overview.md), используя визуализацию зависимостей компьютеров. Этот метод обычно используется, если вы хотите оценить группы виртуальных машин с более высоким уровнем достоверности, выполнив перекрестную проверку зависимостей компьютеров, прежде чем выполнять оценку. Визуализация зависимостей поможет эффективно спланировать миграцию в Azure, гарантируя полный перенос без простоев. Вы сможете обнаружить все взаимозависимые системы, которые нужно переносить вместе, и определить, используют ли пользователи запущенную систему или ее уже нужно вывести из эксплуатации. 


## <a name="prepare-machines-for-dependency-mapping"></a>Подготовка компьютеров к сопоставлению зависимостей
Чтобы просмотреть зависимости компьютеров, необходимо скачать и установить агенты на каждом локальном компьютере, который нужно оценить. Кроме того, если у вас есть компьютеры без подключения к Интернету, на них необходимо скачать и установить [шлюз OMS](../log-analytics/log-analytics-oms-gateway.md).

### <a name="download-and-install-the-vm-agents"></a>Скачивание и установка агентов виртуальной машины
1. На странице **Обзор** выберите **Управление** > **Компьютеры** и выберите необходимый компьютер.
2. В столбце **Зависимости** щелкните **Установить агенты**. 
3. На странице **Зависимости** скачайте и установите Microsoft Monitoring Agent (MMA) и агент зависимостей на каждую виртуальную машину, которую нужно оценить.
4. Скопируйте идентификатор и ключ рабочей области. Они требуются для установки MMA на локальном компьютере.

### <a name="install-the-mma"></a>Установка MMA

Вот как можно установить агент на компьютере Windows.

1. Дважды щелкните скачанный файл агента.
2. На странице **приветствия** нажмите кнопку **Далее**. На странице **Условия лицензии** нажмите кнопку **Принимаю**, чтобы принять условия лицензии.
3. В поле **Конечная папка** оставьте или измените папку установки по умолчанию. Нажмите кнопку **Далее**. 
4. В разделе **Параметры установки агента** выберите **Azure Log Analytics (OMS)** > **Далее**. 
5. Выберите **Добавить**, чтобы добавить новую рабочую область OMS. Вставьте идентификатор и ключ рабочей области, скопированные на портале. Нажмите кнопку **Далее**.


Вот как можно установить агент на компьютере Linux.

1. Перенесите соответствующий пакет (x86 или x64) на компьютер Linux с помощью scp или sftp.
2. Установите пакет, используя аргумент --install.

    ```sudo sh ./omsagent-<version>.universal.x64.sh --install -w <workspace id> -s <workspace key>```


### <a name="install-the-dependency-agent"></a>Установка агента зависимостей
1. Чтобы установить агент зависимостей на компьютере Windows, дважды щелкните файл установки и следуйте инструкциям мастера.
2. Чтобы установить агент зависимостей на компьютере Linux, сделайте это с правами привилегированного пользователя, используя следующую команду.

    ```sh InstallDependencyAgent-Linux64.bin```

[Узнайте больше](../operations-management-suite/operations-management-suite-service-map-configure.md#supported-operating-systems) об операционных системах, поддерживаемых агентом зависимостей. 

## <a name="create-a-group"></a>Создание группы

1. После установки агентов перейдите на портал и выберите **Управление** > **Компьютеры**.
2. Найдите компьютер, на который вы установили агенты.
3. Столбец **зависимостей** для компьютера должен теперь отображаться как **Просмотреть зависимости**. Щелкните столбец для просмотра зависимостей компьютера.
4. На карте зависимостей компьютера появятся следующие сведения:
    - Входящие (клиенты) и исходящие (серверы) TCP-подключения к компьютеру и от него:
        - зависимые компьютеры, на которых не установлен агент MMA и агент зависимостей, будут сгруппированы по номерам порта;
        - зависимые компьютеры, на которых установлен агент MMA и агент зависимостей, будут отображаться в отдельных полях. 
    - Чтобы просмотреть процессы, запущенные на компьютере, разверните поле каждого компьютера.
    - Чтобы просмотреть сведения о таких свойствах, как полное доменное имя (FQDN), операционная система, MAC-адрес каждого компьютера, щелкните каждое поле компьютера.

 ![Просмотр зависимостей компьютера](./media/how-to-create-group-machine-dependencies/machine-dependencies.png)

4. Вы можете просмотреть зависимости за разные периоды. Для этого нужно щелкнуть длительность периода в метке диапазона времени. По умолчанию диапазон равен одному часу. Можно изменить диапазон времени или указать даты начала и окончания и длительность.
5. После определения зависимых компьютеров, которые необходимо сгруппировать, выберите несколько компьютеров на карте, удерживая клавишу CTRL, а затем щелкните **Группировать компьютеры**.
6. Укажите имя группы. Проверьте, нашла ли служба миграции Azure зависимые компьютеры. 

    > [!NOTE]
    > Если нет, компьютеры нельзя добавить в группу. Чтобы добавить такие компьютеры в группу, необходимо снова запустить процесс обнаружения в подходящей области в vCenter Server, и убедиться, что служба миграции Azure нашла зависимые компьютеры.  

7. Если вы хотите создать оценку для этой группы, установите флажок.
8. Нажмите кнопку **ОК**, чтобы сохранить группу.

После создания группы рекомендуется установить агенты на всех входящих в нее компьютерах и уточнить ее путем визуализации зависимости всей группы.

## <a name="next-steps"></a>Дополнительная информация

- [Узнайте, как](how-to-create-group-dependencies.md) уточнить группу путем визуализации ее зависимостей.
- [Узнайте больше](concepts-assessment-calculation.md) о вычислении оценок.
