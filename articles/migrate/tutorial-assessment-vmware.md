---
title: "Обнаружение и оценка локальных виртуальных машин VMware для миграции в Azure с помощью службы \"Миграция Azure\" | Документация Майкрософт"
description: "В этой статье описывается, как обнаруживать и оценивать локальные виртуальные машины VMware для миграции в Azure с помощью службы \"Миграция Azure\"."
services: migration-planner
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: a2521630-730f-4d8b-b298-e459abdced46
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 11/22/2017
ms.author: raynew
ms.openlocfilehash: 1c21364c3ff5cfb61866c912a699b722f2668607
ms.sourcegitcommit: 651a6fa44431814a42407ef0df49ca0159db5b02
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2017
---
# <a name="discover-and-assess-on-premises-vmware-vms-for-migration-to-azure"></a>Обнаружение и оценка локальных виртуальных машин VMware для миграции в Azure

Службы [Миграция Azure](migrate-overview.md) выполняют оценку локальных рабочих нагрузок для миграции в Azure.

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * Создайте проект службы "Миграция Azure".
> * Настройте локальную виртуальную машину сборщика для обнаружения локальных виртуальных машин VMware для оценки.
> * Сгруппируйте виртуальные машины и создайте оценку.


Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.


## <a name="prerequisites"></a>Предварительные требования

- **VMware**. Требуется по крайней мере одна виртуальная машина VMware, размещенная на узле или кластере ESXi под управлением версии 5.0 или более поздней версии. Этим узлом или кластером должен управлять сервер vCenter Server версии 5.5, 6.0 или 6.5.
- **Учетная запись vCenter**. Необходима учетная запись только для чтения с учетными данными администратора для сервера vCenter Server. Служба "Миграция Azure" использует эту учетную запись для обнаружения виртуальных машин.
- **Разрешения**. На сервере vCenter Server необходимы разрешения для создания виртуальной машины путем импорта OVA-файла. 
- **Параметры статистики**. Перед началом развертывания для сервера vCenter Server нужно задать параметры статистики уровня 3. Если указать уровень ниже 3, оценка будет работать, но данные о производительности хранилища и сети собраться не будут.

## <a name="log-in-to-the-azure-portal"></a>Войдите на портал Azure.
Войдите на [портал Azure](https://portal.azure.com).

## <a name="create-a-project"></a>Создание проекта

1. На портале Azure щелкните **Создать ресурс**.
2. Выполните поиск **Миграция Azure** и выберите службу **Миграция Azure (preview)** в результатах поиска. Затем щелкните **Создать**.
3. Укажите имя проекта и подписку Azure для него.
4. Создайте новую группу ресурсов.
5. Укажите регион, в котором следует создать проект, а затем нажмите кнопку **Создать**. Метаданные, полученные из локальных виртуальных машин, будут храниться в этом регионе. Проект службы "Миграция Azure" для данной предварительной версии можно создать только в регионе "Центральная часть США". Тем не менее можно оценить виртуальные машины для другого расположения.

    ![Служба "Миграция Azure"](./media/tutorial-assessment-vmware/project-1.png)
    


## <a name="download-the-collector-appliance"></a>Скачивание модуля сборщика

Служба "Миграция Azure" создает локальную виртуальную машину, известную как модуль сборщика. Эта виртуальная машина обнаруживает локальные виртуальные машины VMware и отправляет метаданные о них в службу "Миграция Azure". Чтобы настроить модуль сборщика, скачайте OVA-файл и импортируйте его на локальный сервер vCenter Server для создания виртуальной машины.

1. В проекте службы "Миграция Azure" щелкните **Начало работы** > **Обнаружение и оценка** > **Обнаружение компьютеров**.
2. В окне **Обнаружение компьютеров** щелкните **Скачать**, чтоб скачать OVA-файл.
3. В окне **Копирование учетных данных проекта** скопируйте идентификатор и ключ проекта. Они потребуются при настройке сборщика.

    ![Скачивание OVA-файла](./media/tutorial-assessment-vmware/download-ova.png)

### <a name="verify-the-collector-appliance"></a>Проверка модуля сборщика

Прежде чем развертывать OVA-файл, убедитесь, что он не поврежден.

1. На компьютере, на который был скачан файл, откройте командное окно с правами администратора.
2. Выполните следующую команду, чтобы создать хэш OVA-файла.
    - ```C:\>CertUtil -HashFile <file_location> [Hashing Algorithm]```
    - Пример использования: ```C:\>CertUtil -HashFile C:\AzureMigrate\AzureMigrate.ova SHA256```
3. Созданный хэш должен соответствовать этим параметрам.
    
    Для OVA-файла версии 1.0.8.38
    **Алгоритм** | **Значение хэша**
    --- | ---
    MD5 | dd27dd6ace28f9195a2b5d52a4003067 
    SHA1 | d2349e06a5d4693fc2a1c0619591b9e45c36d695
    SHA256 | 1492a0c6d6ef76e79269d5cd6f6a22f336341e1accbc9e3dfa5dad3049be6798

    Для OVA-файла версии 1.0.8.40
    **Алгоритм** | **Значение хэша**
    --- | ---
    MD5 | afbae5a2e7142829659c21fd8a9def3f
    SHA1 | 1751849c1d709cdaef0b02a7350834a754b0e71d
    SHA256 | d093a940aebf6afdc6f616626049e97b1f9f70742a094511277c5f59eacc41ad

## <a name="create-the-collector-vm"></a>Создание виртуальной машины сборщика

Импортируйте скачанный файл на сервер vCenter Server.

1. В консоли клиента vSphere щелкните **File** (Файл)  >  **Deploy OVF Template** (Развернуть шаблон OVF).

    ![Развертывание шаблона OVF](./media/tutorial-assessment-vmware/vcenter-wizard.png)

2. В мастере развертывания шаблона OVF выберите **Source** (Источник) и укажите расположение OVA-файла.
3. В полях**Name** (Имя) и **Location** (Расположение) укажите понятное имя виртуальной машины сборщика и объект инвентаризации, в котором будет размещена эта виртуальная машина.
5. В поле **Host/Cluster** (Узел или кластер) укажите узел или кластер, в котором будет выполняться виртуальная машина сборщика.
7. В поле "Storage" (Хранилище) укажите место хранения данных виртуальной машины сборщика.
8. В поле **Disk Format** (Формат диска) укажите тип и размер диска.
9. В поле **Network Mapping** (Сетевое сопоставление) укажите сеть, к которой будет подключена виртуальная машина сборщика. Этой сети требуется подключение к Интернету для отправки метаданных в Azure. 
10. Просмотрите и подтвердите параметры, а затем нажмите кнопку **Finish** (Готово).

## <a name="run-the-collector-to-discover-vms"></a>Запуск сборщика для обнаружения виртуальных машин

1. В консоли клиента vSphere щелкните правой кнопкой мыши виртуальную машину и выберите **Open Console** (Открыть консоль).
2. Укажите язык, часовой пояс и параметры пароля для модуля.
3. На рабочем столе щелкните ярлык **Run collector** (Запустить сборщик).
4. В сборщике службы "Миграция Azure" откройте раздел **Set Up Prerequisites** (Настройка предварительных требований).
    - Примите условия лицензии и прочитайте информацию от сторонних производителей.
    - Сборщик проверит наличие доступа к Интернету у виртуальной машины.
    - Если виртуальная машина подключена к Интернету через прокси-сервер, щелкните **Proxy settings** (Параметры прокси-сервера) и укажите адрес и порт прослушивания прокси-сервера. Укажите учетные данные, если для прокси-сервера требуется аутентификация.
    - Сборщик проверит, запущена ли служба профилировщика Windows. Эта служба устанавливается по умолчанию на виртуальной машине сборщика.
    - Скачайте и установите VMware vSphere PowerCLI.
. В окне **Обнаружение компьютеров** выполните следующие действия.
    - Укажите полное доменное имя или IP-адрес сервера vCenter Server.
    - В полях **Имя пользователя** и **Пароль** укажите данные учетной записи только для чтения, которую сборщик будет использовать для обнаружения виртуальных машин на сервере vCenter Server.
    - В поле **Область сбора данных** выберите область обнаружения виртуальных машин. Сборщик может обнаруживать только виртуальные машины в указанной области. Областью может быть определенная папка, центр обработки данных или кластер. Она не должна содержать более 1000 виртуальных машин. 
    - Для параметра **Tag category for grouping** (Категория тегов для группирования) выберите **Нет**.
1. В поле **Выбор проекта** укажите идентификатор и ключ проекта службы "Миграция Azure", скопированные на портале. Если вы не скопировали их, откройте портал Azure на виртуальной машине сборщика. На странице **Обзор** проекта щелкните **Обнаружение компьютеров** и скопируйте соответствующие значения.  
2. В окне **Complete Discovery** (Завершение обнаружения) наблюдайте процесс обнаружения и убедитесь, что метаданные собираются из виртуальных машин в области обнаружения. Сборщик предоставляет приблизительное время завершения обнаружения.

> [!NOTE]
> Сборщик поддерживает только "Английский (США)" в качестве языка операционной системы и языка интерфейса сборщика. Поддержка дополнительных языков будет реализована в ближайшее время.


### <a name="verify-vms-in-the-portal"></a>Проверка виртуальных машин на портале

Длительность обнаружения зависит от количества виртуальных машин, обнаружение которых выполняется. Обычно для 100 виртуальных машин после завершения работы сборщика обнаружение занимает примерно час. 

1. В проекте службы "Миграция Azure" щелкните **Управление** > **Компьютеры**.
2. Проверьте, появились ли на портале виртуальные машины, которые нужно было обнаружить.


## <a name="create-and-view-an-assessment"></a>Создание и просмотр оценки

После обнаружения виртуальных машин их можно сгруппировать и создать оценку. 

1. На странице **Обзор** проекта щелкните **+Создать оценку**.
2. Щелкните **Просмотреть все**, чтобы просмотреть параметры оценки.
3. Создайте группу и укажите ее имя.
4. Выберите компьютеры, которые необходимо добавить в группу.
5. Щелкните **Создать оценку**, чтобы создать группу и оценку.
6. После создания оценки просмотрите ее, выбрав **Обзор** > **Панель мониторинга**.
7. Щелкните **Экспорт оценки**, чтобы скачать оценку в виде файла Excel.

### <a name="sample-assessment"></a>Пример оценки

Ниже приведен пример отчета об оценке. Он содержит сведения о совместимости виртуальных машин с Azure и предполагаемых ежемесячных затратах. 

![Отчет об оценке](./media/tutorial-assessment-vmware/assessment-report.png)

#### <a name="azure-readiness"></a>Готовность к работе в Azure

Это представление отображает состояние готовности каждого компьютера.

- Для виртуальных машин, которые готовы к миграции, служба "Миграция Azure" рекомендует размер виртуальной машины в Azure.
- Для виртуальных машин, которые не готовы к миграции, служба "Миграция Azure" указывает причины и инструкции по их устранению.
- Служба "Миграция Azure" предлагает инструменты, которые можно использовать для миграции. Если компьютер подходит для миграции "lift-and-shift", рекомендуется использовать службу Azure Site Recovery. Если это компьютер базы данных, рекомендуется использовать Azure Database Migration Service.

  ![Оценка готовности](./media/tutorial-assessment-vmware/assessment-suitability.png)  

#### <a name="monthly-cost-estimate"></a>Примерная стоимость в месяц

В этом представлении отображаются затраты на вычисления и хранилище для каждого компьютера. Примерная стоимость вычисляются с помощью рекомендованного на основе производительности размера компьютера и ее дисков, а также свойств оценки.

Примерная ежемесячная стоимость вычислений и хранилища суммируется для всех виртуальных машин в группе. Можно щелкнуть каждый компьютер, чтобы отобразить более подробные сведения. 

![Оценка стоимости виртуальной машины](./media/tutorial-assessment-vmware/assessment-vm-cost.png) 

Вы можете выполнить детализацию до стоимости определенного компьютера.

![Оценка стоимости виртуальной машины](./media/tutorial-assessment-vmware/assessment-vm-drill.png) 

## <a name="next-steps"></a>Дальнейшие действия

- [Узнайте](how-to-scale-assessment.md), как настроить оценку большого количества локальных компьютеров.
- Узнайте, как создать более точные группы, используя [сопоставление зависимостей компьютеров](how-to-create-group-machine-dependencies.md).
- [Узнайте больше](concepts-assessment-calculation.md) о вычислении оценок.
