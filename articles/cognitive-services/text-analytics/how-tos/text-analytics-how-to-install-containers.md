---
title: Установка и запуск контейнеров
titleSuffix: Text Analytics -  Azure Cognitive Services
description: В этом пошаговом руководстве показано, как скачивать, устанавливать и выполнять контейнеры для Анализа текста.
services: cognitive-services
author: diberry
manager: cgronlun
ms.custom: seodec18
ms.service: cognitive-services
ms.component: text-analytics
ms.topic: article
ms.date: 11/14/2018
ms.author: diberry
ms.openlocfilehash: 11798c3bfd4032ad10c738032a816a2a0488ce67
ms.sourcegitcommit: 9fb6f44dbdaf9002ac4f411781bf1bd25c191e26
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2018
ms.locfileid: "53090539"
---
# <a name="install-and-run-containers"></a>Установка и запуск контейнеров

Контейнеризация — это подход к распространению программного обеспечения, в котором приложение или служба входит в состав образа контейнера. Конфигурация и зависимости приложения или службы включены в образ контейнера. Образ контейнера может быть развернут на узле контейнера с незначительной модификацией или без нее. Контейнеры изолированы друг от друга и от базовой операционной системы. При этом они расходуют меньше ресурсов, чем виртуальная машина. Контейнеры для краткосрочных задач можно создавать из образов контейнеров и удалять их, когда они станут ненужными.

Анализ текста предоставляет следующий набор контейнеров Docker, каждый из которых содержит подмножество функций:

| Контейнер| ОПИСАНИЕ |
|----------|-------------|
|Извлечение ключевой фразы | Извлекает ключевые фразы для определения основных идей текста. Например, для входного текста "Еда была вкусной и персонал был замечательным" API вернет основные тезисы в записи: "еда" и "замечательный персонал". |
|Распознавание языка | Обнаруживает и сообщает, на каком языке написан входной текст (поддержка до 120 языков). Контейнер сообщает код одного языка для каждого документа, который включен в запрос. Код языка сопряжен с показателем, указывающим степень оценки. |
|Анализ тональности | Анализирует необработанный текст на предмет положительной или отрицательной тональности. Этот API возвращает оценку тональности (0 или 1) для каждого документа, где 1 означает положительную тональность. Модели анализа предварительно обучены с использованием обширного набора текстов и технологий естественного языка корпорации Майкрософт. Для [выбранных языков](../language-support.md) API может анализировать и оценивать любой необработанный текст, напрямую возвращая результаты вызывающему приложению. |

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="preparation"></a>Подготовка

Прежде чем использовать контейнеры Анализа текста, необходимо выполнить следующие условия:

**Модуль Docker.** Этот модуль нужно установить в локальной среде. Docker предоставляет пакеты для настройки среды с Docker для [macOS](https://docs.docker.com/docker-for-mac/), [Linux](https://docs.docker.com/engine/installation/#supported-platforms) и [Windows](https://docs.docker.com/docker-for-windows/). В Windows Docker должен быть настроен для поддержки контейнеров Linux. Контейнеры Docker также можно развертывать непосредственно в [Службе Azure Kubernetes](/azure/aks/), [Экземплярах контейнеров Azure](/azure/container-instances/) или в кластере [Kubernetes](https://kubernetes.io/), развернутом в [Azure Stack](/azure/azure-stack/). Дополнительные сведения о развертывании Kubernetes в Azure Stack см. в [этой статье](/azure/azure-stack/user/azure-stack-solution-template-kubernetes-deploy).

Docker нужно настроить таким образом, чтобы контейнеры могли подключать и отправлять данные о выставлении счетов в Azure.

**Опыт работы с Реестром контейнеров (Майкрософт) и Docker.** Требуется базовое представление о Реестре контейнеров (Майкрософт) и понятиях Docker, таких как реестры, репозитории, контейнеры и образы контейнеров, а также знание основных команд `docker`.  

Ознакомьтесь с [общими сведениями о Docker и контейнерах](https://docs.docker.com/engine/docker-overview/).

### <a name="container-requirements-and-recommendations"></a>Требования к контейнеру и рекомендации

В следующей таблице описаны минимальные и рекомендуемые требования к ЦП (минимум 2,6 ГГц или быстрее) и памяти, в ГБ, для выделения для каждого контейнера Анализа текста.

| Контейнер | Минимальная | Рекомендуется |
|-----------|---------|-------------|
|Извлечение ключевой фразы | 1 ядро, 2 ГБ памяти | 1 ядро, 4 ГБ памяти |
|Распознавание языка | 1 ядро, 2 ГБ памяти | 1 ядро, 4 ГБ памяти |
|Анализ тональности | 1 ядро, 2 ГБ памяти | 1 ядро, 4 ГБ памяти |

## <a name="download-container-images-from-microsoft-container-registry"></a>Скачивание образов контейнера из Реестра контейнеров Майкрософт

Образы контейнеров для Анализа текста доступны в Реестре контейнеров Майкрософт. В следующей таблице перечислены репозитории, созданные из Реестра контейнеров Майкрософт для контейнеров Анализа текста. Каждый репозиторий содержит образ контейнера, который нужно скачать для локального запуска контейнера.

| Контейнер | Репозиторий |
|-----------|------------|
|Извлечение ключевой фразы | `mcr.microsoft.com/azure-cognitive-services/keyphrase` |
|Распознавание языка | `mcr.microsoft.com/azure-cognitive-services/language` |
|Анализ тональности | `mcr.microsoft.com/azure-cognitive-services/sentiment` |

Используйте команду [docker pull](https://docs.docker.com/engine/reference/commandline/pull/), чтобы скачать образ контейнера из репозитория. Например, чтобы скачать последний образ контейнера извлечения ключевых фраз из репозитория, выполните следующую команду:

```Docker
docker pull mcr.microsoft.com/azure-cognitive-services/keyphrase:latest
```

Полное описание доступных тегов для контейнеров Анализа текста см. в следующих контейнерах в центре Docker:

* [Извлечение ключевых фраз](https://go.microsoft.com/fwlink/?linkid=2018757).
* [Распознавание языка](https://go.microsoft.com/fwlink/?linkid=2018759).
* [Анализ тональности](https://go.microsoft.com/fwlink/?linkid=2018654).

> [!TIP]
> Используйте команду [docker images](https://docs.docker.com/engine/reference/commandline/images/), чтобы перечислить скачанные образы контейнера. Например, следующая команда возвращает таблицу со списком идентификаторов, репозиториев и тегов для каждого скачанного образа контейнера:
>
>  ```Docker
>  docker images --format "table {{.ID}}\t{{.Repository}}\t{{.Tag}}"
>  ```
>

## <a name="instantiate-a-container-from-a-downloaded-container-image"></a>Создание экземпляра контейнера на основе скачанного образа контейнера

Используйте команду [docker run](https://docs.docker.com/engine/reference/commandline/run/), чтобы создать экземпляр контейнера на основе скачанного образа контейнера. Например, следующая команда позволяет выполнить такие задачи:

* Создание экземпляра контейнера из образа контейнера анализа тональности.
* Выделение одного ядра ЦП и 8 гигабайт (ГБ) памяти.
* Предоставление TCP-порта 5000 и выделение псевдотелетайпа для контейнера.
* Автоматическое удаление контейнера после его выхода из системы.

```Docker
docker run --rm -it -p 5000:5000 --memory 8g --cpus 1 mcr.microsoft.com/azure-cognitive-services/sentiment Eula=accept Billing=https://westus.api.cognitive.microsoft.com/text/analytics/v2.0 ApiKey=0123456789

```

> [!IMPORTANT]
> Для создания контейнера необходимо указать параметры командной строки `Eula`, `Billing` и `ApiKey`, в противном случае контейнер не запустится.  Дополнительные сведения см. в [разделе о выставлении счетов](#billing).

После создания экземпляра операции из контейнера можно вызвать с помощью URI узла контейнера. Например, следующий URI узла представляет контейнер анализа тональности, созданный в предыдущем примере:

```http
http://localhost:5000/
```

> [!TIP]
> Вы можете получить доступ к [спецификации OpenAPI](https://swagger.io/docs/specification/about/) (прежнее название — спецификация Swagger), описывающей операции, поддерживаемые контейнером экземпляра относительного URI `/swagger` для этого контейнера. Например, следующий URI представляет доступ к спецификации OpenAPI контейнеру анализа тональности, который создан в предыдущем примере:
>
>  ```http
>  http://localhost:5000/swagger
>  ```

Вы можете либо [вызывать операции REST API](https://docs.microsoft.com/azure/cognitive-services/text-analytics/how-tos/text-analytics-how-to-call-api), доступные в контейнере, либо использовать клиентскую библиотеку [пакета SDK Анализа текста для Azure Cognitive Services](https://www.nuget.org/packages/Microsoft.Azure.CognitiveServices.Language.TextAnalytics) для вызова этих операций.  
> [!IMPORTANT]
> Для использования клиентской библиотеки в контейнере вам нужен пакет SDK Анализа текста для Azure Cognitive Services версии 2.1.0 или более поздней.

Единственное различие между вызовом заданной операции из контейнера и вызовом той же операции из соответствующей службы в Azure — это использование URI узла контейнера, а не узла URI региона Azure для вызова операции. Например, если вы хотите использовать экземпляр Анализа текста, выполняемый в регионе Azure "Западная часть США", необходимо вызывать следующую операцию REST API:

```http
POST https://westus.api.cognitive.microsoft.com/text/analytics/v2.0/keyPhrases
```

Если вы хотите использовать контейнер извлечения ключевых фраз, выполняемый на локальном контейнере с конфигурацией по умолчанию, необходимо вызвать следующую операцию REST API:

```http
POST http://localhost:5000/text/analytics/v2.0/keyPhrases
```

### <a name="billing"></a>Выставление счетов

Контейнеры Анализа текста отправляют информацию о счетах в Azure с помощью соответствующего ресурса Анализа текста в учетной записи Azure. Следующие параметры командной строки используются контейнерами Анализа текста в целях выставления счетов:

| Параметр | ОПИСАНИЕ |
|--------|-------------|
| `ApiKey` | Ключ API ресурса Анализа текста используется для отслеживания информации о выставлении счетов.<br/>Значение этого параметра должно быть присвоено ключу API для подготовленного ресурса Анализа текста Azure, определенного в `Billing`. |
| `Billing` | Конечная точка ресурса Анализа текста используется для отслеживания информации о выставлении счетов.<br/>Значение этого параметра должно быть присвоено конечной точке URI для подготовленного ресурса Анализа текста Azure.|
| `Eula` | Указывает, что вы приняли условия лицензии для контейнера.<br/>Для этого параметра следует задать значение `accept`. |

> [!IMPORTANT]
> Для всех трех параметров необходимо задать допустимые значения. В противном случае контейнер не запустится.

Дополнительные сведения об этих параметрах см. в статье [Настройка контейнеров](../text-analytics-resource-container-config.md).

## <a name="summary"></a>Сводка

В этой статье вы узнали основные понятия и рабочий процесс для скачивания, установки и выполнения контейнеров Анализа текста. В разделе "Сводка" сделайте следующее.

* Анализ текста предоставляет три контейнера Linux для Docker, инкапсулируя извлечение ключевых фраз, определение языка и анализ тональности.
* Образы контейнеров скачиваются из Реестра контейнеров (Майкрософт) в Azure.
* Образы контейнеров выполняются в Docker.
* Указав узел URI контейнера, пакет SDK или REST API можно использовать для вызова операций в контейнерах Анализа текста.
* При создании экземпляра контейнера нужно указать данные для выставления счетов.

> [!IMPORTANT]
> Контейнеры Cognitive Services не лицензируются для запуска без подключения к Azure для отслеживания использования. Клиенты должны разрешить контейнерам непрерывную передачу данных для выставления счетов в службу контроля потребления. Контейнеры Cognitive Services не отправляют в корпорацию Майкрософт данные клиента (например, анализируемые изображения или тексты).

## <a name="next-steps"></a>Дополнительная информация

* Ознакомьтесь со статьей о [конфигурации контейнеров](../text-analytics-resource-container-config.md).
* Чтобы узнать об обнаружении ключевых фраз, обнаружении языка и анализе тональности, ознакомьтесь со [статьей об анализе текста](../overview.md).  
* Дополнительные сведения о методах, поддерживаемых контейнером, см. в статье [об API анализа текста](//westus.dev.cognitive.microsoft.com/docs/services/TextAnalytics.V2.0/operations/56f30ceeeda5650db055a3c6).
* Чтобы разрешать проблемы, связанные с функциональностью Компьютерного зрения, ознакомьтесь с [часто задаваемыми вопросами](../text-analytics-resource-faq.md).