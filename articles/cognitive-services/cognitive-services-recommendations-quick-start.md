<properties
	pageTitle="Краткое руководство: API рекомендаций для машинного обучения | Microsoft Azure"
	description="Рекомендации по Машинному обучению Azure. Краткое руководство по началу работы"
	services="cognitive-services"
	documentationCenter=""
	authors="luiscabrer"
	manager="jhubbard"
	editor="cgronlun"/>

<tags
	ms.service="cognitive-services"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="08/22/2016"
	ms.author="luisca"/>

# Краткое руководство по API рекомендаций Cognitive Services

В этом документе описывается адаптация службы или приложения для использования [API рекомендаций](http://go.microsoft.com/fwlink/?LinkId=759710). Дополнительную информацию об API рекомендаций и других службах Cognitive Services можно найти [здесь](http://go.microsoft.com/fwlink/?LinkId=759709). В этом руководстве можно также найти полезный [справочник по API рекомендаций](http://go.microsoft.com/fwlink/?LinkId=759348).


<a name="Overview"></a>
## Общая информация

Этот документ содержит пошаговое руководство. Мы покажем, какие шаги нужно выполнить, чтобы обучить модель, и расскажем вам о ресурсах, с помощью которых вы сможете использовать модель из рабочей среды.

Это упражнение займет около 30 минут.

Для использования [API рекомендаций](http://go.microsoft.com/fwlink/?LinkId=759710) необходимо сделать следующее.

1. Создать модель. Модель — это контейнер с данными об использовании, данными каталога и моделью рекомендаций.
1. Импортировать данные каталога. Каталог содержит метаданные элементов.
1. Импортировать данные об использовании. Данные об использовании можно загрузить двумя способами:
  -  путем загрузки файла, содержащего данные об использовании;
  -  путем отправки событий получения данных. Обычно загружают файл с данными об использовании, чтобы создать исходную модель рекомендаций (программу начальной загрузки) и использовать ее, пока система не соберет достаточно данных с помощью формата сбора данных.
1. Построить модель рекомендаций. Это асинхронная операция, при которой система рекомендаций принимает все данные об использовании и создает модель рекомендаций. Эта операция может занять несколько минут или часов в зависимости от размера данных и параметров конфигурации построения. При запуске сборки вы получите ее идентификатор. Используйте его для проверки завершения процесса сборки, прежде чем начать использовать рекомендации.
1. Получить рекомендации. Получите рекомендации для определенного элемента или списка элементов.

<a name="GetStarted"></a>
### Приступим к работе!

Вы начнете построение модели рекомендаций. Затем мы расскажем, как использовать результаты, сформированные моделью, чтобы использовать рекомендации на сайте электронной коммерции.

<a name="Ex1Task1"></a>
#### Задача 1. Регистрация для использования API рекомендаций ####

На этом этапе вы зарегистрируетесь для использования службы API рекомендаций и создадите модель рекомендаций.

1. Перейдите на **портал Azure** по адресу [http://portal.azure.com/](http://portal.azure.com/) и выполните вход со своей учетной записью Azure.

1.  Щелкните **+ Создать**.

1. Выберите параметр **Аналитика**.

1. Выберите продукт **Cognitive Services APIs**. Этот продукт дает возможность запустить подписку с любым API служб Cognitive Services (для распознавания лиц, анализа текста, компьютерного зрения и т. д.). Сегодня мы уделим внимание API рекомендаций.

1. На целевой странице API Cognitive Services введите **имя учетной записи** для своей подписки на рекомендации. Пример: MyRecommendations. В этом имени не должно быть пробелов.

1. Для параметра **Тип API** выберите **Рекомендации**.

1. Выберите план для параметра **Ценовая категория**. Вы можете выбрать уровень **Бесплатный** с 10 000 транзакций в месяц. Это бесплатный план, хорошо подходящий для того, чтобы ознакомиться с системой. Как только вы перейдете к рабочей среде, мы рекомендуем запросить дополнительный объем и соответствующим образом изменить тип плана. (Примечание. Одновременно можно использовать только одну подписку уровня "Бесплатный".)

1. Выберите **группу ресурсов** или создайте новую, если ее у вас нет.

1. В диалоговом окне "Создание" можно изменить другие элементы. Следует отметить, что сейчас поддерживается только поставщик ресурсов из центров обработки данных в США.

1. Завершив выбор параметров, нажмите кнопку **Создать**.

1. Подождите несколько минут, пока ресурс не будет развернут. После развертывания вы можете перейти к разделу **Ключи** на колонке **Параметры**, где вам будут предоставлены первичный и вторичный ключи для API. Скопируйте первичный ключ, так как он потребуется при создании первой модели.

<a name="Ex1Task2"></a>
#### Задача 2. А вы взяли свои данные? ####

API рекомендаций будет обучаться с помощью вашего каталога и операций, чтобы предоставлять подходящие рекомендации по продуктам. Это означает, что его необходимо снабдить качественными данными о продуктах (мы называем их файлом **каталога**) и набором транзакций, достаточным для того, чтобы найти интересующие модели потребления (мы называем их **данными об использовании**).

1. Обычно эта информация запрашивается из базы данных транзакций. На случай, если у вас нет их под рукой, мы предоставили примеры данных, полученных на основе данных транзакций Microsoft Store.

 Скачать эти данные можно [отсюда](http://aka.ms/RecoSampleData). Скопируйте и распакуйте файл MsStoreData.Zip в папку на локальном компьютере.

 > **Примечание.** Пример кода, который вы скачаете и выполните для задачи 3, уже содержит встроенные примеры данных, поэтому эта операция не обязательна. С другой стороны, эта задача позволит скачать более реалистичные наборы данных и даст возможность лучше понять, какие входные данные используются для API рекомендаций.

1.	Теперь рассмотрим файл каталога. Перейдите к расположению, в которое были скопированы данные. Откройте файл каталога в **Блокноте**.

 Вы обратите внимание, что файл каталога довольно прост. В нем используется следующий формат: `<itemid>,<item name>,<product category>`.

 >  AAA-04294,OfficeLangPack 2013 32/64 E34 Online DwnLd,Office <br> AAA-04303,OfficeLangPack 2013 32/64 ET Online DwnLd,Office <br> C9F-00168,KRUSELL Kiruna Flip Cover for Nokia Lumia 635 - Camel,Accessories

 Следует отметить, что файл каталога может быть намного содержательнее. Например, в него можно добавить метаданные о продуктах (мы называем их *признаками элементов*). Дополнительные сведения см. в разделе о [формате каталога](http://go.microsoft.com/fwlink/?LinkID=760716) в справочнике по API.

1. Сделаем то же самое с данными об использовании. Вы заметите, что данные об использовании имеют формат `<User Id>,<Item Id>,<Time Stamp>,<Event>`.

  > 00037FFEA61FCA16,288186200,2015/08/04T11:02:52,Purchase 0003BFFDD4C2148C,297833400,2015/08/04T11:02:50,Purchase 0003BFFDD4C2118D,297833300,2015/08/04T11:02:40,Purchase 00030000D16C4237,297833300,2015/08/04T11:02:37,Purchase 0003BFFDD4C20B63,297833400,2015/08/04T11:02:12,Purchase 00037FFEC8567FB8,297833400,2015/08/04T11:02:04,Purchase

Обратите внимание на то, что первые три элемента являются обязательными. Тип события указывать необязательно. Чтобы больше узнать об этой теме, вы можете ознакомиться с [форматом данных об использовании](http://go.microsoft.com/fwlink/?LinkID=760712).

 > **Сколько данных требуется?**
 <p>
 На самом деле это зависит от самих данных об использовании. Система изучает, когда пользователи покупают различные элементы. Для некоторых сборок, например FBT, важно знать, какие элементы были приобретены в одной транзакции. (Мы называем это *сочетаемостью*.) Хорошее проверенное правило — иметь по 20 или больше транзакций для большинства элементов, то есть при наличии 10 000 элементов в каталоге рекомендуется иметь по крайней мере в 20 раз больше транзакций, а это около 200 000. Опять же, это проверенное правило. Вам нужно будет поэкспериментировать с данными.
</p>

<a name="Ex1Task3"></a>
#### Задача 3. Создание модели рекомендаций ####

Теперь, имея учетную запись и данные, давайте создадим первую модель.

В этой задаче для создания первой модели используется пример приложения.

1. Прежде всего следует изучить [справочник по API рекомендаций](http://go.microsoft.com/fwlink/?LinkId=759348).

1. Скачайте [пример приложения](http://go.microsoft.com/fwlink/?LinkID=759344) в локальную папку.

1. Откройте в Visual Studio решение **RecommendationsSample.sln**, расположенное в папке **C#**.

1. Откройте файл **SampleApp.cs**. Обратите внимание на следующие шаги в файле:
 + Создание модели
 + добавление файла каталога;
 + удаление файла использования;
 + активация выполнения сборки модели;
 + получение рекомендаций по паре элементов.
<p></p>

1. Замените значение поля **AccountKey** ключом из задачи 1.

1. Выполните шаги по настройке решения, и вы увидите, как создается модель.

1. Попробуйте заменить файл каталога и файл использования, которые вы только что скачали, чтобы создать новую модель для Microsoft Store или для рекомендаций по книгам. Потребуется также изменить имя модели и элементы, для которых запрашиваются рекомендации.

1. После создания модели запишите **идентификатор модели**. Он понадобится при запросе рекомендаций в рабочей среде.

>  Узнать больше о типах сборки и оценке качества сборки можно [здесь](cognitive-services-recommendations-buildtypes.md).

<a name="Ex1Task4"></a>
### Перенос модели в рабочую среду ###

Теперь вы знаете, как создать модель и использовать рекомендации. Следующим шагом будет ее реализация в рабочей среде на веб-сайте или в мобильном приложении либо интеграция в систему CRM или ERP. Очевидно, что каждая из этих реализаций будет отличаться. Так как API рекомендаций запрашивается как веб-служба, вы легко сможете вызывать его из любой из этих сред.

**Важно.** Если вы хотите показывать рекомендации из общедоступного клиента (например, сайта электронной коммерции), следует создать прокси-сервер для предоставления рекомендаций. Важно, чтобы ваш ключ API не был представлен внешним сущностям (которые потенциально небезопасны).

Вот несколько идей о расположениях, в которых можно использовать рекомендации.

### Страница продукта

**Рекомендации по элементам**
<p>Если модель была обучена на данных покупок, она позволит вашему клиенту *обнаружить продукты, которые могут заинтересовать людей, купивших исходный элемент*.</p>
<p>Если модель была обучена на данных щелчков, она позволит вашему клиенту *обнаружить продукты, которые могут быть просмотрены людьми, купившими исходный элемент*. Такой тип модели может возвращать схожие элементы.</p>

**Рекомендации "Часто покупают вместе"**
<p>Сборку "Часто покупают вместе" можно обучить, получив наборы элементов, которые могут быть приобретены вместе с данным элементом.</p>

### Страница оформления заказа

**Рекомендации по элементам**
<p>Модель рекомендаций в качестве входных данных может принимать список элементов. Поэтому можно передать все элементы в корзине в качестве входных данных, чтобы получить рекомендации. В этом случае модель предоставит рекомендации, которые представляют интерес с учетом всех элементов в корзине.
</p>

### Целевая страница

**Рекомендации пользователей**
<p>
Модель рекомендаций в качестве входных данных может принимать идентификатор пользователя. Это позволит использовать журнал транзакций данного пользователя, чтобы предоставить персонализированные рекомендации указанному пользователю.
</p>

Ознакомьтесь с [документацией о получении рекомендаций по элементам](http://go.microsoft.com/fwlink/?LinkID=760719).

<a name="Ex1Task6"></a>
### Что дальше?
Поздравляем, если вы добрались досюда! Чтобы узнать больше, ознакомьтесь с полным [справочником по API рекомендаций](http://go.microsoft.com/fwlink/?LinkId=759348). Если у вас возникли вопросы, обращайтесь к нам по адресу mlapi@microsoft.com.

<!---HONumber=AcomDC_0928_2016-->