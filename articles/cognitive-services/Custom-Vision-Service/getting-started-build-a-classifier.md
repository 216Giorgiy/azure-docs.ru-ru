---
title: Создание классификатора в Пользовательской службе визуального распознавания
titlesuffix: Azure Cognitive Services
description: Узнайте, как создать модель классификации изображений на веб-сайте Пользовательской службы визуального распознавания.
services: cognitive-services
author: anrothMSFT
manager: nitinme
ms.service: cognitive-services
ms.subservice: custom-vision
ms.topic: conceptual
ms.date: 01/10/2019
ms.author: anroth
ms.openlocfilehash: d91d62c387fc7bcaef8b7f2cb7e8d865c882aeed
ms.sourcegitcommit: 6cab3c44aaccbcc86ed5a2011761fa52aa5ee5fa
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/20/2019
ms.locfileid: "56445463"
---
# <a name="how-to-build-a-classifier-with-custom-vision"></a>Как создать классификатор с помощью Пользовательской службы визуального распознавания

Чтобы применить Пользовательскую службу визуального распознавания для классификации изображений, необходимо создать модель классификатора. В этом руководстве описано, как разработать классификатор на веб-сайте Пользовательской службы визуального распознавания.

## <a name="prerequisites"></a>Предварительные требования

- Действующая подписка Azure. [Создайте учетную запись](https://azure.microsoft.com/free/) бесплатно.
- Набор изображений для обучения классификатора. Ниже приведены советы по выбору изображений.


## <a name="create-custom-vision-resources-in-the-azure-portal"></a>Создание ресурсов Пользовательского визуального распознавания на портале Azure
С помощью службы Пользовательского визуального распознавания вам необходимо создать ресурсы обучения и прогнозирования этой службы на [портале Azure](https://portal.azure.com/?microsoft_azure_marketplace_ItemHideKey=microsoft_azure_cognitiveservices_customvision#create/Microsoft.CognitiveServicesCustomVision). Благодаря этому будет создан ресурс обучения и прогнозирования. 

## <a name="create-a-new-project"></a>Создание нового проекта

В веб-браузере перейдите на [веб-страницу Пользовательской службы визуального распознавания](https://customvision.ai) и щелкните __Sign in__ (Вход). Войдите с помощью той же учетной записи, что и на портале Azure.

![Изображение страницы входа](./media/browser-home.png)


1. Для создания первого проекта щелкните **Новый проект**. Появится диалоговое окно **Create new project** (Создание проекта).

    ![В диалоговом окне нового проекта есть поля для имени, описания и доменов.](./media/getting-started-build-a-classifier/new-project.png)

1. Введите имя и описание проекта. Затем выберите группу ресурсов. Если учетная запись, с которой вы вошли в систему, связана с учетной записью Azure, в раскрывающемся списка Resource Group (Группа ресурсов) будут отображаться все группы ресурсов Azure, в которых есть ресурс Пользовательской службы визуального распознавания. 

> [!NOTE]
> Если группы ресурсов не доступны, подтвердите, что вы вошли в [customvision.ai](https://customvision.ai) с помощью той же учетной записи, что использовалась для входа на [портал Azure](https://portal.azure.com/). Кроме того, убедитесь, что вы выбрали тот же "Каталог" на портале Пользовательского визуального распознавания, что и каталог на портале Azure, где расположены ваши ресурсы Пользовательского визуального распознавания. На обоих сайтах вы можете выбрать свой каталог из раскрывающегося списка меню учетной записи в правом верхнем углу экрана. 

1. Выберите __Classification__ (Классификация) в поле __Project Types__ (Типы проектов). Затем в разделе __Classification Types__ (Типы классификации) выберите вариант **Multilabel** (По нескольким меткам) или **Multiclass** (По нескольким классам) в зависимости от ситуации. Классификация по нескольким меткам применяет к изображению любое количество (нуль или более) указанных вами тегов, а классификация по нескольким классам относит каждое изображение к конкретной категории (каждому изображению присваивается один наиболее вероятный тег). Если потребуется, вы сможете изменить этот тип классификации позднее.

1. Затем выберите один из доступных доменов. Каждый домен оптимизирует классификатор для определенных типов изображений, как описано в следующей таблице. Если потребуется, вы сможете изменить этот домен позднее.

    |Домен|Назначение|
    |---|---|
    |__Общие вопросы__| Рассчитан на самые разные задачи классификации изображений. Если не подходит ни один из других доменов или вы не уверены, какой домен выбрать, выбирайте Generic. |
    |__Food__|Рассчитан для фотографий блюд, которые будут отображаться в меню ресторана. Если вы хотите классифицировать фотографии отдельных фруктов или овощей, используйте домен Food.|
    |__Landmarks__|Рассчитан на распознавание естественных и искусственных ориентиров. Этот домен работает лучше всего, когда ориентир четко виден на фотографии. Этот домен работает, даже если ориентир немного заслоняют люди.|
    |__Retail__|Рассчитан на изображения из каталогов товаров и торговых веб-сайтов. Если требуется высокая точность при распознавании таких объектов, как платья, брюки и рубашки, следует использовать этот домен.|
    |__Adult__|Рассчитан на определение материалов для взрослых. Например, если вы хотите блокировать изображения людей в купальниках, этот домен дает возможность создать соответствующий пользовательский классификатор.|
    |__Домены Compact__| Оптимизированы для ограничений классификации в режиме реального времени на мобильных устройствах. Модели, созданные доменами Compact, можно экспортировать для локального запуска.|
    
1. И наконец, щелкните __Create project__ (Создать проект).

## <a name="choose-training-images"></a>Выбор обучающих изображений

Мы рекомендуем включить в начальный обучающий набор не менее 30 изображений для каждого тега. Также вам потребуются несколько дополнительных изображений для тестирования обученной модели.

Чтобы обучение модели было эффективным, используйте разнообразные изображения. Изображения должны отличаться по следующим аспектам:
* угол обзора камеры;
* освещение;
* background
* стиль изображения;
* отдельные объекты и группы;
* size
* Тип

Также убедитесь, что все обучающие изображения соответствуют следующим критериям:
* файлы с расширением .jpg, .png или .bmp;
* размер не более 6 МБ (4 МБ для прогнозирования изображений);
* не менее 256 пикселей по короткой стороне (Пользовательская служба визуального распознавания автоматически увеличивает изображения меньшего размера).

## <a name="upload-and-tag-images"></a>Отправка и снабжение тегами изображений

В этом разделе вы отправите изображения и вручную добавите к ним теги для обучения классификатора. 

1. Чтобы добавить изображения, нажмите кнопку __Add images__ (Добавить изображения), а затем выберите __Browse local files__ (Обзор локальных файлов). Выберите __Открыть__, чтобы переместить теги. Выбранные теги будут применены ко всей группе изображений, выбранных для отправки. Это означает, что лучше всего разделить изображения на группы по соответствующим тегам. Вы также можете изменить теги для отдельных изображений уже после отправки.

    ![Визуальный элемент для добавления изображений отображается в левом верхнем углу и в виде кнопки по центру снизу.](./media/getting-started-build-a-classifier/add-images01.png)


1. Чтобы создать тег, введите произвольный текст в поле __My Tags__ (Мои теги) и нажмите клавишу ВВОД. Если такой тег уже существует, он появится в раскрывающемся меню. В проекте с классификацией по нескольким меткам вы можете добавить к каждому изображению более одного тега, а в проекте с классификацией по нескольким классам — только один. Чтобы завершить отправку изображений, нажмите кнопку __Upload [number] files__ (Отправить файлы ([число])). 

    ![Изображение тега и страницы передачи](./media/getting-started-build-a-classifier/add-images03.png)

1. После отправки изображений выберите __Готово__.

    ![Индикатор выполнения показывает все выполненные задачи.](./media/getting-started-build-a-classifier/add-images04.png)

Чтобы отправить новый набор изображений, прокрутите страницу наверх и повторите все шаги. Возможно, на каком-то этапе вам потребуется добавить в проект _негативные примеры_, чтобы повысить точность классификатора. Негативным примером называется изображение, которое не соответствует ни одному из тегов. Отправляя такие изображения, примените к ним специальную метку **Negative** (Негативные).

> [!NOTE]
> Пользовательская служба визуального распознавания поддерживает автоматическое применение отрицательных примеров изображений. Например, когда вы компилируете классификатор для различения винограда и банана, то для фотографии ботинка он должен предоставить оценку 0 % по обеим категориям.

> С другой стороны, в тех случаях, когда отрицательные изображения являются лишь вариацией изображений, используемых в обучении, вполне вероятно, что из-за большого сходства модель будет классифицировать отрицательные изображения как отмеченные классы. Например, если классификатору апельсина и грейпфрута предложить для сравнения изображение клементина, он может оценить его как апельсин, потому что многие черты клементина похожи на апельсины. Если отрицательные изображения имеют такую природу, мы рекомендуем создать один или несколько дополнительных тегов (например, **Другие**) и во время обучения пометить ими отрицательные изображения. Такие действия помогут модели лучше различать эти классы.

## <a name="train-the-classifier"></a>Обучение классификатора

Для обучения классификатора нажмите кнопку **Train** (Обучение). Классификатор создаст на основе всех уже полученных изображений модель, которая идентифицирует визуальные характеристики каждого тега.

![Кнопка обучения в правом верхнем углу панели инструментов в заголовке веб-страницы](./media/getting-started-build-a-classifier/train01.png)

Процесс обучения обычно занимает пару минут. В течение этого времени информация о процессе обучения отображается на вкладке **Performance** (Производительность).

![Окно браузера с диалоговым окном в основной части](./media/getting-started-build-a-classifier/train02.png)

## <a name="evaluate-the-classifier"></a>Оценка классификатора

После обучения выполняется оценка производительности модели и отображаются результаты этой оценки. Пользовательская служба визуального распознавания вычисляет точность и полноту классификации по изображениям, отправленным для обучения, используя [перекрестную проверку k сверток](https://en.wikipedia.org/wiki/Cross-validation_(statistics)). Точность и полнота — это разные характеристики эффективности классификатора.

- **Точность** обозначает долю правильно определенных классов. Например, если модель определила наличие собак на 100 изображениях, из которых на 99 действительно есть собаки, точность этой модели составляет 99 %.
- **Полнота** обозначает долю правильно определенных фактических классов. Например, если в наборе присутствует 100 изображений яблок, из которых модель правильно определила 80, полнота этой модели составляет 80 %.

![Результаты обучения показывают общую точность и отзыв, а также точность и отзыв для каждого тега в классификаторе.](./media/getting-started-build-a-classifier/train03.png)

### <a name="probability-threshold"></a>Порог вероятности

Обратите внимание на ползунок **Probability Threshold** (Порог вероятности) на левой панели вкладки **Performance** (Производительность). Это пороговое значение, начиная с которого прогнозируемая вероятность считается достоверной при оценке точности и полноты.

Интерпретация вызовов прогнозирования с высоким пороговым значением обычно дает хорошую точность в ущерб полноте (классификация выполняется правильно, но многие классы не определяются). Низкое значение порога вероятности действует обратным образом (будут найдены почти все классов, но с большим количеством ложно положительных вхождений). Учитывайте это при настройке порога вероятности в соответствии с потребностями для конкретного проекта. Позже вам нужно будет настроить это же значение порога вероятности на стороне клиента, которое будет фильтровать результаты прогнозирования, полученные от этой модели.

## <a name="manage-training-iterations"></a>Управление итерациями обучения

При каждом обучении классификатора создается новая _итерация_ с обновленными метриками производительности. Все выполненные итерации можно просмотреть на панели слева на вкладке **Performance** (Производительность). Выбрав любую из них, вы можете назначить ее _итерацией по умолчанию_, щелкнув вверху кнопку **Make default** (Назначить по умолчанию). Модель _итерации по умолчанию_ будет использоваться для запросов через API прогнозирования (например, из приложения). Отменив обновление _итерации по умолчанию_, вы можете продолжать обучение модели, не влияя на текущее поведение приложения. Позднее, получив удовлетворительные результаты обновленной модели, вы можете обновить итерацию по умолчанию.

Также на панели слева есть кнопка **Delete** (Удалить), которая позволяет удалить устаревшие итерации. При удалении итерации удаляются только связанные с ней изображения.

## <a name="next-steps"></a>Дополнительная информация

В этом руководстве описано, как создать и обучить модель классификации изображений на веб-сайте Пользовательской службы визуального распознавания. См. дополнительные сведения об итеративном процессе улучшения модели.

[Тестирование и переобучение модели с помощью Пользовательской службы визуального распознавания](test-your-model.md)

