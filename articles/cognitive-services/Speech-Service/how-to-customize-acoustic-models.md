---
title: Как создать акустическую модель с помощью службы "Речь" в Microsoft Cognitive Services
description: В этом документе описывается создание акустической модели с помощью службы распознавания речи в Microsoft Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
ms.service: cognitive-services
ms.component: speech-service
ms.topic: tutorial
ms.date: 06/25/2018
ms.author: panosper
ms.openlocfilehash: 7f7e008e8fb999ce28cf515fe9af549c309316d4
ms.sourcegitcommit: 068fc623c1bb7fb767919c4882280cad8bc33e3a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2018
ms.locfileid: "39285182"
---
# <a name="tutorial-create-a-custom-acoustic-model"></a>Учебник. Создание пользовательской акустической модели

Пользовательская акустическая модель полезна в тех случаях, когда ваше приложение разработано для особых условий применения, например в автомобиле, ориентировано на определенные устройства и условия записи либо на конкретную категорию пользователей. В качестве примера можно привести речь с акцентом, наличие фонового шума или использование определенного микрофона для записи.

На этой странице рассматриваются следующие вопросы:
> [!div class="checklist"]
> * Подготовка данных
> * Импорт набора акустических данных
> * Создание пользовательской акустической модели

Если у вас еще нет учетной записи Cognitive Services, создайте [бесплатную учетную запись](https://azure.microsoft.com/try/cognitive-services), а затем приступайте к работе.

## <a name="prerequisites"></a>Предварительные требования

Подключите учетную запись Cognitive Services к подписке. Для этого откройте страницу [подписок Cognitive Services](https://customspeech.ai/Subscriptions).

Также можно подключиться к подписке службы распознавания речи, созданной на портале Azure, нажав кнопку **Connect existing subscription** (Подключиться к имеющейся подписке).

Дополнительные сведения о создании подписок службы распознавания речи на портале Azure см. на странице [Приступая к работе](get-started.md).

## <a name="prepare-the-data"></a>Подготовка данных

Чтобы настроить акустическую модель для определенной области применения, требуется получить данные для распознавания речи. Объем набора данных может варьироваться от нескольких фраз до нескольких сотен часов записанной речи. Эта коллекция состоит из набора звуковых файлов с данными для распознавания речи и текстового файла, который содержит транскрипцию каждого звукового файла. Представленные звуковые данные должны соответствовать сценарию, в котором планируется использовать систему распознавания речи.

Например: 

*   Если вы хотите оптимизировать распознавание речи в шумных производственных условиях, звуковые файлы должны содержать речь людей, записанных на фоне соответствующего шума.
*   Если вы хотите улучшить распознавание речи конкретного человека, например хотите транскрибировать запись цикла передач с одним ведущим, звуковые файлы должны содержать примеры речи только этого человека.

Набор акустических данных для настройки акустической модели состоит из двух частей: (1) набор звуковых файлов, содержащих данные для распознавания речи, и (2) файл с транскрипцией всех звуковых файлов.

### <a name="audio-data-recommendations"></a>Рекомендации по подготовке звуковых данных

*   Все звуковые файлы должны храниться в формате WAV (RIFF).
*   Файл должен иметь частоту дискретизации 8 кГц или 16 кГц. Значения сэмплов должны храниться в формате 16-разрядных целых чисел PCM со знаком без сжатия (короткие).
*   Поддерживаются только одноканальные (монофонические) звуковые файлы.
*   Звуковой файл должен иметь длину от 100 мс до 1 минуты. В идеальном случае в начале и конце каждого звукового файла должен присутствовать период молчания длительностью около 100 мс, а сам файл должен иметь длину от 500 мс до 1 с.
*   Если данные содержат фоновый шум, также рекомендуется добавить в них несколько образцов с более продолжительными фрагментами тишины (например, несколько секунд) до и (или) после речи.
*   Каждый звуковой файл должен содержать одну фразу, например одно предложение из выступления, один вопрос или одно действие диалоговой системы.
*   Каждый звуковой файл в наборе данных должен иметь уникальное имя и расширение WAV.
*   Набор звуковых файлов должен располагаться в одной папке без подкаталогов. Весь набор должен быть упакован в один архивный ZIP-файл.

> [!NOTE]
> Максимальный размер набора акустических данных ограничен 2 ГБ (ограничение на импорт данных через веб-портал). Это соответствует примерно 17 часам звука при частоте дискретизации 16 кГц или 34 часам записи при частоте дискретизации 8 кГц. Основные требования к звуковым данным описываются в следующей таблице.
>

| Свойство | Значение |
|---------- |----------|
| Формат файла | RIFF (WAV) |
| Частота дискретизации | 8000 или 16 000 Гц |
| Каналы | 1 (моно) |
| Формат выборки | PCM, 16-разрядные целые числа |
| Продолжительность файла | От 0,1 с до 60 с |
| Период тишины | >0,1 с |
| Формат архива | ZIP |
| Максимальный размер архива | 2 ГБ |

## <a name="language-support"></a>Поддержка языков

Следующие языки поддерживаются для пользовательских языковых моделей **преобразования речи в текст**.

Щелкните, чтобы просмотреть полный список [поддерживаемых языков](supported-languages.md)

### <a name="transcriptions-for-the-audio-dataset"></a>Транскрипции для набора звуковых данных

Транскрипции всех WAV-файлов должны содержаться в одном текстовом файле. Каждая строка файла транскрипции должна содержать имя звукового файла и соответствующую ему транскрипцию. Для разделения имени файла и транскрипции необходимо использовать символ табуляции (\t).

  Например:
```
  speech01.wav  speech recognition is awesome
  speech02.wav  the quick brown fox jumped all over the place
  speech03.wav  the lazy dog was not amused
```
> [!NOTE]
> Для кодировки транскрипции необходимо использовать метку порядка байтов UTF-8

Текст транскрипции нормализуется для эффективной обработки системой. Однако есть некоторые важные действия нормализации, которые пользователь должен выполнять _перед_ отправкой данных в пользовательскую службу распознавания речи. При подготовке транскрипций следуйте [руководству по транскрибированию](prepare-transcription.md) для соответствующего языка.

Дальнейшие действия выполняются на [портале службы распознавания речи](https://customspeech.ai).

## <a name="import-the-acoustic-data-set"></a>Импорт набора акустических данных

После подготовки звуковых файлов и транскрипций их можно импортировать на веб-портал службы.

Сначала выполните вход на [портал службы распознавания речи](https://customspeech.ai). Затем щелкните вкладку раскрывающегося меню "Настраиваемое распознавание речи" в верхней ленте и выберите "Adaptation Data" (Данные адаптации). Если вы впервые передаете данные в пользовательскую службу распознавания речи, вы увидите пустую таблицу с именем "Наборы данных". 

Нажмите кнопку "Импорт" в строке акустических наборов данных, и на сайте появится страница для отправки нового набора данных.

![попробуйте выполнить следующее](media/stt/speech-acoustic-datasets-import.png)

Введите _имя_ и _описание_ в соответствующие текстовые поля. Для удобства отслеживания передаваемых наборов данных рекомендуется использовать понятное описание. Затем с помощью кнопок "Choose File" (Выбрать файл) в разделах "Transcription File" (Файл транскрипции) и "WAV files" (WAV-файлы) выберите соответственно текстовый файл транскрипции и ZIP-файл архива или отдельные WAV-файлы. После завершения подготовки нажмите кнопку "Import" (Импорт), чтобы отправить данные. Данные будут отправлены на портал. Отправка крупных наборов данных может занимать несколько минут.

После завершения операции импорта вы вернетесь в таблицу наборов акустических данных и увидите запись, соответствующую вашему набору акустических данных. Обратите внимание, что ему был присвоен уникальный идентификатор (GUID). Данные также будут включать статус, отражающий их текущее состояние. Этим состоянием будет "Не начато", если данные ставятся в очередь для обработки, "Идет обработка", если выполняется проверка, и "Выполнено", когда данные можно использовать.

При проверке данных проверяются формат, продолжительность и частота дискретизации звуковых файлов, а также формат файлов транскрипции. Кроме того, для транскрипции выполняются некоторые операции по нормализации текста.

Если набор акустических данных имеет состояние "Успешно", вы можете просмотреть отчет о проверке, нажав кнопку "Сведения". Отобразится количество успешных и неудачных проверок, а также сведения о фразах, завершившихся сбоем. В приведенном ниже примере проверка двух WAV-файлов завершилась сбоем из-за неверного формата звуковых данных (в одном случае неправильная частота дискретизации, а в другом — неправильный формат файла).

![попробуйте выполнить следующее](media/stt/speech-acoustic-datasets-report.png)

Если вам необходимо изменить имя или описание набора данных, щелкните ссылку "Изменить" и внесите соответствующие изменения. Изменять звуковые файлы и транскрипцию нельзя.

## <a name="create-a-custom-acoustic-model"></a>Создание пользовательской акустической модели

Если набор акустических данных имеет состояние "Выполнено", его можно использовать для создания пользовательской акустической модели. Для этого щелкните "Акустические модели" в раскрывающемся меню "Настраиваемое распознавание речи". Появится таблица "Ваши модели" со списком всех пользовательских акустических моделей. При первом запуске эта таблица будет пустой. Текущий языковой стандарт отображается в заголовке таблицы. В настоящее время акустические модели можно создавать только для английского языка (США).

Чтобы создать новую модель, щелкните ссылку "Создать" под заголовком таблицы. Как и ранее, введите имя и описание, чтобы определить эту модель в будущем. Например, в поле "Описание" можно указать, на основе каких модели и набора акустических данных была создана эта модель. Затем в раскрывающемся меню выберите базовую акустическую модель. Базовая модель выступает в качестве отправной точки для настройки. Вы можете выбрать из двух базовых акустических моделей. _Акустическая модель поиска и диктовки Майкрософт_ подходит для речи, направленной в приложение, например команд, поисковых запросов или диктовки. _Разговорная акустическая модель_ Майкрософт подходит для распознавания речи при общении. Этот тип речи обычно направлен на другого человека и встречается в колл-центрах или на встречах. Разговорная модель характеризуется большей задержкой для частичных результатов по сравнению с моделью поиска и диктовки.

> [!NOTE]
> На данный момент ведется подготовка к развертыванию новой универсальной модели, которая будет охватывать оба этих сценария. Вышеупомянутые модели по-прежнему будут находиться в общем доступе.

Далее в раскрывающемся списке выберите акустические данные, на основе которых будет выполняться настройка.

![попробуйте выполнить следующее](media/stt/speech-acoustic-models-create2.png)

После завершения обработки вы можете выбрать тестирование новой модели на точность. В этом случае будет выполнена оценка эффективности преобразования речи в текст для указанного набора акустических данных с использованием пользовательской акустической модели. По результатам оценки будет подготовлен отчет. Чтобы выполнить проверку, установите флажок "Accuracy Testing" (Тестирование на точность). Затем в раскрывающемся меню выберите языковую модель. Если пользовательская языковая модель не была создана, в раскрывающемся списке будут представлены только базовые языковые модели. Для выбора наиболее подходящей базовой языковой модели ознакомьтесь с их [описанием](how-to-customize-language-model.md) в руководстве.

Наконец, выберите набор акустических данных, который вы хотите использовать для оценки пользовательской модели. Если вы выполняете тестирование на точность, важно выбрать набор акустических данных, отличный от использованного при создании модели. Это позволит более реалистично оценить эффективность модели. Если использовать обучающие данные для тестирования на точность, оценка эффективности адаптированной модели в реальных условиях не будет соответствовать действительности. В таком случае результат будет слишком оптимистичным. Обратите внимание, что объем тестирования на точность ограничен 1000 фразами. Если набор акустических данных имеет больший размер, для оценки будут использоваться первые 1000 фраз.

Если все готово к запуску процесса настройки, щелкните "Create" (Создать).

В таблице акустических моделей появится новая запись, соответствующая этой модели. В таблице будет отражено состояние процесса. Возможны состояния "Ожидание", "Идет обработка" и "Выполнено".

![попробуйте выполнить следующее](media/stt/speech-acoustic-models-creating.png)

## <a name="next-steps"></a>Дополнительная информация

- [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/)
- [Распознавание речи в C#](quickstart-csharp-dotnet-windows.md)
- [Образец данных Git](https://github.com/Microsoft/Cognitive-Custom-Speech-Service)
