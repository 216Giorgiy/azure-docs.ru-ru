---
title: Создание языковой модели с помощью службы распознавания речи в Microsoft Cognitive Services | Документы Майкрософт
description: В этом руководстве вы узнаете, как создать языковую модель с помощью службы распознавания речи в Microsoft Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
manager: onano
ms.service: cognitive-services
ms.component: speech-service
ms.topic: tutorial
ms.date: 06/25/2018
ms.author: panosper
ms.openlocfilehash: c608c1b40c7b4cdaedb2b7e7a609ad65c6357584
ms.sourcegitcommit: 756f866be058a8223332d91c86139eb7edea80cc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2018
ms.locfileid: "37344222"
---
# <a name="tutorial-create-a-custom-language-model"></a>Руководство по созданию пользовательской языковой модели

В этом документе вы создадите пользовательскую языковую модель, которую можно использовать в сочетании с имеющимися новейшими моделями речи от Майкрософт, чтобы добавить в приложение голосовое взаимодействие.

В этом документе рассматриваются следующие вопросы:
> [!div class="checklist"]
> * Подготовка данных
> * Импорт набора языковых данных
> * Создание пользовательской языковой модели

Если у вас еще нет учетной записи Cognitive Services, создайте [бесплатную учетную запись](https://azure.microsoft.com/try/cognitive-services/), а затем приступайте к работе.

## <a name="prerequisites"></a>Предварительные требования

Подключите учетную запись Cognitive Services к подписке. Для этого откройте страницу [подписок Cognitive Services](https://customspeech.ai/Subscriptions).

Также можно подключиться к подписке службы распознавания речи, созданной на портале Azure, нажав кнопку **Connect existing subscription** (Подключиться к имеющейся подписке).

Дополнительные сведения о создании подписок службы распознавания речи на портале Azure см. на странице [Приступая к работе](get-started.md).

## <a name="prepare-the-data"></a>Подготовка данных

Чтобы создать пользовательскую языковую модель для приложения, вам необходимо предоставить список примеров фраз для системы, например:

*   "На прошлой неделе у пациента была крапивница".
*   "У пациента был заживший шрам, оставшийся после герниопластической операции".

Предложения необязательно должны быть полными или грамматически правильными, они должны точно отражать произносимые данные, с которыми система может столкнуться при развертывании. Эти примеры должны отражать стиль и содержимое задачи, которую пользователи будут выполнять с помощью приложения.

Данные языковой модели должны описываться с использованием метки порядка байтов UTF-8. Текстовый файл должен содержать один пример (предложение, фразу или запрос) на строку.

Если некоторые термины должны иметь более высокую значимость (вес), можно добавить в данные несколько фраз, содержащих этот термин. 

Основные требования к языковым данным приведены в следующей таблице.

| Свойство | Значение |
|----------|-------|
| Кодировка текста | Метка порядка байтов UTF-8|
| Количество фраз на строку | 1 |
| Максимальный размер файла | 1,5 ГБ |
| Примечания | Избегайте повторения знаков более четырех раз, например "aaaaa"|
| Примечания | Не используйте специальные знаки, такие как "\t" или любой другой знак UTF-8, идущий после U+00A1 в [таблице знаков Юникод](http://www.utf8-chartable.de/)|
| Примечания | Также будут отклонены универсальные коды ресурсов (URI), так как нет уникального способа произнести их|

При импорте текст нормализуется, чтобы система могла его обработать. Однако есть некоторые важные действия нормализации, которые пользователь должен выполнять _перед_ отправкой данных. Ознакомьтесь с [рекомендациями по транскрибированию](prepare-transcription.md), чтобы определить соответствующий формат языка при подготовке языковых данных.

## <a name="language-support"></a>Поддержка языков

Следующие языки поддерживаются для пользовательских языковых моделей **преобразования речи в текст**.

Щелкните, чтобы просмотреть полный список [поддерживаемых языков](supported-languages.md)

## <a name="import-the-language-data-set"></a>Импорт набора языковых данных

Нажмите кнопку "Импорт" в строке языковых наборов данных, и на сайте появится страница для отправки нового набора данных.

Когда вы будете готовы импортировать свой набор языковых данных, войдите на [портал службы распознавания речи](https://customspeech.ai).  Затем щелкните вкладку раскрывающегося меню "Настраиваемое распознавание речи" в верхней ленте и выберите "Adaptation Data" (Данные адаптации). При первой попытке передать данные в службу распознавания речи вы увидите пустую таблицу с именем "Наборы данных".

Чтобы импортировать новый набор данных, нажмите кнопку "Импорт" в строке наборов языковых данных, и на сайте появится страница для отправки нового набора данных. Введите имя и описание, чтобы определить набор данных в будущем, после чего выберите языковой стандарт. Затем нажмите кнопку "Выбрать файл", чтобы найти текстовый файл языковых данных. После этого для передачи набора данных нажмите кнопку "Импорт". В зависимости от размера набора данных импорт может занять несколько минут.

![попробуйте выполнить следующее](media/stt/speech-language-datasets-import.png)

После завершения операции импорта вы вернетесь в таблицу языковых данных и увидите запись, соответствующую вашему набору языковых данных. Обратите внимание, что ему был присвоен уникальный идентификатор (GUID). Данные также будут включать статус, отражающий их текущее состояние. Этим состоянием будет "Ожидание", если данные ставятся в очередь для обработки, "Идет обработка", если выполняется проверка, и "Выполнено", когда данные можно использовать. При проверке данных выполняется ряд проверок текста в файле и некоторая нормализация текста.

Если активно состояние "Выполнено", можно щелкнуть "Просмотр отчета", чтобы просмотреть отчет о проверке языковых данных. Отобразится количество успешных и неудачных проверок, а также сведения о фразах, завершившихся сбоем. В приведенном ниже примере два примера не прошли проверку из-за неправильных знаков (в этом наборе данных в первом примере содержались два символа табуляции, а во втором было несколько знаков за пределами кодировки для печати ASCII и присутствовала пустая третья строка).

![попробуйте выполнить следующее](media/stt/speech-language-datasets-report.png)

Если набор языковых данных имеет состояние "Выполнено", его можно использовать для создания пользовательской языковой модели.

![попробуйте выполнить следующее](media/stt/speech-language-datasets.png)

## <a name="create-a-custom-language-model"></a>Создание пользовательской языковой модели

Когда языковые данные будут готовы, щелкните "Language Models" (Языковые модели) в раскрывающемся меню, чтобы запустить процесс создания пользовательской языковой модели. На этой странице содержится таблица с именем "Language Models" (Языковые модели) с текущими пользовательскими языковыми моделями. Если вы еще не создали ни одной пользовательской языковой модели, таблица будет пуста. Рядом с соответствующей записью данных в таблице отображается текущий языковой стандарт.

Прежде чем выполнять какие-либо действия, необходимо выбрать соответствующий языковой стандарт. Текущий языковой стандарт указывается в заголовке таблицы на всех страницах данных, модели и развертывания. Чтобы изменить языковой стандарт, нажмите кнопку "Change Locale" (Изменить языковой стандарт) под заголовком таблицы. Откроется страница подтверждения языкового стандарта. Нажмите кнопку "ОК", чтобы вернуться к таблице.

На странице создания языковой модели введите имя и описание, чтобы затем отслеживать соответствующую информацию об этой модели, например используемый набор данных. После этого в раскрывающемся меню выберите базовую языковую модель. Эта модель станет отправной точкой настройки. Вы можете выбрать из двух базовых языковых моделей. Модель поиска и диктовки подходит для речи, направленной в приложение, например команд, поисковых запросов или диктовки. Разговорная модель подходит для распознавания речи при общении. Этот тип речи обычно направлен на другого человека и встречается в колл-центрах или на встречах. Также опубликована новая модель "Универсальная". Эта модель ориентирована на все сценарии и в конечном итоге призвана заменить модель поиска и диктовки, а также разговорную модель.

5.  В следующем примере после указания базовой языковой модели в раскрывающемся меню "Language Data" (Языковые данные) выберите набор языковых данных, который вы хотите использовать для настройки.

![попробуйте выполнить следующее](media/stt/speech-language-models-create2.png)

Как и при создании акустической модели, после завершения обработки вы можете выбрать автономное тестирование новой модели. Для оценки модели требуется набор акустических данных.

Чтобы выполнить автономное тестирование языковой модели, установите флажок рядом с параметром "Автономное тестирование". Затем в раскрывающемся меню выберите акустическую модель. Если вы не создали ни одной пользовательской акустической модели, базовая акустическая модель Майкрософт будет единственной моделью в меню. Если вы выбрали базовую разговорную языковую модель, вам нужно использовать акустическую разговорную модель. Если вы используете языковую модель поиска и диктовки, нужно выбрать акустическую модель диктовки.

Наконец, выберите акустический набор данных, который вы хотите использовать для оценки.

Если вы готовы начать обработку, нажмите кнопку "Создать". Откроется таблица языковых моделей. В таблице появится новая запись, соответствующая этой модели. Статус отражает состояние модели и будет изменяться, представляя разные этапы: "Ожидание", "Идет обработка" и "Выполнено".

Когда модель достигнет состояния "Выполнено", ее можно развернуть в конечную точку. Щелкните "Просмотр результата", и появятся результаты автономного тестирования (если оно применялось).

Если на каком-то этапе вы захотите изменить имя или описание модели, щелкните ссылку "Изменить" в соответствующей строке таблицы языковых моделей.

## <a name="next-steps"></a>Дополнительная информация

- [Получение пробной подписки на службу "Речь"](https://azure.microsoft.com/try/cognitive-services/)
- [Распознавание речи в C#](quickstart-csharp-windows.md)
- [Образец данных Git](https://github.com/Microsoft/Cognitive-Custom-Speech-Service)