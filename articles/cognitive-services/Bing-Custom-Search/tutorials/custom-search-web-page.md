---
title: Создание веб-страницы пользовательского поиска в службе "Пользовательский поиск Bing" | Документация Майкрософт
description: В этой статье описано, как настроить экземпляр пользовательского поиска и интегрировать его в веб-страницу.
services: cognitive-services
author: brapel
manager: ehansen
ms.service: cognitive-services
ms.component: bing-custom-search
ms.topic: article
ms.date: 10/16/2017
ms.author: v-brapel
ms.openlocfilehash: c1431ec852cab943e00d3933ef4f0500a4fdb151
ms.sourcegitcommit: 95d9a6acf29405a533db943b1688612980374272
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2018
ms.locfileid: "35381021"
---
# <a name="build-a-custom-search-web-page"></a>Создание веб-страницы пользовательского поиска
Служба "Пользовательский поиск Bing" позволяет создавать специально адаптированные интерфейсы поиска по темам, которые действительно важны для вас. Например, если веб-сайт боевых искусств предоставляет функцию поиска, то вы можете указать домены, веб-сайты и веб-страницы, по которым Bing будет выполнять поиск. Пользователи увидят результаты поиска, адаптированные к интересующей их информации, вместо того, чтобы пролистывать страницы результатов поиска с несоответствующим содержимым. 

В этой руководстве описано, как настроить экземпляр пользовательского поиска и интегрировать его в новую веб-страницу.

Здесь рассматриваются такие задачи:

> [!div class="checklist"]
> - Создание экземпляра пользовательского поиска.
> - Добавление активных записей.
> - Добавление заблокированных записей.
> - Добавление закрепленных записей.
> - Интеграция экземпляра пользовательского поиска в веб-страницу

## <a name="prerequisites"></a>предварительным требованиям
- Чтобы выполнить задания, описанные в этом руководстве, требуется ключ подписки для API пользовательского поиска Bing.  Сведения о получении ключа см. на странице [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/?api=bing-custom-search).
- Если вы еще не установили Visual Studio 2017, вы можете скачать и использовать **бесплатный** [выпуск Community для Visual Studio 2017](https://www.visualstudio.com/downloads/).

## <a name="create-a-custom-search-instance"></a>Создание экземпляра пользовательского поиска
Чтобы создать экземпляр службы "Пользовательский поиск Bing", сделайте следующее:

1.  Откройте браузер.
2.  Перейдите на [портал](https://customsearch.ai) службы пользовательского поиска.
3.  Войдите на портал с помощью учетной записи Майкрософт (MSA). Если у вас нет учетной записи MSA, щелкните **Создайте учетную запись Майкрософт**. Если вы впервые используете портал, появится запрос на разрешение доступа к данным. Щелкните **Да**.
4.  После входа нажмите кнопку **New custom search** (Создать службу пользовательского поиска). В окне **Create a new custom search instance** (Создание экземпляра пользовательского поиска) введите информативное имя, которое описывает тип содержимого, возвращаемого в результатах поиска. Это имя можно изменить в любое время.
 
    ![Снимок экрана: окно Create a new custom search instance (Создание экземпляра пользовательского поиска)](../media/newCustomSrch.png)

5.  Нажмите кнопку "ОК", укажите URL-адрес и следует ли включать вложенные страницы базовой страницы:

    ![Снимок экрана: страница определения URL-адреса](../media/newCustomSrch1-a.png)

## <a name="add-active-entries"></a>Добавление активных записей
Чтобы включать результаты с конкретных сайтов или URL-адресов, добавьте их на вкладке **Активные**.

1.  В **редакторе определений** перейдите на вкладку **Активные** и введите URL-адреса сайтов, которые требуется включить в поиск.

    ![Снимок экрана: вкладка "Активные" в редакторе определений](../media/customSrchEditor.png)

2.  Чтобы проверить, возвращает ли экземпляр результаты, введите запрос в области предварительного просмотра в правой части экрана. Bing возвращает результаты только с общедоступных индексированных этой службой сайтов.

## <a name="add-blocked-entries"></a>Добавление заблокированных записей
Чтобы исключать результаты с конкретных сайтов или URL-адресов, добавьте их на вкладке **Заблокированные**.

1. В **редакторе определений** перейдите на вкладку **Заблокированные** и введите URL-адреса сайтов, которые требуется исключать из поиска.

    ![Снимок экрана: вкладка "Заблокированные" в редакторе определений](../media/blockedCustomSrch.png)


2. Чтобы проверить, не возвращает ли экземпляр результаты из заблокированных сайтов, введите запрос в области предварительного просмотра в правой части экрана. 

## <a name="add-pinned-entries"></a>Добавление закрепленных записей
Чтобы закрепить конкретную веб-страницу в верхней части результатов поиска, добавьте ее и термин запроса на вкладке **Закрепленные**.  Вкладка **Закрепленные** содержит список пар веб-страницы и термина запроса, указывающие веб-страницу, которая отображается в качестве первого результата определенного запроса. Чтобы эта конфигурация работала, термин запроса пользователя должен точно соответствовать закрепленному термину запроса веб-страницы.

1. В **редакторе определений** перейдите на вкладку **Закрепленные**, а затем введите термин запроса и веб-страницу, которая должна возвращаться как первый результат.

    ![Снимок экрана: вкладка "Закрепленные" в редакторе определений](../media/pinnedCustomSrch.png)

2. Чтобы проверить, возвращает ли экземпляр указанную веб-страницу как первый результат, введите запрос в области предварительного просмотра в правой части экрана.

## <a name="configure-hosted-ui"></a>Настройка размещенного пользовательского интерфейса
Служба "Пользовательский поиск" предоставляет размещенный пользовательский интерфейс, который обрабатывает ответ JSON экземпляра пользовательского поиска.  Чтобы определить пользовательский интерфейс, сделайте следующее:

1. Перейдите на вкладку **Hosted UI** (Размещенный пользовательский интерфейс).
2. Выберите макет.

    ![Снимок экрана: выбор макета на вкладке Hosted UI (Размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-select-layout.png)

3. Выберите цветовую тему.

    ![Снимок экрана: выбор макета на вкладке Hosted UI (Размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-select-color-theme.png)

4. Укажите дополнительные параметры конфигурации.

    ![Снимок экрана: дополнительные параметры конфигурации на вкладке Hosted UI (Размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-additional-configurations.png)

5. Вставьте **ключ подписки**. Дополнительные сведения см. на странице [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/?api=bing-custom-search-api).

    ![Снимок экрана: дополнительные параметры конфигурации на вкладке Hosted UI (Размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-subscription-key.png)

[!INCLUDE[publish or revert](../includes/publish-revert.md)]

<a name="consuminghostedui"></a>
## <a name="consuming-hosted-ui"></a>Использование размещенного пользовательского интерфейса
Размещенный пользовательский интерфейс можно использовать двумя способами.  

- Вариант 1. Интеграция предоставленного фрагмента кода JavaScript в приложение.
- Вариант 2. Использование предоставленной конечной точки HTML.

В оставшейся части этого руководства описан **вариант с использованием фрагмента кода JavaScript**.  

## <a name="set-up-your-visual-studio-solution"></a>Настройка решения Visual Studio
1. Откройте **Visual Studio** у себя на компьютере.
2. В меню **Файл** выберите пункт **Создать**, а затем — **Проект**.
3. В окне **Новый проект** выберите **Visual C# / Интернет / Веб-приложение ASP.NET Core**, введите имя проекта, а затем нажмите кнопку **ОК**.
   
    ![Снимок экрана: диалоговое окно "Новый проект"](./media/custom-search-new-project.png)

4. В окне **Веб-приложение ASP.NET Core** выберите **Веб-приложение** и нажмите кнопку **ОК**.
    
    ![Снимок экрана: диалоговое окно "Новый проект"](./media/custom-search-new-webapp.png)

## <a name="edit-indexcshtml"></a>Изменение файла Index.cshtml
1. В **обозревателе решений** разверните узел **Страницы** и дважды щелкните файл **Index.cshtml**, чтобы открыть его.

    ![Снимок экрана: обозреватель решений с развернутым узлом "Страницы" и выбранным файлом Index.cshtml](./media/custom-search-visual-studio-webapp-solution-explorer-index.png)

2. В файле Index.cshtml удалите все, начиная со строки 7.
    
    ``` razor
    @page
    @model IndexModel
    @{
        ViewData["Title"] = "Home page";
    }    
    ```

3. Добавьте элемент разрыва строки и элемент div в качестве контейнера.

    ``` html
    @page
    @model IndexModel
    @{
        ViewData["Title"] = "Home page";
    }
    <br />
    <div id="customSearch"></div>
    ```

4. На вкладке**Hosted UI** (Размещенный пользовательский интерфейс) прокрутите к разделу **Consuming the UI** (Использование пользовательского интерфейса). Скопируйте фрагмент кода JavaScript.

    ![Снимок экрана: кнопка сохранения на вкладке Hosted UI (Размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-consuming-ui.png)

5. Вставьте элемент скрипта в добавленный контейнер.

    ``` html
    @page
    @model IndexModel
    @{
        ViewData["Title"] = "Home page";
    }
    <br />
    <div id="customSearch">
        <script type="text/javascript"
                id="bcs_js_snippet"
                src="https://ui.customsearch.ai/api/ux/render?customConfig=<YOUR-CUSTOM-CONFIG-ID>&market=en-US&safeSearch=Moderate">
        </script>
    </div>
    ```

6. В **обозревателе решений** щелкните правой кнопкой мыши папку **wwwroot** и нажмите кнопку **Просмотреть в браузере**.

    ![Снимок экрана: кнопка "Просмотреть в браузере" в контекстном меню wwwroot обозревателя решений](./media/custom-search-webapp-view-in-browser.png)

Новая веб-страница пользовательского поиска должна выглядеть следующим образом:

![Снимок экрана: веб-страница пользовательского поиска](./media/custom-search-webapp-browse-index.png)

При поиске возвращаются примерно такие результаты:

![Снимок экрана: результаты пользовательского поиска](./media/custom-search-webapp-results.png)

## <a name="next-steps"></a>Дополнительная информация
В этом руководстве вы выполнили следующее:

> [!div class="checklist"]
> - Создали экземпляр пользовательского поиска.
> - Добавили активные записи.
> - Добавили заблокированные записи.
> - Добавили закрепленные записи.
> - Интегрировали экземпляр пользовательского поиска в веб-страницу

Теперь вы можете приступать к вызову конечных точек службы "Пользовательский поиск Bing" программным способом.

> [!div class="nextstepaction"]
> [Вызов конечной точки службы "Пользовательский поиск Bing" (C#)](../call-endpoint-csharp.md)