---
title: Рабочие процессы модерации — Content Moderator
titlesuffix: Azure Cognitive Services
description: Используйте рабочие процессы в операциях заданий API проверки, чтобы автоматизировать пользовательские проверки на основе политик содержимого и порогов.
services: cognitive-services
author: sanjeev3
manager: nitinme
ms.service: cognitive-services
ms.subservice: content-moderator
ms.topic: conceptual
ms.date: 01/10/2019
ms.author: sajagtap
ms.openlocfilehash: 0a13d86afe3d395cb34f592b03c1eb9daa18076b
ms.sourcegitcommit: 7e772d8802f1bc9b5eb20860ae2df96d31908a32
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57454863"
---
# <a name="automate-moderation-reviews-with-workflows"></a>Автоматизация модерации с помощью рабочих процессов

Content Moderator включает в себя инструменты и интерфейсы API для управления рабочими процессами. Рабочие процессы используются в [операциях заданий API проверки](review-api.md) для автоматизации создания пользовательских проверок на основе политик содержимого и порогов.

API проверки предлагает включить человеческий контроль в процесс модерации контента следующими способами.

1. Операции **задания** используются для запуска машинной модерации и создания пользовательской проверки в один этап.
1. Операции **проверки** используются для создания пользовательской проверки после этапа модерации.
1. Операции **рабочего процесса** используются для управления рабочими процессами, автоматизирующими проверку, с пороговыми значениями для создания проверок.

В этой статье рассматриваются операции **Workflow**. Прочитайте обзор [заданий и проверок](review-api.md), чтобы узнать о заданиях модерации контента и проверках.

Ознакомление с рабочим процессом **default** — лучший способ приступить к изучению рабочих процессов в Content Moderator.

## <a name="your-first-workflow"></a>Ваш первый рабочий процесс

Первый рабочий процесс предоставляется вашей [группе в инструменте проверки](https://contentmoderator.cognitive.microsoft.com/). Зарегистрируйтесь, если вы этого еще не сделали.

Перейдите на экран [Workflows](Review-Tool-User-Guide/Workflows.md) (Рабочие процессы) инструмента проверки и выберите вкладку "Settings" (Параметры). Вы увидите рабочий процесс по умолчанию, **default**, как показано на следующем рисунке.

![Рабочие процессы Content Moderator](Review-Tool-User-Guide/images/2-workflows-1.png)

### <a name="open-the-default-workflow"></a>Открытие рабочего процесса по умолчанию

Используйте параметр **edit** (Изменить), чтобы открыть страницу изменения рабочего процесса, как показано на следующем рисунке: ![Рабочий процесс по умолчанию в Content Moderator](images/default-workflow-listed.PNG)

### <a name="the-designer-view"></a>Представление конструктора

Отобразится вкладка **Designer** (Конструктор) для рабочего процесса. В представлении конструктора отображены следующие шаги.

1. Параметр **Condition** (Условие), оцениваемый рабочим процессом. В этом случае рабочий процесс вызывает API модерации изображений Content Moderator и проверяет, имеет ли полученное свойство `isAdult` значение `true`.
1. Параметр **Action** (Действие), задающий действие, которое выполняется, если условие соблюдено. В этом случае рабочий процесс создает проверку в инструменте проверки, если полученное свойство `isAdult` имеет значение `true`.

![Рабочий процесс по умолчанию в конструкторе Content Moderator](images/default-workflow-designer.png)

### <a name="the-json-view"></a>Представление JSON

Чтобы просмотреть представление JSON рабочего процесса, выберите вкладку **JSON**.

    {
        "Type": "Logic",
        If": {
            "ConnectorName": "moderator",
            "OutputName": "isAdult",
            "Operator": "eq",
            "Value": "true",
            "Type": "Condition"
        },
        "Then": {
        "Perform": [
        {
            "Name": "createreview",
            "CallbackEndpoint": null,
            "Tags": []
        }
        ],
        "Type": "Actions"
        }
    }

### <a name="key-learning"></a>Обучение основам

Рабочие процессы в Content Moderator являются гибкими и простыми в настройке. Если встроенный конструктор не удовлетворяет вашим требованиям, вы можете написать определение рабочего процесса в формате **JSON**. Затем это определение JSON можно будет использовать в [API рабочих процессов](https://westus.dev.cognitive.microsoft.com/docs/services/580519463f9b070e5c591178/operations/5813b46b3f9b0711b43c4c59) для создания рабочего процесса и управления им из приложения.

## <a name="define-a-custom-workflow"></a>Определение пользовательского рабочего процесса

Возможности рабочих процессов Content Moderator позволяют определять и использовать пользовательские рабочие процессы. Определение пользовательского рабочего процесса описывается в статье [Определение, тестирование и использование рабочих процессов](Review-Tool-User-Guide/Workflows.md). Этот рабочий процесс использует функции распознавания текста Content Moderator для извлечения текста из примера изображения. Затем он создает проверку в инструменте проверки.

### <a name="the-sample-image"></a>Пример изображения

Сохраните [пример изображения](https://moderatorsampleimages.blob.core.windows.net/samples/sample5.png) на локальный диск. Это изображение необходимо для упражнения.

### <a name="the-designer-view"></a>Представление конструктора

Выберите вкладку **Designer** (Конструктор) и следуйте указаниям в [руководстве по созданию рабочих процессов](Review-Tool-User-Guide/Workflows.md), чтобы определить пользовательский рабочий процесс. На следующем рисунке показано представление конструктора **Condition** (Условие). С остальными шагами можно ознакомиться в руководстве.

![Условие рабочего процесса в Content Moderator](Review-Tool-User-Guide/images/ocr-workflow-step-2-condition.PNG)

### <a name="the-json-view"></a>Представление JSON

Выберите вкладку **JSON**, чтобы просмотреть определение JSON своего пользовательского рабочего процесса. Обратите внимание на то, как инструкции **If-Then** в определении JSON соответствуют шагам, определенным с помощью представления конструктора.

    {
        "Type": "Logic",
        "If": {
            "ConnectorName": "moderator",
            "OutputName": "hasText",
            "Operator": "eq",
            "Value": "true",
            "Type": "Condition"
        },
        "Then": {
        "Perform": [
        {
            "Name": "createreview",
            "CallbackEndpoint": null,
            "Tags": [
            {
                "Tag": "a",
                "IfCondition": {
                    "ConnectorName": "moderator",
                    "OutputName": "hasText",
                    "Operator": "eq",
                    "Value": "true",
                    "Type": "Condition"
                }
            }
            ]
        }
        ],
        "Type": "Actions"
        }
    }

### <a name="workflow-result"></a>Результат рабочего процесса

После проверки рабочего процесса на экране "Workflows" (Рабочие процессы) создается проверка, показанная ниже. Перейдите на вкладку **Image** (Изображение) в разделе **Review** (Проверка), чтобы просмотреть проверку.
Рабочий процесс создал проверку, так как проверка основного условия дала положительный результат на наличие текста. Кроме того, в проверке изображения выделен тег **`a`**.

![Выходные данные простого рабочего процесса в Content Moderator](images/ocr-sample-image-workflow1.PNG)


## <a name="advanced-workflow-with-combination"></a>Расширенный рабочий процесс с несколькими условиями

### <a name="the-sample-image"></a>Пример изображения

Используйте тот же [пример изображения](https://moderatorsampleimages.blob.core.windows.net/samples/sample5.png), который был использован в предыдущем разделе.

Однако на этот раз измените основное условие, указав сочетание двух проверок. Помимо проверки наличия текста проверьте, содержит ли он нецензурную лексику. Рабочий процесс создаст проверку, если обнаружит текст **и** найдет в нем нецензурную лексику.

### <a name="the-designer-view"></a>Представление конструктора

Чтобы изменить значение параметра **Condition** (Условие) на **Combination** (Сочетание), измените рабочий процесс. На рисунке ниже показано новое представление в конструкторе.

![Измененное условие рабочего процесса в Content Moderator](images/ocr-workflow-2-designer.PNG)

### <a name="the-json-view"></a>Представление JSON

Выберите вкладку **JSON**, чтобы просмотреть определение JSON измененного пользовательского рабочего процесса. Обратите внимание на то, как инструкции **If-Then** в определении JSON соответствуют новым шагам, добавленным в рабочий процесс.

    {
        "Type": "Logic",
        "If": {
        "Left": {
            "ConnectorName": "moderator",
            "OutputName": "hasText",
            "Operator": "eq",
            "Value": "true",
            "Type": "Condition"
            },
        "Right": {
            "ConnectorName": "moderator",
            "OutputName": "text.HasProfanity",
            "Operator": "eq",
            "Value": "true",
            "Type": "Condition",
            "AlternateInput": "moderator.ocrText"
            },
        "Combine": "AND",
        "Type": "Combine"
        },
        "Then": {
        "Perform": [
        {
            "Name": "createreview",
            "CallbackEndpoint": null,
            "Tags": [
            {
                "Tag": "a",
                "IfCondition": {
                    "ConnectorName": "moderator",
                    "OutputName": "hasText",
                    "Operator": "eq",
                    "Value": "true",
                    "Type": "Condition"
                }
            }
            ]
        }
        ],
        "Type": "Actions"
        }
    }

    
### <a name="workflow-result"></a>Результат рабочего процесса

После повторного тестирования рабочего процесса вы обнаружите, что проверки не были созданы. Чтобы убедиться в отсутствии проверок, перейдите на вкладку **Image** (Изображение) в разделе **Review** (Проверка).
Рабочий процесс не создал проверку, так как ему не удалось обнаружить нецензурную лексику в извлеченном тексте.

![Выходные данные измененного рабочего процесса в Content Moderator](images/ocr-workflow-2-result.PNG)


## <a name="the-workflow-api"></a>API рабочих процессов

Операции [рабочего процесса](https://westus.dev.cognitive.microsoft.com/docs/services/580519463f9b070e5c591178/operations/5813b46b3f9b0711b43c4c59) обеспечивают интерфейс программирования для возможностей рабочих процессов. Для создания рабочих процессов, получения сведений о рабочем процессе и обновления определений рабочих процессов можно использовать API рабочих процессов.

### <a name="get-all-workflow-details"></a>Получение сведений о рабочем процессе

Операция **Workflow-Get** принимает следующие входные данные.

- **team**: идентификатор команды, созданной при настройке [учетной записи средства проверки](https://contentmoderator.cognitive.microsoft.com/). 
- **workflowName**: имя рабочего процесса. Для начала используйте `default`.
- **Ocp-Apim-Subscription-Key**: отображается на вкладке **Settings** (Параметры). Дополнительные сведения см. в этом [обзоре](overview.md).

Если операция выполнена успешно, **Response status** (Состояние ответа) имеет значение `200 OK`, а в поле **Response content** (Содержимое ответа) отображается определение рабочего процесса в формате JSON.
Чтобы узнать больше, прочитайте [краткое руководство по консоли API рабочих процессов](try-review-api-job.md).

### <a name="create-or-update-workflow"></a>Создание или обновление рабочего процесса

Операция создания и обновления позволяет создать рабочий процесс с помощью API.

Операция **Workflow-Create or Update** принимает следующие входные данные.

- **team**: идентификатор команды, созданной при настройке [учетной записи средства проверки](https://contentmoderator.cognitive.microsoft.com/). 
- **workflowName**: имя рабочего процесса. Для начала используйте `default`.
- **Ocp-Apim-Subscription-Key**: отображается на вкладке **Settings** (Параметры). Дополнительные сведения см. в этом [обзоре](overview.md).

Если операция выполнена успешно, **Response status** (Состояние ответа) имеет значение `200 OK`, а в поле **Response content** (Содержимое ответа) отображается `true`. Чтобы узнать больше, [опробуйте операцию `Create`](try-review-api-job.md).

## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать, как для создавать пользовательские рабочие процессы, изучите [руководство по рабочим процессам инструмента проверки](Review-Tool-User-Guide/Workflows.md). 

Проверьте в работе [консоль API рабочих процессов](try-review-api-job.md) и примеры кода для REST API. 

Наконец, используйте ваши пользовательские рабочие процессы с **задания** операций, как показано в [консоль API задания](try-review-api-job.md) и [краткого руководства по .NET заданий](moderation-jobs-quickstart-dotnet.md).
