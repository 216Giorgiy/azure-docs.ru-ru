---
title: Публикация вашего приложения LUIS | Документация Майкрософт
description: После создания и тестирования приложения с использованием распознавания речи (LUIS) опубликуйте его как веб-службу на портале Azure.
services: cognitive-services
titleSuffix: Azure
author: v-geberr
manager: kaiqb
ms.service: cognitive-services
ms.component: language-understanding
ms.topic: article
ms.date: 05/07/2018
ms.author: v-geberr;
ms.openlocfilehash: 12a63e65a739be08d436f8f1b53df566255b1fb1
ms.sourcegitcommit: 65b399eb756acde21e4da85862d92d98bf9eba86
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/22/2018
ms.locfileid: "36321816"
---
# <a name="publish-your-trained-app"></a>Публикация обученного приложения
Опубликуйте ваше приложение LUIS после окончания сборки и тестирования. После публикации приложения страница публикации показывает все связанные с ней [конечные точки](luis-glossary.md#endpoint) HTTP. Эти конечные точки интегрируются в любой клиент, чат-бот или внутреннее приложение для каждого [региона](luis-reference-regions.md) и для каждого [ключа](Manage-Keys.md). 

Вы всегда можете [протестировать](interactive-test.md) приложения перед его публикацией. 

## <a name="production-and-staging-slots"></a>Промежуточный и рабочий слоты
Можно опубликовать приложение в **промежуточный** или **рабочий слот**. Использование двух слотов для публикации позволяет иметь две разные версии с опубликованными конечными точками или одну и ту же версию на двух разных конечных точках. 

<!-- TBD: what is the technical difference? log files, endpoint quota? -->

## <a name="settings-configuration-requires-publishing-model"></a>Параметры конфигурации требуют модель публикации
Выполните публикацию в конечной точке после изменения следующих параметров. 

## <a name="external-services-settings"></a>Параметры внешней службы
Параметры внешней службы включают в себя **[анализ тональности](#enable-sentiment-analysis)** и **[подготовку речи](#enable-speech-priming)**.

### <a name="enable-sentiment-analysis"></a>Включение анализа тональности
В **параметрах внешних служб** флажок **Enable Sentiment Analysis** (Включить анализ тональности) позволяет LUIS интегрироваться с функцией [Анализ текста](https://azure.microsoft.com/services/cognitive-services/text-analytics/), чтобы обеспечить анализ тональности и ключевых фраз. Вам не нужно предоставлять ключ Анализа текста и за использование этой службы в вашей учетной записи Azure нет оплаты. Вы проверили этот параметр один раз и он стает постоянным. 

Данные тональности представляют собой оценку между 1 и 0, означающую положительную (ближе к 1) или отрицательную (ближе к 0) тональность данных.

Для получения дополнительной информации об ответе конечной точки JSON с анализом мнений см. раздел[Анализ мнений](luis-concept-data-extraction.md#sentiment-analysis)

### <a name="enable-speech-priming"></a>Включение подготовки речи 
В **параметрах внешней службы** флажок **Enable Speech Priming** (Включение подготовки речи) позволяет иметь одну конечную точку, чтобы получать произнесенные фразы чат-бота или приложения, вызывающего LUIS, и получать от LUIS ответ с прогнозом. Подготовка речи использует [API распознавания речи](../Speech-Service/rest-apis.md) службы Cognitive Service. 

![Изображение диалогового окна с подтверждением подготовки речи](./media/luis-how-to-publish-app/speech-prime-modal.png)

Публикуйте свое приложения после включения этой функции. Когда вы публикуете приложение LUIS, ваша модель приложения отправляется вашей службе "Речь", чтобы запустить ее. Сведения о вашей модели **не** используются за пределами вашей службы. 

Чтобы завершить процесс подготовки речи, требуются следующие сведения для использования в [пакете средств разработки службы "Речь"](../speech-service/speech-sdk-reference.md):
* Ключ подписки LUIS.
* Идентификатор приложения LUIS.
* Домен конечной точки, называемый Hostname в пакете средств разработки, например westus.api.cognitive.microsoft.com, где первый дочерний домен является регионом публикации приложения.

Дополнительные сведения см. в образце в разделе [Пример для распознавания намерений](http://aka.ms/speechsdk).

При удалении приложения LUIS или службы "Речь" удаляются модели данных. 

## <a name="endpoint-url-settings"></a>Настройка URL-адреса конечной точки
Настройка URL-адресов конечных точек включает смещение **[часового пояса](#set-timezone-offset)**, **[все прогнозируемые оценки намерения](#include-all-predicted-intent-scores)** и **[Проверку орфографии Bing](#enable-bing-spell-checker)**.

### <a name="set-timezone-offset"></a>Установка смещения часового пояса 
Частью выбора слота является выбор часового пояса. Эта настройка часового пояса позволяет LUIS [изменять](luis-concept-data-alteration.md#change-time-zone-of-prebuilt-datetimev2-entity) любые заранее установленные значения времени datetimeV2 во время прогноза так, чтобы возвращаемые данные сущностей были правильными в соответствии с выбранным часовым поясом. 

### <a name="include-all-predicted-intent-scores"></a>Включение всех прогнозируемых оценок намерения
Флажок **Включить все прогнозируемые оценки намерения** позволяет ответить на запрос конечной точки, чтобы включить оценку прогноза для каждого намерения. 

Этот параметр позволяет вашему чат-боту или приложению LUIS принимать программное решение, основанное на оценках возвращенных намерений. Как правило, два верхние намерения являются наиболее интересными. Если верхний показатель намерения — None, ваш чат-бот может задать вопрос, который сделает окончательным выбор между намерением None и другим намерением с высокой оценкой. 

Намерения и их оценки также включены в журналы конечных точек. Вы можете [экспортировать](create-new-app.md#export-app) эти журналы и проанализировать оценки. 

```
{
  "query": "book a flight to Cairo",
  "topScoringIntent": {
    "intent": "None",
    "score": 0.5223427
  },
  "intents": [
    {
      "intent": "None",
      "score": 0.5223427
    },
    {
      "intent": "BookFlight",
      "score": 0.372391433
    }
  ],
  "entities": []
}
```

### <a name="enable-bing-spell-checker"></a>Включение проверки орфографии Bing 
Флажок **Включить проверку орфографии Bing** в **настройках URL-адреса конечной точки** позволяет LUIS проверять орфографию перед прогнозом. Для этого требуется создать **[ключ проверки орфографии Bing](https://azure.microsoft.com/try/cognitive-services/?api=spellcheck-api)**. После создания ключа к URL-адресу конечной точки на странице публикации добавляются два параметра строки запроса. 

Если вы создаете собственные URL-адреса для своего приложения, вызывающего LUIS, убедитесь, что заданы параметры строки запроса **spellCheck=true** и **bing-spell-check-subscription-key={YOUR_BING_KEY_HERE}**. Замените `{YOUR_BING_KEY_HERE}` своим ключом проверки правописания Bing.

```JSON
{
  "query": "Book a flite to London?",
  "alteredQuery": "Book a flight to London?",
  "topScoringIntent": {
    "intent": "BookFlight",
    "score": 0.780123
  },
  "entities": []
}
```

## <a name="publish-your-trained-app-to-an-http-endpoint"></a>Публикация обученного приложения в конечную точку HTTP
Откройте приложение, щелкнув его имя на странице **Мои приложения**, и нажмите кнопку **Опубликовать** на верхней панели. 

![Страница публикации](./media/luis-how-to-publish-app/publish-to-production.png)
 
При успешной публикации приложения в верхней части браузера появится зеленое уведомление. 

* Выберите, следует ли публиковать в **рабочий** или **промежуточный** слот, выбрав в раскрывающемся меню пункт **Выбрать слот**. 

## <a name="assign-key"></a>Назначение ключа

Если вы хотите использовать ключ, отличный от бесплатной версии Starter_Key, нажмите кнопку **Добавить ключ**. При этом открывается диалоговое окно, позволяющее выбрать имеющийся ключ конечной точки для назначения этому приложению. Дополнительные сведения о том, как создавать и добавлять ключи конечной точки в приложение LUIS, см. в статье [Manage your LUIS endpoint keys](Manage-Keys.md) (Управление ключами конечной точки LUIS).

Чтобы просмотреть конечные точки и ключи, связанные с другими регионами, используйте переключатели для переключения областей. Каждая строка в таблице **Ресурсы и ключи** перечисляет ресурсы Azure, связанные с вашей учетной записью и ключи конечной точки, связанные с этим ресурсом.

## <a name="endpoint-url-construction"></a>Создание конечной точки URL-адреса
URL-адрес конечной точки соответствует региону Azure, связанному с ключом конечной точки.

В этой таблице удобно отображается ваша конфигурация публикации в конечной точке URL со стратегиями маршрута и строками запроса. Если вы создаете URL-адреса конечных точек для своего приложения, вызывающего LUIS, убедитесь, что эти же маршруты и значения строки запроса заданы для используемой конечной точки. При необходимости их нужно установить.

Маршрут URL-адреса создается с использованием области и идентификатора приложения. При публикации в других регионах или с другими приложениями URL-адрес конечной точки можно создать, изменив значения идентификатора региона и приложения. 

* Выберите слот Production (Рабочий) и нажмите кнопку **Publish** (Опубликовать). При успешной публикации используйте отображаемый URL-адрес конечной точки для доступа к своему приложению LUIS. 

### <a name="optional-query-string-parameters"></a>Необязательные параметры строки запроса
Можно использовать следующие параметры строки запроса с URL-адресом конечной точки:

<!-- TBD: what about speech priming? -->

|Строка запроса|type|Пример значения|Назначение|
|--|--|--|--|
|verbose|Логическое|Да|Включает [все оценки намерения](#include-all-predicted-intent-scores) для фраз|
|timezoneOffset|число (единица измерения — минуты)|60|Задайте [смещение часового пояса](luis-concept-data-alteration.md#change-time-zone-of-prebuilt-datetimev2-entity) для [предварительно созданных сущностей datetimeV2](luis-reference-prebuilt-datetimev2.md)|
|spellCheck|Логическое|Да|[Проверка орфографии](#enable-bing-spell-checker) фраз, используется в сочетании с параметром строки запроса bing-spell-check-subscription-key|
|bing-spell-check-subscription-key|Идентификатор подписки||Используется в сочетании с параметром spellCheck строки запроса|
|staging|Логическое|false|Выберите промежуточную или рабочую конечную точку|
|log|Логическое|Да|Добавьте запрос и результаты в журнал|


## <a name="test-your-published-endpoint-in-a-browser"></a>Тестирование опубликованной конечной точки в браузере
Протестируйте опубликованную конечную точку, выбрав URL-адрес в столбце **Конечная точка**. Браузер по умолчанию открывается с созданным URL-адресом. Задайте в тестовый запрос для URL-адреса параметр "&q". Например, добавьте `&q=Book me a flight to Boston on May 4` к своему URL-адресу, а затем нажмите клавишу ВВОД. Браузер отображает ответ JSON для конечной точки HTTP. 

![Ответ JSON с опубликованной конечной точки HTTP](./media/luis-how-to-publish-app/luis-publish-app-json-response.png)

## <a name="next-steps"></a>Дополнительная информация

* См. раздел [Manage your LUIS endpoint keys](./Manage-Keys.md) (Управление ключами конечной точки LUIS), чтобы добавить ключи к своему приложению LUIS и узнать, как ключи сопоставляются с регионами.
* Инструкции по тестированию приложения с помощью консоли тестирования см. в статье [Test your LUIS app](interactive-test.md) (Протестируйте свое приложение LUIS).
