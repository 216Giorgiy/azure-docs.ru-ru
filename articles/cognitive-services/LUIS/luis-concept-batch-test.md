---
title: Пакетное тестирование приложения LUIS в Azure | Документация Майкрософт
description: Используйте пакетное тестирование для постоянной работы над приложением, чтобы усовершенствовать его и улучшить его функции распознавания речи.
services: cognitive-services
author: diberry
manager: cjgronlund
ms.service: cognitive-services
ms.component: language-understanding
ms.topic: article
ms.date: 07/06/2018
ms.author: diberry
ms.openlocfilehash: bba3f2ff942fbe5dffc9b694990964e4e3078dbe
ms.sourcegitcommit: 44fa77f66fb68e084d7175a3f07d269dcc04016f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2018
ms.locfileid: "39222659"
---
# <a name="batch-testing-in-luis"></a>Пакетное тестирование в LUIS

При пакетном тестировании проверяется [активная](luis-concept-version.md#active-version) обученная модель для оценки точности прогнозирования. По завершении пакетного тестирования отображается диаграмма точности для каждого намерения и каждой сущности в текущей обученной модели. Изучив результаты пакетного тестирования, вы сможете предпринять меры для повышения точности, например добавить в намерение новые примеры высказываний, если приложение часто ошибается с определением намерений.

## <a name="group-data-for-batch-test"></a>Группировка данных для пакетного тестирования
Очень важно применять для пакетного тестирования высказывания, еще не знакомые службе LUIS. Если у вас есть готовый набор высказываний, разделите его на три части: высказывания, добавленные в намерение; высказывания, полученные от опубликованной конечной точки; высказывания для пакетного тестирования LUIS после обучения. 

## <a name="a-dataset-of-utterances"></a>Набор данных с высказываниями
Передайте пакетный файл с высказываниями, который обычно называют *набором данных*, для пакетной проверки. Этот файл содержит данные в формате JSON, которые описывают не более 1000 высказываний **без повторов** и с метками. Для тестирования приложения вы можете применить до 10 наборов данных. Если вам нужно больше, сначала удалите набор данных и добавьте новый вместо него.

|**Правила**|
|--|
|*Высказывания не должны дублироваться.|
|Сущности не могут иметь иерархическую структуру.|
|Не более 1000 высказываний.|

*Дубликатами считаются только точные совпадения, а не совпадения после назначения маркеров. 

## <a name="entities-allowed-in-batch-tests"></a>Сущности, разрешенные в пакетных тестированиях
Сюда можно отнести такие типы сущностей, как простые, иерархически родительские и составные. Все типы этих сущностей отображаются в фильтре сущностей пакетного тестирования, даже если в пакетном файле нет соответствующих сущностей.


<a name="json-file-with-no-duplicates"></a>
<a name="example-batch-file"></a>
## <a name="batch-file-format"></a>Формат пакетного файла
Пакетный файл содержит высказывания. Каждое высказывание должно сопровождаться ожидаемым прогнозом намерения, а также всеми [сущностями машинного обучения](luis-concept-entity-types.md#types-of-entities), которые должны быть в нем обнаружены. 

Пример пакетного файла с правильным синтаксисом приведен далее.

```JSON
[
  {
    "text": "Are there any janitorial jobs currently open?",
    "intent": "GetJobInformation",
    "entities": 
    [
        {
            "entity": "Job",
            "startPos": 14,
            "endPos": 23
        }
    ]
  },
  {
    "text": "I would like a fullstack typescript programming with azure job",
    "intent": "GetJobInformation",
    "entities": 
    [
        {
            "entity": "Job",
            "startPos": 15,
            "endPos": 46
        }
    ]
  },
  {
    "text": "Is there a database position open in Los Colinas?",
    "intent": "GetJobInformation",
    "entities": 
    [
        {
            "entity": "Job",
            "startPos": 11,
            "endPos": 18
        }
    ]
  },
  {
    "text": "Please find database jobs open today in Seattle",
    "intent": "GetJobInformation",
    "entities": 
    [
        {
            "entity": "Job",
            "startPos": 12,
            "endPos": 19
        }
    ]
  }
]
```

## <a name="batch-syntax-template"></a>Шаблон синтаксиса пакета

Чтобы запустить файл пакета, используйте следующий шаблон.

```JSON
[
  {
    "text": "example utterance goes here",
    "intent": "intent name goes here",
    "entities": 
    [
        {
            "entity": "entity name 1 goes here",
            "startPos": 14,
            "endPos": 23
        },
        {
            "entity": "entity name 2 goes here",
            "startPos": 14,
            "endPos": 23
        }
    ]
  }
]
```

Чтобы уведомить о начале и конце сущности, в файле пакета используются свойства **startPos** и **endPos**. Их значения отсчитываются, начиная с нуля, и не должны начинаться или заканчиваться пробелом. 

В этом и состоит основное отличие от журналов запросов, для которых используются свойства startIndex и endIndex. 


## <a name="common-errors-importing-a-batch"></a>Распространенные ошибки при импорте пакета
Ниже перечислены распространенные ошибки. 

> * Превышение ограничения в 1000 высказываний.
> * Объект JSON, содержащий высказывание, не имеет свойства entities.
> * Слова, которые были помечены в нескольких сущностях.

## <a name="batch-test-state"></a>Состояние пакетного тестирования
LUIS отслеживает данные о состоянии последнего тестирования для каждого набора данных. К этим данным относится размер набора данных (количество высказываний в пакете), дата последнего запуска и последний полученный результат (количество успешно спрогнозированных высказываний).

<a name="sections-of-the-results-chart"></a>
## <a name="batch-test-results"></a>Результаты пакетного тестирования
Результат пакетного тестирования демонстрируется в виде точечной диаграммы, которую называют матрицей ошибок. На этой диаграмме приводится распределение по 4 секторам результатов сравнения высказываний, содержащихся в файле, с намерениями и сущностями, прогнозируемыми текущей моделью. 

Точки данных в секторах **False Positive** (Ложный положительный результат) и **False Negative** (Ложный отрицательный результат) обозначают ошибки, которые нужно изучить дополнительно. Если все точки данных попадают в сектора **True Positive** (Истинный положительный результат) и **True Negative** (Истинный отрицательный результат), значит приложение идеально прогнозирует результаты по предложенному набору данных.

![Четыре сектора на диаграмме](./media/luis-concept-batch-test/chart-sections.png)

Эта диаграмма позволяет найти высказывания, которые LUIS неправильно прогнозирует при текущем состоянии обучения. Результаты отображаются в нескольких областях диаграммы. Выберите конкретную точку на диаграмме, чтобы просмотреть сведения об этом высказывании, или выберите имя области, чтобы просмотреть обобщенные результаты по этой области.

![Пакетное тестирование](./media/luis-concept-batch-test/batch-testing.png)

## <a name="errors-in-the-results"></a>Результаты с информацией об ошибках
Ошибками при пакетном тестировании считаются прогнозируемые намерения, которые не совпадают с данными в этом пакетном файле. Ошибки отображаются на диаграмме в двух красных секторах. 

Раздел ложных положительных результатов содержит сведения о высказываниях, которые ошибочно совпадают с намерением или сущностью. Раздел ложных отрицательных результатов содержит сведения о высказываниях, которые не соответствуют нужному намерению или сущности. 

## <a name="fixing-batch-errors"></a>Исправление ошибок, выявленных при пакетном тестировании
Если при пакетном тестировании будут обнаружены ошибки, вы можете добавить в намерение больше высказываний и (или) сопоставить дополнительные высказывания с сущностью, чтобы служба LUIS лучше различала намерения. Если вы уже добавили все нужные высказывания и присвоили все метки, но в прогнозировании при пакетном тестировании по-прежнему возникают ошибки, попробуйте добавить [список фраз](luis-concept-feature.md) с характерным для предметной области словарем, который поможет LUIS обучаться быстрее. 

## <a name="next-steps"></a>Дополнительная информация

* Узнайте, как [выполнить пакетное тестирование](luis-how-to-batch-test.md)
