---
title: 'Руководство по созданию языковой модели с помощью пользовательской службы распознавания речи: Microsoft Cognitive Services | Документация Майкрософт'
description: В этом руководстве вы узнаете, как создать языковую модель с помощью пользовательской службы распознавания речи в Microsoft Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
manager: onano
ms.service: cognitive-services
ms.component: custom-speech
ms.topic: tutorial
ms.date: 05/03/2017
ms.author: panosper
ms.openlocfilehash: 599302cbf614f800d35a9a8c6a401c9692fc2e39
ms.sourcegitcommit: 301855e018cfa1984198e045872539f04ce0e707
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36268286"
---
# <a name="tutorial-create-a-custom-language-model"></a>Руководство по созданию пользовательской языковой модели

В этом руководстве вы создадите пользовательскую языковую модель для текстовых запросов или фраз, которые, как вы ожидаете, пользователи произнесут или напечатают при работе с приложением. Затем вы можете использовать эту пользовательскую языковую модель в сочетании с имеющимися новейшими моделями речи от Майкрософт, чтобы добавить в приложение голосовое взаимодействие.

Из этого руководства вы узнаете, как выполнять такие задачи:
> [!div class="checklist"]
> * Подготовка данных
> * Импорт набора языковых данных.
> * Создание пользовательской языковой модели.

Если у вас еще нет учетной записи Cognitive Services, создайте [бесплатную учетную запись](https://cris.ai), а затем приступайте к работе.

## <a name="prerequisites"></a>предварительным требованиям

Подключите учетную запись Cognitive Services к подписке. Для этого откройте страницу [подписок Cognitive Services](https://cris.ai/Subscriptions).

Если подписки не указаны, вы можете создать учетную запись с помощью Cognitive Services, нажав кнопку **Get free subscription** (Получить бесплатную подписку). Можно также подключиться к подписке пользовательской службы поиска, созданной на портале Azure, нажав кнопку **Connect existing subscription** (Подключиться к имеющейся подписке).

Дополнительные сведения о создании подписки пользовательской службы поиска на портале Azure см. в статье о [создании учетной записи API Cognitive Services на портале Azure](../../cognitive-services-apis-create-account.md).

## <a name="prepare-the-data"></a>Подготовка данных

Чтобы создать пользовательскую языковую модель для приложения, вам необходимо предоставить список примеров фраз для системы, например:

*   "На прошлой неделе у него была крапивница".
*   "У пациента был заживший шрам, оставшийся после герниопластической операции".

Предложения не обязательно должны быть полными или грамматически правильными, они должны точно отражать произносимые данные, с которыми, по вашему усмотрению, система может столкнуться при развертывании. Эти примеры должны отражать стиль и содержимое задачи, которую пользователи будут выполнять с помощью приложения.

Данные языковой модели должны быть написаны в обычном текстовом файле с использованием кодировки US-ASCII или UTF-8 в зависимости от языкового стандарта. Для en-US поддерживаются обе кодировки. Для zh-CN поддерживается только кодировка UTF-8 (метка порядка байтов необязательна). Текстовый файл должен содержать один пример (предложение, фразу или запрос) на строку.

Если вы хотите, чтобы некоторые предложения имели более высокую важность, вы можете добавить их к данным несколько раз. Оптимальное количество повторений составляет 10–100. Если установить стандартное значение 100, относительно этого значения можно легко задать важность предложения.

Основные требования к языковым данным приведены в следующей таблице.

| Свойство | Значение |
|----------|-------|
| Кодировка текста | en-US: US-ACSII или UTF-8; zh-CN: UTF-8|
| Количество фраз на строку | 1 |
| Максимальный размер файла | 200 МБ |
| Примечания | Избегайте повторения знаков более 4-х раз, например "aaaaa"|
| Примечания | Не используйте специальные знаки, такие как "\t" или любой другой знак UTF-8, идущий после U+00A1 в [таблице знаков Юникод](http://www.utf8-chartable.de/)|
| Примечания | Также будут отклонены универсальные коды ресурсов (URI), так как нет уникального способа произнести их|

При импорте текст нормализуется, чтобы система могла его обработать. Однако есть некоторые важные действия нормализации, которые пользователь должен выполнять _перед_ отправкой данных. Ознакомьтесь с [рекомендациями по транскрибированию](cognitive-services-custom-speech-transcription-guidelines.md), чтобы определить соответствующий формат языка при подготовке языковых данных.

## <a name="import-the-language-data-set"></a>Импорт набора языковых данных

Нажмите кнопку "Импорт" в строке акустических наборов данных, и на сайте появится страница для отправки нового набора данных.

Когда вы будете готовы импортировать свой набор языковых данных, войдите на [портал пользовательской службы распознавания речи](https://cris.ai).  Затем щелкните вкладку раскрывающегося меню "Настраиваемое распознавание речи" в верхней ленте и выберите "Adaptation Data" (Данные адаптации). Если вы впервые передаете данные в пользовательскую службу распознавания речи, вы увидите пустую таблицу с именем "Наборы данных".

Чтобы импортировать новый набор данных, нажмите кнопку "Импорт" в строке наборов языковых данных, и на сайте появится страница для отправки нового набора данных. Введите имя и описание, чтобы определить набор данных в будущем. Затем нажмите кнопку "Выбрать файл", чтобы найти текстовый файл языковых данных. После этого для передачи набора данных нажмите кнопку "Импорт". В зависимости от размера набора данных это может занять несколько минут.

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-language-datasets-import.png)

После завершения операции импорта вы вернетесь в таблицу языковых данных и увидите запись, соответствующую вашему набору языковых данных. Обратите внимание, что ему был присвоен уникальный идентификатор (GUID). Данные также будут включать статус, отражающий их текущее состояние. Этим состоянием будет "Ожидание", если данные ставятся в очередь для обработки, "Идет обработка", если выполняется проверка, и "Выполнено", когда данные можно использовать. При проверке данных выполняется ряд проверок текста в файле и некоторая нормализация текста.

Если активно состояние "Выполнено", можно щелкнуть "Просмотр отчета", чтобы просмотреть отчет о проверке языковых данных. Отобразится количество успешных и неудачных проверок, а также сведения о фразах, завершившихся сбоем. В приведенном ниже примере два примера не прошли проверку из-за неправильных знаков (в этом наборе данных в первом примере содержались два смайлика эмодзи, а во втором было несколько знаков за пределами кодировки для печати ASCII).

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-language-datasets-report.png)

Если набор языковых данных имеет состояние "Выполнено", его можно использовать для создания пользовательской языковой модели.

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-language-datasets.png)

## <a name="create-a-custom-language-model"></a>Создание пользовательской языковой модели

Когда языковые данные будут готовы, щелкните "Language Models" (Языковые модели) в раскрывающемся меню, чтобы запустить процесс создания пользовательской языковой модели. На этой странице содержится таблица с именем "Language Models" (Языковые модели) с текущими пользовательскими языковыми моделями. Если вы еще не создали ни одной пользовательской языковой модели, таблица будет пустая. Текущий языковой стандарт отражается в заголовке таблицы. Если вы хотите создать языковую модель для другого языка, щелкните "Change Locale" (Изменить языковой стандарт). Дополнительные сведения о поддерживаемых языках можно найти в статье о [поддерживаемых языковых стандартах в пользовательской службе распознавания речи](cognitive-services-custom-speech-change-locale.md). Чтобы создать модель, щелкните ссылку "Создать" под заголовком таблицы.

На странице создания языковой модели введите имя и описание, чтобы затем отслеживать соответствующую информацию об этой модели, например используемый набор данных. После этого в раскрывающемся меню выберите базовую языковую модель. Эта модель станет отправной точкой настройки. Вы можете выбрать из двух базовых языковых моделей. _Языковая модель поиска и диктовки Майкрософт_ подходит для речи, направленной в приложение, например команд, поисковых запросов или диктовки. _Разговорная языковая модель Майкрософт_ подходит для распознавания речи в разговорном стиле. Этот тип речи обычно направлен на другого человека и встречается в колл-центрах или на встречах.

После указания базовой языковой модели в раскрывающемся меню "Language Data" (Языковые данные) выберите набор языковых данных, который вы хотите использовать для настройки.

![попробуйте выполнить следующее](../../../media/cognitive-services/custom-speech-service/custom-speech-language-models-create2.png)

Как и при создании акустической модели, после завершения обработки вы можете выбрать автономное тестирование новой модели. Так как это оценка эффективности преобразования речи в текст, автономное тестирование требует акустического набора данных.

Чтобы выполнить автономное тестирование языковой модели, установите флажок рядом с параметром "Автономное тестирование". Затем в раскрывающемся меню выберите акустическую модель. Если вы не создали ни одной пользовательской акустической модели, базовая акустическая модель Майкрософт будет единственной моделью в меню. Если вы выбрали базовую разговорную языковую модель, вам нужно использовать акустическую разговорную модель. Если вы используете языковую модель поиска и диктовки, нужно выбрать акустическую модель диктовки.

Наконец, выберите акустический набор данных, который вы хотите использовать для оценки.

Когда будете готовы начать обработку, нажмите кнопку "Создать". Вы вернетесь в таблицу языковых моделей. В таблице появится новая запись, соответствующая этой модели. Статус отражает состояние модели и будет изменяться, представляя разные этапы: "Ожидание", "Идет обработка" и "Выполнено".

Когда модель достигнет состояния "Выполнено", ее можно развернуть в конечную точку. Щелкните "Просмотр результата", и появятся результаты автономного тестирования (если оно применялось).

Если на каком-то этапе вы захотите изменить имя или описание модели, щелкните ссылку "Изменить" в соответствующей строке таблицы языковых моделей.

## <a name="next-steps"></a>Дополнительная информация

В этом руководстве вы разработали пользовательскую языковую модель для использования с текстом. Чтобы создать пользовательскую акустическую модель для использования с аудиофайлами и расшифровками, перейдите к руководству по созданию акустической модели.

> [!div class="nextstepaction"]
> [Руководство по созданию пользовательской акустической модели](cognitive-services-custom-speech-create-acoustic-model.md)
