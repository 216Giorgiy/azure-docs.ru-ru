---
title: "Часто задаваемые вопросы о ретрансляторе Azure | Документация Майкрософт"
description: "Ответы на некоторые часто задаваемые вопросы о ретрансляторе Azure."
services: service-bus-relay
documentationcenter: na
author: jtaubensee
manager: timlt
editor: 
ms.assetid: 886d2c7f-838f-4938-bd23-466662fb1c8e
ms.service: service-bus-relay
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/28/2016
ms.author: jotaub,sethm
translationtype: Human Translation
ms.sourcegitcommit: ca66a344ea855f561ead082091c6941540b1839d
ms.openlocfilehash: 22781ec965decbfd33923478794a76692151c363


---
# <a name="relay-faq"></a>Вопросы и ответы по ретранслятору
В этой статье содержатся ответы на некоторые часто задаваемые вопросы о ретрансляторе Microsoft Azure. Вы также можете посетить страницу [Часто задаваемые вопросы о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083) , где содержатся общие сведения о расценках и поддержке Azure.

## <a name="general-questions"></a>Общие вопросы
### <a name="what-is-azure-relay"></a>Что такое ретранслятор Azure?
[Служба ретрансляции](relay-what-is-it.md) Azure упрощает работу с гибридными приложениями, позволяя безопасно предоставлять в общедоступном облаке службы, используемые в корпоративной сети предприятия, без необходимости открывать подключения брандмауэра или вносить значительные изменения в инфраструктуру корпоративной сети.

### <a name="what-is-a-relay-namespace"></a>Что такое пространство имен ретранслятора?
[Пространство имен](relay-create-namespace-portal.md) предоставляет контейнер для адресации ресурсов ретранслятора в вашем приложении. Необходимо создать пространство имен, чтобы использовать ретранслятор. Это будет одним из первых шагов.

### <a name="what-happened-to-the-previously-named-relay-service"></a>Что случилось со службой, которая называлась службой ретрансляции?
Служба, которая называлась службой **ретрансляции**, теперь называется *ретранслятором WCF*. Вы можете использовать эту службу как обычно. Гибридные подключения представляют собой обновленную версию службы, перенесенной из BizTalk. Ретранслятор WCF и гибридные подключения будут и дальше поддерживаться.

## <a name="pricing"></a>Цены
В этом разделе содержатся ответы на некоторые часто задаваемые вопросы о ценах на использование ретранслятора. Также можно посетить страницу [часто задаваемых вопросов о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083), где содержатся общие сведения о структуре ценообразования Microsoft Azure. Дополнительные сведения о ценах на использование ретранслятора см. на странице [цен на служебную шину](https://azure.microsoft.com/pricing/details/service-bus/).

### <a name="how-do-you-charge-for-hybrid-connections-and-wcf-relay"></a>Как выставляется цена за гибридные подключения и ретранслятор WCF?
Дополнительные сведения о ценах на использование ретранслятора см. на странице [цен на служебную шину][Pricing overview]. Помимо указанной платы, также взимается плата за связанные операции передачи данных, исходящих из центра обработки данных, в котором подготавливается ваше приложение.

### <a name="how-am-i-billed-for-hybrid-connections"></a>Как рассчитывается стоимость использования гибридных подключений?
Ниже приведены три примера сценария.

1. У вас есть один прослушиватель, например диспетчер гибридных подключений, который постоянно работает в течение месяца. В течение месяца вы передаете через это подключение 3 ГБ данных. В этом случае общая стоимость составит 5 долл. США.
2. У вас есть один прослушиватель, например диспетчер гибридных подключений, который постоянно работает в течение месяца. В течение месяца вы передаете через это подключение 10 ГБ данных. В этом случае общая стоимость составит 7,50 долл. США: 5 долл. США за подключение и первые 5 ГБ + 2,50 долл. США за дополнительные 5 ГБ.
3. У вас есть два экземпляра диспетчера гибридных подключений, А и Б, которые постоянно работают в течение месяца. В течение месяца вы передаете через подключение А — 3 ГБ данных, а через подключение Б — 6 ГБ. В этом случае общая стоимость составит 10,50 долл. США: 5 долл. США за подключение А + 5 долл. США за подключение Б + 0,50 долл. США (за шестой гигабайт через подключение Б).

Обращаем ваше внимание, что в примерах расчетов использованы цены на предварительную версию. После выхода общедоступной версии гибридных подключений цена может измениться.

### <a name="how-are-wcf-relay-hours-calculated"></a>Как вычисляются часы ретрансляции WCF?
Часы ретрансляции оплачиваются по совокупному объему времени, в течение которого каждый ретранслятор служебной шины открыт. Ретранслятор неявно создается и открывается для адреса данной служебной шины (URL-адреса пространства имен службы) каждый раз, когда служба WCF с поддержкой ретрансляции (прослушиватель ретрансляции) подключается к этому адресу. Она закрывается только после того, как последний прослушиватель отключается от этого адреса. Таким образом, при выставлении счетов ретранслятор считается открытым с момента подключения первого прослушивателя ретрансляции к адресу служебной шины, участвующей в данной ретрансляции, и до момента отключения последнего прослушивателя от этого адреса.

### <a name="what-if-i-have-more-than-one-listener-connected-to-a-given-relay"></a>Что делать, если к определенному ретранслятору подключено несколько прослушивателей?
В некоторых случаях к одному ретранслятору могут подключаться несколько прослушивателей. Ретранслятор считается открытым, если к нему подключен хотя бы один прослушиватель. Добавление дополнительных прослушивателей к открытому ретранслятору приведет к появлению дополнительных часов ретрансляции. Количество отправителей ретрансляции (клиентов, вызывающих или отправляющих сообщения ретрансляторам), подключенных к ретранслятору, также не влияет на подсчет часов ретрансляции.

### <a name="how-is-the-messages-meter-calculated-for-wcf-relays"></a>Как вычисляется количество сообщений ретрансляторам WCF?
**Следующие сведения касаются только ретрансляторов WCF и никак не связаны со стоимостью гибридных подключений**.

В целом количество оплачиваемых сообщений для ретрансляторов вычисляется так же, как и для сущностей, использующих брокер — очередей, разделов и подписок (см. выше). Тем не менее существует несколько важных отличий.

Отправка сообщения ретранслятору служебной шины рассматривается как полностью осуществленная отправка прослушивателю ретрансляции, который получает сообщение, а не отправка сообщения ретранслятору служебной шины с последующей его доставкой прослушивателю ретрансляции. Следовательно, при вызове службы типа "запрос — ответ" (размером до 64 КБ) на уровне прослушивателя ретрансляции будут зафиксированы следующие сообщения: одно оплачиваемое сообщение для запроса и одно оплачиваемое сообщение для ответа (при условии, что размер ответа также не превышает \<64 КБ). Это отличается от механизма использования очереди в качестве посредника между клиентом и службой. В последнем случае в рамках одного и того же алгоритма типа «запрос-ответ» предусмотрена отправка запроса в очередь с последующим изъятием из очереди и доставкой в службы, отправкой ответа в другую очередь, а также изъятием из очереди и доставкой клиенту. При размере вызова, не превышающем \<64 КБ, использование схемы с посредником в виде очереди приведет к выставлению счета за четыре оплачиваемых сообщения. Это в два раза превышает плату за использование аналогичной схемы с ретранслятором. Конечно, использование такой схемы связано с определенными преимуществами, включая надежность и выравнивание нагрузки. Эти преимущества могут оправдать дополнительные расходы.

Ретрансляторы, открытые с помощью привязки WCF netTCPRelay, обрабатывают сообщения не по отдельности, а как поток данных, передаваемых через систему. Другими словами, сведения о формировании отдельных сообщений, отправленных и полученных с помощью этой привязки, доступны только отправителю и прослушивателю. Таким образом, для ретрансляторов, использующих привязку netTCPRelay, все данные обрабатываются как поток при вычислении количества оплачиваемых сообщений. В этом случае служебная шина вычислит общий объем данных, отправленных или полученных в ходе отдельной ретрансляции с 5-минутными интервалами. Затем полученное значение будет поделено на 64 КБ. Это позволит определить количество оплачиваемых сообщений ретранслятору, обработанных за заданный период.

## <a name="quotas"></a>Квоты
| Имя квоты | Область | Тип | Поведение при превышении квот | Значение |
| --- | --- | --- | --- | --- |
| Параллельные прослушиватели ретранслятора |Сущность |Статическое |Запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. |25 |
| Параллельные прослушиватели ретрансляции |Во всей системе |Статическое |Запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. |2&000; |
| Параллельные подключения ретрансляции для всех конечных точек ретрансляции в пространстве имен службы |Во всей системе |Статическое |- |5 000 |
| Конечные точки ретрансляции на одно пространство имен службы |Во всей системе |Статическое |- |10 000 |
| Размер сообщения для ретрансляций [NetOnewayRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.netonewayrelaybinding.aspx) и [NetEventRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.neteventrelaybinding.aspx) |Во всей системе |Статическое |Входящие сообщения, размер которых превышает эти значения, будут отклонены, а в вызывающем коде возникнет исключение. |64 КБ |
| Размер сообщения для ретрансляций [HttpRelayTransportBindingElement](https://msdn.microsoft.com/library/microsoft.servicebus.httprelaytransportbindingelement.aspx) и [NetTcpRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.nettcprelaybinding.aspx) |Во всей системе |Статическое |- |Без ограничений |

### <a name="does-relay-have-any-usage-quotas"></a>Есть ли у ретранслятора квоты использования?
По умолчанию для любой облачной службы Майкрософт устанавливается квота совокупного месячного использования в рамках всех подписок клиента. Мы понимаем, что вам может потребоваться больше, чем разрешено этими ограничениями. В таком случае вы можете в любое время обратиться в службу поддержки пользователей, чтобы мы изменили эти ограничения на основе ваших потребностей. Для служебной шины установлены следующие квоты общего использования:

* 5 миллиардов сообщений;
* 2 миллиона часов ретрансляции.

Хотя мы оставляем за собой право отключить учетную запись клиента, превысившего свои месячные квоты использования, перед выполнением каких-либо действий мы отправим уведомления по электронной почте, а также предпримем несколько попыток, чтобы связаться с клиентом. Клиентам, превысившим свои квоты, будут выставлены соответствующие счета.

### <a name="naming-restrictions"></a>Ограничения для имен
Имя пространства имен ретранслятора должно содержать от 6 до 50 знаков.

## <a name="subscription-and-namespace-management"></a>Управление подпиской и пространством имен
### <a name="how-do-i-migrate-a-namespace-to-another-azure-subscription"></a>Как перенести пространство имен в другую подписку Azure?
Чтобы переместить пространство имен из одной подписки Azure в другую, можно использовать команды PowerShell (приведенные [здесь](../service-bus-messaging/service-bus-powershell-how-to-provision.md#migrate-a-namespace-to-another-azure-subscription)). При перемещении пространство имен уже должно быть активно. Кроме того, пользователь, который выполняет команды, должен обладать правами администратора как в исходной, так и в целевой подписках.

## <a name="troubleshooting"></a>Устранение неполадок
### <a name="what-are-some-of-the-exceptions-generated-by-azure-relay-apis-and-their-suggested-actions"></a>Какие исключения создаются API ретранслятора Azure? Какие действия можно предпринять?
В статье [Исключения ретранслятора][Relay exceptions] описываются некоторые исключения и приводятся действия по их устранению.

### <a name="what-is-a-shared-access-signature-and-which-languages-support-generating-a-signature"></a>Что такое подписанный URL-адрес? На каких языках можно создавать подписи?
Подписанные URL-адреса представляют собой механизм аутентификации на базе алгоритма безопасного хэширования SHA-256 или URI. Дополнительные сведения о том, как создавать собственные подписи с использованием Node, PHP, Java и C\#, см. в статье [Подписи коллективного доступа][Shared Access Signatures].

[Pricing overview]: https://azure.microsoft.com/pricing/details/service-bus/
[Relay exceptions]: relay-exceptions.md
[Shared Access Signatures]: ../service-bus-messaging/service-bus-sas-overview.md

### <a name="is-it-possible-to-whitelist-relay-endpoints"></a>Можно ли добавить конечные точки ретрансляции в список разрешений?
Да. Клиент ретрансляции устанавливает подключения к службе ретрансляции, используя полные доменные имена. Это дает пользователям возможность добавить запись для `*.servicebus.windows.net` в брандмауэры, поддерживающие добавление в список разрешений DNS.

## <a name="next-steps"></a>Дальнейшие действия
* [Создание пространства имен](relay-create-namespace-portal.md)
* [Приступая к работе с .NET](relay-hybrid-connections-dotnet-get-started.md)
* [Приступая к работе с Node](relay-hybrid-connections-node-get-started.md)



<!--HONumber=Jan17_HO4-->


