<properties
	pageTitle="Предварительная версия Azure Active Directory B2C | Microsoft Azure"
	description="Как создавать приложения напрямую с использованием протоколов, поддерживаемых предварительной версией Azure Active Directory B2C."
	services="active-directory-b2c"
	documentationCenter=""
	authors="dstrockis"
	manager="msmbaldwin"
	editor=""/>

<tags
	ms.service="active-directory-b2c"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="01/28/2016"
	ms.author="dastrock"/>

# Предварительная версия Azure AD B2C: протоколы проверки подлинности

Azure Active Directory (Azure AD) B2C предоставляет приложениям "идентификацию как услугу" благодаря поддержке двух стандартных отраслевых протоколов: OpenID Connect и OAuth 2.0. Хотя эта служба соответствует стандартам, любые две реализации этих протоколов могут иметь небольшие различия. Сведения в этом руководстве помогут вам, если вы планируете не использовать одну из наших библиотек с открытым исходным кодом, а писать код с отправкой и обработкой HTTP-запросов напрямую. Мы рекомендуем ознакомиться с этим руководством, прежде чем углубляться в детали каждого конкретного протокола. Но если вы уже знакомы с Azure AD B2C, вы можете сразу перейти к [справочным руководствам по протоколам](#protocols).

<!-- TODO: Need link to libraries above -->

[AZURE.INCLUDE [active-directory-b2c-preview-note](../../includes/active-directory-b2c-preview-note.md)]

## Основные сведения
Каждое приложение, которое использует Azure AD B2C, необходимо зарегистрировать в каталоге B2C на [портале Azure](https://portal.azure.com). В процессе регистрации приложения будут установлены несколько параметров приложения:

- **Идентификатор приложения**, уникально определяющий конкретное приложение.
- **Универсальный код ресурса (URI) перенаправления** или **Идентификатор пакета**, которые можно использовать для возврата ответов приложению.
- Несколько других зависящих от сценария значений. Для получения дополнительных сведений обратитесь к статье [Как зарегистрировать приложение](active-directory-b2c-app-registration.md).

После регистрации приложение взаимодействует с Azure AD, отправляя запросы к конечной точке версии 2.0:

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize
https://login.microsoftonline.com/common/oauth2/v2.0/token
```

Почти во всех потоках обмена данными в OAuth и OpenID Connect участвуют четыре стороны:

![Роли OAuth 2.0](./media/active-directory-b2c-reference-protocols/protocols_roles.png)

- **Сервер авторизации** — это конечная точка Azure AD версии 2.0. Сервер авторизации безопасно обрабатывает все данные, касающиеся сведений о пользователе и доступе. Он также обрабатывает отношения доверия между сторонами потока. Он отвечает за проверку удостоверения пользователя, предоставление и блокировку доступа к ресурсам, а также выпуск маркеров. Он также называется поставщиком удостоверений.
- **Владелец ресурса** — это, как правило, конечный пользователь. Это сторона, владеющая данными, которая может предоставлять третьим сторонам доступ к этим данным или к ресурсу.
- **Клиент OAuth** — это ваше приложение. Оно определяется идентификатором приложения. Обычно это сторона, с которой взаимодействуют пользователи. Клиент OAuth также запрашивает маркеры у сервера авторизации. Владелец ресурса должен предоставить клиенту разрешение на доступ к ресурсу.
- **Сервер ресурсов** — это место размещения ресурса или данных. Он доверяет серверу авторизации безопасную проверку подлинности и авторизацию клиента OAuth. Он также использует токены доступа носителя для предоставления доступа к ресурсу.

## Политики
Политики Azure AD B2C, возможно, являются наиболее важной функцией службы. Azure AD B2C расширяет стандартные протоколы OAuth 2.0 и OpenID Connect путем введения политик. Они позволяют Azure AD B2C выполнять множество других операций кроме простой проверки подлинности и авторизации. Политики полностью описывают процесс идентификации пользователя, включая регистрацию, вход и изменение профиля. Политики можно задавать в административном интерфейсе пользователя. Их можно выполнять с помощью специального параметра запроса в HTTP-запросах проверки подлинности. Политики не являются стандартным компонентом OAuth 2.0 и OpenID Connect, поэтому нужно уделить некоторое время их изучению. Дополнительные сведения см. в [Справочнике по политикам Azure AD B2C](active-directory-b2c-reference-policies.md).

## Маркеры
В реализации OAuth 0.2 и OpenID Connect в Azure AD B2C широко используются токены носителя, включая токены носителя в виде веб-токенов JSON (JWT). Токен носителя — это упрощенный маркер безопасности, предоставляющий его носителю доступ к защищенному ресурсу. В этом смысле носителем является любая сторона, которая может предъявить маркер. Перед получением токена носителя сторона должна пройти проверку подлинности в Azure AD. Однако действия, необходимые для защиты токена при его передаче и хранении, не выполняются, его может перехватить и использовать несанкционированная сторона.

У некоторых маркеров безопасности есть встроенный механизм, который предотвращает их использование несанкционированными сторонами, но токены носителя не имеют такого механизма. Они должны передаваться по защищенному каналу, например по протоколу безопасности транспортного уровня (HTTPS). Если токен носителя передается вне зашифрованного канала, злоумышленник может использовать атаку "человек посередине", чтобы получить токен и использовать его для несанкционированного доступа к защищенному ресурсу. Те же принципы безопасности применяются при сохранении или кэшировании маркеров носителя для последующего использования. Необходимо всегда проверять, что приложение передает и сохраняет токены носителя безопасным образом.

Дополнительные сведения о безопасности при применении токенов носителя см. в [RFC 6750, раздел 5](http://tools.ietf.org/html/rfc6750).

Дополнительные сведения о различных типах токенов, используемых в Azure AD B2C, можно найти в [справочнике по токенам Azure AD](active-directory-b2c-reference-tokens.md).

## Протоколы

Если вы хотите ознакомиться с некоторыми примерами запросов, можете начать с одного из следующих учебников. Каждый из них соответствует определенному сценарию аутентификации. Сведения о том, как выбрать правильный поток, см. в статье о [типах приложений, которые можно создать с помощью Azure AD B2C](active-directory-b2c-apps.md).

- [Создание мобильного и собственного приложения с использованием OAuth 2.0](active-directory-b2c-reference-oauth-code.md)
- [Построение веб-приложений с помощью OpenID Connect](active-directory-b2c-reference-oidc.md)
- Создание одностраничных приложений с использованием неявного потока OAuth 2.0 (ожидается в ближайшее время)
- Создание управляющих программ или серверных процессов с использованием потока учетных данных клиентов OAuth 2.0 (ожидается в ближайшее время)
- Получение токенов с помощью имени пользователя и пароля с использованием потока учетных данных паролей владельцев ресурсов OAuth 2.0 (ожидается в ближайшее время)
- Получение токенов в веб-API с использованием потока "от имени" OAuth 2.0 (ожидается в ближайшее время)

<!---HONumber=AcomDC_0224_2016-->