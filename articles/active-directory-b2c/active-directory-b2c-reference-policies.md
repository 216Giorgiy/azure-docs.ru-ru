---
title: Потоки пользователей в Azure Active Directory B2C | Документация Майкрософт
description: В этой статье описывается инфраструктура расширяемых политик Azure Active Directory B2C и создание различных типов потоков пользователей.
services: active-directory-b2c
author: davidmu1
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 11/30/2018
ms.author: davidmu
ms.component: B2C
ms.openlocfilehash: d4a93b04b8ad86a6a6d36a5bdaf3209b49e7a9dc
ms.sourcegitcommit: b0f39746412c93a48317f985a8365743e5fe1596
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2018
ms.locfileid: "52877088"
---
# <a name="azure-active-directory-b2c-user-flows"></a>Azure Active Directory B2C. Маршруты пользователей


Инфраструктура расширяемых политик Azure Active Directory (Azure AD) B2C — это основное преимущество службы. Политики полностью описывают процесс идентификации пользователей: регистрацию, вход и редактирование профиля. Чтобы вам было проще настроить наиболее распространенные задачи идентификации, на портале Azure AD B2C реализованы предопределенные настраиваемые политики, которые называются **потоками пользователей**. К примеру, последовательность для регистрации позволяет управлять поведением с помощью таких параметров:

* типы учетных записей (учетные записи в социальных сетях, например Facebook, или локальные учетные записи, например адреса электронной почты), которые пользователи могут применять для регистрации в приложении;
* атрибуты (например, имя, почтовый индекс и размер обуви), которые нужно получить от пользователя во время регистрации;
* использование Многофакторной идентификации Azure;
* внешний вид и удобство использования всех страниц регистрации;
* сведения (объявляемые в качестве утверждений в токене), которые получает приложение после завершения выполнения потока пользователя.

В своем клиенте вы можете создать несколько потоков пользователей различных типов и при необходимости использовать их в приложениях. Потоки пользователей могут повторно использоваться в разных приложениях. Такая гибкость позволяет разработчикам определять и изменять процесс идентификации пользователя, внося лишь незначительные изменения в код или совсем не изменяя его.

Работа с потоками пользователей выполняется через простой интерфейс разработчика. Приложение запускает поток пользователя с помощью стандартного HTTP-запроса на проверку подлинности (передавая в запросе параметр потока пользователя) и в ответ получает настроенный токен. Например, единственное различие между запросами, которые вызывают поток пользователя регистрации, и запросами, которые вызывают поток пользователя входа, заключается в имени потока пользователя, которое используется в качестве строкового параметра "p" в запросе.

```

https://contosob2c.b2clogin.com/contosob2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e      // Your registered Application ID
&redirect_uri=https%3A%2F%2Flocalhost%3A44321%2F    // Your registered Reply URL, url encoded
&response_mode=form_post                            // 'query', 'form_post' or 'fragment'
&response_type=id_token
&scope=openid
&nonce=dummy
&state=12345                                        // Any value provided by your application
&p=b2c_1_siup                                       // Your sign-up user flow

```

```

https://contosob2c.b2clogin.com/contosob2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e      // Your registered Application ID
&redirect_uri=https%3A%2F%2Flocalhost%3A44321%2F    // Your registered Reply URL, url encoded
&response_mode=form_post                            // 'query', 'form_post' or 'fragment'
&response_type=id_token
&scope=openid
&nonce=dummy
&state=12345                                        // Any value provided by your application
&p=b2c_1_siin                                       // Your sign-in user flow

```

## <a name="create-a-sign-up-or-sign-in-user-flow"></a>Создание потока пользователя регистрации или входа в систему

Этот поток пользователя регулирует процедуры регистрации и входа в рамках одной конфигурации. Потребители проводятся через соответствующую процедуру (регистрации или входа в систему) в зависимости от контекста. В ней также описывается содержимое токенов, которые приложение будет получать при успешной регистрации или входе в систему.  Пример кода потока пользователя **регистрации или входа** см. [здесь](active-directory-b2c-devquickstarts-web-dotnet-susi.md).  Мы рекомендуем использовать этот поток пользователя вместо потока пользователя **регистрации** или **входа**.  

[!INCLUDE [active-directory-b2c-create-sign-in-sign-up-policy](../../includes/active-directory-b2c-create-sign-in-sign-up-policy.md)]

## <a name="create-a-sign-up-user-flow"></a>Создание потока пользователя регистрации

[!INCLUDE [active-directory-b2c-create-sign-up-policy](../../includes/active-directory-b2c-create-sign-up-policy.md)]

## <a name="create-a-sign-in-user-flow"></a>Создание потока пользователя входа

[!INCLUDE [active-directory-b2c-create-sign-in-policy](../../includes/active-directory-b2c-create-sign-in-policy.md)]

## <a name="create-a-profile-editing-user-flow"></a>Создание потока пользователя изменения профиля

[!INCLUDE [active-directory-b2c-create-profile-editing-policy](../../includes/active-directory-b2c-create-profile-editing-policy.md)]

## <a name="create-a-password-reset-user-flow"></a>Создание потока пользователя сброса пароля

[!INCLUDE [active-directory-b2c-create-password-reset-policy](../../includes/active-directory-b2c-create-password-reset-policy.md)]

## <a name="preview-user-flows"></a>Потоки пользователей предварительной версии

С выпуском новых функций некоторые из них могут быть недоступны в имеющихся политиках или потоках пользователей.  Мы планируем заменить старые версии на последнюю версию того же типа, как только появится общедоступная версия потоков пользователей.  Имеющиеся политики или потоки пользователей не изменятся. Чтобы воспользоваться преимуществами новых функций, необходимо создать потоки пользователей.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="how-do-i-link-a-sign-up-or-sign-in-user-flow-with-a-password-reset-user-flow"></a>Как связать поток пользователя регистрации или входа с потоком пользователя сброса паролей?
При создании потока пользователя **регистрации или входа** (с помощью локальных учетных записей) на первой странице отображается ссылка **Забыли пароль?**. При переходе по этой ссылке поток пользователя сброса паролей не активируется автоматически. 

Вместо этого в приложение возвращается код ошибки **`AADB2C90118`**. Приложение должно обработать этот код, вызвав определенный поток пользователя сброса паролей. Дополнительные сведения см. в [примере, демонстрирующем подход к связыванию потоков пользователей](https://github.com/AzureADQuickStarts/B2C-WebApp-OpenIDConnect-DotNet-SUSI).

### <a name="should-i-use-a-sign-up-or-sign-in-user-flow-or-a-sign-up-user-flow-and-a-sign-in-user-flow"></a>Что требуется использовать: поток пользователя регистрации или входа или отдельные поток пользователя регистрации и поток пользователя входа?
Рекомендуется использовать поток пользователя **регистрации или входа**, а не потоки пользователей **регистрации** и **входа**.  

Поток пользователя **регистрации или входа** обеспечивает больше возможностей, чем поток пользователя **входа**. Она также позволяет настраивать пользовательский интерфейс страницы и лучше поддерживает локализацию. 

Поток пользователя **входа** рекомендуется, если вам не нужно локализовать потоки пользователей либо если вам требуются ограниченные возможности для настройки фирменного оформления и встроенные возможности сброса паролей.

## <a name="next-steps"></a>Дополнительная информация
* [Настройка токена, сеанса и единого входа](active-directory-b2c-token-session-sso.md)
* [Azure Active Directory B2C: отключение проверки адреса электронной почты во время регистрации потребителя](active-directory-b2c-reference-disable-ev.md)

