---
title: Добавление поставщиков удостоверений OpenID Connect во встроенные политики — Azure AD B2C | Документация Майкрософт
description: Обзорное руководство по добавлению поставщиков OpenID Connect во встроенные политики в Azure AD B2C
services: active-directory-b2c
documentationcenter: ''
author: davidmu1
manager: mtillman
editor: parakhj
ms.assetid: 357d193a-e33b-469c-8a93-0a8f45a60a9f
ms.service: active-directory-b2c
ms.workload: identity
ms.topic: article
ms.date: 04/27/2018
ms.author: davidmu
ms.openlocfilehash: 46223f1ec6b82828983861dae26ec8d777b77b86
ms.sourcegitcommit: 6e43006c88d5e1b9461e65a73b8888340077e8a2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2018
ms.locfileid: "32308990"
---
# <a name="azure-active-directory-b2c-add-a-custom-openid-connect-identity-provider-in-built-in-policies"></a>Azure Active Directory B2C: добавление пользовательского поставщика удостоверений OpenID Connect во встроенные политики

>[!NOTE]
> Эта функция предоставляется в общедоступной предварительной версии. Ее не следует использовать в рабочих средах.

[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) — это протокол проверки подлинности на основе OAuth 2.0, который может использоваться для безопасного входа пользователей. Большинство поставщиков удостоверений, использующих этот протокол, например [Azure AD](active-directory-b2c-setup-oidc-azure-active-directory.md), поддерживаются в Azure AD B2C. В этой статье объясняется, как можно добавить во встроенные политики пользовательских поставщиков удостоверений OpenID Connect.

## <a name="configuring-a-custom-openid-connect-identity-provider"></a>Настройка пользовательского поставщика удостоверений OpenID Connect

Чтобы добавить пользовательского поставщика удостоверений OpenID Connect, сделайте следующее:

1. Следуя [эти инструкциям](active-directory-b2c-app-registration.md#navigate-to-b2c-settings), перейдите к настройкам Azure AD B2C на портале Azure.
1. Щелкните **Поставщики удостоверений**.
1. Щелкните **Добавить**.
1. В поле **Тип поставщика удостоверений** выберите **OpenID Connect**.

### <a name="setting-up-the-openid-connect-identity-provider"></a>Настройка поставщика удостоверений OpenID Connect

#### <a name="metadata-url"></a>URL-адрес метаданных

Для той или иной спецификации каждый поставщик удостоверений OpenID Connect описывает документ метаданных, который содержит большую часть сведений, необходимых для выполнения входа. Сюда входят такие сведения, как используемые URL-адреса и расположение открытых ключей подписывания службы. Документ метаданных OpenID Connect всегда находится в конечной точке, которая заканчивается на `.well-known\openid-configuration`.

Для поставщика удостоверений OpenID Connect, которого требуется добавить, введите его URL-адрес метаданных.

#### <a name="client-id-and-secret"></a>Идентификатор клиента и секрет

Чтобы разрешить пользователям выполнять вход, разработчики должны зарегистрировать приложение в своей службе, так как это требуется для поставщика удостоверений. Это приложение получит идентификатор (называемый **идентификатором клиента**) и **секрет клиента**. Скопируйте эти значения от поставщика удостоверений и введите их в соответствующие поля.

> [!NOTE]
> Секрет клиента не обязателен. Тем не менее, секрет клиента необходимо ввести, если требуется применить [последовательность с использованием кода авторизации](http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth), в которой секрет используется для обмена кода на маркер.

#### <a name="scope"></a>Область

Области определяют сведения и разрешения, которые требуется собрать от пользовательского поставщика удостоверений. Запросы OpenID Connect должны содержать значение области `openid`, чтобы получить маркер идентификатора от поставщика удостоверений. Без маркера идентификатора пользователи не смогут войти в Azure AD B2C с помощью пользовательского поставщика удостоверений.

Можно присоединить другие области (разделяемые пробелом). Сведения о том, какие другие области могут быть доступны, см. в документации пользовательского поставщика удостоверений.

#### <a name="response-type"></a>Тип ответа

Тип ответа описывает, какие сведения будут отправляться обратно в исходный вызов `authorization_endpoint` пользовательского поставщика удостоверений. 

* `code`: в соответствии с [последовательностью с использованием кода авторизации](http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth), код будет возвращаться обратно в Azure AD B2C. Azure AD B2C затем перейдет к вызову `token_endpoint` для обмена кода для маркера.
* `token`: маркер доступа будет возвращен обратно в Azure AD B2C от пользовательского поставщика удостоверений.
* `id_token`: маркер идентификатора будет возвращен обратно в Azure AD B2C от пользовательского поставщика удостоверений.


#### <a name="response-mode"></a>Режим ответа

Режим ответа позволяет определить метод, который следует использовать для отправки данных обратно от пользовательского поставщика удостоверений в Azure AD B2C.

* `form_post`: этот режим ответа рекомендуется использовать для максимальной безопасности. Ответ передается через HTTP-метод `POST` с кодом или маркером, закодированным в тексте с использованием формата `application/x-www-form-urlencoded`.
* `query`: код или маркер будет возвращен в виде параметра запроса.


#### <a name="domain-hint"></a>Указание домена

Используя указание домена, можно перейти непосредственно на страницу входа указанного поставщика удостоверений. Таким образом, пользователю не придется выбирать поставщика удостоверений из списка доступных. Чтобы разрешить такое поведение, введите значение для указания домена.

Чтобы перейти к пользовательскому поставщику удостоверений, добавьте параметр `domain_hint=<domain hint value>` в конец запроса при вызове Azure AD B2C для входа.


### <a name="mapping-the-claims-from-the-openid-connect-identity-provider"></a>Сопоставление утверждений от поставщика удостоверений OpenID Connect

После того как пользовательский поставщик удостоверений отправит маркер идентификатора обратно в службу Azure AD B2C, эта служба должна иметь возможность сопоставить утверждения из полученного маркера с утверждениями, которые Azure AD B2C распознает и использует. 

Ознакомьтесь со сведениями о каждом приведенном ниже сопоставлении в документации пользовательского поставщика удостоверений, чтобы понимать утверждения, которые возвращаются обратно в маркерах поставщика удостоверений.

* `User ID`: введите утверждение, которое предоставляет уникальный идентификатор для пользователя, выполнившего вход.
* `Display Name`: введите утверждение, которое предоставляет отображаемое имя или полное имя пользователя.
* `Given Name`: введите утверждение, которое предоставляет имя пользователя.
* `Surname`: введите утверждение, которое предоставляет фамилию пользователя.
* `Email`: введите утверждение, которое предоставляет адрес электронной почты пользователя.

## <a name="next-steps"></a>Дополнительная информация

Добавьте пользовательского поставщика удостоверений OpenID Connect во [встроенную политику](active-directory-b2c-reference-policies.md).
