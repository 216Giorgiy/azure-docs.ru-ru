<properties
	pageTitle="Предварительная версия Azure Active Directory B2C: вспомогательное средство для настройки пользовательского интерфейса страницы | Microsoft Azure"
	description="Вспомогательное средство, которое используется для демонстрации настройки пользовательского интерфейса страницы в Azure Active Directory B2C."
	services="active-directory-b2c"
	documentationCenter=""
	authors="swkrish"
	manager="msmbaldwin"
	editor="curtand"/>

<tags
	ms.service="active-directory-b2c"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="09/22/2015"
	ms.author="swkrish"/>

# Предварительная версия Azure Active Directory B2C: вспомогательное средство, используемое для демонстрации настройки пользовательского интерфейса страницы

Эта статья дополняет [основную статью о настройке пользовательского интерфейса](active-directory-b2c-reference-ui-customization.md) в Azure Active Directory B2C. Описанные ниже действия показывают, как работать с функцией настройки пользовательского интерфейса страницы, на основе предоставленного нами образца HTML и CSS-содержимого.

[AZURE.INCLUDE [active-directory-b2c-preview-note](../../includes/active-directory-b2c-preview-note.md)]

## Получение клиента B2C

Прежде чем выполнять какую-либо настройку, необходимо [получить клиент Azure AD B2C](active-directory-b2c-get-started.md) (если у вас еще нет его).

## Создание политики регистрации

Предоставленный нами образец содержимого настраивает две страницы в [политике регистрации](active-directory-b2c-reference-policies.md#how-to-create-a-sign-up-policy): [страницу выбора удостоверений](active-directory-b2c-reference-ui-customization.md#identity-provider-selection-page) и [страницу регистрации локальной учетной записи](active-directory-b2c-reference-ui-customization.md#local-account-sign-up-page). При [создании политики регистрации](active-directory-b2c-reference-policies.md#how-to-create-a-sign-up-policy) добавьте в качестве **поставщиков удостоверений** локальную учетную запись (адрес электронной почты), Facebook и Google+. Наш образец HTML-содержимого принимает только этих поставщиков удостоверений.

## Регистрация приложения

Вам потребуется [зарегистрировать](active-directory-b2c-app-registration.md) приложение в клиенте B2C, который можно использовать для выполнения вашей политики. После этого вы получите несколько опций, которые можно будет использовать для выполнения вашей политики регистрации:

- Собрать одно из приложений быстрого запуска Azure AD B2C, перечисленных [здесь](active-directory-b2c-overview.md#getting-started).
- Использовать предварительно построенное приложение [площадки Azure AD B2C](https://aadb2cplayground.azurewebsites.net). В этом случае вам придется зарегистрировать приложение в клиенте B2C, используя **URI перенаправления** `https://aadb2cplayground.azurewebsites.net/`.
- Использовать кнопку **Выполнить** в политике на [портале предварительной версии Azure](https://portal.azure.com).

## Настройка политики

Для настройки внешнего вида и поведения политик необходимо в первую очередь создать файлы HTML и CSS, используя определенные соглашения Azure AD B2C. Затем вы сможете загрузить статическое содержимое в общедоступное место, сделав его доступным для Azure AD B2C. Это может быть ваш собственный выделенный веб-сервер, хранилище больших двоичных объектов Azure, Azure CDN или любой другой поставщик хостинга статических ресурсов. Единственное требование — это возможность получения доступа к содержимому по протоколу HTTPS или с помощью CORS. Переместив статическое содержимое в сеть, вы сможете изменить политику таким образом, чтобы она указывала на это место и предоставляла содержимое конечным пользователям. В [основной статье о настройке пользовательского интерфейса](active-directory-b2c-reference-ui-customization.md) подробно описано, как работает функция настройки Azure AD B2C.

В контексте этого руководства мы уже создали образец содержимого и разместили его в хранилище больших двоичных объектов Azure. Пример содержимого — это самая базовая настройка в теме нашей вымышленной компании Contoso B2C. Чтобы опробовать его в вашей собственной политике, выполните описанные ниже действия.

1. Войдите в свой клиент на [портале предварительной версии Azure](https://portal.azure.com) и откройте колонку функций B2C.
2. Щелкните **Политики регистрации** и выберите свою политику (например, b2c\_1\_sign\_up).
3. Последовательно выберите пункты **Настройка пользовательского интерфейса страницы** и **Страница выбора поставщика удостоверений**.
4. Установите переключатель **Использовать настраиваемый шаблон** в положение **Да**. В поле **URI пользовательской страницы** введите `https://contosob2c.blob.core.windows.net/static/Index.html`. Нажмите кнопку **ОК**.
5. Щелкните **страницу регистрации локальной учетной записи**. Установите переключатель **Использовать настраиваемый шаблон** в положение **Да**. В поле **URI пользовательской страницы** введите `https://contosob2c.blob.core.windows.net/static/EmailVerification.html`. Дважды нажмите кнопку **ОК**, чтобы закрыть колонки настройки пользовательского интерфейса.
6. Щелкните **Сохранить**.

Теперь можно испытать настраиваемую политику в деле. При желании можете использовать собственное приложение или площадку AAD B2C либо просто нажмите кнопку **Выполнить сейчас** в колонке политики. Выберите в раскрывающемся списке приложение и соответствующий URI перенаправления. Нажмите кнопку **Выполнить сейчас**. Откроется новая вкладка браузера, и вы сможете зарегистрировать пользователя в приложении, в котором уже есть новое содержимое.

## Передача образцов содержимого в хранилище больших двоичных объектов Azure

Если вы хотите разместить содержимое страницы в хранилище больших двоичных объектов Azure, создайте собственную учетную запись хранения и загрузите файлы с помощью вспомогательного средства B2C.

#### Создание учетной записи хранения

1. Выполните вход на [портал предварительной версии Azure](https://portal.azure.com/).
2. Последовательно выберите пункты **+ Создать** -> **Данные + хранилище** -> **Учетная запись хранения**. Для создания учетной записи хранения больших двоичных объектов Azure требуется подписка Azure. Бесплатную пробную версию можно загрузить [здесь](https://azure.microsoft.com/ru-RU/pricing/free-trial/).
3. Введите **имя** учетной записи хранения (например, contoso) и выберите соответствующие значения для параметров **Ценовая категория**, **Группа ресурсов** и **Подписка**. Убедитесь, что флажок **Закрепить на начальной панели** установлен. Щелкните **Создать**.
4. Вернитесь на начальную панель и щелкните только что созданную учетную запись хранения.
5. В разделе **Сводка** щелкните **Контейнеры** и **+ Добавить**.
6. Введите **имя** контейнера (например, b2c) и для параметра **Тип доступа** выберите значение **Большой двоичный объект**. Нажмите кнопку **ОК**.
7. Созданный контейнер появится в списке в колонке **Большие двоичные объекты**. Запишите URL-адрес контейнера. Он может выглядеть так: `https://contoso.blob.core.windows.net/b2c`. Закройте колонку **Большие двоичные объекты**.
8. В колонке учетной записи хранения щелкните **Ключи** и запишите значения полей **Имя учетной записи хранения** и **Первичный ключ доступа**.

> [AZURE.NOTE]**Первичный ключ доступа** — важная составляющая системы безопасности.

#### Загрузка вспомогательного средства и образцы файлов

Вы можете скачать [ вспомогательное средство хранилища больших двоичных объектов Azure и примеры файлов в виде ZIP-архива здесь](https://github.com/azureadquickstarts/b2c-azureblobstorage-client/archive/master.zip) или клонировать его из GitHub.

```
git clone https://github.com/azureadquickstarts/b2c-azureblobstorage-client
```

Этот репозиторий включает каталог `sample_templates\contoso`, который содержит пример HTML- и CSS-кода и изображений. Для того чтобы эти шаблоны ссылались именно на вашу учетную запись в хранилище больших двоичных объектов Azure, необходимо изменить HTML-файлы. Откройте `Index.htnml` и `EmailValidation.html` и замените все экземпляры `https://localhost` на URL-адрес вашего контейнера, скопированный ранее. Используйте абсолютный путь к HTML-файлам, так как в этом случае Azure AD будет обслуживать HTML в домене `https://login.microsoftonline.com`.

#### Загрузка образцов файлов

В том же репозитории распакуйте `B2CAzureStorageClient.zip` и запустите файл `B2CAzureStorageClient.exe` из этого архива. Эта программа просто загружает все файлы в каталог, указанный в вашей учетной записи хранения, и обеспечивает доступ к этим файлам с помощью CORS. Если вы выполнили описанные выше шаги, HTML и CSS-файлы будут указывать на учетную запись хранения. Обратите внимание, что имя вашей учетной записи хранения представляет собой часть, предшествующую `blob.core.windows.net`, например `contoso`. Вы можете проверить, что содержимое отправлено правильно, попробовав получить доступ к `https://{storage-account-name}.blob.core.windows.net/{container-name}/Index.html` в браузере. Кроме того, перейдите на веб-сайт [http://test-cors.org/](http://test-cors.org/) и проверьте, включен ли для содержимого CORS (найдите в результате строку "Состояние XHR: 200").

#### Повторная настройка политики

Теперь, когда образец содержимого загружен в свою учетную запись хранения, политику регистрации нужно изменить таким образом, чтобы она ссылалась на этот образец. Повторите действия из приведенного выше раздела [Настройка политики](#customize-your-policy), но на этот раз используйте URL-адреса вашей учетной записи хранения. Например, файл `Index.html` будет расположен по адресу `<url-of-your-container>/Index.html`.
        
Теперь еще раз запустите политику с помощью кнопки **Запустить** или вашего приложения. Результат выглядит практически так же, поскольку в обоих случаях использовался один и тот же образец HTML- и CSS-кода. Однако теперь политики ссылаются на наш собственный экземпляр хранилища больших двоичных объектов Azure, а значит, вы можете спокойно редактировать и перезагружать файлы. Дополнительные сведения о настройке HTML- и CSS-кода см. в [статье о настройке основного пользовательского интерфейса](active-directory-b2c-reference-ui-customization.md).

<!---HONumber=Oct15_HO1-->