---
title: "Azure Active Directory B2C. Настройка пользовательского интерфейса с помощью настраиваемых политик | Документация Майкрософт"
description: "В этой статье описывается настройка пользовательского интерфейса c использованием настраиваемых политик в Azure AD B2C."
services: active-directory-b2c
documentationcenter: 
author: saeeda
manager: krassk
editor: gsacavdm
ms.assetid: 658c597e-3787-465e-b377-26aebc94e46d
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.topic: article
ms.devlang: na
ms.date: 04/04/2017
ms.author: saeeda
ms.translationtype: Human Translation
ms.sourcegitcommit: 125f05f5dce5a0e4127348de5b280f06c3491d84
ms.openlocfilehash: 9de6a57671cf65c4aa5d8695d21e0932175b1183
ms.contentlocale: ru-ru
ms.lasthandoff: 05/22/2017

---
# <a name="azure-active-directory-b2c-ui-customization-in-a-custom-policy"></a>Azure Active Directory B2C. Настройка пользовательского интерфейса в настраиваемой политике

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

Выполнив инструкции из этой статьи, вы получите настраиваемую политику регистрации и входа с фирменной символикой и оформлением.  Azure AD B2C обеспечивает практически полный контроль над HTML и CSS, представленных пользователю.  При использовании настраиваемой политики настройка пользовательского интерфейса выполняется в XML-файле, а не с помощью элементов управления на портале Azure.

## <a name="prerequisites"></a>Предварительные требования

Прежде чем продолжить, необходимо ознакомиться со статьей [Azure Active Directory B2C. Приступая к работе с настраиваемыми политиками](active-directory-b2c-get-started-custom.md).  Для регистрации и входа с использованием локальных учетных записей необходимо иметь рабочую настраиваемую политику.

## <a name="the-page-ui-customization-feature"></a>Возможность настройки пользовательского интерфейса

С помощью функции настройки пользовательского интерфейса страницы можно настроить оформление любой настраиваемой политики.  Обеспечьте целостность фирменной символики и визуализации приложения и службы Azure AD B2C.

Вот как это работает. Служба Azure AD B2C выполняет код в браузере пользователя и использует современный метод, который называется [общим доступом к ресурсам независимо от источника (CORS)](http://www.w3.org/TR/cors/).  Сначала необходимо указать URL-адрес в настраиваемой политике с настраиваемым содержимым HTML.  Azure AD B2C объединяет элементы пользовательского интерфейса с содержимым HTML, загруженным из URL-адреса, и отображает страницу для пользователя.

## <a name="creating-your-html5-content"></a>Создание содержимого HTML5

Давайте создадим содержимое HTML с названием марки продукта в заголовке.

1. Щелкните **Копировать** во фрагменте кода HTML.  Это корректное содержимое HTML5 с пустым элементом `<div id="api"></div>` в разделе `<body>`. Этот элемент обозначает место, в которое будет добавляться содержимое Azure AD B2C.

   ```html
   <!DOCTYPE html>
   <html>
   <head>
       <title>My Product Brand Name</title>
   </head>
   <body>
       <div id="api"></div>
   </body>
   </html>
   ```

1. Вставьте содержимое в текстовый редактор и сохраните файл как `customize-ui.html`.

## <a name="create-a-blob-storage-account"></a>Создание учетной записи хранения больших двоичных объектов

>[!NOTE]
> В этом руководстве мы используем хранилище BLOB-объектов Azure для размещения содержимого.  Вы также можете разместить содержимое на веб-сервере, но на нем необходимо [включить общий доступ к ресурсам независимо от источника (CORS)](https://enable-cors.org/server.html).

Давайте разместим это HTML-содержимое в хранилище BLOB-объектов Azure.

1. Выполните вход на [портал Azure](https://portal.azure.com).
1. В меню концентратора выберите **Создать** -> **Хранилище** -> **Учетная запись хранения**.
1. Введите уникальное **имя** учетной записи хранения.
1. Задайте для параметра **Модель развертывания** значение **Resource Manager**.
1. Измените **тип учетной записи** на **хранилище BLOB-объектов**.
1. Задайте для параметра **Производительность** значение **Стандартный**.
1. Задайте для параметра **Репликация** значение **RA-GRS**.
1. Задайте для параметра **Уровень доступа** значение **Горячий**,
1. а для параметра **Шифрование службы хранилища** — **Отключено**.
1. Выберите **подписку** для вашей учетной записи хранения.
1. Создайте **группу ресурсов** или выберите имеющуюся.
1. Выберите **географический регион** для учетной записи хранения.
1. Щелкните **Создать** , чтобы создать учетную запись хранения.
1. Дождитесь завершения развертывания, и колонка учетной записи хранения откроется автоматически.

## <a name="create-a-container"></a>Создание контейнера

Давайте создадим общедоступный контейнер в хранилище BLOB-объектов Azure.

1. Перейдите на вкладку **Обзор** слева.
1. Щелкните **+ Container** (+ Контейнер).
1. В поле **Имя** введите `$root`.
1. Задайте для параметра **Тип доступа** значение **BLOB-объект**.
1. Щелкните $root, чтобы открыть новый контейнер.
1. Щелкните **Отправить**.
1. Щелкните значок папки рядом с `Select a file`.
1. Перейдите к файлу `customize-ui.html`, созданному в [предыдущем разделе](#the-page-ui-customization-feature).
1. Щелкните **Отправить**.
1. Выберите отправленный большой двоичный объект с именем `customize-ui.html`.
1. Нажмите кнопку "Копировать" рядом с полем **URL-адрес**.
1. Откройте браузер и перейдите по URL-адресу.  Если он недоступен, убедитесь, что для типа доступа контейнера установлено значение "BLOB-объект".

## <a name="configure-cors"></a>Настройка CORS

Теперь мы настроим хранилище BLOB-объектов Azure для общего доступа к ресурсам независимо от источника (CORS).

>[!NOTE]
>Хотите протестировать функцию настройки пользовательского интерфейса с помощью примера содержимого HTML и CSS?  Используйте [простое вспомогательное средство](active-directory-b2c-reference-ui-customization-helper-tool.md) для отправки и настройки примера содержимого в учетной записи хранилища BLOB-объектов Azure.  Если вы используете это средство, перейдите к разделу об [изменении настраиваемой политики регистрации или входа](#modify-your-sign-up-or-sign-in-custom-policy).

1. В колонке хранилища в разделе "Параметры" откройте **CORS**.
1. Щелкните **+ Добавить**.
1. Задайте для параметра `Allowed origins` значение `*`.
1. В раскрывающемся списке `Allowed verbs` выберите `GET` и `OPTIONS`.
1. Задайте для параметра `Allowed headers` значение `*`.
1. Задайте для параметра `Exposed headers` значение `*`.
1. Задайте для параметра `Maximum age (seconds)` значение `200`.
1. Щелкните **Добавить**.

## <a name="testing-cors"></a>Тестирование CORS

Давайте проверим, можно ли приступить к работе.

1. Перейдите на страницу http://test-cors.org/ и вставьте URL-адрес в поле `Remote URL`.
1. Щелкните **Отправить запрос**.
1. Если произошла ошибка, проверьте правильность [параметров CORS](#configure-cors).  Вам также понадобится очистить кэш браузера или использовать закрытый сеанс просмотра (`CTRL-SHIFT-P`).

## <a name="modify-your-sign-up-or-sign-in-custom-policy"></a>Изменение настраиваемой политики регистрации или входа

1. В теге верхнего уровня `<TrustFrameworkPolicy>` найдите тег `<BuildingBlocks>`.  В теге `<BuildingBlocks>` добавьте тег `ContentDefinitions`, скопировав этот пример.  Замените `{your_storage_account}` именем своей учетной записи хранения.

  ```xml
  <BuildingBlocks>
    <ContentDefinitions>
      <ContentDefinition Id="api.idpselections">
        <LoadUri>https://{your_storage_account}.blob.core.windows.net/customize-ui.html</LoadUri>
      </ContentDefinition>
    </ContentDefinitions>
  </BuildingBlocks>
  ```

## <a name="upload-your-updated-custom-policy"></a>Отправка обновленной настраиваемой политики

1. На [портале Azure](https://portal.azure.com) [переключитесь в контекст клиента Azure AD B2C](active-directory-b2c-navigate-to-b2c-context.md) и откройте колонку Azure AD B2C.
1. Щелкните **Все политики**.
1. Выберите **Отправить политику**.
1. Отправьте файл `SignUpOrSignin.xml` с добавленным тегом `ContentDefinitions`.

## <a name="test-the-custom-policy-using-run-now"></a>Тестирование настраиваемой политики с помощью параметра "Запустить сейчас"

1. Откройте **колонку Azure AD B2C** и щелкните **Все политики**.
1. Выберите отправленную вами настраиваемую политику и нажмите кнопку **Запустить сейчас**.
1. Вы сможете зарегистрироваться, используя адрес электронной почты.

## <a name="next-steps"></a>Дальнейшие действия

Это [справочное руководство по настройке пользовательского интерфейса для встроенных политик](active-directory-b2c-reference-ui-customization.md) содержит дополнительные сведения о настройке элементов пользовательского интерфейса.  Пользовательский интерфейс настраивается одинаково как для встроенных, так и для настраиваемых политик.

