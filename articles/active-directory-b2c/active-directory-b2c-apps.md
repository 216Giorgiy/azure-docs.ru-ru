<properties
	pageTitle="Предварительная версия Azure AD B2C | Microsoft Azure"
	description="Типы приложений, которые можно создавать в предварительной версии Azure AD B2C."
	services="active-directory-b2c"
	documentationCenter=""
	authors="dstrockis"
	manager="msmbaldwin"
	editor=""/>

<tags
	ms.service="active-directory-b2c"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="09/04/2015"
	ms.author="dastrock"/>

# Предварительная версия Azure AD B2C: типы приложений

Azure AD B2C поддерживает проверку подлинности для различных архитектур современных приложений, которые основаны на стандартных отраслевых протоколах [OAuth 2.0](active-directory-b2c-reference-protocols.md) и [OpenID Connect](active-directory-b2c-reference-protocols.md). В этом документе кратко описаны типы приложений, которые можно создавать независимо от используемого языка или платформы. Он поможет вам изучить базовые сценарии, прежде чем [перейти непосредственно к коду](active-directory-b2c-overview.md#getting-started).

[AZURE.INCLUDE [active-directory-b2c-preview-note](../../includes/active-directory-b2c-preview-note.md)]

## Основы
Каждое приложение, использующее Azure AD B2C, потребуется зарегистрировать для использования вашего [каталога B2C](https://portal.azure.com) на [портале предварительной версии Azure](active-directory-b2c-get-started.md). В процессе регистрации для приложения будет собрано и назначено несколько значений:

- **Идентификатор приложения**, определяющий конкретное приложение.
- **Универсальный код ресурса (URI) перенаправления**, который можно использовать для направления ответов к приложению.
- Несколько других зависящих от сценария значений. Вы можете подробнее узнать о процедуре [регистрации приложения](active-directory-b2c-app-registration.md).

После регистрации приложение взаимодействует с Azure AD, отправляя запросы к конечной точке версии Azure AD версии 2.0.

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize
https://login.microsoftonline.com/common/oauth2/v2.0/token
```

Каждый запрос, отправленный в Azure AD B2C, определяет какую-либо **политику**. Политика управляет поведением Azure AD и позволяет использовать эти конечные точки для создания настраиваемого набора пользовательских интерфейсов. В число распространенных политик входят политики регистрации, входа и редактирования профилей. Если вы не знакомы с политиками, прежде чем продолжить изучение данной статьи, прочтите о [платформе расширяемых политик](active-directory-b2c-reference-policies.md) Azure AD B2C.

Каждое взаимодействие приложения с конечной точкой версии 2.0 будет использовать аналогичный высокоуровневый шаблон.

1. Приложение направляет конечного пользователя в конечную точку версии 2.0 для выполнения [политики](active-directory-b2c-reference-policies.md).
2. Пользователь выполняет политику в соответствии с ее определением.
4. Приложение получает определенный токен безопасности от конечной точки версии 2.0.
5. Приложение использует токен безопасности для доступа к защищенной информации или ресурсу.
6. Сервер ресурсов проверяет токен безопасности для подтверждения того, что доступ может быть предоставлен.
7. Приложение периодически обновляет токен безопасности.

<!-- TODO: Need a page for libraries to link to -->
Каждый из этих шагов будет немного отличаться в зависимости от типа приложения, которое вы создаете. Мы предоставляем библиотеки с открытым исходным кодом, которые освободят вас от необходимости вникать в подробности.

## Веб-приложения
Azure AD B2C позволяет веб-приложениям (.NET, PHP, Java, Ruby, Python, Node и т. д.), размещенным на сервере и используемым через браузер, использовать [OpenID Connect](active-directory-b2c-reference-protocols.md) для всех действий пользователя, включая вход в систему, регистрацию и управление профилем. В реализации OpenID Connect в Azure AD B2C веб-приложение запускает соответствующие пользовательские интерфейсы, отправляя запросы проверки подлинности в Azure AD. Результатом запроса является `id_token` — маркер безопасности, который предоставляет удостоверение пользователя и сведения о пользователе в форме утверждений.

```
// Partial raw id_token
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImtyaU1QZG1Cd...

// Partial content of a decoded id_token
{
	"name": "John Smith",
	"email": "john.smith@gmail.com",
	"oid": "d9674823-dffc-4e3f-a6eb-62fe4bd48a58"
	...
}
```

Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам B2C](active-directory-b2c-reference-tokens.md).

В веб-приложениях выполнение любой [политики](active-directory-b2c-reference-policies.md) включает следующие действия верхнего уровня.

![Изображение веб-приложения Swimlanes](./media/active-directory-b2c-apps/webapp.png)

Проверки маркера идентификатора с помощью открытого ключа подписи, полученного от Azure AD, достаточно для проверки удостоверения пользователя, а также задания файла cookie сеанса, который может использоваться для идентификации пользователя в последующих запросах страницы.

Чтобы увидеть этот сценарий в действии, изучите один из примеров кода входа веб-приложения из раздела [Приступая к работе](active-directory-b2c-overview.md#getting-started).

Помимо простого входа в систему, приложению веб-сервера может потребоваться доступ к некоторым серверным веб-службам. В этом случае веб-приложение может выполнять несколько иной [поток OpenID Connect](active-directory-b2c-reference-oidc.md) и получать маркеры, используя коды авторизации и маркеры обновления. Этот сценарий представлен ниже в разделе [Веб-API](#web-apis).

<!--, and in our [WebApp-WebAPI Getting Started topic](active-directory-b2c-devquickstarts-web-api-dotnet.md).-->

## Веб-API
Azure AD B2C может также служить для защиты веб-служб, таких как веб-интерфейс API RESTful приложения. Веб-API может использовать OAuth 2.0 для защиты данных и проверять подлинность входящих HTTP-запросов с помощью маркеров. Объект, вызывающий веб-API, добавляет маркер в начале заголовка авторизации HTTP-запроса.

```
GET /api/items HTTP/1.1
Host: www.mywebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6...
Accept: application/json
...
```

Веб-API может использовать маркер для проверки удостоверения объекта, вызывающего API, и получения сведений о нем из утверждений, которые закодированы в маркере. Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам Azure AD B2C](active-directory-b2c-reference-tokens.md).

> [AZURE.NOTE]Предварительная версия Azure AD B2C в настоящее время поддерживает только веб-API, используемые собственными, известными клиентами. Например, готовое приложение может включать приложение iOS, приложение Android и веб-API серверной части. Такая архитектура поддерживается полностью. Что не поддерживается, так это предоставление доступа к тому же веб-API стороннему клиенту, например другому приложению iOS. В связи с этим у всех компонентов готового приложения должен быть один и тот же идентификатор приложения.

Веб-API может получать маркеры от всех типов клиентов, включая веб-приложения, классические и мобильные приложения, одностраничные приложения, серверные управляющие программы и даже другие веб-API. В качестве примера рассмотрим полный поток веб-приложения, вызывающего веб-API.

![Изображение веб-API веб-приложения Swimlanes](./media/active-directory-b2c-apps/webapi.png)

Дополнительные сведения о кодах авторизации, маркерах обновления, а также подробные инструкции о получении маркеров см. в описании [протокола OAuth 2.0](active-directory-b2c-reference-oauth-code.md).

Информацию о защите веб-API с помощью Azure AD B2C см. в учебниках по веб-API, указанных в разделе [Начало работы](active-directory-b2c-overview.md#getting-started).
	
## Мобильные и собственные приложения
Приложениям, установленным на устройстве, например мобильным и классическим приложениям, часто требуется доступ к внутренним службам или веб-API от имени пользователя. Добавить в собственные приложения настраиваемый интерфейс управления удостоверениями и обеспечить безопасный вызов серверных служб можно с помощью Azure AD B2C и [потока кода авторизации OAuth 2.0](active-directory-b2c-reference-oauth-code.md).

В этом потоке приложение выполняет [политики](active-directory-b2c-reference-policies.md) и получает код авторизации из Azure AD, когда пользователь завершает политику. Код авторизации означает, что приложение разрешает вызов серверных служб от имени пользователя, выполнившего вход в систему. Приложение может также передавать код авторизации в фоновом режиме для получения маркера идентификатора и маркера обновления. Приложение может использовать маркер идентификатора для проверки подлинности серверного веб-API в HTTP-запросах, а маркер обновления — для получения новых маркеров идентификатора после того, как срок действия старых закончится.

> [AZURE.NOTE]В настоящее время предварительная версия Azure AD B2C поддерживает только получение маркеров идентификатора, которые используются для доступа к собственной серверной веб-службе приложения. Например, готовое приложение может включать приложение iOS, приложение Android и веб-API серверной части. Такая архитектура поддерживается полностью. Что не поддерживается, так это предоставление приложению iOS доступа к стороннему веб-API по маркерам доступа OAuth 2.0. В связи с этим у всех компонентов готового приложения должен быть один и тот же идентификатор приложения.

![Изображение собственного приложения Swimlanes](./media/active-directory-b2c-apps/native.png)

## Текущие ограничения предварительной версии
Эти типы приложений пока не поддерживаются предварительной версией Azure AD B2C, но мы планируем добавить их поддержку после выхода общедоступной версии. Другие ограничения предварительной версии Azure AD B2C описаны в [этой статье](active-directory-b2c-limitations.md).

### Одностраничные приложения (Javascript)
Многие современные приложения применяют одностраничный интерфейсный модуль, написанный в основном на Javascript и часто использующий платформы SPA, такие как AngularJS, Ember.js, Durandal и т. д. Общедоступная служба Azure AD поддерживает такие приложения с помощью неявного потока OAuth 2.0, однако в Azure AD B2C этот поток пока недоступен. В скором будущем его поддержка будет добавлена.

### Управляющие программы и серверные приложения
Приложениям, содержащим долговременные процессы или работающим без пользователя, также нужна возможность доступа к защищенным ресурсам, таким как веб-API. Такие приложения могут проверять подлинность и получать маркеры, используя удостоверение приложения (а не удостоверение делегированного пользователя) с помощью потока учетных данных клиента OAuth 2.0.

В настоящее время Azure AD B2C не поддерживает этот поток, то есть приложения могут получать маркеры только после завершения интерактивного потока пользователя. Поток клиентских учетных данных будет добавлен в ближайшем будущем.

### Цепочки веб-API (On-Behalf-Of)
Многие архитектуры включают в себя веб-API, которым требуется вызывать другой подчиненный веб-API. При этом оба интерфейса защищены с помощью Azure AD. Этот сценарий характерен для собственных клиентов с внутренним веб-API, который в свою очередь вызывает службу Microsoft Online, например API Graph Azure AD.

Сценарий связанных веб-API может поддерживаться с помощью предоставления учетных данных носителя маркера JWT OAuth 2.0 или потока On-Behalf-Of. Однако в предварительной версии Azure AD B2C поток On-Behalf-Of еще не реализован.

<!---HONumber=Sept15_HO3-->