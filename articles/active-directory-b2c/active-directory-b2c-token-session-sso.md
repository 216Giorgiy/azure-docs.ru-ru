---
title: Настройка токена, сеанса и единого входа в Azure Active Directory B2C | Документация Майкрософт
description: Конфигурация токена, сеанса и единого входа в Azure Active Directory B2C.
services: active-directory-b2c
author: davidmu1
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 08/16/2017
ms.author: davidmu
ms.component: B2C
ms.openlocfilehash: 0058ce8316fa8202cf53eaa1048a44b77efdecb5
ms.sourcegitcommit: 00dd50f9528ff6a049a3c5f4abb2f691bf0b355a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/05/2018
ms.locfileid: "51012451"
---
# <a name="token-session-and-single-sign-on-configuration-in-azure-active-directory-b2c"></a>Конфигурация токена, сеанса и единого входа в Azure Active Directory B2C

Эта возможность обеспечивает более точный контроль указанных далее параметров, осуществляемый [для каждой политики](active-directory-b2c-reference-policies.md).

- Время существования маркеров безопасности, выдаваемых Azure Active Directory (Azure AD) B2C.
- Время существования сеансов веб-приложения, управляемых Azure AD B2C.
- Форматы важных утверждений в маркерах безопасности, создаваемых Azure AD B2C.
- Поведение единого входа (SSO) в нескольких приложениях и политиках в клиенте Azure AD B2C.

Для встроенных политик можно использовать эту функцию в каталоге Azure AD B2C следующим образом:

1. Щелкните **Sign-up or sign-in policies**(Политики регистрации или входа в систему). *Примечание. Эту функцию можно использовать с любым типом политики, а не только с **политиками входа или регистрации*\*\*.
2. Откройте политику, щелкнув ее. Например, щелкните **B2C_1_SiUpIn**.
3. Щелкните **Изменить** в верхней части меню.
4. Щелкните **Конфигурация маркера, сеанса и единого входа**.
5. Внесите нужные изменения. Сведения о доступных свойствах см. в последующих разделах.
6. Последовательно выберите **ОК**.
7. Нажмите кнопку **Сохранить** в верхней части меню.

## <a name="token-lifetimes-configuration"></a>Конфигурация времени существования маркеров

Azure AD B2C поддерживает [протокол авторизации OAuth 2.0](active-directory-b2c-reference-protocols.md) для включения безопасного доступа к защищенным ресурсам. Для реализации этой поддержки Azure AD B2C выдает различные [маркеры безопасности](active-directory-b2c-reference-tokens.md). 

Для управления временем существования маркеров безопасности, выдаваемых Azure AD B2C, используются следующие свойства.

- **Время существования маркера доступа и маркера идентификатора (в минутах)**. Время существования маркера носителя OAuth 2.0, используемого для получения доступа к защищенному ресурсу.
    - Значение по умолчанию — 60 минут.
    - Минимум (включительно) — 5 минут.
    - Максимум (включительно) — 1440 минут.
- **Время существования маркера обновления (в днях)**. Максимальный период времени, до наступления которого маркер обновления может использоваться для получения нового маркера доступа или маркера идентификатора (и при необходимости для получения нового маркера обновления, если приложению была предоставлена область `offline_access`).
    - Значение по умолчанию — 14 дней.
    - Минимум (включительно) — 1 день.
    - Максимум (включительно) — 90 дней.
- **Скользящее время существования маркера обновления (в днях)**. По истечении этого периода времени пользователь должен будет повторно пройти проверку подлинности независимо от срока действия самого последнего маркера обновления, полученного приложением. Он предоставляется, только если установлен переключатель **Ограничено**. Значение должно быть больше или равно значению **времени существования маркера обновления (в днях)**. Если установлен переключатель **Не ограничено**, указать конкретное значение нельзя.
    - Значение по умолчанию — 90 дней.
    - Минимум (включительно) — 1 день.
    - Максимум (включительно) — 365 дней.

Если использовать свойства, которые приведены ниже, будут включены следующие варианты использования.

- Предоставление пользователю возможности находиться в мобильном приложении сколь угодно долго до тех пор, пока он активно его использует. Можно установить переключатель **Скользящее время существования маркера обновления (в днях)** в положение **Не ограничено**.
- Обеспечение соответствия нормам и требованиям безопасности путем задания соответствующих значений времени существования маркера доступа.

Эти параметры недоступны для политик сброса пароля. 

## <a name="token-compatibility-settings"></a>Параметры маркеров совместимости

Чтобы разрешить клиентам что-либо настраивать (по их требованию), воспользуйтесь следующими свойствами.

- **Утверждение издателя (iss)**. Это свойство определяет клиента Azure AD B2C, выдавшего маркер.
    - `https://<domain>/{B2C tenant GUID}/v2.0/`. Это значение по умолчанию.
    - `https://<domain>/tfp/{B2C tenant GUID}/{Policy ID}/v2.0/`. Это значение включает идентификаторы для клиента B2C и политики, используемых в запросе маркера. Если приложению или библиотеке требуется Azure AD B2C для соответствия [спецификации OpenID Connect Discovery 1.0](http://openid.net/specs/openid-connect-discovery-1_0.html), используйте это значение.
- **Утверждение субъекта (sub)**. Это свойство определяет сущность, для которой маркер подтверждает информацию.
    - **ObjectID**. Значение этого свойства является значением по умолчанию. Добавляет идентификатор объекта пользователя из каталога в утверждение `sub` в маркере.
    - **Не поддерживается**. Это свойство указывается только для обратной совместимости. Мы рекомендуем переключиться на свойство **ObjectID**, как только это станет возможно.
- **Идентификатор политики, представляющей утверждения** Это свойство определяет тип утверждения, в котором заполняется идентификатор политики, используемый в запросе маркера.
    - **tfp**. Значение этого свойства является значением по умолчанию.
    - **acr**. Это свойство указывается только для обратной совместимости.

## <a name="session-behavior"></a>Режим работы сеанса

Azure AD B2C поддерживает [протокол проверки подлинности OpenID Connect](active-directory-b2c-reference-oidc.md) для включения безопасного входа в веб-приложения. Следующие свойства можно использовать для управления сеансами веб-приложения.

- **Время существования сеанса веб-приложения (в минутах)**. Время существования файла cookie сеанса Azure AD B2C, сохраненного в браузере пользователя после успешной проверки подлинности.
    - Значение по умолчанию — 1440 минут.
    - Минимум (включительно) — 15 минут.
    - Максимум (включительно) — 1440 минут.
- **Время ожидания сеанса веб-приложения**. Если этот переключатель установлен в положение **Абсолютное**, пользователь вынужден повторно пройти проверку подлинности по истечении периода времени, заданного параметром **Время существования сеанса веб-приложения (в минутах)**. Если этот переключатель установлен в положение **Скользящее** (по умолчанию), пользователь может находиться в веб-приложении сколь угодно долго до тех пор, пока он активно его использует.

Если использовать свойства, которые приведены ниже, будут включены следующие варианты использования.

- Обеспечение соответствия нормам и требованиям безопасности путем задания соответствующих значений времени существования сеанса веб-приложения.
- Применение принудительной проверки подлинности по истечении заданного периода во время взаимодействия пользователя с высокозащищенной частью веб-приложения. 

Эти параметры недоступны для политик сброса пароля.

## <a name="single-sign-on-sso-configuration"></a>Конфигурация единого входа (SSO)

Если в клиенте B2C существует несколько приложений и политик, для управления взаимодействиями пользователей с ними можно использовать свойство **Конфигурация единого входа** . Этому свойству можно задать одно из указанных далее значений.

- **Клиент**. Это значение по умолчанию. Если выбрано это значение, несколько приложений и политик в клиенте B2C могут совместно использовать один и тот же сеанс пользователя. Например, когда пользователь входит в приложение, он также может легко войти в другое приложение, например, Contoso Pharmacy, непосредственно во время доступа к нему.
- **Приложение**. Значение этого параметра позволяет поддерживать сеанс пользователя исключительно для одного приложения и независимо от других приложений. Например, если требуется, чтобы пользователь выполнял вход в приложение Contoso Pharmacy (с теми же учетными данными), даже если пользователь уже выполнил вход в Contoso Shopping, другое приложение на том же клиенте B2C. 
- **Политика**. Значение этого параметра позволяет поддерживать сеанс пользователя исключительно для политики и независимо от приложений, ее использующих. Например, если пользователь уже выполнил вход и прошел этап многофакторной проверки подлинности (MFA), он может получить доступ к более защищенным частям нескольких приложений, который будет действовать, пока не истечет срок действия сеанса, связанного с политикой.
- **Отключено**. Если для параметра задано это значение, то пользователь должен осуществлять все действия по входу при каждом выполнении политики. Например, несколько пользователей могут зарегистрироваться в приложении (в сценарии с использованием общего рабочего стола), даже если все это время с приложением работает один пользователь.

Эти параметры недоступны для политик сброса пароля. 

