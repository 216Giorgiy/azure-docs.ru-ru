---
title: Ограничения IP-адресов в службе приложений Azure | Документация Майкрософт
description: Как использовать ограничения IP-адресов при помощи службы приложений Azure
author: ccompy
manager: stefsch
editor: ''
services: app-service\web
documentationcenter: ''
ms.assetid: 3be1f4bd-8a81-4565-8a56-528c037b24bd
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 7/30/2018
ms.author: ccompy
ms.openlocfilehash: fb26d91ae772c4da1055da80366d6e8c6b80a6ac
ms.sourcegitcommit: f86e5d5b6cb5157f7bde6f4308a332bfff73ca0f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2018
ms.locfileid: "39364314"
---
# <a name="azure-app-service-static-ip-restrictions"></a>Ограничения статических IP-адресов в службе приложений Azure #

Ограничения IP-адресов позволяют определить список IP-адресов, упорядоченных по приоритету, с которых разрешен или запрещен доступ к вашему приложению. Список разрешений может содержать IPv4- и IPv6-адреса. Если он содержит одну или несколько записей, то действует неявный запрет на все адреса в конце этого списка. 

Возможность ограничения IP-адресов работает со всеми рабочими нагрузками, размещенными в службе приложений, включая веб-приложения, приложения API, приложения Linux, приложения-контейнеры Linux и функции. 

При отправке запроса к приложению IP-адрес отправителя сопоставляется со списком ограничений IP-адресов. Если доступ с этого адреса запрещен правилами в списке, служба возвращает код состояния [HTTP 403](https://en.wikipedia.org/wiki/HTTP_403).

Возможность ограничения IP-адресов реализована во внешних ролях службы приложений, являющихся вышестоящими для рабочих узлов, на которых выполняется код. Поэтому ограничение IP-адресов действует как сетевые списки ACL.  

![Поток ограничения IP-адресов](media/app-service-ip-restrictions/ip-restrictions-flow.png)

Какое-то время возможность ограничения IP-адресов на портале была уровнем, реализованным на основе компонента ipSecurity в службах IIS. Текущая возможность ограничения IP-адресов работает иначе. Вы по-прежнему можете настроить ipSecurity в файле web.config приложения, но правила ограничения IP-адресов на основе внешнего интерфейса будут применяться до поступления какого-либо трафика в службы IIS.

## <a name="adding-and-editing-ip-restriction-rules-in-the-portal"></a>Добавление и изменение правил ограничения IP-адресов на портале ##

Чтобы добавить правило ограничения IP-адреса приложения, в меню откройте **Сеть**>**Ограничения IP-адресов** и выберите команду **Настроить ограничения IP-адресов**

![Сетевые возможности службы приложений](media/app-service-ip-restrictions/ip-restrictions.png)  

С помощью пользовательского интерфейса ограничения IP-адресов можно просмотреть список правил ограничения IP-адресов, которые определены для приложения.

![список ограничений IP-адресов](media/app-service-ip-restrictions/ip-restrictions-browse.png)

Если правила были настроены, как показано на рисунке, то ваше приложение будет принимать только трафик с адреса 131.107.159.0/24 и отклонять трафик с любого другого IP-адреса.

Можно щелкнуть **[+] Добавить**, чтобы добавить новое правило ограничения IP-адресов. После добавления правило немедленно вступает в действие. Правила применяются в порядке возрастания приоритета, начиная с наименьшего числа. После добавления даже одного правила действует неявный запрет всего, что было разрешено на текущий момент. 

![Добавление правила ограничения IP-адресов](media/app-service-ip-restrictions/ip-restrictions-add.png)

В нотации CIDR для IPv4- и IPv6-адресов должна быть указана нотация IP-адреса. Чтобы указать точный адрес, можно использовать формат 1.2.3.4/32, где первые четыре октета представляют IP-адрес, а /32 — маску. Нотацией CIDR IPv4 для всех адресов является 0.0.0.0/0. Чтобы узнать больше о нотации CIDR, можно прочитать раздел [Бесклассовая адресация](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing).  

Можно щелкнуть любую строку, чтобы изменить существующее правило ограничения IP-адресов. Изменения вступают в силу немедленно, включая изменения порядка приоритетов.

![Изменение правила ограничения IP-адресов](media/app-service-ip-restrictions/ip-restrictions-edit.png)

Чтобы удалить правило, щелкните **...** для правила и выберите **Удалить**. 

![Удаление правила ограничения IP-адресов](media/app-service-ip-restrictions/ip-restrictions-delete.png)

## <a name="programmatic-manipulation-of-ip-restriction-rules"></a>Программные манипуляции с правилами ограничения IP-адресов ##

В настоящее время нет интерфейса командной строки или PowerShell для новой возможности ограничения IP-адресов, но значения можно установить вручную с помощью операции PUT в конфигурации приложения в Resource Manager. Например, можно использовать resources.azure.com и изменить блок ipSecurityRestrictions, чтобы добавить необходимый код JSON. 

Эти сведения в Resource Manager находятся здесь:

management.azure.com/subscriptions/**ИД_подписки**/resourceGroups/**группы_ресурсов**/providers/Microsoft.Web/sites/**имя_веб-приложения**/config/web?api-version=2018-02-01

Ниже показан синтаксис JSON для приведенного выше примера.

    "ipSecurityRestrictions": [
      {
        "ipAddress": "131.107.159.0/24",
        "action": "Allow",
        "tag": "Default",
        "priority": 100,
        "name": "allowed access"
      }
    ],
