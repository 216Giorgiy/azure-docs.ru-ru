---
title: "Экспорт размещенного в Azure API в PowerApps и Microsoft Flow | Документация Майкрософт"
description: "Общие сведения о предоставлении API, размещенного в службе приложений, для PowerApps и Microsoft Flow"
services: app-service
documentationcenter: 
author: mattchenderson
manager: erikre
editor: 
ms.assetid: 
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 02/06/2017
ms.author: mahender
translationtype: Human Translation
ms.sourcegitcommit: 060fbb885f254c0de02fe422460e8e8d659ac848
ms.openlocfilehash: 503f17a629527e8c9a3bfe6cde1da31dcf1f18ef


---
# <a name="exporting-an-azure-hosted-api-to-powerapps-and-microsoft-flow"></a>Экспорт размещенного в Azure API в PowerApps и Microsoft Flow

## <a name="creating-custom-apis-for-powerapps-and-microsoft-flow"></a>Создание настраиваемых API для PowerApps и Microsoft Flow

[Платформа бизнес-приложений от Майкрософт](https://businessplatform.microsoft.com/) содержит разнообразные продукты, которые помогают опытным пользователям увеличить свою продуктивность. [PowerApps](https://powerapps.com) — это служба для создания и использования пользовательских бизнес-приложений, которые подключаются к данным и работают на различных платформах. [Microsoft Flow](https://flow.microsoft.com) позволяет легко автоматизировать рабочие и бизнес-процессы между избранными приложениями и службами. PowerApps и Microsoft Flow содержат ряд встроенных соединителей для источников данных, таких как Office 365, Dynamics 365, Salesforce и т д. Тем не менее пользователи также должны иметь возможность использовать источники данных и API, созданные в их организации.

Аналогичным образом разработчикам, которым необходимо расширить возможности совместного использования API внутри организации, может потребоваться предоставить доступ к своим API пользователям PowerApps и Microsoft Flow. В этой статье показано, как предоставить API, созданный с помощью службы приложений Azure или Функций Azure, для PowerApps и Microsoft Flow. [Служба приложений Azure](https://azure.microsoft.com/services/app-service/) — это предложение "платформа как услуга", которое позволяет разработчикам быстро и легко создавать корпоративные мобильные, веб-приложения и приложения API. [Функции Azure](https://azure.microsoft.com/services/functions/) — это независимое от сервера решение для вычислений на основе событий, позволяющее быстро создавать код, который может реагировать на другие части системы и масштабироваться по запросу.

Дополнительные сведения об этих службах см. в следующих статьях:
- [Guided Learning for PowerApps](https://powerapps.microsoft.com/guided-learning/learning-introducing-powerapps/) (Пошаговое изучение PowerApps) 
- [Интерактивное обучение Microsoft Flow](https://flow.microsoft.com/guided-learning/learning-introducing-flow/)
- [Что такое служба приложений?](https://docs.microsoft.com/azure/app-service/app-service-value-prop-what-is)
- [Обзор функций Azure](https://docs.microsoft.com/azure/azure-functions/functions-overview)

## <a name="sharing-an-api-definition"></a>Предоставление общего доступа к определению API

Интерфейсы API часто описываются с помощью [документа Open API](https://www.openapis.org/) (иногда называемого документом Swagger). Он содержит все сведения о доступных операциях и о том, как необходимо структурировать данные. С помощью PowerApps и Microsoft Flow можно создавать настраиваемые API для любого документа Open API 2.0. После создания настраиваемого API его можно использовать точно так же, как один из встроенных соединителей, и быстро интегрировать в приложение.

Служба приложений Azure и Функции Azure имеют [встроенную поддержку](https://docs.microsoft.com/azure/app-service-api/app-service-api-metadata) создания и размещения документа Open API, а также управления им. Чтобы создать настраиваемый соединитель для приложения-функции, приложения API, веб- или мобильных приложений, требуются два этапа:

1. [Получение определения API из службы приложений или Функций Azure.](#export)
2. [Импорт определения API в PowerApps.](#import)

Возможно эти два шага придется выполнить разным сотрудникам организации, так как у определенного пользователя может отсутствовать разрешение на выполнение обоих действий. В таком случае разработчик, имеющий доступ с правами участника к службе приложений или к приложению Функций Azure, должен получить определение API (JSON-файл) или ссылку на него. Они понадобятся, чтобы предоставить это определение владельцу PowerApps или Microsoft Flow. Владелец может использовать эти метаданные для создания настраиваемого API.

> [!NOTE]
> Так как используется копия определения API, PowerApps и Microsoft Flow не будут немедленно уведомлены об обновлениях или критических изменениях приложения. При появлении новой версии API эти шаги необходимо выполнить для новой версии. 

<a name="export"></a>
## <a name="retrieving-the-api-definition-from-app-service-or-azure-functions"></a>Получение определения API из службы приложений или Функций Azure

В этом разделе вы экспортируете определение API для API службы приложений для последующего использования в PowerApps.

1. Откройте [портал Azure](https://portal.azure.com) и перейдите к службе приложений или приложению Функций Azure.

    При использовании службы приложений Azure в списке параметров выберите **Определение API**. 
    
    При использовании Функций Azure выберите **Параметры приложения-функции**, а затем — **Настроить метаданные API**.

2. Если определение API было предоставлено, вы увидите кнопку **Export to PowerApps + Microsoft Flow** (Экспорт в PowerApps + Microsoft Flow). Нажмите эту кнопку, чтобы начать процесс экспорта.

3. Вы можете выбрать **Download the API definition** (Скачать определение API) или **Получить ссылку**. Независимо от выбранного варианта результат будет отправлен в PowerApps, как описано в следующем разделе. Выберите один из этих вариантов и следуйте инструкциям.
 
4. Если определение API содержит какие-либо параметры безопасности, они будут вызваны на шаге 2. Во время импорта PowerApps и Microsoft Flow обнаружат их и предложат ввести сведения о безопасности. С их помощью эти службы выполняют вход пользователей, обеспечивая им доступ к API. Если для API требуется проверка подлинности, это определение должно быть записано в виде _определения безопасности_ в документе Open API.

    Получите учетные данные, связанные с определениями. Они понадобятся в следующем разделе. Список поставщиков удостоверений, изначально поддерживаемых PowerApps, и требуемые учетные данные для каждого из них см. в статьях [Register custom APIs in PowerApps] (Регистрация настраиваемых API в PowerApps) и [Регистрация настраиваемых API в Microsoft Flow].
 
> [!NOTE]
> При использовании проверки подлинности Azure Active Directory понадобится зарегистрировать новое приложение AAD с делегированным доступом к API и URL-адрес ответа _https://msmanaged-na.consent.azure-apim.net/redirect_. Дополнительные сведения см. [в этой статье](
https://powerapps.microsoft.com/tutorials/customapi-azure-resource-manager-tutorial/). Вместо Azure Resource Manager здесь нужно использовать API.
>
> Если импортировать определение API в PowerApps будет другой пользователь, помимо файла определения API предоставьте ему идентификатор и секрет клиента **новой регистрации**, а также URL-адрес ресурса API. Обеспечьте безопасное управление этими секретами. **Не предоставляйте учетные данные безопасности самого API.**

<a name="import"></a>
## <a name="importing-the-api-definition-into-powerapps-and-microsoft-flow"></a>Импорт определения API в PowerApps и Microsoft Flow

В этом разделе вы создадите настраиваемый API в PowerApps и Microsoft Flow с помощью определения API, полученного ранее. Настраиваемые API совместно используются двумя службами, поэтому импортировать определение необходимо один раз. Дополнительные сведения о настраиваемых API см. в статьях [Register custom APIs in PowerApps] (Регистрация настраиваемых API в PowerApps) и [Регистрация настраиваемых API в Microsoft Flow].

**Чтобы импортировать в PowerApps:**

1. Откройте [веб-портал PowerApps](https://web.powerapps.com), выполните вход и выберите **Подключения**. Щелкните **Новое подключение**.

2. Выберите **Настраиваемый**, а затем нажмите кнопку **Создать настраиваемый API**.

3. Укажите имя API, а затем передайте определение Swagger или вставьте URL-адрес метаданных. Нажмите кнопку **Далее**.

4. Если будет предложено предоставить сведения о проверке подлинности, введите значения, полученные в предыдущем разделе. В противном случае перейдите к следующему шагу.

5. Щелкните **Создать**.

**Чтобы импортировать в Microsoft Flow:**

1. Откройте [веб-портал Microsoft Flow](https://flow.microsoft.com/) и выполните вход. 

2. Нажмите кнопку **Параметры**, расположенную в правом верхнем углу страницы (выглядит как шестеренка), и выберите **Настраиваемые API**. Щелкните **Создать настраиваемый API**.

3. Передайте определение Swagger и щелкните **Продолжить**.

4. Если будет предложено предоставить сведения о проверке подлинности, введите значения, полученные в предыдущем разделе. В противном случае перейдите к следующему шагу.

5. Установите флажок, расположенный в верхней части экрана.



[Register custom APIs in PowerApps]: https://powerapps.microsoft.com/tutorials/register-custom-api/ (Регистрация настраиваемых API в PowerApps)
[Регистрация настраиваемых API в Microsoft Flow]: https://flow.microsoft.com/documentation/register-custom-api/



<!--HONumber=Feb17_HO2-->


