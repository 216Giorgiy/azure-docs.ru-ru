---
title: Отслеживание приложений в Службе приложений Azure | Документация Майкрософт
description: Узнайте, как выполнять мониторинг приложений в службе приложений Azure с помощью портала Azure.
services: app-service
documentationcenter: ''
author: btardif
manager: erikre
editor: ''
ms.assetid: d273da4e-07de-48e0-b99d-4020d84a425e
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/28/2017
ms.author: byvinyal
ms.custom: seodec18
ms.openlocfilehash: d9f25b7a10b7a50663198120a895220b02818d7b
ms.sourcegitcommit: fd488a828465e7acec50e7a134e1c2cab117bee8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/03/2019
ms.locfileid: "53994952"
---
# <a name="monitor-apps-in-azure-app-service"></a>Мониторинг приложений в службе приложений Azure
[Служба приложений Azure](https://go.microsoft.com/fwlink/?LinkId=529714) предоставляет встроенные средства мониторинга веб-приложений, серверной части мобильных решений и приложений API на [портале Azure](https://portal.azure.com).

На портале Azure можно просматривать *квоты*, *метрики* приложения и план службы приложений, а также настраивать автоматическое получение *оповещений* и *масштабирование* на основе метрик.

## <a name="understand-quotas"></a>Общие сведения о квотах

На приложения, размещенные в службе приложений, распространяются определенные ограничения на использование ресурсов. Эти ограничения определены в рамках плана службы приложений, связанного с приложением.

[!INCLUDE [app-service-dev-test-note](../../includes/app-service-dev-test-note.md)]

Если приложение используется в режиме плана *Бесплатный* или *Общий*, ограничения на использование ресурсов выражены в виде квот.

Если приложение используется в режиме плана *Базовый*, *Стандартный* или *Премиум*, ограничения выражаются в виде *размера* выделенных ресурсов ("Малый", "Средний" или "Большой") и *числа экземпляров* (1, 2, 3 и т. д.) плана службы приложений.

Для приложений, работающих в режиме плана "Бесплатный" или "Общий", предоставляются следующие квоты.

| Quota | ОПИСАНИЕ |
| --- | --- |
| **ЦП (короткое)** | Объем ресурсов ЦП, который может потребить приложение в течение 5 минут. Эта квота повторно назначается каждые 5 минут. |
| **ЦП (день)** | Общий объем ресурсов ЦП, который может потребить приложение в течение одного дня. Эта квота повторно назначается каждые 24 часа в полночь (в формате UTC); |
| **Память** | Общий объем ресурсов ЦП, который может потребить приложение. |
| **Пропускная способность** | Общий объем исходящей пропускной способности, который может использовать приложение в течение одного дня. Эта квота повторно назначается каждые 24 часа в полночь (в формате UTC); |
| **Filesystem** | Общий объем доступного пространства для хранения. |

Для приложений, настроенных для работы в режиме плана *Базовый*, *Стандартный* и *Премиум*, доступна только квота на файловую систему.

Дополнительные сведения об определенных квотах, ограничениях и функциях, доступных для разных номеров SKU службы приложений, см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md#app-service-limits).

### <a name="quota-enforcement"></a>Принудительное применение квот

Если квоты на использование ЦП (*короткое* и *день*), а также квота на *пропускную способность* будут превышены, работа приложения будет остановлена до сброса квоты. В течение этого времени все входящие запросы завершаются с ошибкой HTTP 403.

![Сообщение об ошибке "ошибка 403"][http403]

При превышении квоты на память приложение перезапускается.

При превышении квоты на файловую систему все операции записи завершаются сбоем. Записи в журналы также завершаются сбоем.

Квоты на использование можно увеличить или удалить из приложения путем изменения плана службы приложений.

## <a name="understand-metrics"></a>Общие сведения о метриках

Метрики предоставляют сведения о приложении или поведении плана службы приложений.

Для приложения доступны приведенные далее метрики.

| Метрика | ОПИСАНИЕ |
| --- | --- |
| **Среднее время ответа** | Среднее время обработки запроса приложением (в миллисекундах) |
| **Средний размер рабочего набора памяти** | Средний объем памяти (в МиБ/с), используемый приложением |
| **Время ЦП** | Количество времени ЦП (в секундах), используемого приложением Дополнительные сведения об этих метриках см. в документации по [времени и проценту использования ЦП](#cpu-time-vs-cpu-percentage). |
| **Входящие данные** | Объем входящей пропускной способности, используемый приложением (в МиБ/с) |
| **Выходные данные** | Объем исходящей пропускной способности, используемый приложением (в МиБ/с) |
| **HTTP 2xx** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 200, но меньшим 300 |
| **HTTP 3xx** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 300, но меньшим 400 |
| **HTTP 401** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния 401 |
| **Http 403** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния 403 |
| **HTTP 404** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния 404 |
| **HTTP 406** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния 406 |
| **HTTP 4xx** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 400, но меньшим 500 |
| **Ошибки HTTP-сервера** | Количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 500, но меньшим 600 |
| **Рабочий набор памяти** | Текущий объем используемой приложением памяти (в МиБ/с) |
| **Requests (Запросы)** | Общее количество запросов, для которых возвращается ошибка HTTP (независимо от кода состояния) |

Для плана службы приложений доступны следующие метрики.

> [!NOTE]
> Метрики плана службы приложений поддерживаются только для планов категорий *Базовый*, *Стандартный* и *Премиум*.
> 

| Метрика | ОПИСАНИЕ |
| --- | --- |
| **Процент использования ЦП** | средний процент использования ЦП всеми экземплярами плана; |
| **Процент использования памяти** | средний процент использование памяти всеми экземплярами плана; |
| **Входящие данные** | средний показатель использования входящей пропускной способности всеми экземплярами плана; |
| **Выходные данные** | средний показатель использования исходящей пропускной способности всеми экземплярами плана; |
| **Длина дисковой очереди** | среднее число запросов на чтение и запись, поставленных в очередь в хранилище. Большая длина очереди на диске замедляет производительность приложения из-за избыточных дисковых операций ввода-вывода. |
| **Длина очереди HTTP** | среднее число запросов HTTP, которые ставятся в очередь перед выполнением. Большая или увеличивающая длина очереди HTTP является признаком интенсивной нагрузки плана. |

### <a name="cpu-time-vs-cpu-percentage"></a>Время и процент использования ЦП
<!-- To do: Fix Anchor (#CPU-time-vs.-CPU-percentage) -->

Доступны две метрики, которые отражают использование ЦП.

**Время ЦП**: эту метрику рекомендуется использовать для приложений, настроенных для работы в режиме плана "Бесплатный" или "Общий". Это связанно с тем, что квота на использование ЦП приложением, предоставленная в этих планах, определяется в минутах.

**Процент использования ЦП**: эта метрика удобна для приложений, размещенных в планах "Базовый", "Стандартный" и "Премиум", так как они поддерживают масштабирование. Метрика "Процент ЦП" позволяет получить представление об общем использовании ЦП для всех экземпляров.

## <a name="metrics-granularity-and-retention-policy"></a>Степень детализации метрик и политика их хранения
Метрики для приложения и плана службы приложений записываются и обрабатываются в службе в соответствии со следующей степенью детализации и политиками хранения.

* Метрики со степенью детализации до **минут** хранятся 30 часов.
* Метрики со степенью детализации до **часов** хранятся 30 дней.
* Метрики со степенью детализации до **дней** хранятся 30 дней.

## <a name="monitoring-quotas-and-metrics-in-the-azure-portal"></a>Мониторинг квот и метрик на портале Azure
Состояние квот и метрик, влияющих на приложение, можно просмотреть на [портале Azure](https://portal.azure.com).

![Диаграмма квот на портале Azure][quotas]

Чтобы просмотреть сведения о квотах, выберите **Параметры** > **Квоты**. На диаграмме отображаются указанные далее сведения о квотах. 
1. Имя квоты.
1. Интервал повторного назначения.
1. Текущее ограничение.
1. Текущее значение.

![Диаграмма метрик на портале Azure.][metrics] Доступ к сведениям о метриках можно получить прямо на странице **Ресурс**. Чтобы настроить диаграмму, выполните следующие действия. 
1. Выберите диаграмму.
1. Нажмите кнопку **Изменить диаграмму**.
1. Задайте **диапазон времени**.
1. Укажите **тип диаграммы**.
1. Измените метрики, которые будут отображаться.  

Дополнительные сведения о метриках см. в статье о [данных мониторинга](../monitoring-and-diagnostics/insights-how-to-customize-monitoring.md).

## <a name="alerts-and-autoscale"></a>Оповещения и автомасштабирование
Метрики для плана приложения или службы приложений можно привязать к оповещениям. Дополнительные сведения см. в статье [Создание оповещений для служб Azure с помощью портала Azure](../monitoring-and-diagnostics/insights-alerts-portal.md).

Приложения службы приложений в рамках планов "Базовый", "Стандартный" и "Премиум", поддерживают возможность автомасштабирования. Автомасштабирование позволяет настроить правила, которые отслеживают метрики плана службы приложений. Правила могут увеличивать или уменьшать число экземпляров, предоставляя дополнительные ресурсы при необходимости. Правила также помогают сократить расходы на чрезмерную подготовку приложений. 

Дополнительные сведения об автомасштабировании см. в статьях [Начало работы с автомасштабированием в Azure](../monitoring-and-diagnostics/insights-how-to-scale.md) и [Рекомендации по автомасштабированию](../azure-monitor/platform/autoscale-best-practices.md).

[fzilla]:https://go.microsoft.com/fwlink/?LinkId=247914
[vmsizes]:https://go.microsoft.com/fwlink/?LinkID=309169



<!-- Images. -->
[http403]: ./media/web-sites-monitor/http403.png
[quotas]: ./media/web-sites-monitor/quotas.png
[metrics]: ./media/web-sites-monitor/metrics.png
