<properties 
	pageTitle="Высокая плотность размещения в службе приложений Azure" 
	description="Высокая плотность размещения в службе приложений Azure" 
	authors="btardif" 
	manager="wpickett" 
	editor="" 
	services="app-service\web" 
	documentationCenter=""/>

.<tags 
	ms.service="app-service-web" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="multiple" 
	ms.topic="article" 
	ms.date="08/07/2016" 
	ms.author="byvinyal"/>

# Высокая плотность размещения в службе приложений Azure#

## Основные сведения о масштабировании приложений##

При использовании службы приложений ваше приложение будет отделено от емкости, выделяемой для него из 2 источников:
 
>**Приложение:** представляет приложение и конфигурацию его среды выполнения. Например, какую версию .NET следует загружать среде выполнения? Какие параметры приложения? И т. д.

>**План службы приложений:** определяет характеристики емкости, доступный набор функций и расположение приложения. Например, большой (4 ядра) компьютер, 4 экземпляра, функции уровня "Премиум" в восточной части США.

Приложение всегда связано с одним **планом службы приложений**, но **план службы приложений** может предоставлять емкость для одного или нескольких приложений.

Это означает, что платформа обеспечивает гибкость, изолируя одно приложение или позволяя нескольким приложениям совместно использовать ресурсы посредством совместного доступа к **плану службы приложений**.

Однако, если несколько приложений совместно используют **план службы приложений**, то будет один экземпляр данного приложения, выполняемый на каждом экземпляре данного **плана службы приложений**.

## Масштабирование на каждое приложение##
**Масштабирование на каждое приложение** — это функция, которую можно включить на уровне **плана службы приложений** и затем использовать для каждого приложения.

**Масштабирование на каждое приложение** позволяет масштабировать приложение независимо от **плана службы приложений**, который используется для его размещения. Таким образом, **план службы приложений** может быть настроен на предоставление 10 экземпляров, а приложение можно настроить, например, на масштабирование только на 5 из них.

Ниже приведен шаблон ARM, в котором создается **план службы приложений**, масштабированный на 10 экземпляров, и приложение, настроенное на использование функции **масштабирования на каждое приложение** с масштабированием только на 5 экземпляров.

Для этого план службы приложений присваивает свойству **масштабирования на сайт** значение true (`"perSiteScaling": true`), а приложение для **количества используемых рабочих ролей** устанавливает значение 1 (`"properties": { "numberOfWorkers": "1" }`).

    {
        "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
        "contentVersion": "1.0.0.0",
        "parameters":{
            "appServicePlanName": { "type": "string" },
            "appName": { "type": "string" }
         },
        "resources": [
        {
            "comments": "App Service Plan with per site perSiteScaling = true",
            "type": "Microsoft.Web/serverFarms",
            "sku": {
                "name": "S1",
                "tier": "Standard",
                "size": "S1",
                "family": "S",
                "capacity": 10
                },
            "name": "[parameters('appServicePlanName')]",
            "apiVersion": "2015-08-01",
            "location": "West US",
            "properties": {
                "name": "[parameters('appServicePlanName')]",
                "perSiteScaling": true 
            }
        },
        {
            "type": "Microsoft.Web/sites",
            "name": "[parameters('appName')]",
            "apiVersion": "2015-08-01-preview",
            "location": "West US",
            "dependsOn": [ "[resourceId('Microsoft.Web/serverFarms', parameters('appServicePlanName'))]" ],
            "properties": { "serverFarmId": "[resourceId('Microsoft.Web/serverFarms', parameters('appServicePlanName'))]" },
            "resources": [ {
                    "comments": "",
                    "type": "config",
                    "name": "web",
                    "apiVersion": "2015-08-01",
                    "location": "West US",
                    "dependsOn": [ "[resourceId('Microsoft.Web/Sites', parameters('appName'))]" ],
                    "properties": { "numberOfWorkers": "1" }
             } ]
         }]
    }


## Рекомендуемая конфигурация для высокой плотности размещения

**Масштабирование на каждое приложения** — это функция, которая включается как в общедоступных регионах Azure, так и в средах службы приложений, однако рекомендуется использовать среды службы приложений из-за их дополнительных возможностей и большей емкости пулов.

Выполните указанные ниже действия, чтобы настроить **высокую плотность размещения** для своих приложений.

1. Настройте **среду службы приложений** и выберите **рабочий пул**, который будет выделен для сценария с *высокой плотностью размещения*.

1. Создайте один **план службы приложений** и настройте его для использования всей доступной емкости в **рабочем пуле**.

1. В **плане службы приложений** присвойте флагу масштабирования на сайт значение true.

1. Новые сайты будут созданы и назначены этому **плану службы приложений**, при этом для свойства *numberOfWorkers* будет задано значение *1*. Это позволит достичь в данном **рабочем пуле** максимальной плотности.

1. Число рабочих ролей можно настроить отдельно для каждого сайта, чтобы предоставить дополнительные ресурсы согласно требованиям. Например, для сайта с высоким уровнем использования свойству *numberOfWorkers* можно задать значение *3*, чтобы иметь большую вычислительную мощность для этого приложения, а для сайтов с низким уровнем использования свойству *numberOfWorkers* можно задать значение *1*.

<!---HONumber=AcomDC_0810_2016-->