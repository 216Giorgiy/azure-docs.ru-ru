<properties
   pageTitle="Приступая к работе с модулем PowerShell пакетной службы Azure | Microsoft Azure"
   description="Краткое описание командлетов Azure PowerShell, используемых для управления пакетной службой Azure."
   services="batch"
   documentationCenter=""
   authors="dlepow"
   manager="timlt"
   editor=""/>

<tags
   ms.service="batch"
   ms.devlang="NA"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="powershell"
   ms.workload="big-compute"
   ms.date="10/13/2015"
   ms.author="danlep"/>

# Приступая к работе с командлетами Azure PowerShell
В этой статье представлено краткое введение в командлеты Azure PowerShell, которые можно использовать для управления учетными записями Пакетной службы и получения сведений о заданиях, задачах Пакетной службы и других сведений.

Для получения подробных сведений о синтаксисе командлета введите `get-help <Cmdlet_name>` или см. [справку по командлету Пакетной службы Azure](https://msdn.microsoft.com/library/azure/mt125957.aspx).

[AZURE.INCLUDE [powershell-preview-include](../../includes/powershell-preview-include.md)]

## Предварительные требования

* **Azure PowerShell**. Командлеты пакетной службы поставляются в модуле диспетчера ресурсов Azure. Предварительные требования, инструкции по установке и использованию диспетчера ресурсов Azure см. в статье [Командлеты диспетчера ресурсов Azure](https://msdn.microsoft.com/library/azure/mt125356.aspx).



* **Регистрация пространства имен поставщика пакетной службы (одноразовая операция)**. Чтобы начать работу с учетными записями пакетной службы, зарегистрируйте пространство имен поставщика пакетной службы. Эту операцию нужно выполнять один раз для каждой подписки.

    ```
    Register-AzureRMResourceProvider -ProviderNamespace Microsoft.Batch
    ```

## Управление учетными записями пакетной службы и ключами


### Создание учетной записи Пакетной службы

Командлет **New-AzureRmBatchAccount** создает новую учетную запись пакетной службы в указанной группе ресурсов. Если у вас еще нет группы ресурсов, создайте ее. Для этого выполните командлет [New-AzureRmResourceGroup](https://msdn.microsoft.com/library/azure/mt603739.aspx), указав один из регионов Azure, например «Центральная часть США», в параметре **Расположение**. Например:

```
New-AzureRmResourceGroup –Name MyBatchResourceGroup –location "Central US"
```

Затем создайте новую учетную запись пакетной службы в группе ресурсов, указав имя учетной записи <*account\_name*> и расположение, где доступна пакетная служба. Создание учен=тной записи может занять несколько минут. Например:

```
New-AzureRmBatchAccount –AccountName <account_name> –Location "Central US" –ResourceGroupName MyBatchResourceGroup
```

> [AZURE.NOTE]Имя учетной записи Пакетной службы в Azure должно быть уникальным, содержать от 3 до 24 символов и состоять только из строчных букв и цифр.

### Получение ключей доступа к учетной записи
**Get-AzureRmBatchAccountKeys** выводит клавиши доступа, связанные с учетной записью пакетной службы Azure. Например, выполните следующую команду, чтобы получить первичные и вторичные ключи созданной учетной записи.

```
$Account = Get-AzureBatchAccountKeys –AccountName <accountname>

$Account.PrimaryAccountKey

$Account.SecondaryAccountKey
```

### Создание нового ключа доступа
**New-AzureRmBatchAccountKey** создает новый первичный или вторичный ключ учетной записи пакетной службы Azure. Например, чтобы создать новый первичный ключ для учетной записи Пакетной службы, введите:

```
New-AzureRmBatchAccountKey -AccountName <account_name> -KeyType Primary
```

> [AZURE.NOTE]Чтобы создать новый вторичный ключ, введите "Вторичный" в параметре **KeyType**. Повторно создавать первичный и вторичный ключи нужно отдельно.

### Удаление учетной записи Пакетной службы
**Remove-AzureRmBatchAccount** удаляет учетную запись пакетной службы. Например:

```
Remove-AzureRmBatchAccount -AccountName <account_name>
```

При появлении запроса на удаление учетной записи подтвердите удаление. Удаление учетной записи может занять некоторое время.

## Запрос для получения сведений о заданиях, задачах и других сведений

Для отправки запроса о сущностях, созданных в данной учетной записи, воспользуйтесь командлетами **Get-AzureBatchJob**, **Get-AzureBatchTask** и **Get-AzureBatchPool**.

Чтобы использовать эти командлеты, сначала нужно создать объект AzureBatchContext для хранения имени учетной записи и ключей:

```
$context = Get-AzureRmBatchAccountKeys -AccountName <account_name>
```

Передайте этот контекст в командлеты, которые взаимодействуют с Пакетной службой, через параметр **BatchContext**.

> [AZURE.NOTE]По умолчанию первичный ключ учетной записи используется для проверки подлинности, но вы можете явно выбрать ключ, который нужно использовать, изменив свойство **KeyInUse** объекта BatchAccountContext: `$context.KeyInUse = "Secondary"`.


### Запрос данных

Например, для поиска пулов используйте **Get AzureBatchPools**. По умолчанию этот командлет опрашивает все пулы вашей учетной записи при условии, что вы уже сохранили объект BatchAccountContext в *$context*.

```
Get-AzureBatchPool -BatchContext $context
```
### Использование фильтра OData

Чтобы найти объекты, которые вас интересуют, установите фильтр OData в параметре **Фильтр**. Например, можно найти все пулы с идентификаторами, начинающимися с myPool:

```
$filter = "startswith(id,'myPool')"

Get-AzureBatchPool -Filter $filter -BatchContext $context
```

Этот способ не такой гибкий, как использование "Where-Object" в локальном конвейере. Но запрос отправляется непосредственно Пакетной службе, чтобы вся фильтрация выполнялась на стороне сервера, сохраняя пропускную способность Интернета.

### Используйте параметр Id

Альтернативой использования фильтра OData является использование параметра **Id**. Для запроса конкретного пула с идентификатором myPool сделайте следующее.

```
Get-AzureBatchPool -Id "myPool" -BatchContext $context

```
Параметр **Id** поддерживает поиск только полного идентификатора без подстановочных знаков или фильтров в стиле OData.

### Использование конвейера

Командлеты Пакетной службы могут использовать конвейер PowerShell для передачи данных между командлетами. Это имеет тот же эффект, что и указание параметра, но упрощает вывод нескольких сущностей. Например, этот командлет находит все задачи в вашей учетной записи:

```
Get-AzureBatchJob -BatchContext $context | Get-AzureBatchTask -BatchContext $context
```

### Использование параметра MaxCount

По умолчанию каждый командлет возвращает максимум 1000 объектов. Если этот предел достигнут, уточните параметры фильтра, чтобы он возвращал меньшее количество объектов, или явно задайте максимальное значение с помощью параметра **MaxCount**. Например:

```
Get-AzureBatchTask -MaxCount 2500 -BatchContext $context

```

Чтобы удалить верхнюю границу, задайте **MaxCount** значение "0" или меньше.

## Связанные разделы
* [Скачать Azure PowerShell](http://go.microsoft.com/?linkid=9811175)
* [Установка и настройка Azure PowerShell](../powershell-install-configure.md)
* [Справка по командлету Пакетной службы Azure](https://msdn.microsoft.com/library/azure/mt125957.aspx)
* [Эффективные запросы к пакетной службе](batch-efficient-list-queries.md)

<!---HONumber=Oct15_HO4-->