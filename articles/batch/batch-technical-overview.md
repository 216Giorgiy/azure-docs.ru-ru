<properties
	pageTitle="Технический обзор Пакетной службы Azure"
	description="Узнайте об основных понятиях, рабочих процессах и сценариях Пакетной службы Azure"
	services="batch"
	documentationCenter=""
	authors="dlepow"
	manager="timlt"
	editor=""/>

<tags
	ms.service="batch"
	ms.workload="big-compute"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="get-started-article"
	ms.date="04/28/2015"
	ms.author="danlep"/>


#Технический обзор Пакетной службы Azure
Пакетная служба Azure помогает запускать приложения крупномасштабных и высокопроизводительных вычислительных систем (HPC) в облаке. Это служба платформы, которая предоставляет планирование заданий и автоматическое масштабирование управляемой коллекции виртуальных машин (ВМ) для запуска заданий. С помощью Пакетной службы можно настроить пакетные рабочие нагрузки, чтобы запускать их в Azure по запросу или расписанию, и не беспокоиться о сложности планирования заданий и управления виртуальными машинами на базовой платформе.

>[AZURE.NOTE]Сейчас доступна предварительная версия Пакетной службы. Для использования Пакетной службы необходима учетная запись Azure, также необходимо зарегистрироваться в предварительной версии Пакетной службы. Если ее нет, можно создать бесплатную пробную учетную запись всего за несколько минут. Подробную информацию см. в разделе [Создание учетной записи Azure](http://azure.microsoft.com/develop/php/tutorials/create-a-windows-azure-account/).


## Варианты использования

Пакетная служба использует эластичность и масштаб облака, чтобы помочь вам с *пакетной обработкой* или *пакетными вычислениями*, —для этого выполняется большое количество схожих задач, чтобы получить некоторый требуемый результат. Программа командной строки или сценарий принимает набор файлов данных в качестве входных данных, обрабатывает их в виде последовательности задач и создает набор выходных файлов. Выходные файлы могут быть как конечным результатом, так и промежуточным этапом в рабочем процессе большего размера.

Пакетные вычисления — это общий шаблон для организаций, используемый для обработки, преобразования и анализа больших объемов данных по расписанию или запросу. Он включает в себя обработку полного цикла. Например, создание ежедневного банковского отчета о рисках или зарплатах, который должен формироваться по расписанию. Также он может решать задачи крупного бизнеса, науки и технического применения, для которых обычно требуются инструменты и ресурсы вычислительного кластера или сетки. Это могут быть традиционные приложения высокопроизводительных вычислительных систем (например, моделирование динамики жидкостей или специализированные рабочие нагрузки из области проектирования автомобилей, нефтегазовых исследований, исследований науки о жизни и создание цифрового содержимого).

Пакетная служба хорошо работает с приложениями и рабочими нагрузками, которые параллельно выполняют задачи на нескольких компьютерах, таких как вычислительные виртуальные машины под управлением Пакетной службы. См. рис. 1.

![Параллельные задачи][parallel]

**Рисунок 1. Параллельные задачи, выполняемые на нескольких компьютерах**

Примеры приведены ниже.

* Моделирование финансовых рисков.
* Обработка и визуализация изображений.
* Кодирование и перекодировка мультимедиа.
* Анализ генетических последовательностей.
* Тестирование программного обеспечения.

Пакетная служба может использоваться для выполнения параллельных вычислений с уменьшением шага, а также других, более сложных ациклических параллельных рабочих нагрузок.

>[AZURE.NOTE]Сейчас предварительная версия Пакетной службы не поддерживает приложения интерфейса передачи сообщений (MPI).

## Сценарии для разработчика

Интерфейсы API Пакетной службы на основе REST поддерживают два сценария разработки для настройки и запуска пакетных рабочих нагрузок с помощью Пакетной службы:

1. **Распределение вычислений в виде рабочих элементов.** С помощью API *Пакетной службы* можно создать гибкий пул вычислительных виртуальных машин и управления ими, а также для назначения им задач. Это дает вам полный контроль над ресурсами. Клиент осуществляет управление конвейером выполнения задач. Например, с помощью диспетчера рабочих процессов или метапланировщика, который может быть реализован помощью интерфейсов REST API Пакетной службы или диспетчера заданий рабочего элемента. Вместо того, чтобы настраивать вычислительный кластер или писать код для создания очереди и планирования заданий, можно автоматизировать процессы планирования заданий и масштабирования пула вычислительных ВМ для выполнения заданий. В процессе определения рабочих элементов вам надо указать все зависимости и описать работу с входными и выходными файлами.

2. **Публикация и выполнение приложений с помощью Пакетной службы.** API *приложений Пакетной службы* работают на более высоком уровне, помогая создать программу-оболочку существующего приложения, чтобы оно выполнялось как служба в пуле виртуальных машин, управляемых Пакетной службой в фоновом режиме. Это может быть приложение, которое сегодня выполняется клиентских рабочих станциях или в вычислительном кластере. Платформа для приложений Пакетной службы осуществляет перемещение входных и выходных файлов, выполнение заданий, управление заданиями и сохранение данных. Приложения Пакетной службы также позволяют моделировать задачи разделения данных и выделения этапов задания. В состав входит REST API-интерфейс и портал приложений Пакетной службы, где можно наблюдать за выполнением переданных заданий. Доступ к нему можно получить с помощью портала управления Microsoft Azure.


## Основные понятия Пакетной службы

В следующих разделах приведены основные понятия для работы с Пакетной службой и интерфейсами API. Дополнительную информацию см. в разделе [Основные сведения об API Пакетной службы Azure](batch-api-basics.md).

* [Учетная запись Пакетной службы](#BKMK_Account)
* [Виртуальные машины задач и пулы](#BKMK_TVM)
* [Рабочие элементы, задания и задачи](#BKMK_Workitem)
* [Файлы и каталоги](#BKMK_Files)

### <a id="BKMK_Account">Учетная запись Пакетной службы</a>
Для работы с Пакетной службой требуется уникальная **учетная запись Пакетной службы** . Все запросы в Пакетную службу должны быть аутентифицированы с помощью имени учетной записи и ее ключа доступа.

Создать учетную запись Пакетной службы и управлять ее ключами доступа можно на портале Azure или с помощью [командлетов PowerShell Пакетной службы](batch-powershell-cmdlets-get-started.md).

Создание учетной записи Пакетной службы на портале:

1. Выполните вход на [портал управления Azure](https://manage.windowsazure.com).
2. Последовательно щелкните **Создать**, **Среда выполнения приложений**, **Пакетная служба** и **Быстрое создание**. ![Создание учетной записи Пакетной службы][account_portal]

3. Введите следующие сведения:

	* В поле **Имя учетной записи** введите уникальное имя, которое будет использоваться в URL-адресе учетной записи Пакетной службы.
	* В поле **Регион** выберите регион, в котором доступна Пакетная служба.
	* При наличии нескольких подписок в списке **Подписки** выберите доступную подписку, которой будут выставляться счета за использование Пакетной службы.


### <a id="BKMK_TVM">Виртуальные машины задач и пулы</a>

**Виртуальная машина задач** (ВМЗ) — это виртуальная машина Microsoft Azure, которая выделена Пакетной службой для выполнения определенной рабочей нагрузки (задачи) вашему приложению (это может быть исполняемый файл (EXE-файл) или, если используются приложения Пакетной службы, одна или несколько программ из образа приложения). В отличие от обычной виртуальной машины Microsoft Azure вам не нужно управлять ВМЗ напрямую. Пакетная служба создает **пул** одинаково настроенных вычислительных ресурсов (ВМЗ) и управляет ними, как показано на рис. 2.

![Пул и ВМЗ][TVM_pool]

**Рисунок 2. Пул ВМЗ**

При использовании интерфейсов API Пакетной службы пул можно создать напрямую или же настроить Пакетную службу так, чтобы он создавался автоматически, когда вы указываете работу, которую нужно выполнить. При использовании вами интерфейсов API приложений Пакетной службы пул создается автоматически во время запуска вами облачного приложения Пакетной службы.


Атрибуты пула включают в себя:

* [Размер](http://msdn.microsoft.com/library/azure/dn197896.aspx) ВМЗ.
* Операционная система ВМЗ.
* Максимальное количество ВМЗ.
* Правила масштабирования для пула — это формула, основанная на текущей рабочей нагрузке и использовании ресурсов, которая динамически настраивает количество обрабатывающих задачи ВМЗ.
* Доступные порты брандмауэра для обмена данными между ВМЗ внутри пула.
* Установленный на ВМЗ сертификат (например, для аутентификации доступа к учетной записи хранения).
* Задача запуска для ВМЗ — это операция, которая будет выполнена только один раз (например, установка приложений или скачивание данных для задач).

>[AZURE.NOTE]В настоящее время ВМЗ поддерживают только следующие операционные системы: Windows Server 2012 R2, Windows Server 2012 и Windows Server 2008 R2 с пакетом обновления 1 (SP1).

Пул может использоваться только той учетной записью Пакетной службы, с помощью которой он был создан. Учетная запись Пакетной службы может содержать более одного пула.

Каждой добавляемой к пулу ВМЗ присваивается уникальное имя и IP-адрес. При удалении ВМЗ из пула она теряет все изменения, внесенные в операционную систему, свои локальные файлы, назначенное имя и IP-адрес. Когда ВМЗ покидает пул, она перестает существовать.


### <a id="BKMK_Workitem">Рабочие элементы, задания и задачи</a>

**Рабочий элемент** — это шаблон, который определяет способ выполнения приложения на ВМЗ в пуле. **Задание** представляет собой запланированный экземпляр рабочего элемента и может выполняться как один раз, так и несколько. Задание состоит из набора **задач**. На рис. 3 показаны основные связи.

![Рабочий элемент, задание и задачи][job_task]

**Рисунок 3. Рабочий элемент, задание и задачи**

В зависимости от интерфейсов API, которые используются для разработки с использованием Пакетной службы, необходимо указывать ту или иную информацию о рабочих элементах, заданиях и задачах.

* При разработке приложения, которое работает с интерфейсами API Пакетной службы, необходимо программно определить все рабочие элементы, задания и задачи, а также настроить пулы ВМЗ.

* Если ваше клиентское приложение интегрируется с помощью API-интерфейсов приложений Пакетной службы и ее инструментов, вы можете использовать компоненты, которые автоматически разделят задания на задачи, выполнят обработку задач и слияние результатов отдельных задач в итоговый результат задания. При отправке рабочей нагрузки в Пакетную службу платформа приложений Пакетной службы управляет заданиями и выполняет задачи на ВМЗ.



### <a id="BKMK_Files">Файлы и каталоги</a>

Файл — это часть данных, которые используются в качестве входных данных для задания. Задача может содержать один или несколько связанных с ней входных файлов, либо не содержать их вообще. Файл может использоваться в нескольких задачах. Например, у задач визуализации фильма могут быть общие текстуры и модели. Для задач в задании анализа данных файлы могут содержать набор наблюдений или измерений.

У каждой задачи есть рабочий каталог, в котором хранятся обрабатываемые ею входные данные и создаваемые выходные данные. Во время выполнения задания эти каталоги и файлы доступны для использования в других задачах. Все задачи, файлы и каталоги в ВМЗ принадлежат одной учетной записи.

В зависимости от того, какие вы используете интерфейсы API Пакетной службы, вам надо будет указать ту или иную информацию о входных и выходных файлах для заданий и задач. При разработке приложения, которое работает с интерфейсами API Пакетной службы, необходимо явно указать все зависимости и правила перемещения файлов. При использовании приложений Пакетной службы большую часть этой работы платформа сделает за вас.

## Рабочие элементы рабочего процесса
На рис. 4 показана отправка приложения в пул, где оно распределяется для вычислений. Для этого используется API Пакетной службы.

![Рабочие элементы рабочего процесса][work_item_workflow]

**Рисунок 4. Рабочий процесс распределения рабочих элементов между виртуальными машинами пула**

1.	Передайте входные файлы (например, исходные данные или изображения) для задания учетной записи хранения Azure. Чтобы Пакетная служба имела к ним доступ, они должны находиться в учетной записи хранения. Пакетная служба передаст их в ВМЗ при выполнении задачи.
2.	Передайте зависимые двоичные файлы в учетную запись хранения. Двоичные файлы включают в себя программу, которая выполняется задачей, и зависимые сборки. Эти файлы также должны быть доступны из службы хранения и загружены в ВМЗ.
3.	Создайте пул ВМЗ, указав размер ВМЗ в пуле, операционную систему и другие свойства. Когда задача запускается, ей назначается ВМЗ из этого пула.
4.	Создайте рабочий элемент. Задание будет автоматически создано при создании рабочего элемента. Рабочий элемент позволяет управлять заданием, которое содержит задачи.
5.	Добавьте задачи в задание. Каждая задача использует переданную вами программу для обработки информации из переданного вами файла.
6.	Запустите приложение и отслеживайте полученные выходные данные.

## Рабочий процесс для публикации и выполнения приложений.
На рис. 5 показан основной рабочий процесс публикации приложения с помощью API приложений Пакетной службы с последующей передачей заданий в приложение Пакетной службы.

![Рабочий процесс публикации приложений][app_pub_workflow]

**Рисунок 5. Рабочий процесс публикации и запуска приложения с помощью приложений Пакетной службы**

1.	Подготовьте **образ приложения** — ZIP-файл с исполняемыми файлами приложения и всеми необходимыми файлами. Это могут быть те же исполняемые файлы, которые вы запускаете на традиционных фермах серверов или кластере.
2.	Создайте ZIP-файл с **облачной сборкой**, которая будет вызывать рабочие нагрузки и перенаправлять их в Пакетную службу. Облачная сборка содержит два компонента, которые доступны с помощью пакета SDK:

	а. **Разделитель заданий** разбивает задание на задачи, которые могут быть обработаны независимо друг от друга. Например, в сценарии анимации разделитель заданий будет принимать в качестве задания фильм и разбивать его на отдельные кадры.

	b. **Обработчик задач** вызывает исполняемый файл приложения для заданной задачи. Например, в сценарии анимации обработчик задач будет вызывать программу визуализации для обработки отдельного, указанного задачей кадра.

3.	Используйте интерфейсы API приложений Пакетной службы или инструменты разработчика, чтобы передать ZIP-файлы, подготовленные на двух предыдущих шагах, в учетную запись хранения Azure. Чтобы Пакетная служба имела к ним доступ, они должны находиться в учетной записи хранения. Обычно эта операция однократно выполняется администратором службы для каждого приложения.
4.	Укажите способ отправки заданий в приложение в Azure. Это может быть подключаемый модуль пользовательского интерфейса в приложении, веб-портал или автоматическая служба, которая является частью серверной системы. Все необходимые примеры, демонстрирующие различные варианты, можно найти в пакете SDK.

	Вот как можно выполнить задание:

	а. Передайте входные файлы задания пользователя (например, исходные данные или изображения). Чтобы Пакетная служба имела к ним доступ, они должны находиться в учетной записи хранения.

	b. Отправьте задание с необходимыми параметрами и списком файлов.

	c. Отслеживайте ход выполнения задания с помощью интерфейсов API или портала приложений Пакетной службы.

	г) Скачайте выходные данные.

## Дополнительные ресурсы

* [Приступая к работе с библиотекой Пакетной службы Azure для .NET](batch-dotnet-get-started.md)
* [Библиотеки и инструменты разработки Пакетной службы Azure](batch-development-libraries-tools.md)
* [Справочник по REST API Пакетной службы Azure](http://go.microsoft.com/fwlink/p/?LinkId=517803)
* [Справочник по REST API приложений Пакетной службы Azure](http://go.microsoft.com/fwlink/p/?LinkId=517804)

[parallel]: ./media/batch-technical-overview/parallel.png
[TVM_pool]: ./media/batch-technical-overview/TVM_pool.png
[job_task]: ./media/batch-technical-overview/job_task.png
[account_portal]: ./media/batch-technical-overview/account_portal.png
[work_item_workflow]: ./media/batch-technical-overview/work_item_workflow.png
[app_pub_workflow]: ./media/batch-technical-overview/app_pub_workflow.png

<!---HONumber=62-->