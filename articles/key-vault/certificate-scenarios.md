---
title: Начало работы с сертификатами Key Vault
description: Следующие сценарии описывают некоторые основные примеры использования службы управления сертификатами Key Vault, включая дополнительные действия, необходимые для создания первого сертификата в хранилище ключей.
services: key-vault
documentationcenter: ''
author: lleonard-msft
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: a788b958-3acb-4bb6-9c94-4776852aeea1
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/09/2018
ms.author: alleonar
ms.openlocfilehash: 5f3b8a7b9c7bf582ebc2fac2be8ff55134fbc6f2
ms.sourcegitcommit: 909469bf17211be40ea24a981c3e0331ea182996
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2018
---
# <a name="get-started-with-key-vault-certificates"></a>Начало работы с сертификатами Key Vault
Следующие сценарии описывают некоторые основные примеры использования службы управления сертификатами Key Vault, включая дополнительные действия, необходимые для создания первого сертификата в хранилище ключей.

Ниже описано:
- Создание первого сертификата Key Vault.
- Создание сертификата в центре сертификации (партнер Key Vault).
- Создание сертификата в центре сертификации (не партнер Key Vault).
- Импорт сертификата.

## <a name="certificates-are-complex-objects"></a>Сертификаты — составные объекты
Сертификаты состоят из трех взаимосвязанных ресурсов: метаданные сертификата, ключ и секрет; связанных друг с другом в виде сертификата Key Vault.


![Сертификаты являются составными](media/azure-key-vault.png)


## <a name="creating-your-first-key-vault-certificate"></a>Создание первого сертификата Key Vault  
 Перед созданием сертификата в Key Vault должны быть успешно выполнены обязательные шаги 1 и 2, а также должно существовать хранилище ключей для этого пользователя или организации.  

**Шаг 1** — поставщики центра сертификации (ЦС)  
-   Подключение ИТ-администратора, администратора PKI или любого управляющего учетными записями в центрах сертификации для данной компании (например, Contoso) является необходимым условием для использования сертификатов Key Vault.  
    Следующие центры сертификации являются партнерскими поставщиками Key Vault:  
    -   DigiCert — Key Vault предоставляет OV SSL-сертификаты в DigiCert.  
    -   GlobalSign — Key Vault предоставляет OV SSL-сертификаты в GlobalSign.  
    -   WoSign — Key Vault предоставляет OV SSL или EV SSL-сертификаты в WoSign на основе параметров, настроенных пользователем в своей учетной записи на портале WoSign.  

**Шаг 2** — администратор учетной записи создает для поставщика центра сертификации учетные данные, которые Key Vault использует для регистрации, обновления и использования SSL-сертификатов через Key Vault.

**Шаг 3** — администратор Contoso вместе с сотрудником Contoso (пользователь Key Vault), владеющим сертификатами, в зависимости от центра сертификации, может получить сертификат от администратора или непосредственно из учетной записи ЦС.  

-   Начните операцию добавления учетных данных в хранилище ключей с создания ресурса [издателя сертификата](https://docs.microsoft.com/rest/api/keyvault/certificate-issuers). 
    -   Например, MyDigiCertIssuer  
        -   Поставщик  
        -   Учетные данные — учетные данные учетной записи ЦС. Каждый ЦС имеет собственные данные.  

     Дополнительные сведения о создании учетных записей с помощью поставщиков ЦС см. в соответствующей записи [блога Key Vault](http://aka.ms/kvcertsblog).  

**Шаг 3.1** — настройте [контакты сертификатов](https://docs.microsoft.com/rest/api/keyvault/certificate-contacts) для уведомлений. Это контакт для пользователя Key Vault. Key Vault не требует этот шаг.  

Примечание. Этот процесс, шаг 3.1, — это разовая операция.  

## <a name="creating-a-certificate-with-a-ca-partnered-with-key-vault"></a>Создание сертификата в ЦС (партнер Key Vault)

![Создание сертификата с помощью партнерского центра сертификации Key Vault](media/certificate-authority-2.png)

**Шаг 4** — следующие описания соответствуют шагам, обозначенным зеленым цветом на предыдущей схеме.  
  (1) — На приведенной выше схеме приложение создает сертификат, который начинает создание ключа в хранилище ключей.  
  (2) — Key Vault отправляет запрос на SSL-сертификат в ЦС.  
  (3) — Приложение выполняет опрос (в процессе "цикл — ожидание") для Key Vault для завершения создания сертификата. После того как Key Vault получит ответ от ЦС с сертификатом x509, создание сертификата будет завершено.  
  (4) — В ответ на запрос Key Vault на SSL-сертификат ЦС отправляет SSL-сертификат X509.  
  (5) — Создание сертификата завершается слиянием сертификата X509 из ЦС.  

  Пользователь Key Vault создает сертификат согласно определенной политике.

  -   Повтор при необходимости.  
  -   Политика ограничений:  
      -   свойства X509;  
      -   свойства ключа;  
      -   ссылка на поставщика - > например, MyDigiCertIssure;  
      -   информация о продлении - > например, 90 дней до истечения срока действия.  

  - Процесс создания сертификата обычно асинхронный и включает опрос состояния операции создания сертификата в вашем хранилище ключей.  
[Получение операции с сертификатом](https://docs.microsoft.com/en-us/rest/api/keyvault/getcertificateoperation) — Состояние: выполнено, сбой с информацией об ошибке или отменено.  
            — Из-за задержки создания может инициироваться операция отмены. Отмена может подействовать или нет.  

## <a name="import-a-certificate"></a>Импорт сертификата  
 Альтернативный вариант: сертификат можно импортировать в Key Vault в виде файла формата PFX или PEM.  

 Дополнительные сведения о формате PEM см. в статье [о ключах, секретах и сертификатах](about-keys-secrets-and-certificates.md).  

 Импорт сертификата требует наличия на диске файла формата PEM или PFX и закрытого ключа. 
-   Необходимо указать имя хранилища и сертификата (политика необязательна).

-   PEM- или PFX-файлы содержат атрибуты, которые Key Vault может анализировать и использовать для заполнения политики сертификата. Если политика сертификата уже определена, то Key Vault попытается сопоставить данные из PFX- или PEM-файла.  

-   После окончания импорта в последующих операциях будет использоваться новая политика (новые версии).  

-   Если нет дополнительных операций, Key Vault в первую очередь отправит предупреждение об истечении срока. 

-   Кроме того, пользователь может редактировать политику, которая работает во время импорта, но содержит значения по умолчанию там, где информацию не указали при импорте. Например, нет информации по издателю  

## <a name="creating-a-certificate-with-a-ca-not-partnered-with-key-vault"></a>Создание сертификата в ЦС (не партнер Key Vault)  
 Этот метод позволяет работать с ЦС, отличными от поставщиков, сотрудничающих с Key Vault. Это означает, что ваша организация может работать с ЦС по своему выбору.  

![Создание сертификата с помощью собственного центра сертификации](media/certificate-authority-1.png)  

 Следующие описания соответствуют шагам, обозначенным зеленым цветом на предыдущей схеме.  

  (1) — На приведенной выше схеме приложение создает сертификат, который начинает создание ключа в хранилище ключей.  

  (2) — Key Vault возвращает приложению запрос на подпись сертификата (CSR).  

  (3) — Приложение передает CSR выбранному ЦС.  

  (4) — Выбранный ЦС отправляет сертификат X509.  

  (5) — Приложение завершает создание сертификата путем слияния сертификата X509 из ЦС.

## <a name="see-also"></a>См. также
- [Операции с сертификатами](/rest/api/keyvault/certificate-operations.md)
- [Сведения о ключах, секретах и сертификатах](about-keys-secrets-and-certificates.md)
