---
title: "Планирование развертывания службы синхронизации файлов Azure (предварительная версия) | Документация Майкрософт"
description: "Узнайте, что необходимо учесть при планировании развертывания службы \"Файлы Azure\"."
services: storage
documentationcenter: 
author: wmgries
manager: klaasl
editor: jgerend
ms.assetid: 297f3a14-6b3a-48b0-9da4-db5907827fb5
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/19/2017
ms.author: wgries
ms.translationtype: HT
ms.sourcegitcommit: c3a2462b4ce4e1410a670624bcbcec26fd51b811
ms.openlocfilehash: 3c003d498600a2cfd12ef2adfb7c16f9dfaddb37
ms.contentlocale: ru-ru
ms.lasthandoff: 09/25/2017

---

# <a name="planning-for-an-azure-file-sync-preview-deployment"></a>Планирование развертывания службы синхронизации файлов Azure (предварительная версия)
С помощью службы синхронизации файлов Azure (предварительная версия) можно реплицировать файловые ресурсы на локальные серверы Windows Server или в Azure. Затем вы и ваши пользователи можете получить доступ к файловому ресурсу через Windows Server, например через общий ресурс SMB или NFS. Это особенно полезно в сценариях, в которых доступ к данным и их изменение выполняются далеко за пределами центров обработки данных Azure, например как в сценарии с филиалом. Данные можно реплицировать между несколькими конечными точками Windows Server, например между несколькими филиалами. 

В этом руководстве описывается, что нужно учитывать при развертывании службы синхронизации файлов Azure. Мы рекомендуем ознакомиться с руководством по тестированию [Planning for an Azure Files deployment](storage-files-planning.md) (Планирование развертывания службы "Файлы Azure"). 

## <a name="understanding-azure-file-sync-terminology"></a>Основные сведения о терминологии службы синхронизации файлов Azure
Прежде чем перейти к подробностям о службе синхронизации файлов Azure, необходимо понять терминологию.

### <a name="storage-sync-service"></a>Служба синхронизации хранилища
Служба синхронизации хранилища — это ресурс Azure верхнего уровня, представляющий службу синхронизации файлов Azure. Ресурс службы синхронизации хранилища является одноранговым в отношении ресурса учетной записи хранения, поэтому его можно развернуть в группах ресурсов Azure. Необходим отдельный ресурс верхнего уровня в ресурсе учетной записи хранения, так как служба синхронизации хранилища может создавать синхронизированные связи с несколькими учетными записями хранения через несколько групп синхронизации. В подписке может быть развернуто несколько ресурсов служб синхронизации хранилища.

### <a name="sync-group"></a>Группа синхронизации
Группа синхронизации определяет топологию синхронизации для набора файлов. Конечные точки в группе синхронизации будут синхронизированы друг с другом. Если, например, есть два отдельных набора файлов, которыми можно управлять с помощью AFS, следует создать две группы синхронизации и добавить различные конечные точки для каждой. Служба синхронизации хранилища может содержать любое количество групп синхронизации.  

### <a name="registered-server"></a>Зарегистрированный сервер
Объект "Зарегистрированный сервер" представляет собой отношение доверия между сервером (или кластером) и службой синхронизации хранилища. В экземпляре службы синхронизации хранилища можно зарегистрировать любое необходимое количество серверов. Тем не менее сервер (или кластер) можно зарегистрировать только в одной службе синхронизации хранилища в любой момент времени.

### <a name="azure-file-sync-agent"></a>Агент службы синхронизации файлов Azure
Агент службы синхронизации файлов Azure — это скачиваемый пакет, позволяющий синхронизировать Windows Server с общим файловым ресурсом Azure. Агент службы синхронизации файлов Azure состоит из трех основных компонентов: 
- **FileSyncSvc.exe** — фоновая служба Windows, отвечающая за отслеживание изменений в конечных точках сервера и запуск сеансов синхронизации в Azure.
- **StorageSync.sys** — фильтр файловой системы службы синхронизации файлов Azure, отвечающий за распределение файлов по уровням компонента "Файлы Azure" (если включено распределение по уровням облака).
- **Командлеты управления PowerShell** для взаимодействия с поставщиком ресурсов Azure Microsoft.StorageSync. Их можно найти в следующих расположениях (по умолчанию):
    - C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.PowerShell.Cmdlets.dll;
    - C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll.

### <a name="cloud-endpoint"></a>Конечная точка облака
Конечная точка облака является общим файловым ресурсом Azure, который входит в группу синхронизации. Все операции синхронизации общих файловых ресурсов Azure и файловые ресурсы Azure могут входить только в одну облачную конечную точку и, таким образом, в одну группу синхронизации. При добавлении файлового ресурса Azure с имеющимся набором файлов в качестве облачной конечной точки в группу синхронизации эти файлы будут объединены с любыми другими файлами, которые уже находятся в других конечных точках в группах синхронизации.

### <a name="server-endpoint"></a>Конечная точка сервера
Конечная точка сервера представляет собой определенное расположение на зарегистрированном сервере, например папка в томе сервера или в корне тома. В томе могут располагаться несколько конечных точек сервера, если их пространства имен не перекрываются (например, F:\sync1 и F:\sync2). Политики распределения по уровням облака можно настроить отдельно для каждой конечной точки сервера. При добавлении расположения сервера с имеющимся набором файлов в качестве конечной точки сервера в группу синхронизации эти файлы будут объединены с любыми другими файлами, которые уже находятся в других конечных точках в группе синхронизации.

### <a name="cloud-tiering"></a>Распределение по уровням облака 
Распределение по уровням облака является дополнительным компонентом службы синхронизации файлов Azure, который позволяет распределять редко используемые файлы по уровням компонента "Файлы Azure". При распределении файла фильтр файловой системы службы синхронизации файлов Azure (StorageSync.sys) локально заменяет файл указателем или точкой повторного анализа, представляющей URL-адрес файла в решении "Файлы Azure". Распределенный по уровням файл имеет автономный атрибут, установленный в NTFS, чтобы сторонние приложения могли идентифицировать такие файлы. При открытии файла, распределенного по уровням, служба синхронизации файлов Azure с легкостью отзовет данные файлов из службы "Файлы Azure" без необходимости уведомлять пользователя о том, что файл не хранится локально в системе. Эта возможность известна также как управление иерархическим хранением (HSM).

## <a name="azure-file-sync-interoperability"></a>Взаимодействие службы синхронизации файлов Azure 
В этом разделе описывается взаимодействие службы синхронизации файлов Azure с компонентами и ролями Windows Server, а также с решениями сторонних производителей.

### <a name="supported-versions-of-windows-server"></a>Поддерживаемые версии Windows Server
Сейчас служба синхронизации файлов Azure поддерживает такие версии Windows Server:

| Version (версия) | Поддерживаемые номера SKU | Поддерживаемые варианты развертывания |
|---------|----------------|------------------------------|
| Windows Server 2016 | Datacenter и Standard | Полное (сервер с пользовательским интерфейсом) |
| Windows Server 2012 R2 | Datacenter и Standard | Полное (сервер с пользовательским интерфейсом) |

Будущие версии Windows Server будут добавляться по мере выпуска, а старые версии Windows — по требованию пользователей.

> [!Important]  
> Мы рекомендуем постоянно обновлять серверы Windows Server, используемые со службой синхронизации файлов Azure, используя последние обновления из Центра обновления Windows. 

### <a name="file-system-features"></a>Возможности файловой системы
| Функция | Состояние поддержки | Примечания |
|---------|----------------|-------|
| Списки управления доступом (ACL) | Полностью поддерживается | Списки управления доступом Windows сохраняются службой синхронизации файлов Azure и принудительно используются Windows Server в конечных точках сервера. Списки управления доступом Windows пока не поддерживаются в службе "Файлы Azure", если доступ к ней осуществляется напрямую в облаке. |
| Жесткие связи | Skipped | |
| Символические связи | Skipped | |
| Точки подключения | Частично поддерживаются | Точки подключения могут быть корнем конечной точки сервера, но будут пропущены, если содержатся в пространстве имен конечной точки сервера. |
| Соединения | Skipped | |
| Точки повторного анализа | Skipped | |
| Сжатие NTFS | Полностью поддерживается | |
| Разреженные файлы | Полностью поддерживается | Разреженные файлы будут синхронизироваться (не блокируются) в облако в качестве полного файла. При изменении содержимого файла в облаке (или на другом сервере) он перестанет быть разреженным при скачивании измененной версии. |
| Альтернативные потоки данных (ADS) | Сохраняются, но не синхронизируются | |

> [!Note]  
> Поддерживаются только тома NTFS.

### <a name="failover-clustering"></a>Отказоустойчивая кластеризация
Служба синхронизации файлов Azure поддерживает отказоустойчивую кластеризацию Windows Server для варианта развертывания "Файловый сервер общего использования". Отказоустойчивая кластеризация не поддерживается в вариантах "Масштабируемый файловый сервер для данных приложения" (SOFS) или в общих томах кластеров (CSV).

> [!Note]  
> Агент службы синхронизации файлов Azure должен быть установлен на каждом узле отказоустойчивого кластера для правильной работы синхронизации.

### <a name="windows-server-data-deduplication"></a>Дедупликация данных Windows Server
Для томов без распределения по уровням облака служба синхронизации файлов Azure поддерживает включение дедупликации данных. Сейчас взаимодействие между службой синхронизации файлов Azure с распределением по уровням облака и дедупликацией данных не поддерживается.

### <a name="anti-virus-solutions"></a>Антивирусные решения
Антивирусные программы работают путем сканирования файлов на наличие известного вредоносного кода, поэтому они могут вызвать отзыв файлов, распределенных по уровням. Так как для многоуровневых файлов задан автономный атрибут, мы рекомендуем обратиться к поставщику программного обеспечения за информацией о том, как настроить решение, чтобы пропускать чтение автономных файлов. 

В следующих решениях поддерживается пропуск автономных файлов:

- [Symantec Endpoint Protection](https://support.symantec.com/en_US/article.tech173752.html);
- [McAfee EndPoint Security](https://kc.mcafee.com/resources/sites/MCAFEE/content/live/PRODUCT_DOCUMENTATION/26000/PD26799/en_US/ens_1050_help_0-00_en-us.pdf) (дополнительные сведения см. в разделе "Проверка только необходимых ресурсов" на странице 90);
- [Kaspersky Anti-Virus](https://support.kaspersky.com/4684);
- [Sophos Endpoint Protection](https://community.sophos.com/kb/en-us/40102);
- [TrendMicro OfficeScan](https://success.trendmicro.com/solution/1114377-preventing-performance-or-backup-and-restore-issues-when-using-commvault-software-with-osce-11-0#collapseTwo). 

### <a name="backup-solutions"></a>Решения для архивации
Как и антивирусные решения, решения для архивации могут привести к отзыву многоуровневых файлов. Для архивации файловых ресурсов Azure мы рекомендуем использовать облачное решение для архивации, а не локальное.

### <a name="encryption-solutions"></a>Решения для шифрования
Поддержка для решений шифрования зависит от их реализации. Служба синхронизации файлов Azure точно работает со следующими компонентами и функциями:

- шифрование BitLocker;
- Azure RMS (и устаревшая версия Active Directory RMS).

Служба синхронизации файлов Azure точно не работает со следующими компонентами:

- зашифрованная с помощью NTFS файловая система (EFS).

В целом служба синхронизации файлов Azure должна взаимодействовать с решениями для шифрования, расположенными под файловой системой, например BitLocker, и решениями, реализованными в формате файла, такими как BitLocker. Однако не предусмотрено специального вида взаимодействия с решениями, которые расположены над файловой системой (например, зашифрованная с помощью NTFS файловая система).

### <a name="other-hierarchical-storage-management-hsm-solutions"></a>Другие решения по управлению иерархическим хранением (HSM)
Со службой синхронизации файлов Azure не следует использовать другие решения по управлению иерархическим хранением.

## <a name="region-availability"></a>Регионы доступности
Предварительная версия службы синхронизации файлов Azure доступна только в таких регионах:

| Регион | Расположение центра обработки данных |
|--------|---------------------|
| Запад США | Калифорния, США |
| Западная Европа | Нидерланды |
| Юго-Восточная Азия | Сингапур |
| Восточная часть Австралии | Новый Южный Уэльс, Австралия |

В предварительной версии поддерживается только синхронизация с файловым ресурсом Azure в том же регионе, что и служба синхронизации хранилища.

## <a name="azure-file-sync-agent-update-policy"></a>Политика обновления агента службы синхронизации файлов Azure
Обновления агента службы синхронизации файлов Azure будут выпускаться на регулярной основе, чтобы добавить новые возможности и устранить возможные найденные ошибки. Мы рекомендуем включить Центр обновления Майкрософт, чтобы получать все обновления службы синхронизации файлов Azure по мере их выпуска. С другой стороны, мы понимаем, что некоторые организации могут строго контролировать обновления. Для развертываний, использующих более ранние версии агента службы синхронизации файлов Azure:

- Служба синхронизации хранилища будет поддерживать предыдущую основную версию в течение трех месяцев после первоначального выпуска новой основной версии. Например, версия 1.\* будет поддерживаться службой синхронизации хранилища в течение трех месяцев после выпуска версии 2.\*
- По истечении трех месяцев служба синхронизации хранилища начнет блокировать синхронизацию зарегистрированных серверов, использующих версию с истекшим сроком действия, с соответствующими группами синхронизации.
- В течение трех месяцев поддержки предыдущей основной версии все исправления ошибок будут отправляться в текущую основную версию.

## <a name="next-steps"></a>Дальнейшие действия
* [Planning for an Azure Files deployment](storage-files-planning.md) (Планирование развертывания службы файлов Azure)
* [How to deploy Azure Files](storage-files-deployment-guide.md) (Развертывание службы "Файлы Azure")
* [Развертывание службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-deployment-guide.md)

