---
title: "Обзор управляемых дисков Azure класса Premium и Standard | Документация Майкрософт"
description: "Обзор управляемых дисков Azure, которые отвечают за управление учетными записями хранения, используемыми для виртуальных машин Azure"
services: storage
documentationcenter: na
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 272250b3-fd4e-41d2-8e34-fd8cc341ec87
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: robinsh
translationtype: Human Translation
ms.sourcegitcommit: 0c4554d6289fb0050998765485d965d1fbc6ab3e
ms.openlocfilehash: 53bd62688aa0d1a06d2d012c8da664d2de4b0b45
ms.lasthandoff: 04/13/2017


---

# <a name="azure-managed-disks-overview"></a>Обзор управляемых дисков Azure

Управляемые диски Azure упрощают управление дисками виртуальных машин Azure IaaS. Они управляют [учетными записями хранения](storage-introduction.md), связанными с этими дисками. Вам нужно лишь выбрать класс ([Premium](storage-premium-storage.md) или [Standard](storage-standard-storage.md)) и размер диска, а Azure самостоятельно создаст диск и будет управлять им.

>[!NOTE]
>Для виртуальных машин с управляемыми дисками требуется передавать исходящий трафик через порт 8443 для уведомления платформы Azure о состоянии установленных [расширений виртуальной машины](../virtual-machines/windows/extensions-features.md). Подготовка расширений виртуальной машины завершится сбоем, если этот порт закрыт. Кроме того, если установить расширение на работающую виртуальную машину с закрытым портом 8443, его состояние будет неизвестным. Если вы не можете открыть этот порт, нужно использовать неуправляемые диски. Мы активно работаем над устранением этой проблемы. Дополнительные сведения можно получить, ознакомившись с [часто задаваемыми вопросами о дисках виртуальной машины IaaS](storage-faq-for-disks.md#managed-disks-and-port-8443). 
>
>

## <a name="benefits-of-managed-disks"></a>Преимущества управляемых дисков

Рассмотрим некоторые преимущества использования управляемых дисков.

### <a name="simple-and-scalable-vm-deployment"></a>Простое и масштабируемое развертывание виртуальной машины

Управляемые диски управляют хранилищем в фоновом режиме. Чтобы хранить диски (VHD-файлы) для виртуальных машин Azure, раньше приходилось создавать учетные записи хранения. При выполнении масштабирования нужно было создавать дополнительные учетные записи хранения, чтобы не превысить предел операций ввода-вывода в секунду для дисков. При использовании хранилища, которое управляется с помощью управляемых дисков, ограничения для учетной записи хранения (например, 20 000 операций ввода-вывода в секунду на учетную запись) отсутствуют. Больше не требуется копировать пользовательские образы (VHD-файлы) в несколько учетных записей хранения. Вы можете управлять ими в одной учетной записи хранения на каждый регион Azure и использовать их для создания сотен виртуальных машин в одной подписке.

При использовании управляемых дисков можно создавать до 10 000 **дисков** виртуальных машин в подписке, что дает возможность создавать тысячи **виртуальных машин** в пределах одной подписки. Эта функция также повышает масштабируемость [масштабируемых наборов виртуальных машин (VMSS)](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md), позволяя создавать до тысячи виртуальных машин в VMSS с помощью образа Marketplace.

### <a name="better-reliability-for-availability-sets"></a>Повышенная надежность групп доступности

Управляемые диски обеспечивают более высокую надежность групп доступности. При их использовании диски разных виртуальных машин в группе доступности достаточно изолированы друг от друга, что позволяет избежать одиночных точек сбоя. Это достигается за счет автоматического размещения дисков в разных единицах масштабирования (стеках). В случае сбоя стека из-за проблем с оборудованием или программным обеспечением выйдет из строя только тот экземпляр виртуальной машины, диски которой расположены в этом стеке. Предположим, есть приложение, запущенное на пяти виртуальных машинах, расположенных в одной группе доступности. Диски этих виртуальных машин не хранятся в одном стеке, поэтому если один стек выйдет из строя, другие экземпляры приложения продолжат работу.

### <a name="granular-access-control"></a>Детальный контроль доступа

Вы можете использовать [управление доступом на основе ролей в Azure](../active-directory/role-based-access-control-what-is.md), чтобы назначить определенные разрешения на управляемые диски одному или нескольким пользователям. Управляемые диски позволяют выполнять различные операции, в том числе чтение, запись (создание или обновление), удаление и извлечение [универсального кода ресурса (URI) подписанного URL-адреса (SAS) ](storage-dotnet-shared-access-signature-part-1.md) для диска. Вы можете предоставить пользователям доступ только к тем операциям, которые необходимы им для выполнения определенного задания. Если вы не хотите, чтобы пользователь имел возможность копировать управляемые диски в учетную запись хранения, можно не предоставлять ему доступ к действию экспорта для этого управляемого диска. Если вы не хотите, чтобы пользователь использовал URI SAS для копирования управляемого диска, можно не предоставлять ему такое разрешение для этого диска.

### <a name="azure-backup-service-support"></a>Поддержка службы архивации Azure 
Используйте службу архивации Azure для Управляемых дисков, чтобы создать задание архивации с учетом времени, политики хранения резервных копий и выполнять быстрое восстановление виртуальной машины. Управляемые диски поддерживают только локально избыточное хранилище как вариант репликации. Это означает, что на них сохраняется три копии данных в пределах одного региона. Для регионального аварийного восстановления необходимо создать резервную копию дисков виртуальной машины в другом регионе с использованием [службы архивации Azure](../backup/backup-introduction-to-azure-backup.md) и учетной записи хранения GRS в качестве хранилища архивации. Дополнительные сведения см. в разделе [Использование службы архивации Azure для виртуальных машин, запущенных на управляемых дисках](../backup/backup-introduction-to-azure-backup.md#using-managed-disk-vms-with-azure-backup). 

## <a name="pricing-and-billing"></a>Цены и выставление счетов 

При использовании управляемых дисков счета выставляются за следующее:

* тип хранилища;

* Размер диска

* количество транзакций;

* Передача исходящих данных

* моментальные снимки управляемого диска (полная копия диска).

Рассмотрим это подробнее.

**Тип хранилища.** Для управляемых дисков доступны два уровня производительности: класс [Premium](storage-premium-storage.md) (на базе SSD) и класс [Standard](storage-standard-storage.md) (на базе жестких дисков). Плата, взимаемая за использование управляемых дисков, зависит от того, какой тип хранилища выбран для диска.


**Размер диска.** Выставление счета за использование управляемых дисков зависит от размера подготовленного диска. Служба Azure сопоставляет размер подготовленного диска (округленный) с ближайшим вариантом управляемого диска, как указано в таблице ниже. Каждый диск сопоставляется с одним из поддерживаемых подготовленных размеров, и за него выставляются соответствующие счета. Например, если создать управляемый диск класса Standard и указать подготавливаемый размер 200 ГБ, будет выставлен счет согласно цене диска типа S20.

Ниже приведены размеры для управляемых дисков класса Premium.

| **Управляемые диски <br>класса Premium**  | **P10** | **P20** | **P30**        |
|------------------|---------|---------|----------------|
| Размер диска        | 128 ГБ  | 512 ГБ  | 1024 ГБ (1 ТБ) |

Ниже приведены размеры для управляемых дисков класса Standard. 

| **Управляемые диски <br>класса Standard** | **S4**  | **S6**  | **S10**        | **S20** | **S30**        |
|------------------|---------|---------|----------------|---------|----------------|
| Размер диска        | 32 ГБ   | 64 ГБ   | 128 ГБ  | 512 ГБ  | 1024 ГБ (1 ТБ) |

**Число транзакций.** Счет выставляется за количество транзакций, выполняемых на управляемом диске класса Standard. Плата за транзакции, выполняемые на управляемых дисках класса Premium, не взимается.

**Передача исходящих данных.** [Передача исходящих данных](https://azure.microsoft.com/pricing/details/data-transfers/) (данные, передаваемые из центров обработки данных Azure) учитывается при определении платы за используемую пропускную способность.

**Моментальные снимки управляемых дисков (полная копия диска).** Моментальный снимок управляемого диска — это копия диска, предназначенная только для чтения и хранимая в качестве управляемого диска класса Standard. С помощью моментальных снимков можно архивировать управляемые диски на любой момент времени. Эти моментальные снимки могут существовать независимо от исходного диска и использоваться для создания других управляемых дисков. Стоимость моментального снимка управляемого диска совпадает со стоимостью управляемого диска класса Standard. Например, если вы создадите моментальный снимок управляемого диска класса Premium с объемом 128 ГБ, то цена моментального снимка управляемого диска будет равна цене управляемого диска класса Standard с объемом 128 ГБ.

В настоящее время [добавочные моментальные снимки](storage-incremental-snapshots.md) не поддерживаются управляемыми дисками. Но это будет изменено в будущем.

Дополнительные сведения о создании моментальных снимков управляемых дисков см. в следующих статьях:

* [Создание копии диска VHD, хранящегося в виде управляемого диска, с использованием моментальных снимков в Windows](../virtual-machines/windows/snapshot-copy-managed-disk.md)
* [Создание копии диска VHD, хранящегося в виде управляемого диска, с использованием моментальных снимков в Linux](../virtual-machines/linux/snapshot-copy-managed-disk.md)


Дополнительные сведения о ценах на управляемые диски см. на [этой странице](https://azure.microsoft.com/pricing/details/managed-disks).

## <a name="images"></a>Образы

Управляемые диски также поддерживают создание управляемых пользовательских образов. Вы можете создать образ из пользовательского VHD-файла в учетной записи хранения или непосредственно из обобщенной (подготовленной с помощью программы sysprep) виртуальной машины. В одном образе сохраняются все управляемые диски, связанные с виртуальной машиной, включая диски операционной системы и диски данных. Таким образом, вы можете создавать сотни виртуальных машин с помощью пользовательского образа без необходимости копировать все учетные записи хранения или управлять ими.

Дополнительные сведения о создании образов см. в следующих статьях:
* [How to capture a managed image of a generalized VM in Azure](../virtual-machines/windows/capture-image-resource.md) (Как создать управляемый образ обобщенной виртуальной машины в Azure)
* [Как подготовить к работе и записать образ виртуальной машины Linux с помощью Azure CLI 2.0](../virtual-machines/linux/capture-image.md)

## <a name="images-versus-snapshots"></a>Образы и моментальные снимки

Часто вместе со словом "виртуальная машина" используется слово "образ". Далее в тексте также будет использоваться термин "моментальный снимок". Важно понять разницу между ними. При использовании управляемых дисков можно создать образ освобожденной обобщенной виртуальной машины. Этот образ будет содержать все диски, присоединенные к виртуальной машине. Его можно использовать для создания новой виртуальной машины, которая также будет содержать все диски.

Моментальный снимок — это копия диска на определенный момент времени. Он применяется только к одному диску. При наличии виртуальной машины, которая имеет только один диск (диск операционной системы), можно создать моментальный снимок или образ, а затем на основе одного из них создать виртуальную машину.

Что делать, если есть виртуальная машина с пятью дисками, которые чередуются? Вы можете создать моментальный снимок каждого диска, но виртуальная машина не будет осведомлена о состоянии других дисков. Для моментальных снимков доступны сведения только об одном диске. В этом случае моментальным снимкам потребуется взаимная координация, что в настоящее время не поддерживается.

## <a name="managed-disks-and-encryption"></a>Управляемые диски и шифрование

Управляемые диски предусматривают два вида шифрования. Первый из них — это шифрование службы хранилища (SSE), которое выполняет служба хранилища, второй — шифрование дисков Azure, которые можно включить на дисках операционной системы и данных для виртуальных машин. 

### <a name="storage-service-encryption-sse"></a>шифрования службы хранилища (SSE)

Служба хранилища Azure поддерживает автоматическое шифрование данных при их записи в учетную запись хранения. Дополнительные сведения см. в статье [Шифрование службы хранилища Azure для неактивных данных (предварительная версия)](storage-service-encryption.md). Как насчет данных управляемых дисков? Сейчас невозможно включить шифрование службы хранилища для Управляемых дисков. Тем не менее эта возможность будет добавлена в будущем. Пока нужно знать, как использовать VHD-файл, который находится в зашифрованной учетной записи хранения и является зашифрованным. 

Данные шифруются с помощью шифрования службы хранилища во время записи в учетную запись хранения. Если у вас есть VHD-файл, который когда-либо был зашифрован с помощью SSE, его нельзя использовать для создания виртуальной машины, использующей управляемые диски. Кроме того, зашифрованный неуправляемый диск нельзя преобразовать в управляемый диск. И наконец, если отключить шифрование для этой учетной записи хранения, существующий VHD-файл не будет расшифрован. 

Чтобы использовать зашифрованный диск, сначала необходимо скопировать VHD-файл в учетную запись хранения, которая никогда не была зашифрована. Затем можно создать виртуальную машину с управляемыми дисками с указанием этого VHD-файла в процессе создания или присоединить скопированный VHD-файл к работающей виртуальной машине с управляемыми дисками. 

### <a name="azure-disk-encryption-ade"></a>Шифрование дисков Azure

Шифрование дисков Azure позволяет шифровать диски ОС и диски данных, используемые виртуальными машинами IaaS. Сюда входят и Управляемые диски. Для Windows диски шифруются с помощью стандартной отраслевой технологии шифрования BitLocker. Для Linux диски шифруются с помощью технологии DM-Crypt. Функция интегрируется с хранилищем ключей Azure, что позволяет управлять ключами шифрования дисков. Дополнительные сведения см. в статье [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](../security/azure-security-disk-encryption.md).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об управляемых дисках см. в приведенных ниже статьях.

### <a name="get-started-with-managed-disks"></a>Начало работы с управляемыми дисками 

* [Создание виртуальной машины с помощью Resource Manager и PowerShell](../virtual-machines/virtual-machines-windows-ps-create.md)

* [Создание виртуальной машины Linux с помощью Azure CLI 2.0](../virtual-machines/linux/quick-create-cli.md)

* [Attach a managed data disk to a Windows VM using PowerShell](../virtual-machines/windows/attach-disk-ps.md) (Присоединение управляемого диска данных к виртуальной машине Windows с помощью PowerShell)

* [Добавление управляемого диска к виртуальной машине Linux](../virtual-machines/linux/add-disk.md)

### <a name="compare-managed-disks-storage-options"></a>Сравнение вариантов хранилищ управляемых дисков 

* [Высокопроизводительное хранилище класса Premium, а также неуправляемые и управляемые диски виртуальной машины Azure](storage-premium-storage.md)

* [Экономичное хранилище класса Standard, а также управляемые и неуправляемые диски виртуальной машины Azure](storage-standard-storage.md)

### <a name="operational-guidance"></a>Операционное руководство

* [Миграция из AWS и других платформ на управляемые диски Azure](../virtual-machines/windows/on-prem-to-azure.md)

* [Migrate Azure VMs to Managed Disks in Azure](../virtual-machines/windows/migrate-to-managed-disks.md) (Перенос виртуальных машин Azure на управляемые диски Azure)

