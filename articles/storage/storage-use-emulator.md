<properties 
	pageTitle="Использование эмулятора хранения Azure для разработки и тестирования" 
	description="Информация о том, как использовать эмулятор хранения Azure для разработки и тестирования" 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor=""/>
<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/20/2015" 
	ms.author="tamram"/>

# Использование эмулятора хранения Azure для разработки и тестирования

## Обзор
Эмулятор службы хранилища Microsoft Azure предоставляет собой локальную среду, эмулирующую службы BLOB-объектов, очередей и таблиц для целей разработки. Используя эмулятор хранилища, можно протестировать приложение со службами хранилища локально, не неся никаких затрат.

> [AZURE.NOTE] Эмулятор хранения доступен как часть пакета SDK для Microsoft Azure. Его также можно установить в качестве автономного пакета.
Чтобы настроить эмулятор хранения, необходимо обладать правами администратора на компьютере. 
> Обратите внимание, что данные, созданные в одной версии эмулятора хранения, могут быть недоступны при использовании другой версии. Если нужно сохранить данные на длительный срок, рекомендуется хранить их в учетной записи хранения Azure, а не в эмуляторе хранения.
 
Существует ряд отличий между эмулятором хранения и службой хранилища Azure. Подробную информацию об этих различиях см. в статье [Различия между эмулятором хранилища и службами хранилища Azure](https://msdn.microsoft.com/library/azure/gg433135.aspx).

Эмулятор хранения использует экземпляр Microsoft(r) SQL Server(tm) и локальную файловую систему для эмуляции служб хранилища Azure. По умолчанию эмулятор хранения настроен для использования базы данных Express LocalDB в Microsoft(r) SQL Server(tm) 2012. Вы можете установить SQL Server Management Studio Express для управления установкой LocalDB. Эмулятор хранения подключается к SQL Server или LocalDB с использованием аутентификации Windows. Вы можете настроить эмулятор хранения для доступа к локальному экземпляру SQL Server вместо LocalDB, следуя указаниям в "Справочнике по программе командной строки эмулятора хранения".

## Аутентификация запросов

Эмулятор хранения поддерживает только одну предопределенную учетную запись и известный ключ аутентификации. Эти учетная запись и ключ - единственные разрешенные учетные данные для использования с эмулятором хранения. К ним относятся:

    Account name: devstoreaccount1
    Account key: Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtrKBHBeksoGMGw==
    
> [AZURE.NOTE] Ключ аутентификации, поддерживаемый эмулятором хранения, предназначен только для тестирования работы клиентского кода. Его использование не гарантирует защиту. Нельзя использовать рабочую учетную запись хранения и ключ для эмулятора хранения. Учтите также, что не следует использовать учетную запись разработки с рабочими данными.
 

## Запуск и инициализация эмулятора хранения
Чтобы запустить эмулятор хранения Azure, нажмите кнопку "Пуск" или клавишу Windows. Начните вводить "Эмулятор хранения Azure" и выберите его в списке приложений. 

Кроме того, если эмулятор вычислений Azure уже запущен, вы можете запустить эмулятор хранения, щелкнув правой кнопкой мыши значок на панели задач и выбрав в меню "Запуск эмулятора хранения". Дополнительную информацию о запуске эмулятора вычислений см. в разделе [Запуск приложения Azure в эмуляторе вычислений](https://msdn.microsoft.com/library/azure/hh403990.aspx).

Когда эмулятор хранения запустится, появится окно командной строки. Вы можете использовать командную строку для запуска и остановки эмулятора хранения, а также для очистки данных, получения текущего состояния и инициализации эмулятора. Дополнительную информацию см. в разделе [Справочник по программе командной строки эмулятора хранения](https://msdn.microsoft.com/library/azure/gg433005.aspx).

Когда окно командной строки закрывается, эмулятор хранения продолжает работать. Чтобы снова вызвать окно командной строки, повторите приведенные выше действия, как если бы снова запускали эмулятор хранения.


При первом запуске эмулятора хранения инициализируется локальная среда хранения. Вы можете использовать программу командной строки эмулятора хранения для указания другого экземпляра базы данных или для повторной инициализации существующей базы данных. В процессе инициализации создается база данных в LocalDB и резервируются порты HTTP для каждой локальной службы хранилища. Для выполнения этого шага требуются права администратора. Дополнительную информацию см. в разделе [Справочник по программе командной строки эмулятора хранения](https://msdn.microsoft.com/library/azure/gg433005.aspx).

## Информация об URI служб хранилища

Способ обращения к ресурсу в службах хранилища Azure зависит от того, где находится ресурс: в Azure или в службах эмулятора хранения. Одна схема URI используется для обращения к ресурсу хранилища в Azure, а другая - для обращения к ресурсу хранилища в эмуляторе хранения. Различие вызвано тем, что локальный компьютер не выполняет разрешение доменных имен. Обе схемы URI всегда включают имя учетной записи и адрес запрашиваемого ресурса.

## Обращение к ресурсам службы хранилища Azure в облаке

В схеме URI для обращения к ресурсам хранилища в Azure имя учетной записи представляет собой часть имени узла URI, а ресурс, к которому выполняется обращение, - часть пути URI. Для доступа к ресурсам хранилища используется следующая стандартная схема адресации:

    <http|https>://<account-name>.<service-name>.core.windows.net/<resource-path>


`<account-name>` - имя вашей учетной записи хранения, `<service-name>` - имя службы, к которой осуществляет доступ, а `<resource-path>` - путь к запрашиваемому ресурсу. Ниже перечислены схемы URI для каждой службы хранилища.

	Blob Service: <http|https>://<account-name>.blob.core.windows.net/<resource-path>
	Queue Service: <http|https>://<account-name>.queue.core.windows.net/<resource-path>
	Table Service: <http|https>://<account-name>.table.core.windows.net/<resource-path>

Например, следующий адрес можно использовать для получения доступа к большому двоичному объекту в облаке:
    
    http://myaccount.blob.core.windows.net/mycontainer/myblob.txt

> [AZURE.NOTE] Можно также связать имя пользовательского домена с конечной точкой хранилища больших двоичных объектов в облаке и использовать это имя пользовательского домена для обращения к большим двоичным объектам и контейнерам. См. статью 
 
## Обращение к локальным ресурсам службы хранилища Azure в эмуляторе хранения

В эмуляторе хранения имя учетной записи является частью пути URI, так как локальный компьютер не выполняет разрешение доменных имен. Схема URI для ресурса, выполняемого в эмуляторе хранения, выглядит следующим образом:

    http://<local-machine-address>:<port>/<account-name>/<resource-path>

При обращения к ресурсам, выполняемым в эмуляторе хранения, используйте следующий формат:

	Blob Service: http://127.0.0.1:10000/<account-name>/<resource-path>
	Queue Service: http://127.0.0.1:10001/<account-name>/<resource-path>
	Table Service: http://127.0.0.1:10002/<account-name>/<resource-path>

Например, следующий адрес можно использовать для получения доступа к большому двоичному объекту в эмуляторе службы хранилища:

    http://127.0.0.1:10000/myaccount/mycontainer/myblob.txt

> [AZURE.NOTE] Протокол HTTPS не разрешен для обращения к ресурсам локального хранилища.
 
## Обращение к вторичному расположению через учетную запись с помощью RA-GRS
Начиная с версии 3.1, учетная запись эмулятора хранения поддерживает геоизбыточную репликацию с доступом только для чтения (RA-GRS). Чтобы использовать ресурсы хранилища в облаке или локальном эмуляторе, вы можете получить доступ к вторичному расположению, добавив -secondary к имени учетной записи. Например, следующий адрес можно использовать для получения доступа к большому двоичному объекту с помощью вторичного только для чтения в эмуляторе службы хранилища:

    http://127.0.0.1:10000/myaccount-secondary/mycontainer/myblob.txt 

> [AZURE.NOTE] Для программного доступа к вторичному расположению с помощью эмулятора хранения используйте клиентскую библиотеку хранилища для .NET 3.2 или более поздней версии. Дополнительную информацию см. в разделе "Справочник по клиентской библиотеке хранилища".
 
## Инициализация эмулятора хранения с помощью программы командной строки
Вы можете использовать программу командной строки эмулятора хранения, чтобы инициализировать эмулятор хранения для указания экземпляра базы данных, отличного от экземпляра по умолчанию. Если вы хотите использовать экземпляр базы данных LocalDB по умолчанию, не нужно выполнять отдельный шаг инициализации.

Эта программа устанавливается по умолчанию в каталог C:\Program Files(x86)\Microsoft SDKs\Azure\Storage Emulator. Инициализация выполняется автоматически при первом запуске эмулятора.

> [AZURE.NOTE] Для выполнения команды init, описанной ниже, требуются права администратора.

1. Нажмите кнопку **Пуск** или клавишу **Windows**. Начните вводить `Эмулятор хранения Azure` и выберите его, когда он отобразится. Затем откроется всплывающее окно командной строки.


2. В окне командной строки введите следующую команду, где `<SQLServerInstance> - имя экземпляра SQL Server. Чтобы использовать LocalDb, укажите `(localdb)\v11.0` в качестве экземпляра SQL Server.

    WAStorageEmulator init /sqlInstance <SQLServerInstance> 
    
Можно использовать следующую команду, которая указывает эмулятору использовать экземпляр SQL Server по умолчанию:

    WAStorageEmulator init /server .\\ 

Кроме этого, можно также использовать следующую команду, которая повторно инициализирует базу данных:

    WAStorageEmulator init /forceCreate 

## Справочник по программе командной строки эмулятора хранения

При запуске эмулятора хранения версии 3.0 или более поздней версии вы увидите всплывающее окно командной строки. Используйте командную строку для запуска и остановки работы эмулятора, а также, чтобы запрашивать состояние и выполнять другие операции.

> [AZURE.NOTE] Если установлен эмулятор вычислений, то при запуске эмулятора хранения появится соответствующий значок на панели задач. Щелкните этот значок правой кнопкой мыши, чтобы вызвать меню, которое позволяет запустить и остановить работу эмулятора хранения графическим путем.

### Синтаксис командной строки

	WAStorageEmulator [/start] [/stop] [/status] [/clear] [/init] [/help]

### Параметры
Чтобы просмотреть список параметров, введите /help в командной строке.

## Дальнейшие действия
- [Справочник по программе командной строки эмулятора хранения](https://msdn.microsoft.com/library/azure/gg433005.aspx)
- [Различия между эмулятором хранилища и службами хранилища Azure](https://msdn.microsoft.com/library/azure/gg433135.aspx)
- [Замечания к выпуску Storage Emulator](https://msdn.microsoft.com/library/azure/dn683879.aspx)

<!--HONumber=47-->
 