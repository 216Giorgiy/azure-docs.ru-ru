---
title: "Восстановление задания импорта инструмента импорта и экспорта Azure версии 1 | Документация Майкрософт"
description: "Узнайте, как восстановить задание импорта, созданное и выполняемое с помощью службы импорта и экспорта Azure."
author: muralikk
manager: syadav
editor: tysonn
services: storage
documentationcenter: 
ms.assetid: 38cc16bd-ad55-4625-9a85-e1726c35fd1b
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/23/2017
ms.author: muralikk
translationtype: Human Translation
ms.sourcegitcommit: 432752c895fca3721e78fb6eb17b5a3e5c4ca495
ms.openlocfilehash: 9403fb0bb16227871388f063e9d0004c7186866e
ms.lasthandoff: 03/30/2017


---

# <a name="repairing-an-import-job"></a>Исправление задания импорта
Иногда службе импорта и экспорта Microsoft Azure не удается скопировать некоторые файлы или их части в службу BLOB-объектов Windows Azure. Это может происходить по следующим причинам:  
  
-   файлы повреждены;  
  
-   диски повреждены;  
  
-   ключ учетной записи хранения изменен при передаче файла.  
  
Запустите инструмент импорта и экспорта Microsoft Azure с использованием файлов журнала копирования задания импорта. Он передаст отсутствующие файлы (или их части) в учетную запись хранения Microsoft Azure для завершения задания импорта.  
  
## <a name="repairimport-parameters"></a>Параметры RepairImport

Для команды **RepairImport** можно определить следующие параметры. 
  
|||  
|-|-|  
|**/r:**<RepairFile\>|**Обязательный параметр.** Путь к файлу восстановления для отслеживания восстановления и возобновления прерванной операции восстановления. Каждый диск должен быть связан с одним и только одним файлом восстановления. Запуская восстановление для определенного диска, вы передаете путь к файлу восстановления, который еще не существует. Чтобы возобновить прерванную операцию восстановления, необходимо передать имя существующего файла восстановления. Всегда необходимо указывать файл восстановления, соответствующий целевому диску.|  
|**/logdir:**<LogDirectory\>|**Необязательный параметр.** Каталог журнала. В этот каталог записываются файлы подробного журнала. Если каталог журнала не указан, вместо него будет использоваться текущий каталог.|  
|**/d:**<TargetDirectories\>|**Обязательный параметр.** Один или несколько разделенных точкой с запятой каталогов, содержащих исходные импортированные файлы. Также может использоваться диск для импорта, но это не является обязательным, если доступны альтернативные расположения исходных файлов.|  
|**/bk:**<BitLockerKey\>|**Необязательный параметр.** Укажите ключ BitLocker, чтобы разблокировать зашифрованный диск, на котором расположены исходные файлы.|  
|**/sn:**<StorageAccountName\>|**Обязательный параметр.** Имя учетной записи хранения для задания импорта.|  
|**/sk:**<StorageAccountKey\>|**Требуется**, только если не указан SAS контейнера. Ключ учетной записи хранения для задания импорта.|  
|**/csas:**<ContainerSas\>|**Требуется**, только если не указан ключ учетной записи хранения. Контейнер SAS для доступа к большим двоичным объектам, связанным с заданием импорта.|  
|**/CopyLogFile:**<DriveCopyLogFile\>|**Обязательный параметр.** Путь к файлу журнала копирования диска (подробного журнала или журнала ошибок). Этот файл создается службой импорта и экспорта Microsoft Azure. Его можно скачать из хранилища BLOB-объектов, связанного с заданием. Файл журнала копирования содержит сведения о BLOB-объектах или файлах с ошибками, которые требуется восстановить.|  
|**/PathMapFile:**<DrivePathMapFile\>|**Необязательный параметр.** Путь к текстовому файлу, который может использоваться для устранения неоднозначностей при наличии нескольких файлов с одинаковым именем, импортируемых в одно задание. При первом запуске средства файл может быть заполнен всеми неоднозначными именами. При последующих запусках средства этот файл будет использоваться для устранения неоднозначностей.|  
  
## <a name="using-the-repairimport-command"></a>Использование команды RepairImport  
Чтобы восстановить импортируемые данные, используя потоковую передачу данных по сети, необходимо указать каталоги, которые содержат исходные файлы, импортированные с помощью параметра `/d`. Необходимо также указать файл журнала копирования, скачанный из вашей учетной записи хранения. Обычная командная строка для восстановления задания импорта с частичными повреждениями выглядит так:  
  
```  
WAImportExport.exe RepairImport /r:C:\WAImportExport\9WM35C2V.rep /d:C:\Users\bob\Pictures;X:\BobBackup\photos /sn:bobmediaaccount /sk:VkGbrUqBWLYJ6zg1m29VOTrxpBgdNOlp+kp0C9MEdx3GELxmBw4hK94f7KysbbeKLDksg7VoN1W/a5UuM2zNgQ== /CopyLogFile:C:\WAImportExport\9WM35C2V.log  
```  
  
Ниже приведен пример файла журнала копирования. В этом случае одна часть файла на 64 КБ была повреждена на диске, который указан для задания импорта. Так как это единственное обнаруженное повреждение, остальные большие двоичные объекты были успешно импортированы.  
  
```xml
<?xml version="1.0" encoding="utf-8"?>  
<DriveLog>  
 <DriveId>9WM35C2V</DriveId>  
 <Blob Status=”CompletedWithErrors”>  
 <BlobPath>pictures/animals/koala.jpg</BlobPath>  
 <FilePath>\animals\koala.jpg</FilePath>  
 <Length>163840</Length>  
 <ImportDisposition Status=”Overwritten”>overwrite</ImportDisposition>  
 <PageRangeList>  
  <PageRange Offset=”65536” Length=”65536” Hash=”AA2585F6F6FD01C4AD4256E018240CD4” Status=”Corrupted” />  
 </PageRangeList>  
 </Blob>  
 <Status>CompletedWithErrors</Status>  
</DriveLog>  
```
  
Когда этот журнал копирования передается в инструмент импорта и экспорта Azure, он попытается завершить импорт файла, копируя отсутствующее содержимое из сети. Как показано в примере выше, средство выполнит поиск исходного файла `\animals\koala.jpg` в двух каталогах: `C:\Users\bob\Pictures` и `X:\BobBackup\photos`. Если файл `C:\Users\bob\Pictures\animals\koala.jpg` существует, то инструмент импорта и экспорта Azure скопирует недостающие данные в соответствующий большой двоичный объект `http://bobmediaaccount.blob.core.windows.net/pictures/animals/koala.jpg`.  
  
## <a name="resolving-conflicts-when-using-repairimport"></a>Разрешение конфликтов при использовании RepairImport  
Иногда средству не удается найти или открыть необходимый файл из-за того, что файл не удалось найти или он недоступен, у файла неоднозначное имя или содержимое файла является недопустимым.  
  
Ошибка с неоднозначным именем происходит, когда средство пытается найти файл `\animals\koala.jpg`, который существует в папках `C:\Users\bob\pictures` и `X:\BobBackup\photos`. То есть этот файл доступен сразу в двух расположениях (`C:\Users\bob\pictures\animals\koala.jpg` и `X:\BobBackup\photos\animals\koala.jpg`) на дисках для задания импорта.  
  
Параметр `/PathMapFile` поможет вам устранить эту ошибку. Можно указать имя файла со списком файлов, которые средству не удалось правильно определить. Ниже представлен пример командной строки для заполнения `9WM35C2V_pathmap.txt`:  
  
```
WAImportExport.exe RepairImport /r:C:\WAImportExport\9WM35C2V.rep /d:C:\Users\bob\Pictures;X:\BobBackup\photos /sn:bobmediaaccount /sk:VkGbrUqBWLYJ6zg1m29VOTrxpBgdNOlp+kp0C9MEdx3GELxmBw4hK94f7KysbbeKLDksg7VoN1W/a5UuM2zNgQ== /CopyLogFile:C:\WAImportExport\9WM35C2V.log /PathMapFile:C:\WAImportExport\9WM35C2V_pathmap.txt  
```
  
Затем средство запишет пути к проблемному файлу в параметр `9WM35C2V_pathmap.txt` (по одному в каждой строке). Например, файл может содержать следующие записи после запуска команды:  
 
```
\animals\koala.jpg  
\animals\kangaroo.jpg  
```
  
 Следует попытаться найти и открыть каждый файл в списке, чтобы проверить его доступность для средства. Если вы хотите явно указать средству расположение файла, можно изменить файл сопоставления путей и добавить путь к каждому файлу в той же строке, используя символ табуляции как разделитель:  
  
```
\animals\koala.jpg           C:\Users\bob\Pictures\animals\koala.jpg  
\animals\kangaroo.jpg        X:\BobBackup\photos\animals\kangaroo.jpg  
```
  
Сделав доступными необходимые файлы для средства (или обновив файл сопоставления пути), вы можете повторно запустить средство для завершения импорта.  
  
## <a name="next-steps"></a>Дальнейшие действия
 
* [Настройка средства импорта и экспорта Azure](storage-import-export-tool-setup-v1.md)   
* [Подготовка жестких дисков для задания импорта](storage-import-export-tool-preparing-hard-drives-import-v1.md)   
* [Просмотр состояния задания с помощью файлов журнала копирования](storage-import-export-tool-reviewing-job-status-v1.md)   
* [Подготовка задания экспорта](storage-import-export-tool-repairing-an-export-job-v1.md)   
* [Устранение неполадок со средством импорта и экспорта Azure](storage-import-export-tool-troubleshooting-v1.md)

