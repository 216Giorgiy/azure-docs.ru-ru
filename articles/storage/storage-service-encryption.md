---
title: Шифрование службы хранилища Azure для неактивных данных | Microsoft Docs
description: Используйте функцию шифрования службы хранилища Azure для шифрования хранилища BLOB-объектов Azure на стороне службы при сохранении данных и его расшифровки при извлечении данных.
services: storage
documentationcenter: .net
author: robinsh
manager: carmonm
editor: tysonn

ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/16/2016
ms.author: robinsh

---
# <a name="azure-storage-service-encryption-for-data-at-rest"></a>Шифрование службы хранилища Azure для неактивных данных (предварительная версия)
Шифрование службы хранилища Azure (SSE) для неактивных данных помогает защитить данные в соответствии с предложениями по безопасности и соответствию вашей организации. С помощью этой функции служба хранилища Azure автоматически шифрует данные перед сохранением в хранилище и расшифровывает их перед извлечением. Шифрование, расшифровка и управление ключами полностью прозрачны для пользователей.

В следующих разделах приведены подробные инструкции по использованию функции шифрования для службы хранилища, а также описаны поддерживаемые сценарии и взаимодействие с пользователем.

## <a name="overview"></a>Обзор
Служба хранилища Azure предоставляет полный набор возможностей обеспечения безопасности, которые в совокупности позволяют разработчикам создавать защищенные приложения. Защитить данные в процессе передачи между приложением и Azure можно с помощью [шифрования на стороне клиента](storage-client-side-encryption.md), HTTPS или SMB 3.0. Шифрование службы хранилища обеспечивает шифрование при хранении, а также полностью прозрачное шифрование, расшифровку и управление ключами. Используется 256-битное [шифрование AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard), самая надежная технология блочного шифрования на сегодняшний день.

Функция SSE работает путем шифрования данных при их записи в службу хранилища Azure и может использоваться для блочных, страничных и дополнительных BLOB-объектов. Вот что поддерживает служба:

* универсальные учетные записи хранения и учетные записи хранения BLOB-объектов;
* хранилища класса Premium и Standard; 
* все уровни избыточности (LRS, ZRS, GRS и RA-GRS);
* учетные записи хранения Azure Resource Manager (но не классические учетные записи хранения); 
* все регионы.

Чтобы включить или отключить шифрование службы хранилища для учетной записи хранения, войдите на [портал Azure](https://azure.portal.com) и выберите нужную учетную запись. В колонке "Параметры" найдите раздел "Служба BLOB-объектов", как показано на следующем снимке экрана, и щелкните "Шифрование".

![Снимок экрана портала с параметром шифрования](./media/storage-service-encryption/image1.png)

После выбора параметра шифрования можно включить или отключить шифрование службы хранилища.

![Снимок экрана портала со свойствами шифрования](./media/storage-service-encryption/image2.png)

## <a name="encryption-scenarios"></a>Сценарии шифрования
Шифрование службы хранилища можно включить на уровне учетной записи хранения. Оно поддерживает следующие сценарии клиентов:

* Шифрование блочных, страничных и добавочных BLOB-объектов.
* Шифрование архивных виртуальных жестких дисков и шаблонов, переданных в Azure из локальной среды.
* Шифрование базовой ОС и дисков данных для виртуальных машин IaaS, созданных с помощью виртуальных жестких дисков.

SSE имеет такие ограничения:

* Шифрование классических учетных записей хранения не поддерживается.
* Шифрование классических учетных записей хранения, перенесенных в учетные записи хранения Resource Manager, не поддерживается.
* Существующие данные — SSE шифрует вновь созданные данные только после включения шифрования. Например, если вы создадите учетную запись хранения Resource Manager, не включив шифрование, передадите в нее большие двоичные объекты или архивные виртуальные жесткие диски, а затем включите SSE, то эти большие двоичные объекты будут шифроваться только после их перезаписи или копирования.
* Поддержка Marketplace — включите шифрование виртуальных машин, созданных из Marketplace, с помощью [портала Azure](https://portal.azure.com), PowerShell или интерфейса командной строки Azure (Azure CLI). Базовый образ виртуального жесткого диска остается незашифрованным, однако все операции записи, производимые после развертывания виртуальной машины, шифруются.
* Таблицы, очереди и файлы не шифруются.

## <a name="getting-started"></a>Приступая к работе
### <a name="step-1:-[create-a-new-storage-account](storage-create-storage-account.md)."></a>Этап 1. [Создание учетной записи хранения](storage-create-storage-account.md)
### <a name="step-2:-enable-encryption."></a>Этап 2. Включение шифрования
Шифрование можно включить с помощью [портала Azure](https://portal.azure.com).

> [!NOTE]
> Если вы хотите включить или отключить шифрование службы хранилища для учетной записи хранения с помощью программных средств, вы можете использовать [REST API поставщика ресурсов службы хранилища Azure](https://msdn.microsoft.com/library/azure/mt163683.aspx), [клиентскую библиотеку поставщика ресурсов хранилища для .NET](https://msdn.microsoft.com/library/azure/mt131037.aspx), [Azure PowerShell](../powershell-install-configure.md) или [Azure CLI](storage-azure-cli.md).
> 
> 

### <a name="step-3:-copy-data-to-storage-account"></a>Этап 3. Копирование данных в учетную запись хранения
Если включить SSE для учетной записи хранения, а затем записать большие двоичные объекты в эту учетную запись хранения, большие двоичные объекты будут зашифрованы. Большие двоичные объекты, которые уже находятся в этой учетной записи не будут зашифрованы, если их не перезаписать. Можно скопировать данные из одной учетной записи хранения в другую, для которой включено шифрование SSE, или даже включить SSE и скопировать большие двоичные объекты из одного контейнера в другой, чтобы убедиться, что записанные ранее данные зашифрованы. Для этого можно использовать любой из перечисленных далее инструментов.

#### <a name="using-azcopy"></a>Использование AzCopy
AzCopy — это служебная программа командной строки для Windows. Она разработана для копирования данных из хранилища больших двоичных объектов, файлов и табличного хранилища Microsoft Azure (и обратно) с помощью простых команд, обеспечивающих максимальную производительность. Эту программу можно использовать для копирования больших двоичных объектов из одной учетной записи хранения в другую, для которой включено шифрование SSE. 

Дополнительные сведения см. в статье [Передача данных с помощью служебной программы командной строки AzCopy](storage-use-azcopy.md).

#### <a name="using-the-storage-client-libraries"></a>Использование клиентских библиотек хранилища
Копировать данные больших двоичных объектов из одного хранилища BLOB-объектов в другое или из одной учетной записи хранения в другую можно с помощью нашего обширного набора клиентских библиотек хранилища, в том числе .NET, C++, Java, Android, Node.js, PHP, Python и Ruby.

Дополнительные сведения см. в статье [Приступая к работе с хранилищем BLOB-объектов Azure с помощью .NET](storage-dotnet-how-to-use-blobs.md).

#### <a name="using-a-storage-explorer"></a>Использование обозревателя хранилищ
Вы можете использовать обозреватель хранилищ для создания учетных записей хранения, отправки и скачивания данных, просмотра содержимого больших двоичных объектов и перехода по каталогам. Один из них можно использовать для отправки BLOB-объектов в учетную запись хранения с включенным шифрованием. При помощи некоторых обозревателей хранилищ также можно копировать данные из существующего хранилища BLOB-объектов в другой контейнер учетной записи хранения или в новую учетную запись хранения с включенным SSE.

Дополнительные сведения см. в статье [Обучающие ресурсы для хранилища Azure](storage-explorers.md).

### <a name="step-4:-query-the-status-of-the-encrypted-data"></a>Шаг 4. Запрос состояния зашифрованных данных
Развернута обновленная версия клиентской библиотеки хранилища, позволяющая запрашивать состояние объекта, чтобы определить, зашифрован ли он. Примеры будут добавлены в этот документ в ближайшее время.

В то же время можно вызвать операцию [получения свойств учетной записи](https://msdn.microsoft.com/library/azure/mt163553.aspx) , чтобы убедиться, что для учетной записи включено шифрование, или просмотреть свойства учетной записи хранения на портале Azure.

## <a name="encryption-and-decryption-workflow"></a>Рабочий процесс шифрования и расшифровки
Ниже приведено краткое описание того, как работает шифрование и расшифровка:

* Клиент включает шифрование в учетной записи хранения.
* Когда клиент записывает новые данные (выполняя операции PUT Blob, PUT Block, PUT Page и т. п.) в хранилище BLOB-объектов, к каждой операции записи применяется 256-разрядное [шифрование AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard) — самая надежная технология блочного шифрования на сегодняшний день.
* Когда клиенту требуется получить доступ к данным (например GET Blob и т. п.), они автоматически расшифровываются перед возвратом пользователю.
* Если шифрование отключено, новые операции записи не шифруются, а уже зашифрованные данные остаются в таком состоянии, пока не будут перезаписаны пользователем. Когда шифрование включено, операции записи в хранилище BLOB-объектов шифруются. Состояние данных не изменяется, когда пользователь переключается между включенным и отключенным шифрованием для учетной записи хранения.
* Все ключи шифрования хранятся в зашифрованном виде и управляются корпорацией Майкрософт.

## <a name="frequently-asked-questions-about-storage-service-encryption-for-data-at-rest"></a>Часто задаваемые вопросы о шифровании службы хранилища для неактивных данных
**Вопрос. У меня есть классическая учетная запись хранения. Можно включить в ней SSE?**

Ответ. Нет, SSE поддерживается только для учетных записей хранения Resource Manager.

**Вопрос. Каким образом можно зашифровать данные в классической учетной записи хранения?**

Ответ. Можно создать новую учетную запись хранения Resource Manager и скопировать в нее данные из классической учетной записи с помощью [AzCopy](storage-use-azcopy.md). 

Или же можно выполнить миграцию вашей учетной записи хранения в учетную запись хранения Resource Manage. Дополнительные сведения см. в статье [Поддерживаемый платформой перенос ресурсов IaaS из классической модели в модель Azure Resource Manager](https://azure.microsoft.com/blog/iaas-migration-classic-resource-manager/).

**Вопрос. У меня есть учетная запись хранения Resource Manager. Можно включить в ней SSE?**

Ответ. Да, но шифрование будет применяться только к тем данным, которые будут записываться в большие двоичные объекты после включения SSE. Данные, сохраненные до этого, шифроваться не будут. 

**Вопрос. Мне бы хотелось зашифровать текущие данные в существующей учетной записи хранения Resource Manager.**

Ответ. Вы можете включить SSE в учетной записи Resource Manager в любое время. Однако большие двоичные объекты, которые существовали до этого, не будут зашифрованы. Чтобы зашифровать эти большие двоичные объекты, их можно скопировать в другое имя или другой контейнер и удалить их незашифрованные версии.

**Вопрос. Я использую хранилище класса "Премиум"; доступна ли мне функция SSE?**

Ответ. Да, функция SSE поддерживается для хранилища класса как "Стандартный", так и "Премиум".

**Вопрос. Если я создаю учетную запись хранения, включив SSE, а затем создаю с ее помощью новую виртуальную машину, означает ли это, что виртуальная машина зашифрована?**

Ответ. Да. Все новые диски, которые используют новую учетную запись хранения, будут зашифрованы при условии, что они созданы после включения SSE. Если виртуальная машина создана с помощью Azure Marketplace, базовый образ виртуального жесткого диска остается незашифрованным, однако все операции записи, производимые после развертывания виртуальной машины, шифруются.

**Вопрос. Можно ли создавать учетные записи хранения с включенной функцией SSE с помощью интерфейса командной строки Azure и Azure PowerShell?**

Ответ. Да.

**Вопрос. Насколько дороже обходится служба хранилища Azure с включенным SSE?**

Ответ. Дополнительные затраты не требуются.

**Вопрос. Кто управляет ключами шифрования?**

Ответ. Ключами управляет корпорация Майкрософт.

**Вопрос. Можно ли использовать собственные ключи шифрования?**

Ответ. Мы работаем над тем, чтобы дать клиентам возможность использовать собственные ключи шифрования.

**Вопрос. Можно ли отменить доступ к ключам шифрования?**

Ответ. Сейчас нет, так как ключи полностью управляются корпорацией Майкрософт.

**Вопрос. Включается ли SSE по умолчанию при создании учетной записи хранения?**

Ответ. SSE включается по умолчанию. Для включения можно использовать портал Azure. Можно также включить эту функцию программно с помощью REST API поставщика ресурсов хранилища.

**Вопрос. Чем это отличается от шифрования дисков Azure?**

Ответ. Эта функция используется для шифрования данных в хранилище BLOB-объектов Azure. Шифрование дисков Azure применяется для шифрования дисков операционной системы и данных в виртуальных машинах IaaS. Дополнительные сведения см. в [руководстве по безопасности службы хранилища](storage-security-guide.md).

**Вопрос. Что будет, если включить SSE, а затем выполнить вход и включить шифрование дисков Azure для этих дисков?**

Ответ. Это поддерживаемый режим работы. Данные будут шифроваться с помощью обоих методов.

**Вопрос. Для моей учетной записи хранения настроена геоизбыточная репликация. Если включить SSE, будет зашифрована и избыточная копия?**

Ответ. Да, шифрованию подлежат все копии учетной записи хранения, при этом поддерживаются все варианты избыточности — локально избыточное хранилище (LRS), хранилище, избыточное в пределах зоны (ZRS), геоизбыточное хранилище (GRS) и геоизбыточное хранилище с доступом на чтение (RA-GRS).

**Вопрос. Не удается включить шифрование для учетной записи хранения.**

Ответ. Это учетная запись Resource Manager? Классические учетные записи хранения не поддерживаются. 

**Вопрос. Услуга SSE доступна только в некоторых регионах?**

Ответ. Услуга SSE доступна во всех регионах. 

**Вопрос. Куда обратиться, чтобы задать вопрос или оставить отзыв?**

Ответ. По любым вопросам, связанным с шифрованием службы хранилища, обращайтесь по адресу [ssediscussions@microsoft.com](mailto:ssediscussions@microsoft.com).

## <a name="next-steps"></a>Дальнейшие действия
Служба хранилища Azure предоставляет полный набор возможностей обеспечения безопасности, которые в совокупности позволяют разработчикам создавать защищенные приложения. Дополнительные сведения см. в [руководстве по безопасности службы хранилища](storage-security-guide.md).

<!--HONumber=Oct16_HO2-->


