<properties
	pageTitle="Шифрование службы хранилища Azure для неактивных данных (предварительная версия) | Microsoft Azure"
	description="Используйте функцию шифрования службы хранилища Azure для шифрования хранилища BLOB-объектов Azure на стороне службы при сохранении данных и его расшифровки при извлечении данных."
	services="storage"
	documentationCenter=".net"
	authors="robinsh"
	manager="carmonm"
	editor="tysonn"/>

<tags
	ms.service="storage"
	ms.workload="storage"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/01/2016"
	ms.author="robinsh"/>

# Шифрование службы хранилища Azure для неактивных данных (предварительная версия)

Шифрование службы хранилища Azure (SSE) для неактивных данных помогает защитить данные в соответствии с предложениями по безопасности и соответствию вашей организации. С помощью этой функции служба хранилища Azure автоматически шифрует данные перед сохранением в хранилище и расшифровывает их перед извлечением. Шифрование, расшифровка и управление ключами полностью прозрачны для пользователей.

В следующих разделах приведены подробные инструкции по использованию функции шифрования для службы хранилища, а также описаны поддерживаемые сценарии и взаимодействие с пользователем.

## Обзор


Служба хранилища Azure предоставляет полный набор возможностей обеспечения безопасности, которые в совокупности позволяют разработчикам создавать защищенные приложения. Защитить данные в процессе передачи между приложением и Azure можно с помощью [шифрования на стороне клиента](storage-client-side-encryption.md), HTTPS или SMB 3.0. Шифрование — это новая функция в службе хранилища Azure, которая будет шифровать данные при их записи во вспомогательные блочные, страничные и добавочные BLOB-объекты службы хранилища Azure. Эту функцию можно включить для новых учетных записей хранения, использующих модель развертывания с помощью Azure Resource Manager, кроме того, она доступна для всех уровней избыточности (LRS, ZRS, GRS и RA-GRS). Шифрование службы хранилища доступно для хранилища "Стандартный" и "Премиум" и обеспечивает полностью прозрачное шифрование, расшифровку и управления ключами. Используется 256-битное [шифрование AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard), самая надежная технология блочного шифрования на сегодняшний день. Приведенный ниже раздел "Предварительная версия" содержит подробные сведения о том, как стать участником программы по ознакомлению с предварительной версией для шифрования службы хранилища.

На этом снимке экрана показано, где найти параметры шифрования службы хранилища на [портале Azure](https://azure.portal.com). На этом экране следует щелкнуть элемент "Шифрование", чтобы продолжить.

![Снимок экрана портала с параметром шифрования](./media/storage-service-encryption/image1.png)

После выбора параметра шифрования можно включить или отключить шифрование службы хранилища.

![Снимок экрана портала со свойствами шифрования](./media/storage-service-encryption/image2.png)

##Доступность

В настоящее время для хранилища уровня "Стандартный" эта функция доступна в центральной части США, Восточной Азии, восточной части США 2, Западной Европе и западной части США.

В настоящее время для хранилища уровня "Премиум" эта функция доступна в центральной части США, восточной части США 2, восточной Японии и западной части США.

Мы будем вносить изменения в этот документ по мере развертывания данной функции в других регионах.

##Сценарии шифрования

Шифрование службы хранилища можно включить на уровне учетной записи хранения. Оно поддерживает следующие сценарии клиентов:

-   Шифрование блочных, страничных и добавочных BLOB-объектов.

-   Шифрование архивных виртуальных жестких дисков и шаблонов, переданных в Azure из локальной среды.

-   Шифрование базовой ОС и дисков данных для виртуальных машин IaaS, созданных с помощью виртуальных жестких дисков.

Пробная версия для всеобщего ознакомления имеет следующие ограничения:

-   Шифрование классических учетных записей хранения не поддерживается.

-   Шифрование классических учетных записей хранения, перенесенных в учетные записи хранения Resource Manager, не поддерживается.

-   Существующие данные — SSE шифрует вновь созданные данные только после включения шифрования. Например, если вы создадите учетную запись хранения Resource Manager, не включив шифрование, передадите в нее большие двоичные объекты или архивные виртуальные жесткие диски, а затем включите SSE, то эти большие двоичные объекты будут шифроваться только после их перезаписи или копирования.

-   Поддержка Marketplace — включите шифрование виртуальных машин, созданных из Marketplace, с помощью (портала Azure)[https://portal.azure.com), PowerShell или Azure CLI. Базовый образ виртуального жесткого диска остается незашифрованным, однако все операции записи, производимые после развертывания виртуальной машины, шифруются.

-   Таблицы, очереди и файлы не шифруются.

##Предварительный просмотр

Эта функция поддерживается только для новых учетных записей хранения Resource Manager. Классические учетные записи хранения не поддерживаются. Для использования этой функции необходимо зарегистрировать подписку с помощью командлетов PowerShell. После утверждения подписки вы сможете включить SSE для своей учетной записи хранения, относящейся к утвержденной подписке. Как и большинство других функций, находящихся на этапе предварительной версии, это шифрование не следует использовать для рабочих нагрузок, пока не будет выпущена его общедоступная версия. Вы можете присоединиться к нашей группе по предварительной версии шифрования для службы хранилища в Yammer, чтобы отправить свои замечания по поводу работы с этой функцией.

### Регистрация для доступа к предварительной версии

-   [Установите командлеты Azure PowerShell](../powershell-install-configure.md).

-   В Windows 10 откройте PowerShell от имени администратора.

-   Зарегистрируйте пространство имен поставщика ресурсов хранилища. Это необходимо только для той подписки, которая еще не зарегистрирована у поставщика ресурсов хранилища.

    `PS E:> Register-AzureRmResourceProvider -ProviderNamespace "Microsoft.Storage" `

-   Для регистрации функции можно использовать командлет Register-AzureRmProviderFeature PowerShell.

    `Register-AzureRmProviderFeature -FeatureName "EncryptionAtRest" -ProviderNamespace "Microsoft.Storage"`

-   Чтобы запросить состояние регистрации и узнать, утверждена ли подписка, можно использовать командлет Get-AzureRmProviderFeature PowerShell.

    `Get-AzureRmProviderFeature -FeatureName "EncryptionAtRest" -ProviderNamespace "Microsoft.Storage"`

Если возвращается состояние регистрации "Зарегистрировано", ваша подписка утверждена. Также посетите нашу группу по предварительной версии шифрования для службы хранилища Azure в Yammer.

##Приступая к работе

###Шаг 1. [Регистрация для доступа к предварительной версии](#registering-for-preview)

###Шаг 2. [Создание учетной записи хранения](storage-create-storage-account.md)

###Шаг 3. Включение шифрования

Шифрование можно включить с помощью [портала Azure](https://portal.azure.com).

> [AZURE.NOTE] Если вы хотите программно включить или отключить шифрование службы хранилища для учетной записи хранения, можно использовать [REST API поставщика ресурсов службы хранилища Azure](https://msdn.microsoft.com/library/azure/mt163683.aspx). Скоро мы добавим эту возможность в [клиентскую библиотеку поставщика ресурсов хранилища для .NET](https://msdn.microsoft.com/library/azure/mt131037.aspx), Azure PowerShell и Azure CLI.

###Шаг 4. Копирование данных в учетную запись хранения

#### Использование AzCopy

AzCopy — это служебная программа командной строки для Windows. Она разработана для копирования данных из хранилища больших двоичных объектов, файлов и табличного хранилища Microsoft Azure (и обратно) с помощью простых команд, обеспечивающих максимальную производительность. Эту служебную программу можно применять для копирования данных из существующей учетной записи хранилища BLOB-объектов в новую учетную запись хранения с включенной функцией шифрования.

Дополнительные сведения см. в статье [Передача данных с помощью служебной программы командной строки AzCopy](storage-use-azcopy.md).

#### Использование клиентских библиотек хранилища

Отправлять и скачивать данные в хранилище BLOB-объектов можно с помощью нашего обширного набора клиентских библиотек хранилища, включая .NET, C++, Java, Android, Node.js, PHP, Python и Ruby.

Дополнительные сведения см. в статье [Приступая к работе с хранилищем BLOB-объектов Azure с помощью .NET](storage-dotnet-how-to-use-blobs.md).

#### Использование обозревателя хранилищ

Обозреватель хранилищ можно применять для создания учетных записей хранения, отправки и скачивания данных, просмотра содержимого BLOB-объектов и перехода по каталогам. Многие из обозревателей поддерживают как классические учетные записи хранения, так и учетные записи хранения Resource Manager.

Один из них можно использовать для отправки BLOB-объектов в учетную запись хранения с включенным шифрованием. Некоторые обозреватели хранилищ также позволяют копировать данные из существующей в новую учетную запись хранения с включенным SSE.

Дополнительные сведения см. в статье [Обучающие ресурсы для хранилища Azure](storage-explorers.md).

###Шаг 5. Запрос состояния зашифрованных данных

После широкого распространения SSE будет развернута обновленная версия библиотеки клиента хранилища, позволяющая запрашивать состояние объекта, чтобы определить, зашифрован ли он.

В то же время можно вызвать операцию [получения свойств учетной записи](https://msdn.microsoft.com/library/azure/mt163553.aspx), чтобы убедиться, что для учетной записи включено шифрование, или просмотреть свойства учетной записи хранения на портале Azure.

##Рабочий процесс шифрования и расшифровки

Ниже приведено краткое описание того, как работает шифрование и расшифровка:

-   Клиент включает шифрование в учетной записи хранения.

-   Когда клиент записывает новые данные (выполняя операцию PUT Blob, PUT Block, PUT Page и т. п.) в хранилище BLOB-объектов, к каждой операции записи применяется 256-разрядное [шифрование AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard) — самая надежная технология блочного шифрования на сегодняшний день.

-   Когда клиенту требуется получить доступ к данным (например GET Blob и т. п.), они автоматически расшифровываются перед возвратом пользователю.

-   Если шифрование отключено, новые операции записи не шифруются, а уже зашифрованные данные остаются в таком состоянии, пока не будут перезаписаны пользователем. Когда шифрование включено, операции записи в хранилище BLOB-объектов шифруются. Состояние данных не изменяется, когда пользователь переключается между включенным и отключенным шифрованием для учетной записи хранения.

-   Все ключи шифрования хранятся в зашифрованном виде и управляются корпорацией Майкрософт.

##Часто задаваемые вопросы о шифровании службы хранилища для неактивных данных

**Вопрос. У меня есть классическая учетная запись хранения. Можно включить в ней SSE?**

Ответ. Нет, на этапе предварительной версии SSE поддерживается только для вновь созданных учетных записей хранения Resource Manager.

**Вопрос. Каким образом можно зашифровать данные в классической учетной записи хранения?**

Ответ. Можно создать новую учетную запись хранения Resource Manager и скопировать в нее данные из классической учетной записи с помощью [AzCopy](storage-use-azcopy.md).

**Вопрос. У меня есть учетная запись хранения Resource Manager. Можно включить в ней SSE?**

Ответ. Пока функция SSE находится на этапе предварительной версии, для доступа к ней необходимо создать новую учетную запись.

**Вопрос. Мне бы хотелось зашифровать текущие данные в существующей учетной записи хранения Resource Manager.**

Ответ. Если имеющаяся учетная запись хранения Resource Manager была создана до объявления о выпуске предварительной версии, можно создать новую учетную запись хранения Resource Manager и включить в ней шифрование. После этого можно скопировать данные из предыдущей учетной записи хранения, при этом они шифруются автоматически. Однако, если учетная запись хранения Resource Manager была создана после уведомления о выпуске предварительной версии и вы решили включить шифрование позднее, можно включить шифрование для этой учетной записи хранения с помощью портала Azure и перезаписать в нее незашифрованные данные.

**Вопрос. Я использую хранилище класса "Премиум"; доступна ли мне функция SSE?**

Ответ. Да, функция SSE поддерживается для хранилища класса как "Стандартный", так и "Премиум".

**Вопрос. Если я создаю учетную запись хранения, включив SSE, а затем создаю с ее помощью новую виртуальную машину, означает ли это, что виртуальная машина зашифрована?**

Ответ. Да. Все новые диски, которые используют новую учетную запись хранения, будут зашифрованы при условии, что они созданы после включения SSE. Если виртуальная машина создана с помощью Azure Marketplace, базовый образ виртуального жесткого диска остается незашифрованным, однако все операции записи, производимые после развертывания виртуальной машины, шифруются.

**Вопрос. Можно ли создавать учетные записи хранения с включенной функцией SSE с помощью интерфейса командной строки Azure и Azure PowerShell?**

Ответ. Данная возможность появится в предстоящем выпуске Azure PowerShell и интерфейса командной строки Azure (в настоящее время он запланирован на конец апреля).

**Вопрос. Насколько дороже обходится служба хранилища Azure с включенным SSE?**

Ответ. Дополнительные затраты не требуются.

**Вопрос. Как зарегистрироваться для получения доступа к предварительной версии?**

Ответ. Регистрацию можно выполнить с помощью PowerShell. После утверждения права подписки на использование этой функции вы сможете включить шифрование неактивных данных с помощью PowerShell.

**Вопрос. Какое имя функции следует указать при регистрации для доступа к предварительной версии с помощью PowerShell?**

Ответ. EncryptionAtRest.

**Вопрос. Кто управляет ключами шифрования?**

Ответ. Ключами управляет корпорация Майкрософт.

**Вопрос. Можно ли использовать собственные ключи шифрования?**

Ответ. Мы работаем над тем, чтобы дать клиентам возможность использовать собственные ключи шифрования.

**Вопрос. Можно ли отменить доступ к ключам шифрования?**

Ответ. Сейчас нет, так как ключи полностью управляются корпорацией Майкрософт.

**Вопрос. Включается ли SSE по умолчанию при создании учетной записи хранения?**

Ответ. SSE включается по умолчанию; чтобы включить его, можно использовать портал Azure. Можно также включить эту функцию программно с помощью REST API поставщика ресурсов хранилища.

**Вопрос. Чем это отличается от шифрования дисков Azure?**

Ответ. Эта функция используется для шифрования данных в хранилище BLOB-объектов Azure. Шифрование дисков Azure применяется для шифрования дисков операционной системы и данных в виртуальных машинах IaaS. Дополнительные сведения см. в [руководстве по безопасности службы хранилища](storage-security-guide.md).

**Вопрос. Что будет, если включить SSE, а затем выполнить вход и включить шифрование дисков Azure для этих дисков?**

Ответ. Это поддерживаемый режим работы. Данные будут шифроваться с помощью обоих методов.

**Вопрос. Для моей учетной записи хранения настроена геоизбыточная репликация. Если включить SSE, будет зашифрована и избыточная копия?**

Ответ. Да, шифруются все копии учетной записи хранения, при этом поддерживаются все варианты избыточности — локально избыточное хранилище (LRS), хранилище, избыточное в пределах зоны (ZRS), геоизбыточное хранилище (GRS) и геоизбыточное хранилище с доступом на чтение (RA-GRS).

**Вопрос. Не удается включить шифрование для учетной записи хранения.**

Ответ. Когда была создана учетная запись хранения? На этапе предварительной версии для использования SSE необходимо зарегистрировать подписку и создать новую учетную запись хранения. Включить SSE для учетных записей хранения, созданных до выпуска предварительной версии, нельзя.

**Вопрос. Доступна ли предварительная версия SSE только в определенных регионах?**

Ответ. Предварительная версия SSE доступна в Восточной Азии и Западной Европе для хранилища "Стандартный" и в Восточной Японии для хранилища "Премиум". Мы будем вносить изменения в этот документ по мере развертывания данной функции в дополнительных регионах.

**Вопрос. Куда обратиться, чтобы задать вопрос или оставить отзыв?**

Ответ. По любым вопросам, связанным с шифрованием службы хранилища, обращайтесь по адресу [ssediscussions@microsoft.com](mailto:ssediscussions@microsoft.com).

##Дальнейшие действия

Служба хранилища Azure предоставляет полный набор возможностей обеспечения безопасности, которые в совокупности позволяют разработчикам создавать защищенные приложения. Дополнительные сведения см. в [руководстве по безопасности службы хранилища](storage-security-guide.md).

<!---HONumber=AcomDC_0706_2016-->