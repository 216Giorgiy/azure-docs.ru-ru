---
title: "\"Горячее\", \"холодное\" и архивное хранилище Azure для BLOB-объектов | Документация Майкрософт"
description: "\"Горячее\", \"холодное\" и архивное хранилище для учетных записей хранения BLOB-объектов Azure."
services: storage
documentationcenter: 
author: michaelhauss
manager: vamshik
editor: tysonn
ms.assetid: eb33ed4f-1b17-4fd6-82e2-8d5372800eef
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/05/2017
ms.author: mihauss
ms.openlocfilehash: 501fc59efb8bacf58fea2825752d3a33c6ea5963
ms.sourcegitcommit: b854df4fc66c73ba1dd141740a2b348de3e1e028
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2017
---
# <a name="azure-blob-storage-hot-cool-and-archive-preview-storage-tiers"></a>Хранилище BLOB-объектов Azure: "горячий", "холодный" и архивный (предварительная версия) уровни

## <a name="overview"></a>Обзор

В службе хранилища Azure реализовано три уровня для хранения BLOB-объектов. Это позволяет экономно хранить данные с учетом особенностей их использования. **"Горячий" уровень хранилища** Azure оптимизирован для хранения часто используемых данных. **Холодный уровень хранилища** Azure оптимизирован для хранения данных, которые используются редко и хранятся не менее 30 дней. **Архивный уровень хранилища (предварительная версия)** оптимизирован для хранения данных, которые используются редко и хранятся не менее 180 дней. Требования к задержке для таких данных гибкие (порядка нескольких часов). Архивный уровень хранилища доступен только на уровне большого двоичного объекта. На уровне учетной записи хранения его невозможно использовать. Хотя холодные данные предусматривают более низкую частоту обращения, они должны характеризоваться такими же показателями надежности, доступности, пропускной способности и времени получения доступа, как горячие. Приемлемым компромиссом для более экономного хранения редко используемых данных является соглашение об уровне обслуживания, предусматривающее более низкую доступность. Кроме того, предоставление доступа к таким данным стоит дороже, чем к часто используемыми данными. Архивное хранилище используется в автономном режиме. Оно обеспечивает наименьшие затраты на хранение, но требует наибольших затрат на доступ.

В настоящее время объемы данных, хранящихся в облаке, увеличиваются в геометрической прогрессии. Чтобы оптимизировать затраты при расширении хранилища, размещайте данные на разных уровнях с учетом частоты обращения и планируемого срока хранения. Данные, хранящиеся в облаке, создаются, обрабатываются и используются по-разному. Одни данные активно используют и изменяют на протяжении всего жизненного цикла. Другие данные часто используются в начале цикла, но по мере их устаревания к ним обращаются все реже. Третьи данные не используют или делают это редко, возможно даже единожды за весь срок хранения.

Каждый из этих сценариев доступа к данным имеет свои преимущества: разные уровни хранения оптимизированы для определенных шаблонов доступа. Теперь в хранилище BLOB-объектов Azure можно использовать разные модели ценообразования, выбрав наиболее подходящий уровень хранения данных: горячий, холодный или архивный.

## <a name="blob-storage-accounts"></a>Учетные записи хранения BLOB-объектов

**Учетные записи хранения BLOB-объектов** — это специализированные учетные записи хранения таких неструктурированных данных, как большие двоичные объекты, в службе хранилища Azure. Учетные записи хранения BLOB-объектов на основе шаблонов доступа позволяют выбирать между горячим и холодным уровнями хранилища для учетной записи или между горячим, холодным и архивным уровнями для BLOB-объекта. Чтобы оптимизировать затраты, храните данные, к которым редко, иногда и часто обращаются, на горячем, холодном и активном уровнях хранилища соответственно. Учетные записи хранения BLOB-объектов аналогичны учетным записям хранения общего назначения и обладают теми же функциями обеспечения устойчивости, надежности, масштабируемости и производительности. Кроме того, они отличаются полной согласованностью API в плане блочных BLOB-объектов и добавления больших двоичных объектов.

> [!NOTE]
> Учетные записи хранения BLOB-объектов поддерживают только блочные и добавочные BLOB-объекты и не поддерживают страничные.

Учетные записи больших двоичных объектов предоставляют атрибут **Access Tier** на уровне учетной записи. Этот атрибут указывает стандартный уровень учетной записи хранения: **горячий** или **холодный**. Стандартный уровень учетной записи хранения применяется ко всем большим двоичным объектам, для которых явно не указан уровень хранения. Если схема использования данных изменилась, вы в любое время можете изменить уровень хранилища. **Архивный уровень** (предварительная версия) можно применять только на уровне большого двоичного объекта.

> [!NOTE]
> За изменение уровня хранилища может взиматься дополнительная плата. Дополнительные сведения см. в разделе [Цены и выставление счетов](#pricing-and-billing).

### <a name="hot-access-tier"></a>"Горячий" уровень доступа

Стоимость хранения данных на горячем уровне хранилища выше, чем на холодном и архивном уровнях. Но на этом уровне доступ к данным обходится дешевле. Ниже перечислены ситуации, в которых данные нужно хранить на "горячем" уровне хранилища.

* Данные активно используют или планируют часто получать к ним доступ (для чтения и записи).
* Данные, которые вы планируете обрабатывать и в конечном счете перенести, лучше отнести к "холодному" уровню хранилища.

### <a name="cool-access-tier"></a>"Холодный" уровень доступа

На холодном уровне хранилища дешевле хранить данные, но доступ к ним стоит дороже по сравнению с горячим уровнем. Этот уровень предназначен для данных, которые будут храниться на холодном уровне не менее 30 дней. Ниже перечислены ситуации, в которых данные нужно хранить на "холодном" уровне хранилища.

* Наборы данных резервного копирования и аварийного восстановления краткосрочного хранения.
* Старое мультимедийное содержимое, которое нечасто просматривают, но которое должно быть доступно сразу по необходимости.
* Большие наборы данных, которые нужно хранить при меньших затратах, при этом большую часть данных собирают для последующей обработки (*например*, нужно долго хранить данные научных исследований или необработанные данные телеметрии производственного объекта).

### <a name="archive-access-tier-preview"></a>Архивный уровень доступа (предварительная версия)

Архивный уровень хранилища — это предложение самой низкой ценовой категории для хранения данных и более высокой ценовой категории для получения данных по сравнению с горячим и холодным уровнями. Этот уровень предназначен для данных, для которых допустима задержка извлечения в несколько часов и которые будут храниться не менее 180 дней.

Так как большой двоичный объект является архивным хранилищем, он используется в автономном режиме. Его данные нельзя читать, копировать, перезаписывать и изменять. Исключением являются метаданные, которые находятся в сети и доступны. Также нельзя делать моментальные снимки BLOB-объекта в архивном хранилище. Но можно выполнять операции удаления, перечисления, получение свойств и метаданных, а также изменения уровня BLOB-объектов.

#### <a name="blob-rehydration"></a>Восстановление больших двоичных объектов
Для чтения данных в архивном хранилище сначала необходимо изменить уровень BLOB-объекта на "горячий" или "холодный". Этот процесс называется восстановлением. Его выполнение может занять до 15 часов для BLOB-объектов размером менее 50 ГБ. Дополнительное время, необходимое для BLOB-объектов большего размера, зависит от ограничения пропускной способности BLOB-объекта.

При восстановлении вы можете проверить свойство состояния архивации BLOB-объекта, чтобы убедиться, что уровень изменяется. Для состояния отображается значение rehydrate-pending-to-hot или rehydrate-pending-to-cool в зависимости от целевого уровня. По завершении свойство состояния архивации BLOB-объекта удаляется, а для свойства уровня доступа BLOB-объекта отображается значение "горячего" или "холодного" уровня.  

Пример сценария использования для архивного уровня хранилища включает:

* Наборы данных резервного копирования, архивирования и аварийного восстановления долгосрочного хранения.
* Исходные (необработанные) данные, которые необходимо сохранить даже после их окончательной обработки (*например*, необработанные мультимедийные данные после перекодирования в другие форматы).
* Данные соответствия требованиям и архивные данные, которые нужно хранить в течение длительного времени и которые вряд ли когда-либо будут использовать (*например*, записи камер безопасности, старые рентгенограммы и результаты МРТ в медицинских заведениях или аудиозаписи и записи разговоров с клиентами в финансовых службах).

### <a name="recommendations"></a>Рекомендации

Дополнительные сведения об учетных записях хранения Azure см. в [этой статье](../common/storage-create-storage-account.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).

Для приложений, которые нужны, только чтобы блокировать или добавлять хранилище BLOB-объектов, лучше использовать учетные записи хранения BLOB-объектов. Это позволит получить преимущества дифференцированной модели ценообразования многоуровневого хранилища. Но мы понимаем, что это не всегда возможно в некоторых ситуациях, когда лучше использовать учетные записи хранения общего назначения. Ниже описаны эти ситуации.

* Вам необходимо использовать таблицы, очереди или файлы, а BLOB-объекты при этом нужно хранить в той же учетной записи хранения. Хранение в одной учетной записи не предоставляет никаких технических преимуществ, кроме возможности использования одних и тех же общих ключей.

* При этом все равно нужно использовать классическую модель развертывания. Учетные записи хранения BLOB-объектов доступны при использовании модели развертывания с помощью Azure Resource Manager.

* Вам нужно использовать страничные BLOB-объекты. Учетные записи хранения BLOB-объектов не поддерживают страничные BLOB-объекты. Обычно блочные BLOB-объекты рекомендуется использовать, только если нет необходимости в страничных BLOB-объектах.

* Вы используете версию [REST API служб хранилища](https://msdn.microsoft.com/library/azure/dd894041.aspx) , выпущенную раньше 14.02.2014, или клиентскую библиотеку версии ниже 4 и не можете установить новую версию приложения.

> [!NOTE]
> Сейчас учетные записи хранения BLOB-объектов поддерживаются во всех регионах Azure.


## <a name="blob-level-tiering-feature-preview"></a>Функция распределения по уровням для BLOB-объекта (предварительная версия)

Распределение BLOB-объектов по уровням позволяет изменять уровень данных для объектов в ходе одной операции — [установки уровня BLOB-объекта](/rest/api/storageservices/set-blob-tier). Можно легко изменить уровень доступа к BLOB-объекту на "горячий", "холодный" или архивный, изменив шаблон использования. Перемещать данные между учетными записями не требуется. Все изменения уровня вступают в силу немедленно, за исключением случаев, когда BLOB-объект восстанавливается из архива. Время последнего изменения уровня большого двоичного объекта определяет атрибут **Access Tier Change Time** в свойствах большого двоичного объекта. Если большой двоичный объект используется на архивном уровне, его нельзя перезаписать. Поэтому отправка того же самого большого двоичного объекта не допускается в этом сценарии. Большой двоичный объект можно перезаписать на горячем и холодном уровнях хранилища. В этом случае новый большой двоичный объект наследует уровень перезаписанного.

BLOB-объекты всех трех уровней хранилища могут сосуществовать в пределах одной учетной записи. Любой большой двоичный объект, которому явно не присвоен уровень, наследует его из параметра уровня доступа в учетной записи. Если уровень доступа выводится из учетной записи, атрибуту **Access Tier Inferred** присваивается значение true, а атрибут **Access Tier** большого двоичного объекта соответствует уровню учетной записи. На портале Azure свойство Access Tier Inferred отображается на уровне доступа большого двоичного объекта: например, Hot (inferred) (Горячий (выведен)) или Cool (inferred) (Холодный (выведен)).

> [!NOTE]
> Архивное хранилище и распределение BLOB-объектов по уровням поддерживают только большие двоичные объекты. Уровень большого двоичного объекта, который содержит моментальные снимки, изменить нельзя.

### <a name="blob-level-tiering-billing"></a>Выставление счетов за распределение BLOB-объектов по уровням

Перемещение большого двоичного объекта на более холодный уровень (горячий -> холодный, горячий -> архивный или холодный -> архивный) оплачивается как операция записи на целевой уровень. Запись на целевой уровень оплачивается за каждые 10 000 операций, а запись данных — за каждый ГБ. Перемещение большого двоичного объекта на более теплый уровень (архивный -> холодный, архивный -> горячий или холодный -> горячий) оплачивается, как операция чтения на исходном уровне. Чтение на исходном уровне оплачивается за каждые 10 000 операций, а получение данных — за каждый ГБ.

Чтобы использовать эти возможности в предварительной версии, выполните инструкции в [объявлении блога об архивном хранилище и распределении уровней BLOB-объекта в Azure ](https://azure.microsoft.com/blog/announcing-the-public-preview-of-azure-archive-blob-storage-and-blob-level-tiering).

Ниже перечислены некоторые ограничения для распределения уровней BLOB-объекта, которые применяются в предварительной версии:

* Архивное хранилище поддерживают только новые учетные записи хранения BLOB-объектов, созданные в восточной части США 2, восточной части США и западной части США после успешной регистрации предварительной версии.

* Распределение уровней BLOB-объектов поддерживают только новые учетные записи хранения BLOB-объектов, созданные в общедоступных регионах после успешной регистрации предварительной версии.

* Распределение уровней BLOB-объектов и архивное хранилище поддерживаются в [LRS] (../ common/storage-redundancy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json#locally-redundant-storage) только для хранения данных. В будущем планируется поддержка [GRS](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json#geo-redundant-storage) и [RA-GRS](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json#read-access-geo-redundant-storage).

* Нельзя изменять уровень BLOB-объекта с моментальными снимками.

* Нельзя делать копии или моментальные снимки большого двоичного объекта в архивном хранилище.

## <a name="comparison-of-the-storage-tiers"></a>Сравнение уровней хранилища

В таблице ниже приведены результаты сравнения "горячего" и "холодного" уровней хранилища. Архивный уровень BLOB-объекта реализован в предварительной версии, поэтому для него нет соглашений об уровне обслуживания.

| | **"Горячий" уровень хранилища** | **"Холодный" уровень хранилища** | **Архивный уровень хранилища**
| ---- | ----- | ----- | ----- |
| **Доступность** | 99,9 % | 99 % | Недоступно |
| **Доступность** <br> **(операции чтения RA-GRS)**| 99,99 % | 99,9 % | Недоступно |
| **Плата за использование** | Выше стоимость хранения, ниже расходы на доступ и транзакции | Ниже стоимость хранения, выше расходы на доступ и транзакции | Ниже стоимость хранения, выше расходы на доступ и транзакции |
| **Объекты минимального размера** | Недоступно | Недоступно | Недоступно |
| **Минимальный срок хранения** | Недоступно | Недоступно | 180 дней
| **Задержка** <br> **(время до получения первого байта)** | Миллисекунды | Миллисекунды | < 15 часов
| **Целевые показатели масштабируемости и производительности** | Такие же, как при использовании учетных записей хранения общего назначения | Такие же, как при использовании учетных записей хранения общего назначения | Такие же, как при использовании учетных записей хранения общего назначения |

> [!NOTE]
> Учетные записи хранения BLOB-объектов обеспечивают такую же производительность и масштабируемость, как учетные записи хранения общего назначения. Дополнительные сведения см. в статье [Целевые показатели масштабируемости и производительности службы хранилища Azure](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).


## <a name="pricing-and-billing"></a>Цены и выставление счетов
Модель ценообразования в учетных записях хранения больших двоичных объектов учитывает уровень хранилища каждого большого двоичного объекта. При использовании учетной записи хранения BLOB-объектов счета выставляются следующим образом:

* **Расходы на хранение.** Плата за хранение данных зависит не только от их объема, но и от уровня хранилища. Чем холоднее уровень хранилища, тем меньше стоит каждый гигабайт.

* **Затраты на доступ к данным.** Чем холоднее уровень хранилища, тем дороже доступ к данным. На холодном и архивном уровнях хранилища взимается плата за чтение каждого гигабайта данных.

* **Затраты на транзакции.** Чем холоднее уровень хранилища, тем выше стоимость каждой транзакции для всех уровней.

* **Расходы на передачу данных георепликации**. Этот пункт касается только тех учетных записей, в которых настроена георепликация, включая GRS и RA-GRS. При передаче данных георепликации взимается плата за гигабайт данных.

* **Расходы на исходящий трафик.** Передача трафика (из региона Azure) предусматривает выставление счетов за использование пропускной способности по гигабайтам, как и при использовании учетных записей хранения общего назначения.

* **Изменение уровня хранилища.** Переход в учетной записи с холодного уровня хранилища на горячий оплачивается. Оплата равна стоимости операций чтения всех данных в учетной записи хранения. При этом стоимость перехода с горячего уровня хранилища на холодный равна стоимости операций записи всех данных на холодный уровень.

> [!NOTE]
> Дополнительные сведения о модели ценообразования для учетных записей хранения BLOB-объектов см. на странице с [ценами на службу хранилища Azure](https://azure.microsoft.com/pricing/details/storage/). Дополнительные сведения о ценах на исходящий трафик см. на странице с [ценами на передачу данных](https://azure.microsoft.com/pricing/details/data-transfers/).

## <a name="quick-start"></a>Быстрый запуск

В этом разделе описаны следующие сценарии с использованием портала Azure:

* создание учетной записи хранения BLOB-объектов;
* управление учетной записью хранения BLOB-объектов.

В примерах ниже нельзя установить архивный уровень доступа, так как этот параметр применяется ко всей учетной записи хранения. Архивный уровень доступа можно устанавливать только для отдельных BLOB-объектов.

### <a name="create-a-blob-storage-account-using-the-azure-portal"></a>Создание учетной записи хранилища BLOB-объектов с использованием портала Azure

1. Войдите на [портал Azure](https://portal.azure.com).

2. В меню концентратора выберите **Создать** > **Данные+хранилище** > **Учетная запись хранения**.

3. Выберите имя для своей учетной записи хранения.

    Это имя должно быть уникальным глобально. Оно используется как часть URL-адреса, необходимого для доступа к объектам в учетной записи хранения.  

4. Выберите **Resource Manager** в качестве модели развертывания.

    Для многоуровневого хранилища можно использовать только учетные записи хранения Resource Manager. Это рекомендуемая модель развертывания для новых ресурсов. Дополнительные сведения см. в статье [Общие сведения об Azure Resource Manager](../../azure-resource-manager/resource-group-overview.md).  

5. В раскрывающемся списке Account Kind (Тип учетной записи) выберите **Хранилище BLOB-объектов**.

    Таким образом вы выбираете тип учетной записи хранения. Многоуровневое хранилище недоступно при использовании учетных записей хранения общего назначения. Оно доступно только при использовании учетной записи хранилища BLOB-объектов.     

    Для многоуровневого хранилища используется уровень производительности "Стандартный". Уровень Premium недоступен.

6. Выберите тип хранилища репликации для учетной записи хранения: **LRS**, **GRS** или **RA-GRS**. Значение по умолчанию — **RA-GRS**.

    LRS — локально избыточное хранилище; GRS — геоизбыточное хранилище (два региона); RA-GRS — геоизбыточное хранилище с доступом для чтения (2 региона с доступом для чтения второго).

    Дополнительные сведения о репликации службы хранилища Azure см. в [этой статье](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).

7. Выберите нужный уровень хранилища в соответствии со своими потребностями, задав для параметра **Уровень доступа** значение **Холодный** или **Горячий**. По умолчанию используется значение **Горячий**.

8. Выберите подписку, в которой вы создаете учетную запись хранения.

9. Выберите существующую группу ресурсов или создайте новую. Дополнительные сведения о группах ресурсов см. в статье [Общие сведения об Azure Resource Manager](../../azure-resource-manager/resource-group-overview.md).

10. Выберите регион для вашей учетной записи хранения.

11. Щелкните **Создать** , чтобы создать учетную запись хранения.

### <a name="change-the-storage-tier-of-a-blob-storage-account-using-the-azure-portal"></a>Изменение уровня хранилища в учетной записи хранилища BLOB-объектов с помощью портала Azure

1. Войдите на [портал Azure](https://portal.azure.com).

2. Чтобы перейти к вашей учетной записи хранения, выберите "Все ресурсы", а затем — необходимую учетную запись хранения.

3. В колонке "Параметры" щелкните **Конфигурация** , чтобы просмотреть и (или) изменить конфигурацию учетной записи.

4. Выберите нужный уровень хранилища в соответствии со своими потребностями, задав для параметра **Уровень доступа** значение **Холодный** или **Горячий**.

5. Щелкните "Сохранить" в верхней части колонки.

### <a name="change-the-storage-tier-of-a-blob-using-the-azure-portal"></a>Изменение уровня хранилища больших двоичных объектов с помощью портала Azure

1. Выполните вход на [портал Azure](https://portal.azure.com).

2. Чтобы перейти к большому двоичному объекту в своей учетной записи хранения, выберите "Все ресурсы". Затем последовательно выберите учетную запись хранения, контейнер и большой двоичный объект.

3. В колонке свойств большого двоичного объекта в раскрывающемся меню **Уровень доступа** выберите **горячий**, **холодный** или **архивный** уровень хранилища.

5. Щелкните "Сохранить" в верхней части колонки.

> [!NOTE]
> За изменение уровня хранилища может взиматься дополнительная плата. Дополнительные сведения см. в разделе [Цены и выставление счетов](#pricing-and-billing).


## <a name="evaluating-and-migrating-to-blob-storage-accounts"></a>Оценка учетных записей хранилища BLOB-объектов и переход на них
В это разделе описано, как выполнить оптимальный переход к использованию учетной записи хранилища BLOB-объектов. Есть два пользовательских сценария.

* У вас есть учетная запись хранилища общего назначения, и вы хотите оценить последствия перехода на учетную запись хранилища BLOB-объектов с соответствующим уровнем хранилища.
* Вы решили использовать или уже используете учетную запись хранилища BLOB-объектов. Теперь вы хотите выяснить, какой уровень хранилища использовать — "горячий" или "холодный".

В обоих случаях сначала стоит оценить затраты на хранение данных и доступ к ним в учетной записи хранилища BLOB-объектов, а затем сравнить эти затраты с текущими.

## <a name="evaluating-blob-storage-account-tiers"></a>Оценка уровней учетной записи хранилища BLOB-объектов

Чтобы оценить затраты на хранение данных и доступ к ним в учетной записи хранения BLOB-объектов, необходимо оценить существующую схему использования или приблизительно определить будущую. В общем, необходимо выяснить следующее:

* Использование хранилища. Сколько данных хранится и насколько меняется их объем каждый месяц?

* Схема доступа к хранилищу. Какой объем данных считывается из учетной записи и какой объем записывается в нее? (В этих расчетах также должны учитываться новые данные.) Сколько транзакций используется для доступа к данным? Что это за транзакции?

## <a name="monitoring-existing-storage-accounts"></a>Мониторинг существующих учетных записей хранения

Чтобы отслеживать существующие учетные записи хранения и собирать данные о них, используйте службу "Аналитика Службы хранилища Azure", которая ведет журналы и хранит метрики учетной записи хранения. Служба анализа службы хранилища хранит метрики, содержащие сводную статистику транзакций и данные емкости запросов к службе хранилища BLOB-объектов. Речь идет о метриках учетных записей хранения общего назначения и учетных записей хранилища BLOB-объектов. Эти данные хранятся в общеизвестных таблицах в той же учетной записи хранения.

Дополнительные сведения см. в статьях о [метриках аналитики хранилища](https://msdn.microsoft.com/library/azure/hh343258.aspx) и [схеме таблиц для метрик аналитики хранилища](https://msdn.microsoft.com/library/azure/hh343264.aspx).

> [!NOTE]
> Учетные записи хранилища BLOB-объектов предоставляют конечную точку службы таблиц только для хранения данных метрик для этой учетной записи и доступа к этим данным.

Чтобы отслеживать использование ресурсов хранения в службе хранилища BLOB-объектов, необходимо включить метрики емкости.
Если эти метрики включены, данные о емкости ежедневно будут записываться для службы учетной записи хранения больших двоичных объектов. Эти данные регистрируются как запись в таблице *$MetricsCapacityBlob* в той же учетной записи хранения.

Чтобы отслеживать схему доступа к данным для службы хранилища BLOB-объектов, включите почасовые метрики транзакций на уровне API. Если эти метрики включены, транзакции каждого API собираются каждый час. Эти данные регистрируются как запись таблицы, которая записывается в таблицу *$MetricsHourPrimaryTransactionsBlob* в той же учетной записи хранения. Транзакции учетных записей хранения RA-GRS записываются таблицей *$MetricsHourSecondaryTransactionsBlob* на вторую конечную точку.

> [!NOTE]
> Этот процесс оценки нельзя применить к учетной записи хранения общего назначения, в которой хранятся страничные BLOB-объекты и диски виртуальных машин вместе с данными блочных или добавочных BLOB-объектов. Это связано с тем, что вы не можете различить метрики емкости и транзакций, ориентируясь на тип большого двоичного объекта только для блочных или добавочных BLOB-объектов, которые могут быть перенесены в учетную запись хранения BLOB-объектов.

Чтобы понять, как используются данные и предоставляется доступ к ним, рекомендуем выбрать период хранения для метрик, отражающий эти закономерности, и экстраполировать полученные данные. Один из вариантов — хранить данные метрик в течение семи дней и собирать данные каждую неделю для анализа в конце месяца. Либо вы можете хранить данные метрик месяц, собирая и анализируя данные в конце 30-дневного периода.

Дополнительные сведения о включении, сборе и просмотре данных метрик см. в статье [Включение метрик хранилища Azure и просмотр данных метрик](../common/storage-enable-and-view-metrics.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).

> [!NOTE]
> Хранение и загрузка данных аналитики, а также доступ к ним оплачиваются, как для обычных данных пользователя.

### <a name="utilizing-usage-metrics-to-estimate-costs"></a>Оценка затрат с помощью метрик использования

### <a name="storage-costs"></a>Затраты на хранение

Последняя запись в таблице метрик емкости *$MetricsCapacityBlob* с ключом строки *data* показывает емкость хранилища, которую потребляют данные пользователя. Последняя запись в таблице метрик емкости *$MetricsCapacityBlob* с ключом строки *analytics* показывает емкость хранилища, которую потребляют журналы службы аналитики.

Сведения об общей емкости, потребляемой данными пользователя и журналами службы аналитики (если они включены), позволяют оценить затраты на хранение данных в учетной записи хранения. Этот метод можно использовать для оценки затрат на хранение для блочных и добавочных BLOB-объектов в учетных записях хранения общего назначения.

### <a name="transaction-costs"></a>Плата за транзакции

Сумма значений *TotalBillableRequests*во всех записях для API в таблице метрик транзакций означает общее количество транзакций для этого API. *Например*, общее количество транзакций *GetBlob* в течение указанного периода можно вычислить, просуммировав все оплачиваемые запросы для всех операций с ключом строки *user;GetBlob*.

Чтобы оценить затраты на транзакции для учетных записей хранения BLOB-объектов, разделите транзакции на три группы, так как для них установлены разные цены.

* Транзакции записи: *PutBlob*, *PutBlock*, *PutBlockList*, *AppendBlock*, *ListBlobs*, *ListContainers*, *CreateContainer*, *SnapshotBlob* и *CopyBlob*.
* Транзакции удаления: *DeleteBlob* и *DeleteContainer*.
* Все остальные транзакции.

Чтобы оценить затраты на транзакции для учетных записей хранения общего назначения, просуммируйте стоимость всех транзакций независимо от операции или API.

### <a name="data-access-and-geo-replication-data-transfer-costs"></a>Стоимость передачи данных георепликации и доступа к данным

Служба аналитики службы хранилища не указывает объем данных, которые считываются из учетной записи хранения и записываются в нее. Но этот объем можно приблизительно оценить, просмотрев таблицу метрик транзакций. Сумма значений *TotalIngress* во всех записях для API в таблице метрик транзакций отображает общий объем входящих данных в байтах для этого API. Точно так же сумма значений *TotalEgress* отображает общий объем исходящих данных в байтах.

Чтобы оценить затраты на доступ к данным для учетных записей хранения BLOB-объектов, разделите транзакции на две группы.

* Чтобы оценить объем данных, полученных из учетной записи хранения, вы можете суммировать значения *TotalEgress* в первую очередь для операций *GetBlob* и *CopyBlob*.

* Чтобы оценить объем данных, записанных в учетную запись хранения, вы можете суммировать значения *TotalIngress* в первую очередь для операций *PutBlob*, *PutBlock*, *CopyBlob* и *AppendBlock*.

Расходы на передачу данных георепликации для учетных записей хранения BLOB-объектов также можно рассчитать, оценив объем данных, записанных в учетные записи хранения GRS или RA-GRS.

> [!NOTE]
> Более подробный пример расчета затрат на использование "горячего" или "холодного" уровня хранилища см. в ответе на вопрос *Что такое "горячий" и "холодный" уровень доступа и как определить, какой из них следует использовать?* на странице [Цены на хранилища Azure](https://azure.microsoft.com/pricing/details/storage/).

## <a name="migrating-existing-data"></a>Миграция существующих данных

Учетная запись хранения BLOB-объектов предназначена для хранения только блочных и добавочных BLOB-объектов. Существующие учетные записи хранения общего назначения, в которых можно хранить таблицы, очереди, файлы, диски и большие двоичные объекты, нельзя преобразовать в учетные записи хранения BLOB-объектов. Чтобы использовать уровни хранилища, вам создайте учетные записи хранения BLOB-объектов и перенесите существующие данные в новые учетные записи.

Чтобы перенести данные в учетную запись хранения BLOB-объектов из устройств локального хранилища, сторонних поставщиков облачного хранилища или учетной записи хранения общего назначения в Azure, можно использовать следующее:

### <a name="azcopy"></a>AzCopy

AzCopy — это программа командной строки Windows, предназначенная для быстрого копирования большого объема данных в службу хранилища Azure и из нее. С помощью AzCopy можно копировать данные в учетную запись хранения BLOB-объектов из существующих учетных записей хранения общего назначения или передать данные из локальных устройств хранения в учетную запись хранения BLOB-объектов.

Дополнительные сведения см. в статье [Приступая к работе со служебной программой командной строки AzCopy](../common/storage-use-azcopy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).

### <a name="data-movement-library"></a>Библиотека перемещения данных

В основе библиотеки перемещения данных службы хранилища Azure для .NET лежит основная платформа перемещения данных, на базе которой работает AzCopy. Библиотека предназначена для надежной и простой передачи данных при высокой производительности, как AzCopy. Благодаря ей вы можете изначально пользоваться всеми преимуществами функций AzCopy в своем приложении без необходимости запускать внешние экземпляры AzCopy и выполнять их мониторинг.

Дополнительные сведения см. в статье [Azure Storage Data Movement Library for .NET](https://github.com/Azure/azure-storage-net-data-movement) (Библиотека перемещения данных службы хранилища Azure для .NET).

### <a name="rest-api-or-client-library"></a>REST API или клиентская библиотека

Вы можете самостоятельно создать приложение, чтобы перенести данные в учетную запись хранения BLOB-объектов, используя одну из клиентских библиотек Azure или API REST служб хранения Azure. Служба хранилища Azure предоставляет богатые клиентские библиотеки для создания приложений с использованием .NET, Java, Android, C++, Node.js, PHP, Ruby и Python. Клиентские библиотеки предлагают дополнительные возможности, такие как логический алгоритм повтора, ведение журнала и параллельная загрузка. Также есть возможность вести разработку непосредственно через интерфейс API REST, который можно вызывать в любом языке программирования, поддерживающем запросы HTTP/HTTPS.

Дополнительные сведения см. в статье [Приступая к работе с хранилищем BLOB-объектов Azure с помощью .NET](storage-dotnet-how-to-use-blobs.md).

> [!NOTE]
> Вместе с большими двоичными объектами, зашифрованными на стороне клиента, хранятся связанные с шифрованием метаданные. Крайне важно, чтобы используемый механизм копирования обеспечивал копирование метаданных большого двоичного объекта, особенно тех, которые связаны с шифрованием. Если копировать большие двоичные объекты без этих метаданных, содержимое объектов нельзя будет извлечь повторно. Дополнительные сведения о метаданных, связанных с шифрованием, см. в статье [Шифрование на стороне клиента для службы хранилища Microsoft Azure](../common/storage-client-side-encryption.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json).

## <a name="faq"></a>Часто задаваемые вопросы

1. **Будут ли по-прежнему доступны существующие учетные записи хранения?**

    Да, учетные записи хранения будут доступны. Их функции и цена на их использование также не изменятся.  Но вы не можете выбрать уровень хранилища сейчас, и эта возможность не предвидится в будущем.

2. **Когда и почему лучше начать использовать учетные записи хранения BLOB-объектов?**

    Учетные записи хранения больших двоичных объектов предназначены для хранения больших двоичных объектов. Они предоставляют новые функции таких объектов. Забегая вперед, можно отметить, что учетная запись хранения BLOB-объектов — это рекомендуемое средство хранения соответствующих объектов, ведь в будущем планируется реализовать возможности иерархического и уровневого хранения на основе учетной записи этого типа. Тем не менее решение о миграции следует принимать на основе требований своего бизнеса.

3. **Можно ли преобразовать учетную запись хранения в учетную запись хранения BLOB-объектов?**

    Нет. Учетная запись хранения BLOB-объектов — это учетная запись другого типа. Вам необходимо создать новую запись и перенести данные, как описано ранее.

4. **Можно ли хранить объекты на обоих уровнях хранилища в одной учетной записи?**

    Да. Атрибут *Access Tier*, назначенный на уровне учетной записи, является уровнем по умолчанию. Он применяется ко всем объектам в этой учетной записи без явно указанного уровня. Но функция распределения BLOB-объектов по уровням (предварительная версия) позволяет задавать уровень доступа на уровне объекта независимо от параметра уровня доступа, назначенного в учетной записи. Большие двоичные объекты на любом из трех уровней хранилища (горячий, холодный и архивный) могут существовать в одной учетной записи.

5. **Можно ли изменить уровень хранилища в учетной записи хранилища BLOB-объектов?**

    Вы можете изменить уровень хранилища, установив атрибут *Access Tier* для учетной записи хранения. Изменение уровня хранилища применяется ко всем объектам, которые хранятся в учетной записи и для которых явно не назначен уровень. Изменение уровня хранилища с горячего на холодный предусматривает оплату за операции записи (за каждые 10 000 операций) и за запись данных (за каждый ГБ). Это применимо только к учетным записям хранения больших двоичных объектов. Изменение уровня хранилища с холодного на горячий предусматривает оплату за операции чтения (за каждые 10 000 операций) и за извлечение данных (за каждый ГБ) для чтения всех данных в учетной записи.

6. **Как часто можно изменять уровень хранилища в учетной записи хранилища BLOB-объектов?**

    Ограничений на частоту изменения уровня хранилища нет. Но учитывайте, что изменение уровня хранилища с "холодного" на "горячий" связано с большими расходами. Часто менять уровень хранилища не рекомендуется.

7. **Отличается ли поведение BLOB-объектов на "холодном" уровне хранилища от поведения этих объектов на "горячем" уровне?**

    Для больших двоичных объектов на "горячем" уровне хранилища характерна такая же задержка, как для больших двоичных объектов в учетных записях хранения общего назначения. Для больших двоичных объектов на "холодном" уровне хранилища характерна такая же задержка (в миллисекундах), как для больших двоичных объектов в учетных записях хранения общего назначения. При доступе к большим двоичным объектам на архивном уровне хранилища может быть задержка в несколько часов.

    Доступность BLOB-объектов на "холодном" уровне хранилища несколько ниже (в соответствии с соглашением об уровне обслуживания), чем у BLOB-объектов на "горячем" уровне. Дополнительные сведения см. в статье [Соглашение об уровне обслуживания для хранилища](https://azure.microsoft.com/support/legal/sla/storage).

8. **Можно ли хранить страничные BLOB-объекты и диски виртуальных машин в учетных записях хранения BLOB-объектов?**

    Учетные записи хранения BLOB-объектов поддерживают только блочные и добавочные BLOB-объекты и не поддерживают страничные. Диски виртуальных машин Azure используют страничные BLOB-объекты, поэтому учетные записи хранения BLOB-объектов нельзя использовать для хранения дисков виртуальных машин. Но в учетных записях хранения BLOB-объектов можно хранить резервные копии дисков виртуальных машин в качестве блочных BLOB-объектов.

9. **Нужно ли изменять свои существующие приложения, чтобы использовать учетные записи хранения BLOB-объектов?**

    Учетные записи хранения BLOB-объектов полностью совместимы с API учетных записей хранения общего назначения в плане блочных и добавочных BLOB-объектов. Приложение будет работать при использовании блочных или добавочных BLOB-объектов и [REST API служб хранилища](https://msdn.microsoft.com/library/azure/dd894041.aspx) версии 14.02.2014 и выше. Если вы используете протокол старой версии, нужно обновить приложение, чтобы использовать новую версию и эффективно работать с учетными записями хранения обоих типов. В целом рекомендуется всегда использовать последнюю версию, независимо от того, учетную запись хранения какого типа вы используете.

10. **Произойдут ли изменения в работе пользователей?**

    Учетные записи хранения BLOB-объектов очень похожи на учетные записи хранения общего назначения, если речь идет о хранении блочных и добавочных BLOB-объектов. Они поддерживают все ключевые функции службы хранилища Azure, включая обеспечение высоких показателей надежности, доступности, масштабируемости, производительности и безопасности. Они отличаются только функциями, определенными ограничениями для учетных записей хранилища BLOB-объектов, а также уровнями хранилища, описанными выше.

## <a name="next-steps"></a>Дальнейшие действия

### <a name="evaluate-blob-storage-accounts"></a>Оценка учетных записей хранения BLOB-объектов

[Проверка доступности учетных записей хранения BLOB-объектов по региону](https://azure.microsoft.com/regions/#services)

[Оценка использования текущих учетных записей хранения путем включения метрик службы хранилища Azure](../common/storage-enable-and-view-metrics.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[Проверка цен на хранилище BLOB-объектов по региону](https://azure.microsoft.com/pricing/details/storage/)

[Проверка сведений о ценах на передачу данных](https://azure.microsoft.com/pricing/details/data-transfers/)

### <a name="start-using-blob-storage-accounts"></a>Начало работы с учетными записями хранения BLOB-объектов

[Приступая к работе с хранилищем BLOB-объектов Azure](storage-dotnet-how-to-use-blobs.md)

[Перемещение данных в службу хранилища Azure и обратно](../common/storage-moving-data.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[Приступая к работе со служебной программой командной строки AzCopy](../common/storage-use-azcopy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[Обозреватель службы хранилища Microsoft Azure](http://storageexplorer.com/)
