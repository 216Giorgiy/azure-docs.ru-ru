<properties 
	pageTitle="Настройка строки подключения к хранилищу Azure | Microsoft Azure"
	description="Составление строки подключения к учетной записи хранения Azure. Строка подключения содержит сведения, необходимые для аутентификации при доступе к ресурсам в учетной записи хранения из приложения."
	services="storage"
	documentationCenter=""
	authors="tamram"
	manager="carmonm"
	editor="tysonn"/>

<tags
	ms.service="storage"
	ms.workload="storage"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="04/01/2016"
	ms.author="tamram"/>

# Настройка строк подключения службы хранилища Azure

## Обзор

Строка подключения содержит сведения, необходимые для доступа к ресурсам хранилища Azure программным способом. Приложение использует строку подключения для предоставления информации, необходимой для проверки подлинности при доступе в хранилище Azure.

Можно настроить строку подключения, чтобы сделать следующее.

- Подключиться к эмулятору хранения Azure при локальном тестировании службы или приложения.
- Подключиться к учетной записи хранения в Azure с помощью конечных точек по умолчанию для служб хранилища или явно заданных вами конечных точек.
- Получить доступ к ресурсам в учетной записи хранения через подпись общего доступа (SAS).

## Хранение строки подключения

Приложение должно хранить строки подключения, чтобы проверять подлинность доступа к службе хранилища Azure во время работы. Есть несколько вариантов для хранения строки подключения.

- Для приложения, работающего на рабочем столе или на устройстве, можно хранить строки подключения в файле app.config или другом файле конфигурации. Если вы используете файл app.config, добавьте строку подключения для раздела **AppSettings**.
- Для приложения, работающего в облачной службе Azure, можно хранить строки подключения в [файле схемы конфигурации службы Azure (.cscfg)](https://msdn.microsoft.com/library/ee758710.aspx). Добавьте строку подключения в раздел **ConfigurationSettings** файла конфигурации службы.

Хранение строки подключения в файле конфигурации упрощает обновление строки подключения для переключения между эмулятором хранения и учетной записью хранения Azure в облаке. Необходимо только изменить строку подключения, чтобы указать учетную запись хранения.

Вы можете использовать класс [Microsoft Azure Configuration Manager](https://www.nuget.org/packages/Microsoft.WindowsAzure.ConfigurationManager/) для доступа к строке подключения во время выполнения независимо от того, где выполняется приложение.

## Создание строки подключения в эмуляторе хранения

[AZURE.INCLUDE [storage-emulator-connection-string-include](../../includes/storage-emulator-connection-string-include.md)]

Дополнительные сведения об эмуляторе хранения см. в разделе [Использование эмулятора хранения Azure для разработки и тестирования](storage-use-emulator.md).

## Создание строки подключения к учетной записи хранения Azure

Чтобы создать строку подключения к учетной записи хранения Azure, используйте формат строки подключения, указанный ниже. Указывает, следует ли подключиться к учетной записи хранения через HTTP или HTTPS (рекомендуется). Замените `myAccountName` на имя вашей учетной записи хранения и замените `myAccountKey` на ваш ключ доступа учетной записи:

    DefaultEndpointsProtocol=[http|https];AccountName=myAccountName;AccountKey=myAccountKey

Созданная строка подключения будет выглядеть так, как строка из следующего примера:

	DefaultEndpointsProtocol=https;
	AccountName=storagesample;
	AccountKey=<account-key>

> [AZURE.NOTE] Служба хранилища Azure поддерживает как HTTP, так и HTTPS в строке подключения; однако настоятельно рекомендуется использовать HTTPS.

## Создание строки подключения к явной конечной точке хранилища

Вы можете явно указать конечные точки службы в своей строке подключения, если:

- вы сопоставили собственное доменное имя для учетной записи хранения со службой BLOB-объектов;
- у вас есть подписанный URL-адрес для доступа к ресурсам хранилища в учетной записи хранения.

Чтобы создать строку подключения, определяющую явную конечную точку BLOB-объекта, укажите полную конечную точку для каждой службы, включая спецификацию протокола (HTTP или HTTPS), в следующем формате:

	BlobEndpoint=myBlobEndpoint;
	QueueEndpoint=myQueueEndpoint;
	TableEndpoint=myTableEndpoint;
	FileEndpoint=myFileEndpoint;
	[credentials]


Вы должны указать хотя бы одну конечную точку службы, но необязательно указывать их все. Например, если вы создаете строку подключения для использования с пользовательской конечной точкой большого двоичного объекта, можно не указывать конечные точки для очереди и таблицы. Обратите внимание, что, если вы решили не указывать в строке подключения конечные точки очередей и таблиц, вы не сможете получить доступ к службам очередей и таблиц из кода, используя эту строку подключения.

Когда вы явно указываете конечные точки службы в строке подключения, есть два варианта указания `credentials` в строке выше:

- Можно указать имя учетной записи и ключ: `AccountName=myAccountName;AccountKey=myAccountKey`
- Можно указать подпись общего доступа: `SharedAccessSignature=base64Signature`

### Назначение конечной точки BLOB-объекта с помощью пользовательского доменного имени

Если вы зарегистрировали собственное доменное имя для использования со службой BLOB-объектов, то можно явным образом указать в строке подключения конечную точку большого двоичного объекта. Значение конечной точки из строки подключения применяется для создания универсальных кодов ресурса (URI) к службе BLOB-объектов, а также определяет форму любых универсальных кодов ресурса (URI), возвращаемых в код.

Например, строка подключения к конечной точке BLOB-объекта в пользовательском доменном имени может выглядеть следующим образом:

	DefaultEndpointsProtocol=https;
	BlobEndpoint=www.mydomain.com;
	AccountName=storagesample;
	AccountKey=<account-key>


### Назначение конечной точки BLOB-объекта с помощью подписанного URL-адреса

Вы можете создать строку подключения с явно заданными конечными точками для доступа к ресурсам хранилища с помощью подписанного URL-адреса. В этом случае можно указать подписанный URL-адрес как часть строки подключения, а не как часть учетных данных имени и ключа учетной записи. Маркер подписанного URL-адреса инкапсулирует данные о запрашиваемом ресурсе, периоде, во время которого он доступен, и имеющихся разрешениях. Дополнительные сведения о подписанном URL-адресе см. в разделе [Подписанный URL-адрес: общие сведения о модели SAS](storage-dotnet-shared-access-signature-part-1.md).

Чтобы создать строку подключения, содержащую подписанный URL-адрес, задайте ее в следующем формате:

    BlobEndpoint=myBlobEndpoint; QueueEndpoint=myQueueEndpoint;TableEndpoint=myTableEndpoint;SharedAccessSignature=sasToken

Конечная точка может быть конечной точкой службы по умолчанию или пользовательской конечной точкой. `sasToken` — строка запроса, которая следует за знаком вопроса (?) в URL-адресе SAS.

### Создание строки подключения с суффиксом конечной точки

Чтобы создать строку подключения для службы хранилища в регионах или экземплярах с разными суффиксами конечных точек, например Azure China (Azure для Китая) или Azure Governance (Azure для правительственных организаций), используйте следующий формат строки подключения. Указывает, следует ли подключиться к учетной записи хранения через HTTP или HTTPS. Замените `myAccountName` на имя вашей учетной записи хранения, замените `myAccountKey` на ключ доступа учетной записи и замените `mySuffix` на суффикс URI:


	DefaultEndpointsProtocol=[http|https];AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=mySuffix;


Созданная строка подключения должна выглядеть так, как строка из следующего примера:

	DefaultEndpointsProtocol=https;
	AccountName=storagesample;
	AccountKey=<account-key>;
	EndpointSuffix=core.chinacloudapi.cn;

## Дальнейшие действия

- [Использование эмулятора хранения Azure для разработки и тестирования](storage-use-emulator.md)
- [Обучающие ресурсы для хранилища Azure](storage-explorers.md)

<!---HONumber=AcomDC_0406_2016-->