---
title: Использование RBAC для управления правами доступа к контейнерам и очередям (предварительная версия) — служба хранилища Azure | Документы Майкрософт
description: Используйте управление доступом на основе ролей (RBAC), чтобы назначить роли для доступа к данным BLOB-объектов и очередей пользователям, группам, субъектам-службам приложениям или управляемым удостоверениям службы. Служба хранилища Azure поддерживает встроенные и настраиваемые роли для прав доступа к контейнерам и очередям.
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 12/12/2018
ms.author: tamram
ms.component: common
ms.openlocfilehash: fce89cc754ac179054a60ce837949bb02b2102c6
ms.sourcegitcommit: c37122644eab1cc739d735077cf971edb6d428fe
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2018
ms.locfileid: "53408703"
---
# <a name="manage-access-rights-to-azure-blob-and-queue-data-with-rbac-preview"></a>Управление правами доступа к данным BLOB-объектов и очередей Azure с помощью RBAC (предварительная версия)

Azure Active Directory (Azure AD) разрешает права доступа к защищенным ресурсам с помощью [управления доступом на основе ролей (RBAC)](https://docs.microsoft.com/azure/role-based-access-control/overview). Служба хранилища Azure определяет набор встроенных ролей RBAC, которые охватывают общие наборы разрешений, используемые для доступа к контейнерам или очередям. Когда роль RBAC назначается удостоверению Azure AD, этому удостоверению предоставляется доступ к соответствующим ресурсам в соответствии с указанной областью. Доступ может ограничиваться уровнем подписки, группой ресурсов, учетной записью хранения или отдельным контейнером или очередью. Эти права доступа можно назначать ресурсам службы хранилища Azure с помощью портала Azure, программ командной строки Azure и интерфейсов API управления Azure. 

Можно использовать удостоверение Azure AD пользователя, группы или субъекта-службы приложения, а также управляемое удостоверение службы для ресурсов Azure. Пользователь, группа или субъект-служба приложения могут использоваться в качестве субъекта безопасности. [Управляемое удостоверение для ресурсов Azure](../../active-directory/managed-identities-azure-resources/overview.md) — это автоматически управляемое удостоверение, используемое для аутентификации из приложений, запущенных на виртуальных машинах Azure, функциональных приложений, масштабируемых наборов виртуальных машин и т д. Сведения об удостоверении в Azure AD см. в статье, посвященной [обзору решений удостоверения Azure](https://docs.microsoft.com/azure/active-directory/understand-azure-identity-solutions).

[!INCLUDE [storage-auth-aad-note-include](../../../includes/storage-auth-aad-note-include.md)]

## <a name="rbac-roles-for-blobs-and-queues"></a>Роли RBAC для больших двоичных объектов и очередей

Служба хранилища Azure поддерживает встроенные и пользовательские роли RBAC. Она предлагает использовать эти встроенные роли RBAC в Azure AD:

- [Владелец данных BLOB-объектов хранилища (предварительная версия)](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-blob-data-owner-preview). Предоставляет права владельца и позволяет управлять доступом POSIX для Azure Data Lake Storage 2-го поколения (предварительная версия). Дополнительные сведения см. в статье [Контроль доступа в Azure Data Lake Storage 2-го поколения](../blobs/data-lake-storage-access-control.md).
- [Участник для данных больших двоичных объектов хранилища (предварительная версия)](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-blob-data-contributor-preview). Предоставляет разрешения (чтение, запись и удаление) к ресурсам хранилища BLOB-объектов.
- [Модуль чтения данных больших двоичных объектов хранилища (предварительная версия).](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-blob-data-reader-preview) Предоставляет разрешения только для чтения к ресурсам хранилища BLOB-объектов.
- [Участник для данных очереди хранилища (предварительная версия).](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-queue-data-contributor-preview) Предоставляет разрешения (чтение, запись и удаление) к очередям Azure.
- [Модуль чтения данных очереди хранилища (предварительная версия).](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-queue-data-reader-preview) Предоставляет разрешения только для чтения к очередям Azure.

Дополнительные сведения о том, как встроенные роли определяются для службы хранилища Azure, см. в статье, посвященной [обзору определений ролей](https://docs.microsoft.com/azure/role-based-access-control/role-definitions#management-and-data-operations-preview).

Вы также можете определить собственные роли, чтобы использовать их с контейнерами и очередями. Дополнительные сведения см. в статье, посвященной [созданию пользовательских ролей для управления доступом на основе ролей в Azure](https://docs.microsoft.com/azure/role-based-access-control/custom-roles). 

[!INCLUDE [storage-auth-aad-note-include](../../../includes/storage-auth-aad-note-include.md)]

## <a name="assign-a-role-to-a-security-principal"></a>Назначение роли субъекту безопасности

Назначьте роль RBAC удостоверению Azure, чтобы предоставить разрешение на доступ к контейнерам или очередям в учетной записи хранения. Вы можете ограничить назначение роли до учетной записи хранения или определенного контейнера или очереди. В таблице ниже приводится сводка прав доступа, предоставленных встроенными ролями, в зависимости от области резервирования:

|Область|Владелец данных больших двоичных объектов|Участник данных BLOB-объектов|Модуль чтения данных BLOB-объектов|Участник данных очереди|Модуль чтения данных очереди|
|---|---|---|---|---|---|
|Уровень подписки|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в подписке|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в подписке| Доступ на чтение для всех контейнеров и больших двоичных объектов в подписке|Доступ на чтение и запись для всех очередей в подписке|Доступ на чтение для всех очередей в подписке|
|Уровень группы ресурсов|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в группе ресурсов|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в группе ресурсов|Доступ на чтение для всех контейнеров и больших двоичных объектов в группе ресурсов|Доступ на чтение и запись для всех очередей в группе ресурсов|Доступ на чтение для всех очередей в группе ресурсов|
|Уровень учетной записи хранения|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в учетной записи хранения|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в учетной записи хранения|Доступ на чтение для всех контейнеров и больших двоичных объектов в учетной записи хранения|Доступ на чтение и запись для всех очередей в учетной записи хранения|Доступ на чтение для всех очередей в учетной записи хранения|
|Уровень контейнера или очереди|Доступ на чтение и запись и управление доступом POSIX к указанным контейнерам и хранящимся в них большим двоичным объектам.|Доступ на чтение и запись для указанного контейнера и его больших двоичных объектов|Доступ на чтение для указанного контейнера и его больших двоичных объектов|Доступ на чтение и запись для указанной очереди|Доступ на чтение для указанной очереди|

> [!NOTE]
> Как владельцу учетной записи хранения Azure вам автоматически не назначаются разрешения на доступ к данным. Для службы хранилища Azure вы должны назначить себе роль RBAC явным образом. Вы можете назначить ее на уровне подписки, группы ресурсов, учетной записи хранения, контейнера или очереди.

Дополнительные сведения о разрешениях, необходимых для вызова операций службы хранилища Azure, см. в разделе о [разрешениях для вызова операций REST](https://docs.microsoft.com/rest/api/storageservices/authenticate-with-azure-active-directory#permissions-for-calling-rest-operations).

В следующих разделах показано, как назначить роль, ограниченную областью учетной записи хранения или отдельного контейнера.

### <a name="assign-a-role-scoped-to-the-storage-account-in-the-azure-portal"></a>Назначение роли, ограниченной областью учетной записи хранения на портале Azure

Чтобы назначить встроенную роль, предоставляющую доступ ко всем контейнерам или очередям в учетной записи хранения на портале Azure, сделайте следующее:

1. Войдите в свою учетную запись хранения на [портале Azure](https://portal.azure.com).
1. Выберите свою учетную запись хранения, затем — **Управление доступом (IAM)**, чтобы отобразить параметры управления доступом для учетной записи. Выберите вкладку **Назначения ролей**, чтобы просмотреть список назначений ролей.

    ![Снимок экрана с параметрами управления доступом хранилища](media/storage-auth-aad-rbac/portal-access-control.png)

1. Нажмите кнопку **Добавить назначение ролей**, чтобы добавить новую роль.
1. В окне **Добавление назначения роли** выберите роль, чтобы назначить ее удостоверению Azure AD. Затем выполните поиск, чтобы найти удостоверение, которому вы хотите назначить эту роль. Например, на следующем изображении показана роль **модуля чтения данных BLOB-объектов хранилища (предварительная версия)**, назначенная пользователю.

    ![Снимок экрана с отображением того, как назначить роль RBAC](media/storage-auth-aad-rbac/add-rbac-role.png)

1. Выберите команду **Сохранить**. Удостоверение, которому назначена роль RBAC, будет отображаться в списке под этой ролью. Например, на следующем изображении показано, что у добавленного пользователя теперь есть разрешения на чтение данных всех больших двоичных объектов в учетной записи хранения.

    ![Снимок экрана с отображением списка пользователей, назначенных роли](media/storage-auth-aad-rbac/account-scoped-role.png)

### <a name="assign-a-role-scoped-to-a-container-or-queue-in-the-azure-portal"></a>Назначение роли, ограниченной областью контейнера или очереди на портале Azure

> [!IMPORTANT]
> Это невозможно сделать, если вы все еще используете учетную запись с включенным иерархическим пространством имен.

Шаги для назначения встроенной роли, ограниченной областью контейнера или очереди, схожи. В приведенной здесь процедуре назначается роль, ограниченная областью контейнера, но вы можете выполнить те же действия для назначения роли, ограниченной областью очереди: 

1. Перейдите в свою учетную запись хранения на [портале Azure](https://portal.azure.com) и откройте **Обзор** для учетной записи.
1. В разделе "Службы" выберите **BLOB-объекты**. 
1. Найдите контейнер, для которого нужно назначить роль, и откройте его параметры. 
1. Выберите **Управление доступом (IAM)**, чтобы отобразить параметры управления доступом для контейнера. Выберите вкладку **Назначения ролей**, чтобы просмотреть список назначений ролей.

    ![Снимок экрана с параметрами управления доступом к контейнерам](media/storage-auth-aad-rbac/portal-access-control-container.png)
1. Нажмите кнопку **Добавить назначение ролей**, чтобы добавить новую роль.
1. В окне **Добавление назначения роли** выберите роль, которую вы хотите назначить удостоверению Azure AD. Затем выполните поиск, чтобы найти удостоверение, которому вы хотите назначить эту роль.
1. Выберите команду **Сохранить**. Удостоверение, которому назначена роль RBAC, будет отображаться в списке под этой ролью. Например, на следующем изображении показано, что у добавленных пользователей теперь есть разрешения на чтение для данных в контейнере с именем *sample-container*.

    ![Снимок экрана с отображением списка пользователей, назначенных роли](media/storage-auth-aad-rbac/container-scoped-role.png)

## <a name="next-steps"></a>Дополнительная информация

- Дополнительные сведения см. в статье [Что такое управление доступом на основе ролей (RBAC)?](../../role-based-access-control/overview.md)
- Чтобы узнать, как назначать роли RBAC и управлять назначениями ролей с помощью Azure PowerShell, Azure CLI или REST API, см. сведения в статьях ниже:
    - [Управление доступом на основе ролей с помощью Azure PowerShell](../../role-based-access-control/role-assignments-powershell.md)
    - [Управление доступом на основе ролей с помощью интерфейса командной строки Azure](../../role-based-access-control/role-assignments-cli.md)
    - [Управление доступом на основе ролей с помощью REST API](../../role-based-access-control/role-assignments-rest.md)
- Чтобы узнать об авторизации доступа к контейнерам и очередям из приложений службы хранилища, ознакомьтесь со статьей об [аутентификации с помощью Azure Active Directory из приложения службы хранилища Azure (предварительная версия)](storage-auth-aad-app.md).
- Дополнительные сведения об интеграции Azure AD для очередей и контейнеров Azure см. в записи блога команды разработчиков службы хранилища Azure об [объявлении о выпуске предварительной версии аутентификации Azure AD для службы хранилища Azure](https://azure.microsoft.com/blog/announcing-the-preview-of-aad-authentication-for-storage/).
