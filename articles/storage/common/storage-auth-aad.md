---
title: Аутентификация доступа к BLOB-объектам и очередям Azure с помощью Azure Active Directory (предварительная версия) | Документация Майкрософт
description: Аутентификация доступа к BLOB-объектам и очередям Azure с помощью Azure Active Directory (предварительная версия).
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 02/13/2019
ms.author: tamram
ms.subservice: common
ms.openlocfilehash: dcf7d237c8cfbf52a804e428d84fff0bb328c7c8
ms.sourcegitcommit: 2d0fb4f3fc8086d61e2d8e506d5c2b930ba525a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/18/2019
ms.locfileid: "58012104"
---
# <a name="authenticate-access-to-azure-blobs-and-queues-using-azure-active-directory-preview"></a>Аутентификация доступа к BLOB-объектам и очередям Azure с помощью Azure Active Directory (предварительная версия)

Служба хранилища Azure поддерживает аутентификацию и авторизацию с помощью Azure Active Directory (AD) для служб больших двоичных объектов и очередей. С помощью Azure AD вы можете использовать управление доступом на основе ролей (RBAC) для предоставления доступа пользователям, группам или субъектам-службам приложений. 

Аутентификация пользователей или приложений с использованием учетных данных Azure AD обеспечивает превосходную защиту и простоту использования по сравнению с другими средствами авторизации. Хотя вы можете продолжать применять для приложений авторизацию с помощью общего ключа, благодаря использованию Azure AD не нужно хранить ключ доступа к учетной записи с кодом. Вы также можете продолжать использовать подписанные URL-адреса для предоставления доступа с точной настройкой к ресурсам в учетной записи хранения, но Azure AD предлагает аналогичные возможности без необходимости управлять токенами SAS или беспокоиться об отзыве скомпрометированного SAS. Корпорация Майкрософт рекомендует по возможности использовать аутентификацию Azure AD для приложений службы хранилища Azure.

[!INCLUDE [storage-auth-aad-note-include](../../../includes/storage-auth-aad-note-include.md)]

## <a name="about-the-preview"></a>Сведения о предварительной версии

Имейте в виду следующие моменты о предварительной версии:

- Интеграция с Azure AD доступна для служб BLOB-объектов и очередей только в предварительной версии.
- Интеграция с Azure AD доступна для учетных записей хранения GPv1, GPv2 и больших двоичных объектов во всех общедоступных регионах. 
- Поддерживаются только учетные записи хранения, созданные с помощью модели развертывания Resource Manager. 
- Скоро появится поддержка сведений об удостоверении вызывающего объекта в журналах решения "Аналитика Службы хранилища".
- В настоящее время поддерживается авторизация доступа Azure AD к ресурсам в стандартных учетных записях хранения. В ближайшее время будет объявлена поддержка авторизации доступа к страничным BLOB-объектам в учетных записях хранения уровня "Премиум".
- Служба хранилища Azure поддерживает встроенные и пользовательские роли RBAC. Роли можно назначать для подписки, группы ресурсов, учетной записи хранения, отдельного контейнера или очереди.
- Клиентские библиотеки службы хранилища Azure, которые в настоящее время поддерживают интеграцию с Azure AD, включают в себя:
    - [.NET](https://www.nuget.org/packages/WindowsAzure.Storage)
    - [Java](https://mvnrepository.com/artifact/com.microsoft.azure/azure-storage)
    - Python
        - [Большие двоичные объекты, очереди и файлы](https://github.com/Azure/azure-storage-python)
    - [Node.js](https://www.npmjs.com/package/azure-storage)
    - [JavaScript](https://aka.ms/downloadazurestoragejs)

## <a name="overview-of-azure-ad-for-storage"></a>Обзор Azure AD для хранилища

Первым шагом в использовании интеграции Azure AD со службой хранилища Azure является назначение ролей RBAC для данных хранилища субъекту-службы (пользователю, группе или субъекту-службе приложения) или управляемых удостоверений для ресурсов Azure. Роли RBAC охватывают общие наборы разрешений для контейнеров и очередей. Дополнительные сведения о назначении роли RBAC для службы хранилища Azure, см. в разделе [управление права доступа к данным хранилища с помощью RBAC (Предварительная версия)](storage-auth-aad-rbac.md).

Чтобы использовать Azure AD для авторизации доступа к ресурсам хранилища в приложениях, необходимо запросить токен доступа OAuth 2.0 из кода. Сведения о том, как запросить токен доступа и использовать его для авторизации запросов к службе хранилища Azure, см. в статье [Authenticate with Azure AD from an Azure Storage application (Preview)](storage-auth-aad-app.md) (Аутентификация с помощью Azure Active Directory из приложения службы хранилища Azure (предварительная версия)). Если вы используете управляемые удостоверения, см. статью [Аутентификация доступа к BLOB-объектам и очередям с помощью управляемых удостоверений Azure для ресурсов Azure (предварительная версия)](storage-auth-aad-msi.md).

Теперь Azure CLI и PowerShell поддерживают вход с использованием удостоверения Azure AD. После входа с использованием удостоверения Azure AD сеанс выполняется с этим идентификатором. Дополнительные сведения см. в статье [Использование удостоверения Azure AD для доступа к службе хранилища Azure с помощью интерфейса командной строки или PowerShell (предварительная версия)](storage-auth-aad-script.md).

## <a name="rbac-roles-for-blobs-and-queues"></a>Роли RBAC для больших двоичных объектов и очередей

Azure Active Directory (Azure AD) разрешает права доступа к защищенным ресурсам с помощью [управления доступом на основе ролей (RBAC)](../../role-based-access-control/overview.md). Служба хранилища Azure определяет набор встроенных ролей RBAC, которые охватывают общие наборы разрешений, используемые для доступа к контейнерам или очередям. 

При назначении роли RBAC для субъекта безопасности Azure AD, Azure предоставляет доступ к этим ресурсам для этого участника безопасности. Доступ может ограничиваться уровнем подписки, группой ресурсов, учетной записью хранения или отдельным контейнером или очередью. Субъект безопасности Azure AD может быть пользователь, группы, субъекта-службы приложения, или [управляемое удостоверение для ресурсов Azure](../../active-directory/managed-identities-azure-resources/overview.md). 

[!INCLUDE [storage-auth-rbac-roles-include](../../../includes/storage-auth-rbac-roles-include.md)]

Узнайте, как назначение встроенной роли на портале Azure, см. в разделе [предоставить доступ к контейнерам Azure и очереди с RBAC на портале Azure (Предварительная версия)](storage-auth-aad-rbac.md).

### <a name="access-permissions-granted-by-rbac-roles"></a>Разрешения на доступ, предоставленные роли RBAC 

В следующей таблице перечислены права доступа, предоставляемые встроенные роли для разных уровнях области:

|Область|Владелец данных больших двоичных объектов|Участник данных BLOB-объектов|Модуль чтения данных BLOB-объектов|Участник данных очереди|Модуль чтения данных очереди|
|---|---|---|---|---|---|
|Уровень подписки|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в подписке|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в подписке| Доступ на чтение для всех контейнеров и больших двоичных объектов в подписке|Доступ на чтение и запись для всех очередей в подписке|Доступ на чтение для всех очередей в подписке|
|Уровень группы ресурсов|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в группе ресурсов|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в группе ресурсов|Доступ на чтение для всех контейнеров и больших двоичных объектов в группе ресурсов|Доступ на чтение и запись для всех очередей в группе ресурсов|Доступ на чтение для всех очередей в группе ресурсов|
|Уровень учетной записи хранения|Доступ на чтение и запись и управление доступом POSIX ко всем контейнерам и большим двоичным объектам в учетной записи хранения|Доступ на чтение и запись для всех контейнеров и больших двоичных объектов в учетной записи хранения|Доступ на чтение для всех контейнеров и больших двоичных объектов в учетной записи хранения|Доступ на чтение и запись для всех очередей в учетной записи хранения|Доступ на чтение для всех очередей в учетной записи хранения|
|Уровень контейнера или очереди|Доступ на чтение и запись и управление доступом POSIX к указанным контейнерам и хранящимся в них большим двоичным объектам.|Доступ на чтение и запись для указанного контейнера и его больших двоичных объектов|Доступ на чтение для указанного контейнера и его больших двоичных объектов|Доступ на чтение и запись для указанной очереди|Доступ на чтение для указанной очереди|

Дополнительные сведения о разрешениях, необходимых для вызова операций службы хранилища Azure, см. в разделе о [разрешениях для вызова операций REST](https://docs.microsoft.com/rest/api/storageservices/authenticate-with-azure-active-directory#permissions-for-calling-rest-operations).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об интеграции Azure AD для очередей и больших двоичных объектов Azure доступны в записи блога команды разработчиков службы хранилища Azure [Announcing the Preview of Azure AD Authentication for Azure Storage](https://azure.microsoft.com/blog/announcing-the-preview-of-aad-authentication-for-storage/) (Объявление о выпуске предварительной версии аутентификации Azure AD для службы хранилища Azure).
