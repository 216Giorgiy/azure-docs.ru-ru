---
title: Создание высокодоступных приложений службы хранилища Azure в хранилище, избыточном в пределах зоны (ZRS) | Документация Майкрософт
description: Хранилище, избыточное в пределах зоны (ZRS), предлагает простой способ по созданию высокодоступных приложений. ZRS обеспечивает защиту от сбоев оборудования в центре обработки данных, а также защиту от некоторых региональных сбоев.
services: storage
author: tolandmike
ms.service: storage
ms.topic: article
ms.date: 03/20/2018
ms.author: jeking
ms.component: common
ms.openlocfilehash: 0a4ebefd89414fa62ca69f2f9cc726f471694bee
ms.sourcegitcommit: 1b561b77aa080416b094b6f41fce5b6a4721e7d5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/17/2018
ms.locfileid: "45733622"
---
# <a name="zone-redundant-storage-zrs-highly-available-azure-storage-applications"></a>Хранилище, избыточное в пределах зоны (ZRS). Высокодоступные приложения для службы хранилища Azure
[!INCLUDE [storage-common-redundancy-ZRS](../../../includes/storage-common-redundancy-zrs.md)]

## <a name="support-coverage-and-regional-availability"></a>Доступность в регионах и действие поддержки
ZRS в настоящее время поддерживает типы учетных записей общего назначения версии 2. Дополнительные сведения о типах учетных записей хранения см. в статье [Общие сведения об учетных записях хранения Azure](storage-account-overview.md).

ZRS доступно для блочных BLOB-объектов, бездисковых страничных BLOB-объектов, файлов, таблиц и очередей.

ZRS общедоступно в следующих регионах:

- Восточная часть США
- Восточная часть США 2
- Западная часть США 2
- Центральная часть США
- Северная Европа
- Западная Европа
- Центральная Франция
- Юго-Восточная Азия

Корпорация Майкрософт продолжает запускать ZRS в других регионах Azure. Регулярно проверяйте страницу [обновлений служб Azure](https://azure.microsoft.com/updates/) для получения информации о новых регионах.

## <a name="what-happens-when-a-zone-becomes-unavailable"></a>Что будет, если зона отключена?
Если зона становится недоступной, хранилище данных остается отказоустойчивым. Корпорация Майкрософт предлагает следовать рекомендациям по обработке временных сбоев, таким как реализация политик повтора с экспоненциальной задержкой. Если зона отключена, Azure выполняет обновления сети, например перенаправление DNS. Доступ к данным до завершения процесса обновления может повлиять на ваше приложение.

ZRS не может защитить данные от региональной аварии, где постоянно затрагиваются несколько зон. Вместо этого хранилище ZRS обеспечивает устойчивость для данных, если оно становится временно недоступным. Для защиты от региональных аварий мы советуем использовать геоизбыточное хранилище (GRS). Дополнительные сведения о GRS см. в статье [Геоизбыточное хранилище (GRS). Межрегиональная репликация для службы хранилища Azure](storage-redundancy-grs.md).

## <a name="converting-to-zrs-replication"></a>Преобразование в репликацию ZRS
В настоящее время для изменения типа избыточности учетной записи можно использовать портал Azure или API поставщика ресурсов хранилища, если вы выполняете перенос из LRS, GRS и RA-GRS или в них. Однако с ZRS миграция выполняется не так просто, потому что происходит перемещение физических данных из одной отметки хранилища в несколько меток в пределах региона. 

У вас есть два основных варианта для перемещения данных в хранилище ZRS или из него. Можно вручную скопировать или переместить данные в новую учетную запись ZRS из существующей. Можно также запросить динамическую миграцию. Корпорация Майкрософт настоятельно рекомендует выполнить миграцию вручную, так как нет никакой гарантии относительно времени завершения динамической миграции. Маршрут миграции вручную предоставляет большую гибкость, чем динамическая миграция, и вы контролируете время миграции.

Чтобы выполнить миграцию вручную, у вас есть различные варианты:
- Используйте такие существующие средства, как AzCopy, пакет SDK для службы хранилища, надежные сторонние инструменты и т. д.
- Если вы знакомы с Hadoop или HDInsight, вы можете подключить учетную запись источника и назначения (ZRS) к вашему кластеру и использовать средство, похожее на DistCp, для выполнения массового параллельного процесса копирования данных.
- Создайте собственный инструмент, используя одну версию пакета SDK для службы хранилища.

Однако если миграция вручную приведет к простою приложения и вы не сможете справиться с этим на вашей стороне, мы предоставляем такой вариант, как динамическая миграции. Динамическая миграция — миграция на месте, которая позволяет продолжить использование существующей учетной записи хранения во время переноса данных между отметками исходного и целевого хранилищ. Во время миграции у вас по-прежнему будет тот же уровень устойчивости и заявленная в Соглашении об уровне обслуживания доступность, что и обычно.

Тем не менее динамическая миграция имеет некоторые ограничения. Они перечислены ниже.

- Хотя корпорация Майкрософт незамедлительно отреагирует на запрос динамической миграции, нет никакой гарантии относительно времени его завершения. Если данные должны быть в ZRS к определенному времени, тогда необходимо выполнить миграцию вручную. Как правило, чем больше данных в вашей учетной записи, тем дольше будет выполняться их перенос. 
- Динамическую миграцию можно выполнять только из учетной записи, использующей репликацию LRS или GRS. Если учетная запись использует RA-GRS, то прежде чем продолжить, необходимо сначала перейти на один из этих типов репликации. Этот промежуточный шаг гарантирует, что вторичная конечная точка с доступом на чтение, предоставляемая RA-GRS, будет удалена перед миграцией.
- Учетная запись должна содержать данные.
- Поддерживаются только миграции внутри региона. Если вы хотите перенести данные в учетную запись ZRS, которая находится в регионе, отличном от учетной записи источника, тогда нужно выполнить миграцию вручную.
- Поддерживаются только типы учетных записей хранилища класса Standard. Невозможно перенести учетную запись хранения класса Premium.

Запросы динамической миграции поступают через портал поддержки Azure. На портале выберите учетную запись хранения, которую вы хотите преобразовать в ZRS.
1. Щелкните **Новый запрос на поддержку**.
2. Проверьте основные сведения. Щелкните **Далее**. 
3. В разделе **Проблема**: 
    - Оставьте уровень серьезности как есть.
    - Укажите тип проблемы **Миграция данных**.
    - Укажите категорию **Миграция в ZRS в пределах региона**.
    - Введите заголовок **Миграция учетной записи ZRS** (или что-то описательное).
    - В поле сведений укажите "Хочу перенести данные в ZRS из [LRS, GRS] в регионе ______". 
4. Щелкните **Далее**.
5. Проверьте правильность контактных данных в колонке "Контактные сведения".
6. Нажмите кнопку **Submit**(Отправить).

С вами свяжется специалист службы поддержки. Он окажет любую помощь, которая вам потребуется. 

## <a name="zrs-classic-a-legacy-option-for-block-blobs-redundancy"></a>Классическое хранилище ZRS. Устаревший вариант для обеспечения избыточности блочных BLOB-объектов.
> [!NOTE]
> Корпорация Майкрософт объявит нерекомендуемыми и перенесет классические учетные записи ZRS 31 марта 2021. Перед прекращением поддержки клиентам классического хранилища ZRS будут предоставлены дополнительные сведения. 
>
> Когда хранилище ZRS станет [общедоступным](#support-coverage-and-regional-availability) в регионе, клиенты больше не смогут создавать классическую учетную запись ZRS на портале в этом же регионе. Использование Microsoft PowerShell и Azure CLI для создания классических учетных записей ZRS поддерживается, пока классическое хранилище ZRS не будет объявлено нерекомендуемым.

В классическом хранилище ZRS данные асинхронно реплицируются в центрах обработки данных в пределах одного или двух регионов. Реплика будет недоступна, если корпорация Майкрософт не инициирует отработку отказа в дополнительном регионе. Классическую учетную запись ZRS невозможно преобразовать в учетную запись хранилища LRS или GRS и наоборот. Кроме того, она не поддерживает использование метрик или ведение журналов.

Классическое хранилище ZRS доступно только для **блочных BLOB-объектов** в учетных записях хранения общего назначения версии 1 (GPv1). Дополнительные сведения об учетных записях хранения см. в статье [Общие сведения об учетной записи хранения Azure](storage-account-overview.md).

Классическую учетную запись ZRS невозможно преобразовать в учетную запись хранилища LRS, GRS или RA-GRS и наоборот. Кроме того, она не поддерживает использование метрик или ведение журналов.

Чтобы вручную перенести данные учетной записи ZRS в или из учетной записи LRS, классического хранилища ZRS, GRS или RA-GRS, используйте AzCopy, Обозреватель службы хранилища Azure, Azure PowerShell или Azure CLI. Можно также создавать собственные решения для миграции с использованием одной из клиентских библиотек службы хранилища Azure.

## <a name="see-also"></a>См. также
- [Репликация службы хранилища Azure](storage-redundancy.md)
- [Локально избыточное хранилище (LRS). Недорогая избыточность данных для службы хранилища Azure](storage-redundancy-lrs.md)
- [Геоизбыточное хранилище (GRS). Межрегиональная репликация для службы хранилища Azure](storage-redundancy-grs.md)