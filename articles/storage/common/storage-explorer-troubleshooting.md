---
title: Руководство по устранению неполадок в обозревателе хранилищ Azure | Документы Майкрософт
description: Обзор двух функций отладки Azure
services: virtual-machines
author: Deland-Han
ms.service: virtual-machines
ms.topic: troubleshooting
ms.date: 06/15/2018
ms.author: delhan
ms.subservice: common
ms.openlocfilehash: c192b3e995cacd3085f343d1f6b2c243f1531acc
ms.sourcegitcommit: 79038221c1d2172c0677e25a1e479e04f470c567
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2019
ms.locfileid: "56415516"
---
# <a name="azure-storage-explorer-troubleshooting-guide"></a>Руководство по устранению неполадок в обозревателе хранилищ Azure

Обозреватель службы хранилища Microsoft Azure — это автономное приложение, которое упрощает работу с данными из службы хранилища Azure на платформе Windows, macOS и Linux. Приложение может подключаться к учетным записям хранения, размещенным в Azure, National Clouds и Azure Stack.

В этом руководстве приведены решения для распространенных проблем, возникающих с обозревателем хранилищ.

## <a name="error-self-signed-certificate-in-certificate-chain-and-similar-errors"></a>Ошибка: "Самозаверяющий сертификат в цепочке сертификатов" (и подобные ей ошибки)

Ошибки сертификата вызваны одной из двух следующих ситуаций:

1. Приложение подключается с помощью "прозрачного прокси-сервера". Это означает, что сервер (например, сервер вашей компании) перехватывает трафик HTTPS, расшифровывает его, а затем шифрует с помощью самозаверяющего сертификата.
2. Работающее приложение внедряет самозаверяющий сертификат SSL в получаемые сообщения HTTPS. К примерам приложений, которые внедряют сертификаты, относятся антивирусные программы и программное обеспечение для проверки трафика.

Когда Обозреватель службы хранилища обнаруживает самозаверяющий или недоверенный сертификат, он уже не может определить, было ли изменено принятое сообщение HTTPS. Если у вас есть копия самозаверяющего сертификата, вы можете настроить доверие к нему в Обозревателе службы хранилища, выполнив следующее.

1. Получите копию сертификата X.509 (.cer) в кодировке Base-64.
2. Щелкните **Изменить** > **SSL-сертификаты** > **Импорт сертификатов**, а затем с помощью средства выбора файлов найдите, выберите и откройте CER-файл.

Эта проблема также может быть результатом наличия нескольких сертификатов (корневого и промежуточного). Для устранения ошибки необходимо добавить оба сертификата.

Если вы не уверены в том, откуда получен сертификат, вы можете попробовать выполнить следующие действия:

1. Установите Open SSL.

    * [Windows](https://slproweb.com/products/Win32OpenSSL.html) (любой из облегченных версий должно быть достаточно)
    * MAC и Linux: этот компонент должен быть включен в операционную систему
2. Запустите Open SSL.

    * Windows: откройте каталог установки, щелкните **/bin/**, а затем дважды щелкните **openssl.exe**.
    * MAC и Linux: запустите **openssl** из терминала.
3. Выполните команду `s_client -showcerts -connect microsoft.com:443`.
4. Найдите самозаверяющие сертификаты. Если вы не знаете, какие из сертификатов являются самозаверяющими, найдите сертификаты, в которых субъект `("s:")` и издатель `("i:")` совпадают.
5. Когда вы найдете самозаверяющие сертификаты, для каждого из них скопируйте и вставьте все содержимое от **---BEGIN CERTIFICATE---** до **---END CERTIFICATE---** включительно в новый CER-файл.
6. Откройте обозреватель хранилищ, щелкните **Изменить** > **SSL-сертификаты** > **Импорт сертификатов**, а затем с помощью средства выбора файлов найдите, выберите и откройте созданные CER-файлы.

Если вам не удалось найти самозаверяющие сертификаты, используя приведенные выше инструкции, свяжитесь с нами при помощи средства обратной связи, чтобы получить дополнительные сведения. Кроме того, вы можете запустить Обозреватель службы хранилища из командной строки с флагом `--ignore-certificate-errors`. При запуске с этим флагом Обозреватель службы хранилища будет игнорировать ошибки сертификата.

## <a name="sign-in-issues"></a>Проблемы при входе

### <a name="blank-sign-in-dialog"></a>Пустое диалоговое окно входа
Пустое диалоговое окно входа чаще всего вызвано запросами ADFS к Обозревателю службы хранилища на выполнение перенаправления, которое не поддерживается Electron. Чтобы решить эту проблему вы можете попытаться использовать для входа поток кода устройства. Для этого выполните следующие действия:
1. "Go to Experimental" (Перейти к экспериментальному) -> "Use Device Code Sign-In" (Использовать вход с помощью кода устройств).
2. Откройте диалоговое окно "Подключить" (либо с помощью значка подключения в левом вертикальном меню, либо используя "Добавить учетную запись" на панели учетной записи).
3. Выберите, в какую среду вы желаете войти.
4. Нажмите кнопку "Войти".
5. Следуйте инструкциям на следующей панели.

Примечание: эта функция сейчас доступна только в предварительной версии 1.7.0.

Если у вас возникнут трудности с входом в учетную запись, которую вы хотите использовать, так как ваш браузер по умолчанию уже осуществил вход в другую учетную запись, вы можете:
1. Вручную скопировать ссылку и код в закрытом режиме вашего браузера.
2. Вручную скопировать ссылку и код в другой браузер.

### <a name="reauthentication-loop-or-upn-change"></a>Цикл повторной аутентификации или изменение имени участника-пользователя
Если вы находитесь в цикле повторной аутентификации или изменили имя участника-пользователя одной из своих учетных записей, попробуйте выполнить следующее:
1. Удалите все учетные записи, а затем закройте Обозреватель службы хранилища.
2. Удалите папку .IdentityService с компьютера. В Windows папка находится в расположении `C:\users\<username>\AppData\Local`. Для Mac и Linux вы можете найти папку в корневой папке каталога пользователя.
3. Если вы используете Mac или Linux, вам также потребуется удалить запись Microsoft.Developer.IdentityService из хранилища ключей вашей ОС. В Mac хранилище ключей — это приложение Gnome Keychain. Для Linux приложение обычно называется Keyring, но имя может отличаться в зависимости от вашего дистрибутива.

### <a name="conditional-access"></a>условный доступ;
Когда обозреватель службы хранилища используется в ОС Windows 10, Linux или macOS, то условный доступ не поддерживается. Это происходит из-за ограничения в библиотеке AAD, используемой обозревателем службы хранилища.

## <a name="mac-keychain-errors"></a>Ошибки цепочки ключей Mac
Иногда цепочка ключей MacOS может перейти в состояние, которое вызывает проблемы с библиотекой аутентификации Обозревателя службы хранилища. Чтобы вывести цепочку ключей из этого состояния, попробуйте выполнить следующие действия.
1. Закройте Обозреватель службы хранилища.
2. Откройте цепочку (нажмите клавиши **CMD+ПРОБЕЛ**, введите цепочку ключей и нажмите клавишу "ВВОД").
3. Выберите цепочку ключей login.
4. Щелкните значок замка, чтобы заблокировать цепочку ключей (по завершении замок на значке закроется, на что может потребоваться несколько секунд в зависимости от открытых приложений).

    ![изображение](./media/storage-explorer-troubleshooting/unlockingkeychain.png)

5. Запустите Обозреватель службы хранилища.
6. Откроется всплывающее окно с сообщением примерно такого содержания: "Центр обслуживания хочет получить доступ к цепочке ключей". Когда оно откроется, введите пароль учетной записи администратора Mac и щелкните **Всегда разрешать** (или **Разрешить**, если **Всегда разрешать** недоступно).
7. Попробуйте выполнить вход.

### <a name="general-sign-in-troubleshooting-steps"></a>Общие действия по устранению неполадок входа
* Если вы используете macOS и окно входа не появляется поверх диалогового окна "Waiting for authentication…" (Ожидание аутентификации…), то выполните [эти действия](#mac-keychain-errors).
* Перезапуск Обозревателя службы хранилища
* Если диалоговое окно проверки подлинности пустое, подождите не менее одной минуты, прежде чем его закрыть.
* Убедитесь, что параметры прокси-сервера и сертификата правильно настроены как для вашего компьютера, так и для Обозревателя службы хранилища.
* Если вы работаете в Windows и имеете доступ к Visual Studio 2017 на том же компьютере, при авторизации попробуйте войти в Visual Studio 2017. После успешного входа в Visual Studio 2017 вы сможете открыть обозреватель хранилища и просмотреть свою учетную запись на панели учетных записей.

Если ни один из этих методов не работает, [начните обсуждение проблемы на сайте GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues).

### <a name="missing-subscriptions-and-broken-tenants"></a>Отсутствие подписки и неисправные клиенты

Если не удается получить подписки после успешного входа, выполните следующие методы для устранения этой проблемы.

* Убедитесь, что учетная запись имеет доступ к необходимым подпискам. Проверьте, что у вас есть доступ, войдя на портале для среды Azure, которую вы пытаетесь использовать.
* Убедитесь, что вы выполнили вход в правильную среду Azure (Azure, Azure для Китая через 21Vianet, Azure для Германии, Azure для государственных организаций США или пользовательскую среду).
* При подключении через прокси-сервер убедитесь, что прокси-сервер обозревателя хранилищ настроен правильно.
* Попробуйте удалить и снова добавить учетную запись.
* Если имеется ссылка "Дополнительные сведения", просмотрите, какие сообщения об ошибках появляются для неисправных клиентов. Если вы не знаете, что делать с сообщениями об ошибках, отправьте [проблему в репозиторий GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues).

## <a name="cannot-remove-attached-account-or-storage-resource"></a>Не удается удалить подключенную учетную запись или ресурс хранилища

Если вы не можете удалить подключенную учетную запись или ресурс хранилища через пользовательский интерфейс, вы можете вручную удалить все подключенные ресурсы, удалив следующие папки:

* Windows: `%AppData%/StorageExplorer`
* macOS: `/Users/<your_name>/Library/Application Support/StorageExplorer`
* Linux: `~/.config/StorageExplorer`

> [!NOTE]
>  Перед удалением вышеуказанных папок закройте Обозреватель службы хранилища.

> [!NOTE]
>  Если вы когда-либо импортировали SSL-сертификаты, то создайте резервную копию содержимого каталога `certs`. Позже вы сможете использовать резервную копию, чтобы повторно импортировать сертификаты SSL.

## <a name="proxy-issues"></a>Проблемы с прокси-сервером

Во-первых, убедитесь, что вы правильно указали следующие сведения:

* URL-адрес прокси-сервера и номер порта;
* имя пользователя и пароль, если этого требует прокси-сервер.

Обратите внимание, что Обозреватель службы хранилища Azure не поддерживает файлы автонастройки прокси-сервера для настройки параметров прокси-сервера.

### <a name="common-solutions"></a>Распространенные решения

Если у вас по-прежнему возникают проблемы, попробуйте следующие методы устранения неполадок:

* Если можно подключиться к Интернету без использования прокси-сервера, проверьте, будет ли обозреватель хранилищ работать с отключенными параметрами прокси-сервера. Если это так, возможно, проблема связана с параметрами прокси-сервера. Обратитесь к администратору прокси-сервера, чтобы определить проблему.
* Убедитесь, что другие приложения, использующие прокси-сервер, работают корректно.
* Убедитесь, что вы можете подключиться к порталу для среды Azure, которую вы пытаетесь использовать.
* Убедитесь, что вы можете получать ответы от конечных точек службы. Введите один из URL-адресов конечной точки в браузере. Если вам удается подключиться, вы должны получить ответ InvalidQueryParameterValue или аналогичный XML-ответ.
* Если другие пользователи также используют обозреватель хранилищ с вашим прокси-сервером, проверьте, могут ли они подключаться. Если у них не возникает проблем с подключением, возможно, вам потребуется обратиться к администратору прокси-сервера.

### <a name="tools-for-diagnosing-issues"></a>Инструменты для выявления проблем

Если вы используете средства работы с сетью, такие как Fiddler для Windows, можно попробовать диагностировать проблемы следующим образом.

* Если вам необходимо подключаться через прокси-сервер, может потребоваться настроить сетевые средства для подключения через прокси-сервер.
* Проверьте номер порта, используемый средством для работы с сетью.
* Введите URL-адрес локального узла и номер порта сетевого средства как параметры прокси-сервера в обозревателе хранилищ. Если выполнить эту процедуру правильно, средство для работы с сетью начнет регистрировать сетевые запросы, отправляемые Обозревателем службы хранилища в конечные точки управления и служб. Например, введите адрес https://cawablobgrs.blob.core.windows.net/ для конечной точки хранилища BLOB-объектов в браузере и вы получите примерно следующий ответ, который предполагает, что ресурс существует, несмотря на то, что к нему нет доступа.

![пример кода](./media/storage-explorer-troubleshooting/4022502_en_2.png)

### <a name="contact-proxy-server-admin"></a>Обратитесь к администратору прокси-сервера

Если параметры прокси-сервера настроены правильно, обратитесь к администратору прокси-сервера и

* убедитесь, что прокси-сервер не блокирует трафик к конечным точкам управления или ресурсов Azure.
* Проверьте протокол аутентификации, используемый прокси-сервером. Обозреватель хранилищ пока не поддерживает прокси-серверы NTLM.

## <a name="unable-to-retrieve-children-error-message"></a>Сообщение об ошибке "Не удается получить дочерние элементы"

Если вы подключаетесь к Azure через прокси-сервер, убедитесь, что его параметры настроены правильно. Если доступ к ресурсу предоставлен вам владельцем подписки или учетной записи, убедитесь, что у вас есть разрешения на чтение или перечисление для этого ресурса.

## <a name="connection-string-does-not-have-complete-configuration-settings"></a>Строка подключения не содержит всех параметров конфигурации

Появление этого сообщения об ошибке может означать, что вы не обладаете достаточными правами для получения ключей учетной записи хранения. Чтобы в этом убедится, перейдите на портал и найдите учетную запись хранения. Чтобы сделать это быстро, щелкните правой кнопкой мыши узел учетной записи хранения, а затем — "Открыть на портале". После этого перейдите к колонке "Ключи доступа". Если у вас нет разрешения на просмотр ключей, появится страница "Отсутствуют права доступа". Чтобы обойти эту проблему, можно получить ключ учетной записи от кого-нибудь еще и использовать подключение с именем и ключом, либо можно попросить SAS для учетной записи хранения и использовать его для ее присоединения.

Если вы видите ключи учетной записи, сообщите о проблеме в GitHub, чтобы получить помощь в решении проблемы.

## <a name="issues-with-sas-url"></a>Проблемы с URL-адресом SAS
Если вы подключаетесь к службе с помощью URL-адреса SAS и возникает эта ошибка:

* убедитесь, что URL-адрес предоставляет необходимые разрешения на чтение или перечисление ресурсов.
* Убедитесь, что срок действия URL-адреса не истек.
* Если URL-адрес основан на политике доступа, убедитесь, что политика доступа не была отозвана.

Если вы случайно подключились с помощью недопустимого URL-адреса SAS и отключиться не удается, выполните следующие действия:
1.  Если запущен обозреватель хранилища, нажмите клавишу F12, чтобы открыть окно средств для разработчиков.
2.  Щелкните вкладку "Приложение" и выберите "Локальное хранилище > file://" в дереве слева.
3.  Найти ключ, связанный с типом службы для проблемного URI SAS. Например, если неверный URI SAS относится к контейнеру больших двоичных объектов, найдите ключ с именем `StorageExplorer_AddStorageServiceSAS_v1_blob`.
4.  Значение ключа должно быть массивом JSON. Найдите объект, связанный с неправильным URI, и удалите его.
5.  Нажмите клавиши CTRL+R, чтобы перезагрузить обозреватель хранилища.

## <a name="linux-dependencies"></a>Зависимости Linux

В дистрибутивах Linux, отличных от Ubuntu 16.04, возможно, понадобится вручную установить некоторые зависимости. Как правило, требуются следующие пакеты:
* [.NET Core 2.x](https://docs.microsoft.com/dotnet/core/linux-prerequisites?tabs=netcore2x).
* `libsecret`
* `libgconf-2-4`
* актуальная версия GCC.

В зависимости от дистрибутива, возможно, потребуется установить дополнительные пакеты. В [примечаниях к выпуску](https://go.microsoft.com/fwlink/?LinkId=838275&clcid=0x409) для обозревателя службы хранилища содержатся конкретные инструкции для некоторых дистрибутивов.

## <a name="next-steps"></a>Дополнительная информация

Если ни одно из решений не работает, [начните обсуждение проблемы на сайте GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues). Вы также можете быстро перейти на сайт GitHub с помощью кнопки "Report issue to GitHub" (Сообщить о проблеме на GitHub) в нижнем левом углу.

![Отзыв](./media/storage-explorer-troubleshooting/feedback-button.PNG)
