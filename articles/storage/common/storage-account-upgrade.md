---
title: Обновление до учетной записи хранения общего назначения версии 2 — служба хранилища Azure | Документация Майкрософт
description: Сведения об обновлении до учетной записи хранения общего назначения версии 2.
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 09/11/2018
ms.author: tamram
ms.openlocfilehash: 6e77c4836531a7efd0b52b9a411ac40ff6a613fa
ms.sourcegitcommit: ad08b2db50d63c8f550575d2e7bb9a0852efb12f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/26/2018
ms.locfileid: "47224500"
---
# <a name="upgrade-to-a-general-purpose-v2-storage-account"></a>Обновление до учетной записи хранения общего назначения версии 2

Учетные записи хранения общего назначения версии 2 поддерживают последние возможности службы хранилища Azure и содержат все функции учетных записей общего назначения версии 1 и учетных записей хранилища BLOB-объектов. В большинстве сценариев хранения рекомендуется использовать учетные записи общего назначения версии 2. Учетные записи общего назначения версии 2 отличаются наименьшей ориентировочной платой за каждый гигабайт для службы хранилища Azure, а также конкурентоспособными в отрасли ценами на транзакции.

Процесс обновления до учетной записи хранения общего назначения версии 2 с версии 1 или учетных записей хранилища BLOB-объектов является достаточно простым. Обновление можно выполнить через портал Azure, PowerShell или Azure CLI. Обновление учетной записи нельзя отменять, и оно может привести к дополнительным расходам.

## <a name="upgrade-using-the-azure-portal"></a>Обновление с помощью портала Azure

1. Войдите на [портале Azure](https://portal.azure.com).
2. Войдите в свою учетную запись хранения.
3. В разделе **Параметры** щелкните **Конфигурация**.
4. В разделе **Тип учетной записи** щелкните **Обновить**.
5. В разделе **Подтвердить обновление** введите имя учетной записи. 
6. Щелкните **Обновить** в нижней части колонки.

## <a name="upgrade-with-powershell"></a>Обновление с помощью PowerShell

Для обновления учетной записи общего назначения версии 1 до учетной записи версии 2 с помощью PowerShell сначала обновите PowerShell, чтобы использовать последнюю версию модуля **AzureRm.Storage**. Дополнительные сведения об установке PowerShell см. [здесь](https://docs.microsoft.com/powershell/azure/install-azurerm-ps). 

Затем, чтобы обновить учетную запись, выполните следующую команду, заменив имя вашей группы ресурсов и учетной записи хранения:

```powershell
Set-AzureRmStorageAccount -ResourceGroupName <resource-group> -AccountName <storage-account> -UpgradeToStorageV2
```

## <a name="upgrade-with-azure-cli"></a>Обновление с помощью Azure CLI

Чтобы обновить учетную запись общего назначения версии 1 до версии 2 с помощью Azure CLI, сначала установите последнюю версию Azure CLI. Сведения об установке Azure CLI см. [здесь](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest). 

Затем, чтобы обновить учетную запись, выполните следующую команду, заменив имя вашей группы ресурсов и учетной записи хранения:

```cli
az storage account update -g <resource-group> -n <storage-account> --set kind=StorageV2
``` 

## <a name="specify-an-access-tier-for-blob-data"></a>Указание уровня доступа для данных больших двоичных объектов

Учетные записи общего назначения версии 2 поддерживают все службы хранилища Azure и объекты данных, но уровни доступа предусмотрены только для блочных BLOB-объектов в хранилище BLOB-объектов. При обновлении до учетной записи хранения общего назначения версии 2 можно указать уровень доступа для данных больших двоичных объектов. 

Уровни доступа позволяют выбрать наиболее экономичное хранилище на основе ожидаемых схем использования. Блочные BLOB-объекты можно хранить на горячем, холодном и архивном уровнях. Дополнительные сведения об уровнях доступности см. в статье [Хранилище BLOB-объектов Azure: горячий, холодный и архивный уровни](../blobs/storage-blob-storage-tiers.md).

По умолчанию учетная запись хранения создается на горячем уровне доступа, а учетная запись хранения общего назначения версии 1 обновляется до горячего уровня хранилища. Чтобы определить, какой уровень доступа нужно использовать для данных после обновления, изучите свой сценарий. Существует два типичных пользовательских сценария для перехода на учетную запись общего назначения версии 2.

* У вас есть учетная запись хранения общего назначения версии 1 и вы хотите оценить последствия перехода на учетную запись хранения общего назначения версии 2 с соответствующим уровнем хранилища для данных больших двоичных объектов.
* Вы решили использовать или уже используете учетную запись хранения общего назначения версии 2. Теперь вы хотите выяснить, какой уровень хранилища использовать — "горячий" или "холодный" для данных больших двоичных объектов.

В обоих случаях сначала стоит оценить затраты на хранение данных, доступ и работу с хранимыми данными в учетной записи хранения общего назначения версии 2, а затем сравнить эти затраты с текущими.

### <a name="estimate-costs-for-your-current-usage-patterns"></a>Оценка затрат текущих схем использования

Чтобы оценить затраты на хранение данных больших двоичных объектов и доступ к ним в учетной записи хранения общего назначения версии 2 на определенном уровне, необходимо оценить имеющуюся схему использования или приблизительно определить будущую. В общем, необходимо выяснить следующее:

* Использование хранилища BLOB-объектов (в гигабайтах), включая:
    - Какой объем данных хранится в учетной записи хранения?
    - Как изменяется объем данных ежемесячно? Постоянно ли новые данные заменяют старые данные?
* Схема первичного доступа к данным хранилища BLOB-объектов, включая:
    - Какой объем данных считывается и записывается в учетную запись хранения? 
    - Сколько операций чтения и записи выполняется над данными в учетной записи хранения?

Чтобы выбрать наилучший уровень доступа в соответствии с потребностями, может быть полезно определить, сколько емкости занимают данные больших двоичных объектов и как они используются. 

Чтобы собрать данные об использовании для учетной записи хранения перед миграцией, можно выполнить мониторинг учетной записи хранения с помощью [Azure Monitor](../../monitoring-and-diagnostics/monitoring-overview-azure-monitor.md). Azure Monitor выполняет ведение журналов и предоставляет данные метрик для служб Azure, включая службу хранилища Azure. 

Чтобы отслеживать данные о потреблении больших двоичных объектов в учетной записи хранения, включите метрики емкости в Azure Monitor. Метрики емкости записывают данные о потребляемом объеме хранилища большими двоичными объектами в учетной записи на ежедневной основе. Метрики емкости можно использовать для оценки затрат на хранение данных в учетной записи хранения. Чтобы узнать, как выставляются счета за емкость хранилища BLOB-объектов для каждого типа учетной записи, перейдите в раздел [Цены на хранение блочных BLOB-объектов](https://azure.microsoft.com/pricing/details/storage/blobs/).

Чтобы отслеживать схемы доступа к данным для хранилища BLOB-объектов, включите метрики транзакций в Azure Monitor. Вы можете выполнять фильтрацию по различным операциям службы хранилища Azure, чтобы определить частоту вызова каждой операции. Чтобы узнать, как выставляются счета за разные типы транзакций для блочных и добавочных BLOB-объектов каждого типа учетной записи, перейдите в раздел [Цены на хранение блочных BLOB-объектов](https://azure.microsoft.com/pricing/details/storage/blobs/).  

Дополнительные сведения о сборе метрик из Azure Monitor см. в разделе [Метрики службы хранилища Azure в Azure Monitor](storage-metrics-in-azure-monitor.md).

## <a name="next-steps"></a>Дополнительная информация

- [создать учетную запись хранения;](storage-quickstart-create-account.md)
- [Управление учетными записями хранения Azure](storage-account-manage.md)