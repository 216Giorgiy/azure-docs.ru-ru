---
title: Автоматизация установки исправлений ОС и платформы с помощью службы "Сборка Реестра контейнеров Azure" ("Сборка ACR")
description: Общие сведения о службе "Сборка ACR" — наборе компонентов в Реестре контейнеров Azure, предоставляющем безопасную, автоматическую сборку образов контейнеров и применение исправлений в облаке.
services: container-registry
author: mmacy
manager: jeconnoc
ms.service: container-registry
ms.topic: article
ms.date: 05/01/2018
ms.author: marsma
ms.openlocfilehash: 3ef91270bceb5865bdbdf9c436e4519595a3dc09
ms.sourcegitcommit: d28bba5fd49049ec7492e88f2519d7f42184e3a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2018
---
# <a name="automate-os-and-framework-patching-with-acr-build"></a>Автоматизация установки исправлений ОС и платформы с помощью решения "Сборка ACR"

Контейнеры предоставляют новые уровни виртуализации, изолируя зависимости приложения и разработчиков от требований в отношении инфраструктуры и эксплуатации. Но остается необходимым найти способ применения исправлений виртуализации этого приложения.

**Сборка ACR**, набор компонентов в Реестре контейнеров Azure, обеспечивает не только возможность сборки собственного образа контейнера, но также автоматизирует [исправления ОС и платформы](#automate-os-and-framework-patching) для ваших контейнеров Docker.

[!INCLUDE [container-registry-build-preview-note](../../includes/container-registry-build-preview-note.md)]

## <a name="what-is-acr-build"></a>Что такое "Сборка ACR"?

"Сборка Реестра контейнеров Azure" — это служба сборок образов контейнеров Azure. Служба "Сборка ACR" обеспечивает разработку внутреннего цикла в облаке с помощью сборок образов контейнеров по требованию и автоматизированных сборок при фиксации исходного кода и обновлении базового образа.

Активация образов контейнеров происходит автоматически при фиксации кода в репозитории Git или при обновлении базового образа контейнера. С помощью триггеров, которые срабатывают при обновлении базового образа, можно автоматизировать рабочий процесс внесения исправлений ОС и платформы приложения, поддерживая безопасность в средах в соответствии с правилами неизменяемых контейнеров.

## <a name="quick-build-inner-loop-extended-to-the-cloud"></a>Быстрая сборка: внутренний цикл, расширенный в облако

Управление жизненным циклом начинается перед тем, как разработчики зафиксируют свои первые строки кода. Функция [Быстрая сборка](container-registry-tutorial-quick-build.md) службы "Сборка ACR" обеспечивает разработку интегрированного локального внутреннего цикла, разгружая сборки в Azure. Быстрые сборки позволяют проверить автоматические определения сборок перед фиксацией кода.

Используя знакомый формат `docker build`, команда [az acr build][az-acr-build] в Azure CLI извлекает локальный контекст, отправляет его в службу сборки ACR и по умолчанию помещает встроенный образ в его реестр после завершения. Решение "Сборка ACR" учитывает ваши геореплицированные реестры, благодаря чему географически распределенные группы разработчиков могут использовать ближайший реплицированный реестр. На этапе предварительной версии служба "Сборка ACR" доступна в регионах восточной части США и Западной Европы.

Служба "Сборка ACR" разработана как примитив жизненного цикла контейнеров. К примеру, интегрируйте службу "Сборка ACR" в решение CI/CD. Выполнив команды [az login][az-login] с [субъектом-службой][az-login-service-principal], решение CI/CD может выдавать команды [az acr build][az-acr-build] для запуска сборок образов.

Узнайте, как использовать быстрые сборки из первого руководства по сборке ACR: [Руководство. Создание образов контейнера в облаке с помощью службы "Сборка Реестра контейнеров Azure"](container-registry-tutorial-quick-build.md).

## <a name="automatic-build-on-source-code-commit"></a>Автоматическая сборка при фиксации исходного кода

Используйте службу "Сборка ACR", чтобы автоматически активировать сборку образов контейнеров при фиксации кода в репозиторий Git. Задачи сборки, настраиваемые с помощью команды Azure CLI [az acr build-task][az-acr-build-task], позволяют задавать репозиторий Git и при необходимости ветвь и Dockerfile. Когда ваша команда фиксирует код в репозиторий, веб-перехватчик, созданный службой "Сборка ACR", активирует сборку образов контейнеров, определенную в репозитории.

Узнайте, как активировать сборку при фиксации исходного кода из второго руководства по службе "Сборка ACR", [Automate container image builds with Azure Container Registry Build](container-registry-tutorial-build-task.md) (Автоматизация сборок образов контейнера с помощью службы "Сборка Реестра контейнеров Azure").

## <a name="automate-os-and-framework-patching"></a>Автоматизация установки исправлений ОС и платформы

Возможность службы "Сборка ACR" значительно улучшать конвейер сборки контейнера обуславливается ее способностью обнаруживать обновление базового образа. Когда обновленный базовый образ помещается в ваш реестр, служба "Сборка ACR" может автоматически выполнять сборку всех образов приложения на его основе.

Образы контейнеров можно классифицировать на *базовые* образы и образы *приложения*. К базовым образам, как правило, относятся операционная система и платформы приложений, на основе которых создано приложение, а также другие настройки. Эти базовые образы обычно создаются на основе открытых вышестоящих образов, например [Alpine Linux][base-alpine] или [Node.js][base-node]. Несколько образов вашего приложения могут совместно использовать общий базовый образ.

Когда вышестоящая программа обслуживания обновляет образ ОС или платформу приложения, к примеру, путем внесения критического исправления системы безопасности ОС, необходимо также внести его и в базовые образы. Затем необходимо повторно выполнить сборку каждого образа приложения, чтобы внести эти вышестоящие исправления, внесенные в базовый образ.

Так как при создании образа контейнера служба "Сборка ACR" динамически находит зависимости базовых образов, она может определить время обновления базового образа приложения. С помощью одной предварительно настроенной [задачи сборки](container-registry-tutorial-base-image-update.md#create-build-task) служба "Сборка ACR" **автоматически повторно выполняет сборку каждого образа приложения**. Благодаря такому автоматическому обнаружению и повторному выполнению сборок служба "Сборка ACR" экономит время и усилия, необходимые для того, чтобы вручную отслеживать и обновлять каждый образ приложения, ссылающийся на обновленный базовый образ.

Дополнительные сведения об исправлениях ОС и платформы см. в третьем руководстве по сборке ACR [Руководство. Автоматизация сборок образа при обновлении базового образа с помощью службы "Сборка Реестра контейнеров Azure"](container-registry-tutorial-base-image-update.md).

> [!NOTE]
> В первоначальной предварительной версии обновления базовых образов активируют сборки только в том случае, если базовые образы и образы приложения находятся в одном и том же реестре контейнеров Azure.

## <a name="next-steps"></a>Дополнительная информация

Когда вы будете готовы автоматизировать внесение исправлений ОС и платформы путем выполнения сборок образов контейнера в облаке, ознакомьтесь с тремя руководствами по службе "Сборка ACR".

> [!div class="nextstepaction"]
> [Создание образов контейнера в облаке с помощью службы "Сборка реестра контейнеров Azure"](container-registry-tutorial-quick-build.md)

<!-- LINKS - External -->
[base-alpine]: https://hub.docker.com/_/alpine/
[base-dotnet]: https://hub.docker.com/r/microsoft/dotnet/
[base-node]: https://hub.docker.com/_/node/
[base-windows]: https://hub.docker.com/r/microsoft/nanoserver/
[sample-archive]: https://github.com/Azure-Samples/acr-build-helloworld-node/archive/master.zip

<!-- LINKS - Internal -->
[azure-cli]: /cli/azure/install-azure-cli
[az-acr-build]: /cli/azure/acr#az-acr-build
[az-acr-build-task]: /cli/azure/acr#az-acr-build-task
[az-login]: /cli/azure/reference-index#az-login
[az-login-service-principal]: /cli/azure/authenticate-azure-cli#log-in-with-a-service-principal

<!-- IMAGES -->
[quick-build-01-fork]: ./media/container-registry-tutorial-quick-build/quick-build-01-fork.png
[quick-build-02-browser]: ./media/container-registry-tutorial-quick-build/quick-build-02-browser.png
