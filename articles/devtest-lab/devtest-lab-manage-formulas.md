---
title: Управление формулами в Azure DevTest Labs для создания виртуальных машин | Microsoft Docs
description: Узнайте как создавать, изменять и удалять формулы Azure DevTest Labs, а также использовать их для создания виртуальных машин.
services: devtest-lab,virtual-machines
documentationcenter: na
author: tomarcher
manager: douge
editor: ''

ms.service: devtest-lab
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/30/2016
ms.author: tarcher

---
# Управление формулами DevTest Labs для создания виртуальных машин
Формула в Azure DevTest Labs — это список значений свойств, используемых по умолчанию при создании виртуальной машины. При создании виртуальной машины на основе формулы значения по умолчанию можно использовать "как есть" или изменить. Формулы, так же как [пользовательские образы](devtest-lab-create-template.md) и [образы Marketplace](devtest-lab-configure-marketplace-images.md), обеспечивают быструю подготовку виртуальных машин.

В этой статье вы научитесь выполнять следующие задачи:

* [Создание формулы](#create-a-formula)
* [Использование формулы для подготовки виртуальной машины](#use-a-formula-to-provision-a-vm)
* [Изменение формулы](#modify-a-formula)
* [Удаление формулы](#delete-a-formula)

> [!NOTE]
> Формулы, так же как [пользовательские образы](devtest-lab-create-template.md), позволяют создать базовый образ из VHD-файла. Затем базовый образ можно использовать для подготовки новой виртуальной машины. Чтобы выбрать подходящий вариант для своей среды, ознакомьтесь со статьей [Сравнение пользовательских образов и формул в DevTest Labs](devtest-lab-comparing-vm-base-image-types.md).
> 
> 

## Создание формулы
Любой пользователь, имеющий разрешения роли *Пользователь* DevTest Labs, может создавать виртуальные машины на основе формул. Формулы можно создавать двумя способами.

* Из базового образа — используйте этот способ, если хотите задать все характеристики формулы.
* На основе существующей виртуальной машины — используйте этот способ, если хотите создать формулу на основе параметров существующей виртуальной машины.

### Создание формулы из базового образа
Ниже приведены пошаговые инструкции по созданию формулы на основе пользовательского образа, образа Marketplace или другой формулы.

1. Выполните вход на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Другие службы**, а затем выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.
4. В колонке лаборатории выберите **Formulas (reusable bases)** (Формулы (базовые образы, используемые повторно)).
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. В колонке **Формулы лаборатории** выберите **+ Добавить**.
   
    ![Добавление формулы](./media/devtest-lab-manage-formulas/add-formula.png)
6. В колонке **Выбор основы** выберите базовый образ (пользовательский образ, образ Marketplace или формулу), на основе которого хотите создать формулу.
   
    ![Список базовых образов](./media/devtest-lab-manage-formulas/base-list.png)
7. В колонке **Создание формулы** укажите перечисленные ниже значения.
   
   * **Имя формулы** — введите имя формулы. Это значение будет отображаться в списке базовых образов при создании виртуальной машины. Имя проверяется по мере ввода. Если оно недопустимо, появится сообщение с указанием требований к именам.
   * **Описание** — введите содержательное описание формулы. Это значение доступно в контекстном меню формулы при создании виртуальной машины.
   * **Имя пользователя** — введите имя пользователя, которому будут предоставлены права администратора.
   * **Пароль** — введите или выберите из раскрывающегося списка значение, связанное с секретом (паролем), которое будет применяться для указанного пользователя.
   * **Образ** — в этом поле приводится имя базового образа, выбранного в предыдущей колонке.
   * **Размер виртуальной машины** — выберите один из стандартных пунктов, указывающих количество ядер процессора, объем ОЗУ и размер жесткого диска для создаваемой виртуальной машины.
   * **Виртуальная сеть** — укажите нужную виртуальную сеть.
   * **Подсеть** — укажите нужную подсеть.
   * **Общедоступный IP-адрес** — если политика лаборатории разрешает использовать общедоступные IP-адреса для выбранной подсети, укажите, должен ли IP-адрес быть общедоступным, выбрав **Да** или **Нет**. В противном случае этот параметр отключен и имеет значение **Нет**.
   * **Артефакты** — выберите и настройте артефакты, которые необходимо добавить в базовый образ. Значения защищенных строк в формуле не сохраняются. Поэтому параметры артефактов, представляющие собой защищенные строки, не отображаются.
     
       ![Создание формулы](./media/devtest-lab-manage-formulas/create-formula.png)
8. Щелкните **Создать**, чтобы создать формулу.

### Создание формулы на основе виртуальной машины
Ниже приводятся пошаговые инструкции по созданию формулы на основе существующей виртуальной машины.

> [!NOTE]
> Для создания формулы на основе виртуальной машины необходимо, чтобы эта виртуальная машина была создана после 30 марта 2016 г.
> 
> 

1. Выполните вход на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Другие службы**, а затем выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.
4. В колонке **Обзор** выберите виртуальную машину, на основе которой будет создана формула.
   
    ![Лабораторные виртуальные машины](./media/devtest-lab-manage-formulas/my-vms.png)
5. В колонке виртуальной машины выберите **Create formula (reusable base)** (Создать формулу (базовый образ, используемый повторно)).
   
    ![Создание формулы](./media/devtest-lab-manage-formulas/create-formula-menu.png)
6. В колонке **Create formula** (Создание формулы) введите **имя** и **описание** новой формулы.
   
    ![Колонка "Create formula" (Создание формулы)](./media/devtest-lab-manage-formulas/create-formula-blade.png)
7. Нажмите кнопку **ОК**, чтобы создать формулу.

## Использование формулы для подготовки виртуальной машины
После создания формулы на ее основе можно создать виртуальную машину. В разделе [Добавление виртуальной машины с артефактами](devtest-lab-add-vm-with-artifacts.md#add-a-vm-with-artifacts) описаны шаги этого процесса.

## Изменение формулы
Чтобы изменить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Другие службы**, а затем выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.
4. В колонке лаборатории выберите **Formulas (reusable bases)** (Формулы (базовые образы, используемые повторно)).
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. В колонке **Lab formulas** (Формулы лаборатории) выберите формулу, которую нужно изменить.
6. В колонке **Update formula** (Обновление формулы) внесите необходимые изменения и щелкните **Обновить**.

## Удаление формулы
Чтобы удалить формулу, выполните указанные ниже действия.

1. Выполните вход на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Другие службы**, а затем выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.
4. В колонке **Параметры** лаборатории выберите **Формулы**.
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. В колонке **Lab formulas** (Формулы лаборатории) щелкните многоточие справа от формулы, которую нужно удалить.
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-formulas-blade.png)
6. В контекстном меню формулы выберите **Удалить**.
   
    ![Контекстное меню формулы](./media/devtest-lab-manage-formulas/formula-delete-context-menu.png)
7. В диалоговом окне подтверждения удаления нажмите кнопку **Да**.

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]

## Связанные записи в блогах
* [Custom images or formulas? (Пользовательские изображения или формулы?)](https://blogs.msdn.microsoft.com/devtestlab/2016/04/06/custom-images-or-formulas/)

## Дальнейшие действия
После создания формулы, которая служит для создания виртуальных машин, можно [добавить виртуальную машину в лабораторию](devtest-lab-add-vm-with-artifacts.md).

<!---HONumber=AcomDC_0907_2016-->