<properties
	pageTitle="Управление формулами DevTest Labs для создания виртуальных машин | Microsoft Azure"
	description="Узнайте как создавать, изменять и удалять формулы в лаборатории для разработки и тестирования, а также использовать их для создания виртуальных машин."
	services="devtest-lab,virtual-machines"
	documentationCenter="na"
	authors="tomarcher"
	manager="douge"
	editor=""/>

<tags
	ms.service="devtest-lab"
	ms.workload="na"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="05/08/2016"
	ms.author="tarcher"/>

# Управление формулами DevTest Labs для создания виртуальных машин

## Обзор

Формулы, так же как [пользовательские образы](./devtest-lab-create-template.md) и [образы Marketplace](./devtest-lab-configure-marketplace-images.md), обеспечивают быструю подготовку виртуальных машин. Формула в DevTest Labs — это список значений свойств, используемых по умолчанию при создании виртуальной машины лаборатории. При создании виртуальной машины на основе формулы значения по умолчанию можно использовать "как есть" или изменить.

В этой статье вы научитесь выполнять следующие задачи:

- [Создание формулы](#create-a-new-formula)
- [Использование формулы для создания виртуальной машины](#use-a-formula-to-create-a-new-vm)
- [Изменение формулы](#modify-a-formula)
- [Удаление формулы](#delete-a-formula)

> [AZURE.NOTE] Формулы похожи на [пользовательские образы](./devtest-lab-create-template.md) тем, что каждая формула позволяет на основе виртуального жесткого диска создать базовый образ, который используется для подготовки виртуальной машины. Чтобы выбрать подходящий вариант для своей среды, ознакомьтесь со статьей [Сравнение пользовательских образов и формул в DevTest Labs](./devtest-lab-comparing-vm-base-image-types.md).

## Создание формулы
Любой пользователь, имеющий разрешения роли *Пользователь* DevTest Labs, может создавать виртуальные машины в лаборатории на основе формул. Формулы можно создавать двумя способами.

- С нуля — используйте этот способ, если хотите задать все характеристики формулы с нуля.
- На основе существующей виртуальной машины — используйте этот способ, если хотите создать формулу на основе параметров существующей виртуальной машины.

### Создание формулы с нуля
Ниже приведены пошаговые инструкции по созданию формулы с нуля.

1. Войдите на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).

1. Выберите **Обзор**, а затем в списке выберите **Лаборатории для разработки и тестирования**.

1. В списке лабораторий найдите нужную лабораторию.

1. Появится колонка **Параметры** для выбранной лаборатории.

1. В колонке **Параметры** выберите **Формулы**.

    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)

1. В колонке **Формулы лаборатории** выберите **+ Добавить**.

    ![Добавление формулы](./media/devtest-lab-manage-formulas/add-formula.png)

1. В колонке **Выбор основы** выберите пользовательский образ или образ Marketplace, на основе которого хотите создать формулу.

    ![Список базовых образов](./media/devtest-lab-manage-formulas/base-list.png)

1. В колонке **Создание формулы** укажите перечисленные ниже значения.

	- **Имя формулы** — введите имя формулы. Это значение будет отображаться в списке базовых образов при создании виртуальной машины. Имя проверяется по мере ввода. Если оно недопустимо, появится сообщение с указанием требований к именам.
	- **Описание** — введите содержательное описание формулы. Это значение доступно в контекстном меню формулы при создании виртуальной машины.
	- **Образ** — в этом поле приводится имя базового образа, выбранного в предыдущей колонке. 
	- **Размер ВМ** — выберите один из стандартных элементов, указывающих количество ядер процессора, объем ОЗУ и размер жесткого диска для создаваемой виртуальной машины.
	- **Виртуальная сеть** — выберите нужную виртуальную сеть.
	- **Подсеть** — выберите нужную подсеть.
	- **Общедоступный IP-адрес** — если политика лаборатории разрешает использовать общедоступные IP-адреса для выбранной подсети, укажите, должен ли IP-адрес быть общедоступным, выбрав **Да** или **Нет**. В противном случае этот параметр отключен и имеет значение **Нет**.
	- **Артефакты** — коснитесь этого пункта, а затем в списке артефактов выберите и настройте артефакты, которые нужно добавить в базовый образ. Обратите внимание на то, что параметры артефактов, представляющие собой защищенные строки, не отображаются, так как формула не сохраняет значения защищенных строк. 

    	![Создание формулы](./media/devtest-lab-manage-formulas/create-formula.png)

1. Коснитесь **Создать**, чтобы создать формулу. Когда формула будет создана, она появится в колонке **Lab formulas** (Формулы лаборатории).

	![Созданная формула](./media/devtest-lab-manage-formulas/newly-created-formula.png)

### Создание формулы на основе виртуальной машины лаборатории
Ниже приводятся пошаговые инструкции по созданию формулы на основе существующей виртуальной машины.

> [AZURE.NOTE] Создавать формулы можно только на основе виртуальных машин лаборатории, созданных после 30 марта 2016 года.

1. Войдите на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).

1. Выберите **Обзор**, а затем в списке выберите **Лаборатории для разработки и тестирования**.

1. В списке лабораторий найдите нужную лабораторию.

1. В колонке лаборатории найдите раздел **My VMs** (Мои виртуальные машины) и выберите виртуальную машину, на основе которой хотите создать формулу.

	![Лабораторные виртуальные машины](./media/devtest-lab-manage-formulas/my-vms.png)

1. В колонке **Параметры** виртуальной машины выберите **Create formula** (Создать формулу).

	![Создание формулы](./media/devtest-lab-manage-formulas/create-formula-menu.png)

1. В колонке **Create formula** (Создание формулы) введите **имя** и **описание** новой формулы, а затем нажмите кнопку **ОК**. Когда формула будет создана, она появится в колонке **Lab formulas** (Формулы лаборатории).

	![Колонка "Create formula" (Создание формулы)](./media/devtest-lab-manage-formulas/create-formula-blade.png)

## Изменение формулы
Чтобы изменить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).

1. Выберите **Обзор**, а затем в списке выберите **Лаборатории для разработки и тестирования**.

1. В списке лабораторий найдите нужную лабораторию.

1. В колонке **Параметры** выберите **Формулы**.

    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)

1. В колонке **Lab formulas** (Формулы лаборатории) выберите формулу, которую нужно изменить.

1. В колонке **Обновление формулы** внесите необходимые изменения и нажмите **Обновить**.

## Удаление формулы 
Чтобы удалить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](http://go.microsoft.com/fwlink/p/?LinkID=525040).

1. Выберите **Обзор**, а затем в списке выберите **Лаборатории для разработки и тестирования**.

1. В списке лабораторий найдите нужную лабораторию.

1. В колонке **Параметры** выберите **Формулы**.

    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)

1. В колонке **Lab formulas** (Формулы лаборатории) щелкните многоточие справа от формулы, которую нужно удалить.

    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-formulas-blade.png)

1. В контекстном меню формулы выберите **Удалить**.

    ![Контекстное меню формулы](./media/devtest-lab-manage-formulas/formula-delete-context-menu.png)

1. В диалоговом окне подтверждения удаления нажмите кнопку **Да**.

    ![Контекстное меню формулы](./media/devtest-lab-manage-formulas/formula-delete-confirmation.png)

## Дальнейшие действия
После создания формулы, которая служит для создания виртуальных машин, можно [добавить виртуальную машину в лабораторию](./devtest-lab-add-vm-with-artifacts.md).

<!---HONumber=AcomDC_0518_2016-->