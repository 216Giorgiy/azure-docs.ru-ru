<properties 
   pageTitle="Соединитель Office 365" 
   description="Использование соединителя Office 365" 
   services="app-service\logic" 
   documentationCenter=".net,nodejs,java" 
   authors="sutalasi" 
   manager="dwrede" 
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration" 
   ms.date="03/20/2015"
   ms.author="sutalasi"/>


# Использование соединителя Office 365 в приложении логики#

Приложения логики могут запускаться на основе разных источников данных и предлагать соединители для получения и обработки данных в рамках потока. Соединитель Office 365 позволяет отправлять и получать сообщения электронной почты, управлять календарем и контактами в вашей учетной записи Office 365. Вы можете выполнять различные действия, такие как отправка, получение и извлечение сообщений электронной почты, создание и удаление событий в календаре и создание, обновление, получение и удаление контактов.

**Базовые действия**

- Новое сообщение (триггер)
- Отправить сообщение
- Ответить на сообщение
- Отправить событие
- Добавить контакт


## Создание приложения логики##
Для использования соединителя Office 365 в приложении логики приложение API соединителя должно быть уже создано, либо вы можете создать его в процессе работы в приложении логики. Давайте создадим простое приложение логики, которое инициируется при получении сообщения электронной почты (на адрес запросов на продажу - скажем, sales@contoso.com). Это приложение логики создает событие, добавляет контакт со сведениями отправителя, отправляет электронное письмо в вашу личную учетную запись и в финале отправляет ответ с подтверждением.

1.	Войдите на портал Azure и последовательно выберите "Создать" -> "Мобильные и веб-приложения" -> "Приложение логики".

	![][1]

2.	На странице "Создание приложения логики" предоставьте необходимые сведения, такие как имя, план обслуживания приложения и расположение.

	![][2]

3.	Щелкните "Триггеры и действия", и откроется экран редактора приложения логики.

	![][3]

4.	Разверните узел "Создать новое" в коллекции, чтобы увидеть все доступные приложения API. Выберите в коллекции элемент Office 365, и в поток будет добавлен триггер Office 365.
	![][4]

5.	Таким образом создается новое приложение API "Соединитель Office 365" в одной группе ресурсов с приложением логики. Создание этого приложения API занимает приблизительно 30 секунд.

6.	После создания приложения нажмите кнопку "Авторизовать", чтобы предоставить учетные данные для входа в Office 365.

	![][5]

7.	Вы будете перенаправлены на страницу входа в Office 365, где можете пройти проверку подлинности с помощью учетных данных своей учетной записи Office 365.

	![][6]

	![][7]

8.	После выполнения авторизации отображаются триггеры Office 365.

	![][8]

9.	Выберите триггер "Новое сообщение электронной почты", и появятся входные параметры.


10.	Измените частоту триггера на 'Minutes' и нажмите ✓. 

	![][9]

11. Триггер Office 365 'New Email' теперь настроен, и вы можете видеть, что отображаются также и выходные параметры.
	
	![][10]

12.	В разделе "Последние использовавшиеся" коллекции выберите "Соединитель Office 365", и будет добавлено новое действие "Office 365".

13.	Выберите "Отправить событие" в списке действий, и появятся входные параметры действия "Отправить событие".

	![][11]

14.	Укажите сведения о событии и нажмите ✓.

	![][12]

15.	В разделе "Последние использовавшиеся" коллекции выберите "Соединитель Office 365", и будет добавлено новое действие "Office 365".

16.	Выберите "Добавить контакт" в списке действий, и появятся входные параметры действия "Добавить контакт".

	![][13]

17.	Нажмите знак "плюс" (+) рядом с полем 'Email Address' и выберите значение 'From' выходного поля триггера.

	![][14]

18. Нажмите ✓, и настройка действия будет завершена.

	![][15]

19.	В разделе "Последние использовавшиеся" коллекции выберите "Соединитель Office 365", и будет добавлено новое действие "Office 365".


20.	Выберите "Отправить сообщение электронной почты" в списке действий, и появятся входные параметры действия "Отправить сообщение электронной почты".

	![][19]

21.	Предоставьте сведения, необходимые для отправки сообщения электронной почты. Вы можете создать сообщение, введя примерно следующее. После настройки действия 'Send Email' нажмите ✓.

		Body - @concat('You got a new sales enquiry from',triggers().output.body.From)

	![][20]
22.	В разделе "Последние использовавшиеся" коллекции выберите "Соединитель Office 365", и будет добавлено новое действие "Office 365".


23.	Выберите "Ответить" в списке действий, и появятся входные параметры действия "Ответить".

	![][16]

24.	Нажмите знак "плюс" (+) рядом с полем 'From', выберите значение из входного сообщения триггера и нажмите ✓.

	![][17]

25. Нажмите кнопку "ОК" на экране редактора приложения логики, а затем нажмите кнопку 'Create'. Создание займет приблизительно 30 секунд.

26. Отправьте сообщение электронной почты в учетную запись, которую вы настроили в триггере, и вы должны увидеть сообщение электронной почты в своей личной учетной записи, событие календаря и контакт в вашей почтовой учетной записи Office. Кроме того, вы должны получить ответ с подтверждением, что на ваш запрос на продажу будет вскоре отвечено.

<!--Image references-->
[1]: ./media/app-service-logic-connector-office365/1_New_Logic_App.png
[2]: ./media/app-service-logic-connector-office365/2_Logic_App_Settings.png
[3]: ./media/app-service-logic-connector-office365/3_Logic_App_Editor.png
[4]: ./media/app-service-logic-connector-office365/4_Select_Office365_Gallery.png
[5]: ./media/app-service-logic-connector-office365/5_Office365_Authorize.png
[6]: ./media/app-service-logic-connector-office365/6_Office365_Login.png
[7]: ./media/app-service-logic-connector-office365/7_Office365_User_Consent.png
[8]: ./media/app-service-logic-connector-office365/8_Office365_Trigger.png
[9]: ./media/app-service-logic-connector-office365/9_Office365_Trigger_Settings.png
[10]: ./media/app-service-logic-connector-office365/10_Office365_Trigger_Configured.png
[11]: ./media/app-service-logic-connector-office365/11_Office365_Actions_List.png
[12]: ./media/app-service-logic-connector-office365/12_Office365_Create_Event_Inputs.png
[13]: ./media/app-service-logic-connector-office365/13_Office365_Add_Contact_Inputs.png
[14]: ./media/app-service-logic-connector-office365/14_Office365_Add_Contact_Email_FromTrigger.png
[15]: ./media/app-service-logic-connector-office365/15_Office365_Add_Contacts_Configured.png
[16]: ./media/app-service-logic-connector-office365/16_Office365_Reply_To_Inputs.png
[17]: ./media/app-service-logic-connector-office365/17_Office365_Reply_To_MessageId.png
[18]: ./media/app-service-logic-connector-office365/18_Office365_Reply_To_Configured.png
[19]: ./media/app-service-logic-connector-office365/19_Office365_Send_Inputs.png
[20]: ./media/app-service-logic-connector-office365/20_Office365_Send_Configured.png


<!--HONumber=49-->