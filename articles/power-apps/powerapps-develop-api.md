<properties
	pageTitle="Разработка API для PowerApps Enterprise | Microsoft Azure"
	description="Построение или создание настраиваемых API для PowerApps"
	services=""
    suite="powerapps"
	documentationCenter="" 
	authors="rajram"
	manager="erikre"
	editor=""/>

<tags
   ms.service="powerapps"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na" 
   ms.date="03/02/2016"
   ms.author="rajram"/>

# Разработка API для PowerApps

Вы можете создать или разработать собственный API для использования в PowerApps. Для этого нужно выполнить следующие действия:

- Создание и развертывание API
- Создание определения [Swagger 2.0](http://swagger.io/) для своего API

В этом разделе перечислены эти действия.

## Шаг 1. Создание и развертывание API

Создание и развертывание API для PowerApps осуществляется аналогично созданию любого другого API. Вы можете выбрать предпочитаемый язык программирования и платформу. Разместить API также можно в любом месте. Рекомендуется разместить его в той же среде службы приложений PowerApps, где находится [приложение API](https://azure.microsoft.com/services/app-service/api/).

В следующих статьях рассказывается, как создать и развернуть API .Net, Java или Node.js в среде службы приложений:

- [Создание и развертывание приложения API .NET в службе приложений Azure](../app-service-api/app-service-api-dotnet-get-started.md)
- [Сборка и развертывание приложения API Java в службе приложений Azure](../app-service-api/app-service-api-java-api-app.md)
- [Создание и развертывание приложения API Node.js в службе приложений Azure](../app-service-api/app-service-api-nodejs-api-app.md)


## Шаг 2. Создание определения Swagger 2.0 для своего API

Если следовать инструкциям в одной из статей, указанных в *Шаге 1*, стандартное определение Swagger 2.0 будет создано для вашего API автоматически. Чтобы оптимизировать его для PowerApps, настройте определение Swagger 2.0 с помощью следующих расширений схемы.

Общие сведения о настройке определения API в Swagger 2.0 см. в статье [Настройка определений API, созданных в Swashbuckle](../app-service-api/app-service-api-dotnet-swashbuckle-customize.md).

### Расширения схемы
Помимо автоматически создаваемых Swashbuckle определений Swagger, существует несколько дополнительных расширений Swagger, доступных при создании API для PowerApps. В этом разделе приводится список этих расширений с описаниями.

##### x-ms-summary
Строка, описывающая отображаемые имена для сущностей, у которых нет поля сводки, определенного в спецификации Swagger. Например, это могут быть **имена параметров**.

##### x-ms-visibility
Это значение указывает, отображается ли сущность в конструкторе логических потоков. Доступны следующие значения:

- "none" (по умолчанию)
- "advanced"
- "internal" — конструктор логических потоков не отображает эти операции

Если операция отмечена как "важная", клиент логических потоков должен ее выделить.

##### x-ms-trigger
Определяет, может ли эта операция использоваться в логическом потоке как триггер. Доступные параметры:
	
- none (по умолчанию): операция не может использоваться как триггер.
- single: операция может использоваться как триггер.
- batched: операция может использоваться как триггер. Кроме того, эта операция возвращает "массив" объектов JSON, а логический поток запускает триггер для каждого элемента в массиве.


##### x-ms-dynamic-values
Указывает конструктору логических потоков, что API предоставляет список динамически разрешенных значений для этого параметра. Конструктор логических потоков может вызывать операцию, определенную значением этого поля, и извлекать возможные значения из результата. Затем конструктор логических потоков может отображать эти значения в виде параметров для конечного пользователя.

Значение — это объект, который содержит следующие свойства:
	
- operationId: строка, которая совпадает с идентификатором operationId для вызываемой операции.
- parameters: объект, свойства которого определяют параметры, необходимые для операции.
- value-collection: строка пути, значением которой является массив объектов в полезных данных ответа.
- value-path: строка пути в объекте из value-collection, которая ссылается на значение параметра.
- value-title: строка пути в объекте из value-collection, которая ссылается на описание параметра.


Пример:

```javascript
"/api/tables/{table}/items": {
  "post": {
    "operationId": "TableData_CreateItem",
    "summary": "Create an object in {Salesforce}",
    "parameters": [
      {
        "name": "table",
        "x-ms-summary": "Object Type",
        "x-ms-dynamic-values": {
          "operationId": "TableMetadata_ListTables",      // operation that needs to be invoked
          "parameters": { },                              // parameters for the above operation, if any
          "value-collection": "values",                   // field that contains the collection
          "value-path": "Name",                           // field that contains the value
          "value-title": "DisplayName"                    // field that contains a display name for the value
      }
      // ...
    ]
    // ...
  }
  // ...
}
```

В приведенном выше примере Swagger определяет операцию под названием _TableData\_CreateItem_, которая создает новый объект в Salesforce.

В SalesForce имеется множество встроенных объектов. _x-ms-dynamic-values_ помогает конструктору определить список встроенных объектов Salesforce. Он получает этот список посредством вызова метода _TableMetadata\_ListTables_.

##### x-ms-dynamic-schema
Указывает конструктору логических потоков, что схема для этого параметра (или ответа) является динамической. Расширение может вызывать операцию, определенную значением этого поля, и динамически определять схему. После этого оно отображает соответствующий пользовательский интерфейс, где пользователи вводят данные, или отображаются доступные поля.

Пример:

```javascript
{
  "name": "item",
  "in": "body",
  "required": true,
  "x-ms-dynamic-schema": {
    "operationId": "Metadata_GetTableSchema",
    "parameters": {
      "tablename": "{table}"              // the value that the user has selected from the above parameter
    },
    "value-path": "Schema"                // the field that contains the JSON schema
  }
},
```

Это расширение полезно в сценариях, где входные данные для операции являются динамическими. Возьмем для примера SQL. У всех таблиц разные схемы. Поэтому, когда пользователь выбирает определенную таблицу, конструктору логических потоков приходится анализировать структуру таблицы, чтобы отобразить имена столбцов. В этом случае если определение Swagger содержит расширение _x-ms-dynamic-schema_, для извлечения схемы вызывается соответствующая операция.

<!---HONumber=AcomDC_0309_2016-->