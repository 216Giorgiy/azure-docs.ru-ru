<properties
   pageTitle="Основные сведения о различиях между классической моделью развертывания и моделью развертывания диспетчера ресурсов"
   description="Описывает различия между моделью развертывания диспетчера ресурсов и классической моделью развертывания (или моделью управления службами)."
   services="azure-resource-manager"
   documentationCenter="na"
   authors="tfitzmac"
   manager="wpickett"
   editor=""/>

<tags
   ms.service="azure-resource-manager"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="12/02/2015"
   ms.author="tomfitz"/>

# Общие сведения о развертывании диспетчера ресурсов и классическом развертывании

Модель развертывания диспетчера ресурсов предлагает новый способ развертывания и управления службами, которые составляют приложение. Эта новая модель имеет важные отличия от классической модели развертывания, и эти две модели не являются полностью совместимыми друг с другом. Чтобы упростить развертывание и управление ресурсами, корпорация Майкрософт рекомендует использовать диспетчер ресурсов для новых ресурсов и, если это возможно, для повторного развертывания существующих ресурсов через диспетчер ресурсов.

Возможно, вы знакомы с классической моделью развертывания как с моделью управления службами.

В этом разделе описываются различия между двумя моделями и некоторые из проблем, с которыми можно столкнуться при переходе от классической модели к модели диспетчера ресурсов. Здесь представлены общие сведения о модели, но подробные различия в отдельных службах не рассматриваются. Дополнительные сведения о процессе перехода вычислительных, сетевых ресурсов и ресурсов хранения см. в статье [Поставщики вычислительных, сетевых ресурсов и ресурсов хранения в диспетчере ресурсов Azure](./virtual-machines/virtual-machines-azurerm-versus-azuresm.md).

Многие ресурсы без проблем работают как в классической модели, так и в модели диспетчера ресурсов. Эти ресурсы полностью поддерживают диспетчер ресурсов, даже если они были созданы в классической модели. Их можно легко перевести на диспетчер ресурсов безо всяких проблем и без дополнительных усилий.

Однако некоторые поставщики ресурсов предлагают две версии ресурсов (одну для классической модели и одну для модели диспетчера ресурсов) из-за архитектурных различий между моделями. К поставщикам ресурсов, которые различают две модели, относятся:

- Среда выполнения приложений
- Хранилище
- Сеть

Для этих типов ресурсов необходимо знать, какую версию вы используете, так как поддерживаемые ими операции будут различаться.

Для понимания архитектурных различий между двумя моделями обратитесь к статье [Архитектура диспетчера ресурсов Azure](virtual-machines/virtual-machines-azure-resource-manager-architecture.md).

## Характеристики диспетчера ресурсов

Ресурсы, созданные с помощью диспетчера ресурсов, имеют следующие характеристики.

- Они создаются с помощью одного из следующих методов:

  - [Портал Azure](https://portal.azure.com/).

        ![Azure portal](./media/resource-manager-deployment-model/preview-portal.png)

        For Compute, Storage, and Networking resources, you have the option of using either Resource Manager or Classic deployment. Select **Resource Manager**.

        ![Resource Manager deployment](./media/resource-manager-deployment-model/select-resource-manager.png)

  - Для версий Azure PowerShell до 1.0 команды выполняются в режиме **AzureResourceManager**.

            PS C:\> Switch-AzureMode -Name AzureResourceManager

  - Для Azure PowerShell 1.0 используйте версию команд для диспетчера ресурсов. Эти команды имеют вид *{команда}-AzureRm*, как показано ниже.

            PS C:\> Get-AzureRmResourceGroupDeployment

  - С использованием [API REST диспетчера ресурсов Azure](https://msdn.microsoft.com/library/azure/dn790568.aspx) для операций REST.
  - С использованием команд Azure CLI, выполняемых в режиме **arm**.

            azure config mode arm

- Тип ресурса не содержит **(классический)** в имени. На следующем рисунке тип отображается как **Учетная запись хранения**.

    ![веб-приложение](./media/resource-manager-deployment-model/resource-manager-type.png)

## Характеристики классического развертывания

Ресурсы, созданные с использованием модели классического развертывания, имеют следующие характеристики.

- Они создаются с помощью одного из следующих методов:

  - [Классический портал](https://manage.windowsazure.com).

        ![Classic portal](./media/resource-manager-deployment-model/azure-portal.png)

        Or, the portal and you specify **Classic** deployment (for Compute, Storage, and Networking).

        ![Classic deployment](./media/resource-manager-deployment-model/select-classic.png)

  - Для версий Azure PowerShell до 1.0 команды выполняются в режиме **AzureServiceManagement** (который является режимом по умолчанию, поэтому если вы специально не переключились на AzureResourceManager, то работаете в режиме AzureServiceManagement).

            PS C:\> Switch-AzureMode -Name AzureServiceManagement

  - Для Azure PowerShell 1.0 используйте версию команд для управления ресурсами. Эти команды **не** имеют вид *{команда}-AzureRm*, как показано ниже.

            PS C:\> Get-AzureDeployment

  - С использованием [API REST управления службами](https://msdn.microsoft.com/library/azure/ee460799.aspx) для операций REST.
  - С использованием команд Azure CLI, выполняемых в режиме **asm** или в режиме по умолчанию.
- Тип ресурса содержит **(классический)** в имени. На следующем рисунке тип отображается как **Учетная запись хранения (классическая)**.

    ![классический тип](./media/resource-manager-deployment-model/classic-type.png)

Для управления ресурсами, созданными с помощью классического развертывания, по-прежнему можно использовать портал.

## Преимущества использования диспетчера ресурсов и групп ресурсов

С появлением диспетчера ресурсов было добавлено понятие группы ресурсов. Каждый ресурс, который создается с помощью диспетчера ресурсов, входит в состав группы ресурсов. Модель развертывания диспетчера ресурсов предоставляет несколько преимуществ.

- Вы можете осуществлять развертывание, управление и мониторинг всех служб вашего решения как единой группы вместо того, чтобы работать с ними по отдельности.
- Вы можете повторно разворачивать приложение на протяжении всего его жизненного цикла и гарантировать, что ресурсы развертываются в согласованном состоянии.
- Вы можете использовать декларативные шаблоны для определения развертывания. 
- Вы можете определять зависимости между ресурсами, так чтобы они разворачивались в правильном порядке.
- Вы можете применить контроль доступа ко всем службам, так как контроль доступа на основе ролей (RBAC) изначально интегрирован в платформу управления.
- Вы можете применять к ресурсам теги для логической организации всех ресурсов в вашей подписке.


До появления диспетчера ресурсов каждый ресурс, который создавался с помощью классического развертывания, не являлся членом группы ресурсов. При появлении диспетчера ресурсов все ресурсы были добавлены в группы ресурсов по умолчанию. Теперь при классическом развертывании ресурсы будут автоматически создаваться в группе ресурсов, заданной для этой службы по умолчанию. Указывать ее не нужно. Однако только принадлежность к группе ресурсов не означает, что ресурс был преобразован в модель диспетчера ресурсов. Для виртуальных машин, хранения и виртуальных сетей, если ресурс был создан при помощи классического развертывания, необходимо продолжать работать с ним с помощью классических операций.

Ресурсы можно переместить в другую группу ресурсов; новые ресурсы также можно добавить в существующую группу ресурсов. Таким образом, в одной группе ресурсов могут находиться ресурсы, созданные с помощью диспетчера ресурсов и классического развертывания. Это сочетание ресурсов может привести к непредвиденным результатам, поскольку эти ресурсы не поддерживают одни и те же операции.

С помощью декларативных шаблонов можно упростить сценарии для развертывания. Вместо того чтобы пытаться преобразовать существующие сценарии из модели управления службами к модели диспетчера ресурсов, подумайте о переработке своей стратегии развертывания для определения инфраструктуры и конфигурации в шаблоне.

## Использование тегов

Теги дают возможность логически организовать ресурсы. Теги поддерживаются только ресурсами, созданными с помощью диспетчера ресурсов. К классическим ресурсам теги применить нельзя.

Дополнительные сведения об использовании тегов в диспетчере ресурсов см. в статье [Использование тегов для организации ресурсов Azure](resource-group-using-tags.md).

## Поддерживаемые операции для моделей развертывания

Ресурсы, которые созданы в классической модели развертывания, не поддерживают операции диспетчера ресурсов. В некоторых случаях с помощью команды диспетчера ресурсов можно получить сведения о ресурсе, созданном с помощью классического развертывания, или выполнить административные задачи, такие как перемещение классического ресурса в другую группу ресурсов, но эти случаи не должны создавать впечатление того, что этот тип поддерживает операции диспетчера ресурсов. Например, предположим, что имеется группа ресурсов, содержащих виртуальные машины, которые были созданы с помощью диспетчера ресурсов и классического развертывания. Если вы выполните следующую команду PowerShell, то вы увидите все виртуальные машины:

    PS C:\> Get-AzureRmResourceGroup -Name ExampleGroup
    ...
    Resources :
     Name                 Type                                          Location
     ================     ============================================  ========
     ExampleClassicVM     Microsoft.ClassicCompute/domainNames          eastus
     ExampleClassicVM     Microsoft.ClassicCompute/virtualMachines      eastus
     ExampleResourceVM    Microsoft.Compute/virtualMachines             eastus
    ...

Однако если выполнить команду Get-AzureVM, то вы получите только те виртуальные машины, которые были созданы с помощью диспетчера ресурсов.

    PS C:\> Get-AzureVM -ResourceGroupName ExampleGroup
    ...
    Id       : /subscriptions/xxxx/resourceGroups/ExampleGroup/providers/Microsoft.Compute/virtualMachines/ExampleResourceVM
    Name     : ExampleResourceVM
    ...

В общем случае, не следует ожидать, что ресурсы, созданные с помощью классического развертывания, будут работать с командами диспетчера ресурсов.

При работе с ресурсами, созданными с помощью диспетчера ресурсов, необходимо использовать операции диспетчера ресурсов и не возвращаться к операциям управления службами.

## Рекомендации для виртуальных машин

Вот некоторые важные особенности, которые следует учитывать при работе с виртуальными машинами.

- Виртуальные машины, развернутые с помощью классической модели развертывания, нельзя включить в виртуальную сеть, развернутую с помощью диспетчера ресурсов.
- Виртуальные машины, развернутые с помощью модели развертывания диспетчера ресурсов, должны быть включены в виртуальную сеть.
- Виртуальные машины, развернутые с помощью классической модели развертывания, включать в виртуальную сеть необязательно.

Если простой для виртуальных машин является допустимым, можно перенести их из классического развертывания в диспетчер ресурсов с помощью [скриптов PowerShell ASM2ARM](https://github.com/fullscale180/asm2arm).

Список эквивалентных команд Azure CLI при переходе от классического развертывания к развертыванию диспетчера ресурсов см. в разделе [Эквивалентные команды диспетчера ресурсов и управления службами для задач виртуальных машин](./virtual-machines/xplat-cli-azure-manage-vm-asm-arm.md).

Дополнительные сведения о процессе перехода вычислительных, сетевых ресурсов и ресурсов хранения см. в статье [Поставщики вычислительных, сетевых ресурсов и ресурсов хранения в диспетчере ресурсов Azure](./virtual-machines/virtual-machines-azurerm-versus-azuresm.md).

Сведения о подключении виртуальных сетей с помощью различных моделей развертывания см. в статье [Подключение классических виртуальных сетей к новым виртуальным сетям](./virtual-network/virtual-networks-arm-asm-s2s.md).

## Дальнейшие действия

- Сведения о создании декларативных шаблонов развертывания см. в статье [Создание шаблонов диспетчера ресурсов Azure](resource-group-authoring-templates.md).
- Команды для развертывания шаблонов см. в статье [Развертывание приложения с помощью шаблона диспетчера ресурсов Azure](resource-group-template-deploy.md).

<!---HONumber=AcomDC_1203_2015-->