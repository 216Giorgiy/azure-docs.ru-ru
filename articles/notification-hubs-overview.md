<properties linkid="dev-net-service-bus-amqp-overview" urlDisplayName="Концентраторы уведомлений Azure" pageTitle="Концентраторы уведомлений Azure" metaKeywords="push-уведомления Azure, концентраторы уведомлений Azure, обмен сообщениями Azure" description="Узнайте, как использовать push-уведомления в Azure. Примеры кода написаны на C# с помощью API-интерфейса .NET." metaCanonical="" disqusComments="1" umbracoNaviHide="0" title="Концентраторы уведомлений Azure" authors="" />


#Концентраторы уведомлений Azure


Поддержка push-уведомлений в Azure позволяет получить доступ к простой в использовании, многоплатформенной и масштабируемой инфраструктуре для отправки push-уведомлений, которая значительно упрощает реализацию push-уведомлений как для индивидуальных пользователей, так и для корпоративных приложений для мобильных платформ.

<h2><span class="short-header">Что такое push-уведомления?</span>Что такое push-уведомления?</h2>

Смартфоны и планшетные компьютеры имеют возможность "уведомлять" пользователей, когда произошло событие. В приложениях для Магазина Windows может появляться _всплывающее уведомление_, то есть отображается немодальное окно со звуком для обозначения нового push-уведомления. На устройствах iOS Apple получение push-уведомления приводит к отображению диалогового окна, запрашивающего у пользователя просмотр или закрытие уведомления. Щелкнув **Вид**, можно открыть приложение, которое получает сообщение.

Push-уведомления помогают отображать новую информацию на мобильных устройствах без дополнительного энергопотребления. Push-уведомления являются жизненно важным компонентом приложений для потребителей, где они служат для увеличения степени вовлеченности и использования таких приложений. Уведомления также полезны для предприятий, когда обновленная информация увеличивает скорость реагирования сотрудника на бизнес-события. 

Ниже приведены некоторые конкретные примеры сценариев использования push-уведомлений в мобильных приложениях:

1.  Обновление плитки на Windows 8 и Windows Phone с текущей финансовой информацией.
2.  Оповещение пользователя о рабочем задании с помощью всплывающего уведомления в корпоративном приложении на основе рабочего процесса.
3.  Отображение значка с количеством текущих потенциальных продаж в приложении CRM (например, Microsoft Dynamics CRM).

<h2><span class="short-header">Как работают push-уведомления</span>Как работают push-уведомления</h2>

Push-уведомления доставляются через инфраструктуры, предназначенные для конкретных платформ, называемые _системами уведомления платформ_ (PNS). PNS предоставляют только одни функции (то есть без поддержки вещания, персонализации) и не имеют общего интерфейса. Например, для отправки уведомления в приложение Магазина Windows разработчик должен обратиться в WNS (службу уведомлений Windows) для отправки уведомления на устройство iOS и тот же разработчик должен обратиться в APNS (службу push-уведомлений Apple) и отправить сообщение еще раз.

На высоком уровне, однако, все системы уведомления платформ выполняют одну и ту же процедуру:

1.  Клиентское приложение обращается к PNS для извлечения _дескриптора_. Тип дескриптора зависит от системы. Для WNS это URI или "канал уведомлений". Для APNS это маркер.
2.  Клиентское приложение хранит этот дескриптор в _серверной части_ приложения для дальнейшего использования. Для WNS серверной частью обычно является облачная служба. Для Apple эта система называется _поставщик_.
3.  Для отправки push-уведомления серверная часть приложения обращается к PNS, используя дескриптор, чтобы указать определенный экземпляр клиентского приложения.
4.  PNS перенаправляет уведомление на устройство, указанное дескриптором.

![][0]

<h2><span class="short-header">Проблемы использования push-уведомлений</span>Проблемы использования push-уведомлений</h2>

Хотя эти системы являются очень мощным средством, разработчикам приложений по-прежнему требуется прилагать много усилий для реализации даже распространенных сценариев использования push-уведомлений, например вещания или отправки push-уведомлений пользователю.

Push-уведомления являются одним из наиболее востребованных компонентов облачных служб для мобильных приложений. Это объясняется тем, что инфраструктура, необходимая для их работы, довольно сложная и обычно не связана с основной бизнес-логикой приложения. Ниже приведены некоторые из задач, стоящих перед разработчиком при создании инфраструктуры для push-уведомлений по требованию.

- **Зависимость платформы.** Для отправки уведомлений на устройства на разных платформах необходимо закодировать несколько интерфейсов в серверной части. Отличаются не только низкоуровневые детали, но и само представление уведомлений (плитка, всплывающее уведомление или значок) также зависит от платформы. Из-за этих различий может потребоваться использовать сложный и плохо поддерживаемый серверный код.

- **Масштабируемость.** Масштабирование этой инфраструктуры имеет два аспекта:
1. По инструкции PNS маркеры устройства необходимо обновлять каждый раз, когда запускается приложение. Это приводит к большому объему трафика (и последовательным обращениям к базе данных) только для обновления маркеров устройств. Когда возрастает количество устройств (возможно, до миллионов), затраты на создание и поддержку такой инфраструктуры уже нельзя игнорировать.
2.  Большинство PNS не поддерживают вещание на несколько устройств. Следовательно, вещание на миллионы устройств приведет к миллионам вызовов систем PNS. Иметь возможность масштабировать эти запросы является нетривиальной задачей, так как обычно разработчики приложений хотят сократить общую задержку (например, устройство, получающее сообщение последним, не должно получать уведомление через 30 минут после его отправки, поскольку во многих случаях это сделает push-уведомления неэффективными).
- **Маршрутизация.** Системы PNS предоставляют способ отправки сообщения на устройство. Однако в большинстве приложений уведомления направляются пользователям и/или заинтересованным группам (например, всем сотрудникам, связанным с определенной учетной записью клиента). Таким образом, чтобы направить уведомления на нужные устройства, серверная часть приложения должна поддерживать реестр, который связывает заинтересованные группы с маркерами устройств. Это увеличивает общее время выхода приложения на рынок и повышает затраты на его обслуживание.

<h2><span class="short-header">Почему следует использовать концентраторы уведомлений?</span>Почему следует использовать концентраторы уведомлений?</h2>

Концентраторы уведомлений предоставляют готовую к использованию инфраструктуру для push-уведомлений, которая поддерживает следующие моменты:

- **Несколько платформ.** Концентраторы уведомлений предоставляют общий интерфейс для отправки уведомлений на все поддерживаемые платформы. Серверная часть приложения может отправлять уведомления в форматах, которые используются для конкретной платформы, или в форматах, которые не зависят от платформы. Концентраторы уведомлений могут отправлять push-уведомления в приложения Магазина Windows, iOS, Android и Windows Phone.
- **Маршрутизация Pub/Sub.** Каждое устройство при отправке своего дескриптора в концентратор уведомлений может указать один или несколько _тегов_. Дополнительные сведения о тегах см. в следующем разделе. Заранее подготавливать или размещать теги не требуется. Теги предоставляют простой способ для отправки уведомлений пользователям или заинтересованным группам. Поскольку теги могут содержать любой идентификатор конкретного приложения (например, идентификаторы пользователя или группы), их использование освобождает серверную часть приложения от необходимости хранить дескрипторы устройств и управлять ими.
- **Масштабируемость.** Концентраторы уведомлений поддерживают масштабирование на миллионы устройств без необходимости повторного проектирования или переделки архитектуры.

Концентраторы уведомлений используют полную многоплатформенную, масштабируемую инфраструктуру для push-уведомлений и значительно сокращают количество необходимого для push-уведомлений кода, выполняющегося в серверной части приложения. Концентраторы уведомлений реализуют все функции инфраструктуры для push-уведомлений. Устройства отвечают только за регистрацию своих дескрипторов PNS, а серверная часть отвечает за отправку пользователям и заинтересованным группам сообщений, которые не зависят от платформы.

![][1]

  [0]: ./media/notification-hubs-overview/SBPushNotifications1.gif
  [1]: ./media/notification-hubs-overview/SBPushNotifications2.gif

