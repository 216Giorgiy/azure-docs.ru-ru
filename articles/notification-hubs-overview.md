<properties urlDisplayName="Azure Notification Hubs" pageTitle="Концентраторы уведомлений Azure" metaKeywords="Azure push-уведомления, концентраторы уведомлений Azure, передача сообщений Azure" description="Узнайте, как использовать push-уведомления в Azure. Примеры кода написаны на C# с использованием API .NET." metaCanonical="" disqusComments="1" umbracoNaviHide="0" title="Azure Notification Hubs" authors="sethm" manager="dwrede" />

<tags ms.service="notification-hubs" ms.workload="mobile" ms.tgt_pltfrm="mobile-multiple" ms.devlang="multiple" ms.topic="article" ms.date="09/24/2014" ms.author="sethm" />


#Концентраторы уведомлений Azure


Поддержка push-уведомлений в Azure позволяет получить доступ к простой в использовании, многоплатформенной и масштабируемой инфраструктуре для отправки push-уведомлений, которая значительно упрощает реализацию push-уведомлений как для индивидуальных пользователей, так и для корпоративных приложений для мобильных платформ.

<h2>Что такое push-уведомления?</h2>

Смартфоны и планшеты имеют способность "уведомлять" пользователей о наступлении определенных событий. В приложениях Магазина Windows в случае получения уведомления открывается так называемое _toast_: отображается немодальное окно со звуком для обозначения нового push-уведомления. На устройствах iOS Apple получение push-уведомления приводит к отображению диалогового окна, запрашивающего у пользователя просмотр или закрытие уведомления. Нажав кнопку **Просмотр**, можно открыть приложение, получившее сообщение.

Push-уведомления помогают мобильным устройствам отображать новую информацию, экономя при этом энергию. Push-уведомления являются жизненно важным компонентом приложений для потребителей, где они служат для увеличения степени вовлеченности и использования таких приложений. Уведомления также полезны для предприятий, когда обновленная информация увеличивает скорость реагирования сотрудника на бизнес-события. 

Ниже приведены некоторые конкретные примеры сценариев использования push-уведомлений в мобильных приложениях:

1.  Обновление плитки на Windows 8 и Windows Phone с текущей финансовой информацией.
2.  Оповещение пользователя о рабочем задании с помощью всплывающего уведомления в корпоративном приложении на основе рабочего процесса.
3.  Отображение значка с количеством текущих потенциальных продаж в приложении CRM (например, Microsoft Dynamics CRM).

<h2>Как работают push-уведомления</h2>

Push-уведомления доставляются через зависящую от платформы инфраструктуру PNS (Platform Notification System). PNS предоставляют только одни функции (то есть без поддержки вещания, персонализации) и не имеют общего интерфейса. Например, чтобы отправить уведомление приложению Магазина Windows, разработчик должен связаться со службой WNS (Windows Notification Service), а чтобы отправить уведомление iOS-устройству, тот же разработчик должен связаться со службой APNS (Apple Push Notification Service) и отправить сообщение повторно.

На высоком уровне, однако, все системы уведомления платформ выполняют одну и ту же процедуру:

1.  Клиентское приложение связывается с PNS, чтобы получить его _дескриптор_. Тип дескриптора зависит от системы. Для WNS это URI или "канал уведомлений". Для APNS это будет "токен".
2.  Клиентское приложение сохраняет дескриптор на серверной части приложения, чтобы использовать позже. Для WNS серверной частью обычно является облачная служба. Для Apple эта система называется _поставщиком_.
3.  Для отправки push-уведомления серверная часть приложения обращается к PNS, используя дескриптор, чтобы указать определенный экземпляр клиентского приложения.
4.  PNS перенаправляет уведомление на устройство, указанное дескриптором.

![][0]

<h2>Трудности в работе с push-уведомлениями</h2>

Хотя эти системы являются очень мощным средством, разработчикам приложений по-прежнему требуется прилагать много усилий для реализации даже распространенных сценариев использования push-уведомлений, например вещания или отправки push-уведомлений пользователю.

Push-уведомления - одна из самых часто запрашиваемых возможностей облачных служб для мобильных приложений. Это объясняется тем, что инфраструктура, необходимая для их работы, довольно сложная и обычно не связана с основной бизнес-логикой приложения. Вот примеры затруднений, возникающих при создании push-инфраструктуры, высылающей уведомления по требованию:

- **Зависимость платформы.** Для отправки уведомлений на устройства на разных платформах необходимо закодировать несколько интерфейсов в серверной части. Отличаются не только низкоуровневые детали, но и само представление уведомлений (плитка, всплывающее уведомление или значок) также зависит от платформы. Эти трудности могут привести к созданию сложного и тяжелого в поддержании кода серверной части.

- **Масштабируемость.** Масштабирование этой инфраструктуры имеет два аспекта:
1. По инструкции PNS маркеры устройства необходимо обновлять каждый раз, когда запускается приложение. Это приводит к большому объему трафика (и последовательным обращениям к базе данных) только для обновления маркеров устройств. Когда количество устройств возрастает (возможно, до миллионов), возрастает значение стоимости создания и поддержания этой инфраструктуры.
2.   Большинство PNS не поддерживают вещание на несколько устройств. Следовательно, вещание на миллионы устройств приведет к миллионам вызовов систем PNS. Реализовать способность масштабировать эти запросы - нетривиальная задача, поскольку обычно разработчики приложений хотят сохранить малое время задержки (к примеру, если последнее из получающих уведомления устройств получит его через 30 после рассылки уведомлений, это сделает бессмысленным сам принцип их получения).
- **Маршрутизация.** Системы PNS предоставляют способ отправки сообщения на устройство. Однако в большинстве приложений уведомления направляются пользователям и/или заинтересованным группам (например, всем сотрудникам, связанным с определенной учетной записью клиента). Таким образом, чтобы направить уведомления на нужные устройства, серверная часть приложения должна поддерживать реестр, который связывает заинтересованные группы с маркерами устройств. Это увеличивает время вывода приложения на рынок и затраты на его сопровождение.

<h2>Зачем использовать концентраторы уведомлений?</h2>

Концентраторы уведомлений предоставляют готовую к использованию инфраструктуру для push-уведомлений, которая поддерживает следующие моменты:

- **Несколько платформ.** Концентраторы уведомлений предоставляют общий интерфейс для отправки уведомлений на все поддерживаемые платформы. Серверная часть приложения может отправлять уведомления в форматах, которые используются для конкретной платформы, или в форматах, которые не зависят от платформы. Концентраторы уведомлений могут отправлять push-уведомления приложениям Магазина Windows, iOS, Android и Windows Phone.
- **Маршрутизация Pub/Sub.** Каждое устройство, отправляя свой дескриптор на концентратор уведомлений, может задать один или несколько _тегов_. Дополнительные сведения о тегах см. в следующем разделе. Заранее подготавливать или размещать теги не требуется. Теги предоставляют простой способ для отправки уведомлений пользователям или заинтересованным группам. Поскольку в тегах может содержаться любой зависящий от приложения идентификатор (например, идентификатор пользователя или группы), их использование освобождает приложение от необходимости хранить дескрипторы устройств и обрабатывать их.
- **Масштабируемость.** Концентраторы уведомлений поддерживают масштабирование на миллионы устройств без необходимости повторного проектирования или переделки архитектуры.

В концентраторах уведомлений используется полная многоплатформенная, масштабируемая инфраструктура для push-уведомлений, они значительно снижают объем кода для push-уведомлений, работающего в приложении на устройстве. Концентраторы уведомлений реализуют все функции инфраструктуры для push-уведомлений. Устройству остается лишь зарегистрировать свои дескрипторы PNS, а приложению - отправить зависящие от платформы сообщения пользователям или группам пользователей.

![][1]

## Дальнейшие действия

Дополнительные сведения о концентраторах уведомлений можно найти в следующих статьях:

+ **[Как концентраторы уведомлений используются клиентами]**

+ **[Руководства и учебники по концентраторам уведомлений]** 

+ **Начало работы с концентраторами уведомлений** ([iOS], [Android], [Windows Universal], [Windows Phone], [Kindle], [Xamarin.iOS], [Xamarin.Android])

Соответствующие управляемые API-ссылки .NET на push-уведомления приведены ниже.

+ [Концентратор.уведомлений.для.обмена.сообщениями.Мicrosoft.WindowsAzure]
+ [Microsoft.ServiceBus.Notifications] 


  [0]: ./media/notification-hubs-overview/SBPushNotifications1.gif
  [1]: ./media/notification-hubs-overview/SBPushNotifications2.gif
  [Как концентраторы уведомлений используются клиентами]: http://azure.microsoft.com/ru-ru/services/notification-hubs
  [Учебники и руководства по работе с концентраторами уведомлений]: http://azure.microsoft.com/ru-ru/documentation/services/notification-hubs
  [iOS]: http://azure.microsoft.com/ru-ru/documentation/articles/notification-hubs-ios-get-started
  [Android]: http://azure.microsoft.com/ru-ru/documentation/articles/notification-hubs-android-get-started
  [Windows Universal]: http://azure.microsoft.com/ru-ru/documentation/articles/notification-hubs-windows-store-dotnet-get-started
  [Windows Phone]: http://azure.microsoft.com/ru-ru/documentation/articles/notification-hubs-windows-phone-get-started
  [Kindle]: http://azure.microsoft.com/ru-ru/documentation/articles/notification-hubs-kindle-get-started
  [Xamarin.iOS]: http://azure.microsoft.com/ru-ru/documentation/articles/partner-xamarin-notification-hubs-ios-get-started
  [Xamarin.Android]: http://azure.microsoft.com/ru-ru/documentation/articles/partner-xamarin-notification-hubs-android-get-started
  [Концентратор.уведомлений.для.обмена.сообщениями.Мicrosoft.WindowsAzure]: http://msdn.microsoft.com/ru-ru/library/microsoft.windowsazure.messaging.notificationhub.aspx
  [Уведомления.Мicrosoft.ServiceBus]: http://msdn.microsoft.com/ru-ru/library/microsoft.servicebus.notifications.aspx
  
