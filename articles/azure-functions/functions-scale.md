---
title: "Выбор плана размещения Функций Azure | Документация Майкрософт"
description: "Узнайте, как Функции Azure масштабируются в соответствии с потребностями непостоянных рабочих нагрузок."
services: functions
documentationcenter: na
author: dariagrigoriu
manager: erikre
editor: 
tags: 
keywords: "функции azure, функции, обработка событий, веб-перехватчики, динамические вычисления, независимая архитектура"
ms.assetid: 5b63649c-ec7f-4564-b168-e0a74cb7e0f3
ms.service: functions
ms.devlang: multiple
ms.topic: reference
ms.tgt_pltfrm: multiple
ms.workload: na
ms.date: 02/27/2017
ms.author: dariagrigoriu, glenga
ms.custom: H1Hack27Feb2017
translationtype: Human Translation
ms.sourcegitcommit: 1e6ae31b3ef2d9baf578b199233e61936aa3528e
ms.openlocfilehash: f4d589382fe337549f117e7c03af6fd5e237491f
ms.lasthandoff: 03/03/2017


---
# <a name="choose-the-correct-service-plan-for-azure-functions"></a>Выбор правильного плана обслуживания для Функций Azure

## <a name="introduction"></a>Введение

В Функциях Azure имеются два разных плана обслуживания: план потребления и план службы приложений. План потребления автоматически выделяет вычислительные ресурсы в процессе выполнения кода, масштабируя их в соответствии с нагрузкой и освобождая, когда код не выполняется. Это означает, что вы не платите за неактивные виртуальные машины и вам не нужно резервировать емкость на всякий случай. Эта статья посвящена плану обслуживания на основе потребления. Дополнительную информацию о том, как действует план службы приложений, см. в статье [Подробный обзор планов службы приложений Azure](../app-service/azure-web-sites-web-hosting-plans-in-depth-overview.md). 

Если вы еще не знакомы с Функциями Azure, см. статью [Обзор функций Azure](functions-overview.md).

## <a name="service-plan-options"></a>Параметры плана обслуживания

При создании приложения-функции необходимо настроить план размещения для функций, содержащихся в приложении. Доступные планы размещения: **план потребления** и [план службы приложений](../app-service/azure-web-sites-web-hosting-plans-in-depth-overview.md). Сейчас этот выбор необходимо делать во время создания приложения-функции. Изменить свой выбор после создания невозможно. В [плане службы приложений](../app-service/azure-web-sites-web-hosting-plans-in-depth-overview.md) можно выполнять масштабирование между уровнями. Для плана потребления сейчас никакие изменения не поддерживаются, так как масштабирование является динамическим.

### <a name="consumption-plan"></a>План потребления

В **плане потребления** приложения-функции назначаются экземпляру обработки. При необходимости экземпляры добавляются или удаляются динамически. Более того, ваши функции будут выполняться параллельно, сводя к минимуму общее время, необходимое для обработки запросов. Время выполнения функций объединяется по содержащему их приложению-функции. Стоимость зависит от объема памяти и общего времени выполнения всех функций в приложении-функции (в гигабайтах на секунду). Это очень удобно, когда вычисления требуются только время от времени или время ожидания заданий очень короткое, так как позволяет платить только за вычислительные ресурсы, когда они действительно используются. В следующем разделе приведены сведения о том, как работает план потребления.

### <a name="app-service-plan"></a>План службы приложений

Если используется **план службы приложений**, то приложения-функции выполняются на выделенных виртуальных машинах, так же как веб-приложения для SKU уровня "Базовый", "Стандартный" или "Премиум". Выделенные виртуальные машины назначаются вашим приложениям службы приложений и приложениям-функциям и всегда доступны вне зависимости от наличия активно выполняемого кода. Это хороший вариант в том случае, если у вас уже есть недозагруженные виртуальные машины, на которых выполняется другой код, или если вы планируете выполнять функции непрерывно или почти непрерывно. При использовании виртуальной машины затраты не зависят от времени выполнения и размера памяти. Это позволяет ограничить затраты на многие функции длительного выполнения до стоимости нескольких виртуальных машин, на которых они выполняются. Дополнительную информацию о том, как действует план службы приложений, см. в статье [Подробный обзор планов службы приложений Azure](../app-service/azure-web-sites-web-hosting-plans-in-depth-overview.md). 

## <a name="how-the-consumption-plan-works"></a>Как работает план потребления

План потребления автоматически масштабирует ресурсы ЦП и памяти путем добавления дополнительных экземпляров обработки в зависимости от потребностей среды выполнения функций в приложении-функции. Для каждого экземпляра обработки приложения-функции выделяется память объемом до 1,5 ГБ.

Если при использовании плана потребления приложение-функция становится неактивной, то обработка новых больших двоичных объектов может осуществляться с задержкой до 10 минут. После запуска приложения-функции большие двоичные объекты обрабатываются быстрее. Чтобы избежать этой начальной задержки, используйте обычный план службы приложений с включенной функцией AlwaysOn или другой механизм для активации обработки, например постановку в очередь сообщения, содержащего имя большого двоичного объекта. 

При создании приложения-функции необходимо создать или привязать учетную запись хранения Azure общего назначения, поддерживающую хранилища BLOB-объектов, очередей и таблиц. Для внутренних операций, таких как управление триггерами и ведение журнала выполнения функций, Функции Azure используют службу хранилища Azure. Некоторые учетные записи хранения не поддерживают очереди и таблицы. Например, это относится к учетным записям хранения только для больших двоичных объектов (включая хранилище уровня "Премиум") и учетным записям хранения общего назначения с репликацией ZRS. Эти учетные записи будут отфильтрованы из колонки "Учетная запись хранения" при создании нового приложения-функции.

При использовании плана потребления содержимое приложения-функции (например, файлы кода функций и конфигурации привязки) хранится в файловых ресурсах Azure в основной учетной записи хранения. При удалении основной учетной записи хранения это содержимое будет удалено без возможности восстановления.

Чтобы узнать больше о типах учетных записей хранения, ознакомьтесь с разделом [Введение в службы хранилища Azure] (../storage/storage-introduction.md#introducing-the-azure-storage-services).

### <a name="runtime-scaling"></a>Масштабирование среды выполнения

Для оценки вычислительных потребностей в зависимости от настроенных триггеров и для принятия решения о развертывании или свертывании в Функциях Azure используется центральный прослушиватель. Он постоянно обрабатывает подсказки о требованиях к памяти и точках данных триггеров. Например, для триггера хранилища очередей Azure точки данных содержат сведения о длине очереди и времени ожидания для самой старой записи.

![](./media/functions-scale/central-listener.png)

Единицей масштабирования является приложение-функция. В этом случае развертывание подразумевает добавление нескольких экземпляров приложения-функции. И наоборот, когда потребность в вычислительных ресурсах уменьшается, экземпляры функции-приложения удаляются. Если никакие вычисления не выполняются, то число экземпляров в конечном итоге сократится до нуля. 

### <a name="billing-model"></a>Модель выставления счетов

Выставление счетов для плана потребления подробно описано на [странице цен на Функции Azure](https://azure.microsoft.com/pricing/details/functions). Учитывается использование для каждого приложения-функции только за время выполнения кода. Счета выставляются по следующим единицам: 
* **потребление ресурсов в ГБ/с (гигабайт на секунду)** вычисляется как сочетание объема памяти и времени выполнения для всех функций, выполняемых в приложении-функции; 
* **выполнения** вычисляются при каждом выполнении функции в ответ на событие, активированное привязкой.

