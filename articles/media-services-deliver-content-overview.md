<properties 
	pageTitle="Обзор доставки содержимого клиентам" 
	description="В этом разделе представлен обзор доставки содержимого с помощью служб мультимедиа Azure." 
	services="media-services" 
	documentationCenter="" 
	authors="Juliako" 
	manager="dwrede" 
	editor=""/>

<tags 
	ms.service="media-services" 
	ms.workload="media" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="04/08/2015" 
	ms.author="juliako"/>


#Обзор доставки содержимого клиентам

##Обзор

При работе со службами мультимедиа распространен следующий сценарий:

1. Передача входного файла (мезонинного файла) в ресурс. Например H.264, MP4 или WMV.
1. Кодирование ресурса в набор MP4-файлов с адаптивным битрейтом.
1. Публикация ресурса. 
2. Использование [динамической упаковки](http://msdn.microsoft.com/library/azure/jj889436.aspx) для доставки содержимого клиентам в любом из следующих форматов: MPEG DASH, Apple HLS или Smooth Streaming. 

В этом разделе представлен обзор основных [понятий](media-services-deliver-content.md#concepts) и ссылки на разделы, в которых описывается выполнение связанных [задач доставки содержимого](media-services-deliver-content.md#tasks).

##<a id="concepts"></a>Основные понятия

Ниже приводятся полезные термины и понятия, используемые при доставке мультимедиа.

###Указатели

Чтобы предоставить пользователю URL-адрес для потоковой передачи или загрузки содержимого, сначала необходимо "опубликовать" ресурс, создав указатель.  Указатели предоставляют точку входа для доступа к файлам, содержащимся в ресурсе. Службы мультимедиа поддерживают два типа указателей: 

- **Указатели OnDemandOrigin**, используемые для потоковой передачи мультимедиа (например, MPEG DASH, HLS или Smooth Streaming) или последовательной загрузки файлов.
-  **Указатели SAS** URL-адреса (подписи доступа), используемые для скачивания файлов мультимедиа на локальный компьютер.

**Политика доступа** используется для определения разрешений (например, для чтения, записи и перечисления) и длительности доступа клиента к определенному ресурсу. Обратите внимание, что разрешение списка (AccessPermissions.List) не следует использовать при создании указателя OrDemandOrigin.

Указатели имеют срок действия. При использовании портала для публикации ресурсов создаются указатели со сроком действия 100 лет. 

>[AZURE.NOTE] Если вы использовали портал для создания указателей до марта 2015 г., были созданы указатели со сроком действия два года.  

Чтобы обновить срок действия указателя, используйте API-интерфейсы [REST](http://msdn.microsoft.com/library/azure/hh974308.aspx#update_a_locator ) или [.NET](http://go.microsoft.com/fwlink/?LinkID=533259). Обратите внимание, что при обновлении срока действия указателя SAS URL-адрес изменяется. 
 
Указатели не предназначены для управления доступом на уровне пользователей. Для предоставления различных прав доступа отдельным пользователям используйте решения для управления цифровыми правами (DRM). Дополнительные сведения см. в разделе [Защита мультимедиа](http://msdn.microsoft.com/library/azure/dn282272.aspx).

Обратите внимание, что при создании указателя может возникать 30-секундная задержка из-за необходимых процессов сохранения и распространения в хранилище Azure.


###Адаптивная потоковая передача 

Технологии передачи с адаптивной скоростью позволяют видеопроигрывателю определять условия работы сети и выбрать одну из нескольких скоростей потока (битрейтов). Если условия в сети ухудшаются, клиент может выбрать более низкую скорость, позволяя видеопроигрывателю продолжать воспроизводить видео в более низком качестве. Если состояние в сети улучшается, то клиент может переключиться на более высокий битрейт с более высоким качеством видео. Службы мультимедиа Azure поддерживают следующие технологии потоковой передачи с переменным битрейтом: HTTP Live Streaming (HLS), Smooth Streaming, MPEG DASH и HDS.

Чтобы предоставить пользователям URL-адреса потоковой передачи, сначала необходимо создать указатель OnDemandOrigin. При создании указателя вы получите базовое значение Path для ресурса, который содержит контент для потоковой передачи. Однако, чтобы получить возможность потоковой передачи контента, необходимо изменить этот путь. Чтобы создать полный URL-адрес к файлу манифеста потоковой передачи, необходимо соединить значение Path указателя и имя файла манифеста (filename.ism). Затем добавьте /Manifest и соответствующий формат (если нужно) в путь указателя источника. 

Также по SSL-соединению можно выполнять потоковую передачу содержимого. Для этого убедитесь, что URL-адреса потоковой передачи начинаются с HTTPS. 

Обратите внимание, что потоковую передачу через SSL-соединение можно выполнять, только если конечная точка потоковой передачи, из которой получено содержимое, была создана после 10 сентября 2014 г. Если URL-адреса потоковой передачи основаны на конечных точках потоковой передачи, созданных после 10 сентября, URL-адрес содержит "streaming.mediaservices.windows.net" (новый формат). URL-адреса потоковой передачи, который содержат "origin.mediaservices.windows.net" (старый формат), не поддерживают SSL. Если URL-адрес имеет старый формат и необходимо организовать передачу через SSL, нужно создать новую конечную точку. Используйте URL-адреса, созданные на основе новой конечной точки потоковой передачи, для потоковой передачи содержимого по SSL. 


####Форматы URL-адресов потоковой передачи:

**Формат Smooth Streaming**

{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest

Пример:

	http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest


**Формат MPEG DASH**

{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=mpd-time-csf) 

Пример

	http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=mpd-time-csf)

**Формат Apple HTTP Live Streaming (HLS) V4**

{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl)

	http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl)

**Формат Apple HTTP Live Streaming (HLS) V3**

{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl-v3)
	
	http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=m3u8-aapl-v3)

**HDS (только для лицензиатов Adobe PrimeTime/Access)**

{streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=f4m-f4f)

	http://testendpoint-testaccount.streaming.mediaservices.windows.net/fecebb23-46f6-490d-8b70-203e86b0df58/BigBuckBunny.ism/Manifest(format=f4m-f4f)


###Динамическая упаковка

Службы мультимедиа обеспечивают динамическую упаковку, которая позволяет доставлять закодированное содержимое MP4-файлов с адаптивным битрейтом или Smooth Streaming в форматах потоковой передачи с поддержкой служб мультимедиа (MPEG DASH, HLS, Smooth Streaming, HDS) без необходимости повторной упаковки в эти форматы потоковой передачи. 

Чтобы воспользоваться преимуществом динамической упаковки, необходимо выполнить следующие действия:

- Закодируйте мезонинный (исходный) файл в набор MP4-файлов с адаптивным битрейтом или в набор файлов Smooth Streaming.
- Получите по крайней мере одну единицу потоковой передачи по запросу для конечной точки потоковой передачи, из которой планируется доставлять содержимое. Дополнительные сведения см. в разделе [Масштабирование зарезервированных единиц потоковой передачи по запросу](media-services-manage-origins.md#scale_streaming_endpoints/).

С динамической упаковкой потребуется хранить и оплачивать файлы только в одном формате хранения, а службы мультимедиа выполнят сборку и будут обслуживать соответствующий ответ на основе запросов клиента. 

Обратите внимание, что кроме возможности использовать динамическую упаковку, зарезервированные единицы потоковой передачи по запросу обеспечивают выделенную выходную пропускную способность, которую можно приобрести с шагом 200 Мбит/с. По умолчанию потоковая передача по требованию настроена в модели общего экземпляра, для которой серверные ресурсы (например, вычислительные ресурсы, мощности исходящего трафика и т. д.) совместно используются со всеми другими пользователями. Чтобы повысить производительность потоковой передачи по требованию, рекомендуется приобретать зарезервированные единицы потоковой передачи по требованию.

###Прогрессивное скачивание 

Прогрессивное скачивание позволяет начать воспроизведение мультимедиа до окончания скачивания всего файла. ISMV-, ISMA-, ISMT- и ISMC-файлы не могут быть загружены последовательно. 

Для последовательной загрузки содержимого используйте тип указателя OnDemandOrigin. В следующем примере показан URL-адрес, основанный на типе указателя OnDemandOrigin.

	http://amstest1.streaming.mediaservices.windows.net/3c5fe676-199c-4620-9b03-ba014900f214/BigBuckBunny_H264_650kbps_AAC_und_ch2_96kbps.mp4

Действительны следующие условия.

- Необходимо расшифровать все зашифрованные в хранилище ресурсы, которые требуется передать из исходной службы для последовательной загрузки.


###Скачивание

Для скачивания содержимого на клиентское устройство необходимо создать указатель SAS. Указатель SAS предоставляет доступ к контейнеру хранилища Azure, где расположен ваш файл. Чтобы создать URL-адрес загрузки, необходимо вставить имя файла между узлом и подписью SAS. 

В следующем примере показан URL-адрес, основанный на типе указателя SAS.

	https://test001.blob.core.windows.net/asset-ca7a4c3f-9eb5-4fd8-a898-459cb17761bd/BigBuckBunny.mp4?sv=2012-02-12&se=2014-05-03T01%3A23%3A50Z&sr=c&si=7c093e7c-7dab-45b4-beb4-2bfdff764bb5&sig=msEHP90c6JHXEOtTyIWqD7xio91GtVg0UIzjdpFscHk%3D

Действительны следующие условия.

- Необходимо расшифровать все зашифрованные в хранилище ресурсы, которые требуется передать из исходной службы для последовательной загрузки.
- Процесс загрузки, не завершенный в течение 12 часов, завершается ошибкой.



###Конечные точки потоковой передачи

**Конечная точка потоковой передачи** - это служба потоковой передачи, которая может доставить содержимое непосредственно в клиентское приложение проигрывателя или в сеть доставки содержимого (CDN) для дальнейшего распространения. Исходящим потоком службы конечной точки потоковой передачи может быть ресурс динамического потока или видео по запросу в учетной записи служб мультимедиа. Кроме того, чтобы справиться с растущими потребностями в пропускной способности, можно контролировать мощности службы конечной точки потоковой передачи, регулируя число зарезервированных единиц потоковой передачи. Необходимо выделить хотя бы одну зарезервированную единицу для приложений в рабочей среде. Дополнительную информацию см. в разделе [Масштабирование службы мультимедиа](media-services-manage-origins.md#scale_streaming_endpoints).

##<a id="tasks"></a>Задачи, связанные с доставкой ресурсов

###Настройка политики доставки ресурсов

Настройте политики доставки ресурсов с помощью **.NET** или **REST API**.

[AZURE.INCLUDE [media-services-selector-asset-delivery-policy](../includes/media-services-selector-asset-delivery-policy.md)]

###Публикация ресурсов

Опубликуйте ресурсы (создав указатели) с помощью **портала управления Azure** или **.NET**.

[AZURE.INCLUDE [media-services-selector-publish](../includes/media-services-selector-publish.md)]


##Связанные разделы

[Обновление указателей служб мультимедиа после отката ключей хранилища](media-services-roll-storage-access-keys.md)


<!--HONumber=52-->