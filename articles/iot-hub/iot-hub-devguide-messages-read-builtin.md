---
title: Общие сведения о встроенной конечной точке Центра Интернета вещей Azure | Документация Майкрософт
description: В этом руководстве разработчика описано, как читать сообщения, отправляемые с устройства в облако, с помощью встроенной конечной точки, совместимой с концентратором событий.
author: dominicbetts
manager: timlt
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 07/18/2018
ms.author: dobett
ms.openlocfilehash: 02ea4b94f8d1442360bebb36fdbba13d973f8555
ms.sourcegitcommit: da3459aca32dcdbf6a63ae9186d2ad2ca2295893
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2018
ms.locfileid: "51242421"
---
# <a name="read-device-to-cloud-messages-from-the-built-in-endpoint"></a>Чтение сообщений, пересылаемых с устройства в облако, из встроенной конечной точки

По умолчанию сообщения направляются во встроенную конечную точку, доступную для службы (**/messages/events**), которая совместима с [Центрами событий](https://azure.microsoft.com/documentation/services/event-hubs/
). Сейчас эта конечная точка предоставляется только по протоколу [AMQP](https://www.amqp.org/) на порте 5671. Центр Интернета вещей позволяет управлять встроенной конечной точкой обмена сообщениями **messages/events**, совместимой с концентраторами событий, с помощью приведенных ниже свойств.

| Свойство            | ОПИСАНИЕ |
| ------------------- | ----------- |
| **Количество секций** | Это свойство задается во время создания, чтобы определить количество [разделов](../event-hubs/event-hubs-features.md#partitions) для приема событий, отправляемых с устройства в облако. |
| **Время хранения**  | Это свойство задает время в днях, в течение которого сообщения хранятся в Центре Интернета вещей. Значение по умолчанию — один день, но это значение можно увеличить до семи дней. |

Центр Интернета вещей также предоставляет возможность управлять группами потребителей во встроенной конечной точке, которая получает сообщения, отправляемые с устройства в облако.

Если вы используете [маршрутизацию сообщений](iot-hub-devguide-messages-d2c.md) и включен [резервный маршрут](iot-hub-devguide-messages-d2c.md#fallback-route), все сообщения, которые не соответствуют запросу на любом маршруте, записываются во встроенную конечную точку. Если отключить этот резервный маршрут, то сообщения, которые не соответствуют запросу, будут удаляться.

Период хранения можно изменить на [портале Azure](https://portal.azure.com) или программно (с помощью [интерфейсов REST API поставщика ресурсов Центра Интернета вещей](/rest/api/iothub/iothubresource)).

Центр Интернета вещей предоставляет встроенную конечную точку **messages/events**, с помощью которой внутренние службы считывают сообщения, отправляемые в Центр с устройства в облако. Эта конечная точка совместима с концентраторами событий, поэтому можно использовать любой из механизмов для чтения сообщений, который поддерживает служба "Центры событий".

## <a name="read-from-the-built-in-endpoint"></a>Считывание данных из встроенной конечной точки

При использовании [пакета SDK служебной шины Azure для .NET](https://www.nuget.org/packages/WindowsAzure.ServiceBus) или [Центров событий и узла обработчика событий](..//event-hubs/event-hubs-dotnet-standard-getstarted-receive-eph.md) можно использовать любые строки подключения к Центру Интернета вещей с нужными разрешениями. А затем использовать **messages/events** в качестве имени концентратора событий.

При использовании пакетов SDK (или интеграции продуктов), которые не поддерживают Центр Интернета вещей, следует получить совместимые с концентраторами событий конечную точку и имя:

1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к своему Центру Интернета вещей.

2. Щелкните **Встроенные конечные точки**.

3. Раздел **События** содержит следующие значения: **Event Hub-compatible endpoint** (Конечная точка, совместимая с центрами событий), **Event Hub-compatible name** (Имя, совместимое с центрами событий), **Разделы**, **Время хранения** и **Группы потребителей**.

    ![Параметры отправки сообщений с устройства в облако](./media/iot-hub-devguide-messages-read-builtin/eventhubcompatible.png)

Для пакета SDK для Центра Интернета вещей требуется указать конечную точку Центра Интернета вещей. Это точка **messages/events**, как показано в разделе **Конечные точки**.

Если для используемого пакета SDK требуется указать **имя узла** или **пространство имен**, то удалите схему из **конечной точки, совместимой с концентраторами событий**. Например, если конечная точка, совместимая с концентратором событий, — **sb://iothub-ns-myiothub-1234.servicebus.windows.net/**, то **именем узла** будет **iothub-ns-myiothub-1234.servicebus.windows.net**. Значением для **пространства имен** будет **iothub-ns-myiothub-1234**.

Затем можно использовать любую политику общего доступа с разрешениями **ServiceConnect**, которые позволяют подключаться к указанному концентратору событий.

Если нужно создать строку подключения к концентратору событий с помощью указанных выше сведений, можно использовать следующий образец:

`Endpoint={Event Hub-compatible endpoint};SharedAccessKeyName={iot hub policy name};SharedAccessKey={iot hub policy key}`

Ниже приведен список пакетов SDK и интеграций, которые можно применять к совместимым с концентраторами событий конечным точкам, которые предоставляет Центр Интернета вещей:

* [клиент Центров событий Java;](https://github.com/Azure/azure-event-hubs-java)
* [Воронка Apache Storm](../hdinsight/storm/apache-storm-develop-csharp-event-hub-topology.md). Вы можете просмотреть [источник воронки](https://github.com/apache/storm/tree/master/external/storm-eventhubs) на портале GitHub.
* [интеграция Apache Spark.](../hdinsight/spark/apache-spark-eventhub-streaming.md)

## <a name="next-steps"></a>Дополнительная информация

* Дополнительные сведения о конечных точках Центра Интернета вещей см. в статье [Руководство. Конечные точки Центра Интернета вещей](iot-hub-devguide-endpoints.md).

* В [кратких руководствах](quickstart-send-telemetry-node.md) рассказывается, как отправлять сообщения с имитированных устройств в облако и читать их из встроенной конечной точки. 

Дополнительные сведения см. в руководстве [Настройка маршрутизации сообщений с Центром Интернета вещей](tutorial-routing.md).

* Сведения о перенаправлении сообщений, отправляемых с устройства в облако, на пользовательские конечные точки см. в статье [Использование правил маршрутизации и пользовательских конечных точек для сообщений, отправляемых с устройства в облако](iot-hub-devguide-messages-read-custom.md).