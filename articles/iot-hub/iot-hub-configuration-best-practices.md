---
title: Рекомендации по настройке устройств для Центра Интернета вещей | Документация Майкрософт
description: Рекомендации по настройке устройств Интернета вещей в масштабе
author: chrisgre
manager: briz
ms.author: chrisgre
ms.date: 06/24/2018
ms.topic: conceptual
ms.service: iot-hub
services: iot-hub
ms.openlocfilehash: 7314c5ec05bec61e5bbbc406b6a39a7c5a8f011f
ms.sourcegitcommit: 150a40d8ba2beaf9e22b6feff414f8298a8ef868
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2018
ms.locfileid: "37035209"
---
# <a name="best-practices-for-device-configuration-within-an-iot-solution"></a>Рекомендации по настройке устройств в рамках решения Интернета вещей

Автоматическое управление устройствами в Центре Интернета вещей Azure позволяет автоматизировать многие повторяющиеся и сложные задачи управления для большого количества устройств на протяжении их жизненного цикла. В этой статье описаны многие из лучших методик для различных ролей, связанных с разработкой и использованием решений Интернета вещей.

* **Изготовитель или интегратор оборудования Интернета вещей.** Это изготовители оборудования Интернета вещей, интеграторы оборудования, которые собирают оборудование различных изготовителей, или поставщики оборудования, которые предоставляют оборудование для развертывания Интернета вещей, изготовленное или интегрированное другими поставщиками. Участие в разработке и интеграции встроенных программ, встроенных операционных систем и программного обеспечения.
* **Разработчик решений Интернета вещей.** Разработка решения Интернета вещей обычно осуществляется разработчиком решений. Этот разработчик может входить в команду внутри компании или быть системным интегратором, специализирующимся на данной деятельности. Разработчик решений Интернета вещей может с нуля разработать различные компоненты решения Интернета вещей, интегрировать разные стандарты или компоненты с открытым кодом и настраивать [ускоритель решений Центра Интернета вещей][lnk-solution].
* **Оператор решений Интернета вещей.** После развертывания используемое решение Интернета вещей требует долгосрочного мониторинга, установки обновлений и обслуживания. Эти задачи может выполнять команда внутри компании, в которую входят специалисты по информационным технологиям, группы по эксплуатации и обслуживанию оборудования, а также специалисты в определенной области, которые следят за работой всей инфраструктуры Интернета вещей.

## <a name="understand-automatic-device-management-for-configuring-iot-devices-at-scale"></a>Понимание автоматического управления устройством для настройки устройств Интернета вещей в масштабе

Автоматическое управление устройством включает в себя множество преимуществ, связанных с [двойниками устройств][lnk-device-twins] и [двойниками модулей][lnk-module-twins], для синхронизации требуемых и сообщаемых состояний между облаком и устройствами.  [Автоматическая конфигурация устройств][lnk-auto-device-config] автоматически обновляет большие наборы двойников и сообщает о ходе выполнения и состоянии соответствия. Ниже приведены основные действия по разработке и использованию автоматического управления устройствами.

* **Производитель или интегратор аппаратного обеспечения Интернета вещей** реализует функции управления устройствами во встроенном приложении с использованием [двойников устройств][lnk-device-twins]. Эти функции могут включать в себя обновления встроенного ПО, установку и обновление программного обеспечения и управление настройками.
* **Разработчик решения Интернета вещей** реализует уровень управления операций администрирования устройства с помощью [двойников устройств][lnk-device-twins] и [автоматических конфигураций устройств][lnk-auto-device-config]. Решение должно включать определение интерфейса оператора для выполнения задач управления устройством.
* **Оператор решения Интернета вещей** использует решение Интернета вещей для выполнения задач управления устройством, в частности для группирования устройств, инициирования изменений конфигурации, таких как обновления встроенного ПО, отслеживание хода выполнения и устранение возникающих проблем.

## <a name="iot-hardware-manufacturerintegrator"></a>Производитель или интегратор оборудования IoT

Ниже приведены лучшие методики для производителей и интеграторов оборудования, занимающихся разработкой встроенных программ.

* **Реализация [двойников устройств][lnk-device-twins].** Двойники устройств позволяют синхронизировать желаемую конфигурацию из облака и сообщать текущую конфигурацию и свойства устройства.  Лучший способ реализовать двойники устройств во встроенных приложениях — использовать [пакеты SDK для Azure IoT][lnk-azure-sdk].  Двойники устройств лучше всего подходят для конфигурации, потому что они: а) поддерживают двунаправленную связь; б) разрешают как подключенные, так и отключенные состояния устройств; в) следуют принципу итоговой согласованности; г) полностью запрашиваемые в облаке.
* **Структурирование двойника устройства для управления устройством.** Двойник устройства должен быть структурирован таким образом, чтобы свойства управления устройством были логически сгруппированы в разделы. В этом случае изменения конфигурации могут быть изолированы, не влияя на другие части двойника. Например, создайте раздел в пределах требуемых свойств для встроенного ПО, второй раздел для программного обеспечения и третий раздел для сетевых параметров. 
* **Сообщение атрибутов устройства, которые полезны для управления устройством.** Атрибуты, такие как сборка и модель физического устройства, встроенное ПО, операционная система, серийный номер и другие идентификаторы, полезны для отчетов и в качестве параметров для изменений конфигурации.
* **Определение основных состояний для отправки отчетов о состоянии и процессе выполнения.** Должны быть перечислены состояния верхнего уровня, чтобы их можно было сообщить оператору. Например, при обновлении встроенного ПО может сообщаться состояние "Текущее", "Загрузка", "Применение", "Выполняется" или "Ошибка".  Определите дополнительные поля для получения сведений о каждом состоянии.  

## <a name="iot-solution-developer"></a>Разработчик решений IoT

Ниже перечислены рекомендации для разработчиков решений Интернета вещей, которые создают системы на основе Azure.

* **Реализация [двойников устройств][lnk-device-twins].** Двойники устройств позволяют синхронизировать желаемую конфигурацию из облака и сообщать текущую конфигурацию и свойства устройства.  Лучший способ реализовать двойники устройств в облачных решениях — использовать [пакеты SDK для Azure IoT][lnk-azure-sdk].  Двойники устройств лучше всего подходят для конфигурации, потому что они: а) поддерживают двунаправленную связь; б) разрешают как подключенные, так и отключенные состояния устройств; в) следуют принципу итоговой согласованности; г) полностью запрашиваемые в облаке.
* **Организация устройств с помощью тегов двойников устройств.** Решение должно позволить оператору определять качественные круги или другие наборы устройств на основе различных стратегий развертывания, таких как ранний выпуск. Организация устройств может быть реализована в вашем решении с использованием тегов двойников устройств и [запросов][lnk-queries].  Организация устройств необходима для обеспечения надежной и точной настройки развертывания конфигурации.
* **Реализация [автоматических конфигураций устройств][lnk-auto-device-config].** Автоматические конфигурации устройств развертывают и отслеживают изменения конфигурации в больших наборах устройств Интернета вещей с использованием двойников устройств.  Автоматические конфигурации устройств определяют наборы двойников устройств с помощью **целевого состояния**, которое является запросом к тегам двойников устройств или сообщаемым свойствам. **Целевое содержимое** — это набор требуемых свойств, который будет установлен в указанных двойниках устройств. Целевое содержимое должно соответствовать структуре двойников устройств, определяемой изготовителем оборудования Центра Интернета вещей или интегратором.  **Метрики** — это запросы к сообщаемым свойствам двойников устройств, которые должны совпадать со структурой двойника устройства, определенной производителем или интегратором оборудования Центра Интернета вещей. Автоматические конфигурации устройств также имеют преимущество Центра Интернета вещей, который выполняет операции с двойниками устройств со скоростью, которая никогда не будет превышать [пределы регулирования][lnk-throttling] для считываний и обновлений двойников устройств.
* **Использование [службы подготовки устройств][lnk-dps].** Разработчики решений должны использовать службу подготовки устройств для назначения тегов двойников устройств новым устройствам, чтобы они автоматически настраивались с помощью **автоматических конфигураций устройств**, предназначенных для двойников с этим тегом. 

## <a name="iot-solution-operator"></a>Оператор решений IoT

Ниже приведены лучшие методики для операторов решений Интернета вещей, которые используют решение Интернета вещей на основе Azure.

* **Организация устройств для управления.** Решение Интернета вещей должно определять или разрешать создание качественных кругов или других наборов устройств на основе различных стратегий развертывания, таких как ранний выпуск. Наборы устройств будут использоваться для развертывания изменений конфигурации и выполнения других операций управления масштабируемыми устройствами.
* **Выполнение изменений конфигурации с использованием поэтапного развертывания.** Поэтапное развертывание — это общий процесс, с помощью которого оператор развертывает изменения в расширенном наборе устройств Интернета вещей. Цель этого развертывания — постепенно вносить изменения, чтобы уменьшить риск глобальных критических изменений.  Оператор должен использовать интерфейс решения для создания [автоматической конфигурации устройств][lnk-auto-device-config], а условие назначения должно быть нацелено на исходный набор устройств (например, группа раннего выпуска).  Затем оператор должен проверить изменение конфигурации в исходном наборе устройств.  После завершения проверки оператор обновит автоматическую конфигурацию устройства, чтобы включить в нее более широкий набор устройств. Оператор также должен установить более высокий приоритет для этой конфигурации, чем у других конфигураций, предназначенных для этих устройств.  Развертыванием можно управлять, используя метрики, сообщаемые автоматической конфигурацией устройства. 
* **Выполнение откатов в случае ошибок или неправильных конфигураций.** Автоматическую конфигурацию устройства, которая вызывает ошибки или неправильные конфигурации, можно отменить, изменив **условие назначения**, чтобы устройства больше не соответствовали ему.  Убедитесь, что другая конфигурация устройства с более низким приоритетом по-прежнему предназначена для этих устройств.  Убедитесь, что откат удался, просмотрев метрики. Конфигурация отката не должна отображать состояние нецелевых устройств, а метрики второй конфигурации теперь должны включать количество устройств, которые продолжают быть целевыми.


## <a name="next-steps"></a>Дополнительная информация

* Руководство по реализации двойников устройств см. в статье [Общие сведения о двойниках устройств и их использование в Центре Интернета вещей][lnk-device-twins].
* Дополнительные сведения о создании, обновлении и удалении автоматической конфигурации устройства см. в статье [Настройка и мониторинг устройств Центра Интернета вещей в масштабе (предварительная версия)][lnk-auto-device-config].
* Сведения о реализации шаблона обновления встроенного ПО с использованием двойников устройств и автоматических конфигураций устройств см. в статье [Руководство по реализации процесса обновления встроенного ПО устройств][lnk-firmware-update].

<!-- Links -->
[lnk-device-twins]: iot-hub-devguide-device-twins.md
[lnk-module-twins]: iot-hub-devguide-module-twins.md
[lnk-auto-device-config]: iot-hub-auto-device-config.md
[lnk-firmware-update]: tutorial-firmware-update.md
[lnk-throttling]: iot-hub-devguide-quotas-throttling.md
[lnk-queries]: iot-hub-devguide-query-language.md
[lnk-dps]: ../iot-dps/how-to-manage-enrollments.md
[lnk-azure-sdk]: https://github.com/Azure/azure-iot-sdks
[lnk-solution]: https://azure.microsoft.com/features/iot-accelerators/