---
title: Разработка приложений для устройств с ограниченным ресурсами в Центре Интернета вещей Azure | Документация Майкрософт
description: Руководство разработчика. Сведения о разработке приложений для устройств с ограниченным ресурсами с помощью пакетов SDK для Azure IoT.
services: iot-hub
documentationcenter: c
author: yzhong94
manager: timlt
editor: ''
ms.assetid: 979136db-c92d-4288-870c-f305e8777bdd
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/24/2018
ms.author: yizhon
ms.openlocfilehash: 62065b78e3f8191c6423ba9dba4a8f7d16fad114
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34660027"
---
# <a name="develop-for-constrained-devices-using-azure-iot-sdks"></a>Разработка приложений для устройств с ограниченным ресурсами с помощью пакетов SDK для Azure IoT

## <a name="develop-using-azure-iot-hub-c-sdk"></a>Разработка с использованием пакета SDK для Центра Интернета вещей для C
Пакет SDK для Центра Интернета вещей для C написан в соответствии со стандартом ANSI C (C99), благодаря чему он подходит для использования с разными платформами с низким объемом памяти и маленьким размером диска.  Рекомендуемый объем ОЗУ составляет 64 КБ, но точный объем памяти зависит от используемого протокола, количества открытых подключений и целевой платформы.

SDK для C доступен в форме пакета от apt-get, NuGet и MBED.  Чтобы создавать приложения для устройств с ограниченным ресурсами, вы, возможно, захотите выполнить сборку пакета SDK локально для целевой платформы. В этой статье описано, как с помощью средства [CMake][lnk-cmake] удалить некоторые компоненты, чтобы сжать пакет SDK для C.  Кроме того, здесь рассматриваются рекомендованные модели программирования, с которыми следует работать на устройствах с ограниченными ресурсами.

### <a name="building-the-c-sdk-for-constrained-devices"></a>Сборка пакета SDK для C для устройств с ограниченными ресурсами
#### <a name="prerequisites"></a>предварительным требованиям
Чтобы подготовить среду разработки к сборке пакета SDK для C, следуйте указаниям из этого [руководства по настройке решения][lnk-devbox-setup].  До перехода к шагу сборки с помощью CMake вы можете вызвать флаги CMake и удалить неиспользуемые компоненты.

#### <a name="remove-additional-protocol-libraries"></a>Удаление дополнительных библиотек протоколов
Пакет SDK для C поддерживает пять протоколов: MQTT, MQTT через WebSocket, AMQPS, AMQP через WebSocket и HTTPS.    В большинстве случаев в клиенте требуется один или несколько протоколов, поэтому вы можете удалить из пакета SDK неиспользуемую библиотеку протокола.  Дополнительные сведения о выборе соответствующего протокола связи см. в [этой статье][lnk-choosing-protocol].  Например, MQTT — это упрощенный протокол, который лучше подходит для устройств с ограниченными ресурсами.

Вы можете удалить библиотеки AMQP и HTTP с помощью следующей команды CMake:
```
cmake -Duse_amqp=OFF -Duse_http=OFF <Path_to_cmake>
```

#### <a name="remove-sdk-logging-capability"></a>Удаление возможности ведения журналов пакета SDK
Пакет SDK для C предоставляет журнал с подробными сведениями, что помогает в процессе отладки. Вы можете удалить возможность ведения журналов рабочих устройств с помощью следующей команды CMake:
```
cmake -Dno_logging=OFF <Path_to_cmake>
```

#### <a name="remove-upload-to-blob-capability"></a>Удаление возможности отправки в хранилище BLOB-объектов
Большие файлы можно передавать в службу хранилища Azure с помощью встроенной в пакет SDK возможности.  Центр Интернета вещей Azure выступает в качестве диспетчера связанной учетной записи хранения Azure.  С помощью этой функции вы можете отправлять файлы мультимедиа, большие пакеты данных телеметрии и журналы.  Дополнительные сведения о передаче файлов с помощью Центра Интернета вещей см. в [этой статье][lnk-hub-file-upload].  Если приложению не требуется такая функциональная возможность, вы можете удалить ее с помощью следующей команды CMake:
```
cmake -Ddont_use_uploadtoblob=ON <Path_to_cmake>
```
#### <a name="running-strip-on-linux-environment"></a>Выполнение команды strip в среде Linux
Если в системе Linux выполняются двоичные файлы, вы можете уменьшить размер окончательного приложения после компиляции с помощью [команды strip][lnk-strip].
```
strip -s <Path_to_executable>
```

### <a name="programming-models-for-constrained-devices"></a>Модели программирования для устройств с ограниченными ресурсами
#### <a name="avoid-using-the-serializer"></a>Избегайте использования сериализатора
Пакет SDK для C имеет дополнительный [сериализатор][lnk-serializer], который позволяет с помощью декларативных таблиц сопоставления определять методы и свойства двойника устройства.  Этот сериализатор упрощает разработку, но он создает нагрузку, которая не подходит для устройств с ограниченными ресурсами.  В этом случае советуем использовать простые клиентские API-интерфейсы и выполнять анализ JSON с помощью такого упрощенного анализатора, как [parson][lnk-parson].

#### <a name="use-the-lower-layer-ll"></a>Используйте более низкий слой (_LL_)
Пакет SDK для C поддерживает две модели программирования.  Один набор имеет интерфейсы API с инфиксным индексом _LL_, который означает более низкий слой.  Этот набор API-интерфейсов более простой и не запускает рабочие потоки, что означает, что пользователь должен вручную управлять планированием.  Например, API-интерфейсы с инфиксным оператором _LL_ для клиента устройства можно найти в этом [файле заголовка](https://github.com/Azure/azure-iot-sdk-c/blob/master/iothub_client/inc/iothub_device_client_ll.h).  Другой набор API-интерфейсов без индекса _LL_ называется удобным слоем, на котором автоматически запускается рабочий поток.  Например, API-интерфейсы удобного слоя для клиента устройства можно найти в этом [файле заголовка](https://github.com/Azure/azure-iot-sdk-c/blob/master/iothub_client/inc/iothub_device_client.h).  Для устройств с ограниченными ресурсами, на которых поток может потреблять значительный объем системных ресурсов, советуем использовать API-интерфейсы с индексом _LL_.

## <a name="next-steps"></a>Дополнительная информация
Дополнительные сведения об архитектуре пакетов SDK для Azure IoT для C см. в следующих источниках:
-   [Исходный код пакета SDK для Интернета вещей Azure для C](https://github.com/Azure/azure-iot-sdk-c/)
-   [Пакет SDK для устройств Azure IoT для C](https://docs.microsoft.com/azure/iot-hub/iot-hub-device-sdk-c-intro)

------
[lnk-cmake]: https://cmake.org/
[lnk-devbox-setup]:  https://github.com/Azure/azure-iot-sdk-c/blob/master/doc/devbox_setup.md
[lnk-choosing-protocol]: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-protocols
[lnk-hub-file-upload]: https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-file-upload
[lnk-strip]: https://en.wikipedia.org/wiki/Strip_(Unix)
[lnk-serializer]: https://github.com/Azure/azure-iot-sdk-c/tree/master/serializer
[lnk-parson]: https://github.com/kgabis/parson