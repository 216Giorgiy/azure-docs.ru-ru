<properties
	pageTitle="Передача файлов из устройств в центре IoT | Microsoft Azure"
	description="Следуйте инструкциям этого учебника, чтобы узнать, как передавать файлы из устройств в центре IoT Azure с помощью C#."
	services="iot-hub"
	documentationCenter=".net"
	authors="fsautomata"
	manager="kevinmil"
	editor=""/>

<tags
     ms.service="iot-hub"
     ms.devlang="csharp"
     ms.topic="article"
     ms.tgt_pltfrm="na"
     ms.workload="tbd"
     ms.date="09/29/2015"
     ms.author="elioda"/>

# Передача файлов из устройств в облако в центре IoT

## Введение

Центр IoT Azure — полностью управляемая служба, которая обеспечивает надежный и защищенный двунаправленный обмен данными между миллионами устройств IoT и серверной частью приложения. В предыдущих учебниках ([Приступая к работе с центром IoT] и [Отправка сообщений с облака на устройства в центре IoT]) описаны базовые функции центра IoT по отправке сообщений с устройства в облако и с облака на устройство, а также описан доступ к этим сообщениям из устройств и облачных компонентов. В учебнике [Обработка сообщений, отправляемых с устройств в облако] описан способ надежного хранения сообщений, отправляемых с устройства в облако, в хранилище больших двоичных объектов. Однако существуют случаи, когда данные, поступающие от устройств, не удается легко сопоставить с относительно небольшими сообщениями, отправляемыми с устройства в облако. Среди примеров — большие файлы, содержащие изображения, видео, данные вибрации для образца с высокой частотой или содержащие предварительно обработанные данные в какой-либо форме. Эти файлы обычно обрабатываются в виде пакета с помощью таких средств, как [Фабрика данных Azure] или стек [Hadoop]. Когда передача файла из устройства является более приоритетной по сравнению с отправкой событий, функции безопасности и надежности центра IoT остаются доступными.

Этот учебник основан на коде, приведенном в учебнике [Отправка сообщений с облака на устройства в центре IoT]. В нем показано, как с помощью отправки сообщений с облака на устройство надежно предоставить устройству универсальный код ресурса (URI) большого двоичного объекта Azure, используемый для передачи файла, и как с помощью подтверждений доставки центра IoT активировать обработку файла в серверной части приложения. Преимуществом этого подхода является повторное использование удостоверения устройства центра IoT и подтверждения доставки сообщений, отправляемых с облака на устройство, для информирования серверной части приложения об успешной загрузке файла.

> [AZURE.NOTE]Такой же подход можно использовать для безопасной загрузки файлов из облака на устройства.

Дополнительные сведения о сообщениях, отправляемых с облака на устройство, и о безопасности центра IoT можно найти в [Руководстве разработчика по центру IoT].

В конце этого учебника вы запустите два консольных приложения Windows:

* **SimulatedDevice**, измененную версию приложения, созданного в учебнике [Отправка сообщений с облака на устройства в центре IoT]. Это приложение подключается к центру IoT и получает сообщения, отправленные с облака на устройство, которые содержат универсальный код ресурса (URI) больших двоичных объектов Azure. Для каждого полученного сообщения инициируется передача файла на указанный универсальный код ресурса (URI) большого двоичного объекта.
* **SendCloudToDevice**, которое создает универсальный код ресурса (URI) большого двоичного объекта Azure (как описано в разделе [Создание и использование SAS с помощью службы BLOB-объектов](../storage/storage-dotnet-shared-access-signature-part-2.md)), отправляет его в виде сообщения на виртуальное устройство с помощью центра IoT и затем получает подтверждение доставки этого сообщения.

> [AZURE.NOTE]Для центра IoT существуют пакеты SDK для многих платформ устройств и языков (включая C, Java и Javascript). Эти пакеты работают на основе пакетов SDK для устройств IoT Azure. Пошаговые инструкции по подключению устройства к коду этого учебника и к центру IoT Azure в целом см. в [Центре разработчика IoT в Azure]. Пакеты SDK службы IoT Azure для Java и Node будут выпущены в ближайшее время.

Чтобы пройти этот учебник, требуется:

+ Microsoft Visual Studio 2015;

+ Активная учетная запись Azure. <br/>Если ее нет, можно создать бесплатную пробную учетную запись всего за несколько минут. Подробные сведения см. на странице [Бесплатная пробная версия Azure](http://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A0E0E5C02&amp;returnurl=http%3A%2F%2Fazure.microsoft.com%2Fru-RU%2Fdevelop%2Fiot%2Ftutorials%2Ffile-upload%2F target="\_blank").


[AZURE.INCLUDE [iot-hub-file-upload-cloud-csharp](../../includes/iot-hub-file-upload-cloud-csharp.md)]


[AZURE.INCLUDE [iot-hub-file-upload-device-csharp](../../includes/iot-hub-file-upload-device-csharp.md)]

## Запуск приложений

Теперь все готово к запуску приложений.

1.  В Visual Studio щелкните правой кнопкой мыши на вашем решении и выберите **Настроить запускаемые при включении проекты**. Выберите **Несколько запускаемых проектов**, а затем выберите действие **Запуск** для обоих приложений **SimulatedDevice** и **SendCloudToDevice**.

2.  Нажмите клавишу **F5**, и оба приложения должны запуститься. Выберите окно **SendCloudToDevice** и нажмите клавишу. Вы увидите, что виртуальное устройство выводит сообщение при загрузке файла, а приложение **SendCloudToDevice** выводит подтверждение доставки. Наличие файла в вашей учетной записи хранения можно проверить с помощью [портала предварительной версии Azure] или обозревателя серверов Visual Studio.

  ![][50]


## Дальнейшие действия

В этом учебнике было показано, как упростить передачу файлов с устройств с помощью сообщений, отправляемых из облака на устройства. Изучение функций и сценариев центра IoT можно продолжить в следующем руководстве:

- [Обработка сообщений, отправляемых с устройств в облако] — в нем показано, как надежно обрабатывать данные телеметрии и интерактивные сообщения, поступающие от устройств.

Дополнительная информация о центре IoT приведена в следующих статьях:

* [Обзор центра IoT]
* [Руководство разработчика по центру IoT]
* [Руководство по центру IoT]
* [Поддерживаемые платформы устройств и языки][Supported devices]
* [Центр разработчика IoT Azure]

<!-- Images. -->

[50]: ./media/iot-hub-csharp-csharp-file-upload/run-apps1.png

<!-- Links -->

[Send Cloud-to-Device messages with IoT Hub]: iot-hub-csharp-csharp-c2d.md

[портала предварительной версии Azure]: https://portal.azure.com/

[Фабрика данных Azure]: https://azure.microsoft.com/ru-RU/documentation/services/data-factory/
[Hadoop]: https://azure.microsoft.com/ru-RU/documentation/services/hdinsight/

[Get started with IoT Hub]: iot-hub-csharp-csharp-getstarted.md
[Отправка сообщений с облака на устройства в центре IoT]: iot-hub-csharp-csharp-c2d.md
[Обработка сообщений, отправляемых с устройств в облако]: iot-hub-csharp-csharp-process-d2c.md
[Uploading files from devices]: iot-hub-csharp-csharp-file-upload.md

[Обзор центра IoT]: iot-hub-what-is-iot-hub.md
[Руководство по центру IoT]: iot-hub-guidance.md
[Руководстве разработчика по центру IoT]: iot-hub-devguide.md
[Руководство разработчика по центру IoT]: iot-hub-devguide.md
[IoT Hub Supported Devices]: iot-hub-supported-devices.md
[Приступая к работе с центром IoT]: iot-hub-csharp-csharp-getstarted.md
[Supported devices]: https://github.com/Azure/azure-iot-sdks/blob/master/doc/tested_configurations.md
[Центр разработчика IoT Azure]: http://www.azure.com/iotdev
[Центре разработчика IoT в Azure]: http://www.azure.com/iotdev



 

<!---HONumber=Oct15_HO1-->