---
title: Как настроить клиенты OpenVPN для VPN-шлюза Azure | Документация Майкрософт
description: Действия по настройке клиентов OpenVPN для VPN-шлюза Azure
services: vpn-gateway
author: cherylmc
ms.service: vpn-gateway
ms.topic: conceptual
ms.date: 09/21/2018
ms.author: cherylmc
ms.openlocfilehash: 141f29ea1c7ebdd8208dda6bc39a60f7873dab7d
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46977848"
---
# <a name="configure-openvpn-clients-for-azure-vpn-gateway-preview"></a>Настройка клиентов OpenVPN для VPN-шлюза Azure (предварительная версия)

Эта статья поможет вам настроить клиенты OpenVPN.

> [!IMPORTANT]
> Общедоступная предварительная версия предоставляется без соглашения об уровне обслуживания и не должна использоваться для производственных рабочих нагрузок. Некоторые функции могут не поддерживаться, иметь ограничения и быть доступными не во всех расположениях Azure. См. [дополнительные условия использования для предварительных версий Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).
>

## <a name="before-you-begin"></a>Перед началом работы

Убедитесь, что шаги по настройке OpenVPN для вашего VPN-шлюза выполнены. Дополнительные сведения см. в разделе [Настройка OpenVPN для VPN-шлюза Azure](vpn-gateway-howto-openvpn.md).

## <a name="windows"></a>Клиенты Windows

1. Загрузите и установите официальный клиент OpenVPN с [веб-сайта OpenVPN](https://openvpn.net/index.php/open-source/downloads.html).
2. Загрузите профиль VPN для шлюза. Это можно сделать со вкладки конфигурации "точка — сеть" на портале Azure или с "New-AzureRmVpnClientConfiguration" в PowerShell.
3. Распакуйте профиль. Откройте файл конфигурации vpnconfig.ovpn из папки OpenVPN в Notepad.
4. Заполните раздел сертификата клиента подключения "точка — сеть" открытым ключом сертификата клиента P2S в формате base64. В сертификате с форматированием PEM вы можете просто открыть файл CER и скопировать ключ в формате base64, находящийся между заголовками сертификата. Сведения о том, как экспортировать сертификат, чтобы получить закодированный открытый ключ, см. ниже.
5. Заполните раздел секретного ключа закрытым ключом сертификата клиента P2S в base64. Сведения о способе извлечения закрытого ключа см. в разделе [об извлечении ключа](vpn-gateway-certificates-point-to-site.md#clientexport).
6. Не изменяйте остальные поля. Для подключения к VPN используйте заполненную конфигурацию на входе клиента.
7. Скопируйте файл vpnconfig.ovpn в папку C:\Program Files\OpenVPN\config.
8. Щелкните правой кнопкой мыши значок OpenVPN в области уведомлений и щелкните "Подключить".

## <a name="mac"></a>Клиенты Mac

1. Скачайте и установите клиент OpenVPN, например [TunnelBlik](https://tunnelblick.net/downloads.html). 
2. Загрузите профиль VPN для шлюза. Это можно сделать со вкладки конфигурации "точка — сеть" на портале Azure или с "New-AzureRmVpnClientConfiguration" в PowerShell.
3. Распакуйте профиль. Откройте файл конфигурации vpnconfig.ovpn из папки OpenVPN в Notepad.
4. Заполните раздел сертификата клиента подключения "точка — сеть" открытым ключом сертификата клиента P2S в формате base64. В сертификате с форматированием PEM вы можете просто открыть файл CER и скопировать ключ в формате base64, находящийся между заголовками сертификата. Дополнительные сведения о том, как экспортировать сертификат для получения закодированного открытого ключа, см. в разделе [Экспорт открытого ключа (CER)](vpn-gateway-certificates-point-to-site.md#cer).
5. Заполните раздел секретного ключа закрытым ключом сертификата клиента P2S в base64. Дополнительные сведения о том, как извлечь закрытый ключ, см. в разделе [Извлечение закрытого ключа](https://www.geotrust.eu/en/support/manuals/microsoft/all+windows+servers/export+private+key+or+certificate/).
6. Не изменяйте остальные поля. Для подключения к VPN используйте заполненную конфигурацию на входе клиента.
7. Дважды щелкните файл профиля, чтобы создать профиль в Tunnelblik.
8. Запустите Tunnelblik из папки приложения.
9. Нажмите значок Tunneblik на панели задач и выберите подключение.

## <a name="linux"></a>Клиенты Linux

1. Запустите новый сеанс терминала. Также новый сеанс можно начать, нажав "Ctrl + Alt + Т".
2. Для установки необходимых компонентов введите следующую команду.

  ```
  sudo apt-get install openvpn
  sudo apt-get -y install network-manager-openvpn
  sudo service network-manager restart
  ```
3. Загрузите профиль VPN для шлюза. Это можно сделать со вкладки конфигурации "точка — сеть" на портале Azure или с "New-AzureRmVpnClientConfiguration" в PowerShell.
4. Заполните раздел секретного ключа закрытым ключом сертификата клиента P2S в base64. Дополнительные сведения о том, как извлечь закрытый ключ, см. в разделе [Извлечение закрытого ключа](https://www.geotrust.eu/en/support/manuals/microsoft/all+windows+servers/export+private+key+or+certificate/).
5. Чтобы подключиться с помощью командной строки, введите следующее.
  
  ```
  Sudo openvpn –config <name and path of your VPN profile file>
  ```
5. Чтобы подключиться с помощью графического пользовательского интерфейса, перейдите в параметры системы.
6. Щелкните **+** для добавления нового подключения VPN.
7. В разделе **Добавить VPN** выберите **Импорт из файла...**
8. Просмотрите файл профиля и дважды щелкните или выберите **Открыть**.
9. Щелкните **Добавить** в окне **Добавить VPN**.
  
  ![Импорт из файла](./media/vpn-gateway-howto-openvpn-clients/importfromfile.png)
10. Вы можете подключиться, выбрав для VPN **Вкл.** на странице **Параметры сети** или под значком сети на панели задач.

## <a name="next-steps"></a>Дополнительная информация

Если вы хотите, чтобы клиенты VPN могли получить доступ к ресурсам в другой (рабочей) виртуальной сети, следуйте инструкциям в статье [Подключение между виртуальными сетями](vpn-gateway-howto-vnet-vnet-resource-manager-portal.md) по настройке соединения "виртуальная сеть — виртуальная сеть". Обязательно включите протокол BGP на шлюзах и соединениях, иначе трафик не будет считываться.
