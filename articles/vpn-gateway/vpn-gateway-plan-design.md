<properties 
   pageTitle="Планирование и проектирование VPN-шлюза| Microsoft Azure"
   description="Сведения о планировании и проектировании VPN-шлюза для подключений между организациями и между виртуальными сетями, а также гибридных подключений"
   services="vpn-gateway"
   documentationCenter="na"
   authors="cherylmc"
   manager="carmonm"
   editor=""
   tags="azure-service-management,azure-resource-manager"/>
<tags 
   ms.service="vpn-gateway"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="08/19/2016"
   ms.author="cherylmc"/>

# Планирование и проектирование VPN-шлюза

Планирование и проектирование конфигураций распределенных подключений и подключений между виртуальными сетями может быть очень простым или достаточно сложным в зависимости от потребностей сети. В этой статье рассматриваются основные вопросы планирования и проектирования.

## Планирование


### <a name="compare"></a>Возможности распределенного подключения

Если вам требуется безопасное подключение локальных сайтов к виртуальной сети, доступны три варианта: подключение типа "сеть — сеть", подключение типа "точка — сеть" и канал ExpressRoute. Сравните различные доступные варианты подключений между организациями. На выбор влияют различные факторы, в том числе следующие.


- Какая пропускная способность требуется для решения?
- Вы хотите обмениваться данными через общедоступный Интернет по безопасному VPN-подключению или через частное подключение?
- У вас есть общедоступный IP-адрес, который можно использовать?
- Вы планируете использовать VPN-устройство? Если да, является ли оно совместимым?
- Вы подключаете лишь несколько компьютеров или требуется постоянное подключения для сайта?
- Какой тип VPN-шлюза необходим для решения, которое вы хотите создать?
- Какой номер SKU шлюза следует использовать?


Приведенная ниже таблица поможет вам подобрать наилучший вариант подключения для решения.


[AZURE.INCLUDE [vpn-gateway-cross-premises](../../includes/vpn-gateway-cross-premises-include.md)]



### <a name="gwrequire"></a>Требования к шлюзу в зависимости от типа VPN и SKU


Во время создания шлюза VPN нужно указать SKU шлюза, который вы хотите использовать. Существует три SKU VPN-шлюза:

- базовая;
- Стандартная
- высокопроизводительная

[AZURE.INCLUDE [vpn-gateway-table-requirements](../../includes/vpn-gateway-table-requirements-include.md)]



### <a name="aggthroughput"></a>Типы шлюзов и их суммарная пропускная способность

В следующей таблице приведены типы шлюзов с приблизительной суммарной пропускной способностью. Приблизительная суммарная пропускная способность может быть решающим фактором при проектировании. Цены на шлюзы зависят от артикулов. Сведения о ценах см. в разделе [Стоимость VPN-шлюзов ](https://azure.microsoft.com/pricing/details/vpn-gateway/). Эта таблица относится к классической модели развертывания и модели диспетчера ресурсов.

[AZURE.INCLUDE [vpn-gateway-table-gwtype-aggtput](../../includes/vpn-gateway-table-gwtype-aggtput-include.md)]



### <a name="wf"></a>Рабочий процесс

Ниже приведен стандартный рабочий процесс для настройки облачных подключений.

1.	Спроектируйте и спланируйте топологию подключений и составьте список адресных пространств для всех сетей, которые необходимо подключить.
2.	Создайте виртуальную сеть Azure.
3.	Создайте VPN-шлюз для виртуальной сети.
4.	Создайте и настройте подключения к локальным сетям или другим виртуальным сетям (при необходимости).
5.	Создайте и настройте подключение "точка — сеть" для VPN-шлюза Azure (при необходимости).
 

## Проектирование

### <a name="topologies"></a>Топологии подключений

Начните с просмотра схем в статье о [топологии подключений](vpn-gateway-topology.md). В этой статье содержатся базовые схемы, а также описаны модели развертывания для каждой топологии (с использованием Resource Manager или классическая модель) и средства развертывания, которыми можно воспользоваться для развертывания конфигурации.

### <a name="designbasics"></a>Основы проектирования

В следующих разделах представлены основные сведения о VPN-шлюзе. Кроме того, ознакомьтесь с [ограничениями сетевых служб](../articles/azure-subscription-service-limits.md#networking-limits).


#### <a name="subnets"></a>О подсетях

При создании подключений необходимо определить диапазоны адресов подсетей. Нельзя, чтобы они перекрывались. Перекрывающаяся подсеть — это подсеть, в которой одна виртуальная сеть или локальное расположение находится в том же адресном пространстве, что и другое расположение. Это значит, что ваши сетевые инженеры должны выделить для ваших локальных сетей диапазон, который будет использоваться для подсетей и пространства IP-адресов Azure. Это адресное пространство не должно использоваться в локальной сети.

Перекрытие подсетей также следует предотвратить при работе с подключениями между виртуальными сетями. Если подсети перекрываются и какой-либо IP-адрес существует в виртуальных сетях отправки и назначения, то создать подключение между виртуальными сетями не удастся. Azure не сможет перенаправить данные в другую виртуальную сеть, так как адрес назначения является частью виртуальной сети отправки.

Для работы VPN-шлюзов требуется специальная подсеть, которая называется подсетью шлюза. Чтобы подсети шлюзов работали надлежащим образом, каждую из них нужно назвать GatewaySubnet. Убедитесь, что для подсети шлюза не используется другое имя. Кроме того, не следует развертывать в ней виртуальные машины или что-либо другое. Ознакомьтесь с [подсетями шлюза](vpn-gateway-about-vpn-gateway-settings.md#gwsub).

#### <a name="local"></a>О локальных сетевых шлюзах

Обычно термин "шлюз локальной сети" означает локальное расположение. В классической модели развертывания локальный сетевой шлюз называется сайтом локальной сети. При настройке локального сетевого шлюза для него нужно задать имя, общедоступный IP-адрес локального VPN-устройства и префиксы адресов, принадлежащих к локальному расположению. Azure проверяет наличие сетевого трафика по префиксам адресов назначения, учитывает конфигурацию, указанную для локального сетевого шлюза, и соответствующим образом направляет пакеты. При необходимости эти префиксы адресов можно изменить. Дополнительные сведения см. в статье [Шлюзы локальной сети](vpn-gateway-about-vpn-gateway-settings.md#lng).


#### <a name="gwtype"></a>О типах шлюзов

Для топологии чрезвычайно важен правильный выбор типа шлюза. Шлюз не будет работать надлежащим образом, если выбран неправильный тип. По типу шлюза определяется, как подключается шлюз. Это обязательный параметр конфигурации для модели развертывания с помощью Resource Manager.

Существуют такие типы шлюзов:

- Vpn
- ExpressRoute

#### <a name="connectiontype"></a>О типах подключений

Для каждой конфигурации необходим конкретный тип подключения. Существуют такие типы подключения:

- IPsec
- Vnet2Vnet
- ExpressRoute
- VPNClient


#### <a name="vpntype"></a>О типах VPN

Для каждой конфигурации нужен определенный тип VPN. Если необходимо совместить две конфигурации, например создать подключения типа "сеть — сеть" и "точка — сеть" в одной виртуальной сети, нужно указать тип VPN, который отвечает требованиям обоих подключений.

[AZURE.INCLUDE [vpn-gateway-vpntype](../../includes/vpn-gateway-vpntype-include.md)]

В приведенных ниже таблицах приведены типы VPN и соответствующие конфигурации подключений. Тип VPN для шлюза должен соответствовать конфигурации, которую требуется создать.


[AZURE.INCLUDE [vpn-gateway-table-vpntype](../../includes/vpn-gateway-table-vpntype-include.md)]

### <a name="devices"></a>VPN-устройства для подключений типа "сеть — сеть"

Независимо от модели развертывания для настройки подключения типа "сеть — сеть" необходимы следующие элементы:

- VPN-устройство, совместимое с VPN-шлюзами Azure;
- общедоступный IP-адрес IPv4, который находится в пределах NAT.

Необходимо иметь опыт настройки VPN-устройства или возможность обратиться к специалисту, который может настроить устройство для вас. Дополнительные сведения о VPN-устройствах см. в статье [О VPN-устройствах для подключений VPN-шлюзов типа "сеть — сеть"](vpn-gateway-about-vpn-devices.md). Статья о VPN-устройствах содержит сведения о проверенных устройствах, требованиях к еще непроверенным устройствам и ссылки на документы по конфигурации устройств, если они доступны.

### <a name="forcedtunnel"></a>Вариант маршрутизации с принудительным туннелированием

Принудительное туннелирование можно настроить для большинства конфигураций. Оно позволяет перенаправлять или "принудительно направлять" весь Интернет-трафик обратно в локальное расположение через VPN типа "сеть — сеть" для проверки и аудита. Это критически важное требование безопасности, имеющееся в большинстве корпоративных ИТ-политик.

Без принудительного туннелирования Интернет-трафик из виртуальных машин в Azure будет всегда поступать из инфраструктуры сети Azure непосредственно в Интернет, без возможности его проверки или аудита. Неавторизованный доступ в Интернет может привести к раскрытию информации или другим нарушениям безопасности.

**Схема принудительного туннелирования**

![Подключение с принудительным туннелированием](./media/vpn-gateway-plan-design/forced-tunnel.png "принудительное туннелирование")

Подключение с принудительным туннелированием можно настроить в обеих моделях развертывания с помощью разных средств. Дополнительные сведения приведены в таблице ниже. Мы обновляем эту таблицу по мере выпуска новых статей, моделей развертывания и дополнительных инструментов для этой конфигурации. Если статья доступна, таблица ссылается на нее напрямую.

[AZURE.INCLUDE [vpn-gateway-table-forcedtunnel](../../includes/vpn-gateway-table-forcedtunnel-include.md)]



## Дальнейшие действия

Дополнительные сведения о проектировании см. в статьях [VPN-шлюз: вопросы и ответы](vpn-gateway-vpn-faq.md) и [Шлюзы VPN](vpn-gateway-about-vpngateways.md).

Дополнительные сведения о конкретных параметрах шлюза см. в разделе [Сведения о параметрах VPN-шлюза](vpn-gateway-about-vpn-gateway-settings.md).

<!---HONumber=AcomDC_0824_2016-->