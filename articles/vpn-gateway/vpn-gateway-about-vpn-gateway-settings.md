<properties 
   pageTitle="Сведения о параметрах VPN-шлюза | Microsoft Azure"
   description="Узнайте о параметрах VPN-шлюза для виртуальной сети Azure."
   services="vpn-gateway"
   documentationCenter="na"
   authors="cherylmc"
   manager="carmonm"
   editor=""
   tags="azure-resource-manager,azure-service-management"/>
<tags 
   ms.service="vpn-gateway"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="08/29/2016"
   ms.author="cherylmc" />

# Сведения о параметрах VPN-шлюза

VPN-шлюз — это набор ресурсов, настраиваемых для обмена сетевым трафиком между виртуальными и локальными сетями. VPN-шлюз можно также использовать для передачи трафика между виртуальными сетями в Azure. В этой статье рассматриваются ресурсы и параметры, связанные с VPN-шлюзом.

Возможно, вы захотите рассмотреть доступные конфигурации с помощью схем подключений. Схемы, показывающие процесс развертывания каждой конфигурации, можно найти в статье [Основные сведения о VPN-шлюзах Azure](vpn-gateway-about-vpngateways.md).


## <a name="gwsku"></a>SKU шлюзов

Во время создания шлюза VPN нужно указать SKU шлюза, который вы хотите использовать. SKU шлюзов применяются к обоим типам шлюзов: ExpressRoute и VPN. Цены на шлюзы зависят от артикулов. Сведения о ценах см. в разделе [Стоимость VPN-шлюзов ](https://azure.microsoft.com/pricing/details/vpn-gateway/). Дополнительные сведения об ExpressRoute см. в [техническом обзоре ExpressRoute](../expressroute/expressroute-introduction.md).

Существует 3 SKU VPN-шлюза:

- базовая;
- Стандартная
- HighPerformance.

В следующем примере PowerShell используется `-GatewaySku` со значением *Standard*.

	New-AzureRmVirtualNetworkGateway -Name vnetgw1 -ResourceGroupName testrg `
	-Location 'West US' -IpConfigurations $gwipconfig -GatewaySku Standard `
	-GatewayType Vpn -VpnType RouteBased


###  <a name="aggthroughput"></a>Расчетная суммарная пропускная способность в зависимости от SKU и типа шлюза


В следующей таблице приведены типы шлюзов с приблизительной суммарной пропускной способностью. Эта таблица относится к классической модели развертывания и модели диспетчера ресурсов.

[AZURE.INCLUDE [vpn-gateway-table-gwtype-aggthroughput](../../includes/vpn-gateway-table-gwtype-aggtput-include.md)]

## <a name="gwtype"></a>Типы шлюзов

Тип шлюза определяет, как подключается шлюз. Это обязательный параметр конфигурации для модели развертывания с помощью Resource Manager. У каждой виртуальной сети может быть только один шлюз виртуальной сети каждого типа. Для `-GatewayType` доступны такие значения:

- Vpn
- ExpressRoute


В этом примере PowerShell для модели развертывания с помощью Resource Manager для параметра -GatewayType задано значение *Vpn*. При создании шлюза необходимо убедиться, что в конфигурации указан правильный тип шлюза.

	New-AzureRmVirtualNetworkGateway -Name vnetgw1 -ResourceGroupName testrg `
	-Location 'West US' -IpConfigurations $gwipconfig -GatewayType Vpn `
	-VpnType RouteBased

## <a name="connectiontype"></a>Типы подключения

Для каждой конфигурации необходим конкретный тип подключения. Для `-ConnectionType` в PowerShell можно указать такие значения (развертывание Resource Manager):

- IPsec
- Vnet2Vnet
- ExpressRoute
- VPNClient

В следующем примере PowerShell создается подключение типа "сеть — сеть", для которого требуется тип IPsec.

	New-AzureRmVirtualNetworkGatewayConnection -Name localtovon -ResourceGroupName testrg `
	-Location 'West US' -VirtualNetworkGateway1 $gateway1 -LocalNetworkGateway2 $local `
	-ConnectionType IPsec -RoutingWeight 10 -SharedKey 'abc123'


## <a name="vpntype"></a>Типы VPN

Чтобы VPN работала, необходимо указать ее тип в конфигурации. Во время создания конфигурации нужно выбрать тип VPN, требуемый для подключения.

Например, если требуется подключаться к виртуальной сети, используя подключения типа "сеть — сеть" и "точка —сеть", то необходимо использовать тип VPN, который соответствует требованиям к подключению обеих конфигураций. Для подключений типа "точка — сеть" требуется тип VPN на основе маршрутов (шлюз с динамической маршрутизацией), а подключения типа "сеть — сеть" иногда могут поддерживать тип VPN на основе политик. Это означает, что если у вас уже есть подключение типа "сеть — сеть", использующее тип VPN на основе политик (статическая маршрутизация), то необходимо повторно создать шлюз, указав тип VPN на основе маршрутов (динамическая маршрутизация), чтобы обеспечить поддержку подключений типа "точка — сеть".

Существует два типа VPN:

[AZURE.INCLUDE [vpn-gateway-vpntype](../../includes/vpn-gateway-vpntype-include.md)]



В этом примере PowerShell для модели развертывания с помощью Resource Manager для `-VpnType` задано значение *RouteBased*. При создании шлюза необходимо убедиться, что в конфигурации указано правильное значение -VpnType.

	New-AzureRmVirtualNetworkGateway -Name vnetgw1 -ResourceGroupName testrg `
	-Location 'West US' -IpConfigurations $gwipconfig `
	-GatewayType Vpn -VpnType RouteBased

##  <a name="requirements"></a>Требования к шлюзу

[AZURE.INCLUDE [vpn-gateway-table-requirements](../../includes/vpn-gateway-table-requirements-include.md)]


## <a name="gwsub"></a>Подсеть шлюза

Чтобы настроить VPN-шлюз, сначала нужно создать подсеть шлюза для виртуальной сети. Чтобы подсети шлюзов работали правильно, каждую подсеть нужно назвать *GatewaySubnet*. Это имя сообщит Azure, что подсети должны использоваться для шлюза.<BR>Если вы используете классический портал, подсеть шлюза будет автоматически отображаться в интерфейсе портала под именем *Gateway*. Это примечание касается только просмотра подсети шлюзов на классическом портале. Подсеть фактически создается с именем *GatewaySubnet*, под которым она отображается на портале Azure и в PowerShell.

Минимальный размер подсети шлюза зависит исключительно от того, какую конфигурацию вы хотите создать. Хотя можно создать подсеть шлюза всего лишь с размером /29, мы рекомендуем создавать подсети с размером /28 или больше (/28, /27, /26 и т. д.).

Создание шлюза большего размера предотвращает превышение ограничений его размера при работе. Например, вы создали шлюз виртуальной сети с размером подсети /29 для подключения типа "сеть — сеть". Теперь требуется конфигурацию сосуществования подключений типа "сеть — сеть" и ExpressRoute. Для такой конфигурации требуется подсеть шлюза с размером не менее /28. Чтобы создать конфигурацию, придется изменить подсеть шлюза для соблюдения минимальных требований к подключению, то есть настроить для нее размер /28.

В примере PowerShell ниже показана подсеть шлюза GatewaySubnet. Здесь приведена нотация CIDR, указывающая размер /27, при котором можно использовать достаточно IP-адресов для большинства существующих конфигураций.

	Add-AzureRmVirtualNetworkSubnetConfig -Name 'GatewaySubnet' -AddressPrefix 10.0.3.0/27

>[AZURE.IMPORTANT] Убедитесь, что к подсети шлюза не применены какие-либо группы безопасности сети (NSG), так как из-за этого подключение может не работать.


## <a name="lng"></a>Локальные сетевые шлюзы

Обычно термин "шлюз локальной сети" означает локальное расположение. В классической модели развертывания шлюз локальной сети называется "локальным сайтом". Для локального сетевого шлюза следует задать имя и общий IP-адрес локального VPN-устройства, а также указать префиксы адресов, принадлежащие к локальному расположению. Azure проверяет наличие сетевого трафика по префиксам адресов назначения, учитывает конфигурацию, указанную для локального сетевого шлюза, и соответствующим образом направляет пакеты.

Иногда возникает необходимость изменить параметры локального сетевого шлюза. Например, при добавлении или изменении диапазона адресов, либо при изменении IP-адреса VPN-устройства. Для классической виртуальной сети эти параметры можно изменить на классическом портале, на странице "Локальные сети". В случае использования Resource Manager ознакомьтесь с разделом [Изменение параметров шлюза локальной сети с помощью PowerShell](vpn-gateway-modify-local-network-gateway.md).

## <a name="resources"></a>Интерфейсы REST API и PowerShell

Дополнительные технические материалы и специальные требования к синтаксису, действующие при использовании интерфейсов REST API и PowerShell, доступны на приведенных ниже страницах.

|**Классический** | **Диспетчер ресурсов**|
|-----|----|
|[PowerShell](https://msdn.microsoft.com/library/mt270335.aspx)|[PowerShell](https://msdn.microsoft.com/library/mt163510.aspx)|
|[ИНТЕРФЕЙС REST API](https://msdn.microsoft.com/library/jj154113.aspx)|[ИНТЕРФЕЙС REST API](https://msdn.microsoft.com/library/mt163859.aspx)|


## Дальнейшие действия

Дополнительные сведения о доступных конфигурациях подключений см. в статье [Основные сведения о VPN-шлюзах Azure](vpn-gateway-about-vpngateways.md).







 

<!---HONumber=AcomDC_0831_2016-->