<properties 
	pageTitle="Использование AzCopy со службой хранилища Microsoft Azure Storage" 
	description="Вы узнаете, как использовать AzCopyс для передачи, загрузки и копирования BLOB-объектов и содержания файлов." 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor="cgronlun"/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/5/2015" 
	ms.author="tamram"/>

# Приступая к работе со служебной программой командной строки AzCopy

AzCopy - это служебная программа командной строки, разработанная для быстрой отправки, скачивания и копирования данных из хранилища больших двоичных объектов, файлов и табличного хранилища Microsoft Azure. В настоящем руководстве приводится обзор использования AzCopy.

> [AZURE.NOTE] В этом руководстве предполагается, что установлена AzCopy 3.1.0 или более поздней версии. Уже выпущена общедоступная версия AzCopy 3.x.
> 
> В этом руководстве также описывается использование версии AzCopy 4.1.0, которая является предварительной версией AzCopy. Функции, предоставляемые только в предварительной версии, обозначены в этом руководстве как  *для предварительной версии*.
> 
> Обратите внимание, что в будущих выпусках AzCopy 4.x параметры и функциональные возможности командной строки могут измениться.

##Оглавление

- [Скачивание и установка AzCopy](#install)
- [Информация о синтаксисе командной строки AzCopy](#syntax)
- [Ограничение одновременных операций записи при копировании данных](#limit-writes)
- [Копирование больших двоичных объектов Azure с помощью AzCopy](#copy-blobs)
- [Копирование файлов в общую папку Azure с помощью AzCopy &#40;только для предварительной версии&#41;](#copy-files)
- [Копирование сущностей таблиц Azure с помощью AzCopy &#40;только для предварительной версии&#41;](#copy-entities)
- [Версии AzCopy](#versions)
- [Дальнейшие действия](#next-steps)

##<a id="install"></a> Скачивание и установка AzCopy

1. Скачайте [последнюю версию AzCopy](http://aka.ms/downloadazcopy) или [самую последнюю предварительную версию](http://aka.ms/downloadazcopypr).
2. Запустите установку. По умолчанию при установке AzCopy создается папка с именем  `AzCopy` в  `%ProgramFiles(x86)%\Microsoft SDKs\Azure\` (на компьютере под управлением 64-разрядной версии Windows) или  `%ProgramFiles%\Microsoft SDKs\Azure\` (на компьютере под управлением 32-разрядной версии Windows). Однако путь установки можно изменить в мастере установки.
3. При необходимости можно добавить место установки AzCopy к системному пути.

##<a id="syntax"></a> Информация о синтаксисе командной строки AzCopy

Далее откройте окно командной строки и перейдите к каталогу установки AzCopy на компьютере, где располагается исполняемый файл  `AzCopy.exe`. В командах AzCopy используется следующий базовый синтаксис:

	AzCopy /Source:<source> /Dest:<destination> /Pattern:<filepattern> [Options]

> [AZURE.NOTE] В самом начале работы с AzCopy версии 3.0.0 вам необходимо задать каждый параметр в командной строке, включая имя самого параметра, так как этого требует синтаксис командной строки,  *e.g.*,  `/ParameterName:ParameterValue`.

Параметры для AzCopy описаны в таблице ниже. Вы можете использовать одну из следующих команд для получения справки во время работы с AzCopy:

- Для получения подробных сведений о командной строке AzCopy: `AzCopy /?`
- Чтобы получить подробную информацию о параметрах AzCopy: `AzCopy /?:SourceKey`
- Чтобы получить примеры команд в командной строке: `AzCopy /?:Samples` 


<table>
  <tr>
    <th>Имя параметра</th>
    <th>Описание</th>
    <th>Применяется к хранилищу BLOB-объектов (да/нет)</th>
    <th>Применяется к хранилищу файлов (да/нет) (только для предварительной версии)</th>
    <th>Применяется к хранилищу таблиц (да/нет) (только для предварительной версии)</th>
  </tr>
  <tr>
    <td><b>/Source:&lt;source&gt;</b></td>
    <td>Параметр определяет исходные данные для копирования. Источником может быть каталог файловой системы, контейнер BLOB-объектов, виртуальный каталог BLOB-объектов, общая папка файлового хранилища, каталог файлового хранилища или таблица Azure.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/Dest:&lt;destination&gt;</b></td>
    <td>Параметр определяет целевую директорию копирования. Целевой директорией может быть каталог файловой системы, контейнер BLOB-объектов, виртуальный каталог BLOB-объектов, общая папка файлового хранилища, каталог файлового хранилища и таблица Azure.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/Pattern:&lt;file-pattern&gt;</b></td>
      <td>
          Параметр определяет шаблон файла, который указывает, какие именно файлы нужно копировать. Поведение дополнительного параметра "/Pattern" определяется местоположением исходных данных, а также наличием параметра "рекурсивный режим". Рекурсивный режим задается с помощью параметра "/S.".
          <br />
          Если определенный источник представляет собой каталог в файловой системе, то используются стандартные подстановочные знаки, и предоставленный шаблон файла сравнивается с файлами в каталоге. При задании параметра "/S." AzCopy также выполняет сравнение определенного шаблона со всеми файлами в любых подпапках каталога.
          <br />
          Если определенный источник представляет собой контейнер BLOB-объектов или виртуальный каталог, то подстановочные знаки не используются. Если задан параметр &nbsp;/S&nbsp;, то AzCopy интерпретирует заданный шаблон файла как префикс большого двоичного объекта. Если параметр &nbsp;/S&nbsp; не задан, то AzCopy выполняет сопоставление шаблона файла с точными именами больших двоичных объектов.
          <br />
          Если исходный файл для копирования находится в общей папке Azure, то вам необходимо либо указать точное имя файла (например, &nbsp;abc.txt) для копирования одного файла, либо задать параметр &nbsp;/S&nbsp; для копирования всех файлов в общей папке рекурсивно. Попытка одновременно задать шаблон файла и параметр /S&nbsp; приведет к ошибке.
          <br />
          Если не удается задать шаблон файла, то по умолчанию используется шаблон файла *.* для расположения файловой системы или пустой префикс для расположения службы хранилища Azure. Задание нескольких шаблонов не поддерживается.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/DestKey:&lt;storage-key&gt;</b></td>
    <td>Задает ключ учетной записи хранения для ресурса в месте назначения.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td class="auto-style1"><b>/DestSAS:&lt;sas-token&gt;</b></td>
    <td class="auto-style1">Задает подпись общего доступа (SAS) для контейнера назначения (если применяется). Заключите подписанный URL-адрес в двойные кавычки, так как он может содержать специальные символы командной строки..<br />
        Если в качестве ресурса в месте назначения используется контейнер больших двоичных объектов или таблица, можно либо задать этот параметр, а после него использовать маркер SAS, либо задать SAS как часть URI места назначения большого двоичного объекта без использования данного параметра.<br />
        Если исходное место копирования и место назначения копирования являются BLOB-объектами, то BLOB-объект места назначения должен находиться в той же учетной записи хранилища, что и BLOB-объект исходного места копирования.</td>
    <td class="auto-style1">Да</td>
    <td class="auto-style1">Нет</td>
    <td class="auto-style1">Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/SourceKey:&lt;storage-key&gt;</b></td>
    <td>Задает ключ учетной записи хранения для исходного ресурса.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/SourceSAS:&lt;sas-token&gt;</b></td>
    <td>Задает подпись общего доступа (SAS) для исходного контейнера (если применяется). Поместите SAS в двойные кавычки, так как подпись может содержать специальные символы командной строки.
        <br />
        Если исходный ресурс для копирования является BLOB-объектом и не предоставляется ни ключ, ни SAS, то контейнер будет считываться через анонимный доступ.
        <br />
        Если исходный ресурс для копирования является таблицей, то необходимо предоставить ключ или SAS.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/S</b></td>
    <td>Задает рекурсивный режим для операций копирования. В рекурсивном режиме AzCopy копирует все BLOB-объекты или файлы, соответствующие определенному шаблону файла, в том числе файлы из подпапок.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/BlobType:&lt;block | page&gt;</b></td>
    <td>Определяет, является ли место назначения блочным или страничным BLOB-объектом. Этот параметр применяется только в случае передачи BLOB-объекта. В противном случае создается сообщение об ошибке. Если в качестве места назначения выступает BLOB-объект и этот параметр не задается, то по умолчанию AzCopy создает блочный BLOB-объект.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/CheckMD5</b></td>
    <td>Вычисляет хэш MD5 для загруженных данных и проверяет соответствие хэша MD5, сохраненного в BLOB-объекте, или свойства Content-MD5 файла вычисленному хэшу. Проверка MD5 выключена по умолчанию. Чтобы выполнить проверку MD5 при загрузке данных, необходимо задать этот параметр.
	<br />
    Обратите внимание, что хранилище Azure не гарантирует актуальность хэша MD5, сохраненного для BLOB-объекта или файла. Клиент несет ответственность за обновление MD5 при каждом изменении BLOB-объекта или файла.
	<br />
    AzCopy всегда задает свойство Content-MD5 для BLOB-объекта или файла Azure после отправки его в службу.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/Snapshot</b></td>
    <td>Указывает, передаются ли моментальные снимки. Это параметр действителен только, если в качестве источника используется BLOB-объект. 
        <br />
        Переданные моментальные снимки BLOB-объекта переименовываются в следующем формате: [blob-name] (snapshot-time)[extension]. 
        <br />
        По умолчанию моментальные снимки не копируются.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/V:[verbose log-file]</b></td>
    <td>Выводит сообщения с подробным состоянием в файл журнала. По умолчанию файлу журнала с подробными данными присваивается имя <code>AzCopyVerbose.log</code> в <code>%LocalAppData%\Microsoft\Azure\AzCopy</code>. При задании существующего местоположения файла для этого параметра журнал с подробными данными будет добавляться к этому файлу.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/Z:[journal-file-folder]</b></td>
    <td>Задает папку файла журнала для возобновления операции.<br />
        AzCopy всегда поддерживает возобновление, если операция была прервана.<br />
        Если не задать этот параметр или задать его без пути папки, AzCopy создаст файл журнала в следующем расположении по умолчанию: <code>%LocalAppData%\Microsoft\Azure\AzCopy</code>.<br />
        При каждом вводе команды для AzCopy выполняется проверка на наличие файла журнала в папке по умолчанию или в папке, которая была задана с помощью данного параметра. Если в обоих местах файл журнала отсутствует, AzCopy воспринимает операцию как новую и создает новый файл журнала.
        <br />
		Если файл журнала не существует, AzCopy проверяет, соответствует ли введенная командная строка командной строке в файле журнала. Если две командные строки совпадают, AzCopy возобновляет незавершенную операцию. Если они не совпадают, вам будет предложено либо переписать файл журнала, чтобы начать новую операцию, либо отменить текущую операцию. 
        <br />
        После успешного завершения операции файл журнала удаляется.
		<br />
		Обратите внимание, что возобновление операции из файла журнала, созданного предыдущей версией AzCopy, не поддерживается.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/@:parameter-file</b></td>
    <td>Задает файл, который содержит параметры. AzCopy обрабатывает параметры в файле, как если бы они были заданы в командной строке.<br /> 
		В файле ответа можно либо задать несколько параметров в одной строке, либо задать каждый параметр в отдельной строке. Обратите внимание, что отдельный параметр не может занимать несколько строк. 
        <br />
		Файлы ответов могут содержать строки комментариев, которые начинаются с символов <code>#</code>. 
        <br />
        Можно задать несколько файлов ответов. Однако, следует иметь в виду, что AzCopy не поддерживает вложенных фалов ответов.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/Y</b></td>
    <td>Скрывает все запросы на подтверждение AzCopy.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/L</b></td>
    <td>Задает только операцию перечисления, данные не копируются.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/MT</b></td>
    <td>Задает такое же время последнего изменения загруженного файла, как в исходном BLOB-объекте или файле.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/XN</b></td>
    <td>Исключает более новый исходный ресурс. Ресурс не будет копироваться, если источник новее, чем место назначения.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/XO</b></td>
    <td>Исключает более старый исходный ресурс. Ресурс не будет копироваться, если источник старее, чем место назначения.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/A</b></td>
    <td>Отправляет только файлы с установленным атрибутом "Архивный".</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/IA:[RASHCNETOI]</b></td>
    <td>Передает файлы, содержащие любой из следующих заданных атрибутов.<br />
        Доступные атрибуты:  
        <br />
        R&nbsp;&nbsp;&nbsp;файлы, доступные только для чтения
        <br />
        A&nbsp;&nbsp;&nbsp;файлы, готовые к архивированию
        <br />
        S&nbsp;&nbsp;&nbsp;системные файлы
        <br />
        H&nbsp;&nbsp;&nbsp;скрытые файлы
        <br />
        C&nbsp;&nbsp;&nbsp;сжатые файлы
        <br />
        N&nbsp;&nbsp;&nbsp;обычные файлы
        <br />
        E&nbsp;&nbsp;&nbsp;зашифрованные файлы
        <br />
        T&nbsp;&nbsp;&nbsp;временные файлы
        <br />
        O&nbsp;&nbsp;&nbsp;автономные файлы
        <br />
        I&nbsp;&nbsp;&nbsp;неиндексированные файлы</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/XA:[RASHCNETOI]</b></td>
    <td>Исключает файлы, содержащие любой из следующих заданных атрибутов..<br />
        Доступные атрибуты:  
        <br />
        R&nbsp;&nbsp;&nbsp;файлы, доступные только для чтения  
        <br />
        A&nbsp;&nbsp;&nbsp;файлы, готовые к архивированию  
        <br />
        S&nbsp;&nbsp;&nbsp;системные файлы  
        <br />
        H&nbsp;&nbsp;&nbsp;скрытые файлы  
        <br />
        C&nbsp;&nbsp;&nbsp;сжатые файлы  
        <br />
        N&nbsp;&nbsp;&nbsp;обычные файлы  
        <br />
        E&nbsp;&nbsp;&nbsp;зашифрованные файлы  
        <br />
        T&nbsp;&nbsp;&nbsp;временные файлы  
        <br />
        O&nbsp;&nbsp;&nbsp;автономные файлы  
        <br />
        Я&nbsp;&nbsp;&nbsp;неиндексированные файлы</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/Delimiter:&lt;delimiter&gt;</b></td>
    <td>Указывает разделитель, используемый для разделения виртуальных каталогов в имени большого двоичного объекта.<br />
        По умолчанию AzCopy использует / как разделитель. Однако, AzCopy поддерживает любой общий символ (например, @, # или %) в качестве разделителя. Если необходимо ввести любой из этих специальных символов в командную строку следует заключить имя файла в двойные кавычки. 
        <br />
        Этот параметр применяется только для загрузки BLOB-объектов.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/NC:&lt;number-of-concurrents&gt;</b></td>
    <td>Задает количество одновременных операций.
        <br />
        По умолчанию AzCopy запускает несколько одновременных операций для увеличения скорости передачи данных. Обратите внимание, что большое количество одновременных операций в среде с низкой пропускной способностью может переполнить сетевое подключение и помешать полному завершению операций. Регулируйте количество одновременных операций в зависимости от фактической доступной пропускной способности сети.
        <br />
		Верхний лимит количества одновременно выполняемых операций составляет 512.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/SourceType:Blob|Table</b></td>
    <td>Указывает, что ресурс <code>source</code> представляет собой большой двоичный объект, доступный в локальной среде разработки, в которой запущен эмулятор хранения.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/DestType:Blob|Table</b></td>
    <td>Указывает, что ресурс <code>destination</code>  представляет собой большой двоичный объект, доступный в локальной среде разработки, в которой запущен эмулятор хранения.</td>
    <td>Да</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><strong>/PKRS:&lt;&quot;key1#key2#key3#...&quot;&gt;</strong></td>
    <td>Разбивает диапазоны ключей секций для обеспечения параллельной передачи данных с целью увеличения скорости экспорта данных.
        <br />
        Если параметр не задан, то AzCopy будет использовать одиночный поток для экспорта данных таблицы. Например, если пользователь задал параметр /PKRS:&quot;aa#bb&quot;, то AzCopy начинает три одновременных операции передачи.
        <br />
        Каждая операция экспортирует один из диапазонов ключей секций, как это показано на примере ниже: 
        <br />
        &nbsp;&nbsp;&nbsp;&#91;&lt;первый ключ раздела&gt;, aa&#41; 
        <br />
        &nbsp;&nbsp;&nbsp;&#91;aa, bb&#41;
        <br />
        &nbsp;&nbsp;&nbsp;&#91;bb, &lt;последний ключ раздела&gt;&#93; </td>
    <td>Нет</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><strong>/SplitSize:</strong><file-size><strong>&lt;file-size&gt;</strong></td>
    <td>Задает размер разбитых экспортированных файлов в МБ.
        <br />
        Если данный параметр не задан, то AzCopy поместит все экспортированные данные в один файл.
        <br />
        Если данные таблицы экспортируются в BLOB-объект и размер экспортированного файла достигает 200 ГБ для BLOB-объекта, то AzCopy разделяет экспортированный файл, даже если данный параметр не задан. </td>
    <td>Нет</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/EntityOperation:&lt;InsertOrSkip | InsertOrMerge | InsertOrReplace&gt;
</b>
</td>
    <td>Задает поведение импортированных данных таблиц.
        <br />
        InsertOrSkip - пропускает существующую сущность или вставляет новую, если сущность отсутствует в таблице.
        <br />
        InsertOrMerge - объединяет существующую сущность или вставляет новую, если сущность отсутствует в таблице.
        <br />
        InsertOrReplace - заменяет существующую сущность или вставляет новую, если сущность отсутствует в таблице. </td>
    <td>Нет</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/Manifest:&lt;manifest-file&gt;</b></td>
    <td>Задает файл описания для операции импорта данных. <br />
        Файл описания создается на стадии экспорта данных.</td>
    <td>Нет</td>
    <td>Нет</td>
    <td>Да<br /> (только для предварительной версии)</td>
  </tr>
  <tr>
    <td><b>/SyncCopy</b></td>
    <td>Указывает, копируются ли большие двоичные объекты или файлы синхронно между двумя конечными точками службы хранилища Azure. <br />
		По умолчанию AzCopy использует серверное асинхронное копирование. Задайте этот параметр, чтобы выполнить синхронное копирование, при котором большие двоичные объекты или файлы скачиваются в локальную память, а затем передаются в службу хранилища Azure. Вы можете использовать этот параметр для копирования файлов в хранилище больших двоичных объектов и хранилище файлов или из хранилища больших двоичных объектов в хранилище файлов и наоборот.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
  <tr>
    <td><b>/SetContentType:&lt;content-type&gt;</b></td>
    <td>Задает тип содержимого MIME для целевых больших двоичных объектов или файлов. <br />
		По умолчанию AzCopy задает для типа содержимого большого двоичного объекта или файла значение <code>application/octet-stream</code>. Вы можете задать тип содержимого для всех больших двоичных объектов или файлов, указав значение для этого параметра. Если вы задали этот параметр, не указав значение, AzCopy установит тип содержимого для каждого большого двоичного объекта или файла в соответствии с расширением файла.</td>
    <td>Да</td>
    <td>Да<br /> (только для предварительной версии)</td>
    <td>Нет</td>
  </tr>
</table>

<br/>

##<a id="limit-writes"></a>Ограничение одновременных операций записи при копировании данных

При копировании BLOB-объектов или файлов с помощью AzCopy следует иметь в виду, что другое приложение может изменять данные в то время, когда они копируются. Если это возможно, обеспечьте, чтобы во время операции копирования не происходило изменение копируемых данных. Например, при копировании VHD, связанного с виртуальной машиной Azure, убедитесь в том, что никакое другое приложение в это время не записывает данные на VHD. В качестве альтернативы можно сначала создать моментальный снимок VHD, а затем скопировать его.

Если не удается предотвратить запись в BLOB-объекты или файлы во время их копирования со стороны других приложений, следует иметь в виду, что к моменту завершения задания скопированные ресурсы могут больше не иметь полного соответствия с исходными ресурсами.

##<a id="copy-blobs"></a>Копирование больших двоичных объектов Azure с помощью AzCopy

В приведенных ниже примерах рассматриваются различные сценарии копирования BLOB-объектов с помощью AzCopy.

### Копирование одного BLOB-объекта

**Отправка файла из файловой системы в хранилище больших двоичных объектов:**
	
	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /Pattern:abc.txt

**Скачивание большого двоичного объекта из хранилища больших двоичных объектов в файловую систему:**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /Pattern:abc.txt

Дополнительную информацию о работе с ключами доступа к хранилищу см. в разделе [Просмотр, копирование и повторное создание ключей доступа к хранилищу]( http://azure.microsoft.com/documentation/articles/storage-create-storage-account/#regeneratestoragekeys).

### Копирование BLOB-объекта через копирование на стороне сервера

При копировании BLOB-объекта в пределах учетной записи хранения или между разными учетными записями хранения выполняется операция копирования на стороне сервера. Дополнительную информацию о серверных операциях копирования см. в статье [Информация об асинхронных операциях копирования больших двоичных объектов между различными учетными записями](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-asynchronous-cross-account-copy-blob.aspx).

**Копирование больших двоичных объектов в пределах учетной записи хранения:**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer1 /Dest:https://myaccount.blob.core.windows.net/mycontainer2 /SourceKey:key /DestKey:key /Pattern:abc.txt 

**Копирование большого двоичного объекта между различными учетными записями хранения:**

	AzCopy /Source:https://sourceaccount.blob.core.windows.net/mycontainer1 /Dest:https://destaccount.blob.core.windows.net/mycontainer2 /SourceKey:key1 /DestKey:key2 /Pattern:abc.txt
 
### Копирование BLOB-объекта из вторичного региона 

Если учетная запись хранения имеет включенное геоизбыточное хранилище для доступа с правом чтения, можно копировать данные из вторичного региона. 

**Копирование большого двоичного объекта из основной учетной записи во вторичную:**

	AzCopy /Source:https://myaccount1-secondary.blob.core.windows.net/mynewcontainer1 /Dest:https://myaccount2.blob.core.windows.net/mynewcontainer2 /SourceKey:key1 /DestKey:key2 /Pattern:abc.txt

**Скачивание большого двоичного объекта во вторичной учетной записи в файл в файловой системе:**

	AzCopy /Source:https://myaccount-secondary.blob.core.windows.net/mynewcontainer /Dest:C:\myfolder /SourceKey:key /Pattern:abc.txt

### Отправка файла в новый контейнер BLOB-объектов или виртуальный каталог

**Отправка файла в новый контейнер больших двоичных объектов**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mynewcontainer /DestKey:key /Pattern:abc.txt

Обратите внимание, что если указанный контейнер назначения не существует, AzCopy создаст его и загрузит в него файл.

**Отправка файла в новый виртуальный каталог больших двоичных объектов**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer/vd /DestKey:key /Pattern:abc.txt

Обратите внимание, что если указанный виртуальный каталог не существует, AzCopy отправит файл, чтобы включить его в виртуальный каталог от своего имени (*например*,  `vd/abc.txt` в указанном выше примере).

### Загрузка BLOB-объекта в новую папку

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /Pattern:abc.txt

Если папка  `C:\myfolder` еще не существует, AzCopy создаст ее в файловой системе и скачает в нее файл abc.txt.

### Рекурсивная отправка файлов и подпапок каталога в контейнер

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /S

При задании параметра  `/S` происходит копирование содержимого определенного каталога в хранилище больших двоичных объектов рекурсивно, что означает также копирование всех вложенных папок и их файлов. Например, предположим, что следующие файлы размещены в папке  `C:\myfolder`:

	C:\myfolder\abc.txt
	C:\myfolder\abc1.txt
	C:\myfolder\abc2.txt
	C:\myfolder\subfolder\a.txt
	C:\myfolder\subfolder\abcd.txt

После операции копирования в контейнер будут помещены следующие файлы:

    abc.txt
    abc1.txt
    abc2.txt
    subfolder\a.txt
    subfolder\abcd.txt

### Нерекурсивная отправка файлов из каталога в контейнер

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key

Если вы не зададите параметр  `/S` в командной строке, AzCopy не будет выполнять рекурсивное копирование. Копируются только файлы в указанном каталоге. Никакие подпапки и их файлы НЕ копируются. Например, предположим, что следующие файлы размещены в папке  `C:\myfolder`:

	C:\myfolder\abc.txt
	C:\myfolder\abc1.txt
	C:\myfolder\abc2.txt
	C:\myfolder\subfolder\a.txt
	C:\myfolder\subfolder\abcd.txt

После операции копирования в контейнер будут помещены следующие файлы:

	abc.txt
	abc1.txt
	abc2.txt

### Рекурсивная загрузка всех BLOB-объектов контейнера в каталог файловой системы

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /S

Предположим, что в указанном контейнере находятся следующие BLOB-объекты:  

	abc.txt
	abc1.txt
	abc2.txt
	vd1\a.txt
	vd1\abcd.txt

После операции копирования в каталог  `C:\myfolder` будут помещены следующие файлы:

	C:\myfolder\abc.txt
	C:\myfolder\abc1.txt
	C:\myfolder\abc2.txt
	C:\myfolder\vd1\a.txt
	C:\myfolder\vd1\abcd.txt

### Рекурсивная загрузка всех BLOB-объектов виртуального каталога BLOB-объектов в файловую систему

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer/vd1/ /Dest:C:\myfolder /SourceKey:key /S

Предположим, что в указанном контейнере находятся следующие BLOB-объекты:

	abc.txt
	abc1.txt
	abc2.txt
	vd1\a.txt
	vd1\abcd.txt

После операции копирования в каталог  `C:\myfolder` будут помещены следующие файлы: Обратите внимание, что копируются только BLOB-объекты в виртуальном каталоге:

	C:\myfolder\a.txt
	C:\myfolder\abcd.txt

### Рекурсивная отправка файлов, соответствующих определенному шаблону файла, в контейнер 

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /Pattern:a* /S

Предположим, что следующие файлы размещены в папке  `C:\myfolder`:

	C:\myfolder\abc.txt
	C:\myfolder\abc1.txt
	C:\myfolder\abc2.txt
	C:\myfolder\xyz.txt
	C:\myfolder\subfolder\a.txt
	C:\myfolder\subfolder\abcd.txt

После операции копирования в контейнер будут помещены следующие файлы:

	abc.txt
	abc1.txt
	abc2.txt
	subfolder\a.txt
	subfolder\abcd.txt
	
### Рекурсивная загрузка BLOB-объектов с заданным префиксом в файловую систему

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /Pattern:a /S

Предположим, что в указанном контейнере находятся следующие BLOB-объекты: Все большие двоичные объекты, начинающиеся с префикса `a`, будут копированы:

	abc.txt
	abc1.txt
	abc2.txt
	xyz.txt
	vd1\a.txt
	vd1\abcd.txt

После операции копирования в папку  `C:\myfolder` будут помещены следующие файлы:

	C:\myfolder\abc.txt
	C:\myfolder\abc1.txt
	C:\myfolder\abc2.txt

Обратите внимание, что префикс применяется к виртуальному каталогу, который формирует первую часть имени BLOB-объекта. В указанном выше примере виртуальный каталог не соответствует заданному префиксу и не копируется.


### Копирование BLOB-объекта и его моментальных снимков на другую учетную запись хранения

	AzCopy /Source:https://sourceaccount.blob.core.windows.net/mycontainer1 /Dest:https://destaccount.blob.core.windows.net/mycontainer2 /SourceKey:key1 /DestKey:key2 /Pattern:abc.txt /Snapshot

После выполнения копирования целевой контейнер будет содержать BLOB-объект и его моментальные снимки. Предположим, что в BLOB-объект в приведенном выше примере имеет два моментальных снимка, тогда контейнер будет содержать следующий BLOB-объект и моментальные снимки:

	abc.txt
	abc (2013-02-25 080757).txt
	abc (2014-02-21 150331).txt


### Использование файла ответа для задания параметров командной строки

	AzCopy /@:"C:\myfolder\abc.txt"

В файл ответа можно включить параметры командной строки AzCopy. AzCopy обрабатывает параметры в файле, как если бы он были заданы в командной строке, выполняя прямую замену содержимого файла.

**Задание одного или нескольких однострочных файлов ответа**

Предположим, что у нас есть файл ответа с именем  `source.txt`, который указывает исходный контейнер:

	/Source:http://myaccount.blob.core.windows.net/mycontainer

И файл ответа с именем  `dest.txt`, который указывает папку назначения в файловой системе:

	/Dest:C:\myfolder

А также файл ответа с именем  `options.txt`, определяющий параметры для AzCopy:

	/S /Y

Чтобы вызвать AzCopy с этими файлами ответов, размещенными в каталоге  `C:\responsefiles`, используйте команду:

	AzCopy /@:"C:\responsefiles\source.txt" /@:"C:\responsefiles\dest.txt" /SourceKey:<sourcekey> /@:"C:\responsefiles\options.txt"   

AzCopy обрабатывает эту команду, как если бы все индивидуальные параметры были включены в командную строку:

	AzCopy /Source:http://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:<sourcekey> /S /Y

**Задание многострочного файла ответа**

Предположим, что у нас есть файл ответа с именем  `copyoperation.txt`, содержащий следующие строки: Каждый параметр AzCopy задается на своей собственной строке:

	/Source:http://myaccount.blob.core.windows.net/mycontainer
	/Dest:C:\myfolder
	/SourceKey:<sourcekey>
	/S
	/Y

Чтобы вызвать AzCopy с этими файлами ответов, используйте команду:

	AzCopy /@:"C:\responsefiles\copyoperation.txt"

AzCopy обрабатывает эту команду, как если бы все индивидуальные параметры были включены в командную строку:	

	AzCopy /Source:http://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:<sourcekey> /S /Y

Обратите внимание, что каждый параметр AzCopy должен быть полностью задан на одной строке. Например, при выполнении AzCopy возникнет ошибка, если разделить параметр на две строки, как показано здесь для параметра  `/sourcekey`:

	http://myaccount.blob.core.windows.net/mycontainer
 	C:\myfolder
	/sourcekey:
	[sourcekey]
	/S
	/Y

### Указание подписи общего доступа (SAS)
	
**Указание SAS для исходного контейнера с помощью параметра /sourceSAS**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer1 /DestC:\myfolder /SourceSAS:SAS /S

**Указание SAS для исходного контейнера в URI исходного контейнера**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer1/?SourceSASToken /Dest:C:\myfolder /S

**Указание SAS для контейнера назначения с помощью параметра /destSAS**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer1 /DestSAS:SAS /Pattern:abc.txt

**Указание SAS для исходного контейнера и контейнера назначения**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer1 /Dest:https://myaccount.blob.core.windows.net/mycontainer2 /SourceSAS:SAS1 /DestSAS:SAS2 /Pattern:abc.txt

### Указание папки файла журнала

При каждом вводе команды для AzCopy выполняется проверка на наличие файла журнала в папке по умолчанию или в папке, которая была задана с помощью данного параметра. Если в обоих местах файл журнала отсутствует, AzCopy воспринимает операцию как новую и создает новый файл журнала.

Если файл журнала не существует, AzCopy проверяет, соответствует ли введенная командная строка командной строке в файле журнала. Если две командные строки совпадают, AzCopy возобновляет незавершенную операцию. Если они не совпадают, вам будет предложено либо переписать файл журнала, чтобы начать новую операцию, либо отменить текущую операцию. 

**Использование расположения по умолчанию для файла журнала**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /Z

Если опустить параметр  `/Z` или задать параметр  `/Z` без пути папки, как указано выше, AzCopy создает файл журнала в расположении по умолчанию:  `%SystemDrive%\Users\%username%\AppData\Local\Microsoft\Azure\AzCopy`. Если файл журнала уже существует, то AzCopy возобновляет операцию на основе файла журнала. 

**Задание настраиваемого расположения для файла журнала**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /Z:C:\journalfolder\

В этом примере создается файл журнала, если он еще не существует. Если такой файл существует, то AzCopy возобновляет операцию на основе файла журнала.

**Возобновление операции AzCopy**

	AzCopy /Z:C:\journalfolder\

В этом примере возобновляется последняя операция, при завершении которой произошел сбой.


### Создание файла журнала

**Запись в файл журнала с подробными данными в расположении по умолчанию**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /V

Если задать параметр  `/V` без указания пути файла в журнал с подробными данными, AzCopy создает файл журнала в расположении по умолчанию:  `%SystemDrive%\Users\%username%\AppData\Local\Microsoft\Azure\AzCopy`.

**Запись в файл журнала с подробными данными в настраиваемом расположении**

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.blob.core.windows.net/mycontainer /DestKey:key /V:C:\myfolder\azcopy1.log

Обратите внимание, что если задать относительный путь после параметра  `/V`, например,  `/V:test/azcopy1.log`, то журнал с подробными данными будет создан в текущем рабочем каталоге в вложенной папке с именем  `test`.


### Установка такого же времени последнего изменения загруженных файлов, как в исходных BLOB-объектах

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /MT

### Исключение BLOB-объектов из операции копирования на основании времени их последнего изменения

Задайте параметр  `/MT`, чтобы сравнить время последнего изменения исходного большого двоичного объекта и файла назначения.

**Исключение более новых больших двоичных объектов, чем файл назначения**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /MT /XN

**Исключение более старых больших двоичных объектов, чем целевой файл**

	AzCopy /Source:https://myaccount.blob.core.windows.net/mycontainer /Dest:C:\myfolder /SourceKey:key /MT /XO

### Задание количества одновременных операций для запуска

Параметр  `/NC` задает количество одновременных операций копирования. По умолчанию AzCopy начинает одновременные операции в количестве, в восемь раз превышающем имеющееся количество ядер процессоров. При выполнении AzCopy в сети с низкой пропускной способностью можно задать меньшее количество для этого параметра, чтобы избежать сбоев, вызванных конкуренцией за ресурсы.


### Запуск AzCopy с использованием ресурсов BLOB-объектов в эмуляторе хранилища

	AzCopy /Source:https://127.0.0.1:10004/myaccount/myfileshare/ /Dest:C:\myfolder /SourceKey:key /SourceType:Blob /S

### Синхронное копирование больших двоичных объектов между двумя конечными точками службы хранилища Azure

По умолчанию AzCopy выполняет асинхронное копирование данных между двумя конечными точками хранилища. Таким образом, операция копирования будет выполняться в фоновом режиме, используя свободную пропускную способность, для которой не предусмотрено соглашение об уровне обслуживания касательно скорости копирования большого двоичного объекта, и AzCopy будет периодически проверять состояние операции копирования до ее завершения или сбоя. 

Параметр  `/SyncCopy`, появившийся в выпуске 3.1.0, обеспечивает постоянную скорость операции копирования. AzCopy выполняет синхронное копирование, при котором большие двоичные объекты копируются из указанного источника в локальную память путем скачивания, а затем загружаются в целевое хранилище больших двоичных объектов.

	AzCopy /Source:https://myaccount1.blob.core.windows.net/myContainer/ /Dest:https://myaccount2.blob.core.windows.net/myContainer/ /SourceKey:key1 /DestKey:key2 /Pattern:ab /SyncCopy

Обратите внимание, что использование параметра /SyncCopy может влечь дополнительные затраты на исходящие данные по сравнению с асинхронным копированием. Во избежание таких затрат мы советует использовать этот параметр в виртуальных машинах Azure, которые находятся в одном регионе с вашей учетной записью хранения.

### Задание типа содержимого MIME целевого большого двоичного объекта

По умолчанию AzCopy задает для типа содержимого целевого большого двоичного объекта значение  `application/octet-stream`. Начиная с версии 3.1.0, вы можете задать тип содержимого с помощью параметра `/SetContentType:[content-type]`. Этот синтаксис задает тип содержимого для всех больших двоичных объектов в операции копирования.

	AzCopy /Source:C:\myfolder\ /Dest:https://myaccount.blob.core.windows.net/myContainer/ /DestKey:key /Pattern:ab /SetContentType:video/mp4

Если вы задали параметр  `/SetContentType`, не указав значение, AzCopy задаст тип содержимого для каждого большого двоичного объекта или файла в соответствии с расширением файла.

	AzCopy /Source:C:\myfolder\ /Dest:https://myaccount.blob.core.windows.net/myContainer/ /DestKey:key /Pattern:ab /SetContentType

##<a id="copy-files"></a>Копирование файлов в файловое хранилище Azure с помощью AzCopy (только для предварительной версии)

В приведенных ниже примерах рассматриваются различные сценарии копирования файлов Azure с помощью AzCopy.

### Загрузка файла из общей папки Azure в файловую систему

	AzCopy /Source:https://myaccount.file.core.windows.net/myfileshare/myfolder1/ /Dest:C:\myfolder /SourceKey:key /Pattern:abc.txt

Если исходный файл для копирования находится в общей папке Azure, то вам необходимо либо указать точное имя файла (*например, * `abc.txt`) для копирования одного файла или указать параметр  `/S` для копирования всех файлов в общей папке рекурсивно. Попытка одновременно задать шаблон файла и параметр  `/S` приведет к ошибке.

### Рекурсивная загрузка файлов и папок общей папки Azure в файловую систему

	AzCopy /Source:https://myaccount.file.core.windows.net/myfileshare/ /Dest:C:\myfolder /SourceKey:key /S

Обратите внимание, что пустые папки не копируются.


### Рекурсивная отправка файлов и папок из файловой системы в общую папку Azure

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.file.core.windows.net/myfileshare/ /DestKey:key /S

Обратите внимание, что пустые папки не копируются.


### Рекурсивная отправка файлов, соответствующих определенному шаблону файла, в общую папку Azure

	AzCopy /Source:C:\myfolder /Dest:https://myaccount.file.core.windows.net/myfileshare/ /DestKey:key /Pattern:ab* /S


### Синхронное копирование файлов в хранилище файлов Azure

С помощью нового параметра /SyncCopy в предварительной версии 4.1.0 пользователь может копировать файлы между хранилищами файлов, а также из хранилища файлов в хранилище больших двоичных объектов и наоборот.

	AzCopy /Source:https://myaccount1.file.core.windows.net/myfileshare1/ /Dest:https://myaccount2.file.core.windows.net/myfileshare2/ /SourceKey:key1 /DestKey:key2 /S

	AzCopy /Source:https://myaccount1.file.core.windows.net/myfileshare/ /Dest:https://myaccount2.blob.core.windows.net/mycontainer/ /SourceKey:key1 /DestKey:key2 /S
	
	AzCopy /Source:https://myaccount1.blob.core.windows.net/mycontainer/ /Dest:https://myaccount2.file.core.windows.net/myfileshare/ /SourceKey:key1 /DestKey:key2 /S

При копировании из хранилища файлов в хранилище больших двоичных объектов (тип большого двоичного объекта по умолчанию - блочный BLOB-объект) пользователь может указать параметр /BlobType:page, чтобы изменить тип целевого большого двоичного объекта.

Обратите внимание, что на момент выпуска предварительной версии AzCopy 4.1.0 служба хранилища Azure не поддерживала асинхронное копирование, поэтому указанные выше операции копирования закончатся сбоем, если не будет задан параметр /SyncCopy.


##<a id="copy-entities"></a> Копирование данных в таблицу Azure с помощью AzCopy (только для предварительной версии)

В приведенных ниже примерах рассматриваются различные сценарии копирования данных таблиц Azure с помощью AzCopy.

### Экспорт данных в локальную файловую систему

	AzCopy /Source:https://myaccount.table.core.windows.net/myTable/ /Dest:C:\myfolder\ /SourceKey:key

### Экспорт данных в BLOB-объект Azure

	AzCopy /Source:https://myaccount.table.core.windows.net/myTable/ /Dest:https://myaccount.blob.core.windows.net/mycontainer/ /SourceKey:key1 /Destkey:key2

AzCopy создает файл данных JSON в локальной папке или контейнере BLOB-объектов в соответствии с соглашением об именовании:

	<account name>_<table name>_<timestamp>_<volume index>_<CRC>.json

Созданный JSON-файл следует формату полезных метаданных. Подробную информацию о формате полезных данных см. в разделе [Формат полезных данных для операций службы таблиц](http://msdn.microsoft.com/library/azure/dn535600.aspx).

### Разделение экспортируемых файлов

	AzCopy /Source:https://myaccount.table.core.windows.net/mytable/ /Dest:C:\myfolder /SourceKey:key /S /SplitSize:100

AzCopy использует  *индекс тома* в именах разделенных файлов данных, чтобы отличить один файл от другого. Индекс тома состоит из двух частей:  *индекс диапазонов  ключей разделов* и  *индекс разделенного файла*. Оба индекса отсчитываются, начиная с нуля.

Индекс диапазонов ключей разделов будет равен 0, если пользователь не укажет параметр  `/PKRS` (более подробно об этом в следующем разделе).

Предположим, например, что AzCopy создает два файла данных после того, как пользователь задал значение параметра  `/SplitSize`. В таком случае конечные имена файлов могут выглядеть следующим образом:

	myaccount_mytable_20140903T051850.8128447Z_0_0_C3040FE8.json
	myaccount_mytable_20140903T051850.8128447Z_0_1_0AB9AC20.json

Обратите внимание, что минимальное возможное значение для  `/SplitSize` составляет 32 МБ. Если в качестве назначения задано хранилище больших двоичных объектов, AzCopy разделит файл данных, как только размер файла достигнет предельного значения (200 ГБ), не зависимости от того, задан ли пользователь параметр  `/SplitSize`.

### Экспорт данных в несколько потоков

	AzCopy /Source:https://myaccount.table.core.windows.net/myTable/ /Dest:C:\myfolder\ /SourceKey:key /PKRS:"aa#bb"

Если пользователь задал параметр  `/PKRS`, AzCopy начнет выполнение одновременных операций для экспорта сущностей. Каждая операция экспортирует объем данных равный значению объема, указанного в индексе диапазонов ключей секций.

Обратите внимание на то, что количество одновременных операций можно контролировать с помощью параметра  `/NC`. При копировании сущностей таблиц AzCopy использует информацию о количестве основных процессоров в качестве значения по умолчанию для параметра  `/NC`, даже если параметр  `/NC` не задан. Если пользователь задал параметр  `/PKRS`, AzCopy использует меньшее из двух значений (индекса диапазонов ключей разделов и явно или не явно заданный параметр количества одновременных операций), чтобы определить количество одновременных операций, которые можно запустить. Для получения более подробной информации введите  `AzCopy /?:NC` в командной строке.

### Импорт данных в несколько потоков

	AzCopy /Source:C:\myfolder\ /Dest:https://myaccount.table.core.windows.net/mytable1/ /DestKey:key /Manifest:"myaccount_mytable_20140103T112020.manifest" /EntityOperation:InsertOrReplace 

При экспорте данных таблиц AzCopy создает файл описания в конечной папке копирования или BLOB-объекте. Файл описания используется процессом для нахождения нужных файлов и проверки корректности данных в файлах во время импорта. Файл описания использует следующее соглашение о наименовании:

	<account name>_<table name>_<timestamp>.manifest

Параметр  `/EntityOperation` определяет способ размещения данных в таблице. Возможные значения:

- `InsertOrSkip`: Пропускает существующий объект или вставляет новый, если объект не существует в таблице.
- `InsertOrMerge`: Объединяет существующий объект или вставляет новый, если объект не существует в таблице.
- `InsertOrReplace`: Заменяет существующий объект или вставляет новый, если объект не существует в таблице.

Обратите внимание на то, что вы не можете задать значение параметра  `/PKRS` в сценарии импорта данных. В отличие от сценария экспорта данных, в котором необходимо задавать параметр  `/PKRS` для начала одновременных операций, при экспорте сущностей AzCopy по умолчанию задает параметр передачи в несколько потоков. Количество потоков по умолчанию соответствует количеству основных процессоров. Однако, вы можете задать свое значение с помощью параметра  `/NC`. Для получения более подробной информации введите  `AzCopy /?:NC` в командной строке.


##<a id="versions"></a> Версии AzCopy

| Версия | Новые возможности                                                                                      				|
|---------|-----------------------------------------------------------------------------------------------------------------|
| **V4.1.0**  | **Текущая предварительная версия. Включает в себя весь набор функциональных возможностей версии 3.1.0. Она поддерживает синхронное копирование больших двоичных объектов и файлов и позволяет указывать тип содержимого для целевых больших двоичных объектов и файлов**	
| **V3.1.0**  | **Текущая версия выпуска. Она поддерживает синхронное копирование больших двоичных объектов и позволяет указывать тип содержимого для целевых больших двоичных объектов.**
| V4.0.0  | Включает в себя весь набор функциональных возможностей версии 3.0.0. Версия поддерживает возможность копирования файлов в хранилище файлов Azure и импорт файлов из него, а также копирование данных в хранилище таблиц Azure и извлечение данных из него.
| V3.0.0  | Изменен синтаксис командной строки AzCopy: теперь необходимо указывать имя параметра. Изменен внешний вид справки по командной строке. Данная версия поддерживает только копирование данных в BLOB-объекты и копирование данных из них.	
| V2.5.1  | Повышена производительность при использовании /xo и /xn. Исправлены ошибки, возникающие при наличии в имени исходного файла специальных символов, а также появление ошибок в файле журнала из-за неправильного введения команд пользователем в командной строке.	
| V2.5.0  | Улучшена производительность при крупномасштабных сценариях копирования, а также реализовано несколько важных улучшений для повышения удобства использования.	
| V2.4.1  | Поддерживает указание папки назначения в мастере установки.                     			
| V2.4.0  | Поддерживает отправку и скачивание файлов для хранилища файлов Azure.                       				                              
| V2.3.0  | Поддерживает геоизбыточные учетные записи хранения для доступа с правом чтения.                                                  			|
| V2.2.2  | Обновлена для использования библиотеки клиента хранилища Azure версии 3.0.3.                                            				                    
| V2.2.1  | Устранены проблемы с производительностью при копировании большого количества файлов в пределах одной учетной записи хранения.            				                                                
| V2.2    | Поддерживает задание разделителя виртуального каталога для имен больших двоичных объектов. Поддерживает задание пути файла журнала.		|
| V2.1    | Предоставляет более 20 параметров для выполнения эффективных операций отправки, загрузки и копирования больших двоичных объектов.		|


##<a id="next-steps"></a> Дальнейшие действия

Для получения дополнительной информации о хранилище Azure и AzCopy см. следующие ресурсы.

### Документация по хранилищу Azure:

- [Введение в хранилище Azure](http://azure.microsoft.com/documentation/articles/storage-introduction/)
- [Хранение файлов в хранилище больших двоичных объектов](http://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-blobs/)
- [Создание общей папки SMB в Azure с помощью хранилища файлов](http://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-files/)

### Записи блога по хранилищу Azure:
- [AzCopy: Введение в синхронное копирование и настраиваемый тип содержимого](http://blogs.msdn.com/b/windowsazurestorage/archive/2015/01/13/azcopy-introducing-synchronous-copy-and-customized-content-type.aspx)
- [AzCopy: AzCopy 3.0. Выпуск общедоступной версии AzCopy 3.0 и предварительной версии AzCopy 4.0 с поддержкой таблиц и файлов](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/10/29/azcopy-announcing-general-availability-of-azcopy-3-0-plus-preview-release-of-azcopy-4-0-with-table-and-file-support.aspx)
- [AzCopy: оптимизированные сценарии для крупномасштабного копирования](http://go.microsoft.com/fwlink/?LinkId=507682)
- [Введение в службы файлов Microsoft Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/12/introducing-microsoft-azure-file-service.aspx)
- [AzCopy: поддержка геоизбыточного хранилища для доступа с правом чтения](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/04/07/azcopy-support-for-read-access-geo-redundant-account.aspx)
- [AzCopy: передача данных с использованием перезапускаемого режима и маркера SAS](http://blogs.msdn.com/b/windowsazurestorage/archive/2013/09/07/azcopy-transfer-data-with-re-startable-mode-and-sas-token.aspx)
- [AzCopy: использование копирования BLOB-объектов между разными учетными записями](http://blogs.msdn.com/b/windowsazurestorage/archive/2013/04/01/azcopy-using-cross-account-copy-blob.aspx)
- [AzCopy: отправка/ загрузка файлов для BLOB-объектов Windows Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/12/03/azcopy-uploading-downloading-files-for-windows-azure-blobs.aspx)


<!--HONumber=42-->
