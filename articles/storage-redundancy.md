
<properties 
  pageTitle="Варианты избыточности службы хранилища Azure|Microsoft Azure" 
  description="Данные в учетной записи хранения Microsoft Azure всегда реплицируются, обеспечивая устойчивость и высокий уровень доступности. Узнайте о вариантах репликации учетной записи хранения Azure" 
  services="storage" 
  documentationCenter="" 
  authors="tamram" 
  manager="adinah" 
  editor=""/>

<tags 
  ms.service="storage" 
  ms.workload="storage" 
  ms.tgt_pltfrm="na" 
  ms.devlang="na" 
  ms.topic="article" 
  ms.date="03/20/2015" 
  ms.author="tamram"/>

# Варианты избыточности службы хранилища Azure



Данные в учетной записи хранения Microsoft Azure всегда реплицируются, обеспечивая устойчивость, высокий уровень доступности и соответствие [соглашению об уровне обслуживания для службы хранилища Azure](http://azure.microsoft.com/support/legal/sla/) даже при временных сбоях оборудования. Сведения об устойчивости архитектуры в службе хранилища Azure см. в [документе SOSP службы хранилища Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).

При создании учетной записи хранения необходимо выбрать один из следующих вариантов репликации.  

- **Локально избыточное хранилище (LRS).** Локально избыточное хранилище обслуживает три копии ваших данных. LRS реплицируется три раза в одном помещении в одном регионе. LRS защищает ваши данные от обычных сбоев оборудования, но не от сбоев в одном помещении.
  
LRS предлагается со скидкой. Для максимальной устойчивости рекомендуется использовать геоизбыточное хранилище, описанное ниже.


- **Хранилище, избыточное в пределах зоны (ZRS).** Хранилище, избыточное в пределах зоны обслуживает три копии ваших данных. ZRS реплицируется три раза в двух-трех помещениях одном или двух регионах, обеспечивая более высокую устойчивость по сравнению с LRS. ZRS гарантирует устойчивость данных в одном регионе.
Уровень устойчивости ZRS выше, чем в LRS, однако для максимальной устойчивости рекомендуется использовать геореплицированное хранилище, описанное ниже.  

	> [AZURE.NOTE] ZRS в настоящее время доступно только для блочных BLOB-объектов.  
	> После создания учетной записи хранения и выбора хранилища, избыточного в пределах зоны, невозможно преобразовать его для использования другого типа репликации или наоборот.
 


- **Геоизбыточное хранилище (GRS)**. Геоизбыточное хранилище включается для учетной записи хранения при создании по умолчанию. GRS хранит шесть копий ваших данных. С GRS ваши данные реплицируются три раза в первичном регионе, а также три раза во вторичном регионе, который находится с сотнях километров от первичного, для самого высокого уровня устойчивости. В случае сбоя в первичном регионе хранилище Azure выполнит отработку отказа во вторичном регионе. GRS гарантирует устойчивость данных в двух отдельных регионах.


- **Геоизбыточное хранилище с доступом для чтения (RA-GRS)**. Геоизбыточное хранилище с доступом для чтения служит для репликации ваших данных в дополнительное географическое местоположение, а также обеспечивает доступ для чтения к вашим данным в дополнительном местоположении. Геоизбыточное хранилище с доступом для чтения позволяет получать доступ к данным из основного или дополнительного расположения в случае, если одно из расположений становится недоступным.

	> [AZURE.IMPORTANT] Вы можете изменить способ репликации данных после создания учетной записи хранения, но обратите внимание, что с вас могут взять дополнительную плату за единовременную передачу данных, если вы перейдете с LRS на GRS или RA-GRS. Если вы выберете GRS при создании учетной записи, вы не сможете впоследствии переключиться на другой тип репликации; то же касается других способов репликации.
 

В таблице ниже представлено краткое описание различий между LRS, ZRS, GRS и RA-GRS, а в следующих разделах каждый тип репликации представлен более подробно.


|Стратегия репликации|LRS|ZRS|GRS|RA-GRS 
|--------------------|---|---|---|------
|Данные реплицируются в нескольких помещениях|Нет|Да|Да|Да|
|Данные могут быть считаны как из первичного, так и из вторичного местоположения|Нет|Нет|Нет|Да
|Количество обслуживаемых копий данных на отдельных узлах|3|3|6|6
 

Сведения о ценах на репликацию учетной записи хранения см. в разделе [Сведения о ценах на хранилище.](http://azure.microsoft.com/pricing/details/storage/)

## Локально избыточное хранилище (LRS)

Локально избыточное хранилище реплицирует ваши данные в регионе, в котором создана учетная запись хранения. Для максимальной устойчивости каждый запрос данных в учетной записи хранения реплицируется три раза. Эти три реплики хранятся в отдельных доменах сбоя и доменах обновления. Домен сбоя - это группа узлов, представляющая физическую единицу сбоя, которая может рассматриваться как узлы, принадлежащие одному физическом блоку. Домен обновления - это группа узлов, которые обновляются одновременно во время обновления службы (развертывания). Эти три реплики распределяются по доменам обновления и доменам сбоя, обеспечивая доступность данных, даже если сбой оборудования затрагивает один блок, а также при обновлении узлов во время развертывания. Запрос возвращается только после того, как его записывают во все три реплики.

Хотя для большинства приложений рекомендуется использовать геоизбыточное хранилище, в некоторых случаях может потребоваться локально избыточное хранилище:  

- LRS дешевле, чем GRS, а также предоставляет более высокую пропускную способность. Если в вашем приложении хранятся данные, которые можно легко воссоздать, можно выбрать LRS.

- Некоторые приложения реплицируют данные только в одном регионе из-за нормативных требований.

- Если в приложении содержится собственная стратегия георепликации, GRS может не потребоваться.


## Хранилище, избыточное в пределах зоны(ZRS)

Хранилище, избыточное в пределах зоны, реплицирует данные в двух-трех помещениях в одном или двух регионах, предоставляя более высокую доступность по сравнению с LRS. Если в вашей учетной записи хранения включена репликация ZRS, данные будут устойчивы даже в случае сбоя в одном из помещений.


>[AZURE.NOTE]  ZRS в настоящее время доступно только для блочных BLOB-объектов. Обратите внимание, что после создания учетной записи хранения и выбора хранилища, избыточного в пределах зоны, невозможно преобразовать его для использования другого типа репликации или наоборот.


## Геоизбыточное хранилище (GRS)


Геоизбыточное хранилище реплицирует данные во вторичный регион, который находится в сотнях километров от первичного региона. Если в учетной записи хранения включена репликация GRS, данные будут устойчивы даже в случае отключения электричества во всем регионе или аварии, при которой первичный регион не может быть восстановлен. 

Для учетной записи хранения с GRS обновление фиксируется сначала в первичном регионе, где оно реплицируется три раза. Затем обновление реплицируется во вторичном регионе (также три раза) в разных доменах сбоя и доменах обновления.

 
> [AZURE.NOTE] С GRS запросы на запись данных реплицируются асинхронно во вторичный регион. Важно обратить внимание, что выбор GRS не влияет на задержку запросов в первичном регионе. Однако так как асинхронная репликация подразумевает задержку, в случае региональной аварии есть вероятность, что изменения, еще не реплицированные во вторичный регион, могут быть потеряны, если данные будет невозможно восстановить из первичного региона.
 
При создании учетной записи хранения вы выбираете первичный регион для учетной записи. Вторичный регион определяется на основе первичного региона, его невозможно изменить. В таблице ниже показаны пары первичных и вторичных регионов:

|Первичный            |Вторичный        
| ---------------   |----------------
|Северо-Центральный регион США   |Юго-Центральный регион США
|Юго-Центральный регион США   |Северо-Центральный регион США
|Восточная часть США            |Западная часть США        
|Западная часть США            |Восточная часть США         
|Восточная часть США 2          |Центральная часть США      
|Центральная часть США         |Восточная часть США 2       
|Северная Европа       |Западная Европа     
|Западная Европа        |Северная Европа    
|Юго-Восточная Азия    |Восточная Азия       
|Восточная Азия          |Юго-Восточная Азия 
|Восточный Китай         |Северный Китай     
|Северный Китай        |Восточный Китай      
|Восточная Япония         |Западная Япония      
|Западная Япония         |Восточная Япония      
|Южная Бразилия       |Юго-Центральный регион США
|Восточная Австралия     |Юго-Восточная Австралия
|Юго-Восточная Австралия|Восточная Австралия  

 
## Геоизбыточное хранилище с доступом для чтения (RA-GRS)

Геоизбыточное хранилище с доступом для чтения максимально увеличивает доступность для учетной записи хранения, обеспечивая доступ только для чтения к данным во вторичном местоположении в дополнение к репликации в двух регионах, предоставленной в GRS. В случае недоступности данных в первичном регионе ваше приложение может считывать данные из вторичного региона.

При включении доступа только для чтения для данных во вторичном регионе ваши данные будут доступны как в первичной конечной точке, так и во вторичной конечной точке учетной записи хранения. Вторичная конечная точка аналогична первичной конечной точке, но к имени учетной записи добавляется суффикс -secondary. Например, если первичная конечная точка для службы BLOB-объектов -  `myaccount.blob.core.windows.net`, то вторичная конечная точка -  `myaccount-secondary.blob.core.windows.net`. Ключи доступа для учетной записи хранения одинаковые как для первичной, так и для вторичной конечных точек.

## Дальнейшие действия

- [Целевые платформы масштабирования и производительности службы хранилища Azure](storage-scalability-targets.md) 
- [Варианты избыточности и геоизбыточное хранилище с доступом для чтения службы хранилища Microsoft Azure ](http://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx)
- [Эмулятор службы хранилища Microsoft Azure 3.1 с RA-GRS ](http://blogs.msdn.com/b/windowsazurestorage/archive/2014/05/08/microsoft-azure-storage-emulator-3-1-with-ra-grs.aspx)
- [Документ SOSP службы хранилища Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx)


<!--HONumber=52-->