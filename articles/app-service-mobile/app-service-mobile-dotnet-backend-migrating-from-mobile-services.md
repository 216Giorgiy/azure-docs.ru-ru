<properties 
	pageTitle="Миграция из мобильных служб в мобильное приложение службы приложений" 
	description="Простая миграция приложения мобильных служб в мобильное приложение службы приложений" 
	services="app-service\mobile" 
	documentationCenter="" 
	authors="mattchenderson" 
	manager="dwrede" 
	editor=""/>

<tags 
	ms.service="app-service-mobile" 
	ms.workload="mobile" 
	ms.tgt_pltfrm="mobile" 
	ms.devlang="dotnet" 
	ms.topic="article" 
	ms.date="11/04/2015" 
	ms.author="mahender"/>

# Перенос существующего приложения мобильной службы Azure .NET в службу приложений 

В этом разделе показано, как выполнить миграцию существующего приложения из мобильных служб Azure в новое мобильное приложение службы приложений. Все существующие приложения мобильных служб можно легко перенести в новое мобильное приложение службы приложений. Во время миграции существующее приложение мобильных служб может продолжить работать.

>[AZURE.NOTE]В настоящее время миграцию серверных мобильных служб .NET в службу приложений можно выполнить вручную. Выпуск готовой среды миграции для Node.js и .NET ожидается в ближайшее время. Тем не менее, при выполнении миграции вручную вы *не можете* сохранить существующий URL-адрес **service.azure mobile.net**.

При переносе приложения в службу приложений Azure оно получает доступ ко всем возможностям службы приложений. Тарификация при этом будет осуществляться в соответствии с [ценами службы приложений], а не мобильных служб.

### <a name="why-host"></a>Каковы преимущества размещения в службе приложений?

Служба приложения позволяет использовать расширенные возможности среды размещения при работе с приложением. Кроме того, приложению предоставляется доступ к промежуточным слотам, пользовательским доменам, поддержке диспетчера трафика и многим другим функциям. Хотя вы можете [перенести мобильную службу в мобильное приложение в службе приложений], у некоторых клиентов может возникнуть необходимость воспользоваться преимуществами этих функций немедленно, т. е. без предварительного обновления пакета SDK.

Основное ограничение при размещении в службе приложений — отсутствие интеграции запланированных заданий мобильных служб. Кроме того, вам нужно настроить планировщик Azure для вызова пользовательских API, а также включить функции веб-заданий.

Дополнительные сведения о преимуществах службы приложений см. в статье [Сравнение мобильных служб и службы приложений].

##Миграция или обновление

[AZURE.INCLUDE [app-service-mobile-migrate-vs-upgrade](../../includes/app-service-mobile-migrate-vs-upgrade.md)]

  - Для проектов серверов на основе Node.js новый [пакет SDK Node.js для мобильных приложений](https://github.com/Azure/azure-mobile-apps-node) обеспечивает ряд новых возможностей. Например, теперь можно осуществлять локальную разработку и отладку, использовать любую версию Node.js выше 0.10 и выполнять настройку с любой версией ПО промежуточного слоя Express.js.

  - Для проектов серверов на основе .NET новые [пакеты NuGet пакета SDK для мобильных приложений](https://www.nuget.org/packages/Microsoft.Azure.Mobile.Server/) обеспечивают дополнительную гибкость для зависимостей NuGet, поддерживают новые возможности проверки подлинности службы приложений и совместимы с любыми проектами ASP.NET, включая MVC. Дополнительные сведения об обновлении см. в разделе [Обновление существующего приложения мобильной службы .NET до службы приложений](app-service-mobile-net-upgrading-from-mobile-services.md).


##<a name="understand"></a>Общие сведения о мобильных приложениях службы приложений 

Мобильное приложение службы приложений — это новый способ сборки мобильных приложений с помощью Microsoft Azure. Дополнительные сведения о мобильных приложениях см. в разделе [Что такое мобильные приложения].

При миграции в мобильные службы все существующие функции приложений (и код) можно сохранить. Более того, в приложении доступны новые функции. В модели мобильных служб код фактически выполняется в веб-приложении (новая версия веб-сайтов Azure). Вы получите полный контроль над веб-приложением и его работой. Кроме того, теперь можно использовать функции веб-приложений, которые были ранее недоступны в мобильных службах, например диспетчер трафика и слоты развертывания.


##Ручная миграция для внутреннего сервера .NET мобильных служб

В этом разделе показано, как разместить проект мобильных служб .NET в службе приложений Azure. Для работы с приложениями, размещенными в службе приложений, можно использовать все учебники .NET для *мобильных служб* среды выполнения. Вам только нужно будет заменить домен azure-mobile.net во всех соответствующих URL-адресах доменом экземпляра службы приложений.

Вы можете разместить проект мобильных служб и в [среде службы приложений]. Все содержимое этого учебника будет актуальным, кроме того, что адрес сайта вместо contoso.contosoase.p.azurewebsites.net формы будет выглядеть так: contoso.azurewebsites.net.

>[AZURE.NOTE]При выполнении миграции вручную вы *не можете* сохранить существующий URL-адрес **service.azure mobile.net**. При наличии мобильных клиентов, подключающихся к этому URL-адресу, следует использовать автоматическую миграцию или не отключать мобильную службу до завершения обновления URL-адреса для всех мобильных клиентов.


### <a name="app-settings"></a>Параметры приложения
Для работы мобильных служб требуется, чтобы в среде были доступны различные параметры приложения, которые описаны в этом разделе.

Чтобы задать параметры приложения в своем веб-приложении, сначала войдите на [портал управления предварительной версии Azure]. Перейдите к веб-приложению, мобильному приложению или приложению API, которое будет использоваться, и выберите "Параметры" и "Параметры приложения". Перейдите в раздел "Параметры приложения". Здесь вы можете задать необходимые значения соответствующим ключам.
 
Для параметра **MS\_MobileServiceName** нужно указать имя приложения. Например, если вы собираетесь запустить приложение с URL-адресом contoso.azurewebsites.net, правильным значением будет contoso.
 
Для параметра **MS\_MobileServiceDomainSuffix** нужно указать имя веб-приложения. Например, если вы собираетесь запустить приложение с URL-адресом contoso.azurewebsites.net правильным значением будет azurewebsites.net.
 
Для параметра **MS\_ApplicationKey** можно указать любое значение, но оно должно совпадать со значением, которое используется в пакете SDK для клиента. Рекомендуется использовать идентификатор GUID.
 
Для параметра **MS\_MasterKey** можно указать любое значение, но оно должно совпадать со значением, которое используется в API или клиенте администратора. Рекомендуется использовать идентификатор GUID.
 
При перемещении существующего приложения мобильных служб главный ключ и ключ приложения можно получить на вкладке "Настройка" в разделе "Мобильные службы" [портала управления Azure]. Выберите действие "Управление ключами" внизу и скопируйте ключи.


### <a name="client-sdk"></a>Изменение параметров пакета SDK клиента

В проекте клиентского приложения измените параметры конструктора клиентского объекта мобильных служб для принятия нового URL-адреса приложения (например, `https://contoso.azurewebsites.net`) и ключа приложения, настроенного ранее. Используйте версию пакета SDK для **мобильных служб**, которая **не** должна обновляться. Для клиентов iOS и Android используйте версии 2.x, а для Windows и Xamarin — версию 1.3.2. С клиентами JavaScript должна использоваться версия 1.2.7.

### <a name="data"></a>Включение функций для работы с данными

Для работы с классами платформы Entity Framework по умолчанию в мобильных службах требуются два дополнительных параметра приложения.
 
Строки подключения хранятся в разделе "Строки подключения" колонки **Параметры приложения** сразу под одноименным разделом. Строка подключения для базы данных должна быть указана в ключе **MS\_TableConnectionString**. Для перемещения существующего приложения мобильных служб на портале мобильных служб перейдите в раздел "Строки подключения" вкладки "Настройка". Щелкните "Показать строки подключения" и скопируйте значение.
 
По умолчанию используется схема **MS\_MobileServiceName**, но это может быть переопределено с помощью параметра **MS\_TableSchema**. Вернитесь в раздел **Параметры приложения** и укажите имя используемой схемы **MS\_TableSchema**. При перемещении существующего приложения мобильных служб используется схема, созданная с помощью Entity Framework. Речь идет об имени мобильной службы, а не экземпляре службы приложения с размещаемым кодом.

### <a name="push"></a>Включение функций push-уведомлений

Чтобы включить функцию отправки push-уведомлений, вам нужно предоставить веб-приложению информацию о центре уведомлений.
 
В разделе "Строки подключения" укажите для параметра **MS\_NotificationHubConnectionString** строку подключения DefaultFullSharedAccessSignature для центра уведомлений. Для перемещения существующего приложения мобильных служб на портале мобильных служб перейдите в раздел "Строки подключения" вкладки "Настройка". Щелкните "Показать строки подключения" и скопируйте значение.

Присвойте параметру **MS\_NotificationHubName** приложения имя центра уведомлений. При перемещении существующего приложения мобильных служб это значение можно получить на портале мобильных служб на вкладке push-уведомлений. Другие поля на этой вкладке уже связаны с центром уведомлений, и их значения не нужно копировать.
 
### <a name="auth"></a>Включение функций проверки подлинности

Для работы функций идентификации также необходимо настроить параметры приложения для отдельных поставщиков. При перемещении мобильных служб из существующего приложения каждому полю на вкладке идентификации на портале мобильных служб соответствует определенный параметр приложения.
 
Учетная запись Майкрософт

* **MS\_MicrosoftClientID**

* **MS\_MicrosoftClientSecret**

* **MS\_MicrosoftPackageSID**
 
Facebook

* **MS\_FacebookAppID**

* **MS\_FacebookAppSecret**
 
Twitter

* **MS\_TwitterConsumerKey**

* **MS\_TwitterConsumerSecret**
 
Google

* **MS\_GoogleClientID**

* **MS\_GoogleClientSecret**
 
AAD

* **MS\_AadClientID**

* **MS\_AadTenants**. Примечание. Параметр **MS\_AadTenants** сохраняется как разделенный запятыми список доменов клиента (поля "Разрешенные клиенты" на портале мобильных служб).

### <a name="publish"></a>Публикация проекта мобильных служб

1. На портале предварительной версии перейдите в приложение и щелкните на панели команд "Получить профиль публикации". Сохраните загруженный профиль на локальном компьютере.
2. В Visual Studio щелкните правой кнопкой мыши серверный проект и выберите "Опубликовать". На вкладке "Профиль" выберите "Импорт" и найдите загруженный профиль.
3. Нажмите кнопку "Опубликовать", чтобы развернуть код в службе приложений.

Журналы обрабатываются с использованием стандартных функций ведения журнала службы приложений. Дополнительные сведения о ведении журнала см. в разделе [Включение ведения журнала диагностики в службе приложений Azure].



<!-- URLs. -->

[портал управления предварительной версии Azure]: https://portal.azure.com/
[портала управления Azure]: https://manage.windowsazure.com/
[Что такое мобильные приложения]: app-service-mobile-value-prop.md
[I already use web sites and mobile services – how does App Service help me?]: /ru-RU/documentation/articles/app-service-mobile-value-prop-migration-from-mobile-services
[Mobile App Server SDK]: http://www.nuget.org/packages/microsoft.azure.mobile.server
[Create a Mobile App]: app-service-mobile-xamarin-ios-get-started.md
[Add push notifications to your mobile app]: app-service-mobile-xamarin-ios-get-started-push.md
[Add authentication to your mobile app]: app-service-mobile-xamarin-ios-get-started-users.md
[Azure Scheduler]: /ru-RU/documentation/services/scheduler/
[Web Job]: ../app-service-web/websites-webjobs-resources.md
[Send cross-platform push notifications]: app-service-mobile-xamarin-ios-push-notifications-to-user.md
[How to use the .NET server SDK]: app-service-mobile-dotnet-backend-how-to-use-server-sdk.md


[Включение ведения журнала диагностики в службе приложений Azure]: web-sites-enable-diagnostic-log.md
[ценами службы приложений]: https://azure.microsoft.com/ru-RU/pricing/details/app-service/
[среде службы приложений]: app-service-app-service-environment-intro.md
[Сравнение мобильных служб и службы приложений]: app-service-mobile-value-prop-migration-from-mobile-services-preview.md
[перенести мобильную службу в мобильное приложение в службе приложений]: app-service-mobile-dotnet-backend-migrating-from-mobile-services-preview.md

<!---HONumber=Nov15_HO3-->