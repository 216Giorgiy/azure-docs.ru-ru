<properties
	pageTitle="Установка и настройка Azure PowerShell"
	description="Сведения об установке и настройке Azure PowerShell."
	editor="tysonn"
	manager="stevenka"
	documentationCenter=""
	services=""
	authors="coreyp69"/>

<tags
	ms.service="multiple"
	ms.workload="multiple"
	ms.tgt_pltfrm="powershell"
	ms.devlang="na"
	ms.topic="article"
	ms.date="02/20/2015"
	ms.author="coreyp"/>

# Установка и настройка Azure PowerShell#

<div class="dev-center-tutorial-selector sublanding"><a href="/manage/install-and-configure-windows-powershell/" title="PowerShell" class="current">PowerShell</a><a href="/manage/install-and-configure-cli/" title="Cross-Platform CLI">Кроссплатформенный интерфейс командной строки</a></div>

С помощью Windows PowerShell можно выполнять различные задачи в Azure в интерактивном режиме, в командной строке или автоматически с помощью сценариев. Azure PowerShell - это модуль, предоставляющий командлеты для управления Azure с помощью Windows PowerShell. Эти командлеты можно использовать для создания, тестирования, развертывания решений и служб на платформе Azure и управления ими. В большинстве случаев с помощью командлетов можно выполнять те же задачи, которые доступны на портале управления Azure. Например, можно создавать и настраивать облачные службы, виртуальные машины, виртуальные сети и веб-приложения. 

Этот модуль распространяется в виде загружаемого файла, а управление исходным кодом осуществляется с помощью общедоступного репозитория. Ссылки на загружаемые файлы приведены в инструкциях по установке далее в этом разделе. Сведения об исходном коде см. в [репозитории кода Azure PowerShell](https://github.com/Azure/azure-powershell).

В данном руководстве представлены основные сведения об установке и настройке Azure PowerShell для управления платформой Azure.

### <a id="Prereq"></a>Необходимые компоненты для использования Azure PowerShell

Azure - это платформа на основе подписок. Это означает, что для использования платформы требуется подписка. В большинстве случаев это также означает, что при использовании командлетов для выполнения задач, связанных с подпиской, требуются сведения об этой подписке. (Некоторые командлеты, связанные с хранилищем, можно использовать без этой информации.) Эти сведения задаются при настройке подключения компьютера к вашей подписке. Инструкции представлены в этой статье, в разделе "Практическое руководство. Подключение к подписке".

> [AZURE.NOTE] Начиная с версии 0.8.5 для модулей Azure PowerShell требуется Microsoft .NET Framework 4.5.

При установке модуля установщик проверяет систему на наличие необходимого программного обеспечения и устанавливает все зависимости, такие как нужная версия Windows PowerShell и платформа .NET Framework.

<h2> <a id="Install"></a>Практическое руководство. Установка Azure PowerShell</h2>

Вы можете скачать и установить модули Azure PowerShell, запустив [установщик веб-платформы Майкрософт](http://go.microsoft.com/fwlink/p/?LinkId=320376). При появлении запроса нажмите кнопку **Запуск**. Установщик веб-платформы установит модули Azure PowerShell и все зависимости. Следуйте инструкциям на экране для завершения установки.

> [AZURE.NOTE] Если вы хотите просто скачать установщик PowerShell, перейдите по ссылке https://github.com/Azure/azure-powershell/releases.
Исходный код для командлетов PowerShell можно также найти в этом репозитории.

Дополнительные сведения о программах командной строки Azure см. в разделе [Программы командной строки]( http://go.microsoft.com/fwlink/?LinkId=320796).

При установке модуля также устанавливается специальная консоль для Azure PowerShell. Командлеты можно выполнять в стандартном модуле PowerShell или в консоли Azure PowerShell.

Метод, используемый для открытия консоли, зависит от используемой версии Windows:

- На компьютере под управлением Windows 8, Windows Server 2012 или более поздних версий можно использовать встроенный поиск. На начальном экране введите **power**. В результате вы получите список приложений, включающий Windows PowerShell и Azure PowerShell. Чтобы открыть консоль, щелкните любое приложение. (Для закрепления приложения на начальном экране щелкните значок правой кнопкой мыши.)

- На компьютере под управлением Windows более ранней версии, чем Windows 8 или Windows Server 2012, можно использовать меню "Пуск". В меню "Пуск" последовательно щелкните пункты **Все программы**, **Azure**, **Azure PowerShell**.

<h2><a id="Connect"></a>Практическое руководство. Подключение к подписке</h2>

Для использования Azure требуется подписка. Если у вас нет подписки, см. раздел [Начало работы с Azure](http://go.microsoft.com/fwlink/p/?LinkId=320795).

Командлетам необходима ваша подписка для управления службами. Есть два способа предоставить данные подписки в Windows PowerShell. Можно использовать сертификат управления, который содержит нужные данные, или можно войти в Azure с использованием учетной записи Майкрософт или рабочей учетной записи. Когда вы входите, Azure Active Directory (Azure AD) проверяет учетные данные и возвращает маркер доступа, который позволяет Azure PowerShell управлять вашей учетной записью.

Чтобы помочь вам выбрать метод проверки подлинности, который вам подходит, необходимо учитывать следующее:

- Azure AD является рекомендованным методом аутентификации, поскольку с ним проще управлять доступом к подписке. С обновлением в версии 0.8.6 он также поддерживает сценарий автоматизации с проверкой подлинности Azure AD при использовании рабочей учетной записи. Также работает с API диспетчера ресурсов Azure.
- При использовании метода с сертификатом информация о подписке доступна, пока подписка и сертификат действительны. Однако этот метод затрудняет управление доступом к общим подпискам, например, когда несколько пользователей обладают доступом к учетной записи. Также API диспетчера ресурсов Azure не принимает проверку подлинности на основе сертификата.

Дополнительные сведения о проверке подлинности и управлении подписками в Azure см. в разделе [Управление учетными записями, подписками и административными ролями](http://go.microsoft.com/fwlink/?LinkId=324796).

<h3>Использование метода Azure AD</h3>

1. Откройте консоль Azure PowerShell, как описано в разделе [Практическое руководство. Установка Azure PowerShell](#Install).

2. Введите следующую команду:

		Add-AzureAccount

3. В окне введите адрес электронной почты и пароль, связанные с вашей учетной записью.

4. Azure выполняет проверку подлинности и сохраняет учетные данные, а затем закрывает окно.

5. Начиная с версии 0.8.6 при входе с помощью рабочей учетной записи вы можете ввести следующую команду, чтобы обойти всплывающее окно. При этом появляется стандартное окно ввода учетных данных Windows PowerShell, где следует указать имя пользователя и пароль рабочей учетной записи.

        $cred = Get-Credential
        Add-AzureAccount -Credential $cred

    > Дополнительные сведения о безопасности и использовании учетных данных см. в разделе [Рекомендации для развертывания паролей и других конфиденциальных данных в ASP.NET и на веб-сайтах Azure](http://www.asp.net/identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure).


	> [AZURE.NOTE] Этот неинтерактивный метод входа работает только с рабочей учетной записью.  Рабочая учетная запись - это учетная запись, которой управляет соответствующая организация; она задается в Azure Active Directory для вашей организации. Если вы используете для входа в подписку Azure учетную запись Майкрософт, вы можете создать рабочую учетную запись, выполнив следующие действия.
	>
	> 1. Войдите на [портал управления Azure](https://manage.windowsazure.com) и щелкните **Active Directory**.
	>
	> 2. Если каталог не существует, выберите **Создание каталога** и укажите нужные данные.
	>
	> 3. Выберите каталог и добавьте нового пользователя. Этот новый пользователь может войти, используя рабочую учетную запись.
	>
	>     При создании пользователя вам будут предоставлены электронной адрес и временный пароль. Эти данные используются на следующем шаге. Сохраните их.
	>
	> 4. На портале управления выберите **Параметры** и затем **Администраторы**. Щелкните **Добавить**, чтобы добавить нового пользователя в качестве соадминистратора. Это позволит использовать вашу рабочую учетную запись для управления подпиской Azure.
	>
	> 5. Выйдите из портала Azure и затем войдите снова с использованием новой рабочей учетной записи. При первом входе в учетную запись появится запрос на изменение пароля.
	>
	>Дополнительные сведения о регистрации в Microsoft Azure с помощью рабочей учетной записи см. в разделе [Регистрация организации в Microsoft Azure](sign-up-organization.md).

<h3>Использование сертификата</h3>

Модуль Azure содержит командлеты, с помощью которых можно скачать и импортировать сертификат.

> [AZURE.NOTE] Для командлетов в модуле AzureResourceManager требуется метод Azure AD (Add-AzureAccount). Эти командлеты не поддерживают файлы параметров публикации. Дополнительные сведения о командлетах в модуле AzureResourceManager см. в разделе [Командлеты диспетчера ресурсов Azure](http://go.microsoft.com/fwlink/?LinkID=394765).


- Командлет **Get-AzurePublishSettingsFile** открывает веб-страницу на
портале управления Azure, с которого можно скачать сведения о подписке. Эта информация содержится в PUBLISHSETTINGS-файле.

- Командлет **Import-AzurePublishSettingsFile** импортирует PUBLISHSETTINGS-файл для использования в модуле. Этот файл содержит сертификат управления с учетными данными безопасности.

> [AZURE.IMPORTANT] После импорта этих параметров рекомендуется удалить профиль публикации, скачанный с помощью <b>Get-AzurePublishSettingsFile</b>. Так как сертификат управления содержит учетные данные безопасности, неавторизованные пользователи не должны получить к нему доступ. Если вам нужны сведения о подписках, их можно получить на [портале управления Azure](http://manage.windowsazure.com/) или на [клиентском портале служб Microsoft Online Services](http://go.microsoft.com/fwlink/p/?LinkId=324875).

1. Войдите на [портал управления Azure](http://manage.windowsazure.com), используя учетную запись Azure.

2. Откройте консоль Azure PowerShell, как описано в разделе [Практическое руководство. Установка Azure PowerShell](#Install).

3. Введите следующую команду:

		Get-AzurePublishSettingsFile

4. При появлении запроса скачайте и сохраните профиль публикации. Запомните путь и имя PUBLISHSETTINGS-файла. Эта информация необходима при запуске командлета **Import-AzurePublishSettingsFile** для импорта параметров. Расположение по умолчанию и формат имени файла:

			C:\\Users\<UserProfile>\\Download\\[*MySubscription*-...]-*downloadDate*-credentials.publishsettings

5. Введите команду, подобную следующей, указав имя своей учетной записи Windows, а также полный путь к файлу вместо заполнителей:

		Import-AzurePublishSettingsFile C:\Users\<UserProfile>\Downloads\<SubscriptionName>-credentials.publishsettings

> [AZURE.NOTE] Если вас добавили в другие подписки в качестве соадминистратора после импорта параметров публикации, потребуется повторить этот процесс для скачивания нового PUBLISHSETTINGS-файла, а затем импортировать эти параметры. Дополнительные сведения о добавлении соадминистраторов для управления службами подписки см. в разделе [Добавление и удаление соадминистраторов для подписки Azure](http://msdn.microsoft.com/library/windowsazure/gg456328.aspx).

<h3> Просмотр сведений учетной записи и подписки</h3>
У вас может быть несколько учетных записей и подписок, доступных для использования в Azure PowerShell. Можно добавить несколько учетных записей, выполнив командлет AzureAccount несколько раз.

Чтобы просмотреть доступные учетные записи Azure, введите:

	Get-AzureAccount

Чтобы просмотреть подписки Azure, введите:

	Get-AzureSubscription

## <a id="Ex"></a>Использование командлетов: Пример ##

После установки модуля и настройки компьютера для подключения к вашей подписке вы можете создать веб-приложение Azure. Данный пример поможет приступить к работе с командлетами Azure.

1. Запустите консоль Azure PowerShell.

2. Выберите имя для веб-приложения. Необходимо использовать имя, соответствующее правилам именования DNS. Допустимые имена могут содержать только буквы a-z, цифры от 0 до 9 и дефис ("-"). 

	Имя веб-приложения должно быть уникальным в рамках Azure. В примере мы будем использовать "mySite", но постарайтесь выбрать другое имя, например имя учетной записи с номером.  

	После выбора имени введите команду, аналогичную следующей. Замените "mySite" именем своего веб-приложения.

		New-AzureWebsite mySite

	Командлет создает веб-приложение и возвращает объект, который представляет новое веб-приложение. В свойства этого объекта входит полезная информация о веб-приложении.

3. Чтобы получить информацию о веб-приложении, введите такую команду. Она возвращает информацию обо всех веб-приложениях в подписке, в том числе и о только что созданном.

		Get-AzureWebsite

4. Для получения дополнительной информации о веб-приложении укажите в команде имя веб-приложения. Обязательно укажите имя своего веб-приложения вместо "mySite".

		Get-AzureWebsite -Name mySite

5. Веб-приложения запускаются после их создания. Чтобы остановить веб-приложение, введите эту команду и имя своего веб-приложения.

		Stop-AzureWebsite -Name mySite

6. Чтобы убедиться, что состояние сайта -  'stopped', запустите команду "Get-AzureWebsite" еще раз.

		Get-AzureWebsite

7. Для завершения этого теста удалите веб-приложение. Введите:  

		Remove-AzureWebsite -Name mySite

7. Чтобы завершить задачу, удалите веб-приложение.

		Get-AzureWebsite -Name mySite

##<a id="Help"></a>Получение справки##

В этих ресурсах вы найдете справку для определенных командлетов:


-   В консоли можно использовать встроенную справку. Командлет **Get-Help** предоставляет доступ к этой системе. В следующей таблице приведены некоторые примеры команд, которые можно использовать для получения справки. Дополнительные сведения можно получить в консоли, введя команду **help**.

    <table border="1" cellspacing="4" cellpadding="4">
    <tbody>
    <tr align="left" valign="top">
		<td><b>Команда</b></td>
		<td><b>Результат</b></td>
    </tr>
    <tr align="left" valign="top">
		<td>Get-Help</td>
		<td>Описывает, как использовать справочную систему. <p><b>Примечание</b>. В описание включена некоторая информация о файлах справки, не относящихся к модулю Azure. В частности, файлы справки, установленные при установке модуля. Они недоступны для отдельного скачивания.</p>
</td>
    </tr>
    <tr align="left" valign="top">
		<td>Get-Help Azure</td>
		<td>Возвращает все командлеты в модуле Azure.</td>
    </tr>
	<tr align="left" valign="top">
		<td>Get-Help &lt;<b>language</b>&gt;-dev</td>
		<td>Возвращает командлеты для разработки приложений на определенном языке и управления ими. Например, help node-dev, help php-dev или help python-dev.</td>
    </tr>
	    <tr align="left" valign="top">
		<td>Get-Help &lt;<b>cmdlet</b>&gt;</td>
		<td>Выводит справку о командлете Windows PowerShell. Замените <cmdlet> именем командлета.</td>
    </tr>
    <tr align="left" valign="top">
		<td>Get-Help &lt;<b>cmdlet</b>&gt; -Parameter *</td>
		<td>Возвращает описание параметров командлета. Звездочка (*) означает "все".</td>
    </tr>
    <tr align="left" valign="top">
		<td>Get-Help &lt;<b>cmdlet</b>&gt; -Examples</td>
		<td>Возвращает синтаксис и примеры использования командлета.</td>
    </tr>
    <tr align="left" valign="top">
		<td>Get-Help &lt;<b>cmdlet</b>&gt; -Full</td>
		<td>Возвращает всю справку по командлету, в том числе технические подробности.</td>
    </tr>
    </tbody>
    </table>



- Справочные данные о командлетах в модуле Azure PowerShell также доступны в библиотеке Azure. Дополнительные сведения см. в [справочнике по командлетам Azure](http://msdn.microsoft.com/library/windowsazure/jj554330.aspx).

На этих популярных форумах можно получить помощь от сообщества:

- [Форум Azure на MSDN]( http://go.microsoft.com/fwlink/p/?LinkId=320212)
- [Stackoverflow](http://go.microsoft.com/fwlink/?LinkId=320213)


## <a id="Resources"></a>Дополнительные ресурсы ##

Вот некоторые ресурсы, которые можно использовать для получения информации об использовании Azure и Windows PowerShell.

- Информацию о получении доступа к компонентам службы хранилища Azure см. в разделе [Использование Azure PowerShell в службе хранилища Azure](storage-powershell-guide-full.md).

- Информацию о том, как оставить отзывы и предложения о командлетах, сообщить о проблемах или получить доступ к исходному коду, см. в [репозитории кода Azure PowerShell](https://github.com/WindowsAzure/azure-sdk-tools).

- Информацию о командной строке Windows PowerShell и среде сценариев см. в [Центре сценариев TechNet](http://go.microsoft.com/fwlink/p/?LinkId=320211).

- Информацию об установке, изучении, использовании и настройке Windows PowerShell см. в статье [Сценарии в Windows PowerShell](http://go.microsoft.com/fwlink/p/?LinkId=320210).

- Информацию о сценариях и способах их выполнения в Windows PowerShell см. в разделе [Выполнение сценариев](http://go.microsoft.com/fwlink/p/?LinkId=320627). Данная статья содержит базовые сведения о создании сценариев и настройке компьютера для их запуска.

- Информацию о командлетах для Azure AD см. в статье [Управление Azure AD с помощью Windows PowerShell](http://go.microsoft.com/fwlink/p/?LinkId=320628).





  [Клиентский портал служб Microsoft Online Services]: https://mocp.microsoftonline.com/site/default.aspx

<!--HONumber=52-->