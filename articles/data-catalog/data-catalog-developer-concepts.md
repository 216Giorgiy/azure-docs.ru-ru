<properties
   pageTitle="Концепции каталога данных Azure для разработчиков"
   description="Введение в основные понятия концептуальной модели каталога данных Azure, предоставляемой через каталог REST API."
   services="data-catalog"
   documentationCenter=""
   authors="spelluru"
   manager="paulettm"
   editor=""
   tags=""/>
<tags 
   ms.service="data-catalog"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-catalog"
   ms.date="07/25/2016"
   ms.author="derrickv"/>

# Концепции каталога данных Azure для разработчиков

**Каталог данных Azure** — это полностью управляемая облачная служба, предоставляющая возможности обнаружения источников данных и совместной работы над метаданными источников данных. Разработчики могут взаимодействовать с этой службой через интерфейс API REST. Для успешной интеграции с **каталогом данных Azure** разработчикам важно понимать концепции, реализованные в каталоге.

## Основные понятия

В основе концептуальной модели **каталога данных Azure** лежат четыре основных понятия: **каталог**, **пользователи**, **ресурсы** и **аннотации**.

![концепция][1]

*Рисунок 1. Упрощенная концептуальная модель каталога данных Azure*

### Каталог

Объект **каталога** является контейнером верхнего уровня для всех метаданных, которые будут храниться в организации. В каждой учетной записи Azure имеется только один **каталог**. Каталоги привязаны к подписке Azure, но для каждой учетной записи Azure можно создать только один **каталог**, хотя у одной учетной записи может быть несколько подписок.

Каталог содержит **пользователей** и **ресурсы**.

### Пользователи

Пользователи являются субъектами безопасности, имеющими разрешения на выполнение определенных действий в каталоге (поиск, добавление, изменение, удаление элементов и т. д).

Существует несколько различных ролей, которые может иметь пользователь. Дополнительные сведения о ролях приведены в разделе "Роли и авторизация".

Можно добавлять отдельных пользователей и группы безопасности.

Для управления доступом и идентификации пользователей каталог данных Azure использует Azure Active Directory. Каждый пользователь каталога должен быть членом Active Directory для учетной записи.

### Активы

**Каталог** содержит ресурсы данных. **Ресурс** — это единица детализации, управляемая каталогом.

Детализация ресурса может быть разной в зависимости от источника данных. Для базы данных Oracle или SQL Server в качестве ресурса могут выступать таблица или представление. В службах SQL Server Analysis Services ресурсами могут быть меры, измерения или ключевые показатели эффективности. В службах SQL Server Reporting Services ресурсом может быть отчет.

**Ресурс** — это элемент, который добавляется в каталог или удаляется из него. Ресурс является единицей данных, получаемых в результате **поиска**.

**Ресурс** включает не только данные об имени, расположении и типе ресурса, но и заметки с описанием ресурса.

### Аннотации

Аннотации — это элементы, представляющие метаданные ресурсов.

Заметки представлены описаниями, тегами, схемами, документацией и т. д. Полный список типов заметок и ресурсов приведен в разделе «Объектная модель ресурса».

## Совместная работа над аннотациями и мнения пользователей (множественность мнений)

Важным аспектом каталога данных Azure является то, как он поддерживает совместную работу над метаданными в системе. В отличие от подхода wiki, где есть только одно мнение и оно принадлежит последнему написавшему, в модели каталога данных Azure возможно одновременное сосуществование нескольких мнений.

Этот подход отражает реальный мир корпоративных данных, в которых пользователи могут иметь различный взгляд на один и тот же ресурс:

-	Администратор базы данных может предоставить сведения о соглашениях об уровне обслуживания или о доступном окне обработки для массовых операций ETL
-	Менеджер данных может предоставить сведения о бизнес-процессах, к которым применяется ресурс, или бизнес-категориях ресурса
-	Финансовый аналитик может предоставить сведения об использовании данных при подготовке отчетов конца периода

В этом примере каждый пользователь — администратор базы данных, менеджер данных и аналитик — может добавить свое описание к одной и той же таблице, зарегистрированной в каталоге. Все описания сохраняются в системе и отображаются на портале каталога данных Azure.

Этот шаблон применяется к большинству элементов объектной модели. По этой причине в полезных данных JSON там, где можно было ожидать одноэлементный объект, часто встречаются массивы свойств.

Например в корневом ресурсе находится массив объектов описаний. Свойство массива называется "описанием". Объект описания имеет одно свойство — описание. Каждый пользователь, который набирает описание, получает объект описания, созданный для введенных им значений.

Затем можно выбрать способ отображения сочетания. Существует три различных шаблона отображения.

-	Самый простой — "Показать все". В этом шаблоне отображаются все объекты в виде какого-либо списка. Это те действия, которые выполняются порталом каталога данных Azure для описания.
-	Другой шаблон — "Слияние". В этом шаблоне все значения от различных пользователей объединяются, а дубликаты удаляются. Примерами этого шаблона в портале каталога данных Azure являются свойства тегов и экспертов.
-	Третий шаблон — "Побеждает последний". В этом шаблоне отображается только последнее значение. Пример этого шаблона — friendlyName.

## Объектная модель ресурса

Как описано в разделе «Ключевые концепции», объектная модель **каталога данных Azure** включает элементы, которые могут быть ресурсами или заметками. Элементы имеют свойства, которые могут быть обязательными или необязательными. Некоторые свойства применяются ко всем элементам. Некоторые свойства применяются ко всем ресурсам. Некоторые свойства применяются только к ресурсам определенного типа.

### Свойства системы

<table><tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>Timestamp</td><td>DateTime</td><td>Время последнего изменения элемента. Создается сервером при вставке и каждом изменении элемента. Значение этого свойства игнорируется во входных данных операции публикации.</td></tr><tr><td>id</td><td>URI</td><td>Абсолютный URL-адрес элемента (только для чтения). Это уникальный адресуемый URI для элемента. Значение этого свойства игнорируется во входных данных операции публикации.</td></tr><tr><td>type</td><td>Строка</td><td>Тип ресурса (только для чтения).</td></tr><tr><td>etag</td><td>Строка</td><td>Строка, соответствующая версии элемента, которую можно использовать для оптимистического управления параллелизмом при выполнении операций, изменяющих элементы в каталоге. "*" используется в качестве соответствия любому значению.</td></tr></table>

### Общие свойства

Эти свойства применяются ко всем корневым типам ресурсов и ко всем типам аннотаций.

<table>
<tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr>
<tr><td>fromSourceSystem</td><td>Логический</td><td>Указывает, получены ли данные из исходной системы (например базы данных SQL Server или Oracle) или созданы пользователем.</td></tr>
</table>

### Общие свойства корневого ресурса
<p>
Эти свойства применяются ко всем типам корневых ресурсов.
<table><tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>name</td><td>Строка</td><td>Имя, полученное на основе данных о расположении источника данных</td></tr><tr><td>dsl</td><td>DataSourceLocation</td><td>Однозначно определяет источник данных и является одним из идентификаторов ресурса. (См. раздел о двойной идентификации.) Структура dsl зависит от протокола и типа источника.</td></tr><tr><td>dataSource</td><td>DataSourceInfo</td><td>Дополнительные сведения о типе ресурса.</td></tr><tr><td>lastRegisteredBy</td><td>SecurityPrincipal</td><td>Описание пользователя, который последним зарегистрировал этот ресурс. Содержит уникальный идентификатор пользователя (upn) и отображаемое имя пользователя (lastName и firstName).</td></tr><tr><td>containerId</td><td>Строка</td><td>Идентификатор ресурса-контейнера для источника данных. Это свойство не поддерживается для типа контейнера.</td></tr></table>

### Общие свойства неодноэлементной аннотации

Эти свойства применяются ко всем типам неодноэлементных аннотаций (то есть аннотаций, которых может быть несколько на один ресурс).

<table>
<tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr>
<tr><td>key</td><td>Строка</td><td>Указанный пользователем ключ, который однозначно определяет аннотацию в текущей коллекции. Длина ключа не может превышать 256 символов.</td></tr>
</table>

### Типы корневых ресурсов

Типы корневых ресурсов — это типы, представляющие различные типы ресурсов данных, которые могут быть зарегистрированы в каталоге. Для каждого корневого типа определено представление, описывающее ресурс и аннотации, включенные в представление. Имя представления следует использовать в соответствующем сегменте {имя\_представления} URL-адреса при публикации ресурса с помощью REST API.

<table><tr><td><b>Тип ресурса (имя представления)</b></td><td><b>Дополнительные свойства</b></td><td><b>Тип данных</b></td><td><b>Разрешенные аннотации</b></td><td><b>Комментарии</b></td></tr><tr><td>Таблица ("tables")</td><td></td><td></td><td>Описание<p>FriendlyName<p>Тег<p>Схема<p>ColumnDescription<p>ColumnTag<p> Эксперт<p>Предварительный просмотр<p>AccessInstruction<p>TableDataProfile<p>ColumnDataProfile<p>ColumnDataClassification<p>Документация<p></td><td>Таблица представляет любые табличные данные. К таблицам могут относиться: таблица SQL, представление SQL, таблица Analysis Services, многомерное измерение Analysis Services, таблица Oracle и т. д.   </td></tr><tr><td>Мера ("measures")</td><td></td><td></td><td>Описание<p>FriendlyName<p>Тег<p>Эксперт<p>AccessInstruction<p>Документация<p></td><td>Этот тип представляет измерение Analysis Services.</td></tr><tr><td></td><td>measure</td><td>столбец</td><td></td><td>Метаданные, описывающие измерение</td></tr><tr><td></td><td>isCalculated </td><td>Логический</td><td></td><td>Указывает, вычисляется измерение или нет.</td></tr><tr><td></td><td>measureGroup</td><td>Строка</td><td></td><td>Физический контейнер для измерения</td></tr><td>Ключевой показатель эффективности ("kpis")</td><td></td><td></td><td>Описание<p>FriendlyName<p>Тег<p>Эксперт<p>AccessInstruction<p>Документация</td><td></td></tr><tr><td></td><td>measureGroup</td><td>Строка</td><td></td><td>Физический контейнер для измерения</td></tr><tr><td></td><td>goalExpression</td><td>Строка</td><td></td><td>Числовое выражение MDX или вычисление, которое возвращает целевое значение ключевого показателя эффективности.</td></tr><tr><td></td><td>valueExpression</td><td>Строка</td><td></td><td>Числовое выражение MDX, которое возвращает фактическое значение ключевого показателя эффективности.</td></tr><tr><td></td><td>statusExpression</td><td>Строка</td><td></td><td>Выражение MDX, которое отражает состояние ключевого показателя эффективности в заданный момент времени.</td></tr><tr><td></td><td>trendExpression</td><td>Строка</td><td></td><td>Выражение MDX, которое оценивает значение ключевого индикатора производительности во времени. В качестве тренда может использоваться любой временной критерий, который удобно использовать в заданном бизнес-контексте.</td>
<tr><td>Отчет ("reports")</td><td></td><td></td><td>Описание<p>FriendlyName<p>Тег<p>Эксперт<p>AccessInstruction<p>Документация<p></td><td>Этот тип представляет отчет для служб отчетов SQL Server </td></tr><tr><td></td><td>assetCreatedDate</td><td>Строка</td><td></td><td></td></tr><tr><td></td><td>assetCreatedBy</td><td>Строка</td><td></td><td></td></tr><tr><td></td><td>assetModifiedDate</td><td>Строка</td><td></td><td></td></tr><tr><td></td><td>assetModifiedBy</td><td>Строка</td><td></td><td></td></tr><tr><td>Контейнер ("containers")</td><td></td><td></td><td>Описание<p>FriendlyName<p>Тег<p>Эксперт<p>AccessInstruction<p>Документация<p></td><td>Этот тип представляет контейнер других ресурсов, таких как база данных SQL, контейнер больших двоичных объектов Azure или модель служб Analysis Services.</td></tr></table>

### Типы аннотаций

Типы аннотаций представляют типы метаданных, которые могут быть назначены другим типам в каталоге.

<table>
<tr><td><b>Тип аннотации (имя вложенного представления)</b></td><td><b>Дополнительные свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr>

<tr><td>Описание ("descriptions")</td><td></td><td></td><td>Содержит описание ресурса. Каждый пользователь системы может добавлять собственное описание. Изменить объект описания может только пользователь, создавший его. (Администраторы и владельцы ресурса могут удалить объект Description, но не изменить его.) Система хранит эти описания отдельно. Таким образом формируется массив описаний для каждого ресурса (по одному для каждого пользователя, который добавил информацию о ресурсе, и, возможно, еще одно описание, которое содержит сведения, полученные из источника данных).</td></tr>
<tr><td></td><td>description</td><td>строка</td><td>Краткое описание ресурса (2–3 строки).</td></tr>

<tr><td>Тег ("tags")</td><td></td><td></td><td>Содержит тег для ресурса. Каждый пользователь системы может добавить несколько тегов для ресурса. Изменить объекты Tag может только создавший их пользователь. (Администраторы и владельцы ресурса могут удалить объект Tag, но не изменить его.) Система хранит эти описания отдельно. Таким образом, для каждого ресурса существует массив объектов Tag.</td></tr>
<tr><td></td><td>tag</td><td>string</td><td>Тег, описывающий ресурс.</td></tr>

<tr><td>FriendlyName ("friendlyName")</td><td></td><td></td><td>Содержит понятное имя для ресурса. FriendlyName — это одноэлементная аннотация, для ресурса можно добавить только один FriendlyName. Изменить объект FriendlyName может только создавший его пользователь. (Администраторы и владельцы ресурса могут удалить объект FriendlyName, но не изменить его.) Система хранит эти описания отдельно.</td></tr>
<tr><td></td><td>friendlyName</td><td>string</td><td>Понятное имя ресурса.</td></tr>

<tr><td>Схема ("schema")</td><td></td><td></td><td>Схема описывает структуру данных. Она содержит список имен (столбец, атрибут, поле и т. д.) и типов атрибутов, а также другие метаданные. Вся эта информация извлекается из источника данных. Schema — это одноэлементная аннотация, для ресурса можно добавить только один Schema.</td></tr>
<tr><td></td><td>columns</td><td>Column[]</td><td>Массив объектов столбцов. Они описывают столбец с информацией, полученной из источника данных.</td></tr>

<tr><td>ColumnDescription ("columnDescriptions")</td><td></td><td></td><td>Содержит описание столбца. Каждый пользователь системы может добавить собственные описания для нескольких столбцов (не более одного на столбец). Изменить объекты ColumnDescription может только создавший их пользователь. (Администраторы и владельцы ресурса могут удалить объект ColumnDescription, но не изменить его.) Система хранит эти описания отдельно. Таким образом формируется массив объектов ColumnDescription для каждого ресурса (по одному на столбец для каждого пользователя, который добавил информацию о столбцах, и, возможно, еще один объект, который содержит сведения, полученные из источника данных). ColumnDescription слабо привязан к схеме, поэтому он может потерять свою актуальность, т. е. ColumnDescription может описывать столбец, который больше не существует в схеме. За синхронизацию атрибутов отвечает тот, кто производит запись. Источник данных также может иметь описание столбцов. Оно может быть представлено в виде дополнительных объектов ColumnDescription, создаваемых при запуске средства.</td></tr>
<tr><td></td><td>columnName</td><td>Строка</td><td>Имя столбца, на который ссылается это описание.</td></tr>
<tr><td></td><td>description</td><td>Строка</td><td>Краткое описание столбца (2-3 строки).</td></tr>

<tr><td>ColumnTag ("columnTags")</td><td></td><td></td><td>Содержит тег для столбца. Каждый пользователь системы может добавить несколько тегов для заданного столбца, а также теги для нескольких столбцов. Изменить объекты ColumnTag может только создавший их пользователь. (Администраторы и владельцы ресурса могут удалить объект ColumnTag, но не изменить его.) Система хранит эти описания отдельно. Таким образом, для каждого ресурса существует массив объектов ColumnTag. ColumnTag слабо привязан к схеме, поэтому он может потерять свою актуальность, т. е. ColumnTag может описывать столбец, который больше не существует в схеме. За синхронизацию атрибутов отвечает тот, кто производит запись.</td></tr>
<tr><td></td><td>columnName</td><td>Строка</td><td>Имя столбца, на который ссылается этот тег.</td></tr>
<tr><td></td><td>tag</td><td>Строка</td><td>Тег, описывающий столбец.</td></tr>

<tr><td>Эксперт ("experts")</td><td></td><td></td><td>Содержит пользователя, который считается экспертом в наборе данных. Мнения экспертов (т. е. их описания) будут перемещаться в верхнюю часть списков описаний. Каждый пользователь может задавать своих собственных экспертов. Изменить объект эксперта может только пользователь, создавший его. (Администраторы и владельцы ресурса могут удалить объект Expert, но не изменить его.)</td></tr>
<tr><td></td><td>expert</td><td>SecurityPrincipal</td><td></td></tr>

<tr><td>Предварительный просмотр ("previews")</td><td></td><td></td><td>Предварительный просмотр содержит моментальный снимок 20 верхних строк данных ресурса. Предварительный просмотр имеет смысл только для некоторых типов ресурсов (например для таблицы, но не для измерения).</td></tr>
<tr><td></td><td>предварительный просмотр</td><td>object[]</td><td>Массив объектов, представляющих столбцы. Каждый объект имеет сопоставление свойства на столбец со значением для этого столбца и строки.</td></tr>

<tr><td>AccessInstruction ("accessInstructions")</td><td></td><td></td><td></td></tr>
<tr><td></td><td>mimeType</td><td>string</td><td>Тип mime содержимого.</td></tr>
<tr><td></td><td>Содержимое</td><td>string</td><td>Инструкции для получения доступа к этому ресурсу-контейнеру данных. Это может быть URL-адрес, адрес электронной почты или набор инструкций.</td></tr>

<tr><td>TableDataProfile ("tableDataProfiles")</td><td></td><td></td><td></td></tr>
<tr><td></td><td>numberOfRows</td></td><td>int</td><td>Количество строк в наборе данных</td></tr>
<tr><td></td><td>size</td><td>длинное целое число</td><td>Размер набора данных в байтах.  </td></tr>
<tr><td></td><td>schemaModifiedTime</td><td>строка</td><td>Время последнего изменения схемы.</td></tr>
<tr><td></td><td>dataModifiedTime</td><td>строка</td><td>Время последнего изменения набора данных (добавление, изменение или удаление данных)</td></tr>

<tr><td>ColumnsDataProfile ("columnsDataProfiles")</td><td></td><td></td><td></td></tr>
<tr><td></td><td>columns</td></td><td>ColumnDataProfile[]</td><td>Массив профилей данных столбцов.</td></tr>

<tr><td>ColumnDataClassification ("columnDataClassifications")</td><td></td><td></td><td></td></tr>
<tr><td></td><td>columnName</td><td>Строка</td><td>Имя столбца, на который ссылается эта классификация.</td></tr>
<tr><td></td><td>классификация;</td><td>Строка</td><td>Классификация данных в этом столбце.</td></tr>

<tr><td>Документация ("documentation")</td><td></td><td></td><td>Данный ресурс может иметь только одну связанную с ним документацию.</td></tr>
<tr><td></td><td>mimeType</td><td>string</td><td>Тип mime содержимого.</td></tr>
<tr><td></td><td>Содержимое</td><td>строка</td><td>Содержимое документации</td></tr>

</table>

### Общие типы

Общие типы можно использовать в качестве типов свойств, но не элементов.
<table>
<tr><td><b>Общий тип</b></td><td><b>Свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr>
<tr><td>DataSourceInfo</td><td></td><td></td><td></td></tr>
<tr><td></td><td>sourceType</td><td>string</td><td>Описывает тип источника данных, т.&#160;е. "SQL Server", "база данных Oracle" и т. д.  </td></tr>
<tr><td></td><td>objectType</td><td>string</td><td>Описывает тип объекта в источнике данных, т. е. "таблица", "представление для SQL Server".</td></tr>

<tr><td>DataSourceLocation</td><td></td><td></td><td></td></tr>
<tr><td></td><td>protocol</td><td>string</td><td>Обязательный параметр. Описывает протокол, используемый для связи с источником данных. Например, "tds" для SQl Server, "oracle" для Oracle и т. д. Список текущих поддерживаемых протоколов см. в [спецификации ссылки на источник данных, в разделе структуре DSL](data-catalog-dsr.md).</td></tr>
<tr><td></td><td>address</td><td>Dictionary&lt;строка, объект></td><td>Обязательный параметр. Это набор данных, относящийся к протоколу, который используется для определения источника данных, указанного в ссылке. Так как данные адреса относятся к определенному протоколу, это значит, что знать их нет смысла, не зная протокол.</td></tr>
<tr><td></td><td>authentication</td><td>string</td><td>необязательный параметр. Схема аутентификации, используемая для связи с источником данных. Т. е. windows, oauth, и т. д. </td></tr>
<tr><td></td><td>connectionProperties</td><td>Dictionary&lt;строка, объект></td><td>необязательный параметр. Дополнительные сведения о том, как подключиться к источнику данных.</td></tr>

<tr><td>SecurityPrincipal</td><td></td><td></td><td>Обратите внимание, что серверная часть не выполняет проверку указанных свойств в AAD во время публикации.</td></tr>
<tr><td></td><td>upn</td><td>string</td><td>Уникальный адрес электронной почты пользователя. Должен быть указан, если не задан objectId или используется контекст свойства "lastRegisteredBy", в противном случае необязателен.</td></tr>
<tr><td></td><td>objectId</td><td>Guid</td><td>Удостоверение AAD для пользователя или группы безопасности. необязательный параметр. Должен быть указан, если не задан upn, в противном случае необязателен.</td></tr>
<tr><td></td><td>firstName</td><td>string</td><td>Имя пользователя (для отображения). необязательный параметр. Допустим только в контексте свойства "lastRegisteredBy". Не может быть указан при предоставлении субъекта безопасности для "roles", "permissions" и "experts".</td></tr>
<tr><td></td><td>lastName</td><td>string</td><td>Фамилия пользователя (для отображения). необязательный параметр. Допустим только в контексте свойства "lastRegisteredBy". Не может быть указан при предоставлении субъекта безопасности для "roles", "permissions" и "experts".</td></tr>

<tr><td>столбец</td><td></td><td></td><td></td></tr>
<tr><td></td><td>name</td><td>string</td><td>Имя столбца или атрибута.</td></tr>
<tr><td></td><td>type</td><td>string</td><td>тип данных столбца или атрибута. Допустимые для использования типы зависят от типа источника данных ресурса. Поддерживается только подмножество типов.</td></tr>
<tr><td></td><td>maxLength</td><td>int</td><td>Максимальная длина столбца или атрибута. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr>
<tr><td></td><td>precision</td><td>byte</td><td>Точность для столбца или атрибута. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr>
<tr><td></td><td>isNullable</td><td>Логический</td><td>Указывает, разрешены ли значения null для этого столбца. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr>
<tr><td></td><td>expression</td><td>string</td><td>Если значение представляет собой вычисляемый столбец, то это поле содержит выражение для этого значения. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr>

<tr><td>ColumnDataProfile</td><td></td><td></td><td></td></tr>
<tr><td></td><td>columnName </td><td>строка</td><td>Имя столбца</td></tr>
<tr><td></td><td>type </td><td>строка</td><td>Тип столбца</td></tr>
<tr><td></td><td>min </td><td>строка</td><td>Минимальное значение в наборе данных</td></tr>
<tr><td></td><td>max </td><td>строка</td><td>Максимальное значение в наборе данных</td></tr>
<tr><td></td><td>avg </td><td>double</td><td>Среднее значение в наборе данных</td></tr>
<tr><td></td><td>stdev </td><td>double</td><td>Стандартное отклонение для набора данных</td></tr>
<tr><td></td><td>nullCount </td><td>int</td><td>Число значений null в наборе данных</td></tr>
<tr><td></td><td>distinctCount  </td><td>int</td><td>Число различающихся значений в наборе данных</td></tr>


</table>

## Удостоверение ресурса
Каталог данных Azure использует свойство "protocol" и свойства удостоверения из контейнера свойств "address" свойства DataSourceLocation "dsl" для создания удостоверения ресурса, которое используется для адресации ресурса в каталоге. Например, протокол "tds" имеет свойства удостоверения "server", "database", "schema" и "object". Сочетание протокола и свойств удостоверения используется для создания удостоверения ресурса таблицы SQL Server. Каталог данных Azure предоставляет несколько встроенных протоколов источников данных, которые перечислены в [спецификации ссылки на источник данных, в разделе структуре DSL](data-catalog-dsr.md). Набор поддерживаемых протоколов можно расширить программно (см. справочник по REST API каталога данных). Администраторы каталога могут регистрировать пользовательские протоколы источников данных. В следующей таблице описаны свойства, необходимые для регистрации пользовательского протокола.

### Спецификация пользовательского протокола источника данных
<table>
<tr><td><b>Тип</b></td><td><b>Свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr>

<tr><td>DataSourceProtocol</td><td></td><td></td><td></td></tr>
<tr><td></td><td>пространство_имен</td><td>string</td><td>Пространство имен протокола. Пространство имен должно содержать от 1 до 255 знаков и включать в себя одну или несколько непустых частей, разделенных точкой (.). Каждая часть должна включать в себя от 1 до 255 знаков, начинаться с буквы и содержать только буквы и цифры.</td></tr>
<tr><td></td><td>name</td><td>string</td><td>Имя протокола. Имя должно включать в себя от 1 до 255 знаков, начинаться с буквы и содержать только буквы, цифры и тире (-).</td></tr>
<tr><td></td><td>identityProperties</td><td>DataSourceProtocolIdentityProperty[]</td><td>Список свойств удостоверения. Должен содержать по крайней мере одно свойство, но их должно быть не более 20. Пример: "server", "database", "schema", "object" — свойства удостоверения "tds".</td></tr>
<tr><td></td><td>identitySets</td><td>DataSourceProtocolIdentitySet[]</td><td>Список наборов идентификаторов. Определяет наборы свойств удостоверения, которые представляют допустимое удостоверение ресурса. Должен содержать по крайней мере один, но не более 20 наборов. Пример: {"server", "database", "schema" и "object"} — набор удостоверения для протокола "tds", который определяет удостоверение ресурса таблицы SQL Server.</td></tr>

<tr><td>DataSourceProtocolIdentityProperty</td><td></td><td></td><td></td></tr>
<tr><td></td><td>name</td><td>строка</td><td>Имя свойства. Имя должно включать в себя от 1 до 100 знаков, начинаться с буквы и содержать только буквы и цифры.</td></tr>
<tr><td></td><td>type</td><td>строка</td><td>Тип свойства. Поддерживаемые значения: "bool", boolean", "byte", "guid", "int", "integer", "long", "string", "url".</td></tr>
<tr><td></td><td>ignoreCase</td><td>bool</td><td>Указывает, следует ли игнорировать регистр при использовании значения свойства. Можно указать только для свойств с типом "string". Значение по умолчанию — false.</td></tr>
<tr><td></td><td>urlPathSegmentsIgnoreCase</td><td>bool[]</td><td>Указывает, следует ли игнорировать регистр в каждом сегменте пути URL-адреса. Можно указать только для свойств с типом "url". Значение по умолчанию — false.</td></tr>

<tr><td>DataSourceProtocolIdentitySet</td><td></td><td></td><td></td></tr>
<tr><td></td><td>name</td><td>строка</td><td>Имя набора идентификаторов.</td></tr>
<tr><td></td><td>properties</td><td>string[]</td><td>Список свойств удостоверения, включенных в этот набор идентификаторов. Не может содержать повторяющиеся значения. Каждое свойство, на которое ссылается набор идентификаторов, должно быть определено в списке "identityProperties" протокола.</td></tr>

</table>

## Роли и авторизация

Каталог данных Azure поддерживает авторизацию для выполнения операций над ресурсами и аннотациями.

## Основные понятия

Каталог данных Azure использует два механизма авторизации:

- Авторизация на основе ролей
- Авторизация на основе разрешений

### Роли

Существует три роли: **администратор**, **владелец** и **участник**. Каждая роль имеет собственную область действия и права, которые приведены в следующей таблице.

<table><tr><td><b>Роль</b></td><td><b>Область</b></td><td><b>Права</b></td></tr><tr><td>Администратор</td><td>Каталог (т. е. все ресурсы и аннотации в составе каталога)</td><td>Read Delete ViewRoles ChangeOwnership ChangeVisibility ViewPermissions</td></tr><tr><td>Владелец</td><td>Каждый ресурс (т. е. каждый корневой элемент)</td><td>Read Delete ViewRoles ChangeOwnership ChangeVisibility ViewPermissions</td></tr><tr><td>Участник</td><td>Каждый отдельный ресурс и аннотация</td><td>Read Update Delete ViewRoles Примечание: при лишении участника права Read (Чтение) он также лишается всех остальных прав</td></tr></table>

> [AZURE.NOTE] Права **Read**, **Update**, **Delete** и **ViewRoles** применяются ко всем элементам (ресурсам и заметкам), а права **TakeOwnership**, **ChangeOwnership**, **ChangeVisibility**, **ViewPermissions** — только к корневому ресурсу.
>
>Право **Delete** применяется к самому элементу, а также ко всем вложенным элементам и элементам, расположенным ниже по иерархии. Например, при удалении ресурса также удаляются все аннотации для этого ресурса.

### Разрешения

Разрешение представляет собой список записей управления доступом. Каждая запись управления доступом назначает субъекту безопасности набор прав. Разрешения могут задаваться только для ресурсов (корневых элементов) и применяются к ресурсам и всем вложенным элементам.

В предварительной версии **каталога данных Azure** из всего списка разрешений поддерживается только право **Read**. Оно может использоваться для ограничения видимости ресурса.

По умолчанию любой пользователь, прошедший проверку подлинности, получает право доступа **Read**, распространяющееся на все элементы каталога. Это актуально за исключением случаев, когда видимость элементов каталога ограничена набором субъектов, заданным в разрешениях.

## Интерфейс REST API

Для управления ролями и разрешениями можно использовать запросы на просмотр элементов **PUT** и **POST**. В дополнение к полезным данным элемента можно указать еще два системных свойства: **roles** и **permissions**.

> [AZURE.NOTE]
>
> Свойство **permissions** применимо только к корневому элементу.
>
> Роль **владельца** применима только к корневому элементу.
>
> Когда в каталоге создается элемент, связанная с таким элементом роль **участника** по умолчанию назначается текущему пользователю, прошедшему проверку подлинности. Чтобы обновлять элемент могли все пользователи, при первой его публикации роли **участника** в свойстве **roles** должен быть назначен специальный субъект безопасности <Everyone> (см. пример ниже). Роль **участника** изменить нельзя. Она назначается на все время существования элемента (т. е. даже **администратор** и **владелец** не имеют право изменять роль **участника**). Единственное значение, которое можно явно присвоить роли **участника** — это <Everyone>. Это значит, что **участником** может быть только пользователь, создавший элемент, или <Everyone>.

###Примеры
**Назначение роли участника <Everyone> при публикации элемента.** Специальный субъект безопасности <Everyone> имеет следующий код объекта: 00000000-0000-0000-0000-000000000201. **POST** https://api.azuredatacatalog.com/catalogs/default/views/tables/?api-version=2016-03-30

  > [AZURE.NOTE] Некоторые реализации клиентов HTTP могут автоматически повторно отправлять запросы после получения ответа 302 с сервера, но обычно извлекают заголовки авторизации из запроса. Так как заголовок авторизации является обязательным для выполнения запросов к каталогу данных Azure, необходимо убедиться, что он указывается и при повторной отправке запроса к расположению для перенаправления, указанному каталогом данных Azure. Ниже приведен пример кода, демонстрирующий это с помощью объекта .NET HttpWebRequest.

**Текст**

	{
		"roles": [
			{
				"role": "Contributor",
				"members": [
					{
						"objectId": "00000000-0000-0000-0000-000000000201"
					}
				]
			}
		]
	}

  **Назначение владельцев и ограничение видимости для существующего корневого элемента** **PUT** https://api.azuredatacatalog.com/catalogs/default/views/tables/042297b0...1be45ecd462a?api-version=2016-03-30

	{
		"roles": [
			{
				"role": "Owner",
				"members": [
					{
						"objectId": "c4159539-846a-45af-bdfb-58efd3772b43",
						"upn": "user1@contoso.com"
					},
					{
						"objectId": "fdabd95b-7c56-47d6-a6ba-a7c5f264533f",
						"upn": "user2@contoso.com"
					}
				]
			}
		],
		"permissions": [
			{
				"principal": {
					"objectId": "27b9a0eb-bb71-4297-9f1f-c462dab7192a",
					"upn": "user3@contoso.com"
				},
				"rights": [
					{
						"right": "Read"
					}
				]
			},
			{
				"principal": {
					"objectId": "4c8bc8ce-225c-4fcf-b09a-047030baab31",
					"upn": "user4@contoso.com"
				},
				"rights": [
					{
						"right": "Read"
					}
				]
			}
		]
	}

> [AZURE.NOTE] В теле запроса PUT не обязательно указывать полезные данные: запрос PUT можно использовать только для обновления ролей и/или разрешений.

<!--Image references-->
[1]: ./media/data-catalog-developer-concepts/concept2.png

<!---HONumber=AcomDC_0727_2016-->