<properties
   pageTitle="Концепции каталога данных Azure для разработчиков"
   description="Концепции каталога данных Azure для разработчиков: каталог, пользователи, ресурсы, совместная работа."
   services="data-catalog"
   documentationCenter=""
   authors="dvana"
   manager="mblythe"
   editor=""
   tags=""/> <tags
   ms.service="data-catalog"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-catalog"
   ms.date="07/13/2015"
   ms.author="derrickv"/>

# Концепции каталога данных Azure для разработчиков

**Каталог данных Azure** — это полностью управляемая облачная служба, предоставляющая возможности обнаружения источников данных и совместной работы над метаданными источников данных. Разработчики могут взаимодействовать с этой службой через интерфейс API REST. Для успешной интеграции с **каталогом данных Azure** разработчикам важно понимать концепции, реализованные в каталоге.

## Основные понятия

В основе концептуальной модели **каталога данных Azure** лежат четыре основных понятия: **каталог**, **пользователи**, **ресурсы** и **аннотации**.
     
![концепция][1]

*Рисунок 1. Упрощенная концептуальная модель каталога данных Azure*

### Каталог

Объект **каталога** является контейнером верхнего уровня для всех метаданных, которые будут храниться в организации. В каждой учетной записи Azure имеется только один **каталог**. Каталоги привязаны к подписке Azure, но для каждой учетной записи Azure можно создать только один **каталог**, хотя у одной учетной записи может быть несколько подписок.

Каталог содержит **пользователей** и **ресурсы**.

### Пользователи

Пользователи являются субъектами безопасности, имеющими разрешения на выполнение определенных действий в каталоге (поиск, добавление, изменение, удаление элементов и т. д).

Существует несколько различных ролей, которые может иметь пользователь. Дополнительные сведения о ролях приведены в разделе "Роли и авторизация".

Добавлять можно только отдельных пользователей (а не группы безопасности).

Для управления доступом и идентификации пользователей каталог данных Azure использует Azure Active Directory. Каждый пользователь каталога должен быть членом Active Directory для учетной записи.

### Активы

**Каталог** содержит ресурсы данных. **Ресурс** является единицей данных, которыми управляет каталог.

Детализация ресурса может быть разной в зависимости от источника данных. Для базы данных Oracle или SQL Server в качестве ресурса могут выступать таблица или представление. В SQL Server Analysis Services ресурсами могут быть измерения, размерности или ключевые показатели эффективности (KPI). В SQL Server Reporting Services ресурсом может быть отчет.

**Ресурс** — это элемент, который добавляется в каталог или удаляется из него. Ресурс является единицей данных, получаемых в результате **поиска**.

**Ресурс** состоит из основной информации, информации о расположении и типе ресурса и аннотаций, которые содержат дальнейшее описание ресурса.

### Аннотации

Аннотации — это элементы, представляющие метаданные ресурсов.

Примерами аннотаций являются описание, теги, схема, документация и т. д. Полный список типов ресурсов и аннотаций приведен в разделе "Объектная модель ресурса".

## Совместная работа над аннотациями и мнения пользователей (множественность мнений)

Важным аспектом каталога данных Azure является то, как он поддерживает совместную работу над метаданными в системе. В отличие от подхода wiki, где есть только одно мнение и оно принадлежит последнему написавшему, в модели каталога данных Azure возможно одновременное сосуществование нескольких мнений.

Этот подход отражает реальный мир корпоративных данных, в которых пользователи могут иметь различный взгляд на один и тот же ресурс:

-	Администратор базы данных может предоставить сведения о соглашениях об уровне обслуживания или о доступном окне обработки для массовых операций ETL
-	Менеджер данных может предоставить сведения о бизнес-процессах, к которым применяется ресурс, или бизнес-категориях ресурса
-	Финансовый аналитик может предоставить сведения об использовании данных при подготовке отчетов конца периода

В этом примере каждый пользователь — администратор базы данных, менеджер данных и аналитик — может добавить свое описание к одной и той же таблице, зарегистрированной в каталоге. Все описания сохраняются в системе и отображаются на портале каталога данных Azure.

Этот шаблон применяется к большинству элементов объектной модели. По этой причине в полезных данных JSON там, где можно было ожидать одноэлементный объект, часто встречаются массивы свойств.
 
Например в корневом ресурсе находится массив объектов описаний. Свойство массива называется "описанием". Объект описания имеет три свойства: описание, теги и friendlyName (понятное имя). Каждый пользователь, который набирает одно или несколько из этих свойств, получает объект описания, созданный для введенных пользователем значений.

Затем можно выбрать способ отображения сочетания. Существует три различных шаблона отображения.

-	Самый простой — "Показать все". В этом шаблоне отображаются все объекты в виде какого-либо списка. Это те действия, которые выполняются порталом каталога данных Azure для описания. 
-	Другой шаблон — "Слияние". В этом шаблоне все значения от различных пользователей объединяются, а дубликаты удаляются. Примерами этого шаблона в портале каталога данных Azure являются свойства тегов и экспертов. 
-	Третий шаблон — "Побеждает последний". В этом шаблоне отображается только последнее значение. Пример этого шаблона — friendlyName. Для некоторых типов невозможно наличие нескольких экземпляров. 

Ниже приведен список типов, которые могут и не могут иметь несколько экземпляров.

Следующие типы могут иметь несколько экземпляров:

- Описание
- Эксперты
- Описание схемы

Следующие типы **не** могут иметь несколько экземпляров:

- Корневые типы
- Схема
- Предварительный просмотр

## Объектная модель ресурса

Как описано в разделе "Ключевые концепции", объектная модель **каталога данных Azure** включает элементы, в качестве которых могут выступать ресурсы и аннотации. Элементы имеют свойства, которые могут быть обязательными или необязательными. Некоторые свойства применяются ко всем элементам. Некоторые свойства применяются ко всем ресурсам. Некоторые свойства применяются только к ресурсам определенного типа.

### Общие свойства

Эти свойства применяются ко всем корневым типам ресурсов и ко всем типам аннотаций.

> [AZURE.NOTE]Свойства, имена которых начинаются с двух символов подчеркивания, имеют системный тип.

<table><tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>modifiedTime</td><td>DateTime</td><td>Время последнего изменения корневого ресурса. Задается клиентом. (Сервер не сохраняет это значение.)</td></tr><tr><td>__id</td><td>Guid</td><td>Идентификатор элемента (только для чтения). Этот идентификатор ресурса гарантированно является уникальным. Поэтому ключом для этого элемента является __Id, __id корневого ресурса. Уникальность этого кортежа гарантируется только в пределах каталога.</td></tr><tr><td>__typeId</td><td>Guid</td><td>Тип ресурса (только для чтения)</td></tr><tr><td>__creatorId</td><td>Строка</td><td>Строка, используемая создателем ресурса для уникальной идентификации ресурса. </td></tr></table>

### Общие свойства корневого ресурса

Эти свойства применяются ко всем типам корневых ресурсов.

<table><tr><td><b>Имя свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>name</td><td>Строка</td><td>Имя, полученное на основе данных о расположении источника данных</td></tr><tr><td>dsl</td><td>Data Source Location</td><td>Однозначно определяет источник данных и является одним из идентификаторов ресурса. (См. раздел о двойной идентификации.) Структура dsl зависит от типа источника.</td></tr><tr><td>dataSource</td><td>DataSourceInfo</td><td>Дополнительные сведения о типе ресурса.</td></tr><tr><td>lastRegisteredBy</td><td>SecurityPrincipal</td><td>Описание пользователя, который последним зарегистрировал этот ресурс. Содержит уникальный идентификатор пользователя (upn) и отображаемое имя пользователя (lastName и firstName).</td></tr><tr><td>lastRegisteredTime</td><td>dateTime</td><td>Время последней регистрации ресурса в каталоге.</td></tr></table>

### Типы корневых ресурсов

Типы корневых ресурсов — это типы, представляющие различные типы ресурсов данных, которые могут быть зарегистрированы в каталоге.

<table><tr><td><b>Тип ресурса</b></td><td><b>Дополнительные свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>Таблица</td><td></td><td></td><td>Таблица представляет любые табличные данные. К таблицам могут относиться: таблица SQL, представление SQL, таблица Analysis Services, многомерное измерение Analysis Services, таблица Oracle и т. д.   </td></tr><tr><td>Measure</td><td></td><td></td><td>Этот тип представляет измерение Analysis Services.</td></tr><tr><td></td><td>Measure</td><td>Столбец</td><td>Метаданные, описывающие измерение</td></tr><tr><td></td><td>isCalculated </td><td>Логический</td><td>Указывает, вычисляется измерение или нет.</td></tr><tr><td></td><td>measureGroup</td><td>Строка</td><td>Физический контейнер для измерения</td></tr><tr><td>Ключевой показатель эффективности</td><td></td><td></td><td>Этот тип представляет ключевой показатель эффективности Analysis Services.</td></tr><tr><td></td><td>goalExpression</td><td>Строка</td><td>Числовое выражение MDX или вычисление, которое возвращает целевое значение ключевого показателя эффективности.</td></tr><tr><td></td><td>valueExpression</td><td>Строка</td><td>Числовое выражение MDX, которое возвращает фактическое значение ключевого показателя эффективности.</td></tr><tr><td></td><td>statusExpression</td><td>Строка</td><td>Выражение MDX, которое отражает состояние ключевого показателя эффективности в заданный момент времени.</td></tr><tr><td></td><td>trendExpression</td><td>Строка</td><td>Выражение MDX, которое оценивает значение ключевого индикатора производительности во времени. В качестве тренда может использоваться любой временной критерий, который удобно использовать в заданном бизнес-контексте.</td></tr><tr><td></td><td>measureGroup</td><td>Строка</td><td>физический контейнер для измерения</td></tr><tr><td>Отчет</td><td></td><td></td><td>Этот тип представляет отчет для служб отчетов SQL Server </td></tr><tr><td></td><td>CreatedBy</td><td>Строка</td><td></td></tr><tr><td></td><td>CreatedDate</td><td>Строка</td><td></td></tr></table>

### Типы аннотаций

Типы аннотаций представляют типы метаданных, которые могут быть назначены другим типам в каталоге.

<table><tr><td><b>Тип аннотации</b></td><td><b>Дополнительные свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>Описание</td><td></td><td></td><td>Каждый пользователь системы может добавлять собственные описания и теги. Изменить объект описания может только пользователь, создавший его. (Администраторы и владельцы ресурса могут удалить объект описания, но не изменить его.) Система хранит эти описания отдельно. Таким образом формируется массив описаний для каждого ресурса (по одному для каждого пользователя, который добавил информацию о ресурсе, и, возможно, еще одно описание, которое содержит сведения, полученные из источника данных).</td></tr><tr><td></td><td>friendlyName</td><td>string</td><td>Понятное имя, которое можно использовать вместо имени, полученного от источника данных. Это имя удобно использовать для отображения и поиска.</td></tr><tr><td></td><td>tags</td><td>string[]</td><td>Массив тегов для ресурса</td></tr><tr><td></td><td>description</td><td>string</td><td>Краткое описание ресурса (2-3 строки)</td></tr><tr><td>Схема</td><td></td><td></td><td>Схема описывает структуру данных. Она содержит список имен (столбец, атрибут, поле и т. д.) и типов атрибутов, а также другие метаданные. Вся эта информация извлекается из источника данных. У одного ресурса обычно есть одна схема.</td></tr><tr><td></td><td>columns</td><td>Column[]</td><td>Массив объектов столбцов. Они описывают столбец с информацией, полученной из источника данных.</td></tr><tr><td>SchemaDescription</td><td></td><td></td><td>Содержит описание и набор тегов для каждого атрибута, определенного в схеме. Каждый пользователь системы может добавлять собственные описания и теги. Изменить объект описания может только пользователь, создавший его. (Администраторы и владельцы ресурсов могут только удалить объект SchemaDescription, но не изменить его.) Система хранит эти описания отдельно. Таким образом формируется массив объектов SchemaDescription для каждого ресурса (по одному для каждого пользователя, который добавил информацию об атрибутах, и, возможно, еще один объект, который содержит сведения, полученные из источника данных). Атрибуты схемы слабо привязаны к схеме, поэтому они могут потерять свою актуальность, т. е. SchemaDescription может описывать столбцы, которых больше не существует в схеме, или не содержать нового столбца, который недавно был добавлен. За синхронизацию атрибутов отвечает тот, кто производит запись. Источник данных также может иметь описание. Оно может быть представлено в виде дополнительного объекта schemaDescription, создаваемого при запуске средства.</td></tr><tr><td></td><td>columnDescriptions</td><td>ColumnDescription[]</td><td>Массив объектов ColumnDescription, описывающих столбцы схемы. </td></tr><tr><td>Эксперт</td><td></td><td></td><td>Содержит список пользователей, которые считаются экспертами в наборе данных. Мнения экспертов (т. е. их описания) будут перемещаться в верхнюю часть списков описаний. Каждый пользователь может задавать собственные списки экспертов. Изменить объект эксперта может только пользователь, создавший его. (Администраторы и владельцы ресурса могут удалить объект Experts, но не изменить его.)</td></tr><tr><td></td><td>experts</td><td>string[]</td><td>Массив адресов электронной почты.</td></tr><tr><td>Предварительный просмотр</td><td></td><td></td><td>Предварительный просмотр содержит моментальный снимок 20 верхних строк данных ресурса. Предварительный просмотр имеет смысл только для некоторых типов ресурсов (например для таблицы, но не для измерения).</td></tr><tr><td></td><td>предварительный просмотр</td><td>object[]</td><td>Массив объектов, представляющих столбцы. Каждый объект имеет сопоставление свойства на столбец со значением для этого столбца и строки.</td></tr></table>

### Общие типы

Общие типы можно использовать в качестве типов свойств, но не элементов.

<table><tr><td><b>Общий тип</b></td><td><b>Свойства</b></td><td><b>Тип данных</b></td><td><b>Комментарии</b></td></tr><tr><td>DataSourceInfo</td><td></td><td></td><td></td></tr><tr><td></td><td>sourceType</td><td>string</td><td>Описывает тип источника данных, т.&#160;е. "SQL Server", "база данных Oracle" и т. д.  </td></tr><tr><td></td><td>objectType</td><td>string</td><td>Описывает тип объекта в источнике данных, т. е. "таблица", "представление для SQL Server".</td></tr><tr><td></td><td>formatType</td><td>string</td><td>Описывает структуру данных. Текущие значения структурированы или не структурированы.</td></tr><tr><td>SecurityPrincipal</td><td></td><td></td><td></td></tr><tr><td></td><td>upn</td><td>string</td><td>Уникальный адрес электронной почты пользователя.</td></tr><tr><td></td><td>firstName</td><td>string</td><td>Имя пользователя (для отображения).</td></tr><tr><td></td><td>lastName</td><td>string</td><td>Фамилия пользователя (для отображения).</td></tr><tr><td>столбец</td><td></td><td></td><td></td></tr><tr><td></td><td>name</td><td>string</td><td>Имя столбца или атрибута.</td></tr><tr><td></td><td>type</td><td>string</td><td>тип данных столбца или атрибута. Допустимые для использования типы зависят от типа источника данных ресурса. Поддерживается только подмножество типов.</td></tr><tr><td></td><td>maxLength</td><td>int</td><td>Максимальная длина столбца или атрибута. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr><tr><td></td><td>Precision</td><td>byte</td><td>Точность для столбца или атрибута. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr><tr><td></td><td>isNullable</td><td>Логический</td><td>Указывает, разрешены ли значения null для этого столбца. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr><tr><td></td><td>expression</td><td>string</td><td>Если значение представляет собой вычисляемый столбец, то это поле содержит выражение для этого значения. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr><tr><td></td><td>defaultValue</td><td>object</td><td>Значение по умолчанию, которое подставляется, если значение не указано в инструкции insert для объекта. Определяется по информации из источника данных. Применимо только к некоторым типам источников данных.</td></tr><tr><td>ColumnDescription</td><td></td><td></td><td></td></tr><tr><td></td><td>tags</td><td>string[]</td><td>Массив тегов, описывающих столбец.</td></tr><tr><td></td><td>description</td><td>string</td><td>Описание столбца.</td></tr><tr><td></td><td>columnName</td><td>string</td><td>Имя столбца, на который ссылается эта информация.</td></tr></table>

## Роли и авторизация

Каталог данных Azure поддерживает авторизацию для выполнения операций над ресурсами и аннотациями.

## Основные понятия

Каталог данных Azure использует два механизма авторизации:

- Авторизация на основе ролей
- Авторизация на основе разрешений

### Роли

Существует три роли: **администратор**, **владелец** и **участник**. Каждая роль имеет собственную область действия и права, которые приведены в следующей таблице.

<table><tr><td><b>Роль</b></td><td><b>Область</b></td><td><b>Права</b></td></tr><tr><td>Администратор</td><td>Каталог (т. е. все ресурсы и аннотации в составе каталога)</td><td>Read Delete ViewRoles ChangeOwnership ChangeVisibility ViewPermissions</td></tr><tr><td>Владелец</td><td>Каждый ресурс (т. е. каждый корневой элемент)</td><td>Read Delete ViewRoles ChangeOwnership ChangeVisibility ViewPermissions</td></tr><tr><td>Участник</td><td>Каждый отдельный ресурс и аннотация</td><td>Read Update Delete ViewRoles Примечание: при лишении участника права Read (Чтение) он также лишается всех остальных прав</td></tr></table>

> [AZURE.NOTE]Права **Read**, **Update**, **Delete**, **ViewRoles** применяются ко всем элементам (ресурсам и аннотациям), а права **TakeOwnership**, **ChangeOwnership**, **ChangeVisibility**, **ViewPermissions** применяются только к корневому ресурсу.
>
>Право **Delete** применяется к элементу, а также всем его вложенным элементам и элементам, расположенным ниже по иерархии. Например, при удалении ресурса также удаляются все аннотации для этого ресурса.

### Разрешения

Разрешение представляет собой список записей управления доступом. Каждая запись управления доступом назначает субъекту безопасности набор прав. Разрешения могут задаваться только для ресурсов (корневых элементов) и применяются к ресурсам и всем вложенным элементам.

В предварительной версии **каталога данных Azure** поддерживается только право доступа **Read**, которое может использоваться для ограничения видимости ресурса.

По умолчанию любой пользователь, прошедший аутентификацию, получает право доступа **Read** для всех элементов каталога, если видимость элементов каталога не ограничена заданным набором участников в правах доступа.

## Интерфейс REST API

Для управления ролями и правами доступа можно использовать запросы **PUT** и **POST**. В дополнение к свойствам элемента можно определить еще два системных свойства: **__roles** и **__permissions**.

> [AZURE.NOTE]
>
> **__permissions** применимо только к корневому элементу.
>
> Роль **владельца** применима только к корневому элементу.
>
> По умолчанию при создании элемента в каталоге роль **участника** для этого элемента назначается текущему пользователю, прошедшему аутентификацию. Если права на обновление элемента должны иметь все пользователи, то на роль **участника** для этого элемента нужно назначить специального субъекта безопасности <Everyone> в свойстве **__roles** при первой публикации элемента (см. пример ниже). **Участника** для элемента изменить нельзя, и он остается постоянным в течение всего времени существования элемента (т. е. даже **администратор** и **владелец** не могут изменить **участника**). Единственное значение, допустимое для явного задания **участника** — это <Everyone>: т. е. **участником** может быть только пользователь, создавший элемент, или <Everyone>.

###Примеры
**Установите участника в <Everyone> при публикации элемента.** Специальный субъект безопасности <Everyone> имеет objectId, равный "00000000-0000-0000-0000-000000000201". **POST** https://123154bb...6aad6370ee14.datacatalog.azure.com/default/views/tables/?api-version=2015-07.1.0-Preview **Тело запроса**

	{
	    "__roles": [
	        {
	            "role": "Contributor",
	            "members": [
	                {
	                    "objectId": "00000000-0000-0000-0000-000000000201"
	                }
	            ]
	        }
	    ],
	    … other table properties
	}

**Назначает владельцев и ограничивает видимость для существующего корневого элемента ****PUT**https://123154bb...6aad6370ee14.datacatalog.azure.com/default/views/tables/042297b0...1be45ecd462a?api-version=2015-07.1.0-Preview

	{
	    "__roles": [
	        {
	            "role": "Owner",
	            "members": [
	                {
	                    "objectId": "c4159539-846a-45af-bdfb-58efd3772b43",
	                    "upn": "user1@contoso.com"
	                },
	                {
	                    "objectId": "fdabd95b-7c56-47d6-a6ba-a7c5f264533f",
	                    "upn": "user2@contoso.com"
	                }
	            ]
	        }
	    ],
	    "__permissions": [
	        {
	            "principal": {
	                "objectId": "27b9a0eb-bb71-4297-9f1f-c462dab7192a",
	                "upn": "user3@contoso.com"
	            },
	            "rights": [
	                {
	                    "right": "Read"
	                }
	            ]
	        },
	        {
	            "principal": {
	                "objectId": "4c8bc8ce-225c-4fcf-b09a-047030baab31",
	                "upn": "user4@contoso.com"
	            },
	            "rights": [
	                {
	                    "right": "Read"
	                }
	            ]
	        }
	    ]
	}

> [AZURE.NOTE]В теле запроса PUT не обязательно указывать полезные данные: запрос PUT можно использовать только для обновления ролей и/или разрешений.

<!--Image references-->
[1]: ./media/data-catalog-developer-concepts/concept.png

<!---HONumber=July15_HO4-->