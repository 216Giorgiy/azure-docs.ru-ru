---
title: Создание конвейера CI/CD для имеющегося кода с помощью проекта Azure DevOps | Руководство Azure DevOps Services
description: Проект DevOps упрощает начало работы с Azure. Она позволяет использовать собственный код и репозиторий GitHub для запуска приложения в выбранной службе Azure за несколько простых шагов.
services: vsts
documentationcenter: vs-devops-build
ms.author: mlearned
ms.manager: douge
editor: ''
ms.assetid: ''
ms.workload: web
ms.prod: devops
ms.technology: devops-cicd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 07/09/2018
author: mlearned
ms.custom: mvc
monikerRange: vsts
ms.openlocfilehash: 02b6823a46c94edb0ba28c7a2a8b9ae0efc44ae8
ms.sourcegitcommit: 07a09da0a6cda6bec823259561c601335041e2b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2018
ms.locfileid: "49406098"
---
# <a name="tutorial--create-a-cicd-pipeline-for-your-existing-code-with-the-azure-devops-project"></a>Руководство. Создание конвейера CI/CD для имеющегося кода с помощью проекта Azure DevOps

Проект Azure DevOps предоставляет собой упрощенный интерфейс, к которому можно подключить имеющийся код и репозиторий Git. Вы также можете выбрать один из примеров приложений, чтобы создать конвейер непрерывной интеграции (CI) и непрерывной поставки (CD) в Azure.

Вы сможете выполнять следующие задачи:

> [!div class="checklist"]
> * Создание проекта Azure DevOps
> * Настройка доступа к репозиторию GitHub и выбор платформы
> * Настройка Azure DevOps Services и подписки Azure 
> * Фиксация изменений в GitHub и автоматическое развертывание в Azure
> * Изучение конвейера CI/CD в Azure DevOps Services
> * Настройка мониторинга Azure Application Insights

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/).
* Доступ к GitHub или внешнему репозиторию Git, содержащему .NET, Java, PHP, Node, Python или статический веб-код.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Проект Azure DevOps создает конвейер CI/CD в Azure DevOps Services.  Вы можете создать **новую организацию Azure DevOps Services** или использовать **существующую**.  Проект Azure DevOps также создает **ресурсы Azure** в необходимой **подписке Azure**.

1. Войдите на портал [Microsoft Azure](https://portal.azure.com).

1. Щелкните значок **Создать ресурс** на панели навигации слева, затем выполните поиск по запросу **Проект DevOps**.  Выберите **Создать**.

    ![Начало непрерывной поставки](_img/azure-devops-project-github/fullbrowser.png)

1. Выберите **Bring your own code** (Использовать собственный код).  Когда все будет готово, щелкните **Далее**.

## <a name="configure-access-to-your-github-repository-and-choose-a-framework"></a>Настройка доступа к репозиторию GitHub и выбор платформы

1. Выберите **GitHub**.  При необходимости можно выбрать **внешний репозиторий Git**.  Выберите **репозиторий** и **ветвь**, содержащую приложение.

1. Выберите **веб-платформу**.  Когда все будет готово, щелкните **Далее**.

    ![Платформа .NET](_img/azure-devops-project-github/webframework.png)

1. Исполняющая среда, которую вы выбрали на предыдущих шагах, определяет тип цели развертывания службы Azure, доступной здесь.  Выберите необходимую **целевую службу**.  Когда все будет готово, щелкните **Далее**.

## <a name="configure-azure-devops-services-and-an-azure-subscription"></a>Настройка Azure DevOps Services и подписки Azure 

1. Создайте **новую** организацию Azure DevOps Services или выберите **существующую**.  Выберите **имя** для проекта Azure DevOps.  Выберите **подписку Azure**, **расположение** и укажите **имя** приложения.  Когда все будет готово, щелкните **Done** (Готово).

1. За несколько минут на портале Azure загружается **панель мониторинга проекта Azure DevOps**.  Пример приложения настраивается в репозитории в организации Azure DevOps Services, выполняется сборка, а ваше приложение развертывается в Azure.  Эта панель мониторинга обеспечивает видимость **репозитория кода** GitHub, **конвейера Azure DevOps Services CI/CD** и **приложения в Azure**.  В правой части панели мониторинга выберите **Обзор**, чтобы просмотреть запущенное приложение.

    ![Представление панели мониторинга](_img/azure-devops-project-github/dashboardnopreview.png) 
    
Проект Azure DevOps автоматически настраивает сборку непрерывной интеграции и триггер выпуска.  Код остается в GitHub или другом внешнем репозитории.  

## <a name="commit-changes-to-github-and-automatically-deploy-to-azure"></a>Фиксация изменений в GitHub и автоматическое развертывание в Azure 

Теперь вы готовы сотрудничать с командой в своем приложении с процессом CI/CD, который автоматически развертывает данные последней работы на вашем веб-сайте.  Каждое изменение в репозитории GitHub запускает сборку в Azure DevOps, а конвейер CD Azure DevOps выполняет развертывание в Azure.

1.  Внесите изменения в приложение и **зафиксируйте** их в репозитории GitHub.
2.  Через несколько секунд в Azure DevOps Services начнется выполнение сборки.  Состояние сборки вы можете отслеживать на панели мониторинга для проекта Azure DevOps или на странице браузера, которая отображает организацию Azure DevOps Services.
3.  По завершении сборки **обновите приложение** в браузере, чтобы убедиться, что вы видите изменения.

## <a name="examine-the-azure-devops-services-cicd-pipeline"></a>Изучение конвейера CI/CD в Azure DevOps Services

Проект Azure DevOps автоматически настраивает конвейер CI/CD Azure DevOps Services в организации Azure DevOps Services.  При необходимости изучите и настройте конвейер.  Выполните следующие шаги, чтобы ознакомиться с конвейерами сборки и выпуска Azure DevOps Services.

1. Щелкните **Конвейеры сборки** в **верхней части** панели мониторинга проекта Azure DevOps.  Эта ссылка открывает в новой вкладке браузера конвейер сборки Azure DevOps Services для нового проекта.

1. Поместите указатель мыши справа от конвейера сборки рядом с полем **Состояние**. Выберите отобразившееся **многоточие**.  После этого откроется меню, в котором можно начать выполнение нескольких действий, таких как постановка новой сборки в очередь, приостановка создания и изменение конвейера сборки.

1. Выберите **Изменить**

1. В этом представлении **рассмотрите различные задачи** для конвейера сборки.  Сборка выполняет различные задачи, такие как выборка источников из репозитория Git, восстановление зависимостей и публикация результатов, используемых для развертывания.

1. Выберите **имя конвейера сборки** в верхней части конвейера сборки.

1. Замените **имя** конвейера сборки более описательным.  Щелкните **Save & queue** (Сохранить и поместить в очередь), а затем выберите **Сохранить**.

1. Под именем конвейера сборки щелкните **Журнал**.  Вы увидите журнал аудита последних изменений сборки.  Azure DevOps Services отслеживает любые изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

1. Выберите **Триггеры**.  Проект Azure DevOps автоматически создал триггер CI, и теперь каждая фиксация в репозитории запускает новую сборку.  При желании выберите включение или исключение ветвей из процесса непрерывной интеграции.

1. Щелкните **Период удержания**.  На основе вашего сценария можно указать политики для хранения или удаления определенного количества сборок.

1. Щелкните **Сборка и выпуск**, а затем выберите **Выпуски**.  Проект Azure DevOps создал конвейер выпуска Azure DevOps Services для управления развертываниями в Azure.

1. В левой части окна браузера щелкните **многоточие** рядом с конвейером выпуска и выберите действие **Изменить**.

1. Конвейер выпуска содержит **конвейер**, в котором определен процесс выпуска.  В разделе **Артефакты** выберите **Удалить**.  Конвейер сборки, который вы изучали на предыдущих этапах, создает выходные данные для артефакта. 

1. Справа от значка **Удалить** выберите **Триггер непрерывного развертывания**.  Этот выпуск конвейера содержит триггер непрерывного развертывания, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки.  При желании можно отключить триггер, чтобы развертывание требовалось выполнять вручную. 

1. В левой части окна браузера выберите **Задачи**.  Задачи являются действиями, выполняемыми в процессе развертывания.  В этом примере задача была создана для развертывания в **службу приложений Azure**.

1. В правой части окна браузера выберите **Просмотреть выпуски**.  В этом представлении можно просмотреть журнал выпусков.

1. Щелкните **многоточие** рядом с одним из выпусков и выберите **Открыть**.  В этом представлении есть несколько меню, которые можно изучить, например меню сводки, связанных рабочих элементов и тестов.

1. Щелкните **Фиксации**.  В этом представлении отображаются фиксации кода, связанные с конкретным развертыванием. 

1. Выберите **Журналы**.  Журналы содержат полезную информацию о процессе развертывания.  Их можно просматривать как во время, так и после развертывания.

## <a name="configure-azure-application-insights-monitoring"></a>Настройка мониторинга Azure Application Insights

С помощью Azure Application Insights можно легко отслеживать производительность и использование своего приложения.  Проект Azure DevOps автоматически настроил ресурс Application Insights для вашего приложения.  Вы можете дополнительно настроить различные предупреждения и возможности мониторинга по мере необходимости.

1. Перейдите на панель мониторинга **проекта Azure DevOps** на портале Azure.  В правом нижнем углу панели мониторинга выберите ссылку **​​Application Insights** для своего приложения.

1. На портале Azure откроется колонка **Application Insights**.  Это представление содержит информацию об использовании, производительности и доступности приложения.

    ![Application Insights](_img/azure-devops-project-github/appinsights.png) 

1. Щелкните **Диапазон времени**, а затем выберите **За последний час**.  Щелкните **Обновить**, чтобы отфильтровать результаты.  Отобразится вся активность за последние 60 минут.  Щелкните **x**, чтобы закрыть диапазон времени.

1. Выберите **Оповещения**, затем щелкните **+ Добавить оповещение метрики**.  

1. Введите **имя** оповещения.

1. Выберите раскрывающийся список для **Source Alter on** (Изменить источник).  Выберите необходимый **ресурс Службы приложений.**
<!-- Could you please confirm if this should be "Source Alter on" instead of "Source Alert on"? -->
1. По умолчанию оповещение отображается, если **время отклика сервера превышает 1 секунду**.  Выберите раскрывающийся список **Метрика**, чтобы просмотреть различные оповещения метрики.  Различные оповещения можно легко настроить, чтобы улучшить возможности мониторинга приложения.

1. Установите флажок **Notify via Email owners, contributors, and readers** (Уведомлять по электронной почте владельцев, участников и читателей).  При желании вы можете выполнять дополнительные действия, когда срабатывает оповещение во время выполнения приложения логики Azure.

1. Нажмите кнопку **ОК**, чтобы создать оповещение.  Через несколько секунд предупреждение появится на панели мониторинга как активное.  **Выйдите из** области оповещений и вернитесь в колонку **Application Insights**.

1. Выберите **Доступность**, затем щелкните **+ Add test** (+ Добавить тест). 

1. Введите **имя теста**, а затем выберите **Создать**.  Создается простой тест проверки связи для проверки доступности вашего приложения.  Через несколько минут результаты тестирования будут доступны, а на панели мониторинга Application Insights отобразится состояние доступности.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вам больше не нужны служба приложений Azure и связанные с ней ресурсы, созданные в рамках этого краткого руководства, их можно удалить с помощью функции **Удалить** на панели мониторинга проекта Azure DevOps.

## <a name="next-steps"></a>Дополнительная информация

После настройки процесса CI/CD в рамках этого руководства в проекте Azure DevOps автоматически создается конвейер сборки и выпуска. Вы можете изменить эти конвейеры сборки и выпуска в соответствии с потребностями вашей команды. Вы научились выполнять следующие задачи:

> [!div class="checklist"]
> * Создание проекта Azure DevOps
> * Настройка доступа к репозиторию GitHub и выбор платформы
> * Настройка Azure DevOps Services и подписки Azure 
> * Фиксация изменений в GitHub и автоматическое развертывание в Azure
> * Изучение конвейера CI/CD в Azure DevOps Services
> * Настройка мониторинга Azure Application Insights

Чтобы получить дополнительные сведения о конвейере CI/CD Azure DevOps Services, изучите это руководство:

> [!div class="nextstepaction"]
> [Define your multi-stage continuous deployment (CD) process](https://docs.microsoft.com/azure/devops/pipelines/release/define-multistage-release-process?view=vsts) (Определение многоэтапного процесса непрерывного развертывания)
