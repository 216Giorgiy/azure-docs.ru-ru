---
title: Создание конвейера CI/CD для имеющегося кода с помощью проекта Azure DevOps | Руководство VSTS
description: Проект DevOps упрощает начало работы с Azure. Она позволяет использовать собственный код и репозиторий GitHub для запуска приложения в выбранной службе Azure за несколько простых шагов.
services: vsts
documentationcenter: vs-devops-build
ms.author: mlearned
ms.manager: douge
editor: ''
ms.assetid: ''
ms.workload: web
ms.prod: devops
ms.technology: devops-cicd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 07/09/2018
author: mlearned
ms.custom: mvc
monikerRange: vsts
ms.openlocfilehash: 8c92b45cd3949e56515286c963b035e3c449835b
ms.sourcegitcommit: a1e1b5c15cfd7a38192d63ab8ee3c2c55a42f59c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2018
ms.locfileid: "37967451"
---
# <a name="create-a-cicd-pipeline-for-your-existing-code-with-the-azure-devops-project"></a>Создание конвейера CI/CD для имеющегося кода с помощью проекта Azure DevOps

Проект Azure DevOps предоставляет собой упрощенный интерфейс, к которому можно подключить имеющийся код и репозиторий Git. Вы также можете выбрать один из примеров приложений, чтобы создать конвейер непрерывной интеграции (CI) и непрерывной поставки (CD) в Azure.

Вы сможете выполнять следующие задачи:

> [!div class="checklist"]
> * Создание проекта Azure DevOps.
> * Настройка доступа к репозиторию GitHub и выбор платформы.
> * Настройка VSTS и подписки Azure. 
> * Фиксация изменений в GitHub и автоматическое развертывание в Azure.
> * Анализ конвейера VSTS CI/CD.
> * Настройка мониторинга Azure Application Insights.

## <a name="prerequisites"></a>предварительным требованиям

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/).
* Доступ к GitHub или внешнему репозиторию Git, содержащему .NET, Java, PHP, Node, Python или статический веб-код.

## <a name="sign-in-to-the-azure-portal"></a>Выполните вход на портал Azure.

Проект Azure DevOps создает конвейер CI/CD в VSTS.  Вы можете создать учетную запись **VSTS** или использовать **имеющуюся**.  Проект Azure DevOps также создает **ресурсы Azure** в необходимой **подписке Azure**.

1. Войдите на [портал Microsoft Azure](https://portal.azure.com).

1. Щелкните значок **+ Создать** на левой панели навигации, затем найдите **проект DevOps**.  Выберите **Создать**.

    ![Начало непрерывной поставки](_img/azure-devops-project-github/fullbrowser.png)

1. Выберите **Bring your own code** (Использовать собственный код).  Когда все будет готово, щелкните **Далее**.

## <a name="configure-access-to-your-github-repository-and-choose-a-framework"></a>Настройка доступа к репозиторию GitHub и выбор платформы

1. Выберите **GitHub**.  При необходимости можно выбрать **внешний репозиторий Git**.  Выберите **репозиторий** и **ветвь**, содержащую приложение.

1. Выберите **веб-платформу**.  Когда все будет готово, щелкните **Далее**.

    ![Платформа .NET](_img/azure-devops-project-github/webframework.png)

1. Исполняющая среда, которую вы выбрали на предыдущих шагах, определяет тип цели развертывания службы Azure, доступной здесь.  Выберите необходимую **целевую службу**.  Когда все будет готово, щелкните **Далее**.

## <a name="configure-vsts-and-an-azure-subscription"></a>Настройка VSTS и подписки Azure 

1. **Создайте** учетную запись VSTS или выберите **имеющуюся**.  Выберите **имя** для проекта VSTS.  Выберите **подписку Azure**, **расположение** и укажите **имя** приложения.  Когда все будет готово, щелкните **Done** (Готово).

    ![Предоставление сведений о VSTS](_img/azure-devops-project-github/vstsazureinfo.png)

1. Через несколько минут на портале Azure загрузится **панель мониторинга проекта**.  Пример приложения настраивается в репозитории в вашей учетной записи VSTS, выполняется сборка, а ваше приложение развертывается в Azure.  Эта панель мониторинга обеспечивает видимость **репозитория кода** GitHub, **конвейера VSTS CI/CD** и **приложения в Azure**.  В правой части панели мониторинга выберите **Обзор**, чтобы просмотреть запущенное приложение.

    ![Представление панели мониторинга](_img/azure-devops-project-github/dashboardnopreview.png) 
    
Проект Azure DevOps автоматически настраивает сборку непрерывной интеграции и триггер выпуска.  Код остается в GitHub или другом внешнем репозитории.  

## <a name="commit-changes-to-github-and-automatically-deploy-to-azure"></a>Фиксация изменений в GitHub и автоматическое развертывание в Azure 

Теперь вы готовы сотрудничать с командой в своем приложении с процессом CI/CD, который автоматически развертывает данные последней работы на вашем веб-сайте.  Каждое изменение в репозитории GitHub запускает сборку в VSTS, а определение Release Management для VSTS выполняет развертывание в Azure.

1.  Внесите изменения в приложение и **зафиксируйте** их в репозитории GitHub.
2.  Через несколько секунд в VSTS начнется выполнение сборки.  Отслеживайте состояние сборки с помощью панели мониторинга проекта DevOps или в браузере, используя учетную запись VSTS.
3.  По завершении сборки **обновите приложение** в браузере, чтобы убедиться, что вы видите изменения.

## <a name="examine-the-vsts-cicd-pipeline"></a>Анализ конвейера VSTS CI/CD

Проект Azure DevOps автоматически настроил полный конвейер VSTS CI/CD в вашей учетной записи VSTS.  При необходимости изучите и настройте конвейер.  Выполните следующие шаги, чтобы ознакомиться с определениями выпуска и сборки VSTS.

1. Щелкните **Конвейеры сборки** в **верхней части** панели мониторинга проекта Azure DevOps.  Эта ссылка открывает вкладку браузера и определение сборки VSTS нового проекта.

1. Переместите указатель мыши справа от определения сборки рядом с полем **Состояние**. Выберите отобразившееся **многоточие**.  После этого откроется меню, в котором можно начать выполнение нескольких действий, таких как постановка новой сборки в очередь, приостановка создания и изменение определения сборки.

1. Выберите **Изменить**

1. В этом представлении **рассмотрите различные задачи** для определения сборки.  Сборка выполняет различные задачи, такие как выборка источников из репозитория Git, восстановление зависимостей и публикация результатов, используемых для развертывания.

1. В верхней части определения сборки выберите **имя определения сборки**.

1. Замените **имя** определения сборки более описательным именем.  Щелкните **Save & queue** (Сохранить и поместить в очередь), а затем выберите **Сохранить**.

1. Под именем определения сборки щелкните **Журнал**.  Вы увидите журнал аудита последних изменений сборки.  VSTS отслеживает любые изменения, внесенные в определение сборки, и позволяет сравнивать версии.

1. Выберите **Триггеры**.  Проект Azure DevOps автоматически создал триггер CI, а каждая фиксация в репозитории запускает новую сборку.  При желании выберите включение или исключение ветвей из процесса непрерывной интеграции.

1. Щелкните **Период удержания**.  На основе вашего сценария можно указать политики для хранения или удаления определенного количества сборок.

1. Щелкните **Сборка и выпуск**, а затем выберите **Выпуски**.  Проект Azure DevOps создал определение выпуска VSTS для управления развертываниями в Azure.

1. В левой части браузера щелкните **многоточие** рядом с определением выпуска, а затем выберите **Изменить**.

1. Определение выпуска содержит **конвейер**, определяющий процесс выпуска.  В разделе **Артефакты** выберите **Удалить**.  Определение сборки, рассмотренное на предыдущих этапах, создает выходные данные, используемые для артефакта. 

1. Справа от значка **Удалить** выберите **Триггер непрерывного развертывания**.  Это определение выпуска содержит триггер непрерывного развертывания, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки.  При желании можно отключить триггер, чтобы развертывание требовалось выполнять вручную. 

1. В левой части окна браузера выберите **Задачи**.  Задачи являются действиями, выполняемыми в процессе развертывания.  В этом примере задача была создана для развертывания в **службу приложений Azure**.

1. В правой части окна браузера выберите **Просмотреть выпуски**.  В этом представлении можно просмотреть журнал выпусков.

1. Щелкните **многоточие** рядом с одним из выпусков и выберите **Открыть**.  В этом представлении есть несколько меню, которые можно изучить, например меню сводки, связанных рабочих элементов и тестов.

1. Щелкните **Фиксации**.  В этом представлении отображаются фиксации кода, связанные с конкретным развертыванием. 

1. Выберите **Журналы**.  Журналы содержат полезную информацию о процессе развертывания.  Их можно просматривать как во время, так и после развертывания.

## <a name="configure-azure-application-insights-monitoring"></a>Настройка мониторинга Azure Application Insights

С помощью Azure Application Insights можно легко отслеживать производительность и использование своего приложения.  Проект Azure DevOps автоматически настроил ресурс Application Insights для вашего приложения.  Вы можете дополнительно настроить различные предупреждения и возможности мониторинга по мере необходимости.

1. Перейдите на панель мониторинга **проекта Azure DevOps** на портале Azure.  В правом нижнем углу панели мониторинга выберите ссылку **​​Application Insights** для своего приложения.

1. На портале Azure откроется колонка **Application Insights**.  Это представление содержит информацию об использовании, производительности и доступности приложения.

    ![Application Insights](_img/azure-devops-project-github/appinsights.png) 

1. Щелкните **Диапазон времени**, а затем выберите **За последний час**.  Щелкните **Обновить**, чтобы отфильтровать результаты.  Отобразится вся активность за последние 60 минут.  Щелкните **x**, чтобы закрыть диапазон времени.

1. Выберите **Оповещения**, затем щелкните **+ Добавить оповещение метрики**.  

1. Введите **имя** оповещения.

1. Выберите раскрывающийся список для **Source Alter on** (Изменить источник).  Выберите необходимый **ресурс службы приложений.**

1. По умолчанию оповещение отображается, если **время отклика сервера превышает 1 секунду**.  Выберите раскрывающийся список **Метрика**, чтобы просмотреть различные оповещения метрики.  Различные оповещения можно легко настроить, чтобы улучшить возможности мониторинга приложения.

1. Установите флажок **Notify via Email owners, contributors, and readers** (Уведомлять по электронной почте владельцев, участников и читателей).  При желании вы можете выполнять дополнительные действия, когда срабатывает оповещение во время выполнения приложения логики Azure.

1. Нажмите кнопку **ОК**, чтобы создать оповещение.  Через несколько секунд предупреждение появится на панели мониторинга как активное.  **Выйдите из** области оповещений и вернитесь в колонку **Application Insights**.

1. Выберите **Доступность**, затем щелкните **+ Add test** (+ Добавить тест). 

1. Введите **имя теста**, а затем выберите **Создать**.  Создается простой тест проверки связи для проверки доступности вашего приложения.  Через несколько минут результаты тестирования будут доступны, а на панели мониторинга Application Insights отобразится состояние доступности.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вам больше не нужны служба приложений Azure и связанные с ней ресурсы, созданные в рамках этого краткого руководства, их можно удалить с помощью функции **Удалить** на панели мониторинга проекта Azure DevOps.

## <a name="next-steps"></a>Дополнительная информация

После настройки процесса CI/CD в рамках этого руководства в проекте VSTS автоматически создается определение сборки и выпуска. Вы можете изменить эти определения сборки и выпуска в соответствии с потребностями вашей команды. Вы научились выполнять следующие задачи:

> [!div class="checklist"]
> * Создание проекта Azure DevOps.
> * Настройка доступа к репозиторию GitHub и выбор платформы.
> * Настройка VSTS и подписки Azure. 
> * Фиксация изменений в GitHub и автоматическое развертывание в Azure.
> * Анализ конвейера VSTS CI/CD.
> * Настройка мониторинга Azure Application Insights.

Чтобы получить дополнительные сведения о конвейере VSTS, см. это руководство:

> [!div class="nextstepaction"]
> [Define your multi-stage continuous deployment (CD) process](https://docs.microsoft.com/vsts/pipelines/release/define-multistage-release-process?view=vsts) (Определение многоэтапного процесса непрерывного развертывания)
