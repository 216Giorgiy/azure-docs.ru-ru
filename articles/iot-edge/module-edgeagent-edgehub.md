---
title: Справочные материалы по модулям EdgeAgent и EdgeHub в Azure IoT Edge | Документация Майкрософт
description: Обзор определенных свойств и их значений для двойников модулей EdgeAgent и EdgeHub
author: kgremban
manager: timlt
ms.author: kgremban
ms.date: 03/14/2018
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: 0b9e7421bb09e619b4a820910db5faa9edfcc5d5
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34632913"
---
# <a name="properties-of-the-edge-agent-and-edge-hub-module-twins"></a>Свойства двойников модулей EdgeAgent и EdgeHub

EdgeAgent и EdgeHub — это два модуля, которые составляют среду выполнения IoT Edge. Дополнительные сведения о функциях каждого модуля см. в статье [Общие сведения о среде выполнения Azure IoT Edge и ее архитектуре (предварительная версия)](iot-edge-runtime.md). 

В этой статье представлены требуемые и отображаемые в отчете свойства двойников модулей для среды выполнения. Дополнительные сведения о развертывании модулей на устройствах IoT Edge см. в статье [Understand IoT Edge deployments for single devices or at scale - preview][lnk-deploy] (Основные сведения о развертываниях IoT Edge для одного устройства или в требуемом масштабе (предварительная версия)).

## <a name="edgeagent-desired-properties"></a>Требуемые свойства EdgeAgent

Двойник модуля для агента Edge называется `$edgeAgent`. Он координирует взаимодействие между агентом Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько. 

| Свойство | ОПИСАНИЕ | Обязательно |
| -------- | ----------- | -------- |
| schemaVersion | Должно быть "1.0". | Yes |
| runtime.type | Должно быть "docker". | Yes |
| runtime.settings.minDockerVersion | Задайте минимальную версию Docker, которая требуется для этого манифеста развертывания. | Yes |
| runtime.settings.loggingOptions | Переведенные в строку JSON, содержащую параметры ведения журнала для контейнера агента Edge. [Параметры ведения журнала Docker][lnk-docker-logging-options] | Нет  |
| systemModules.edgeAgent.type | Должно быть "docker". | Yes |
| systemModules.edgeAgent.settings.image | Универсальный код ресурса (URI) образа агента Edge. В настоящее время агент Edge не может обновить себя сам. | Yes |
| systemModules.edgeAgent.settings.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера агента Edge. [Параметры создания Docker][lnk-docker-create-options] | Нет  |
| systemModules.edgeAgent.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Этот параметр задается в Центре Интернета вещей при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| systemModules.edgeHub.type | Должно быть "docker". | Yes |
| systemModules.edgeHub.status | Должно быть "running". | Yes |
| systemModules.edgeHub.restartPolicy | Должно быть "always". | Yes |
| systemModules.edgeHub.settings.image | Универсальный код ресурса (URI) образа концентратора Edge. | Yes |
| systemModules.edgeHub.settings.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера концентратора Edge. [Параметры создания Docker][lnk-docker-create-options] | Нет  |
| systemModules.edgeHub.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Этот параметр задается в Центре Интернета вещей при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| modules.{ИД_модуля}.version | Определяемая пользователем строка, представляющая версию этого модуля. | Yes |
| modules.{ИД_модуля}.type | Должно быть "docker". | Yes |
| modules.{ИД_модуля}.restartPolicy | {"never" \| "on-failed" \| "on-unhealthy" \| "always"} | Yes |
| modules.{ИД_модуля}.settings.image | Универсальный код ресурса (URI) для образа модуля. | Yes |
| modules.{ИД_модуля}.settings.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера модуля. [Параметры создания Docker][lnk-docker-create-options] | Нет  |
| modules.{ИД_модуля}.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Этот параметр задается в Центре Интернета вещей при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |

## <a name="edgeagent-reported-properties"></a>Отображаемые в отчете свойства EdgeAgent

Сообщаемые свойства агента Edge включают в себя три основных элемента информации:

1. состояние применения последних требуемых свойств;
2. состояние модулей, запущенных на устройстве, зарегистрированное агентом Edge;
3. копия требуемых свойств, выполняемых в данное время на устройстве.

Последний элемент данных полезен в случае, если требуемые свойства не были успешно применены в среде выполнения и устройство по прежнему работает под управлением предыдущего манифеста развертывания.

> [!NOTE]
> Сообщаемые свойства агента Edge полезны, так как к ним можно выполнять запросы с помощью [языка запросов Центра Интернета вещей][lnk-iothub-query], чтобы узнать состояние развертывания в масштабе. Дополнительные сведения о том, как использовать эту функцию см. в статье [Understand IoT Edge deployments for single devices or at scale - preview][lnk-deploy] (Основные сведения о развертываниях IoT Edge для одного устройства или в требуемом масштабе (предварительная версия)).

Следующая таблица не включает сведения, которые копируются из требуемых свойств.

| Свойство | ОПИСАНИЕ |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых модулем EdgeAgent. |
| lastDesiredStatus.code | Это код состояния, ссылающийся на последние требуемые свойства, используемые агентом Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация,`412` — недопустимая версия схемы, `417` — нужные свойства пусты, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание состояния. |
| deviceHealth | Имеет значение `healthy`, если состояние среды выполнения всех модулей имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| configurationHealth.{ИД_развертывания}.health | Имеет значение `healthy`, если состояние среды выполнения всех модулей, установленное развертыванием {ИД_развертывания}, имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| runtime.platform.OS | Сообщает ОС, выполняющуюся на устройстве. |
| runtime.platform.architecture | Сообщает архитектуру ЦП на устройстве. |
| systemModules.edgeAgent.runtimeStatus | Состояние агента Edge: {"running" \| "unhealthy"} |
| systemModules.edgeAgent.statusDescription | Текстовое описание сообщаемого состояния агента Edge. |
| systemModules.edgeHub.runtimeStatus | Текущее состояние центра Edge: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| systemModules.edgeHub.statusDescription | Текстовое описание текущего состояния концентратора Edge, если он неработоспособен. |
| systemModules.edgeHub.exitCode | Если выполнен выход, код завершения, сообщаемый контейнером концентратора Edge. |
| systemModules.edgeHub.startTimeUtc | Время последнего запуска концентратора Edge. |
| systemModules.edgeHub.lastExitTimeUtc | Время последнего завершения работы концентратора Edge. |
| systemModules.edgeHub.lastRestartTimeUtc | Время последнего перезапуска концентратора Edge. |
| systemModules.edgeHub.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |
| modules.{ИД_модуля}.runtimeStatus | Текущее состояние модуля: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| modules.{ИД_модуля}.statusDescription | Текстовое описание текущего состояния модуля, если он неработоспособен. |
| modules.{ИД_модуля}.exitCode | Если выполнен выход, код завершения, сообщаемый контейнером модуля. |
| modules.{ИД_модуля}.startTimeUtc | Время последнего запуска модуля. |
| modules.{ИД_модуля}.lastExitTimeUtc | Время последнего завершения работы модуля. |
| modules.{ИД_модуля}.lastRestartTimeUtc | Время последнего перезапуска модуля. |
| modules.{ИД_модуля}.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |

## <a name="edgehub-desired-properties"></a>Требуемые свойства EdgeHub

Двойник модуля концентратора Edge называется `$edgeHub`. Он координирует взаимодействие между концентратором Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько. 

| Свойство | ОПИСАНИЕ | Требуется в манифесте развертывания |
| -------- | ----------- | -------- |
| schemaVersion | Должно быть "1.0". | Yes |
| routes.{имя_маршрута} | Строка, представляющая маршрут концентратора Edge. | Элемент `routes` может присутствовать, но быть пустым. |
| storeAndForwardConfiguration.timeToLiveSecs | Время в секундах, в течение которого модуль EdgeHub сохраняет сообщения в случае отключения конечных точек маршрутизации, например отключения от Центра Интернета вещей или локального модуля. | Yes |

## <a name="edgehub-reported-properties"></a>Отображаемые в отчете свойства EdgeHub

| Свойство | ОПИСАНИЕ |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых модулем EdgeHub. |
| lastDesiredStatus.code | Это код состояния, ссылающийся на последние требуемые свойства, используемые концентратором Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание состояния. |
| clients.{удостоверение устройства или модуля}.status | Состояние подключения этого устройства или модуля. Возможные значения {"connected" \| "disconnected"}. В отключенном состоянии могут находиться только удостоверения модуля. Подчиненные устройства, подключающиеся к концентратору Edge, отображаются только при подключении. |
| clients.{удостоверение устройства или модуля}.lastConnectTime | Время последнего подключения модуля или устройства. |
| clients.{удостоверение устройства или модуля}.lastDisconnectTime | Время последнего отключения модуля или устройства. |

## <a name="next-steps"></a>Дополнительная информация

Сведения о том, как использовать эти свойства для создания манифестов развертывания, см. в статье [Сведения об использовании, настройке и повторном использовании модулей Azure IoT Edge (предварительная версия)](module-composition.md).

<!--links -->
[lnk-deploy]: module-deployment-monitoring.md
[lnk-docker-create-options]: https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate
[lnk-docker-logging-options]: https://docs.docker.com/engine/admin/logging/overview/
[lnk-iothub-query]: ../iot-hub/iot-hub-devguide-query-language.md
