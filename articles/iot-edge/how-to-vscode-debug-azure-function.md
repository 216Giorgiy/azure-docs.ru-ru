---
title: Отладка модулей службы "Функции" для Azure IoT Edge | Документация Майкрософт
description: Использование Visual Studio Code для отладки решения "Функции Azure" C# с помощью Azure IoT Edge
services: iot-edge
keywords: ''
author: shizn
manager: timlt
ms.author: xshi
ms.date: 3/20/2018
ms.topic: article
ms.service: iot-edge
ms.openlocfilehash: cd870d8f5c3fff87b121ab777a086f21df07cfbc
ms.sourcegitcommit: d78bcecd983ca2a7473fff23371c8cfed0d89627
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2018
ms.locfileid: "34165671"
---
# <a name="use-visual-studio-code-to-debug-azure-functions-with-azure-iot-edge"></a>Использование Visual Studio Code для отладки решения "Функции Azure" с помощью Azure IoT Edge

В этой статье содержатся подробные инструкции по использованию [кода Visual Studio (VS)](https://code.visualstudio.com/) для отладки службы "Функции Azure" на IoT Edge.

## <a name="prerequisites"></a>предварительным требованиям
В этой статье предполагается, что для разработки вы используете компьютер или виртуальную машину под управлением Windows или Linux. Устройством Azure IoT Edge может быть другое физическое устройство или имитация устройства, запущенная на компьютере разработки.

> [!NOTE]
> Функции C# можно отлаживать только в контейнерах linux-amd64.

Перед выполнением инструкции в этой статье, выполните действия, описанные в статье о [разработке решения IoT Edge с несколькими модулями в Visual Studio Code](tutorial-multiple-modules-in-vscode.md). После этого должны быть готовы следующие элементы:
- Локальный реестр Docker, запущенный на компьютере разработки. Рекомендуем использовать локальный реестр Docker для создания прототипов и тестирования. Можно обновить реестр контейнеров в файле `module.json` каждой папки модулей.
- Рабочая область проекта решения IoT Edge с вложенной папкой модуля "Функция Azure".
- Файл `run.csx` с кодом функции.
- Среда выполнения Edge, выполняемая на компьютере разработки.

## <a name="build-your-iot-edge-function-module-for-debugging-purpose"></a>Создайте свой модуль функции IoT Edge для целей отладки
1. Чтобы начать отладку, повторно выполните сборку образа Docker с помощью **Dockerfile.amd64.debug** и повторно разверните решение Edge. В проводнике VS Code перейдите к файлу `deployment.template.json`. Обновите URL-адрес образа функции, добавив `.debug` в конце.

    ![Сборка образа для отладки](./media/how-to-debug-csharp-function/build-debug-image.png)

2. Перестройте решение. В палитре команд VS Code введите и выполните команду **Edge: Build IoT Edge solution**.
3. В обозревателе устройств Центра Интернета вещей Azure щелкните правой кнопкой мыши идентификатор устройства IoT Edge и выберите **Create deployment for Edge device** (Создать развертывание для устройства Edge). Выберите файл `deployment.json` в папке `config`. Ход развертывания можно отслеживать с помощью идентификатора развертывания во встроенном терминале VS Code.

Чтобы проверить состояние контейнера, откройте обозреватель кода Docker VS или выполните команду `docker images` в окне терминала.

## <a name="start-debugging-c-function-in-vs-code"></a>Запуск отладки функции C# в VS Code
1. VS Code хранит информацию о конфигурации отладки в файле `launch.json`, расположенном в папке `.vscode` рабочей области. Этот файл `launch.json` создан при создании решения IoT Edge. Он автоматически обновляется при каждом добавлении нового модуля, который поддерживает отладку. Перейдите к представлению отладки и выберите соответствующий файл конфигурации отладки.
    ![Выбор конфигурации отладки](./media/how-to-debug-csharp-function/select-debug-configuration.jpg)

2. Перейдите на страницу `run.csx`. Добавьте в функцию точку останова.
3. Нажмите кнопку **Начать отладку** или клавишу **F5**, затем выберите процесс для присоединения.
4. В представлении отладки VS Code можно просмотреть переменные на панели слева. 


> [!NOTE]
> В предыдущем примере показаны процесс отладки функции .Net Core IoT Edge в контейнерах. Он основан на отладочной версии файла `Dockerfile.amd64.debug`, который при сборке образа контейнера включает в него отладчик командной строки .NET Core (VSDBG). Мы рекомендуем использовать для рабочей версии функции IoT Edge готовый или отдельно настроенный файл `Dockerfile` без отладчика VSDBG, когда вы завершите отладку функции C#.

## <a name="next-steps"></a>Дополнительная информация


[Использование Visual Studio Code для отладки модуля C# с помощью Azure IoT Edge](how-to-vscode-debug-csharp-module.md)

