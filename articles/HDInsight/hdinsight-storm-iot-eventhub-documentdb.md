<properties
 pageTitle="Обработка данных с датчиков автомобилей с использованием концентраторов событий и средств Apache Storm в HDInsight"
 description="Узнайте, как обрабатывать данные с датчиков автомобилей из концентраторов событий Azure с использованием средств Apache Storm в HDInsight. Во время обработки данные дополняются сведениями о модели автомобиля, полученными из базы DocumentDB. В конечном итоге данные записываются в хранилище Azure."
 services="hdinsight"
 documentationCenter=""
 authors="Blackmist"
 manager="paulettm"
 editor="cgronlun"/>

<tags
ms.service="hdinsight"
ms.devlang="java"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="big-data"
ms.date="04/28/2015"
ms.author="larryfr"/>

#Обработка данных с датчиков из концентраторов событий Azure с использованием средств Apache Storm в HDInsight

Узнайте, как обрабатывать данные с датчиков автомобилей из концентраторов событий Azure с использованием средств Apache Storm в HDInsight. В этом примере производится считывание данных с датчиков из концентраторов событий Azure, которые дополняются сведениями из Azure DocumentDB, с последующей записью полученных данных в хранилище Azure с использованием файловой системы Hadoop (HDFS).

![схема архитектуры](./media/hdinsight-storm-iot-eventhub-documentdb/iot.png)

##Обзор

Датчики на автомобилях помогают прогнозировать возникновение неполадок оборудования на основе тенденций в массивах статистических данных, а также совершенствовать последующие версии датчиков, руководствуясь результатами анализа закономерностей в их использовании. В то время как для такого анализа можно использовать традиционные средства обработки пакетов данных MapReduce, необходима возможность быстро и эффективно загружать данные со всех автомобилей в систему Hadoop до начала их обработки средствами MapReduce. Кроме того, целесообразно реализовать анализ путей критических отказов (температуры в двигателе, неполадок тормозной системы и т. д.) в режиме реального времени.

Концентраторы событий Azure позволяют справляться с большими объемами данных, поступающих с датчиков, а с помощью средств Apache Storm в HDInsight можно реализовать загрузку и обработку данных перед их сохранением в HDFS (на базе хранилища Azure) для обработки с использованием традиционных алгоритмов MapReduce.

##Решение

Данные телеметрии, связанные с температурой двигателя и окружающей среды, и также скоростью автомобиля, фиксируются датчиками и отправляются в концентраторы событий вместе с идентификационным номером автомобиля (VIN-кодом) и отметкой времени. Топология Storm, работающая на платформе Apache Storm в кластере HDInsight, считывает эту информацию оттуда, обрабатывает ее и сохраняет в системе HDFS.

Во время обработки VIN-код используется для извлечения сведений о модели автомобиля из базы Azure DocumentDB. Они добавляются в поток данных перед его сохранением.

В топологии Storm используются перечисленные ниже компоненты.

* **EventHubSpout**: считывает данные из концентраторов событий Azure.

* **TypeConversionBolt**: преобразует строку JSON, полученную из концентраторов событий, в кортеж с отдельными значениями температуры двигателя, температуры окружающей среды, скорости, VIN-кода и отметки времени.

* **DataReferencBolt**: ищет сведения о модели автомобиля в DocumentDB на основе VIN-кода.

* **WasbStoreBolt**: сохраняет данные в HDFS (хранилище Azure).

Ниже представлена схема этого решения.

![топология Storm](./media/hdinsight-storm-iot-eventhub-documentdb/iottopology.png)

> [AZURE.NOTE]Это упрощенная схема, и у каждого компонента решения может быть несколько экземпляров. Например, несколько экземпляров каждого компонента топологии могут быть распределены между узлами Storm в кластере HDInsight.

##Реализация

Полное автоматизированное решение на базе этого сценария доступно в репозитории <a href="https://github.com/hdinsight/hdinsight-storm-examples" target="_blank">HDInsight-Storm-Examples</a> в службе GitHub. Чтобы воспользоваться этим примером, следуйте инструкциям в файле [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).

## Дальнейшие действия

Другие примеры топологий Storm см. в разделе [Примеры топологий для Storm в HDInsight](hdinsight-storm-example-topology.md).

<!--HONumber=52-->
 