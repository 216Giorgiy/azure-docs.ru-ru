---
title: Мониторинг производительности служб приложений Azure | Документация Майкрософт
description: Мониторинг производительности приложений для служб приложений Azure. Диаграммы времени загрузки и ответа, информация о зависимостях и настройка оповещений о производительности.
services: application-insights
documentationcenter: .net
author: mrbullwinkle
manager: carmonm
ms.assetid: 0b2deb30-6ea8-4bc4-8ed0-26765b85149f
ms.service: application-insights
ms.workload: na
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 10/25/2018
ms.author: mbullwin
ms.openlocfilehash: 17d8eff39eabb2f7b4968bf74d2482b980fe8060
ms.sourcegitcommit: 818d3e89821d101406c3fe68e0e6efa8907072e7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/09/2019
ms.locfileid: "54116625"
---
# <a name="monitor-azure-app-service-performance"></a>Мониторинг производительности Службы приложений Azure
На [портале Azure](https://portal.azure.com) можно настроить мониторинг производительности веб-приложений, мобильных серверных приложений и приложений API в [Службе приложений Azure](../../app-service/overview.md). [Azure Application Insights](../../azure-monitor/app/app-insights-overview.md) инструментируют ваше приложение для отправки данных телеметрии о действиях в службу Application Insights, где эти данные хранятся и анализируются. В этой службе диаграммы метрик и инструменты поиска могут использоваться для диагностики неисправностей, улучшения производительности и анализа использования приложения.

## <a name="run-time-or-build-time"></a>Инструментирование во время выполнения и во время сборки
Вы можете настроить параметры мониторинга с помощью инструментирования приложения одним из следующих способов:

* **Во время выполнения.** Вы можете добавить расширение для мониторинга производительности, когда служба приложений станет активной.  Для этого не обязательно выполнять повторную сборку или установку приложения. Вы получаете стандартный набор пакетов для отслеживания времени отклика, частоты успешных выполнений, исключений, зависимостей и т. д. 
* **Во время сборки.** Вы можете добавить пакет в код своего приложения на этапе разработки. Этот способ является более гибким решением. Помимо установки стандартных пакетов, вы можете написать код для настройки данных телеметрии либо для отправки пользовательской телеметрии. Вы можете вести журнал действий или регистрировать события в соответствии с семантикой домена вашего приложения. 

## <a name="run-time-instrumentation-with-application-insights"></a>Инструментирование во время выполнения с помощью Application Insights
Если вы уже используете службу приложений в Azure, то наверняка получили определенные сведения мониторинга, касающиеся частоты запросов и ошибок. Добавьте Application Insights, чтобы получить дополнительные сведения и возможности, такие как время отклика, мониторинг вызовов зависимостей, интеллектуальное обнаружение и мощный язык запросов Log Analytics. 

1. На панели управления Azure **выберите Application Insights** для своей службы приложений.

    ![В разделе "Параметры" выберите пункт Application Insights](./media/azure-web-apps/settings-app-insights.png)

   * Нажмите переключатель "Создать новый ресурс", если вы еще не настроили ресурс Application Insights для этого приложения. 

    > [!NOTE]
    > Нажав кнопку **OK** для создания нового ресурса, вам будет предложено выбрать параметр **Применение параметров мониторинга**. Нажав кнопку **Продолжить**, вы свяжете новый ресурс Application Insights со службой приложений, а также **активируете перезапуск самой службы приложений**. 

    ![Инструментирование веб-приложения](./media/azure-web-apps/create-resource.png)

2. Указав ресурс для использования, вы можете выбрать способ сбора данных в Application Insights для каждой платформы для приложения.

    ![Выбор параметров для каждой платформы](./media/azure-web-apps/choose-options.png)

3. **Выполните инструментирование службы приложений** после установки Application Insights.

   **Включите мониторинг на стороне клиента** для получения сведений о просмотрах страниц и данных телеметрии пользователя.

   * Выберите элементы "Параметры > Параметры приложения".
   * В разделе "Параметры приложения" добавьте новую пару "ключ — значение":

    Ключ: `APPINSIGHTS_JAVASCRIPT_ENABLED`.

    Значение: `true`
   * **Сохраните** параметры и **перезапустите** приложение.
4. Просматривать данные мониторинга приложения можно, выбрав **Параметры** > **Application Insights** > **Больше в Application Insights**.

Позже при необходимости можно создать приложение с помощью Application Insights.

*Как удалить Application Insights или отправлять данные на другой ресурс?*

* Откройте колонку управления веб-приложением в Azure и в разделе параметров откройте **Application Insights**. Вы можете отключить Application Insights, щелкнув **Отключить** сверху. Можно также выбрать новый ресурс в разделе **	Изменение ресурса**.

## <a name="build-the-app-with-application-insights"></a>Создание приложения с поддержкой Application Insights
Установите пакет SDK в свое приложение, чтобы воспользоваться более подробными сведениями телеметрии Application Insights. В частности, можно собирать журналы трассировки, [написать код пользовательской телеметрии](../../azure-monitor/app/api-custom-events-metrics.md) и получать более подробные отчеты об исключениях.

1. **В Visual Studio** (2013 года с обновлением 2 или более поздней версии) настройте Application Insights для проекта.

    Щелкните веб-проект правой кнопкой мыши и выберите **Добавить > Application Insights** или **Проект** > **Application Insights** > **Настроить Application Insights**.

    ![Щелкните правой кнопкой мыши веб-проект и выберите добавление или настройку Application Insights.](./media/azure-web-apps/03-add.png)

    Если отобразится предложение войти, воспользуйтесь данными вашей учетной записи Azure.

    Операция выполняет два действия:

   1. Создает ресурс Application Insights, в котором выполняется отображение, хранение и анализ данных телеметрии.
   2. Добавляет пакет NuGet Application Insights в код (если его еще нет) и настраивает его для отправки данных телеметрии в ресурс Azure.
2. **Проверьте данные телеметрии**, запустив приложение на компьютере разработки (F5).
3. **Опубликуйте приложение** в Azure обычным способом. 

*Как отправлять данные на другой ресурс Application Insights?*

* В Visual Studio щелкните проект правой кнопкой мыши, выберите **Настроить Application Insights**, а затем выберите нужный ресурс. После этого вы сможете создать, заново собрать или повторно развернуть ресурс.

## <a name="more-telemetry"></a>Дополнительные данные телеметрии

* [Данные о загрузке веб-страницы](../../azure-monitor/app/javascript.md)
* [Пользовательская телеметрия](../../azure-monitor/app/api-custom-events-metrics.md)

## <a name="video"></a>Видео

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/100/player]

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="appinsightsjavascriptenabled-causes-incomplete-html-response-in-net-core-web-applications"></a>Параметр APPINSIGHTS_JAVASCRIPT_ENABLED вызывает неполный ответ HTML в веб-приложениях NET CORE.

Включение Javascript с помощью служб приложений может привести к усечению HTML-ответов.

- Возможное решение 1. Задайте для параметра приложения APPINSIGHTS_JAVASCRIPT_ENABLED значение false либо полностью удалите этот параметр и выполните перезагрузку.
- Возможное решение 2. Добавьте пакет SDK с помощью кода и удалите расширение (расширения Profiler и Snapshot Debugger не работают с такой конфигурацией).

Мы отслеживаем эту проблему [здесь](https://github.com/Microsoft/ApplicationInsights-Home/issues/277).

## <a name="next-steps"></a>Дополнительная информация
* [Запуск профилировщика в живом приложении](../../azure-monitor/app/profiler.md).
* [Функции Azure.](https://github.com/christopheranderson/azure-functions-app-insights-sample) Отслеживайте функции Azure с помощью Application Insights.
* [Включите отправку данных диагностики Azure](../../azure-monitor/platform/diagnostics-extension-to-application-insights.md) в Application Insights.
* [Отслеживайте метрики состояния службы](../../azure-monitor/platform/data-collection.md), чтобы убедиться, что служба доступна и отвечает на запросы.
* [Получайте уведомления](../../azure-monitor/platform/alerts-overview.md) при возникновении операционных событий или превышении пороговых значений метрик.
* Используйте [расширение Application Insights для приложений JavaScript и веб-страниц](../../azure-monitor/app/javascript.md), чтобы получать данные телеметрии клиентов из браузеров, которые используются для открытия веб-страницы.
* [Настройте веб-тесты доступности](../../azure-monitor/app/monitor-web-app-availability.md), чтобы получать уведомления о сбоях в работе сайта.

