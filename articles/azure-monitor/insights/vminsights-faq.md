---
title: 'Azure Monitor для виртуальных машин (предварительная версия): вопросы и ответы | Документация Майкрософт'
description: Azure Monitor для виртуальных машин (предварительная версия) – это решение Azure, которое совмещает мониторинг работоспособности и производительности операционной системы виртуальной машины Azure. Оно автоматически обнаруживает компоненты приложений и их зависимости от других ресурсов и сопоставляет взаимодействие между ними. Эта статья содержит ответы на часто задаваемые вопросы.
services: azure-monitor
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: tysonn
ms.assetid: ''
ms.service: azure-monitor
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 11/08/2018
ms.author: magoedte
ms.openlocfilehash: a97a7be0eaa8438a4df27b610106ec6ab9f60d30
ms.sourcegitcommit: 5b869779fb99d51c1c288bc7122429a3d22a0363
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2018
ms.locfileid: "53184398"
---
# <a name="azure-monitor-for-vms-preview-faq"></a>Azure Monitor для виртуальных машин (предварительная версия). Вопросы и ответы
В этой статье изложены ответы на некоторые часто задаваемые вопросы об Azure Monitor для виртуальных машин. Если у вас есть другие вопросы об этом решении, вы можете задать их на [форуме для обсуждений Azure](https://feedback.azure.com/forums/34192--general-feedback). Если вопрос задается часто, мы добавим его в эту статью, чтобы его можно было найти быстро и легко.

## <a name="can-i-deploy-vms-to-an-existing-workspace"></a>Можно ли развернуть виртуальные машины к существующей рабочей области?
Если ваши виртуальные машины уже подключены к рабочей области Log Analytics, вы можете продолжить использовать эту рабочую область при развертывании в Azure Monitor для виртуальных машин. Рабочая область должна находиться в одном из поддерживаемых регионов, перечисленных в разделе "Необходимые компоненты" статьи [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md#prerequisites) (Развертывание для виртуальных машин (предварительная версия)).

Настройка счетчиков производительности для рабочей области происходит во время развертывания. Это действие принуждает виртуальные машины, которые передают отчетные данные в рабочую область, начинать сбор данных для отображения и анализа в Azure Monitor для виртуальных машин. В результате будут отображаться данные производительности, которые получены со всех виртуальных машин, подключенных к выбранной рабочей области. Функции "Работоспособность" и "Схема" будут включены только для тех виртуальных машин, которые вы укажете для развертывания.

Дополнительные сведения о включенных счетчиках производительности см. в статье [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md) (Развертывание для виртуальных машин (предварительная версия)).

## <a name="can-i-deploy-vms-to-a-new-workspace"></a>Можно ли развертывать виртуальные машины в рабочую область? 
Если на данный момент ваши виртуальные машины не подключены к существующей рабочей области Log Analytics, вам потребуется создать рабочую область для хранения ваших данных. Ви можете автоматически создать одну из них, настроив одну виртуальную машину для Azure Monitor для виртуальных машин на портале Azure.

Если вы желаете воспользоваться методом, основанном на скриптах, см. [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md) (Развертывание для виртуальных машин (предварительная версия)). 

## <a name="what-can-i-do-if-my-vm-is-already-reporting-to-an-existing-workspace"></a>Что делать, если виртуальная машина уже отправляет отчеты в существующую рабочую область?
Если вы уже собираете данные со своих виртуальных машин, возможно, вы уже настроили их для передачи отчетных данных в существующую рабочую область Log Analytics. Пока эта рабочая область находится в одном из поддерживаемых регионов, вы можете включить Azure Monitor для виртуальных машин для этой существующей рабочей области. Мы активно работаем над поддержкой дополнительных регионов.

>[!NOTE]
>Мы настраиваем счетчики производительности для рабочей области, которые затрагивают все виртуальные машины, отправляющие отчетные данные в эту рабочую область, независимо от того, разверните ли вы их к Azure Monitor для виртуальных машин. Дополнительные сведения о настройке счетчиков производительности для рабочей области см в разделе "Настройка счетчиков производительности" в статье [Источники данных производительности Windows и Linux в Log Analytics](../../azure-monitor/platform/data-sources-performance-counters.md). Сведения о счетчиках, настроенных для Azure Monitor для виртуальных машин, см. в статье [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md)(Развертывание для виртуальных машин (предварительная версия)). 

## <a name="why-did-my-vm-deployment-fail"></a>Почему произошел сбой развертывания виртуальной машины?
При развертывании виртуальной машины Azure на портале Azure происходят указанные ниже события:

* Система создает рабочую область Log Analytics, используемую по умолчанию, если был выбран соответствующий параметр.
* Система настраивает счетчики производительности для выбранной рабочей области. Если не удастся выполнить это действие, в некоторых диаграммах и таблицах производительности не будут отображатся данные для подключенной вами виртуальной машины. Вы можете исправить эту проблему, запустив скрипт PowerShell, который описан в разделе "Включение с помощью PowerShell" статьи [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md#enable-with-powershell) (Развертывание для виртуальных машин (предварительная версия)).
* Если система определяет, что необходим агент Log Analytics, она устанавливает его на виртуальных машинах Azure, используя расширение виртуальной машины. 
* При необходимости на виртуальных машинах Azure с использованием расширения устанавливается Dependency Agent, которого требует функция "Схема" в Azure Monitor для виртуальных машин. 
* При необходимости настраиваются компоненты Azure Monitor, поддерживающие функцию "Работоспособность". Кроме того, настраивается виртуальная машина так, чтобы она предоставляла данные о работоспособности.

Во время развертывания мы проверяем состояние для каждого предыдущего действия и возвращаем состояние уведомления на портале. Настройка рабочей области и установка агента обычно занимает 5–10 минут. Просмотр данных мониторинга и работоспособности на портале занимает еще 5–10 минут. 

Если вы инициировали развертывание, но после этого отображаются сообщения о том, что необходимо развернуть виртуальную машину, подождите около 30 минут, пока виртуальная машина завершит процесс. 

## <a name="i-dont-see-some-or-any-data-in-the-performance-charts-for-my-vm"></a>На диаграммах производительности не отображаются некоторые или все данные для моей виртуальной машины
Если данные производительности не отображаются в таблице дисков или в диаграммах производительности, возможно, не настроены счетчики производительности в рабочей области. Чтобы устранить эту проблему, запустите скрипт PowerShell, который описан в разделе "Включение с помощью PowerShell" статьи [Deploy Azure Monitor for VMs (preview)](vminsights-onboard.md#enable-with-powershell) (Развертывание для виртуальных машин (предварительная версия)).

## <a name="how-is-the-azure-monitor-for-vms-map-feature-different-from-service-map"></a>Чем функция "Схема" в Azure Monitor для виртуальных машин отличается от функции "Сопоставление служб"?
Функция "Схема" в Azure Monitor для виртуальных машин основана на решении "Сопоставление служб", но при этом имеет указанные ниже отличия:

* Вы можете получить доступ к представлению "Схема", выбрав панель "Виртуальная машина" или элемент "Azure Monitor для виртуальных машин" в Azure Monitor.
* Теперь в функции "Схема" можно щелкать подключения и отображать данные метрик подключений на боковой панели.
* Для создания схем с целью улучшения поддержки сложных схем используется новый API.
* Отслеживаемые виртуальные машины теперь есть в узле групп клиентов, а на кольцевой диаграмме показаны доли отслеживаемых и неотслеживаемых виртуальных машин. Вы также можете фильтровать список компьютеров при развертывании группы.
* Отслеживаемые виртуальные машины теперь есть в узлах групп портов сервера, а на кольцевой диаграмме показаны доли отслеживаемых и неотслеживаемых машин. Вы также можете фильтровать список компьютеров при развертывании группы.
* Стиль схем был обновлен, и теперь он больше соответствует схеме приложений в приложении Azure Application Insights.
* Боковые панели были обновлены, но еще не имеют полного набора интеграций, которые поддерживались в "Сопоставлении служб": Управление обновлениями, отслеживания изменений, безопасность и служба поддержки. 
* Параметр для выбора групп и машин, которые нужно сопоставить, был обновлен. Теперь он поддерживает подписки, группы ресурсов, масштабируемые наборы виртуальных машин Azure и облачные службы.
* Вы не можете создать группы компьютеров в решении "Сопоставление служб", используя функцию "Схема" в Azure Monitor для виртуальных машин. 

## <a name="why-do-my-performance-charts-show-dotted-lines"></a>Почему диаграммы производительности отображаются пунктирными линиями?

На диаграммах производительности пунктирные линии вместо сплошных показаны по нескольким причинам:
* Возможен промежуток в сборе данных. 

* Выборка данных настроена по умолчанию на каждые 60 секунд. Вы можете увидеть пунктирные линии, если выберете узкий диапазон времени для диаграммы, а ваша частота выборки будет меньше размера контейнера, используемого в диаграмме. Допустим, вы выбрали частоту выборки 10 минут, а каждый контейнер на графике составляет 5 минут. В этом случае, если вы выберете больший диапазон времени для отображения, линии диаграммы должны вновь стать сплошными.

## <a name="are-groups-supported-with-azure-monitor-for-vms"></a>Поддерживаются ли группы в Azure Monitor для виртуальных машин?
Да. После установка агента зависимостей мы собираем сведения с виртуальных машин для отображения групп в зависимости от подписки, группы ресурсов, масштабируемых наборов виртуальных машин и облачных служб. Если вы используете "Сопоставление служб" и создали группы компьютеров, то эти группы также отображаются. Группы компьютеров также появятся в фильтре групп, если они были созданы для просматриваемой вами рабочей области. 

## <a name="how-can-i-display-the-details-about-whats-driving-the-95th-percentile-line-in-the-aggregate-performance-charts"></a>Как я могу отобразить сведения о факторах, влияющих на линию 95-го процентиля на агрегированных диаграммах производительности?
По умолчанию список отсортирован так, чтобы показывать вам виртуальные машины, которые имеют наибольшее значение 95-го процентиля для выбранной метрики. Исключением является диаграмма **Доступная память**, на которой показаны машины с самым низким значением пятого процентиля. Щелкните диаграмму, чтобы открыть представление с **лучшими параметрами** с соответствующей выбранной метрикой.

## <a name="how-does-the-map-feature-handle-duplicate-ips-across-various-virtual-networks-and-subnets"></a>Как функция "Схема" обрабатывает дублирующиеся IP-адреса в различных виртуальных сетях и подсетях?
Если диапазоны IP-адресов дублируются при использовании виртуальных машин либо масштабируемых наборов виртуальных машин Azure в подсетях и виртуальных сетях, в функции "Схема" Azure Monitor для виртуальных машин может отображаться неправильная информация. Нам известна эта проблема, и мы работаем над ее решением.

## <a name="does-the-map-feature-support-ipv6"></a>Поддерживает ли функция "Схема" протокол IPv6?
На данный момент функция "Схема" поддерживает только протокол IPv4, но мы работаем над поддержкой протокола IPv6. Мы также поддерживаем протокол IPv4, туннелируемый через протокол IPv6.

## <a name="when-i-load-a-map-for-a-resource-group-or-other-large-group-why-is-the-map-difficult-to-view"></a>Почему становится трудно просматривать схему, когда я загружаю схему для группы ресурсов или другой большой группы?
Несмотря на то что мы усовершенствовали функцию "Схема" в части отображения больших и сложных конфигураций, мы понимаем, что на схеме может быть много узлов, подключений и узлов, работающих как кластеры. Мы намерены продолжать работу над улучшением функции масштабирования.  

## <a name="why-does-the-network-chart-on-the-performance-tab-look-different-from-the-network-chart-on-the-azure-vm-overview-page"></a>Почему внешний вид диаграммы сети на вкладке "Производительность" отличается от внешнего вида диаграммы сети на странице общих сведений о виртуальной машине Azure?

На странице общих сведений о виртуальной машине Azure отображаются диаграммы, основанные на измерениях активности гостевой виртуальной машины, выполняемых узлом. На диаграмме сети на странице общих сведений о виртуальной машине Azure отображается только тот сетевой трафик, за который будет выставлен счет. Это отображение не включает трафик между виртуальными сетями. Данные и диаграммы, отображаемые в Azure Monitor для виртуальных машин, основаны на данных, получаемых из гостевой виртуальной машины, а на диаграмме сети отображается весь входящий и исходящий трафик TCP/IP виртуальной машины, включая трафик между виртуальными сетями.

## <a name="what-are-the-limitations-of-the-log-analytics-free-pricing-plan"></a>Каковы ограничения для Log Analytics ценовой категории "Бесплатный"?
Если вы настроили Azure Monitor с рабочей областью Log Analytics в ценовой категории *Бесплатный*, функция сопоставления Azure Monitor для виртуальных машин поддерживает подключение к рабочей области только пяти машин. 

Например, предположим, что у вас есть пять виртуальных машин, подключенных к свободной рабочей области. Если вы отключите одну виртуальную машину, а затем подключите новую, то новая виртуальная машина не будет отслеживаться, и сведения о ней не будут отображаться на странице карт. В этом сценарии, когда вы открываете новую виртуальную машину, вам предлагается использовать опцию **Попробовать сейчас** и выбрать **Аналитические сведения (предварительная версия)** на левой панели даже после установки на виртуальной машине. Однако вам не будут предлагаться параметры, которые обычно отображаются, если виртуальная машина не была развернута в Azure Monitor для виртуальных машин. 

## <a name="next-steps"></a>Дополнительная информация
Сведения о требованиях и методах, помогающих отслеживать виртуальные машины, см. в статье [Подключение Azure Monitor для виртуальных машин (предварительная версия)](vminsights-onboard.md).
