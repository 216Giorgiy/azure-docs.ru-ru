---
title: "Сетевые интерфейсы Azure | Документация Майкрософт"
description: "Узнайте, как создавать и удалять сетевые интерфейсы, а также назначать им общедоступные и частные IP-адреса. Узнайте, как подключать и отключать сетевые карты в виртуальных машинах Azure."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/14/2017
ms.author: jdial
translationtype: Human Translation
ms.sourcegitcommit: 07635b0eb4650f0c30898ea1600697dacb33477c
ms.openlocfilehash: f691f3886fce217ea784237f03a4f02ed58e12ee
ms.lasthandoff: 03/28/2017


---

# <a name="network-interfaces"></a>Сетевые интерфейсы

Узнайте о сетевых интерфейсах и способах работы с ними. Сетевая карта обеспечивает взаимодействие между виртуальной машиной и сетью с базовым программным обеспечением. На следующем рисунке показаны возможности, которые обеспечивает сетевая карта:

![Сетевой интерфейс](./media/virtual-network-network-interface/nic.png)

В этой статье объясняется, как работать с основными понятиями, показанными на рисунке. Щелкните любое из них, чтобы перейти непосредственно к соответствующему разделу:

- [Сетевые интерфейсы.](#nics) Сетевая карта подключена к одной подсети в виртуальной сети Azure. На рисунке к виртуальной машине **VM1** подключено две сетевые карты, а к виртуальной машине **VM2** — одна. Каждая сетевая карта подключена к одной виртуальной сети, но к разным подсетям. В этом разделе содержится процедура вывода списка существующих сетевых карт, а также процедура их создания, изменения и удаления.
- [IP-конфигурации.](#ip-configs) С каждой сетевой картой связана одна или несколько IP-конфигураций, которым назначен частный IP-адрес. Кроме того, IP-конфигурации может быть назначен общедоступный IP-адрес. На рисунке с каждой из сетевых карт **NIC1** и **NIC3** связано по одной IP-конфигурации, а с сетевой картой **NIC2** — две IP-конфигурации. IP-конфигурации, назначенной сетевым картам NIC1 и NIC3, назначены общедоступные IP-адреса, а IP-конфигурациям, назначенным сетевой карте NIC2, не назначены такие IP-адреса. В этом разделе описана процедура создания, изменения и удаления IP-конфигураций, которым статическим или динамическим способом назначены частные IP-адреса. Здесь также представлена пошаговая инструкция по связыванию общедоступного IP-адреса с IP-конфигурацией и по отмене этой связи.
- [Группы безопасности сети](#nsgs) содержат одно или несколько правил безопасности для входящего или исходящего трафика. Правила определяют тип входящего и исходящего сетевого трафика сетевого интерфейса, подсети или и тот, и другой. На рисунке с сетевыми картами **NIC1** и **NIC3** связана группа безопасности сети, а с **NIC2** — нет. В этом разделе содержатся инструкции по просмотру группы безопасности сети, применяемой к сетевой карте, добавлению группы безопасности сети к сетевой карте и удалению из нее.
- [Виртуальные машины.](#vms) К виртуальной машине подключается по крайней мере одна сетевая карта. В зависимости от размера к виртуальной машине можно подключить несколько сетевых карт. Дополнительные сведения об определении числа сетевых карт, поддерживаемых каждым из размеров виртуальной машины, см. в статьях [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md) и [Размеры виртуальных машин Linux в Azure](../virtual-machines/virtual-machines-linux-sizes.md). В этом разделе содержатся инструкции по созданию виртуальной машины с одной или несколькими сетевыми картами, а также по подключению сетевых карт к существующим виртуальным машинам и по их отключению.

Если вы не знакомы с сетевыми картами и виртуальными машинами в Azure, прежде чем ознакомиться с этой статьей, мы рекомендуем вам выполнить упражнение в статье [Создание первой собственной виртуальной сети](virtual-network-get-started-vnet-subnet.md). Выполнив его, вы сможете освоить работу с виртуальными сетями и виртуальными машинами.

Сведения в этой статье применимы к виртуальным машинам и сетевым картам, созданным с использованием модели развертывания с помощью Azure Resource Manager. Для создания ресурсов корпорация Майкрософт рекомендует использовать модель развертывания с помощью Resource Manager, а не классическую модель. Дополнительные сведения о различиях между двумя моделями см. в статье [Развертывание с помощью Azure Resource Manager и классическое развертывание: сведения о моделях развертывания и состоянии ресурсов](../azure-resource-manager/resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

В остальных разделах этой статьи представлены действия по выполнению задач, связанных с сетевой картой. В каждом разделе указано следующее:
- Действия для выполнения задачи на портале Azure. Для выполнения действий нужно войти на [портал Azure](http://portal.azure.com). [Зарегистрируйтесь для получения бесплатной пробной учетной записи](https://azure.microsoft.com/free), если у вас ее нет.
- Команды для выполнения задачи с помощью Azure PowerShell (со ссылками на справочник по командам). Установите и настройте PowerShell, выполнив действия, описанные в [этой статье](/powershell/azureps-cmdlets-docs?toc=%2fazure%2fvirtual-network%2ftoc.json). Для получения справки по командам PowerShell с примерами введите `get-help <command> -full`.
- Команды для выполнения задачи с помощью интерфейса командной строки Azure (Azure CLI) (со ссылками на справочник по командам). Установите и настройте Azure CLI 2.0, следуя инструкциям в [этой статье](/cli/azure/install-azure-cli?toc=%2fazure%2fvirtual-network%2ftoc.json). Для получения справки по командам интерфейса командной строки введите `az <command> -h`.

## <a name="nics"></a>Сетевые интерфейсы
Выполните действия, описанные в следующих разделах, чтобы создать, просмотреть, изменить и удалить сетевые интерфейсы и параметры.

### <a name="create-nic"></a>Создание сетевого интерфейса

Сетевую карту можно подключить к виртуальной машине или использовать отдельно. Сведения о подключении сетевой карты к виртуальной машине см. в [этом разделе](#vm-attach-nic) статьи.

Чтобы создать сетевую карту, сделайте следующее:

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетной записи, которой назначены как минимум разрешения на роль "Участник сети" для подписки. Сведения о назначении ролей и разрешений учетным записям см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).
2. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *сетевые интерфейсы*. Когда **сетевые интерфейсы** появятся в результатах поиска, щелкните их.
3. В появившейся колонке **Сетевые интерфейсы** щелкните **+ Add** (+ Добавить).
4. В появившейся колонке **Создать сетевой интерфейс** введите или выберите значения следующих параметров и щелкните **Создать**.

    |**Параметр**|**Обязательный?**|**Дополнительные сведения**|
    |---|---|---|
    |**Имя**|Да|Имя невозможно изменить после создания сетевой карты. Имя должно быть уникальным в пределах выбранной группы ресурсов. Рекомендации по именованию см. в статье [Naming conventions](/azure/architecture/best-practices/naming-conventions?toc=%2fazure%2fvirtual-network%2ftoc.json#naming-rules-and-restrictions) (Соглашения об именовании).|
    |**Виртуальная сеть**|Да|Сетевую карту можно подключать только к виртуальной сети, созданной в том же расположении и в той же подписке, что и сама сетевая карта. Виртуальная машина, к которой подключена сетевая карта, должна находиться в том же расположении и в той же подписке, что и сетевая карта. Если виртуальной сети нет, необходимо создать ее. Чтобы создать виртуальную сеть, выполните действия, описанные в [этой статье](virtual-networks-create-vnet-arm-pportal.md). После создания сетевой карты невозможно изменить виртуальную сеть, к которой она подключена.|
    |**Подсеть**|Да|Выберите подсеть в пределах выбранной виртуальной сети. После создания сетевой карты вы можете изменить подсеть, к которой она подключена.|
    |**Назначение общедоступных IP-адресов**|Да| DHCP-сервер Azure назначает частный IP-адрес сетевой карте при ее создании. DHCP-сервер назначает доступный адрес из диапазона адресов, определенного для подсети, к которой подключается сетевая карта. **Динамическое назначение.** Azure может назначить сетевой карте другой адрес, если виртуальная машина, к которой она подключена, запускается после того, как она была остановлена (освобождена). Адрес не меняется, если до перезапуска виртуальная машины не была остановлена (освобождена). **Статическое назначение.** Статические адреса изменяются только по требованию или при удалении сетевой карты. Метод назначения можно изменить после создания сетевой карты.|
    |**группа безопасности сети**.|Нет|Группы безопасности сети позволяют контролировать передачу исходящего и входящего сетевого трафика сетевой карты. Дополнительные сведения о группах безопасности сети см. в [этой статье](virtual-networks-nsg.md). К сетевой карте можно применить одну группу безопасности сети или не применять их вообще. То же касается и подсети, к которой подключена сетевая карта. Иногда применение группы безопасности сети к сетевой карте и подсети, к которой она подключена, может давать непредвиденные результаты. Сведения об устранении неполадок с группами безопасности сети, применяемыми к сетевым картам, см. в [этой статье](virtual-network-nsg-troubleshoot-portal.md#view-effective-security-rules-for-a-network-interface).|
    |**Подписка**|Да| Виртуальная машина, к которой подключается сетевая карта, и виртуальная сеть, к которой вы подключаете виртуальную машину, должны находиться в пределах одной подписки.|
    |**Группа ресурсов**|Да| Сетевая карта может находиться в той же группе ресурсов, что и виртуальная машина и виртуальная сеть, к которой она подключена, или в другой группе ресурсов.|
    |**Расположение**|Да|Виртуальная машина, к которой подключается сетевая карта, и виртуальная сеть, к которой вы подключаете виртуальную машину, должны находиться в одном расположении.|

Портал Azure создает основную IP-конфигурацию **ipconfig1** с динамическим частным IP-адресом и связывает ее с созданной сетевой картой. Дополнительные сведения об IP-конфигурациях см. в [соответствующем разделе](#ip-configs) этой статьи. Нельзя указать имя IP-конфигурации, созданной порталом, назначить статический частный IP-адрес или общедоступный IP-адрес при создании сетевой карты. При создании сетевой карты с помощью PowerShell или интерфейса командной строки можно указать имя IP-конфигурации, статический IP-адрес и назначить общедоступный IP-адрес. Вы можете изменить способ назначения частных IP-адресов и связь между общедоступным IP-адресом и сетевой картой после ее создания. Чтобы изменить параметры после создания сетевой карты, выполните действия, описанные в разделе [Изменение IP-конфигурации](#change-ip-config) этой статьи.

>[!Note]
> Azure назначает сетевой карте MAC-адрес только после ее подключения к виртуальной машине, а также после первого запуска виртуальной машины. Невозможно указать MAC-адрес, который Azure назначает сетевой карте. MAC-адрес назначен сетевой карте на период, пока она не будет удалена или пока не изменится частный IP-адрес, назначенный основной IP-конфигурации основной сетевой карты. Дополнительные сведения об IP-конфигурациях см. в [соответствующем разделе](#ip-configs) этой статьи.

|**Средство**|**Команда**|
|:---|:---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic create](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#create)|
|**PowerShell**|[New-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.4.0/new-azurermnetworkinterface/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#create)|

### <a name="view-nics"></a>Просмотр и изменение сетевых интерфейсов и параметров

Чтобы просмотреть и изменить сетевые интерфейсы и параметры, сделайте следующее:

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетной записи, которой назначены как минимум разрешения на роль "Участник сети" для подписки. Сведения о назначении ролей и разрешений учетным записям см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).
2. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *сетевые интерфейсы*. Когда **сетевые интерфейсы** появятся в результатах поиска, щелкните их.
3. В появившейся колонке **Сетевые интерфейсы** щелкните сетевую карту, которую нужно просмотреть или параметры которой нужно изменить.
4. Следующие параметры указаны в колонке, отображаемой для выбранной сетевой карты.
    - **Обзор.** Содержит сведения о сетевой карте, такие как IP-адреса, назначенные ей, а также виртуальная сеть, подсеть и виртуальная машина, к которым она подключена (если сетевая карта подключена к виртуальной машине). На следующем рисунке показан обзор параметров сетевой карты **mywebserver256**:   ![Обзор сетевой карты](./media/virtual-network-network-interface/nic-overview.png)
    - **Конфигурации IP.** Сетевой карте назначается по крайней мере одна IP-конфигурация. Ей можно назначить несколько IP-конфигураций. Дополнительные сведения о максимальном числе IP-конфигураций, поддерживаемых для сетевой карты, см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits). Каждой IP-конфигурации назначается один частный IP-адрес. Кроме того, с ней можно связать один общедоступный IP-адрес. Чтобы изменить отображаемые элементы, выполните действия в разделах [Добавление дополнительный IP-конфигурации к сетевой карте](#create-ip-config), [Изменение IP-конфигурации](#change-ip-config) или [Удаление IP-конфигурации](#delete-ip-config) этой статьи.
    - **DNS-серверы.** Вы можете указать, какому DNS-серверу назначена сетевая карта с использованием DHCP-серверов Azure. Доступны внутренний или пользовательский DNS-серверы. Чтобы изменить отображаемые элементы, выполните действия в разделе [Изменение параметров DNS для сетевой карты](#dns) этой статьи.
    - **Network security group (NSG)** (Группа безопасности сети (NSG)). Этот параметр указывает, связана ли с сетевой картой группа безопасности сети. Если группа безопасности сети связана с сетевой картой, отображается имя этой группы. Чтобы изменить отображаемые элементы, выполните действия в разделе [Связывание группы безопасности сети с сетевым интерфейсом и отмена связи](#associate-nsg) этой статьи.
    - **Свойства.** Здесь отображаются основные параметры сетевой карты, включая ее MAC-адрес и подписку, в пределах которой она используется. Сетевую карту можно переместить в другую группу ресурсов или подписку, переместив также все ее ресурсы. Например, если сетевая карта подключена к виртуальной машине, необходимо также переместить виртуальную машину и дополнительные ресурсы, связанные с ней. Сведения о перемещении сетевой карты см. в статье [Перемещение ресурсов в новую группу ресурсов или подписку](../azure-resource-manager/resource-group-move-resources.md?toc=%2fazure%2fvirtual-network%2ftoc.json#use-portal). В ней указаны необходимые условия для перемещения, а также процедура перемещения с использованием портала Azure, PowerShell и Azure CLI.
    - **Действующие правила безопасности.** Правила безопасности указываются, если сетевая карта подключена к запущенной виртуальной машине, а группа безопасности связана с сетевой картой, с подсетью, к которой подключена сетевая карта, или и с тем, и с другим. Дополнительные сведения об отображаемых элементах см. в статье [Устранение проблем с группами безопасности сети на портале Azure](virtual-network-nsg-troubleshoot-portal.md#view-effective-security-rules-for-a-network-interface). Дополнительные сведения о группах безопасности сети см. в [этой статье](virtual-networks-nsg.md).
    - **Фактические маршруты.** Маршруты указываются, если сетевая карта подключена к запущенной виртуальной машине. Маршруты представляют собой сочетание маршрутов Azure по умолчанию, любых определяемых пользователем маршрутов и всех маршрутов BGP, которые могут существовать для подсети, к которой подключена сетевая карта. Дополнительные сведения об отображаемых элементах см. в статье [Устранение проблем с маршрутами на портале Azure](virtual-network-routes-troubleshoot-portal.md#view-effective-routes-for-a-network-interface). Дополнительные сведения об определяемых пользователем маршрутах см. в [этой статье](virtual-networks-udr-overview.md).
    - **Common Azure Resource Manager settings** (Общие параметры диспетчера ресурсов Azure). Дополнительные сведения об общих параметрах диспетчера ресурсов Azure см. в статьях о [журнале действий](../azure-resource-manager/resource-group-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json#activity-logs), [контроле доступа (IAM)](../azure-resource-manager/resource-group-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json#access-control), [тегах](../azure-resource-manager/resource-group-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json#tags), [блокировках](../azure-resource-manager/resource-group-lock-resources.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [скрипте службы автоматизации](../azure-resource-manager/resource-manager-export-template.md?toc=%2fazure%2fvirtual-network%2ftoc.json#export-the-template-from-resource-group).

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic list](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#list) для просмотра сетевых карт в подписке, [az network nic show](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#show) для просмотра параметров сетевой карты.|
|**PowerShell**|[Get-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.4.0/get-azurermnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json) для просмотра сетевых карт в подписке или параметров сетевой карты.|

### <a name="dns"></a>Изменение параметров DNS для сетевой карты

Чтобы изменить параметры DNS для сетевой карты, сделайте следующее. DHCP-сервер Azure назначает DNS-сервер виртуальной машине. Дополнительные сведения о параметрах разрешения имен для сетевой карты см. в статье [Разрешение имен для ВМ и экземпляров ролей](virtual-networks-name-resolution-for-vms-and-role-instances.md).

1. Выполните шаги 1–3 в разделе [Просмотр и изменение сетевых интерфейсов и параметров](#view-nics) этой статьи для сетевой карты, параметры которой следует изменить.
2. В колонке выбранной сетевой карты щелкните **DNS-серверы**.
3. Щелкните один из следующих параметров:
    - **Inherit from virtual network (default)** (Наследовать от виртуальной сети (по умолчанию)). Выберите этот вариант, чтобы наследовать параметры DNS-сервера, определенные для виртуальной сети, к которой подключена сетевая карта. На уровне виртуальной сети определяется пользовательский DNS-сервер или DNS-сервер, предоставленный Azure. Последний может разрешать имена ресурсов, подключенных к одной и той же виртуальной сети. Это не действует для ресурсов, подключенных к разным виртуальным сетям.
    - **Custom** (Пользовательские). Вы можете настроить собственный DNS-сервер для разрешения имен в нескольких виртуальных сетях. Введите IP-адрес сервера, который будет использоваться в качестве DNS-сервера. Этот адрес назначается только этой сетевой карте и переопределяет все параметры DNS для виртуальной сети, к которой подключена сетевая карта.
4. Щелкните **Сохранить**.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic update](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#update)|
|**PowerShell**|[Set-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.4.0/set-azurermnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json)|

### <a name="ip-forwarding"></a>Изменение IP-пересылки для сетевой карты

Благодаря IP-пересылке виртуальная машина, к которой подключена сетевая карта, может делать следующее:
- Получать сетевой трафик, не предназначенный для одного из IP-адресов, назначенных какой-либо IP-конфигурации, которая назначена сетевой карте.
- Отправлять сетевой трафик с исходным IP-адресом, который отличается от одного из присвоенных IP-конфигурации.

Параметры следует включить для каждой сетевой карты, подключенной к виртуальной машине, получающей трафик, который следует перенаправлять. Виртуальная машина может пересылать трафик независимо от числа сетевых карт, подключенных к ней. Хотя IP-пересылка и является параметром Azure, на виртуальной машине также должно выполняться приложение с такой возможностью, например брандмауэр, приложения для оптимизации глобальной сети и балансировки нагрузки. Если на виртуальной машине выполняются сетевые приложения, ее часто называют виртуальным сетевым устройством (NVA). Список готовых к развертыванию виртуальных сетевых устройств см. в [Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/category/networking?page=1&subcategories=appliances). IP-пересылка обычно используется в определяемых пользователем маршрутах. Дополнительные сведения об определяемых пользователем маршрутах см. в [этой статье](virtual-networks-udr-overview.md).

Чтобы изменить параметры IP-пересылки для сетевой карты, сделайте следующее.

1. Выполните шаги 1–3 в разделе [Просмотр и изменение сетевых интерфейсов и параметров](#view-nics) этой статьи для сетевой карты, которую следует изменить.
2. В колонке выбранной сетевой карты щелкните "Конфигурации IP".
3. Щелкните **Включено** или **Отключено** (параметр по умолчанию), чтобы изменить параметр.
4. Щелкните **Сохранить**.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic update](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#update)|
|**PowerShell**|[Set-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.4.0/set-azurermnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json)|

### <a name="subnet"></a>Изменение подсети, к которой подключена сетевая карта

Вы можете изменить подсеть, к которой подключена сетевая карта, но не виртуальную сеть. Чтобы изменить подсети, всем IP-конфигурациям, связанным с сетевой картой, следует назначить динамические частные IP-адреса. Чтобы изменить подсеть, к которой подключена сетевая карта, сделайте следующее:

1. Выполните шаги 1–3 в разделе [Просмотр и изменение сетевых интерфейсов и параметров](#view-nics) этой статьи для сетевой карты, которую следует подключить к другой подсети.
2. В колонке выбранной сетевой карты щелкните **Конфигурации IP**. Если любые из представленных частных IP-адресов любой IP-конфигурации назначены статическим способом, измените этот способ на динамический, сделав следующее. Если адреса назначаются динамическим способом, перейдите к шагу 3:
    - В списке IP-конфигураций щелкните статический IP-адрес IP-конфигурации, который требуется изменить.
    - В появившейся колонке IP-конфигурации щелкните значение **Динамический** в качестве способа **назначения**.
    - Щелкните **Сохранить**.
3. В раскрывающемся списке **Подсеть** выберите подсеть, к которой нужно подключить сетевую карту.
4. Щелкните **Сохранить**. Новые динамические адреса назначаются из диапазона адресов подсети сети. Затем при необходимости можно назначить статические IP-адреса из диапазона адресов новой подсети.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic ip-config update](/cli/azure/network/nic/ip-config?toc=%2fazure%2fvirtual-network%2ftoc.json#update)|
|**PowerShell**|[Set-AzureRmNetworkInterfaceIpConfig](/powershell/resourcemanager/azurerm.network/v3.4.0/set-azurermnetworkinterfaceipconfig?toc=%2fazure%2fvirtual-network%2ftoc.json)|


### <a name="delete-nic"></a>Удаление сетевого интерфейса

Вы можете удалить сетевую карту, если она не подключена к виртуальной машине. В противном случае перед удалением сначала следует отключить ее от виртуальной машины. Чтобы отключить сетевую карту от виртуальной машины, выполните действия, описанные в разделе [Отключение сетевой карты от виртуальной машины](#vm-detach-nic) этой статьи.

1. Выполните шаги 1–2 в разделе [Просмотр и изменение сетевых интерфейсов и параметров](#view-nics) этой статьи для сетевой карты, которую следует удалить.
2. Щелкните правой кнопкой мыши сетевую карту, которую нужно удалить, и выберите пункт **Удалить**.
3. Нажмите кнопку **Да**, чтобы подтвердить удаление сетевой карты.

При удалении сетевой карты MAC- или IP-адреса, назначенные ей, освобождаются.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic delete](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#delete)|
|**PowerShell**|[Remove-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.1.0/remove-azurermnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="ip-configs"></a>IP-конфигурации
Каждой сетевой карте назначена по крайней мере одна IP-конфигурация, которая называется **основной**. С сетевой картой также может быть связана одна или несколько *дополнительных* IP-конфигураций. Число IP-адресов, которые можно назначить сетевой карте, ограничено. Дополнительные сведения см. в статье об [ограничениях в Azure](../azure-subscription-service-limits.md?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits). Каждой IP-конфигурации назначаются следующие ресурсы:
- Частный IP-адрес с применением статического или динамического назначения. Динамические IP-адреса могут измениться, если запустить виртуальную машину после того, как она была остановлена (освобождена). Статические IP-адреса сетевой карты освобождаются только при ее удалении.
- Один общедоступный IP-адрес.

DHCP-сервер Azure назначает частный IP-адрес для основной IP-конфигурации сетевой карте в операционной системе виртуальной машины.

Назначение нескольких IP-адресов сетевой карте полезно в следующих сценариях:
- Возможность размещать на одном сервере несколько веб-сайтов или служб с разными IP-адресами и SSL-сертификатами.
- Возможность использовать виртуальную машину в качестве виртуального сетевого устройства, такого как брандмауэр или балансировщик нагрузки.
- Возможность добавления любых частных IP-адресов любых сетевых карт во внутренний пул Azure Load Balancer. Раньше во внутренний пул можно было добавить только основной IP-адрес для основной сетевой карты. Дополнительные сведения о балансировке нагрузки в конфигурациях с несколькими IP-адресами см. в [этой статье](../load-balancer/load-balancer-multiple-ip.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

Число общедоступных IP-адресов, которые можно использовать в пределах подписки, ограничено, как и число частных IP-адресов, которые можно назначить сетевой карте. Сведения об ограничениях см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits).

### <a name="create-ip-config"></a>Добавление дополнительной IP-конфигурации к сетевой карте

Вы можете добавить требуемое количество IP-конфигураций к сетевой карте в пределах, сведения о которых указаны в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits). Чтобы добавить IP-конфигурацию к сетевой карте, сделайте следующее:

1. Выполните шаги 1–3 в разделе [Просмотр параметров сетевых интерфейсов](#view-nics) этой статьи для сетевой карты, к которой следует добавить IP-конфигурацию.
2. В колонке выбранной сетевой карты щелкните **Конфигурации IP**.
3. В появившейся колонке IP-конфигураций щелкните **+ Add** (+ Добавить).
4. Укажите следующие сведения и нажмите кнопку **ОК**, чтобы закрыть колонку **Добавить IP-конфигурацию**.

    |**Параметр**|**Обязательный?**|**Дополнительные сведения**|
    |---|---|---|
    |**Имя**|Да|Должно быть уникальным для сетевой карты.|
    |**Тип**|Да|Так как вы добавляете IP-конфигурацию к существующей сетевой карте и каждая сетевая карта должна иметь основную IP-конфигурацию, единственным вариантом является **Вторичный**.|
    |**Private IP address assignment method** (Способ назначения общедоступных IP-адресов)|Да|**Динамический** адрес меняется, если до перезапуска виртуальная машина была остановлена (освобождена). **Статические** адреса не освобождаются, пока не будет удалена сетевая карта. Укажите IP-адрес из диапазона адресного пространства подсети, который сейчас не используется другой IP-конфигурацией.|
    |**Общедоступный IP-адрес**|Нет|**Отключено.** Сейчас с IP-конфигурацией не связан ресурс общедоступного IP-адреса. **Включено.** Выберите существующий общедоступный IP-адрес или создайте его. Дополнительные сведения о создании общедоступного IP-адреса см. в [этом разделе](virtual-network-public-ip-address.md#create).|
5. Добавьте дополнительный частный IP-адрес для операционной системы виртуальной машины вручную, выполнив инструкции в статье [Назначение виртуальным машинам нескольких IP-адресов с помощью портала Azure](virtual-network-multiple-ip-addresses-portal.md#os-config). Не добавляйте в операционную систему общедоступные IP-адреса.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic ip-config create](/cli/azure/network/nic/ip-config?toc=%2fazure%2fvirtual-network%2ftoc.json#create)|
|**PowerShell**|[Add-AzureRmNetworkInterfaceIpConfig](/powershell/resourcemanager/azurerm.network/v3.4.0/add-azurermnetworkinterfaceipconfig?toc=%2fazure%2fvirtual-network%2ftoc.json)|

### <a name="change-ip-config"></a>Изменение IP-конфигурации

Чтобы изменить параметры частного и общедоступного IP-адреса для любой основной или дополнительной IP-конфигурации, сделайте следующее:

1. Выполните шаги 1–3 в разделе [Просмотр параметров сетевых интерфейсов](#view-nics) этой статьи для сетевой карты, которую следует изменить.
2. В колонке выбранной сетевой карты щелкните **Конфигурации IP**.
3. В появившейся колонке IP-конфигурации в списке щелкните IP-конфигурацию, которую следует изменить.
4. Измените параметры требуемым образом, используя сведения о параметрах в разделе [Добавление IP-конфигурации](#create-ip-config) этой статьи, и нажмите кнопку **Сохранить**, чтобы закрыть колонку выбранной IP-конфигурации.

>[!NOTE]
>Если изменить частный IP-адрес основной IP-конфигурации в основной сетевой карте, которой назначено несколько IP-конфигураций, необходимо вручную переназначить все дополнительные IP-адреса сетевой карте в Windows (не требуется в Linux). Чтобы назначать IP-адрес сетевой карте в операционной системе вручную, см. статью [Назначение виртуальным машинам нескольких IP-адресов с помощью портала Azure](virtual-network-multiple-ip-addresses-portal.md#os-config). Не добавляйте в операционную систему общедоступные IP-адреса.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic ip-config update](/cli/azure/network/nic/ip-config?toc=%2fazure%2fvirtual-network%2ftoc.json#update)|
|**PowerShell**|[Set-AzureRMNetworkInterfaceIpConfig](/powershell/resourcemanager/azurerm.network/v3.4.0/set-azurermnetworkinterfaceipconfig?toc=%2fazure%2fvirtual-network%2ftoc.json)|

### <a name="delete-ip-config"></a>Удаление дополнительной IP-конфигурации из сетевой карты

Чтобы удалить дополнительную IP-конфигурацию из сетевой карты, сделайте следующее:

1. Выполните шаги 1–3 в разделе [Просмотр параметров сетевых интерфейсов](#view-nics) этой статьи для сетевой карты, которую следует изменить.
2. В колонке выбранной сетевой карты щелкните **Конфигурации IP**.
3. Щелкните правой кнопкой мыши IP-конфигурацию, которую нужно удалить, и выберите пункт **Удалить**. Если с IP-конфигурацией был связан общедоступный IP-адрес, его связь с ней отменяется, но сам IP-адрес не удаляется.
4. Закройте колонку **Конфигурации IP**.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic ip-config delete](/cli/azure/network/nic/ip-config?toc=%2fazure%2fvirtual-network%2ftoc.json#delete)|
|**PowerShell**|[Remove-AzureRmNetworkInterfaceIpConfig](/powershell/resourcemanager/azurerm.network/v3.4.0/remove-azurermnetworkinterfaceipconfig?toc=%2fazure%2fvirtual-network%2ftoc.json)|


## <a name="nsgs"></a>Группы безопасности сети
Группа безопасности сети содержит перечень правил исходящего и входящего трафика, которые разрешают или запрещают сетевой трафик к сетевым картам. Чтобы связать группу безопасности сети, не требуется сетевая карта и подсеть, к которой она подключена. Однако ее можно связать с сетевой картой, с подсетью, к которой она подключена, или и с тем, и с другим. Как правило, группы безопасности сети, которые применяются ко всем сетевым картам, подключенным к подсети, связаны с подсетями. К отдельным сетевым картам можно применять группы безопасности сети с более строгими правилами. Дополнительные сведения о группах безопасности сети см. в [этой статье](virtual-networks-nsg.md).

### <a name="associate-nsg"></a>Связывание группы безопасности сети с сетевым интерфейсом и отмена связи между ними

Чтобы связать группы безопасности сети с сетевой картой или отменить такую связь, сделайте следующее:

1. Выполните шаги 1–3 в разделе [Просмотр и изменение сетевых интерфейсов и параметров](#view-nics) этой статьи для сетевой карты, которую следует связать с группой безопасности сети или для которой следует отменить такую связь.
2. В колонке выбранной сетевой карты щелкните **Группа безопасности сети**. Появится колонка, в верхней части которой находится элемент **Изменить**. Если сейчас с сетевой картой не связаны группы безопасности сети, для параметра **Группа безопасности сети** отображается значение *Нет*. В противном случае для параметра **Группа безопасности сети** отображается значение *NSG-Name* (где NSG-Name — это имя группы безопасности сети, связанной с сетевой картой).
3. Нажмите кнопку **Изменить**.
4. Щелкните **Группа безопасности сети**. Если в списке нет групп безопасности сети, это означает, что их нет в подписке. Чтобы создать группу безопасности сети, выполните действия, описанные в [этой статье](virtual-networks-create-nsg-arm-pportal.md).
5. В появившейся колонке **Выбрать группу безопасности сети** щелкните существующую группу безопасности сети в списке, чтобы связать ее с сетевой картой, или щелкните **Нет**, чтобы отменить связь между группой безопасности сети и сетевой картой.
6. Щелкните **Сохранить**.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az network nic update](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#update)|
|**PowerShell**|[Set-AzureRmNetworkInterface](/powershell/resourcemanager/azurerm.network/v3.4.0/set-azurermnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="vms"></a>Подключение и отключение сетевых карт в виртуальной машине

Существующую сетевую карту можно подключить к виртуальной машине при ее создании. Кроме того, ее можно подключить к уже созданной виртуальной машине. Помимо этого можно отключить сетевую карту от существующей виртуальной машины, к которой подключено по крайней мере две сетевых карты. Хотя портал и создает сетевую карту при создании виртуальной машины, он не позволяет делать следующее:

- Указать существующую сетевую карту для подключения при создании виртуальной машины.
- Создать виртуальную машину, к которой подключено несколько сетевых карт.
- Указать имя сетевой карты (портал создает ее с именем по умолчанию).
- Указать статический способ назначения частных IP-адресов. Портал автоматически назначает динамический частный IP-адрес. Способ назначения можно изменить после создания сетевой карты на портале.

Чтобы создать сетевую карту или виртуальную машину с атрибутами, указанными выше, для которых нельзя использовать портал, можно применить PowerShell или интерфейс командной строки. Прежде чем приступить к выполнению задач в следующих разделах, обратите внимание на следующие ограничения и поведение.

- Виртуальные машины разных размеров поддерживают разное количество сетевых карт. Дополнительные сведения об определении числа сетевых карт, поддерживаемых каждым из размеров виртуальной машины, см. в статьях [Размеры виртуальных машин Linux в Azure](../virtual-machines/virtual-machines-linux-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Размеры виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). 
- По умолчанию первая сетевая карта, подключенная к виртуальной машине, определяется в качестве *основной*. Все остальные сетевые карты, подключенные к виртуальной машине, считаются *дополнительными*.
- По умолчанию весь исходящий трафик виртуальной машины отправляется с IP-адреса, назначенного основной IP-конфигурации основной сетевой карты. Вы, конечно же, можете контролировать IP-адрес, используемый для отправки исходящего трафика в операционной системе виртуальной машины.
- В прошлом все виртуальные машины в одной группе доступности должны были иметь одну или несколько сетевых карт. Теперь в одной группе доступности могут находиться виртуальные машины с любым количеством сетевых карт. Виртуальную машину можно добавить в группу доступности только при ее создании. Дополнительные сведения о группах доступности см. в статье [Управление доступностью виртуальных машин Windows в Azure](../virtual-machines/virtual-machines-windows-manage-availability.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-multiple-virtual-machines-in-an-availability-set-for-redundancy).
- Хотя сетевые карты, подключенные к одной виртуальной машине, можно подключить к разным подсетям в виртуальной сети, все они должны быть подключены к одной виртуальной сети.
- Вы можете добавить любой IP-адрес для любой IP-конфигурации любой основной или дополнительной сетевой карты во внутренний балансировщик нагрузки Azure. Раньше во внутренний пул можно было добавить только основной IP-адрес для основной сетевой карты.
- При удалении виртуальной машины подключенные к ней сетевые карты не удаляются. Когда виртуальная машина удаляется, сетевые карты отключаются от нее. Вы можете подключить эти сетевые карты к другим виртуальным машинам или удалить их.

### <a name="vm-create"></a>Подключение одной или нескольких сетевых карт при создании виртуальной машины

Невозможно подключить существующие сетевые карты к новой виртуальной машине или создать виртуальную машину с несколькими сетевыми картами на портале Azure. Чтобы подключить одну или несколько существующих сетевых карт при создании виртуальной машины, можно использовать следующие команды Azure CLI или PowerShell:

- **Интерфейс командной строки:** [az vm create](/cli/azure/vm?toc=%2fazure%2fvirtual-network%2ftoc.json#create).
- **PowerShell:** [New-AzureRmVM](/powershell/resourcemanager/azurerm.compute/v2.5.0/new-azurermvm?toc=%2fazure%2fvirtual-network%2ftoc.json).

### <a name="vm-view-nic"></a>Просмотр сетевых карт, подключенных к виртуальной машине

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетной записи, которой назначены роли "Владелец", "Участник" или "Участник сети" для подписки. Сведения о назначении ролей учетным записям см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).
2. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *виртуальные машины*. Когда **виртуальные машины** появятся в результатах поиска, щелкните их.
3. В появившейся колонке **Виртуальные машины** щелкните имя виртуальной машины, для которой следует просмотреть подключенные сетевые интерфейсы.
4. В колонке **Виртуальная машина**, которая отобразилась для выбранной виртуальной машины, щелкните **Сетевые интерфейсы**.

|**Средство**|**Команда**|
|---|---|
|**ИНТЕРФЕЙС КОМАНДНОЙ СТРОКИ**|[az vm show](/cli/azure/vm?toc=%2fazure%2fvirtual-network%2ftoc.json#show)|
|**PowerShell**|[Get-AzureRmVM](/powershell/resourcemanager/azurerm.compute/v1.3.4/get-azurermvm?toc=%2fazure%2fvirtual-network%2ftoc.json)|

### <a name="vm-attach-nic"></a>Подключение сетевой карты к существующей виртуальной машине

Виртуальная машина, к которой нужно подключить сетевую карту, должна поддерживать использование нескольких сетевых карт и должна быть остановлена (освобождена). Невозможно подключить сетевые карты к существующей виртуальной машине с помощью портала Azure. Для подключения сетевых карт к виртуальным машинам можно использовать следующие команды Azure CLI или PowerShell:

- **Интерфейс командной строки:** [az vm nic add](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#add).
- **PowerShell:** [Add-AzureRmVMNetworkInterface](/powershell/resourcemanager/azurerm.compute/v2.5.0/add-azurermvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json).

### <a name="vm-detach-nic"></a>Отключение сетевой карты от существующей виртуальной машины

Виртуальная машина, от которой следует отключить сетевую карту, должна быть остановлена (освобождена) и к ней должны быть подключены по крайней мере две сетевые карты. Вы можете отключить любую сетевую карту, но к виртуальной машине всегда должна быть подключена по крайней мере одна сетевая карта. При отключении основной сетевой карты Azure назначает основной атрибут остальным присоединенным сетевым картам, которые были подключены к виртуальной машине дольше всего. Кроме того, любую сетевую карту можно указать в качестве основной. Невозможно отключить сетевые карты от виртуальной машины или задать основной атрибут сетевой карте с помощью портала Azure, хотя все это можно сделать с помощью интерфейса командной строки или PowerShell. Для отключения сетевых карт от виртуальных машин можно использовать следующие команды Azure CLI или PowerShell:

- **Интерфейс командной строки:** [az vm nic remove](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#remove).
- **PowerShell:** [Remove-AzureRMVMNetworkInterface](/powershell/resourcemanager/azurerm.compute/v2.5.0/remove-azurermvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json).

## <a name="next-steps"></a>Дальнейшие действия
Чтобы создать виртуальную машину с несколькими сетевыми картами или IP-конфигурациями с помощью скриптов, см. следующие статьи:

|**Задача.**|**Средство**|
|---|---|
|**Создание виртуальной машины с несколькими сетевыми адаптерами**|[Интерфейс командной строки](virtual-network-deploy-multinic-arm-cli.md) и [PowerShell](virtual-network-deploy-multinic-arm-ps.md)|
|**Создание виртуальной машины с одной сетевой картой, которой назначено несколько IP-адресов**|[Интерфейс командной строки](virtual-network-multiple-ip-addresses-cli.md) и [PowerShell](virtual-network-multiple-ip-addresses-powershell.md)|

