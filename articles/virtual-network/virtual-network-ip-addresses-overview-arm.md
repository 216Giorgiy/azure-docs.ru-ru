---
title: "Типы IP-адресов в Azure | Документация Майкрософт"
description: "Сведения об использовании частных и общедоступных IP-адресов в Azure."
services: virtual-network
documentationcenter: na
author: jimdial
manager: jeconnoc
editor: 
tags: azure-resource-manager
ms.assetid: 610b911c-f358-4cfe-ad82-8b61b87c3b7e
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/18/2017
ms.author: jdial
ms.openlocfilehash: 95f2b57b2012df816c76a1b6ec55ca9f92e134a3
ms.sourcegitcommit: afc78e4fdef08e4ef75e3456fdfe3709d3c3680b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2017
---
# <a name="ip-address-types-and-allocation-methods-in-azure"></a>Типы IP-адресов и методы распределения в Azure

Вы можете назначать IP-адреса ресурсам Azure, чтобы они могли взаимодействовать с другими ресурсами Azure, а также подключаться к вашей локальной сети и Интернету. В Azure можно использовать два типа IP-адресов.

* **Общедоступные IP-адреса** используются для доступа в Интернет, включая общедоступные службы Azure.
* **Частные IP-адреса**используются для обмена данными в виртуальной сети Azure (VNet) или в локальной сети (если для расширения сети до масштабов Azure используется VPN-шлюз или канал ExpressRoute).

> [!NOTE]
> В Azure предлагаются две модели развертывания для создания ресурсов и работы с ними: [модель Resource Manager и классическая модель](../azure-resource-manager/resource-manager-deployment-model.md?toc=%2fazure%2fvirtual-network%2ftoc.json).  В этой статье описывается использование модели развертывания c помощью Resource Manager. Для большинства новых развертываний мы рекомендуем использовать эту модель вместо [классической](virtual-network-ip-addresses-overview-classic.md).
> 

Если вы знакомы с классической моделью развертывания, ознакомьтесь с [различиями в IP-адресации для классической модели развертывания и модели Resource Manager](virtual-network-ip-addresses-overview-classic.md#differences-between-resource-manager-and-classic-deployments).

## <a name="public-ip-addresses"></a>Общедоступные IP-адреса

Общедоступные IP-адреса позволяют ресурсам Azure подключаться к Интернету и другим общедоступным службам Azure, таким как [кэш Redis для Azure](https://azure.microsoft.com/services/cache), [концентраторы событий Azure](https://azure.microsoft.com/services/event-hubs), [базы данных SQL](../sql-database/sql-database-technical-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [служба хранилища Azure](../storage/common/storage-introduction.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

В диспетчере ресурсов Azure [общедоступный IP-адрес](virtual-network-public-ip-address.md) — это ресурс, который имеет собственные свойства. Ресурс общедоступного IP-адреса можно связать с одним из таких ресурсов:

* Сетевые интерфейсы виртуальных машин
* Балансировщики нагрузки, доступные в Интернете
* VPN-шлюзы
* Шлюзы приложений

### <a name="ip-address-version"></a>Версия IP-адреса

Общедоступные IP-адреса создаются с адресами IPv4 или IPv6. Общедоступные IP-адреса IPv6 можно назначить только подсистемам балансировки нагрузки, доступным в Интернете.

### <a name="sku"></a>SKU

Общедоступные IP-адреса создаются с использованием одного из следующих номеров SKU:

#### <a name="basic"></a>Basic

До появления номеров SKU все общедоступные IP-адреса имеют номер SKU категории "Базовый". С появлением номеров SKU вы можете выбрать номер SKU для общедоступного IP-адреса. Адреса с номерами SKU "Базовый":

- Назначаются с помощью статического или динамического выделения.
- Назначаются любому ресурсу Azure, которому может быть присвоен общедоступный IP-адрес, например сетевым интерфейсам, VPN-шлюзам, шлюзам приложений и подсистемам балансировки нагрузки, доступным в Интернете.
- Эти адреса можно назначать определенной зоне.
- Не могут быть избыточными в пределах зоны. См. дополнительные сведения о [зонах доступности](../availability-zones/az-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

#### <a name="standard"></a>Standard

Общедоступные IP-адреса с номерами SKU "Стандартный":

- Назначаются только с помощью статического выделения.
- Назначаются сетевым интерфейсам или подсистемам балансировки нагрузки категории "Стандартный", доступным в Интернете. См. дополнительные сведения см. о [подсистеме балансировки нагрузки Azure с номером SKU "Стандартный"](../load-balancer/load-balancer-standard-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json).
- По умолчанию являются избыточными в пределах зоны. Могут создаваться как зональные IP-адреса и гарантироваться в определенной зоне доступности.  См. дополнительные сведения о [зонах доступности](../availability-zones/az-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json).
 
> [!NOTE]
> Если вы назначаете общедоступный IP-адрес с номером SKU "Стандартный" сетевому интерфейсу виртуальной машины, необходимо явно разрешить предполагаемый трафик в [группе безопасности сети](security-overview.md#network-security-groups).  Обмен данными с ресурсом будет невозможен, пока вы не создадите группу безопасности сети, не свяжете ее с ресурсом и не разрешите соответствующий трафик.

Номер SKU "Стандартный" используется в режиме предварительной версии. Прежде чем создавать общедоступные IP-адреса с номером SKU "Стандартный", сначала зарегистрируйтесь для использования предварительной версии и создайте адрес в поддерживаемом расположении. См. инструкции по [регистрации для использования предварительной версии номера SKU](virtual-network-public-ip-address.md#register-for-the-standard-sku-preview). См. список [поддерживаемых расположений (регионов)](../load-balancer/load-balancer-standard-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json#region-availability). Также проверяйте страницу [обновлений виртуальной сети Azure](https://azure.microsoft.com/updates/?product=virtual-network) на наличие дополнительных регионов.


### <a name="allocation-method"></a>Способ выделения

IP-адрес можно выделить ресурсу с общедоступным IP-адресом двумя способами: *динамически* и *статически*. По умолчанию используется *динамический* способ выделения, в рамках которого IP-адрес выделяется **не** тогда, когда он создается, а тогда, когда вы запускаете (или создаете) связанный ресурс (например, виртуальную машину или балансировщик нагрузки). Если остановить или удалить ресурс, IP-адрес освобождается. Например, когда IP-адрес освобождается из ресурса A, его можно назначить другому ресурсу. Если IP-адрес назначен другому ресурсу, пока ресурс A остановлен, перезапущенному ресурсу A будет назначен другой IP-адрес.

Чтобы IP-адрес связанного ресурса не изменялся, вы можете явным образом задать *статический* способ выделения. Статический IP-адрес назначается немедленно. Адрес освобождается, только если вы удалили ресурс или изменили способ выделения адреса на *динамический*.

> [!NOTE]
> Даже если выбран *статический* способ выделения, нельзя указать фактический IP-адрес, назначенный ресурсу с общедоступным IP-адресом. Azure назначает IP-адрес из пула доступных IP-адресов в расположении Azure, в котором создан ресурс.
>

Статические общедоступные IP-адреса обычно используются в таких случаях:

* Если необходимо обновить правила брандмауэра для обмена данными с ресурсами Azure.
* разрешение DNS-имени, в рамках которого изменение IP-адреса влечет за собой необходимость обновить записи A;
* ваши ресурсы Azure взаимодействуют с другими веб-приложениями или службами, которые используют модель безопасности, основанную на IP-адресах;
* вы используете SSL-сертификаты, связанные с IP-адресом.

> [!NOTE]
> Azure выделяет общедоступные IP-адреса из уникального для каждого региона Azure диапазона. См. дополнительные сведения о [диапазонах IP-адресов центра обработки данных Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=41653).
>

### <a name="dns-hostname-resolution"></a>Разрешение DNS-имен узлов
Вы можете указать DNS-имя домена для ресурса с общедоступным IP-адресом. В результате этого будут сопоставлены адрес *метка_домена*.*расположение*.cloudapp.azure.com и общедоступный IP-адрес на DNS-серверах под управлением Azure. Например, если создать ресурс с общедоступным IP-адресом и задать значение **contoso** в качестве *метки домена* в *расположении* Azure **Западная часть США**, полное доменное имя **contoso.westus.cloudapp.azure.com** разрешается в общедоступный IP-адрес ресурса. С помощью полного доменного имени вы можете создать запись CNAME личного домена, указывающую на общедоступный IP-адрес в Azure.

> [!IMPORTANT]
> Каждая созданная метка имени домена должна быть уникальной в пределах своего расположения в Azure.  
>

### <a name="virtual-machines"></a>Виртуальные машины

Чтобы связать общедоступный IP-адрес с виртуальной машиной [Windows](../virtual-machines/windows/overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [Linux](../virtual-machines/linux/overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json), назначьте этот адрес ее **сетевому интерфейсу**. Виртуальной машине можно назначить динамический или статический общедоступный IP-адрес. См. дополнительные сведения о [назначении IP-адресов сетевым интерфейсам](virtual-network-network-interface-addresses.md).

### <a name="internet-facing-load-balancers"></a>Балансировщики нагрузки, доступные в Интернете

Чтобы связать общедоступный IP-адрес, созданный с любым [номером SKU](#SKU), с [Azure Load Balancer](../load-balancer/load-balancer-overview.md), назначьте этот адрес для **интерфейсной** конфигурации подсистемы балансировки нагрузки. Общедоступный IP-адрес будет выполнять функцию виртуального IP-адреса с балансировкой нагрузки. Интерфейсной конфигурации подсистемы балансировки нагрузки можно назначить динамический или статический общедоступный IP-адрес. Кроме того, этой конфигурации можно назначить несколько общедоступных IP-адресов. Так вы сможете создавать сценарии с [несколькими виртуальными IP-адресами](../load-balancer/load-balancer-multivip-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) (например, среду с несколькими клиентами и веб-сайтами на основе SSL). См. дополнительные сведения см. о [подсистеме балансировки нагрузки Azure с номером SKU "Стандартный"](../load-balancer/load-balancer-standard-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

### <a name="vpn-gateways"></a>VPN-шлюзы

[VPN-шлюз Azure](../vpn-gateway/vpn-gateway-about-vpngateways.md?toc=%2fazure%2fvirtual-network%2ftoc.json) соединяет виртуальную сеть Azure с другими виртуальными сетями Azure или локальной сетью. Общедоступный IP-адрес назначается VPN-шлюзу для обмена данными с удаленной сетью. VPN-шлюзу можно назначить только *динамический* общедоступный IP-адрес.

### <a name="application-gateways"></a>Шлюзы приложений

Чтобы связать общедоступный IP-адрес со [шлюзом приложений](../application-gateway/application-gateway-introduction.md?toc=%2fazure%2fvirtual-network%2ftoc.json)Azure, назначьте этот адрес конфигурации **внешнего интерфейса** шлюза. Этот общедоступный IP-адрес будет выполнять функцию виртуального IP-адреса с балансировкой нагрузки. Интерфейсной конфигурации шлюза приложений можно назначить только *динамический* общедоступный IP-адрес.

### <a name="at-a-glance"></a>Краткий обзор
В следующей таблице показано, через какое свойство можно связать общедоступный IP-адрес с ресурсом верхнего уровня и какой способ распределения (динамический или статический) можно использовать.

| Ресурс верхнего уровня | Связанный IP-адрес | динамический | Статическое |
| --- | --- | --- | --- |
| Виртуальная машина. |сетевому интерфейсу |Да |Да |
| Подсистема балансировки нагрузки, доступная в Интернете |Интерфейсная конфигурация |Да |Да |
| VPN-шлюз |Конфигурация IP шлюза |Да |Нет |
| шлюзом приложений |Конфигурация клиентской части |Да |Нет |

## <a name="private-ip-addresses"></a>Частные IP-адреса
С помощью частных IP-адресов ресурсы Azure взаимодействуют с другими ресурсами в [виртуальной сети](virtual-networks-overview.md) либо в локальной сети через VPN-шлюз или канал ExpressRoute, и для этого не нужен IP-адрес, доступный через Интернет.

В модели развертывания Azure Resource Manager частный IP-адрес связан со следующими ресурсами Azure:

* Сетевые интерфейсы виртуальных машин
* Внутренние балансировщики нагрузки
* Шлюзы приложений

### <a name="ip-address-version"></a>Версия IP-адреса

Частные IP-адреса создаются с адресами IPv4 или IPv6. Частные IPv6-адреса можно назначать только с помощью динамического выделения. Частные IPv6-адреса не могут обмениваться данными между собой в виртуальной сети. Частный IPv6-адрес может принимать входящий трафик из Интернета с помощью подсистемы балансировки нагрузки, доступной в Интернете. См. дополнительные о [создании подсистемы балансировки нагрузки, доступной в Интернете, с IPv6-адресом](../load-balancer/load-balancer-ipv6-internet-ps.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

### <a name="allocation-method"></a>Способ выделения

Частный IP-адрес выделяется из диапазона адресов подсети виртуальной сети, в которой развернут ресурс. Существует два способа выделения IP-адресов:

- **Динамический.** Azure резервирует первые четыре адреса в каждом диапазоне адресов подсети и не назначает эти адреса. Azure присваивает ресурсу следующий свободный адрес из диапазона адресов подсети. Например, если подсеть имеет диапазон адресов 10.0.0.0/16, а адреса 10.0.0.0.4–10.0.0.14 уже назначены (адреса .0–.3 зарезервированы), Azure назначает следующему ресурсу адрес 10.0.0.15. По умолчанию используется динамический способ выделения. Назначенные динамические IP-адреса освобождаются, только если сетевой интерфейс удаляется или переносится в другую подсеть в той же виртуальной сети, а также если метод распределения изменяется на статический с указанием другого IP-адреса. Когда метод распределения изменяется с динамического на статической, Azure по умолчанию назначает в качестве статического адреса тот же адрес, который был до этого момента назначен динамически.
- **Статический.** Вы выбираете и назначаете адрес из диапазона адресов подсети. Вы можете назначить любой адрес из диапазона адресов подсети, кроме первых четырех адресов из этого диапазона и тех адресов, которые уже назначены другим ресурсам в этой подсети. Статические адреса не освобождаются, пока сетевой интерфейс не будет удален. Если вы измените метод распределения на статический, Azure динамически назначит сетевому интерфейсу тот же IP-адрес, который ранее был назначен ему как динамический адрес, даже если это не следующий свободный адрес в диапазоне адресов подсети. Также адрес изменится, если назначить сетевой интерфейс другой подсети в пределах той же виртуальной сети. Если же вы хотите назначить сетевой интерфейс другой подсети, сначала необходимо изменить метод распределения со статического на динамический. Назначив сетевой интерфейс другой подсети, вы сможете снова изменить способ распределения на статический и назначить IP-адрес, но уже из диапазона адресов новой подсети.

### <a name="virtual-machines"></a>Виртуальные машины

Один или несколько IP-адресов назначаются одному или нескольким **сетевым интерфейсам** виртуальной машины [Windows](../virtual-machines/windows/overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [Linux](../virtual-machines/linux/overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Можно указать метод выделения для каждого частного IP-адреса: динамический или статический.

#### <a name="internal-dns-hostname-resolution-for-virtual-machines"></a>Разрешение внутренних DNS-имен узла (для виртуальных машин)

По умолчанию все виртуальные машины Azure связаны с [DNS-серверами под управлением Azure](virtual-networks-name-resolution-for-vms-and-role-instances.md#azure-provided-name-resolution) (кроме случаев, когда отдельно заданы пользовательские DNS-серверы). Эти DNS-серверы обеспечивают внутреннее разрешение имен для виртуальных машин, находящихся в одной виртуальной сети.

Когда вы создаете виртуальную машину, в DNS-серверы под управлением Azure добавляется сопоставление имени узла с частным IP-адресом. Если используется виртуальная машина с несколькими сетевыми интерфейсами или несколькими IP-конфигурациями для сетевого интерфейса, имя узла сопоставляется с частным IP-адресом основной IP-конфигурации основного сетевого интерфейса.

Виртуальные машины, связанные с DNS-серверами под управлением Azure, могут сопоставлять имена узлов всех виртуальных машин виртуальной сети с их частными IP-адресами. Для разрешения имен узлов виртуальных машин в подключенных виртуальных сетях необходимо использовать пользовательский DNS-сервер.

### <a name="internal-load-balancers-ilb--application-gateways"></a>Внутренние балансировщики нагрузки и шлюзы приложений

Вы можете назначить частный IP-адрес конфигурации **внешнего интерфейса** [внутреннего балансировщика нагрузки Azure](../load-balancer/load-balancer-internal-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [шлюза приложений Azure](../application-gateway/application-gateway-introduction.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Этот IP-адрес является внутренней конечной точкой, доступной только для ресурсов виртуальной сети и подключенных к ней удаленных сетей. Интерфейсной конфигурации можно назначить динамический или статический частный IP-адрес.

### <a name="at-a-glance"></a>Краткий обзор
В следующей таблице показано, через какое свойство можно связать частный IP-адрес с ресурсом верхнего уровня и какой способ распределения (динамический или статический) можно использовать.

| Ресурс верхнего уровня | Связанный IP-адрес | динамический | Статическое |
| --- | --- | --- | --- |
| Виртуальная машина. |сетевому интерфейсу |Да |Да |
| Подсистема балансировки нагрузки |Конфигурация клиентской части |Да |Да |
| шлюзом приложений |Конфигурация клиентской части |Да |Да |

## <a name="limits"></a>Ограничения
Ограничения IP-адресации указаны в полном списке [сетевых ограничений](../azure-subscription-service-limits.md?toc=%2fazure%2fvirtual-network%2ftoc.json#networking-limits) в Azure. Ограничения указаны по региону и по подписке. Для увеличения ограничений по умолчанию до максимальных ограничений в зависимости от потребностей своего бизнеса вы можете [обратиться в службу поддержки](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade) .

## <a name="pricing"></a>Цены
За общедоступные IP-адреса взимается номинальная плата. Дополнительные сведения о ценах на IP-адреса в Azure см. на [соответствующей](https://azure.microsoft.com/pricing/details/ip-addresses) странице.

## <a name="next-steps"></a>Дальнейшие действия
* [Развертывание виртуальной машины со статическим общедоступным IP-адресом с использованием портала Azure](virtual-network-deploy-static-pip-arm-portal.md)
* [Развертывание виртуальной машины со статическим общедоступным IP-адресом с помощью шаблона](virtual-network-deploy-static-pip-arm-template.md)
* [Развертывание виртуальной машины со статическим частным IP-адресом с помощью портала Azure](virtual-networks-static-private-ip-arm-pportal.md)
