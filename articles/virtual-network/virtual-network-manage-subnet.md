---
title: Создание, изменение или удаление виртуальной сети Azure | Документация Майкрософт
description: Сведения о создании, изменении и удалении виртуальной сети в Azure.
services: virtual-network
documentationcenter: na
author: jimdial
manager: jeconnoc
editor: ''
tags: azure-resource-manager
ms.assetid: ''
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/09/2018
ms.author: jdial
ms.openlocfilehash: 16ce5aac26abcf2ef2cf7664fb0b9aae600708d4
ms.sourcegitcommit: 48ab1b6526ce290316b9da4d18de00c77526a541
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2018
---
# <a name="add-change-or-delete-a-virtual-network-subnet"></a>Создание, изменение или удаление виртуальной сети

Сведения о создании, изменении и удалении подсетей виртуальной сети. Если вы не работали с виртуальными сетями, прежде чем создавать, изменять и удалять подсеть, мы рекомендуем прочитать [обзор виртуальных сетей Azure ](virtual-networks-overview.md), а также статью [Создание, изменение и удаление виртуальной сети](manage-virtual-network.md). Все ресурсы Azure, развернутые в виртуальной сети, также развертываются в подсети виртуальной сети.
 
## <a name="before-you-begin"></a>Перед началом работы

Перед выполнением действий, описанных в любом разделе этой статьи, выполните следующие задачи.

- Если у вас нет учетной записи Azure, зарегистрируйтесь для получения [бесплатной пробной учетной записи](https://azure.microsoft.com/free).
- При использовании портала перейдите по адресу https://portal.azure.com и войдите с использованием своей учетной записи Azure.
- При использовании команд PowerShell для работы с этой статьей выполняйте их в [Azure Cloud Shell](https://shell.azure.com/powershell) или в PowerShell на своем компьютере. Azure Cloud Shell — это бесплатная интерактивная оболочка, с помощью которой можно выполнять действия, описанные в этой статье. Она включает предварительно установленные общие инструменты Azure и настроена для использования с вашей учетной записью. Для работы с этим руководством требуется модуль Azure PowerShell версии не ниже 5.2.0. Выполните командлет `Get-Module -ListAvailable AzureRM`, чтобы узнать установленную версию. Если вам необходимо выполнить обновление, ознакомьтесь со статьей, посвященной [установке модуля Azure PowerShell](/powershell/azure/install-azurerm-ps). Если модуль PowerShell запущен локально, необходимо также выполнить командлет `Login-AzureRmAccount`, чтобы создать подключение к Azure.
- При использовании команд интерфейса командной строки Azure (CLI) для работы с этой статьей выполняйте их в [Azure Cloud Shell](https://shell.azure.com/bash) или в интерфейсе командной строки на своем компьютере. Для этого руководства требуется Azure CLI версии не ниже 2.0.26. Выполните командлет `az --version`, чтобы узнать установленную версию. Если вам необходимо выполнить установку или обновление, см. статью [Установка Azure CLI 2.0](/cli/azure/install-azure-cli). Если Azure CLI запущен локально, необходимо также выполнить командлет `az login`, чтобы создать подключение к Azure.

## <a name="add-a-subnet"></a>Добавление подсети

1. В поле поиска в верхней части портала введите *виртуальные сети*. Когда в результатах поиска появится пункт **Виртуальные сети**, выберите его.
2. Из списка виртуальных сетей выберите ту, которую нужно добавить к подсети.
3. В разделе **Параметры** выберите **Subnets** (Подсети).
4. Выберите **+Subnet** (+Подсеть).
5. Введите значения для следующих параметров.
    - **Имя**. Имя должно быть уникальным в пределах виртуальной сети.
    - **Диапазон адресов**. Диапазон должен быть уникальным в пределах адресного пространства виртуальной сети. Диапазон не должен перекрываться с другими диапазонами адресов подсетей в виртуальной сети. Адресное пространство должно быть указано с помощью нотации CIDR. Например, в виртуальной сети с адресным пространством 10.0.0.0/16 можно определить адресное пространство подсети 10.0.0.0/24. Наименьший допустимый диапазон — /29. Он обеспечивает восемь IP-адресов для подсети. Azure резервирует первый и последний адреса в каждой подсети для соответствия требованиям протоколов. Еще три адреса резервируются для служб Azure. Следовательно, если определить подсеть с диапазоном адресов /29, то в ней будет только три пригодных для использования IP-адреса. Если вы планируете подключать виртуальную сеть к VPN-шлюзу, необходимо создать подсеть шлюза. Узнайте больше о [рекомендациях по диапазонам адресов для подсетей шлюза](../vpn-gateway/vpn-gateway-about-vpn-gateway-settings.md?toc=%2fazure%2fvirtual-network%2ftoc.json#gwsub). При определенных условиях после создания подсети можно изменить диапазон адресов. Сведения об изменении диапазона адресов подсети см. в разделе [Изменение параметров подсети](#change-subnet-settings).
    - **Группа безопасности сети**. При необходимости вы можете связать с подсетью одну имеющуюся группу безопасности сети (или не связывать), чтобы фильтровать входящий и исходящий сетевой трафик подсети. Группа безопасности сети должна существовать в той же подписке и расположении, что и виртуальная сеть. Подробнее о [группах безопасности сети](security-overview.md) и [их создании](virtual-networks-create-nsg-arm-pportal.md).
    - **Таблица маршрутов**. С подсетью можно связать имеющуюся таблицу маршрутов (или не связывать), чтобы управлять маршрутизацией сетевого трафика в других сетях. Таблица маршрутов должна существовать в той же подписке и расположении, что и виртуальная сеть. Подробнее о [маршрутизации Azure](virtual-networks-udr-overview.md) и [создании таблиц маршрутов](tutorial-create-route-table-portal.md).
    - **Конечные точки службы**. Подсеть может иметь несколько включенных для нее конечных точек службы (или не иметь). Чтобы включить конечную точку службы, выберите одну или несколько служб, для которых необходимо включить конечные точки, из списка **Services** (Службы). Чтобы удалить конечную точку службы, снимите флажки для тех служб, для которых необходимо удалить конечную точку. Дополнительные сведения о конечных точках службы см. в статье [Конечные точки службы виртуальной сети](virtual-network-service-endpoints-overview.md). После включения конечной точки службы необходимо предоставить подсети сетевой доступ к ресурсам, созданным с помощью этой службы. Например, если включить конечную точку службы для *Microsoft.Storage*, необходимо также включить сетевой доступ для всех учетных записей хранения Azure, которым нужно предоставить доступ к сети. Дополнительные сведения о включении сетевого доступа к подсетям, доступным для конечной точки службы, см. в документации по службам, для которых включена эта конечная точка.
6. Чтобы добавить подсеть в выбранную виртуальную сеть, щелкните **ОК**.

**Команды**

- Azure CLI: [az network vnet subnet create](/cli/azure/network/vnet/subnet#az_network_vnet_subnet_create)
- PowerShell: [Add-AzureRmVirtualNetworkSubnetConfig](/powershell/module/azurerm.network/add-azurermvirtualnetworksubnetconfig)

## <a name="change-subnet-settings"></a>Изменение параметров подсети

1. В поле поиска в верхней части портала введите *виртуальные сети*. Когда в результатах поиска появится пункт **Виртуальные сети**, выберите его.
2. В списке виртуальных сетей выберите сеть, содержащую подсеть, для которой нужно изменить параметры.
3. В разделе **Параметры** выберите **Subnets** (Подсети).
4. В списке подсетей выберите подсеть, для которой нужно изменить параметры. Вы можете изменить следующие параметры.

    - **Диапазон адресов**. Если в подсети не развернуты ресурсы, вы можете изменить диапазон адресов. Если в подсети имеются какие-либо ресурсы, необходимо удалить их или переместить в другую подсеть. Процедура удаления или перемещения ресурса зависит от его типа. Чтобы узнать, как удалить или переместить ресурсы, подключенные к подсети, прочтите документацию по всем типам ресурсов, которые вам необходимо удалить или переместить. Ограничения для **диапазона адресов** представлены на шаге 5 раздела [Добавление подсети](#add-a-subnet).
    - **Пользователи**. Можно управлять доступом к подсети, используя встроенные роли или собственные настраиваемые роли. Подробнее о назначении ролей и пользователей для доступа к подсети см. в статье [Использование управления доступом на основе ролей для контроля доступа к ресурсам в подписке Azure](../active-directory/role-based-access-control-configure.md?toc=%2fazure%2fvirtual-network%2ftoc.json#add-access).
    - Дополнительные сведения об изменении **группы безопасности сети**, **таблицы маршрутов**, **пользователей** и **конечных точек службы** см. на шаге 5 раздела [Добавление подсети](#add-a-subnet).
5. Щелкните **Save** (Сохранить).

**Команды**

- Azure CLI: [az network vnet subnet update](/cli/azure/network/vnet/subnet#az-network-vnet-subnet-update)
- PowerShell: [Set-AzureRmVirtualNetworkSubnetConfig](/powershell/module/azurerm.network/set-azurermvirtualnetworksubnetconfig)

## <a name="delete-a-subnet"></a>Удаление подсети

Подсеть можно удалить только если, к ней не подключены какие-либо ресурсы. Если в подсети есть подключенные ресурсы, их необходимо удалить, и только потом — саму подсеть. Конкретная процедура удаления ресурса зависит от его типа. Чтобы узнать, как удалить ресурсы, подключенные к подсети, прочтите документацию по всем типам ресурсов, которые вам необходимо удалить.

1. В поле поиска в верхней части портала введите *виртуальные сети*. Когда в результатах поиска появится пункт **Виртуальные сети**, выберите его.
2. В списке виртуальных сетей выберите сеть, содержащую подсеть, которую нужно удалить.
3. В разделе **Параметры** выберите **Subnets** (Подсети).
4. В списке подсетей справа щелкните **...** для подсети, которую нужно удалить.
5. Выберите **Удалить**, а затем — **Да**.

**Команды**

- Azure CLI: [az network vnet delete](/cli/azure/network/vnet/subnet#az-network-vnet-subnet-delete)
- PowerShell: [Remove-AzureRmVirtualNetworkSubnetConfig](/powershell/module/azurerm.network/remove-azurermvirtualnetworksubnetconfig?toc=%2fazure%2fvirtual-network%2ftoc.json)

## <a name="permissions"></a>Разрешения

Для выполнения задач в подсетях учетной записи должна быть назначена одна из ролей ([Участник сети](../active-directory/role-based-access-built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor) или [Пользователь](../active-directory/role-based-access-control-custom-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json)), в которой назначены соответствующие разрешения, перечисленные в следующей таблице.

|Операция                                                                |   Имя операции                               |
|-----------------------------------------------------------------------  |   -------------------------------------------  |
|Microsoft.Network/virtualNetworks/subnets/read                           |   Получение подсети виртуальной сети                   |
|Microsoft.Network/virtualNetworks/subnets/write                          |   Создание или обновление подсети виртуальной сети      |
|Microsoft.Network/virtualNetworks/subnets/delete                         |   Удаление подсети виртуальной сети                |
|Microsoft.Network/virtualNetworks/subnets/join/action                    |   Присоединение к виртуальной сети                         |
|Microsoft.Network/virtualNetworks/subnets/joinViaServiceEndpoint/action  |   Присоединение службы к подсети                     |
|Microsoft.Network/virtualNetworks/subnets/virtualMachines/read           |   Получение виртуальных машин подсети виртуальной сети  |
