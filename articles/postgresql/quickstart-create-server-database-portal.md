---
title: "Портал Azure. Создание базы данных Azure для PostgreSQL | Документация Майкрософт"
description: "Краткое руководство по созданию базы данных Azure и управлению ею для сервера PostgreSQL с помощью пользовательского интерфейса портала Azure."
services: postgresql
author: SaloniSonpal
ms.author: salonis
manager: jhubbard
editor: jasonwhowell
ms.service: postgresql
ms.custom: mvc
ms.topic: quickstart
ms.date: 08/10/2017
ms.translationtype: HT
ms.sourcegitcommit: cf381b43b174a104e5709ff7ce27d248a0dfdbea
ms.openlocfilehash: a4ab9e9e7d331d35547d56406e1da993ade58113
ms.contentlocale: ru-ru
ms.lasthandoff: 08/23/2017

---

# <a name="create-an-azure-database-for-postgresql-in-the-azure-portal"></a>Создание базы данных Azure для PostgreSQL на портале Azure

База данных Azure для PostgreSQL является управляемой службой, которая позволяет запускать и масштабировать высокодоступные базы данных PostgreSQL, а также управлять ими в облаке. В этом кратком руководстве описывается, как быстро создать базу данных Azure для сервера PostgreSQL с помощью портала Azure.

Если у вас еще нет подписки Azure, создайте [бесплатную](https://azure.microsoft.com/free/) учетную запись Azure, прежде чем начинать работу.

## <a name="log-in-to-the-azure-portal"></a>Войдите на портал Azure.
Откройте свой веб-браузер и перейдите на [портал Microsoft Azure](https://portal.azure.com/). Введите свои учетные данные для входа на портал. Панель мониторинга службы является представлением по умолчанию.

## <a name="create-an-azure-database-for-postgresql"></a>Создание базы данных Azure для PostgreSQL

Сервер базы данных Azure для PostgreSQL создается с определенным набором [вычислительных ресурсов и ресурсов хранения](./concepts-compute-unit-and-storage.md). Он создается в [группе ресурсов Azure](../azure-resource-manager/resource-group-overview.md).

Чтобы создать базу данных Azure для сервера PostgreSQL, сделайте следующее:
1.  Щелкните **Создать** (+) в верхнем левом углу портала Azure.
2.  На странице **создания** выберите **Базы данных**, а на странице **Базы данных** щелкните **Azure Database for PostgreSQL** (База данных Azure для PostgreSQL).
 ![База данных Azure для PostgreSQL. Создание базы данных](./media/quickstart-create-database-portal/1-create-database.png)

3.  Заполните форму сведений о новом сервере, указав следующую информацию, как показано на предыдущем рисунке.

    Настройка|Рекомендуемое значение|Описание
    ---|---|---
    имя сервера; |*mypgserver-20170401*|Выберите уникальное имя, идентифицирующее базу данных Azure для сервера PostgreSQL. Имя домена *postgres.database.azure.com* добавляется к указанному вами имени сервера, к которому должны подключаться приложения. В имени сервера можно использовать только строчные буквы, цифры и знак дефиса (-). Длина имени должна составлять от 3 до 63 символов.
    Подписки|*Ваша подписка*|Подписка Azure, которую вы хотите использовать для сервера. Если вы используете несколько подписок, выберите ту, в которой за ресурс взимается плата.
    Группа ресурсов|*myresourcegroup*| Можно создать новую группу ресурсов или использовать существующую группу из подписки.
    учетные данные администратора сервера для входа; |*mylogin*| Создайте собственную учетную запись для входа при подключении к серверу. Не используйте для имени учетной записи администратора такие варианты: azure_superuser, azure_pg_admin, admin, administrator, root, guest или public. Также не используйте имя, которое начинается с pg_.
    Пароль |*По своему выбору* | Создайте пароль учетной записи администратора сервера. Пароль должен содержать от 8 до 128 символов. Пароль должен содержать символы трех из следующих категорий: прописные латинские буквы, строчные латинские буквы, цифры (0–9) и другие символы (!, $, #, % и т. д.).
    Расположение|*Ближайший к пользователям регион*| Выберите ближайшее к пользователям расположение.
    Версия PostgreSQL.|*Выберите последнюю версию*| Если нет особых требований, выберите последнюю версию.
    Ценовая категория | **Базовый**, **50 единиц вычислений**,  **50 ГБ** | Щелкните **Ценовая категория**, чтобы указать уровень производительности и уровень служб для новой базы данных. На вкладке вверху выберите уровень "Базовый". Щелкните ползунок "Единицы вычислений" слева, чтобы для начала выбрать наименьшее доступное значение. Нажмите кнопку **ОК**, чтобы сохранить ценовую категорию. Экран должен выглядеть следующим образом.
    | Закрепление на панели мониторинга | Проверка | Установите флажок **Закрепить на панели мониторинга**, чтобы отслеживать работу сервера на странице передней панели мониторинга портала Azure.

  > [!IMPORTANT]
  > Указанные здесь учетные данные и пароль администратора сервера понадобятся позже в этом руководстве, чтобы войти на сервер и в его базу данных. Запомните или запишите эту информацию для последующего использования.

    ![База данных Azure для PostgreSQL. Выбор ценовой категории](./media/quickstart-create-database-portal/2-service-tier.png)

4.  Нажмите кнопку **Создать**, чтобы подготовить сервер. Подготовка занимает максимум 20 минут.

5.  На панели инструментов щелкните **Уведомления**, чтобы отслеживать процесс развертывания.
 ![База данных Azure для PostgreSQL. Просмотр уведомлений](./media/quickstart-create-database-portal/3-notifications.png)
   
  По умолчанию на сервере создается база данных **postgres**. База данных [postgres](https://www.postgresql.org/docs/9.6/static/app-initdb.html) — это база данных по умолчанию, предназначенная для использования пользователями, служебными программами и сторонними приложениями. 

## <a name="configure-a-server-level-firewall-rule"></a>Настройка правила брандмауэра на уровне сервера

База данных Azure для службы PostgreSQL создает брандмауэр на уровне сервера. Он не позволяет внешним приложениям и средствам подключаться к серверу и к любой базе данных на сервере, если не создано правило брандмауэра, открывающее брандмауэр для определенных IP-адресов. 

1.  Найдите сервер после завершения развертывания. При необходимости можно выполнить поиск. Например, щелкните **Все ресурсы** в меню слева и введите имя сервера (например, *mypgserver-20170401*), чтобы найти созданный сервер. Щелкните имя сервера в результатах поиска. После этого откроется страница **обзора** сервера с параметрами для дальнейшей конфигурации.
 
    ![База данных Azure для PostgreSQL: поиск имени сервера](./media/quickstart-create-database-portal/4-locate.png)

2.  На странице сервера выберите **Безопасность подключения**. 
    ![База данных Azure для PostgreSQL. Создание правила брандмауэра](./media/quickstart-create-database-portal/5-firewall-2.png)

3.  В разделе **Правила брандмауэра** щелкните пустое текстовое поле в столбце **Имя правила**, чтобы создать правило брандмауэра. 

    В этом кратком руководстве мы разрешим трафик на сервер со всех IP-адресов. Для этого введите следующие значения в текстовое поле в каждом столбце.

    Имя правила | Начальный IP-адрес | Конечный IP-адрес 
    ---|---|---
    AllowAllIps |  0.0.0.0 | 255.255.255.255

4. На верхней панели инструментов страницы "Безопасность подключения" щелкните **Сохранить**. Перед продолжением подождите несколько секунд и дождитесь уведомлениям о том, что обновление безопасности подключения завершилось успешно.

    > [!NOTE]
    > Подключения к базе данных Azure для сервера PostgreSQL выполняются через порт 5432. Если вы пытаетесь подключиться из корпоративной сети, исходящий трафик через порт 5432 может быть запрещен сетевым брандмауэром. В таком случае вы не сможете подключиться к серверу. Для этого ваш ИТ-отдел должен открыть порт 5432.
    >

## <a name="get-the-connection-information"></a>Получение сведений о подключении

При создании базы данных Azure для сервера PostgreSQL создается база данных по умолчанию **postgres**. Для подключения к серверу базы данных вам потребуются учетные данные администратора для входа и полное имя сервера. Скорее всего, вы записали эти значения на предыдущем этапе этого руководства. Если вы этого не сделали, можно легко найти данные для входа на странице обзора сервера на портале Azure.

1. Откройте страницу сервера **Обзор**. Запишите значения **имени сервера** и **имени для входа администратора сервера**.
    Наведите указатель на каждое поле. Справа от текста отобразится значок копирования. Щелкните значок копирования, чтобы скопировать нужные значения.

 ![База данных Azure для PostgreSQL. Имя для входа администратора сервера](./media/quickstart-create-database-portal/6-server-name.png)

## <a name="connect-to-postgresql-database-using-psql-in-cloud-shell"></a>Подключение к базе данных PostgreSQL с помощью psql в Cloud Shell

К базе данных Azure для сервера PostgreSQL можно подключиться с помощью нескольких приложений. Сначала воспользуемся служебной программой командной строки psql для подключения к серверу.  Веб-браузер и Azure Cloud Shell можно использовать, как описано здесь, без установки дополнительного программного обеспечения. Если на вашем компьютере установлена служебная программа psql, вы можете подключиться с него.

1. Запустите Azure Cloud Shell с помощью значка терминала в верхней области навигации.

   ![База данных Azure для PostgreSQL. Значок терминала Azure Cloud Shell](./media/quickstart-create-database-portal/7-cloud-console.png)

2. В браузере откроется служба Azure Cloud Shell, которая позволяет выполнять команды оболочки Bash.

   ![База данных Azure для PostgreSQL. Строка Bash в Azure Cloud Shell](./media/quickstart-create-database-portal/8-bash.png)

3. Чтобы подключиться к базе данных Azure для сервера PostgreSQL, введите команду psql в зеленой командной строке Cloud Shell.

    Используйте следующий формат, чтобы подключиться к серверу базы данных Azure для PostgreSQL с помощью служебной программы [psql](https://www.postgresql.org/docs/9.6/static/app-psql.html):
    ```bash
    psql --host=<yourserver> --port=<port> --username=<server admin login> --dbname=<database name>
    ```

    Например, следующая команда позволяет подключиться к серверу, используемому для примера:

    ```bash
    psql --host=mypgserver-20170401.postgres.database.azure.com --port=5432 --username=mylogin@mypgserver-20170401 --dbname=postgres
    ```

    Параметр psql |Рекомендуемое значение|Описание
    ---|---|---
    --host | *имя сервера* | Укажите значение имени сервера, которое вы использовали ранее при создании базы данных Azure для PostgreSQL. В нашем примере используется такое имя сервера: mypgserver-20170401.postgres.database.azure.com. Используйте полное доменное имя (\*.postgres.database.azure.com), как показано в примере. Выполните действия из предыдущего раздела, чтобы найти сведения для подключения, если вы не помните имя своего сервера. 
    --port | **5432** | Всегда используйте порт 5432 при подключении к базе данных Azure для PostgreSQL. 
    --username | *имя для входа администратора сервера* |Введите имя администратора сервера, которое вы использовали ранее при создании базы данных Azure для PostgreSQL. Выполните действия из предыдущего раздела, чтобы найти сведения для подключения, если вы не помните имя пользователя.  Используйте формат *username@servername*.
    --dbname | **postgres** | Для первого подключения используйте имя базы данных по умолчанию *postgres*, созданное автоматически. Позже можно создать собственную базу данных.

    Когда вы запустите команду psql с собственными значениями параметров, появится запрос на ввод пароля администратора сервера. Это пароль, указанный при создании сервера. 

    Параметр psql |Рекомендуемое значение|Описание
    ---|---|---
    пароль | *ваш пароль администратора* | Обратите внимание, что символы введенного пароля не будут отображаться в строке Bash. После ввода всех символов нажмите клавишу ВВОД для проверки подлинности и подключения.

    После подключения служебная программа psql отображает запрос postgres в поле, где вы вводите команды sql. В первоначальных выходных данных подключения может отобразится предупреждение, так как psql в Azure Cloud Shell может иметь версию, отличную от версии сервера базы данных Azure для PostgreSQL. 
    
    Пример выходных данных psql:
    ```bash
    psql (9.5.7, server 9.6.2)
    WARNING: psql major version 9.5, server major version 9.6.
        Some psql features might not work.
    SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-SHA384, bits: 256, compression: off)
    Type "help" for help.
   
    postgres=> 
    ```

    > [!TIP]
    > Если брандмауэр не настроен на разрешение IP-адресов Azure Cloud Shell, возникает следующая ошибка:
    > 
    > psql: FATAL: нет записи pg_hba.conf для узла 138.91.195.82, пользователь mylogin, база данных postgres, подключение SSL для FATAL: необходимо SSL-подключение. Укажите параметры SSL и повторите попытку.
    > 
    > Чтобы устранить эту ошибку, убедитесь, что конфигурация сервера соответствует инструкциям в разделе *Настройка правила брандмауэра уровня сервера* статьи.

4.  Создайте пустую базу данных. Для этого в командной строке введите следующую команду:
    ```bash
    CREATE DATABASE mypgsqldb;
    ```
    Выполнение команды может занять несколько секунд. 

5.  Чтобы подключиться к созданной базе данных **mypgsqldb**, выполните в командной строке следующую команду.
    ```bash
    \c mypgsqldb
    ```

6.  Введите \q и нажмите клавишу ВВОД, чтобы выйти из программы psql. После выполнения Azure Cloud Shell можно закрыть.

Итак, вы подключились к базе данных Azure для PostgreSQL и создали пустую пользовательскую базу данных. Перейдите к следующему разделу, чтобы подключиться к базе данных с помощью другого популярного средства — pgAdmin.

## <a name="connect-to-postgresql-database-using-pgadmin"></a>Подключение к базе данных PostgreSQL с помощью pgAdmin

Чтобы подключиться к серверу PostgreSQL Azure с помощью инструмента графического интерфейса пользователя _pgAdmin_, сделайте следующее:
1.  Запустите приложение _pgAdmin_ на клиентском компьютере. Вы можете установить _pgAdmin_ с помощью http://www.pgadmin.org/.
2.  В центральной части страницы мониторинга в разделе **Быстрые ссылки** щелкните значок **Добавление сервера**.
3.  На вкладке **Общее** в диалоговом окне **Создать сервер** введите уникальное понятное имя для сервера, например **Azure PostgreSQL Server**.
![Средство pgAdmin. Создание сервера](./media/quickstart-create-database-portal/9-pgadmin-create-server.png)
4.  На вкладке **Подключение** в диалоговом окне **Создать сервер** используйте настройки, как указано, а затем нажмите кнопку **Сохранить**.
   ![pgAdmin. Создание сервера](./media/quickstart-create-database-portal/10-pgadmin-create-server.png)

    параметр pgAdmin |Рекомендуемое значение|Описание
    ---|---|---
    Имя узла и адрес | *имя сервера* | Укажите значение имени сервера, которое вы использовали ранее при создании базы данных Azure для PostgreSQL. В нашем примере используется такое имя сервера: mypgserver-20170401.postgres.database.azure.com. Используйте полное доменное имя (\*.postgres.database.azure.com), как показано в примере. Выполните действия из предыдущего раздела, чтобы найти сведения для подключения, если вы не помните имя своего сервера. 
    Порт | **5432** | Всегда используйте порт 5432 при подключении к базе данных Azure для PostgreSQL.  
    База данных обслуживания | **postgres** | Используйте системное имя базы данных по умолчанию — *postgres*.
    Имя пользователя | *имя для входа администратора сервера* | Введите имя администратора сервера, которое вы использовали ранее при создании базы данных Azure для PostgreSQL. Выполните действия из предыдущего раздела, чтобы найти сведения для подключения, если вы не помните имя пользователя. Используйте формат *username@servername*.
    Пароль | *ваш пароль администратора* |  Пароль, выбранный при создании сервера во время работы с этим руководством.
    Роль | *Не указывайте* | Указывать роль на этом шаге не нужно. Оставьте поле пустым.
    Режим SSL | Обязательный параметр | По умолчанию все серверы PostgreSQL Azure создаются с включенным применением SSL. Чтобы выключить применение SSL, ознакомьтесь со статьей [о настройке подключения SSL в базе данных Azure для PostgreSQL](./concepts-ssl-connection-security.md).
    
5.  Щелкните **Сохранить**.
6.  В левой области браузера разверните узел **Серверы**. Выберите сервер, например, **Azure PostgreSQL Server** и щелкните, чтобы подключиться к нему.
7. Разверните узел сервера, а затем разверните раздел **Базы данных** под ним. Список должен включать имеющиеся базы данных *postgres*, а также все созданные пользовательские базы данных, такие как *mypgsqldb*, созданные в предыдущем разделе. Обратите внимание, что можно создать несколько баз данных на сервере с помощью базы данных Azure для PostgreSQL.
8. Щелкните правой кнопкой мыши **Базы данных**, выберите меню **Создать** и щелкните **База данных**.
9.  Введите выбранное имя базы данных в поле **База данных**, в нашем примере это *mypgsqldb*. 
10. Выберите **владельца** для базы данных из раскрывающегося списка. Выберите имя администратора сервера для входа, в нашем примере это *mylogin*.
10. Щелкните **Сохранить**, чтобы создать пустую базу данных.
11. В области **Обзор** найдите созданную базу данных в списке баз данных под именем сервера.
 ![pgAdmin. Создание базы данных](./media/quickstart-create-database-portal/11-pgadmin-database.png)


## <a name="clean-up-resources"></a>Очистка ресурсов
Очистите ресурсы, созданные в рамках работы с этим руководством, удалив [группу ресурсов Azure](../azure-resource-manager/resource-group-overview.md), которая включает все ресурсы в группе ресурсов, или удалив один ресурс сервера, если необходимо сохранить остальные ресурсы без изменений.

> [!TIP]
> Другие краткие руководства в этой коллекции созданы на основе этого документа. Если вы планируете продолжать работу с этими краткими руководствами, не удаляйте созданные ресурсы. Если вы не планируете продолжать работу, удалите созданные ресурсы, выполнив на портале Azure следующие действия.

Чтобы удалить группу ресурсов, включая только что созданный сервер, сделайте следующее:
1.  Найдите группу ресурсов на портале Azure. В меню слева на портале Azure щелкните **Группы ресурсов**, а затем выберите имя группы ресурсов, такое как наш пример **myresourcegroup**.
2.  На странице группы ресурсов щелкните **Удалить**. Затем введите имя своей группы ресурсов, например, из нашего примера — **myresourcegroup**, в текстовое поле, чтобы подтвердить удаление, и щелкните **Удалить**.

Или наоборот, чтобы удалить только что созданный сервер:
1.  Найдите сервер на портале Azure, если он у вас не открыт. В меню слева на портале Azure щелкните **Все ресурсы** и найдите созданный сервер.
2.  На странице **Обзор** нажмите кнопку **Удалить** в верхней части области.
![Сервер базы данных Azure для PostgreSQL: удаление сервера](./media/quickstart-create-database-portal/12-delete.png)
3.  Подтвердите имя сервера, которое нужно удалить, чтобы появилась нужная база данных. Введите имя сервера в текстовое поле, в нашем примере это **mypgserver-20170401**, и щелкните **Удалить**.

## <a name="next-steps"></a>Дальнейшие действия
> [!div class="nextstepaction"]
> [Перенос базы данных с помощью экспорта и импорта](./howto-migrate-using-export-and-import.md)

