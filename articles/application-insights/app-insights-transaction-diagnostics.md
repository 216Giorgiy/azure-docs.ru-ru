---
title: Диагностика транзакций Azure Application Insights | Документация Майкрософт
description: Сведения о полной диагностике транзакций в Application Insights.
services: application-insights
documentationcenter: .net
author: mrbullwinkle
manager: carmonm
ms.service: application-insights
ms.workload: TBD
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 01/19/2018
ms.author: mbullwin;sdash
ms.openlocfilehash: 7a4e4f74c02358fc117e0a66977ee3f0aef5b1dd
ms.sourcegitcommit: 870d372785ffa8ca46346f4dfe215f245931dae1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2018
---
# <a name="unified-cross-component-transaction-diagnostics"></a>Единый интерфейс диагностики транзакций между компонентами

*Сейчас эта возможность доступна в предварительной версии. Она заменяет существующие колонки диагностики серверных запросов, зависимостей и исключений*.

В этой предварительной версии доступен новый единый интерфейс диагностики, который автоматически сопоставляет серверные данные телеметрии со всех отслеживаемых службой Application Insights компонентов в одном представлении. Количество ресурсов с отдельными ключами инструментирования не имеет значения. Application Insights определяет базовые связи и позволяет легко диагностировать компоненты приложения, зависимости или исключения, вызвавшие замедление или сбой выполнения транзакции.

## <a name="what-is-a-component"></a>Что такое компонент?

Компоненты — это независимо развертываемые части распределенного приложения или приложения для микрослужб. Разработчики и операционные команды могут просматривать данные телеметрии, созданные компонентами приложения, на уровне кода.

* Компоненты отличаются от наблюдаемых внешних зависимостей, таких как база данных SQL или концентратор событий, к которым команды или организации могут не иметь доступа (код или данные телеметрии).
* Компоненты выполняются на любом количестве экземпляров серверов, ролей или контейнеров.
* К компонентам могут относиться отдельные ключи инструментирования Application Insights (даже из разных подписок) или разные роли, относящиеся к одному такому ключу. В новом интерфейсе отображаются сведения обо всех компонентах, независимо от способа их настройки.

> [!NOTE]
> * **Отсутствуют связи со связанным элементом?** Все данные телеметрии, относящиеся к запросам сервера, зависимостям и исключениям, находятся в [верхнем](#cross-component-transaction-chart) и [нижнем](#all-telemetry-related-to-the-selected-component-operation) разделах слева. 
> * В [верхнем](#cross-component-transaction-chart) разделе сопоставляются транзакции по всем компонентам. Чтобы получить наилучшие результаты, все компоненты необходимо инструментировать с помощью последних стабильных версий пакетов SDK Application Insights. При наличии разных ресурсов Application Insights проверьте, имеете ли вы соответствующие права на просмотр их данных телеметрии.
> * В [нижнем](#all-telemetry-related-to-the-selected-component-operation) разделе слева отображаются **все** данные телеметрии, включая трассировки и события, связанные с запросом от выбранного компонента.

## <a name="enable-transaction-diagnostics-experience"></a>Включение диагностики транзакций
Включите функцию "Объединенные данные: полная диагностика транзакций" из [списка предварительных версий](app-insights-previews.md).

![Включение предварительной версии](media/app-insights-e2eTxn-diagnostics/previews.png)

Сейчас в этой предварительной версии можно просмотреть серверные запросы, зависимости и исключения. Доступ к новому интерфейсу можно получить из представлений **Результаты поиска**, **Производительность** или **Сбой**. Предварительная версия заменяет соответствующие классические колонки со сведениями.

![Образцы производительности](media/app-insights-e2eTxn-diagnostics/performanceSamplesClickThrough.png)

## <a name="transaction-diagnostics-experience"></a>Интерфейс диагностики транзакций
Это представление состоит из трех основных частей: диаграмма транзакций между компонентами, последовательный список данных телеметрии из определенных операций компонента и область сведений, в которой слева отображается любой выбранный элемент телеметрии.

![Основные части](media/app-insights-e2eTxn-diagnostics/3partsCrossComponent.png)

## <a name="cross-component-transaction-chart"></a>Диаграмма транзакций между компонентами

Эта диаграмма содержит временную шкалу с горизонтальными линиями длительности запросов и зависимостей между компонентами. На ней также помечены все собранные исключения.

* Верхняя строка этой диаграммы представляет точку входа (входящий запрос к первому компоненту, вызванному в этой транзакции). Длительность — это общее время, необходимое, чтобы завершить транзакцию.
* Все вызовы к внешним зависимостям — это простые несворачиваемые строки со значками, представляющими тип зависимости.
* Сворачиваемые строки представляют вызовы к другим компонентам. Каждая строка соответствует определенной операции, вызванной в компоненте.
* По умолчанию на диаграмме отображается изначально выбранный запрос, зависимость или исключение.
* Щелкните любую строку, чтобы просмотреть [сведения из нее в области справа](#details-of-the-selected-telemetry). 

> [!NOTE]
Вызовы к другим компонентам отображаются в виде двух строк: одна представляет исходящий вызов (зависимость) из компонента вызывающей стороны, а другая — входящий запрос в вызываемом компоненте. Разницу между ними можно определить по значку и стилю линий длительности.

## <a name="all-telemetry-related-to-the-selected-component-operation"></a>Все данные телеметрии, связанные с выбранной операцией для компонента

Каждая строка, выбранная на диаграмме транзакций, относится к операции, вызванной в определенном компоненте. Эта операция отражается в заголовке в нижней части. Откройте этот раздел, чтобы просмотреть временную последовательность данных телеметрии, относящихся к определенной операции. Выберите любой элемент телеметрии, чтобы просмотреть соответствующие [сведения в области справа](#details-of-the-selected-telemetry).

![Временная последовательность всех данных телеметрии](media/app-insights-e2eTxn-diagnostics/allTelemetryDrawerOpened.png)

## <a name="details-of-the-selected-telemetry"></a>Подробные сведения о выбранном элементе телеметрии

В этой области отображаются подробные сведения о выбранных элементах из любого из двух разделов в левой части экрана. Если щелкнуть "Показать все", отобразятся все собранные стандартные атрибуты. Все настраиваемые атрибуты отдельно перечислены под стандартным набором. Щелкните Open profiler traces (Открыть трассировки профилировщика) или Open debug snapshot (Открыть моментальный снимок отладки), чтобы просмотреть данные диагностики на уровне кода в соответствующих областях.

![Сведения об исключении](media/app-insights-e2eTxn-diagnostics/exceptiondetail.png)

## <a name="profiler-and-snapshot-debugger"></a>Profiler и Snapshot Debugger

[Application Insights Profiler](app-insights-profiler.md) и [Snapshot Debugger](app-insights-snapshot-debugger.md) упрощают диагностику проблем производительности и ошибок на уровне кода. Эти средства позволяют легко просматривать трассировки профилировщика и моментальные снимки из любого компонента.

Если не удалось запустить профилировщик, получить работы профилировщика, напишите сообщение на адрес **serviceprofilerhelp@microsoft.com**

Если не удалось запустить Snapshot Debugger, напишите сообщение на адрес **snapshothelp@microsoft.com**

![Интеграция отладчика](media/app-insights-e2eTxn-diagnostics/debugSnapshot.png)

## <a name="faq"></a>Часто задаваемые вопросы

*На диаграмме отображается один компонент, а остальные показаны как внешние зависимости без каких-либо сведений о том, что с ними случилось.*

Возможные причины:

* Эти другие компоненты не инструментированы с помощью Application Insights.
* В них используется не последняя стабильная версия пакета SDK Application Insights.
* Если это отдельные ресурсы Application Insights, возможно, отсутствуют необходимые права доступа к их данным телеметрии.

Если вы имеете доступ и компоненты инструментированы с помощью последних версий пакетов SDK Application Insights, сообщите об этом через канал обратной связи в верхнем правом углу.

*Нужна ли эта предварительная версия, если используются только внешние зависимости?*

Да. Новый интерфейс объединяет все связанные серверные данные телеметрии в одно представление. В будущем мы планируем заменить старые колонки сведений. Оцените эту новую возможность и пришлите нам отзыв. Транзакция одного компонента выглядит так:

![Интерфейс с одним компонентом](media/app-insights-e2eTxn-diagnostics/singleComponent.png)

*Строки зависимостей повторяются. Так и должно быть?*

Сейчас исходящий вызов зависимости отображается отдельно от входящего запроса. Как правило, эти два вызова выглядят одинаково. Единственное различие заключается в значении длительности, которое зависит от кругового пути в сети. Разницу между ними можно определить по значку и стилю линий длительности. Если такое представление данных слишком трудное, отправьте нам свой отзыв!

*Что происходит, если часы разных экземпляров компонентов рассинхронизированы?*

Временные шкалы на диаграмме транзакций приводятся в соответствие. Вы можете просмотреть точные метки времени в области сведений или с помощью Analytics.

*Почему в новом интерфейсе отсутствует большинство запросов связанных элементов?*

Это сделано специально. Все связанные элементы компонентов уже доступны в левой части (верхние и нижние разделы). В левой части нового интерфейса отсутствуют два связанных элемента: все данные телеметрии, полученные в течение пяти минут до или после этого события, и временная шкала пользователя.

*Почему в новом интерфейсе отсутствуют функции, которые часто использовались в старых колонках?*

Напишите свои отзывы! Мы хотим решить все проблемы перед выпуском общедоступной версии этого интерфейса, после чего старые представления станут устаревшими. Сейчас вы можете отключить предварительную версию и работать со старыми колонками.

## <a name="known-issues"></a>Известные проблемы

* Образцы сбоев из схемы приложений ссылаются на старые колонки сведений.
* Данные анализа на основе функции autocluster в результатах поиска ссылаются на старые колонки сведений.
* Интеграция рабочих элементов недоступна в новом интерфейсе.
