<properties 
	pageTitle="Мониторинг использования в приложениях Магазина Windows и Windows Phone с помощью Application Insights" 
	description="Анализ использования приложения для устройства Windows с помощью Application Insights." 
	services="application-insights" 
    documentationCenter="windows"
	authors="alancameronwills" 
	manager="douge"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="06/19/2015" 
	ms.author="awills"/>

#  Мониторинг использования в приложениях Магазина Windows и Windows Phone с помощью Application Insights

*Application Insights находится в состоянии предварительной версии.*

Узнайте, сколько пользователей у вас есть и какие страницы они просматривают в вашем приложении. В Application Insights встроена возможность предоставления этих данных. Вставив всего несколько строк кода в ваше приложение, вы можете получить сведения о том, как пользователи используют это приложение и каких целей они достигают с его помощью.

Если это еще не сделано, добавьте [Application Insights в свой проект приложения][windows] и заново опубликуйте его.


## <a name="usage"></a>Отслеживание использования

Во временной шкале «Обзор» щелкайте диаграммы пользователей и сеансов для просмотра более подробной аналитики.


![](./media/app-insights-windows-usage/appinsights-d018-oview.png)

* **Пользователи** отслеживаются анонимно, поэтому один и тот же пользователь на разных устройствах может быть учтен дважды.
* **Сеанс** учитывается, когда приложение приостановлено (не на короткий интервал времени, чтобы не учитывались случайные приостановки).

#### Сегментация

Сегментируйте диаграмму, чтобы получить разбивку по различным критериям. Например, чтобы увидеть, сколько пользователей используют каждую версию приложения, откройте диаграмму пользователей и сегментируйте ее по версии приложения:

![На диаграмме пользователей переключитесь на сегментирование и выберите параметр «Версия приложения»](./media/app-insights-windows-usage/appinsights-d25-usage.png)


#### Просмотры страниц

Чтобы исследовать пути, по которым пользователи проходят в вашем приложении, вставьте в свой код [телеметрию просмотра страниц][api]:

    var telemetry = new TelemetryClient();
    telemetry.TrackPageView("GameReviewPage");

Просматривайте результаты на диаграмме просмотров страниц, щелкнув ее, чтобы открыть подробные сведения:

![](./media/app-insights-windows-usage/appinsights-d27-pages.png)

Щелкайте любую страницу, чтобы просмотреть подробные сведения о конкретных случаях.

#### Настраиваемые события

Вставив код для отправки настраиваемых событий из приложения, вы можете отслеживать поведение пользователей и использование определенных компонентов и сценариев.

Например:

    telemetry.TrackEvent("GameOver");

Данные будут отображаться в таблице настраиваемых событий. Вы можете просматривать агрегированное представление в обозревателе метрик, а также щелкать любое событие, чтобы просматривать конкретные случаи.

![](./media/app-insights-windows-usage/appinsights-d28-events.png)


К любому событию можно добавлять строковые и числовые свойства.


    // Set up some properties:
    var properties = new Dictionary <string, string> 
       {{"Game", currentGame.Name}, {"Difficulty", currentGame.Difficulty}};
    var measurements = new Dictionary <string, double>
       {{"Score", currentGame.Score}, {"Opponents", currentGame.OpponentCount}};

    // Send the event:
    telemetry.TrackEvent("GameOver", properties, measurements);


Щелкайте любое событие, чтобы просмотреть его подробные свойства, включая заданные вами.


![](./media/app-insights-windows-usage/appinsights-d29-eventProps.png)

Дополнительные сведения о настраиваемых событиях см. в [справочнике по API][api].

## Сеансы

Сеанс является базовым понятием Application Insights, целью которого является сопоставление телеметрических событий (например, сбоев или настраиваемых событий, запрограммированных вами) с определенным сеансом пользователя.

О каждом сеансе собирается подробная контекстная информация, например, характеристики устройства, географическое положение, сведения об операционной системе и т. д.

При [диагностировании проблем][diagnostic] можно найти все телеметрические события, связанные с сеансом, в рамках которого возникла проблема, в том числе все запросы и все зарегистрированные события, исключения или трассировки.

Сеансы предоставляют подробную информацию о частотности контекстов, таких как устройство, операционная система или местоположение. Например, отобразив количество сеансов, сгруппированных по устройствам, можно получить более точную информацию о том, как часто определенное устройство используется вместе с приложением, чем используя данные счетчика просмотров страницы. Эти входные данные будут полезны при рассмотрении любых проблем, связанных с конкретным устройством.


#### Что такое сеанс?

Сеанс представляет собой отдельный случай использования приложения пользователем. Простейший сеанс начинается с запуска приложения пользователем и завершается, когда пользователь прекращает работу с приложением. В случае с мобильными приложениями сеанс завершается при приостановке приложения (сворачивании его в фоновый режим) более чем на 20 секунд. При возобновлении работы приложения начинается новый сеанс. Обычно пользователь может осуществить несколько сеансов за день или даже за час.

Метрика **длительность сеанса** представляет собой промежуток времени между первым и последним телеметрическим событием сеанса. (Она не включает время ожидания.)


**Числом сеансов** за определенный промежуток времени называют количество уникальных сеансов, в рамках которых осуществлялись какие-либо действия. С точки зрения долговременных диапазонов, таких как число ежедневных сеансов за неделю, это число обычно эквивалентно общему количеству сеансов.

Однако при анализе более коротких временных диапазонов продолжительностью, скажем, один час, долговременный многочасовой сеанс будет учитываться каждый час его активности.

## Пользователи и число пользователей

Каждому сеансу пользователя присваивается уникальный идентификатор пользователя, создаваемый при использовании приложения и хранящийся в локальном хранилище устройства. Пользователь, использующий несколько устройств, будет учтен более одного раза.

Метрикой **число пользователей** за определенный промежуток времени называют количество уникальных пользователей, со стороны которых была зарегистрирована активность в данный промежуток времени. Таким образом, при установке временного интервала с шагом в час и менее пользователи, осуществляющие долгие сеансы, могут быть учтены несколько раз.

Метрика**новые пользователи** показывает количество пользователей, которые начали свой первый сеанс работы в приложении в данный интервал времени.


## <a name="debug"></a>Режим отладки и режим выпуска

#### Отладка

При сборке в режиме отладки события передаются по мере их создания. При потере подключения к Интернету и выходе из приложения до восстановления подключения данные автономной телеметрии удаляются.

#### Выпуск

Если сборка выполняется в конфигурации выпуска, события хранятся на устройстве и передаются, когда приложение возобновляет работу. Данные также отправляются при первом использовании приложения. Если при запуске отсутствует подключение к Интернету, предыдущие данные телеметрии, а также данные телеметрии для текущего жизненного цикла сохраняются и отправляются при следующем возобновлении.

## <a name="next"></a>Дальнейшие действия

[Изучение своих пользователей][knowUsers]

[Дополнительные сведения об обозревателе метрик][metrics]


[Устранение неполадок][qna]




<!--Link references-->

[api]: app-insights-api-custom-events-metrics.md
[diagnostic]: app-insights-diagnostic-search.md
[knowUsers]: app-insights-overview-usage.md
[metrics]: app-insights-metrics-explorer.md
[portal]: http://portal.azure.com/
[qna]: app-insights-troubleshoot-faq.md
[windows]: app-insights-windows-get-started.md


 

<!---HONumber=62-->