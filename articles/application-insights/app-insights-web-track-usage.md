<properties 
	pageTitle="Отслеживание использования в веб-приложениях" 
	description="Ведение журнала действий пользователя." 
	services="application-insights" 
	authors="alancameronwills" 
	manager="kamrani"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="2015-01-09" 
	ms.author="awills"/>
 
# Отслеживание использования веб-приложений

Узнайте, как используется ваше веб-приложение. Настройте аналитику использования, и вы узнаете, какие страницы ищут пользователи, сколько пользователей возвращается на ваш веб-сайт и часто ли они посещают его. Добавляя [пользовательские события и метрики][track], вы сможете детально проанализировать популярные функции, распространенные ошибки и настроить свое приложение для успешного использования.

Данные телеметрии собираются от клиента и от сервера. Клиентские данные собираются со всех современных веб-браузеров, а серверные данные могут собираться с платформы ASP.NET. (Она не обязательно должна работать на Azure.) 

* [Настройка аналитики веб-использования](#webclient)
* [Аналитика использования](#usage)
* [Пользовательские счетчики страниц для одностраничных приложений](#spa)
* [Инспектирование отдельных страничных событий](#inspect)
* [Детальное отслеживание с пользовательскими событиями и метриками](#custom)
* [Видео](#video)

## <a name="webclient"></a> Настройка аналитики веб-клиента

#### Получение ресурса Application Insights в Azure

**Если вы разрабатываете приложение ASP.NET** и еще этого не сделали, [добавьте Application Insights в свой веб-проект][start]. 

**Если веб-сайт работает не на платформе ASP.NET,** выполните вход в [Microsoft Azure](http://azure.com), перейдите на [предварительную версию портала](https://portal.azure.com) и добавьте ресурс Application Insights.

![](./media/app-insights-web-track-usage/appinsights-11newApp.png)

(Вы можете вернуться к этому позже, нажав кнопку "Обзор".)



#### Добавьте свой скрипт на веб-страницы

Получите скрипт для веб-страниц в разделе "Быстрый запуск".

![](./media/app-insights-web-track-usage/appinsights-06webcode.png)

Вставляйте скрипт перед тегом &lt;/head&gt; на каждой странице, где необходимо отслеживание. Если на вашем веб-сайте есть главная страница, можно разместить скрипт на ней. Например, в проекте ASP.NET MVC скрипт следует разместить на странице View\Shared_Layout.cshtml

## <a name="usage"></a>Аналитика использования

Запустите веб-сайт, поработайте с ним немного для формирования телеметрии и подождите 1-2 минуты. Можно запустить его на компьютере разработчика с помощью клавиши F5 или развернуть его на сервере.

В колонке общих сведений о приложении вы увидите следующие плитки с аналитикой использования:

![](./media/app-insights-web-track-usage/appinsights-47usage.png)

*Еще нет данных? Нажмите кнопку **Обновить** в верхней части страницы*.

* **Сеансов для браузера**

    Сеанс - это период времени от открытия пользователем любой страницы на сайте и до истечения 30 минут после последнего запроса к веб-серверу. 

    Чтобы увеличить диаграмму, щелкните ее.

* **Самые просматриваемые страницы**

    Показывает общее число просмотров за последние 24 часа.

    Чтобы просмотреть более подробную историю, щелкните плитку с числом просмотров страницы. Чтобы получить журнал за более длительный период, можно изменить временной диапазон для отчета.

![](./media/app-insights-web-track-usage/appinsights-49usage.png)


Щелкните диаграмму, чтоб увидеть метрики, которые она может отобразить, либо добавьте новую диаграмму и выберите метрики, которые она отображает.

![](./media/app-insights-web-track-usage/appinsights-63usermetrics.png)

> [AZURE.NOTE] Отмените выбор для всех метрик, чтобы включить их все. Метрики могут отображаться только в определенных сочетаниях. При выборе какой-либо метрики все несовместимые метрики будут отключены.



## <a name="spa"></a> Настраиваемые счетчики страниц для одностраничных приложений

По умолчанию счетчик страницы увеличивается на единицу каждый раз, когда страница загружается в клиентском браузере.  Однако вам может потребоваться подсчитать дополнительные просмотры страницы. Например, если содержимое страницы разбито на вкладки, возможно, вы захотите, чтобы счетчик увеличивался на единицу при каждом переключении между ними. Другой пример - ситуация, когда код JavaScript на странице загружает новое содержимое, но URL-адрес в браузере при этом не меняется. 

Вставьте в соответствующем месте клиентского кода вызов JavaScript наподобие следующего:

    appInsights.trackPageView(myPageName);

Имя страницы может содержать те же символы, что и URL-адрес, но все символы после "#" или "?" игнорируются.


## <a name="inspect"></a> Изучение отдельных событий просмотра страницы

Обычно телеметрия просмотра страниц анализируется службой Application Insights, и вы видите только сводные отчеты со средними значениями для всех пользователей. Однако в целях отладки можно также изучать отдельные события просмотра страниц.

В колонке Diagnostic Search (Поиск данных диагностики) в разделе Filter (Фильтр) установите флажок Page View (Просмотр страниц).

![](./media/app-insights-web-track-usage/appinsights-51searchpageviews.png)

Выберите любое событие, чтобы просмотреть подробные сведения.

> [AZURE.NOTE] При использовании [поиска][diagnostic] обратите внимание, что будут искаться соответствия по полным словам: запросы "Информаци" и "нформация" не соответствуют слову "Информация", а запрос "Информаци*" соответствует. Поисковый запрос нельзя начинать с подстановочного знака. Например, по запросу "*нформаци" не будет найдено слово "Информация". 

> [Подробнее о диагностическом поиске][diagnostic]

## <a name="custom"></a> Подробное отслеживание использования с помощью настраиваемых событий и метрик

Хотите узнать, что пользователи делают в вашем приложении? Вставив вызовы в коде клиента и сервера, вы можете отправить свою телеметрию в Application Insights. Например, вы можете выяснить, сколько пользователей создали заказы, но не завершили их, какие ошибки проверки возникают наиболее часто или среднее количество очков, набранных пользователями в игре.

[Подробнее о пользовательских событиях и метриках API][track].

## <a name="video"></a> Видео: "Отслеживание использования"

> [AZURE.VIDEO tracking-usage-with-application-insights]

## <a name="next"></a> Дальнейшие действия

[Мониторинг использования приложения с помощью пользовательских событий и метрик][track]




[AZURE.INCLUDE [app-insights-learn-more](../../includes/app-insights-learn-more.md)]





<!--HONumber=35.2-->

<!--HONumber=46--> 
 