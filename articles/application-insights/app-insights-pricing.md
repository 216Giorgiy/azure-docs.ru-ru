<properties 
	pageTitle="Управление ценами и квотами для Application Insights" 
	description="Выберите необходимый план цен" 
	services="application-insights" 
    documentationCenter=""
	authors="alancameronwills" 
	manager="douge"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="03/15/2016" 
	ms.author="awills"/>

# Управление ценами и квотами для Application Insights

*Доступна только предварительная версия Application Insights.*

[Ценообразование][pricing] для [Visual Studio Application Insights][start] зависит от объема данных для каждого приложения. Бесплатный уровень Free позволяет получить доступ к большинству функций с некоторыми ограничениями.

Каждый ресурс Application Insights оплачивается как отдельная служба и включается в счет за вашу подписку на Azure.

[См. схему ценообразования][pricing].

## Обзор квоты и расценок для ресурса Application Insights

Можно открыть колонку «Квота + цены» из раздела «Настройки» ресурса приложения.

![Выберите «Настройки», «Квота + Цены».](./media/app-insights-pricing/01-pricing.png)

Ваш выбор схемы ценообразования отражается на следующих параметрах.

* [Месячная квота](#monthly-quota) — объем телеметрии, который может быть проанализирован каждый месяц.
* [Скорость передачи данных](#data-rate) — максимальная скорость обработки данных, полученных от вашего приложения.
* [Сохранение данных](#data-retention) — насколько долго на портале Application Insights сохраняются данные для просмотра.
* [Непрерывный экспорт](#continuous-export) — можете ли вы экспортировать данные в другие средства и службы.

Эти ограничения задаются отдельно для каждого ресурса Application Insights.

### Бесплатная пробная версия Premium

При создании первого ресурса Application Insights он запускается на уровне Free.

Вы можете в любой момент перейти на 30-дневную бесплатную пробную версию Premium. Это дает вам все преимущества уровня Premium. По истечении 30 дней приложение автоматически вернется на прежний уровень, если явно не выбран другой уровень. Понравившийся уровень можно выбрать в любой момент в течение пробного периода, но бесплатная пробная версия по-прежнему доступна до конца 30-дневного периода.


## Месячная квота

* Каждый календарный месяц приложение может отправлять определенное количество данных телеметрии в Application Insights. В настоящее время квоты для бесплатной ценовой категории — 5 миллионов точек данных в месяц и значительно больше для других схем; при превышении квоты вы можете приобрести дополнительные точки данных. Актуальные сведения см. в [схеме ценообразования][pricing]. 
* Квота зависит от выбранной ценовой категории.
* Квота отсчитывается с полуночи (в формате UTC) первого дня каждого месяца.
* Диаграмма точек данных показывает, какая часть вашей квоты будет полностью использована в этом месяце.
* Квота измеряется в *точках данных.* Одна точка данных представляет собой вызов одного из методов отслеживания явно в коде или в одном из модулей стандартной телеметрии. Она может иметь несколько присоединенных свойств и метрик.
* Точки данные создаются:
 * [модулями пакета SDK](app-insights-configuration-with-applicationinsights-config.md), которые автоматически собирают данные, например для сообщения о запросе или сбое либо для измерения производительности;
 * вызовами [API](app-insights-api-custom-events-metrics.md) `Track...`, которые вы написали, например `TrackEvent` или `trackPageView`;
 * [веб-тестами доступности](app-insights-monitor-web-app-availability.md), которые вы настроили.
* Во время отладки вы увидите точки данных, отправляемые из приложения, в окне вывода Visual Studio. Чтобы просмотреть события на стороне клиента, откройте вкладку "Сеть" на панели отладки браузера (обычно для этого нужно нажать клавишу F12).
* *Данные о сеансах* в квоте не учитываются. Сюда относятся количество пользователей, сеансов, данные среды и устройств.
* Если вы хотите подсчитать точки данных визуально, их вы можете найти в различных областях:
 * каждый элемент в [поиске по журналу диагностики](app-insights-diagnostic-search.md), в том числе запросы HTTP, исключения, журналы трассировки, просмотры страниц, события зависимости и пользовательские события;
 * каждое необработанное измерение [метрики](app-insights-metrics-explorer.md), например счетчик производительности; (Обычно точки, отображаемые на диаграммах, это агрегаты нескольких точек необработанных данных.)
 * Каждая точка на диаграмме веб-доступности, кроме того, является усреднением нескольких точек данных.
* Кроме того, вы можете проверить отдельные точки данных источника во время отладки:
 * Если запустить приложение в режиме отладки в Visual Studio, точки данных будут отображаться в окне вывода. 
 * Чтобы просмотреть точки данных клиента, откройте панель отладки браузера (обычно клавишей F12) и откройте вкладку "Сеть".
* Скорость передачи данных может (по умолчанию) снижаться [адаптивной выборкой](app-insights-sampling.md). Это означает, что по мере более активного использования приложения скорость телеметрии не увеличится настолько, насколько этого можно ожидать.

### Превышение

Если приложение отправляет объем данных, превышающий месячную квоту, есть несколько вариантов:

* Оплатить дополнительные данные. Подробности см. в [схеме ценообразования][pricing]. Этот параметр можно выбрать заранее. Этот параметр недоступен в ценовой категории Free.
* Выбрать более высокую ценовую категорию.
* Ничего не предпринимать. Данные о сеансах по-прежнему будут записываться, но другие данные не будут отображаться в результатах поиска по журналу диагностики или в обозревателе метрик.


### Какой объем данных отправляется в настоящее время?

На диаграмме в нижней части колонки цен показан объем точек данных приложения, сгруппированных по типам точек данных. (Вы можете также создать эту диаграмму в обозревателе метрик.)

![В нижней части колонки цен](./media/app-insights-pricing/03-allocation.png)

Щелкните диаграмму, чтобы получить дополнительную информацию, или перетащите по ней указатель мыши и щелкните (+), чтобы узнать подробности о диапазоне времени.

Диаграмма показывает объем данных, поступающих в службу Application Insights после [выборки](app-insights-sampling.md).


## Скорость передачи данных

Помимо месячной квоты имеются ограничения по скорости передачи данных. Для [ценовой категории][pricing] "Бесплатный" это ограничение составляет 200 точек данных в секунду с вычислением среднего значения за пятиминутный период, а для платных категорий — 500 точек данных в секунду с вычислением среднего значения поминутно.

Имеются три категории, которые подсчитываются отдельно.

* [Вызовы TrackTrace](app-insights-api-custom-events-metrics.md#track-trace) и [извлеченные журналы](app-insights-asp-net-trace-logs.md).
* [Исключения](app-insights-api-custom-events-metrics.md#track-exception), ограничены 50 точками в секунду.
* Все другие данные телеметрии (просмотры страниц, сеансы, запросы, зависимости, метрики, пользовательские события, результаты веб-тестов).





*Что произойдет, если для приложения будет превышена частота обмена данными?*

* Объем данных, отправляемых приложением, оценивается каждую минуту. Если он превышает среднюю минутную частоту, сервер отклоняет часть запросов. В некоторых версиях пакета SDK в этом случае выполняется повторная попытка отправки, распределяющая пиковую нагрузку по периоду в несколько минут, в то время как в других SDK, например для JavaScript, отклоненные данные теряются.

Если произошло регулирование, вы увидите соответствующее предупреждение.

*Как узнать, сколько точек данных отправляет приложение?*

* Чтобы отобразилась диаграмма тома данных, последовательно выберите элементы «Параметры» и «Квота и расценки».
* Или же в обозревателе метрик добавьте новую диаграмму и в качестве метрики выберите **том точек данных**. Переключитесь на представление "Группировка" и сгруппируйте по **типу данных**.


### Советы по уменьшению скорости передачи данных

Если ограничения по скорости данных станут причиной их потерь, вот некоторые действия, которые можно предпринять.

* Используйте [выборку](app-insights-sampling.md). Эта технология уменьшает скорость передачи данных, не искажая значения метрик и не влияя на возможность перехода между связанными элементами в поиске.
* [Ограничьте число вызовов Ajax, которые могут быть отображены](app-insights-javascript.md#detailed-configuration) на каждой странице представления, или отключите формирование отчетов Ajax.
* Отключите модули сбора, которые вы не используете, [отредактировав файл ApplicationInsights.config](app-insights-configuration-with-applicationinsights-config.md). Например, вы можете решить, что счетчики производительности или данные зависимостей не являются необходимыми.
* Агрегируйте метрики заранее. Если в ваше приложение включены вызовы в адрес TrackMetric, вы можете снизить объем трафика путем перегрузки, которая будет получать ваши вычисления среднего значения и стандартного отклонения замеров пакетов. Кроме того, вы можете использовать [пакет предварительных статистических вычислений](https://www.myget.org/gallery/applicationinsights-sdk-labs). 


### Ограничения для имен

1.	Максимальное количество уникальных имен метрик — 200, а уникальных имен свойств — 200. Метрики включают данные, отправленные в TrackMetric, а также измерения по другим типам данных, таким как события. [Имена метрик и свойств][api] являются глобальными для каждого ключа инструментирования и не ограничиваются типом данных.
2.	[Свойства][apiproperties] можно использовать для фильтрации и группирования, только если на каждое свойство приходится менее 100 уникальных значений. После превышения максимального количества уникальных значений (100 уникальных значений), свойство можно по-прежнему использовать для поиска и фильтрации, но не для фильтров.
3.	Максимальное количество уникальных значений для стандартных свойств, таких как Request Name или Page URL, в неделю — 1000. После превышения максимального количества уникальных значений (1000 уникальных значений) дополнительные значения отмечаются как «Другие значения». Исходное значение можно по-прежнему использовать для полнотекстового поиска и фильтрации.

## Хранение данных

Ваша ценовая категория определяет срок хранения данных на портале, а также какое время в прошлом вы можете установить временные интервалы.


* Необработанные точки данных (экземпляры, которые можно проверить с помощью поиска по журналу диагностики): 7 дней.
* Статистические данные (то есть счетчики, средние значения и другие статистические данные, которые отображаются в обозревателе метрик) сохраняются со степенью детализации 1 минута в течение 30 дней, а со степенью детализации 1 час или 1 день (в зависимости от типа) — 90 дней.


## Выборка

[Выборка](app-insights-sampling.md) представляет собой метод уменьшения объема данных телеметрии, сохраняемых приложением. Он позволяет оставить возможность поиска связанных событий во время поиска по журналу диагностики, сохранив правильные количества событий. Выборка помогает соблюдать месячную квоту.

Существует несколько видов выборки. Мы рекомендуем [адаптивную выборку](app-insights-sampling.md), которая автоматически настраивается на объем данных телеметрии, отправляемых приложением. Она оперирует с данными в пакете SDK в вашем веб-приложении, что позволяет уменьшить сетевой трафик телеметрии. Ее можно использовать, если ваше веб-приложение основано на платформе .NET. Только установите последнюю версию пакета SDK (бета-версию).

В качестве альтернативы можно установить *выборку приема*, доступную на колонке квот и цен. Этот вид выборки работает в точке, где данные телеметрии из приложения поступают в службу Application Insights. Это не влияет на объем данных телеметрии, отправляемых из приложения, но уменьшает объем данных, сохраняемых службой.

![В колонке "Quotas and pricing" (Квоты и цены) щелкните элемент "Выборки" и выберите долю выборки.](./media/app-insights-pricing/04.png)

Выборка — это эффективный способ сократить затраты и оставаться в пределах месячной квоты. Алгоритм выборки сохраняет связанные элементы телеметрии, поэтому, например, при использовании поиска можно найти запрос, относящийся к конкретному исключению. Алгоритм также сохраняет правильные количества, чтобы вы видели в обозревателе метрик правильные значения частоты запросов, частоты исключений и других счетчиков.


## Просмотр счета для подписки на Azure

Оплата за использование Application Insights добавляется в счет Azure. Дополнительную информацию о счете за подписку на Azure можно просмотреть в разделе выставления счетов портала Azure или на [портале выставления счетов Azure](https://account.windowsazure.com/Subscriptions).

![В боковом меню выберите «Выставление счетов».](./media/app-insights-pricing/02-billing.png)

## Сводная таблица ограничений

[AZURE.INCLUDE [application-insights-limits](../../includes/application-insights-limits.md)]


<!--Link references-->

[api]: app-insights-api-custom-events-metrics.md
[apiproperties]: app-insights-api-custom-events-metrics.md#properties
[start]: app-insights-overview.md
[pricing]: http://azure.microsoft.com/pricing/details/application-insights/

 

<!---HONumber=AcomDC_0518_2016-->