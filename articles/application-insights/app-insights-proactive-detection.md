<properties 
	pageTitle="Application Insights: упреждающее обнаружение" 
	description="Служба Application Insights выполняет глубокий анализ телеметрии вашего приложения и предупреждает о потенциальных проблемах производительности." 
	services="application-insights" 
    documentationCenter="windows"
	authors="antonfrMSFT" 
	manager="douge"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/08/2016" 
	ms.author="awills"/>

#  Application Insights: упреждающее обнаружение

*Application Insights находится в состоянии предварительной версии.*


Служба Application Insights выполняет глубокий анализ телеметрии вашего приложения и предупреждает о потенциальных проблемах производительности. Скорее всего, вы читаете эту статью, так как получили от нас письмо с предупреждением.


## Что такое упреждающее обнаружение?

Упреждающее обнаружение определяет аномалии производительности приложения путем анализа телеметрии, передаваемой приложением в Application Insights.

В частности, оно определяет проблемы с производительностью, которые влияют только на некоторых пользователей или влияют на пользователей лишь в некоторых случаях.

Например, упреждающее обнаружение сможет сообщить вам, что страницы приложения загружаются намного медленнее только в конкретном браузере или что медленнее обслуживаются запросы только с конкретного сервера. Оно также позволяет находить проблемы, связанные с сочетаниями свойств, например, медленная загрузка страницы в одном географическом регионе в определенное время дня.

Такие аномалии очень сложно обнаружить, просто просматривая данные, но они встречаются чаще, чем вы могли бы ожидать. Часто они обнаруживаются только после жалоб ваших клиентов. Но это уже слишком поздно: столкнувшиеся с проблемами пользователи уже переключаются на ваших конкурентов.

В настоящее время наши алгоритмы анализируют время загрузки страницы, время отклика на запрос на сервере и время выполнения зависимых запросов.

Чтобы воспользоваться этой возможностью, не нужно устанавливать пороговые значения или настраивать правила. Для обнаружения аномальных шаблонов используются алгоритмы машинного обучения и интеллектуального анализа данных.

Упреждающее обнаружение существует только в предварительной версии и доступно не для всех пользователей Application Insights. Если вы хотите попробовать эту функцию, обратитесь к AppInsightsML@microsoft.com, и мы поможем вам ее настроить.

## Предупреждение

* *Почему мне направлено это сообщение?*
 * Функция упреждающего обнаружения провела анализ данных телеметрии вашего приложения, которые были отправлены в Application Insights, и обнаружила проблему производительности в приложении.
* *Уведомление означает, что определенно возникла какая-то неполадка?*
 * Нет, это просто предложение обратить более пристальное внимание на ту или иную ситуацию. 
* *Что делать?*
 * [Просмотрите представленные данные](#responding-to-an-alert). Используйте обозреватель метрик для анализа производительности в динамике по времени и перехода к дополнительным метрикам. Используйте поиск для фильтрации определенных событий, которые помогут определить основную причину. 
* *Это означает, что вы отслеживаете мои данные?*
 * Нет, служба работает полностью в автоматическом режиме. Уведомления получаете только вы. Ваши данные [конфиденциальны](app-insights-data-retention-privacy.md).


## Процесс обнаружения

* *Какие виды аномалий обнаруживаются?*
 * Шаблоны, проверка которых займет у вас слишком много времени. Например, низкая производительность при определенном сочетании расположения, времени суток и платформы.
* *Анализируются ли все данные, собираемые Application Insights?*
 * В настоящее время нет. В настоящее время мы анализируем время ответа на запрос и время загрузки страницы. Анализ дополнительных метрик ожидается в ближайшее время. 
* *Можно создавать собственные правила обнаружения аномалий?*
 * Пока нет. Но вы можете сделать следующее:
 * [настроить предупреждения](app-insights-alerts.md), которые оповещают вас, когда метрика достигает порогового значения;
 * [Экспортировать данные телеметрии](app-insights-export-telemetry.md) в [базу данных](app-insights-code-sample-export-sql-stream-analytics.md), [PowerBI](app-insights-export-power-bi.md) или [другие](app-insights-code-sample-export-telemetry-sql-database.md) средства, с помощью которых можно проанализировать информацию самостоятельно.
* *Как часто выполняется анализ?*
 * Мы проводим анализ ежедневно, обрабатывая данные телеметрии за предыдущий день.
* **То есть эта функция заменяет [оповещения о метриках](app-insights-alerts.md)?
 * Нет. В наши задачи не входит обнаружение каждого события, которое вы можете счесть нестандартным или аварийным.

## Как исследовать проблемы, выявленные упреждающим обнаружением

Откройте отчет об аномалии из электронного письма или списка аномалий.

![](./media/app-insights-proactive-detection/03.png)


* В поле **Когда** показано время обнаружения проблемы.
* В разделе **Что** описывается
 * обнаруженная проблема;
 * характеристики набора событий, которые демонстрировали проблемное поведение.
* В таблице набор с низкой производительностью сравнивается со средним поведением всех других событий.

С помощью ссылок перейдите к обозревателю метрик и поиска в соответствующих отчетах, отфильтрованных по времени и свойствам набора с низкой производительностью.

Измените диапазон времени и фильтры для просмотра телеметрии.

## Как можно повысить производительность?

Медленные и неудачные отклики доставляют большие неудобства пользователям веб-сайтов, как вы знаете из собственного опыта. Поэтому очень важно устранить проблемы.

### Рассмотрение

Во-первых, имеет ли это значение? Если страница всегда загружается медленно, но ее просматривает всего 1 % пользователей веб-сайта, наверное, вам лучше заняться более важными делами. С другой стороны, если страницу открывает только 1 % пользователей, но она каждый раз возвращает исключения, возможно, есть смысл в том, чтобы изучить проблему.

В общем, ориентируйтесь на отчет о влиянии в сообщении электронной почты. Но имейте в виду, что полностью полагаться на него нельзя. Соберите дополнительные данные для подтверждения.

Рассмотрите все аспекты проблемы. Причиной может быть географическое расположение. Выполните [тесты доступности](app-insights-monitor-web-app-availability.md), включив этот регион. Возможно, в этой области просто проблемы с сетью.

### Диагностика медленных загрузок страниц 

В чем суть проблемы? Сервер медленно отвечает на запросы, страница очень большая или браузеру требуется проделать большой объем работы, чтобы отобразить ее?

Откройте колонку метрик браузеров. [Сегментированное отображение показателей времени загрузки страницы в браузере](app-insights-javascript.md#explore-your-data) показывает, на что уходит время.

* Высокий показатель **времени отправки запроса** означает, что сервер отвечает медленно или запрос является публикацией с большим объемом данных. Чтобы узнать время отклика, просмотрите [метрики производительности](app-insights-web-monitor-performance.md#metrics). 
* Чтобы узнать, что замедляет работу — внешние службы или базы данных, — настройте [отслеживание зависимостей](app-insights-dependencies.md).
* Если преобладает метрика **Получение ответа**, это значит, что страница и ее зависимые компоненты (JavaScript, CSS, изображения и т. п. — но не асинхронно загруженные данные) имеют большой размер. Настройте [тест доступности](app-insights-monitor-web-app-availability.md) и не забудьте установить параметр для загрузки зависимых компонентов. После получения результатов откройте сведения и разверните их, чтобы просмотреть показатели времени загрузки различных файлов.
* Высокое значение счетчика **Время обработки клиента** может указывать на медленное выполнение сценариев. Если причина не очевидна, рекомендуем добавить код времени и отправить значения времени в вызовах trackMetric.

### Улучшение производительности медленных страниц

В Интернете достаточно советов о том, как ускорить ответы серверов и сократить время загрузки страниц, поэтому мы не будем повторять их здесь. Ниже приведено несколько советов, которые, вероятно, вам уже известны. Может, они натолкнут вас на нужные мысли.

* Медленная загрузка из-за большого размера файлов — загружайте скрипты и другие компоненты асинхронно. Используйте объединение скриптов. Разбейте главную страницу на мини-приложения, которые загружают свои данные по отдельности. Не используйте обычный HTML для отправки длинных таблиц — используйте скрипт для запроса данных в формате JSON (или другом компактном формате) и уже затем заполняйте таблицу. Для всего этого есть замечательные платформы. (Они, конечно же, также содержат большие скрипты).
* Медленные серверные зависимости — обратите внимание на географическое расположение компонентов. Например, при использовании Azure веб-сервер и база данных должны быть расположены в одном регионе. Проверьте, не получают ли запросы больше данных, чем требуется. Возможно, поможет кэширование или пакетная обработка.
* Проблемы мощности — просмотрите метрики времени ответа сервера и количества запросов. Если пики времени ответа непропорциональны пикам количества запросов, вполне вероятно, что ресурсы серверов исчерпаны. 


## Электронные уведомления

* *Мне необходимо подписаться на эту службу для получения уведомлений?*
 * Нет. Наша программа-робот периодически исследует данные от всех пользователей службы Application Insights и отправляет уведомления при обнаружении неполадок.
* *Можно отменить подписку или настроить пересылку уведомлений моим коллегам?*
 * Щелкните ссылку отмены подписки в предупреждении или письме. 
 
    В настоящее время они направляются только тем, у кого есть [доступ на запись к ресурсу Application Insights](app-insights-resources-roles-access-control.md).

    Также можно изменить список получателей в колонке "Упреждающее обнаружение".
* *Не хочу, чтобы меня донимали этими сообщениями.*
 * Отправляется только одно сообщение в день. Сообщения не отправляются повторно.
* *Если я ничего не сделаю, мне придет напоминание?*
 * Нет, вы получаете сообщение о каждой проблеме только один раз.
* *Не могу найти письмо. Где найти уведомления на портале?*
 * В обзоре приложения службы Application Insights щелкните элемент **Упреждающее обнаружение**. 


## Связанные статьи

* [Обнаружение, рассмотрение, диагностика](app-insights-detect-triage-diagnose.md)
* [Настройка оповещений о метриках](app-insights-alerts.md)
* [Обозреватель метрик](app-insights-metrics-explorer.md)
* [Обозреватель поиска](app-insights-diagnostic-search.md)
 

<!---HONumber=AcomDC_0114_2016-->