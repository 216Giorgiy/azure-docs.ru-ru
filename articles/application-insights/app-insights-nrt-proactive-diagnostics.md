<properties 
	pageTitle="Превентивная диагностика в близком к реальному масштабе времени в Application Insights" 
	description="Превентивная диагностика в близком к реальному масштабе времени автоматически оповещает пользователя о необычном изменении во времени отклика сервера. Настройка не требуется." 
	services="application-insights" 
    documentationCenter=""
	authors="alancameronwills" 
	manager="douge"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/16/2016" 
	ms.author="awills"/>
 
# Превентивная диагностика в близком к реальному масштабе времени

*Эта функция находится на раннем этапе тестирования.*

*Отзывы отправляйте по адресу:* [ainrtpd@microsoft.com](mailto:ainrtpd@microsoft.com)

[Visual Studio Application Insights](app-insights-overview.md) уведомляет вас о существенном увеличении частоты невыполненных запросов в вашем веб-приложении автоматически и в близком к реальному масштабе времени. Для того чтобы вам было проще определить и диагностировать проблему, в уведомление включается анализ характеристик невыполненных запросов и соответствующие данные телеметрии. Кроме того, даются ссылки на портал Application Insights для дальнейшей диагностики. Эта функция не требует настройки или конфигурации, поскольку для прогнозирования нормального уровня сбоев использует алгоритмы машинного обучения. Для работы ей требуется определенный минимальный объем трафика.

Вот пример оповещения:

![Пример умного оповещения, содержащий связанный со сбоем анализ кластера](./media/app-insights-nrt-proactive-diagnostics/010.png)

Чтобы получать оповещения о сбоях, необходимо настроить [Application Insights для ASP.NET](app-insights-asp-net.md) или [для веб-приложения Java](app-insights-java-get-started.md).

## Принцип работы

Диагностика в близком к реальному масштабе времени отслеживает поступающие из вашего приложения данные телеметрии, а именно частоту невыполненных запросов. Обычно это метрика указывает, сколько HTTP-запросов выдали код ответа 400 или выше (при условии, что вы не написали пользовательский код [фильтрации](app-insights-api-filtering-sampling.md#filtering) или собственные вызовы метода [TrackRequest](app-insights-api-custom-events-metrics.md#track-request)).

Опираясь на предыдущее поведение этой метрики, служба прогнозирует ожидаемый диапазон значений. Если фактическое значение намного выше, создается оповещение.

Если выдается оповещение, служба анализирует кластер по различным аспектам запросов и пытается установить, какой шаблон значений характеризует полученные сбои. В приведенном выше примере анализ показал, что большинство сбоев были связаны с определенным именем запроса и не зависели от экземпляра узла или сервера.

Затем анализатор находит исключения и ошибки зависимости, связанные с запросами в установленном кластере, и пример журналов трассировки, связанных с такими запросами.

Итоговый анализ отправляется как сообщение электронной почты (если не настроено иное поведение).

Как и в случае [оповещений, настраиваемых вручную](app-insights-alerts.md), вы можете проверить состояние оповещения и настроить его в соответствующей колонке ресурса Application Insights. В отличие от других оповещений здесь не требуется настройка переменных оповещений о сбоях. При желании адреса электронной почты для отправки оповещений можно отключить или изменить.

## Если вы получили оповещение

Оповещение означает, что в частоте невыполненных запросов обнаружена аномалия. Скорее всего, проблема возникла в приложении или его среде. Возможно, плохо работает новая загруженная вами версия или неисправна какая-либо зависимость, например базы данных или внешнего ресурса.

В зависимости от процента запросов и числа вовлеченных пользователей вы можете решить, насколько срочно необходимо решить проблему.

Зачастую проблему можно быстро диагностировать по имени запроса, исключениям, зависимостям и другим предоставленным данным.

Если же вам требуется более глубокое исследование, ссылки в каждом разделе укажут на [страницу поиска](app-insights-diagnostic-search.md), относящуюся к соответствующему запросу, исключению, зависимости или трассировке. Вы также можете открыть [портал Azure](https://portal.azure.com), перейти к ресурсу Application Insights для своего приложения и открыть колонку "Сбои".

## Просмотр последних оповещений

Чтобы просмотреть оповещения на портале, откройте **Параметры, операционные события**.

![Общие данные оповещения](./media/app-insights-nrt-proactive-diagnostics/040.png)

Щелкните оповещение, чтобы открыть его полные данные.


## Настройка оповещений 

> **UX для настройки пока недоступен.**
> 
> Пишите по адресу [ainrtpd@microsoft.com](mailto:ainrtpd@microsoft.com).
>
> Вот как это может работать:

Откройте страницу "Оповещения". Переменное оповещение о сбое входит в список оповещений, которые вы настроили вручную. Здесь можно увидеть его текущее состояние.

![На странице "Обзор" щелкните плитку оповещения. Либо на любой странице метрики нажмите кнопку "Оповещения".](./media/app-insights-nrt-proactive-diagnostics/020.png)

Щелкните оповещение, чтобы его настроить.

![Конфигурация](./media/app-insights-nrt-proactive-diagnostics/030.png)

Обратите внимание, что переменное оповещение о сбое можно отключить, но нельзя удалить (или создать другое).


## В чем разница?

Превентивная диагностика в близком к реальному масштабе времени дополняет другие похожие, но иные компоненты Application Insights.

* [Оповещения о метриках](app-insights-alerts.md) задаются пользователем и позволяют отслеживать самые разные метрики, включая нагрузку на ЦП, частоту запросов, время загрузки страниц и т. д. Их можно использовать, например, для того, чтобы добавить ресурсы. В свою очередь, превентивная диагностика в близком к реальному масштабе времени охватывает небольшой диапазон критически важных метрик (в настоящее время только частоту невыполненных запросов) и в близком к реальному масштабе времени оповещает пользователя в случае, если частота невыполненных запросов в веб-приложении намного превышает нормальный для этого приложения уровень.
* [Превентивное обнаружение](app-insights-proactive-detection.md) использует искусственный интеллект для обнаружения необычного поведения ваших метрик и не требует настройки. В отличие от превентивной диагностики в близком к реальному масштабе времени, эта функция предназначена для поиска плохо обслуживаемых сегментов вашего приложения, например неправильной работы определенных страниц в определенном типе браузера. Анализ выполняется ежедневно, и обнаруженные результаты обычно не требуют таких срочных действий, как оповещения. Для сравнения анализ данных превентивной диагностики в близком к реальному масштабе времени выполняется постоянно на основе всех поступающих данных телеметрии, и в случае, если частота сбоев сервера намного превысит ожидания, вы получите оповещение в течение нескольких минут.


## Отправляйте нам свои отзывы

*Эта функция находится на раннем этапе тестирования. Нам необходимо узнать ваше мнение о ее работе. Напишите нам по адресу* [ainrtpd@microsoft.com](mailto:ainrtpd@microsoft.com) *или щелкните ссылку на отзыв в тексте оповещения.*

<!---HONumber=AcomDC_0218_2016-->