<properties 
	pageTitle="Отслеживание зависимостей в Application Insights" 
	description="Анализ использования, доступности и производительности локального приложения или веб-приложения Microsoft Azure с помощью Application Insights." 
	services="application-insights" 
    documentationCenter=".net"
	authors="alancameronwills" 
	manager="douge"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="10/08/2015" 
	ms.author="awills"/>


# Настройка Application Insights: веб-страницы


[AZURE.INCLUDE [app-insights-selector-get-started-dotnet](../../includes/app-insights-selector-get-started-dotnet.md)]


Узнайте о производительности и использовании своей веб-страницы. Добавьте Visual Studio Application Insights на свои страницы, и вы узнаете такую информацию, как количество пользователей, как часто они возвращаются на страницу и какие страницы используют чаще всего. Вы также можете получать отчеты о времени загрузки и любых исключениях. Добавляя [пользовательские события и метрики][api], вы сможете детально проанализировать самые популярные функции, распространенные ошибки и настроить свою страницу для успешного использования.

![Последовательно выберите пункты «Создать», «Службы для разработчиков», «Application Insights»](./media/app-insights-asp-net-client/16-page-views.png)

Если телеметрия сервера уже настроена для веб-приложения [ASP.NET](app-insights-asp-net.md) или [Java](app-insights-java-get-started.md), вы сможете получать данные клиента и сервера. На портале Application Insights будут интегрированы два потока.

## Открытие ресурса Application Insights

Войдите на [портал Azure](http://portal.azure.com).

Если вы уже настроили мониторинг приложения на стороне сервера, то у вас уже есть ресурс:

![Последовательно выберите пункты «Обзор», «Службы для разработчиков» и «Application Insights».](./media/app-insights-asp-net-client/01-find.png)

Если ресурса у вас нет, создайте его.

![Последовательно выберите пункты «Создать», «Службы для разработчиков», «Application Insights»](./media/app-insights-asp-net-client/01-create.png)


## Добавление сценария пакета SDK в приложение или на веб-страницу

В разделе «Быстрый запуск» получите сценарий для веб-страниц:

![В колонке обзора приложения последовательно выберите элементы «Быстрый запуск», «Получить код для мониторинга моих веб-страниц». Скопируйте сценарий.](./media/app-insights-asp-net-client/02-monitor-web-page.png)

Вставьте сценарий прямо перед тегом &lt;/head&gt; на каждой странице, которую необходимо отслеживать. Если на вашем веб-сайте есть главная страница, можно разместить скрипт на ней. Например:

* В проекте ASP.NET MVC разместите сценарий на странице View\\Shared\_Layout.cshtml.
* На сайте SharePoint на панели управления откройте [Параметры сайта/Главная страница](app-insights-sharepoint.md).

Сценарий содержит ключ инструментирования, который направляет данные к ресурсу Application Insights.

*(Если вы используете известную платформу веб-страницы, найдите адаптеры Application Insights. Например, [модуль AngularJS](http://ngmodules.org/modules/angular-appinsights).)*


## <a name="run"></a>Запуск приложения

Запустите веб-приложение, используйте его в течение непродолжительного времени для формирования телеметрии и подождите несколько секунд. Вы также можете запустить приложение на компьютере, на котором ведется разработка, нажав клавишу **F5**, или опубликовать и позволить пользователям его использовать.

Если вам надо проверить телеметрию, отправляемую веб-приложением в Application Insights, используйте инструменты отладки браузера (во многих браузерах это можно сделать нажатием клавиши **F12**). Данные отправляются по адресу dc.services.visualstudio.com.

## Изучение данных

В верхней части колонки обзора приложения есть диаграмма, на которой показано среднее время загрузки страницы в браузере:


![](./media/app-insights-asp-net-client/05-browser-page-load.png)


*Еще нет данных? Нажмите кнопку **Обновить** в верхней части страницы. По-прежнему нет данных? См. раздел [Устранение неполадок][qna].*

Щелкните диаграмму, чтобы просмотреть более подробные данные:

![](./media/app-insights-asp-net-client/07-client-perf.png)

Это диаграмма с накоплением, на которой время загрузки страницы разбито на [стандартные отрезки времени, определенные консорциумом W3C](http://www.w3.org/TR/navigation-timing/#processing-model).

![](./media/app-insights-asp-net-client/08-client-split.png)

Обратите внимание, что значение времени *подключения к сети* обычно меньше ожидаемого, так как это среднее значение по всем запросам из браузера на сервер. Для множества отдельных запросов значение времени подключения — «0» из-за наличия активного подключения к серверу.


### Производительность по страницам

Ниже в колонке подробных данных есть сетка, разбитая по URL-адресам страниц:


![](./media/app-insights-asp-net-client/09-page-perf.png)

Если вам нужно увидеть производительность страниц по времени, дважды щелкните сетку и измените тип диаграммы:

![](./media/app-insights-asp-net-client/10-page-perf-area.png)

## Обзор использования клиента

В колонке обзора щелкните **Использование**.

![](./media/app-insights-asp-net-client/14-usage.png)

* **Пользователи** — количество отдельных пользователей за диапазон времени на диаграмме. (Чтобы определить пользователей, возвращающихся на страницу, используются файлы cookie).
* **Сеансы** — сеанс учитывается, если пользователь не выполнял никаких запросов в течение 30 минут.
* **Количество просмотров страницы** — подсчитывается количество вызовов функции trackPageView(), которая обычно вызывается один раз на каждой веб-странице.


### Щелкните, чтобы увидеть больше данных

Щелкните любую диаграмму, чтобы увидеть более подробные данные. Обратите внимание, что диапазоны времени диаграмм можно менять.

![](./media/app-insights-asp-net-client/appinsights-49usage.png)


Щелкните диаграмму, чтоб увидеть метрики, которые она может отобразить, либо добавьте новую диаграмму и выберите метрики, которые она отображает.

![](./media/app-insights-asp-net-client/appinsights-63usermetrics.png)

> [AZURE.NOTE]Метрики могут отображаться только в определенных сочетаниях. При выборе какой-либо метрики все несовместимые метрики будут отключены.



## Настраиваемые счетчики страниц

По умолчанию счетчик страницы увеличивается на единицу каждый раз, когда страница загружается в клиентском браузере. Однако вам может потребоваться подсчитать дополнительные просмотры страницы. Например, если содержимое страницы разбито на вкладки, возможно, вы захотите, чтобы счетчик увеличивался на единицу при каждом переключении между ними. Другой пример — ситуация, когда код JavaScript на странице загружает новое содержимое, но URL-адрес в браузере при этом не меняется.

Вставьте в соответствующем месте клиентского кода вызов JavaScript наподобие следующего:

    appInsights.trackPageView(myPageName);

Имя страницы может содержать те же символы, что и URL-адрес, но все символы после "#" или "?" игнорируются.


## Изучение отдельных событий просмотра страницы

Обычно телеметрия просмотра страниц анализируется службой Application Insights, и вы видите только сводные отчеты со средними значениями для всех пользователей. Однако в целях отладки можно также изучать отдельные события просмотра страниц.

В колонке Diagnostic Search (Поиск данных диагностики) в разделе Filter (Фильтр) установите флажок Page View (Просмотр страниц).

![](./media/app-insights-asp-net-client/12-search-pages.png)

Выберите любое событие, чтобы просмотреть подробные сведения. На странице сведений нажмите кнопку «...», чтобы открыть еще более подробные сведения.

> [AZURE.NOTE]Если вы используете [Поиск][diagnostic], обратите внимание, что вы должны сопоставлять слова целиком: «Пр» и «о» не соответствуют «Про», в отличие от «Пр*». Поисковый запрос нельзя начинать с подстановочного знака. Например, по запросу "*нформаци" не будет найдено слово "Информация".

> [Дополнительная информация о поиске диагностических данных][diagnostic]

### Свойства просмотра страниц

* **Длительность просмотра страницы**&#151 время, необходимое для загрузки страницы и запуска сценариев. В частности, имеется в виду промежуток времени между началом загрузки страницы и выполнением сценария trackPageView. Если после инициализации сценария trackPageView вы переместили его из обычного положения, значение будет иным.

## Отслеживание использования элементов пользователями

Хотите узнать, что пользователи делают в вашем приложении? Вставив вызовы в коде клиента и сервера, вы можете отправить свою телеметрию в Application Insights. Например, вы можете выяснить, сколько пользователей создали заказы, но не завершили их, какие ошибки проверки возникают наиболее часто или среднее количество очков, набранных пользователями в игре.

* [Дополнительная информация о пользовательских событиях и метриках API][api].
* [Справочник по API](https://github.com/Microsoft/ApplicationInsights-JS/blob/master/API-reference.md)




## <a name="video"></a>Видео «Отслеживание использования»

> [AZURE.VIDEO tracking-usage-with-application-insights]

## <a name="next"></a>Дальнейшие действия

- [Установка пакета SDK](../article/application-insights/app-insights-asp-net.md#selector1)
- [Отслеживание использования приложения с помощью пользовательских событий и метрик][api]
- [Доступность](../article/application-insights/app-insights-monitor-web-app-availability.md#selector1)
- [Уже живое приложение](../article/application-insights/app-insights-monitor-performance-live-website-now.md)

<!--Link references-->

[api]: app-insights-api-custom-events-metrics.md
[apikey]: app-insights-api-custom-events-metrics.md#ikey
[availability]: app-insights-monitor-web-app-availability.md
[azure]: ../insights-perf-analytics.md
[client]: app-insights-asp-net-client.md
[detect]: app-insights-detect-triage-diagnose.md
[diagnostic]: app-insights-diagnostic-search.md
[knowUsers]: app-insights-overview-usage.md
[metrics]: app-insights-metrics-explorer.md
[netlogs]: app-insights-asp-net-trace-logs.md
[perf]: app-insights-web-monitor-performance.md
[portal]: http://portal.azure.com/
[qna]: app-insights-troubleshoot-faq.md
[redfield]: app-insights-monitor-performance-live-website-now.md
[roles]: app-insights-resources-roles-access-control.md
[start]: app-insights-overview.md


 

<!---HONumber=Nov15_HO4-->