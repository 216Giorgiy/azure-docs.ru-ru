<properties linkid="websites-global-web-presence" urlDisplayName="Создание глобального веб-присутствия на веб-сайтах Azure" pageTitle="Создание глобального веб-присутствия на веб-сайтах Azure" metaKeywords="" description="В этом руководстве представлены технические сведения о размещении сайта вашей организации (.COM) на веб-сайтах Azure. Под размещением понимаются развертывание, пользовательские домены, SSL и мониторинг." metaCanonical="http://www.windowsazure.com/ru-ru/documentation/articles/web-sites-global-web-presence-solution-overview/" services="" documentationCenter="" title="Создание глобального веб-присутствия на веб-сайтах Azure" authors="jroth" solutions="" manager="paulettm" editor="mollybos" />





# Создание глобального веб-присутствия на веб-сайтах Azure

В этом руководстве представлены технические сведения о размещении сайта вашей организации (.COM) в Azure. Этот сценарий также называют глобальным веб-присутствием. В этом руководстве основное внимание уделяется использованию [веб-сайтов Azure][websitesoverview], поскольку веб-сайты представляют собой самый быстрый и самый простой способ создания, переноса, масштабирования и управления для веб-приложения на платформе Azure. Тем не менее, требования, предъявляемые к некоторым приложениям, делают удобным их размещение в [облачных службах Azure][csoverview] или в [виртуальных машинах Azure][vmoverview] с использованием IIS. Эти варианты также являются отличным выбором для размещения веб-приложений. Если вы находитесь на начальной стадии планирования, ознакомьтесь с документом [Веб-сайты Azure, облачные службы и виртуальные машины: когда они используются?][chooseservice]. В отсутствие необходимости использовать облачные службы или виртуальные машины рекомендуется использовать веб-сайты для своего глобального веб-присутствия. Остальная часть этого документа содержит рекомендации по использованию веб-сайтов в этом сценарии. 

В этом руководстве рассматриваются следующие вопросы:

- [Создание веб-сайта Azure](#createwebsite)
- [Развертывание веб-сайта](#deploywebsite)
- [Добавление пользовательского домена](#customdomain)
- [Обеспечение безопасности веб-сайта с помощью SSL](#ssl)
- [Мониторинг сайта](#monitor)

<div class="dev-callout">
<strong>Примечание.</strong>
<p>В этом руководстве представлены некоторые из наиболее распространенных вопросов и задач, связанных с разработкой общедоступных сайтов .COM. Но существуют и другие возможности веб-сайтов Azure, которые можно использовать в конкретной реализации. Для анализа этих возможностей также можно воспользоваться другими руководствами: <a href="http://www.windowsazure.com/ru-ru/manage/services/web-sites/digital-marketing-campaign-solution-overview">Цифровая маркетинговая кампания</a> и <a href="http://www.windowsazure.com/ru-ru/manage/services/web-sites/business-application-solution-overview">Бизнес-приложения</a>.</p>
</div>

##<a name="createwebsite"></a>Создание веб-сайта Azure
С помощью портала управления Azure можно создать новый веб-сайт Azure несколькими способами. При нажатии в нижней части окна портала кнопки **Далее** появится следующее диалоговое окно:

![GlobalWebCreate][GlobalWebCreate]

Существует три варианта для создания нового веб-сайта: **Быстрое создание**, **Настраиваемое создание** и **Из коллекции**. Для каждого из этих вариантов следует выбрать регион Azure, соответствующий основной части базы пользователей.

При переносе существующего веб-сайта вариант **Настраиваемое создание** позволяет создать или связать с сайтом базу данных SQL или базу данных MySQL. Этот вариант также предоставляет возможность указать несколько вариантов системы управления версиями для развертывания, например GitHub или Team Foundation Server (TFS). Если для управления веб-сайтом уже используется механизм управления версиями, это позволит быстро настроить веб-сайт Azure для развертывания.

Вариант **Из коллекции** используется для создания нового сайта с помощью одной из нескольких платформ, таких как Drupal или WordPress. Это может быть полезно для быстрой настройки нового сайта, который затем можно настроить в выбранной структуре.

Как в случае большинства служб в Azure, для нового веб-сайта необходимо выбрать регион Azure. В Azure есть несколько регионов, расположенных по всему миру. После развертывания веб-сайта для любого одного региона этот сайт становится доступным глобально в Интернете. Но наличие нескольких регионов обеспечивает большую гибкость. Одним из очевидных преимуществ является развертывание сайтов в регионах, максимально близких к пользователям. 

Подробные инструкции по созданию нового веб-сайта см. в статье [Создание и развертывание веб-сайта][howtocreatewebsites].

##<a name="deploywebsite"></a>Развертывание веб-сайта
Существует несколько способов развертывания веб-сайта в Azure. При выборе платформы из коллекции начальный вариант сайта уже оказывается развернут. Но для дальнейшего развития по-прежнему необходимо настроить ряд процедур редактирования и развертывания. Ниже перечислены некоторые возможные варианты развертывания:

- Использование клиента FTP.
- Развертывание из системы управления версиями.
- Публикация из Visual Studio.
- Публикация из [WebMatrix][webmatrix].

У каждого из этих вариантов есть свои преимущества. Возможность публикации из FTP-клиента — это простой и удобный способ передачи новых файлов на веб-сайт. Это также означает, что с веб-сайтами Azure можно продолжить использовать любые существующие средства публикации и процессы, основанные на FTP. Система управления версиями обеспечивает наилучшее управление версиями контента веб-сайта, поскольку она позволяет отслеживать и публиковать изменения и при необходимости возвращаться к предыдущим версиям. Варианты публикации прямо из Visual Studio или Web Matrix удобны для разработчиков, использующих любое из этих средств. Полезным сценарием использования этой возможности является ее применение на ранних этапах проекта или для создания прототипов. В обоих случаях частые публикации и тестирование потенциально удобнее выполнять из среды разработки. 

Многие описываемые здесь задачи развертывания подразумевают использование информации на портале управления Azure. Перейдите к своему веб-сайту, выберите вкладку **Панель мониторинга** и найдите раздел **Краткое описание**. На следующем снимке экрана показано несколько вариантов.

![GlobalWebQuickGlance][GlobalWebQuickGlance]

Для доступа к некоторым средствам управления версиями и клиентам FTP требуются имя пользователя и пароль. Для нового веб-сайта учетные данные не создаются автоматически. Но их можно легко создать, щелкнув **Сброс учетных данных развертывания**. После выполнения этого действия можно использовать любой клиент FTP для развертывания веб-сайта, применяя эти учетные данные вместе со значением **Имя узла FTP** на той же странице **Панель мониторинга**.

![GlobalWebFTPSettings][GlobalWebFTPSettings]

Обратите внимание, что имя пользователя развертывания/FTP является сочетанием имени веб-сайта и введенного имени пользователя. Таким образом, если вашим сайтом является "http://contoso.azurewebsite.net", а именем пользователя веб-сайта — "myuser", именем пользователя для развертывания и FTP будет "contoso\myuser".

Можно также выполнить развертывание с помощью службы управления версиями, такой как GitHub или TFS Online. Выберите вариант **Настроить развертывания в системе управления версиями**. Далее следуйте инструкциям для выбранной системы управления версиями или службы. Пошаговые инструкции для публикации из локального репозитория Git см. в статье [Публикация из системы управления версиями на веб-сайты Azure][publishingwithgit].

Если для создания и управления веб-сайтом планируется использовать Visual Studio, можно выполнять публикацию прямо из Visual Studio. Первый способ — нажать кнопку **Загрузить профиль публикации**. Это позволяет сохранить файл publishsettings, который можно импортировать в Visual Studio для веб-публикации. 

<div class="dev-callout">
<strong>Примечание.</strong>
<p>Важно обеспечить безопасное хранение файла <i>publishsettings</i> вне системы управления версиями, так как он содержит имена пользователей и пароли для развертывания, а также все связанные строки подключения к базе данных.</p>
</div>

Также импортировать сведения о подписке прямо в Visual Studio. Например, рассмотрим локальный проект ASP.NET в Visual Studio. Щелкните правой кнопкой мыши веб-проект и выберите **Опубликовать**. Кнопка **Импорт** в диалоговом окне **Публикация веб-сайта** позволяет импортировать либо файл, содержащий параметры подписки Azure, либо файл publishsettings, загруженный из панели мониторинга веб-сайтов. Эти варианты показаны на следующем снимке экрана.

![GlobalWebVSPublish][GlobalWebVSPublish]

Дополнительные сведения о публикации в Azure из Visual Studio см. в статье "Развертывание веб-приложения ASP.NET на веб-сайте Azure". 

Еще одним вариантом для разработки и развертывания является использование WebMatrix на портале управления Azure.

![GlobalWebWebMatrix][GlobalWebWebMatrix]

Дополнительные сведения об этом варианте см. в статье [Разработка и развертывание веб-сайта с помощью Microsoft WebMatrix][aspnetgetstarted].

Хотя эти действия содержат все необходимое для развертывания сайта .COM, следует также создать план управления циклом текущих публикаций контента. Возможные варианты могут варьироваться от развертывания пользовательского решения и периодических повторных развертываний для редко меняющегося сайта до полнофункциональной системы управления контентом (CMS). При создании нового веб-сайта следует отметить, что в коллекции есть варианты, позволяющие использовать существующие платформы CMS, такие как [Drupal][drupal] или [Umbraco][umbraco].

##<a name="customdomain"></a>Добавление пользовательского домена
В случае глобального веб-присутствия понадобится связать с веб-сайтом зарегистрированное имя домена. Существует множество независимых поставщиков, предоставляющих услуги регистрации домена. Каждый из этих поставщиков поддерживает создание различных типов записей DNS для управления вашим доменом. Запись DNS позволяет сопоставлять понятный URL-адрес, например "www.contoso.com", фактическому URL-адресу или IP-адресу узла, на котором размещен веб-сайт. 

<div class="dev-callout">
<strong>Примечание.</strong>
<p>Ниже рассматривается два интересующих типа записей DNS. Во-первых, запись CNAME может обеспечивать перенаправление с одного URL-адреса, например "www.contoso.com", на другой URL-адрес, например "contoso.azurewebsites.net". Во-вторых, запись A можно сопоставить URL-адрес, например "www.contoso.com", IP-адресу, например 172.16.48.1.</p>
</div>

В случае веб-сайтов Azure сначала необходимо создать запись CNAME, указывающую на веб-сайт Azure. Для этого используется сайт независимого регистратора. Ниже приведен пример записи CNAME.

<table cellspacing="0" border="1">
<tr>
   <th align="left" valign="top">Тип</th>
   <th align="left" valign="top">Узел</th>
   <th align="left" valign="top">Ответ</th>
   <th align="left" valign="top">Срок жизни</th>
</tr>
<tr>
   <td valign="top"><strong>CNAME</strong></td>
   <td valign="top">www.contoso.com</td>
   <td valign="top">contoso.azurewebsites.net</td>
   <td valign="top">8000</td>
</tr>
</table>

Если домен регистрируется заново, его разрешение на всех DNS-серверах, которые кэшируют DNS-записи, может занять от одного дня и больше. Но если домен уже существует, изменение записи CNAME должно выполняться в течение минуты. Обратите внимание, что запись CNAME обеспечивает сопоставление домена (в котором должен указываться псевдоним поддомена, например "www") URL-адресу веб-сайта Azure. Ни одна из сторон записи CNAME не содержит префикс "http://".

На портале управления Azure убедитесь, что используется режим **В общем доступе** или **Стандартный**, с помощью вкладки **Масштаб** (пользовательские домены не поддерживаются для веб-сайтов в режиме **Бесплатный**). Затем перейдите на вкладку **Настройка** и нажмите кнопку **Управление доменами**. Это позволяет связать веб-сайт с пользовательским именем домена. 

![GlobalWebWebMatrix][GlobalWebWebMatrix]

Перед помещением в список своего пользовательского домена необходимо сначала обратиться к поставщику DNS и создать запись CNAME для своего пользовательского домена (www.contoso.com), указывающую на URL-адрес веб-сайта Azure (contoso.azurewebsites.net). После ее распространения можно ввести пользовательский домен в диалоговом окне, показанном на предыдущем снимке экрана. Наличие записи CNAME для www.contoso.com, указывающей на этот веб-сайт, гарантирует наличие у вас прав использовать это имя домена с этим веб-сайтом. В этот момент в нижней части диалогового окна можно создать запись A с IP-адресом.

<table cellspacing="0" border="1">
<tr>
   <th align="left" valign="top">Тип</th>
   <th align="left" valign="top">Узел</th>
   <th align="left" valign="top">Ответ</th>
   <th align="left" valign="top">Срок жизни</th>
</tr>
<tr>
   <td valign="top"><strong>A</strong></td>
   <td valign="top">contoso.com</td>
   <td valign="top">172.16.48.1</td>
   <td valign="top">8000</td>
</tr>
</table>

Дополнительные сведения см. в разделе [Задание пользовательского имени домена для веб-сайта Azure][customdns].

##<a name="ssl"></a>Обеспечение безопасности веб-сайта с помощью SSL
Если сайт содержит данные только для чтения, необязательно обеспечивать безопасный доступ к этому веб-сайту. Но, если нужно собирать любые сведения о пользователях, вести электронную торговлю или управлять другими важными данными следует защитить этот сайт. Безопасность — это большая тема, и в этой статье невозможно рассказать обо всех рекомендациях и методах. Тем не менее, важно выделить процесс включения протокола SSL для веб-сайта. SSL позволяет пользователям подключаться к сайту шифрованным образом, используя адреса HTTPS вместо HTTP. Существуют специфические действия, необходимые для использования протокола SSL с веб-сайтами Azure. 

Веб-сайты Azure автоматически обеспечивают безопасное подключение к фактическому URL-адресу сайта. Например, если используется веб-сайт http://contoso.azurewebsites.net, можно подключиться по протоколу SSL, просто изменив "http" на "https", как в **https**: / / contoso.azurewebsites.net.

Но при использовании имени пользовательского домена необходимо выполнить ряд действий для загрузки сертификата и включения SSL для веб-сайта на портале управления Azure. Ниже приведен краткий обзор этого процесса, но подробные инструкции можно найти в разделе [Настройка SSL-сертификата для веб-сайта Azure][ssl].

Во-первых, получите SSL-сертификат в центре сертификации. Если нужно защитить домен с несколькими поддоменами (например, www.contoso.com и staging.contoso.com), понадобится получить групповой сертификат (*.contoso.com). Это может стоить дороже, поэтому необходимо решить, оправдывает ли гибкость сертификата этого типа возможные расходы.

Полученный от центра сертификации сертификат нельзя просто загрузить в Azure в том же формате. Необходимо с помощью команды openssl создать PFX-файл. Команда openssl является частью проекта OpenSSL. Исходные коды распространяются на [веб-сайте OpenSSL][openssl], но уже скомпилированные версии средства обычно можно также найти в Интернете. В следующем примере для создания PFX-файла используются сертификат, myserver.crt и файл закрытого ключа.

	openssl pkcs12 -export -out myserver.pfx -inkey myserver.key -in myserver.crt

Чтобы отправить сертификат в Azure, сначала перейдите на вкладку **Масштаб** и убедитесь, что используется режим **Стандартный**. SSL для пользовательских доменов в режимах **Бесплатный** и **В общем доступе** не поддерживается. На вкладке **Настройка** нажмите кнопку **Загрузить сертификат**.

![GlobalWebUplodateCert][GlobalWebUplodateCert]

Затем в разделе **SSL-привязки** сопоставьте сертификат имени домена, которое защищает этот сертификат. Существует два варианта данного сопоставления: SNI SSL и SSL на основе IP-адреса.

![GlobalWebSSLBindings][GlobalWebSSLBindings]

Вариант **SSL на основе IP-адреса** — это традиционный способ сопоставления открытого выделенного IP-адреса и имени домена. Этот способ работает со всеми браузерами. Вариант **SNI SSL** позволяет нескольким доменам совместно использовать один и тот же IP-адрес и применять для каждого домена различные связанные сертификаты SSL. SNI SSL не поддерживает некоторые старые браузеры (дополнительные сведения о совместимости см. в [записи Википедии о SNI SSL][sni]). С каждым сертификатом SSL связана ежемесячная оплата (рассчитываемая почасовым образом), и цены зависят от выбора SSL на основе IP-адреса или SNI SSL. Сведения о ценах см. в разделе [Сведения о ценах — веб-сайты][sslpricing]. Дополнительные сведения об этом процессе см. в разделе [Настройка SSL-сертификата для веб-сайта Azure][ssl].

##<a name="monitor"></a>Мониторинг сайта
Когда веб-сайт активно обрабатывает запросы пользователей, важно использовать мониторинг. Например, может понадобиться знать, приводит ли пользовательская нагрузка к высокой загрузке ЦП, что может указывать на необходимость масштабирования сайта. Либо неэффективность приложения может увеличить время ответа или привести к ошибкам. В этом разделе рассматриваются некоторые из встроенных возможностей мониторинга портала управления Azure.

Вкладка **Монитор** содержит ряд ключевых показателей для веб-сайта в графическом формате. 

![GlobalWebMonitor1][GlobalWebMonitor1]

Метрики в этой диаграмме можно настроить с помощью кнопки "Добавить метрики".

![GlobalWebMonitor2][GlobalWebMonitor2]

Для сайтов, работающих в режиме **Стандартный**, можно также включить мониторинг конечных точек и соответствующее оповещение. На вкладке **Настройка** перейдите в раздел **Мониторинг** и настройте конечную точку. Эта конечная точка выполняется из одного или нескольких указанных местоположений и периодически пытается получить доступ к веб-сайту. Собираются сведения о времени и ошибках. 

На вкладке **Монитор** эта конечная точка появляется, показывая время ответа. После выбора метрики конечной точки можно добавить правило оповещения, щелкнув значок **Добавить правило**.

![GlobalWebMonitor3][GlobalWebMonitor3]

Правило может обеспечить оповещение по электронной почте администраторов или других пользователей, когда время ответа превышает заданный порог.

![GlobalWebMonitor4][GlobalWebMonitor4]

Если обнаружено, что требуется масштабирование веб-сайта, это можно выполнить на вкладке **Масштаб** либо вручную, либо с помощью предварительной версии функции автомасштабирования. Вкладка "Масштаб" содержит варианты как для вертикального масштабирования (увеличение числа выделенных машин), так и для горизонтального масштабирования (дополнительные общие экземпляры или выделенные экземпляры того же размера). Предварительная версия автомасштабирования поддерживает только горизонтальное масштабирование. Дополнительные сведения об этом варианте и мониторинге веб-сайта см. в разделе "Масштабирование в соответствии с пользовательским спросом" сценария [Цифровая маркетинговая кампания][scenariodigitalmarketing]. Кроме того, см. [Мониторинг веб-сайтов][howtomonitor].

##<a name="summary"></a>Сводка
К стандартным задачам создания сайта организации (.COM) относятся выбор платформы разработки, создание сайта, его развертывание, назначение пользовательского домена и мониторинг. Для сайтов, которые должны защищать пользовательские данные, настоятельно рекомендуется использовать SSL. В данной статье предоставлен обзор выполнения этих задач с помощью веб-сайтов Azure. Дополнительные сведения см. в следующих технических статьях, ссылки на которые содержит данный документ.

<table cellspacing="0" border="1">
<tr>
   <th align="left" valign="top">Область</th>
   <th align="left" valign="top">Ресурсы</th>
</tr>
<tr>
   <td valign="middle"><strong>План</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/manage/services/web-sites/choose-web-app-service">Веб-сайты Azure, облачные службы и виртуальные машины: когда они используются?</a></td>
</tr>
<tr>
   <td valign="middle"><strong>Создание</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/manage/services/web-sites/how-to-create-websites/">Создание и развертывание веб-сайта</a></td>
</tr>
<tr>
   <td valign="middle"><strong>Развертывание</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/develop/net/common-tasks/publishing-with-git/">Публикация из системы управления версиями на веб-сайты Azure</a><br/>- <a href="http://www.windowsazure.com/ru-ru/develop/net/tutorials/get-started/">Развертывание веб-приложения ASP.NET на веб-сайте Azure</a><br/>- <a href="http://www.windowsazure.com/ru-ru/develop/net/tutorials/website-with-webmatrix/">Разработка и развертывание веб-сайта с помощью Microsoft WebMatrix</a></td>
</tr>
<tr>
   <td valign="middle"><strong>Пользовательские домены</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/develop/net/common-tasks/custom-dns-web-site/">Настройка пользовательского имени домена для веб-сайта Azure</a></td>
</tr>
<tr>
   <td valign="middle"><strong>SSL</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/develop/net/common-tasks/enable-ssl-web-site/">Настройка сертификата SSL для веб-сайта Azure</a></td>
</tr>
<tr>
   <td valign="middle"><strong>Монитор</strong></td>
   <td valign="top">- <a href="http://www.windowsazure.com/ru-ru/manage/services/web-sites/how-to-monitor-websites/">Как отслеживать веб-сайты</a></td>
</tr>
</table>

  [websitesoverview]:/ru-ru/documentation/services/web-sites/
  [csoverview]:/ru-ru/documentation/services/cloud-services/
  [vmoverview]:/ru-ru/documentation/services/virtual-machines/
  [chooseservice]:/ru-ru/manage/services/web-sites/choose-web-app-service
  
  
  [scenariodigitalmarketing]:/ru-ru/manage/services/web-sites/digital-marketing-campaign-solution-overview
  [howtocreatewebsites]:/ru-ru/manage/services/web-sites/how-to-create-websites/
  [webmatrix]:http://www.microsoft.com/web/webmatrix/
  [publishingwithgit]:/ru-ru/develop/net/common-tasks/publishing-with-git/
  [aspnetgetstarted]:/ru-ru/develop/net/tutorials/get-started/
  [drupal]:https://drupal.org/
  [umbraco]:http://umbraco.com/
  [customdns]:/ru-ru/develop/net/common-tasks/custom-dns-web-site/
  [ssl]:/ru-ru/develop/net/common-tasks/enable-ssl-web-site/
  [openssl]:http://www.openssl.org/
  [sni]:http://en.wikipedia.org/wiki/Server_Name_Indication
  [sslpricing]:/ru-ru/pricing/details/web-sites/#service-ssl
  [howtomonitor]:/ru-ru/manage/services/web-sites/how-to-monitor-websites/
  
 [GlobalWebCreate]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Create.png
  [GlobalWebQuickGlance]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_QuickGlance.png
  [GlobalWebMonitor1]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Monitor1.png
  [GlobalWebMonitor2]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Monitor2.png
  [GlobalWebMonitor3]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Monitor3.png
  [GlobalWebMonitor4]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Monitor4.png
  [GlobalWebVSPublish]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_VS_Publish.png
  [GlobalWebSSLBindings]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_SSL_Bindings.png
  [GlobalWebUplodateCert]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_Uplodate_Cert.png
  [GlobalWebCustomDomain]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_CustomDomain.png
  [GlobalWebWebMatrix]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_WebMatrix.png
  [GlobalWebFTPSettings]: ./media/web-sites-global-web-presence-solution-overview/GlobalWeb_FTPSettings.png
  
  
  
  
  
  
  
  
  
  
  

