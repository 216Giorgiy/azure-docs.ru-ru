<properties 
	pageTitle="Шаг 3. Создание эксперимента машинного обучения | Microsoft Azure" 
	description="Третий этап пошагового руководства по разработке прогнозного решения: создание эксперимента обучения в студии машинного обучения Azure." 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="04/22/2015" 
	ms.author="garye"/>


# Шаг 3. Создание эксперимента машинного обучения Azure

Это третий шаг из пошагового руководства [Разработка прогнозирующего решения с помощью Azure ML](machine-learning-walkthrough-develop-predictive-solution.md).


1.	[Создание рабочей области машинного обучения](machine-learning-walkthrough-1-create-ml-workspace.md)
2.	[Отправка существующих данных](machine-learning-walkthrough-2-upload-data.md)
3.	**Создание нового эксперимента**
4.	[Обучение и анализ моделей](machine-learning-walkthrough-4-train-and-evaluate-models.md)
5.	[Публикация веб-службы](machine-learning-walkthrough-5-publish-web-service.md)
6.	[Доступ к веб-службе](machine-learning-walkthrough-6-access-web-service.md)

----------

Нам необходимо создать новый эксперимент в ML Studio с использованием отправленного набора данных.

1.	В ML Studio нажмите **+СОЗДАТЬ** внизу окна.
2.	Выберите **ЭКСПЕРИМЕНТА**, а затем выберите «Пустой эксперимент». В верхней части холста выберите имя эксперимента по умолчанию и присвойте ему понятное имя.
3.	На палитре модулей слева от полотна эксперимента разверните **Saved Datasets** (Сохраненные наборы данных).
4.	Найдите созданный набор данных и перетащите его на полотно. Набор данных можно также отыскать, введя имя в поле **Поиск** над палитрой.  

##Подготовка данных
Чтобы просмотреть первые 100 строк данных и некоторую статистическую информацию для всего набора данных, щелкните правой кнопкой мыши выходной порт набора данных и выберите **Визуализировать**. Обратите внимание, что в ML Studio уже определены типы данных для каждого столбца. Также присвоены универсальные заголовки столбцам, так как файл данных поступил без заголовков столбцов.

Заголовки столбцов не имеют существенного значения, однако они облегчат работу с данными в модели. Кроме того, при последующей публикации этой модели в веб-службе заголовки помогут определять столбцы пользователям службы.

Заголовки столбцов можно добавить с помощью модуля [Редактор метаданных][metadata-editor]. Модуль [редактора метаданных][metadata-editor] используется для изменения метаданных, связанных с набором данных. В этом случае он позволяет предоставить более понятные имена заголовков столбцов. Для этого мы применим [редактор метаданных][metadata-editor] ко всем столбцам, а затем подготовим список имен, которые будут добавлены в столбцы.

1.	В палитре модуля введите "metadata" в поле **Поиск**. В списке модуля будет присутствовать [Редактор метаданных][metadata-editor].
2.	Щелкните и перетащите модуль [Редактор метаданных][metadata-editor] на полотно и вставьте его под набором данных.
3.	Подключение набора данных к [редактору метаданных][metadata-editor]: щелкните выходной порт набора данных, перетащите во входной порт [редактора метаданных][metadata-editor] и отпустите кнопку мыши. Набор данных и модуль останутся подключенными даже при их перемещении по полотну.
4.	Пока [редактор метаданных][metadata-editor] по-прежнему выбран, на панели **Свойства** справа от полотна щелкните **Запустить средство выбора столбцов**.
5.	В диалоговом окне **Выбор столбцов** выберите в поле **Начинаются с** значение «Все столбцы».
6.	Строка под полем **Начинаются с** позволяет включить или исключить определенные столбцы из области действия [редактора метаданных][metadata-editor]. Поскольку нам требуется изменить все столбцы, удалите эту строку, нажав кнопку «минус» («-») в правой части строки. Диалоговое окно должно выглядеть следующим образом: ![Селектор столбцов, где выделены все столбцы][4]
7.	Установите флажок **ОК**. 
8.	В панели **Свойства** найдите параметр **Новое имя столбца**. В этом поле введите список имен для 21 столбца набора данных с разделителями-запятыми и в порядке расположения столбцов. Вы можете получить имена столбцов из документации по наборам данных на веб-сайте UCI или скопировать и вставить следующее:  

		Status of checking account, Duration in months, Credit history, Purpose, Credit amount, Savings account/bond, Present employment since, Installment rate in percentage of disposable income, Personal status and sex, Other debtors, Present residence since, Property, Age in years, Other installment plans, Housing, Number of existing credits, Job, Number of people providing maintenance for, Telephone, Foreign worker, Credit risk  

Панель свойств будет выглядеть следующим образом:

![Свойства редактора метаданных][1]

> [AZURE.TIP]Если необходимо проверить заголовки столбцов, запустите эксперимент (нажмите кнопку **ВЫПОЛНИТЬ** под полотном эксперимента), щелкните правой кнопкой мыши выходной порт модуля [Редактор метаданных][metadata-editor] и выберите **Визуализировать**. Аналогичным образом можно просматривать выход любого модуля, чтобы следить за ходом использования данных в эксперименте.

Теперь наш эксперимент должен выглядеть следующим образом:

![Добавление редактора метаданных][2]
 
##Создание обучающих и тестовых наборов данных
На следующем шаге эксперимента создаются отдельные наборы данных, которые будут использоваться для обучения и тестирования модели. Для этого используется модуль [Разделение][split].

1.	Отыщите модуль [Разделение][split] перетащите его на полотно и подключите к последнему модулю [редактор метаданных][metadata-editor].
2.	По умолчанию коэффициент разделения равен 0,5 и задан параметр **Randomized split** (Случайное разделение). Это означает, что случайная половина данных будет выходить через один порт модуля [Разделение][split], а вторая половина — через другой. Можно это отрегулировать, а также использовать параметр **Псевдослучайные числа**, чтобы изменить соотношение между данными для обучения и оценки. Для этого примера оставим их как есть.
	> [AZURE.TIP]  
	
Выходы модуля [Разделение][split] можно использовать по своему усмотрению. Однако предлагаем использовать левый выход для данных для обучения, а правый — для данных для оценки.

Как отмечалось на веб-сайте UCI, стоимость неверной классификации высокого кредитного риска как низкого в 5 раз выше, чем стоимость неверной классификации низкого кредитного риска как высокого. Чтобы это учесть, создадим новый набор данных, отражающий эту функцию стоимости. В новом наборе данных каждый пример высокого риска реплицируется 5 раз, а каждый пример низкого риска не реплицируется.

Эту репликацию можно выполнить с помощью кода R:

1.	Отыщите и перетащите модуль [Выполнение скрипта R][execute-r-script] на полотно эксперимента и подключите к левому выходному порту модуля [Разделение][split].
2.	На панели **Свойства** удалите текст по умолчанию в параметре **Скрипт** и введите следующий скрипт: 

		dataset1 <- maml.mapInputPort(1)
		data.set<-dataset1[dataset1[,21]==1,]
		pos<-dataset1[dataset1[,21]==2,]
		for (i in 1:5) data.set<-rbind(data.set,pos)
		maml.mapOutputPort("data.set")


Необходимо проделать ту же операцию репликации для каждого выхода модуля [Разделение][split], чтобы данные для обучения и оценки получили одинаковую корректировку стоимости.

1.	Щелкните правой кнопкой мыши модуль [Выполнение скрипта R][execute-r-script] и выберите **Копировать**.
2.	Щелкните правой кнопкой мыши полотно эксперимента и выберите **Вставить**.
3.	Подключите модуль [Выполнение скрипта R][execute-r-script] к правому выходному порту модуля [Разделение][split].  

> [AZURE.TIP]Копия модуля "Выполнение скрипта R" содержит тот же скрипт, что и исходный модуль. При копировании и вставке модуля на полотно копия сохраняет все свойства оригинала.
>
Наш эксперимент теперь выглядит приблизительно следующим образом:
 
![Добавление модуля Разделение и скриптов R][3]

Подробнее об использовании сценариев R в экспериментах см. в разделе [Расширение эксперимента с R](machine-learning-extend-your-experiment-with-r.md).

**Далее: [обучение и анализ моделей](machine-learning-walkthrough-4-train-and-evaluate-models.md)**


[1]: ./media/machine-learning-walkthrough-3-create-new-experiment/create1.png
[2]: ./media/machine-learning-walkthrough-3-create-new-experiment/create2.png
[3]: ./media/machine-learning-walkthrough-3-create-new-experiment/create3.png
[4]: ./media/machine-learning-walkthrough-3-create-new-experiment/columnselector.png


<!-- Module References -->
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
[metadata-editor]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/
 

<!---HONumber=July15_HO2-->