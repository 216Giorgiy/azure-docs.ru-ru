<properties
    pageTitle="Шаг 3. Создание эксперимента машинного обучения | Microsoft Azure"
    description="Третий этап пошагового руководства по разработке прогнозного решения: создание эксперимента обучения в студии машинного обучения Azure."
    services="machine-learning"
    documentationCenter=""
    authors="garyericson"
    manager="jhubbard"
    editor="cgronlun"/>

<tags
    ms.service="machine-learning"
    ms.workload="data-services"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/05/2016" 
    ms.author="garye"/>



# <a name="walkthrough-step-3:-create-a-new-azure-machine-learning-experiment"></a>Шаг 3. Создание эксперимента машинного обучения Azure

Это третий этап из пошагового руководства [Разработка решения для прогнозной аналитики в службе машинного обучения Azure](machine-learning-walkthrough-develop-predictive-solution.md)


1.  [Создание рабочей области машинного обучения](machine-learning-walkthrough-1-create-ml-workspace.md)
2.  [Отправка существующих данных](machine-learning-walkthrough-2-upload-data.md)
3.  **Создание нового эксперимента**
4.  [Обучение и анализ моделей](machine-learning-walkthrough-4-train-and-evaluate-models.md)
5.  [Развертывание веб-службы](machine-learning-walkthrough-5-publish-web-service.md)
6.  [Доступ к веб-службе](machine-learning-walkthrough-6-access-web-service.md)

----------

Следующим этапом в этом пошаговом руководстве является создание эксперимента в студии машинного обучения, который использует отправленный набор данных.  

1.  В студии машинного обучения щелкните **+СОЗДАТЬ** в нижней части окна.
2.  Выберите **ЭКСПЕРИМЕНТА**, а затем выберите "Пустой эксперимент". В верхней части холста выберите имя эксперимента по умолчанию и присвойте ему понятное имя.

    > [AZURE.TIP] Рекомендуем заполнить поля **Сводка** и **Описание** для эксперимента в области **Свойства**. Эти свойства позволят вам задокументировать эксперимент, чтобы любой, кто откроет его позднее, смог понять ваши цели и методы.

3.  На палитре модулей слева от полотна эксперимента разверните **Saved Datasets**(Сохраненные наборы данных).
4.  Найдите набор данных, созданный в разделе **Мои наборы данных** , и перетащите его на холст. Набор данных можно также отыскать, введя имя в поле **Поиск** над палитрой.  

##<a name="prepare-the-data"></a>Подготовка данных
Чтобы просмотреть первые 100 строк данных и некоторую статистическую информацию для всего набора данных, щелкните правой кнопкой мыши выходной порт набора данных (маленький кружок в нижней части) и выберите команду **Визуализировать**.  

Поскольку файл данных поступил без заголовков столбцов, студия предоставляет универсальные заголовки (Col1, Col2 *и т. д.*). Понятные заголовки столбцов не имеют существенного значения для создания модели, однако они облегчат работу с данными в эксперименте. Кроме того, при последующей публикации этой модели в веб-службе заголовки помогут определять столбцы пользователям службы.  

Заголовки столбцов можно добавить с помощью модуля [Edit Metadata][edit-metadata] (Изменение метаданных).
Модуль [Edit Metadata][edit-metadata] используется для изменения метаданных, связанных с набором данных. В этом случае он позволяет предоставить более понятные имена заголовков столбцов. 

Для использования модуля [Edit Metadata][edit-metadata] сначала необходимо указать, какие столбцы будут изменены (в нашем случае все). Далее следует указать действие, которое будет выполнено с этими столбцами (в нашем случае изменение заголовков столбцов).

1.  В палитре модуля введите "metadata" в поле **Поиск** . В списке модулей появится модуль [Edit Metadata][edit-metadata].
2.  Щелкните и перетащите модуль [Edit Metadata][edit-metadata] на холст и вставьте его под набором данных, добавленным ранее.
3.  Подключите набор данных к модулю [Edit Metadata][edit-metadata]: щелкните вывода порт набора данных (маленький кружок в нижней части набора данных). Далее перетащите порт ввода модуля [Edit Metadata][edit-metadata] (маленький кружок в верхней части модуля), затем отпустите кнопку мыши. Набор данных и модуль остаются подключенными даже при их перемещении на холсте.

    Теперь наш эксперимент должен выглядеть следующим образом:  

    ![Добавление модуля "Изменение метаданных"][2]
    
    Красный восклицательный знак указывает, что для этого модуля свойства еще не заданы. Мы сделаем это позже.
    
    > [AZURE.TIP] Дважды щелкните модуль и введите текст, чтобы добавить комментарий. Это поможет вам увидеть описание модуля и его действие в рамках эксперимента. В этом случае дважды щелкните модуль [Edit Metadata][edit-metadata] и введите комментарий "Добавить заголовки столбцов". Щелкните в любом месте холста, чтобы закрыть текстовое поле. Чтобы отобразить комментарий, щелкните стрелку вниз в модуле.

4.  Выберите [Edit Metadata][edit-metadata], затем в области **Свойства** справа от холста щелкните **Launch column selector** (Запустить средство выбора столбцов).
5.  В диалоговом окне **Select columns** (Выбор столбцов) выберите все строки в разделе **Available Columns** (Доступные столбцы) и нажмите кнопку ">", чтобы переместить их в раздел **Selected Columns** (Выбранные столбцы).
Диалоговое окно должно выглядеть следующим образом: ![Селектор столбцов, где выделены все столбцы][4]
7.  Установите флажок **ОК** .
8.  На панели **Свойства** найдите параметр **New column names** (Новые имена столбцов). В этом поле введите список имен для 21 столбца набора данных с разделителями-запятыми и в порядке расположения столбцов. Вы можете получить имена столбцов из документации по наборам данных на веб-сайте UCI или скопировать и вставить следующий список.  

          Status of checking account, Duration in months, Credit history, Purpose, Credit amount, Savings account/bond, Present employment since, Installment rate in percentage of disposable income, Personal status and sex, Other debtors, Present residence since, Property, Age in years, Other installment plans, Housing, Number of existing credits, Job, Number of people providing maintenance for, Telephone, Foreign worker, Credit risk  

    Панель свойств будет выглядеть следующим образом:

    ![Свойства модуля "Изменение метаданных"][1]

> [AZURE.TIP] Если вы хотите проверить заголовки столбцов, запустите эксперимент (щелкните **RUN** (Выполнить) под холстом эксперимента). После его завершения (в модуле [Edit Metadata][edit-metadata] появится зеленая галочка) щелкните порт вывода модуля [Edit Metadata][edit-metadata], а затем выберите **Visualize** (Визуализировать). Аналогичным образом можно просматривать выход любого модуля, чтобы следить за ходом использования данных в эксперименте.

##<a name="create-training-and-test-datasets"></a>Создание обучающих и тестовых наборов данных

На следующем шаге эксперимента создаются отдельные наборы данных, которые будут использоваться для обучения и тестирования модели.

Для этого используется модуль [Split Data][split] (Разделение данных).  

1.  Найдите модуль [Split Data][split], перетащите его на холст и подключите к последнему модулю [Edit Metadata][edit-metadata].
2.  По умолчанию коэффициент разделения равен 0,5 и задан параметр **Randomized split** (Случайное разделение). Это означает, что случайно выбранная половина данных будет выводиться через один порт модуля [Split Data][split], а другая половина — через другой. Это можно отрегулировать, а также использовать параметр **Random seed** (Псевдослучайные числа), чтобы изменить соотношение между данными для обучения и тестирования. Для этого примера оставим их как есть.
    
    > [AZURE.TIP] Свойство **Fraction of rows in the first output dataset** (Доля строк в первом выходном наборе данных) определяет, какой объем данных будет выходить через левый порт вывода. Например, если коэффициент установлен на 0,7, то 70% данных выходит через левый порт, а 30% — через правый.  
    
3. Дважды щелкните модуль [Split Data][split] и введите комментарий "Соотношение данных обучения и тестирования составляет 50 %". 

Выходные данные модуля [Split Data][split] можно использовать по своему усмотрению. Однако предлагаем использовать левый порт вывода для обучения данных, а правый — для их оценки.  

Как отмечалось на веб-сайте UCI, стоимость неверной классификации высокого кредитного риска как низкого в пять раз выше, чем стоимость неверной классификации низкого кредитного риска как высокого. Чтобы это учесть, создадим новый набор данных, отражающий эту функцию стоимости. В новом наборе данных каждый пример высокого риска реплицируется пять раз, а каждый пример низкого риска не реплицируется.   

Эту репликацию можно выполнить с помощью кода R:  

1.  Найдите и перетащите модуль [Execute R Script][execute-r-script] (Выполнение сценария R) на холст эксперимента и подключите левый порт вывода модуля [Split Data][split] к первому порту ввода (Dataset1) модуля [Execute R Script][execute-r-script].
2. Дважды щелкните модуль [Execute R Script][execute-r-script] и введите комментарий "Задать корректировку стоимости".
2.  На панели **Свойства** удалите текст по умолчанию в параметре **R-скрипт** и введите следующий сценарий:

          dataset1 <- maml.mapInputPort(1)
          data.set<-dataset1[dataset1[,21]==1,]
          pos<-dataset1[dataset1[,21]==2,]
          for (i in 1:5) data.set<-rbind(data.set,pos)
          maml.mapOutputPort("data.set")


Необходимо проделать ту же операцию репликации для каждого порта вывода модуля [Split Data][split], чтобы данные для обучения и тестирования получили одинаковую корректировку стоимости.

1.  Щелкните правой кнопкой мыши модуль [Execute R Script][execute-r-script] и выберите **Копировать**.
2.  Щелкните правой кнопкой мыши полотно эксперимента и выберите **Вставить**.
3.  Подключите первый порт ввода этого модуля [Execute R Script][execute-r-script] к правому порту вывода модуля [Split Data][split]. 
4.  В нижней части холста нажмите кнопку **Run** (Выполнить). 

> [AZURE.TIP] Копия модуля "Выполнение скрипта R" содержит тот же скрипт, что и исходный модуль. При копировании и вставке модуля на полотно копия сохраняет все свойства оригинала.  

На эксперимент теперь выглядит приблизительно так:

![Добавление модуля Разделение и скриптов R][3]

Подробнее об использовании сценариев R в экспериментах см. в разделе [Расширение возможностей эксперимента с помощью R](machine-learning-extend-your-experiment-with-r.md).

**Дальнейшие действия: [обучение и анализ моделей](machine-learning-walkthrough-4-train-and-evaluate-models.md)**.


[1]: ./media/machine-learning-walkthrough-3-create-new-experiment/create1.png
[2]: ./media/machine-learning-walkthrough-3-create-new-experiment/create2.png
[3]: ./media/machine-learning-walkthrough-3-create-new-experiment/create3.png
[4]: ./media/machine-learning-walkthrough-3-create-new-experiment/columnselector.png


<!-- Module References -->
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
[edit-metadata]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/



<!--HONumber=Oct16_HO2-->


