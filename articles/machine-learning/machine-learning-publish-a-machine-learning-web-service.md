<properties
    pageTitle="Развертывание веб-службы машинного обучения | Microsoft Azure"
    description="Сведения о том, как преобразовать обучающий эксперимент в прогнозный, подготовить его к развертыванию, а затем развернуть как веб-службу машинного обучения Azure."
    services="machine-learning"
    documentationCenter=""
    authors="garyericson"
    manager="jhubbard"
    editor="cgronlun"/>

<tags
    ms.service="machine-learning"
    ms.workload="data-services"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/04/2016"
    ms.author="garye"/>


# <a name="deploy-an-azure-machine-learning-web-service"></a>Развертывание веб-службы машинного обучения Azure

Машинное обучение Azure позволяет создавать, тестировать и развертывать решения для прогнозной аналитики.

Этот процесс можно обобщить до трех этапов:

- **[Создание обучающего эксперимента]**. Студия машинного обучения Azure Studio представляет собой среду совместной визуальной разработки, используемую для обучения и проверки модели прогнозирования с помощью обучающих данных, предоставляемых вами.
- **[Преобразование обучающего эксперимента в прогнозный]**. Когда модель обучена с помощью существующих данных и готова для оценки новых данных, вы подготавливаете и оптимизируете свой эксперимент для прогнозов.
- **Развертывание в качестве веб-службы**. Прогнозный эксперимент можно развернуть как [новую] или [классическую] веб-службу Azure. Пользователи могут отправлять данные в вашу модель и получать ее прогнозы.

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="create-a-training-experiment"></a>Создание обучающего эксперимента

Чтобы обучить модель прогнозирующей аналитики использовании, с помощью Студии машинного обучения Azure вы создаете эксперимент по обучению с различными модулями для загрузки обучающих данных, необходимой подготовки данных, применения алгоритмов машинного обучения и оценки результатов. Вы можете выполнять итерации эксперимента и испытывать разные алгоритмы машинного обучения, чтобы сравнить и оценить результаты.

Процесс создания обучающих экспериментов и управления ими рассматривается более подробно в других материалах. Дополнительные сведения вы найдете в следующих статьях:

- [Создание простого эксперимента в Студии машинного обучения Azure](machine-learning-create-experiment.md)
- [Разработка прогнозирующего решения с помощью машинного обучения Azure](machine-learning-walkthrough-develop-predictive-solution.md)
- [Импорт обучающих данных в Студию машинного обучения Azure](machine-learning-data-science-import-data.md)
- [Управление итерациями экспериментов в Студии машинного обучения Azure](machine-learning-manage-experiment-iterations.md)

## <a name="convert-the-training-experiment-to-a-predictive-experiment"></a>Преобразование обучающего эксперимента в прогностический эксперимент

После обучения модели вы можете преобразовать обучающий эксперимент в прогнозный, чтобы оценить новые данные.

Преобразование эксперимента в прогнозный подразумевает подготовку обученной модели к развертыванию в качестве оценивающей веб-службы. Пользователи веб-службы будут отправлять в модель входные данные, а модель будет возвращать им результаты прогнозов. При преобразовании эксперимента в прогнозный следует учитывать, как пользователи будут использовать эту модель.

Чтобы преобразовать обучающий эксперимент в прогнозный, в нижней части холста эксперимента нажмите кнопку **Run** (Выполнить), а затем щелкните **Set Up Web Service** (Настроить веб-службу) и выберите **Predictive Web Service** (Прогностическая веб-служба).

![Преобразование в эксперимент по оценке](./media/machine-learning-publish-a-machine-learning-web-service/figure-1.png)

Дополнительные сведения о том, как выполнить это преобразование, см. в статье [Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент](machine-learning-convert-training-experiment-to-scoring-experiment.md).

Ниже описано, как развернуть прогнозный эксперимент в качестве новой веб-службы. Кроем того, эксперимент можно развернуть как классическую веб-службу.

## <a name="deploy-the-predictive-experiment-as-a-new-web-service"></a>Развертывание прогнозного эксперимента в качестве новой веб-службы

Теперь, когда прогностический эксперимент подготовлен, его можно развернуть в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять в модель данные, а она будет возвращать им прогнозы.

Чтобы развернуть прогнозный эксперимент, в нижней части области эксперимента щелкните **Run** (Выполнить). После завершения эксперимента щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [New]** (Развернуть новую веб-службу).  Откроется страница развертывания на портале веб-службы машинного обучения. 

### <a name="machine-learning-web-service-portal-deploy-experiment-page"></a>Страница развертывания эксперимента на портале веб-службы машинного обучения

На странице развертывания эксперимента введите имя веб-службы.
Выберите ценовой план. Если у вас уже имеется ценовой план, то можно выбрать его. В противном случае необходимо создать ценовой план для службы. 

1.  В раскрывающемся списке **Price Plan** (Ценовой план) выберите существующий план или щелкните **Select new plan** (Выбрать новый план).
2.  В поле **Plan Name** (Имя плана) введите имя для идентификации плана в счете.
3.  Выберите один из вариантов **Monthly Plan Tier**(Уровень ежемесячного плана). По умолчанию указаны уровни плана для вашего стандартного региона, и веб-служба развертывается именно в этом регионе.

Щелкните **Deploy** (Развернуть). Откроется **страница быстрого запуска веб-службы**.

На странице быстрого запуска веб-службы приведены рекомендации для основных задач, которые выполняются после создания новой веб-службы. С нее можно быстро перейти на страницу тестирования или использования.

<!-- ![Deploy the Web service](./media/machine-learning-publish-a-machine-learning-web-service/figure-2.png)-->

### <a name="test-your-web-service"></a>Тестирование веб-службы

Чтобы протестировать новую веб-службу, в разделе стандартных задач щелкните **Test web service** (Тестировать веб-службу). На странице тестирования веб-службу можно проверить двумя способами: как службу "запрос-ответ" (RRS) или как службу пакетного выполнения (BES). 

На странице тестирования RRS отображаются входные и выходные данные, а также все глобальные параметры, которые были определены для эксперимента. Чтобы протестировать веб-службу, вручную введите необходимые значения для входных данных или предоставьте тестовые значения в файле данных с разделителями-запятыми (CSV). 

Для тестирования с помощью службы RRS в режиме представления списка введите необходимые значения для входных данных и щелкните **Test Request-Response**(Тестировать "запрос-ответ"). Результаты прогноза отобразятся в выходном столбце справа.

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-5-test-request-response.png)

Для тестирования службы BES щелкните **Batch**(Пакетная служба). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файла и прогнозный эксперимент вы создали с помощью Студии машинного обучения, скачайте набор данных для своего прогнозного эксперимента и используйте его.

Чтобы скачать набор данных, откройте Студию машинного обучения. Откройте прогнозный эксперимент и щелкните правой кнопкой мыши входные данные своего эксперимента. В контекстном меню выберите **dataset** (набор данных), а затем выберите **Download** (Скачать). 

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-7-mls-download.png)

Нажмите **Проверить**. Состояние задания пакетного выполнения отобразится справа в разделе **Test Batch Jobs**(Тестирование пакетных заданий).

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-6-test-batch-execution.png)

<!--![Test the Web service](./media/machine-learning-publish-a-machine-learning-web-service/figure-3.png)-->

На странице **Configuration** (Настройка) можно изменить описание или заголовок, обновить ключ учетной записи хранения, а также включить образцы данных для веб-службы.

![Настройка веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-8-arm-configure.png)

После развертывания веб-службы вы сможете:

- **обращаться** к ней через API веб-службы;
- **управлять** ею через портал веб-службы машинного обучения Microsoft Azure или классический портал Azure; 
- **обновлять** ее при изменении модели.

### <a name="access-the-web-service"></a>Доступ к веб-службе

Развернув веб-службу из Студии машинного обучения, вы сможете программным способом отправлять в эту службу данные и получать от нее ответы.

На странице **Consume** (Использование) предоставлена вся информация, необходимая для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе. 

Дополнительную информацию о доступе к веб-службе машинного обучения см. в статье [Как использовать веб-службу машинного обучения Azure, развернутую из эксперимента машинного обучения](machine-learning-consume-Web-services.md).

### <a name="manage-your-new-web-service"></a>Управление новой веб-службой

С помощью портала веб-службы машинного обучения можно управлять классическими веб-службами. На [главной странице портала](https://services.azureml-test.net/) щелкните **Web Services** (Веб-службы). На странице веб-служб службу можно удалить или скопировать. Для наблюдения за конкретной службой выберите службу и щелкните **Dashboard**(Панель мониторинга). Для наблюдения за выполнением пакетных заданий, связанных с веб-службой, щелкните **Batch Request Log**(Журнал пакетных запросов).

## <a name="deploy-the-predictive-experiment-as-a-classic-web-service"></a>Развертывание прогнозного эксперимента в качестве классической веб-службы

Теперь, когда прогностический эксперимент правильно подготовлен, его можно развернуть в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять в модель данные, а она будет возвращать им прогнозы.

Чтобы развернуть прогностический эксперимент, нажмите **Run** (Выполнить) в нижней части холста эксперимента, а затем выберите **Deploy Web Service** (Развернуть веб-службу). Веб-служба будет настроена, после чего отобразится ее панель мониторинга.

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-2.png)

Чтобы протестировать веб-службу, щелкните ссылку **Test** (Проверить) на панели мониторинга веб-службы. Появится диалоговое окно, предлагающее ввести входные данные для службы. Это столбцы, ожидаемые экспериментом по оценке. Введите набор данных и нажмите кнопку **ОК**. В нижней части панели мониторинга отобразятся результаты, созданные веб-службой.

Ссылка **Test** (Проверить) позволяет протестировать службу на портале веб-службы машинного обучения Azure, как описано выше в разделе о развертывании новой веб-службы.

![Тестирование веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-3.png)

На странице **Configuration** (Настройка) можно изменить отображаемое имя службы и добавить ее описание. Имя и описание отображаются на [классическом портале Azure](http://manage.windowsazure.com/), на котором вы управляете веб-службами.

Вы можете предоставить описание входных данных, выходных данных и параметров веб-службы, введя строковые данные для каждого столбца в разделах **INPUT SCHEMA** (Схема входных данных), **OUTPUT SCHEMA** (Схема выходных данных) и **Web Service Parameter** (Параметр веб-службы). Эти описания используются в типовой документации к коду веб-службы.

Включив ведение журнала, вы сможете диагностировать сбои, которые наблюдаются при обращении к веб-службе. Дополнительную информацию см. в статье [Включение функции ведения журналов для веб-служб машинного обучения](machine-learning-web-services-logging.md).

![Настройка веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-4.png)

Кроме того, на портале веб-службы машинного обучения Azure можно настроить конечные точки веб-службы. См. раздел о развертывании новой веб-службы выше. В этом случае будут доступны другие возможности: можно добавить или изменить описание службы, активировать ведение журнала и включить пример данных для тестирования.

### <a name="access-the-web-service"></a>Доступ к веб-службе

Развернув веб-службу из Студии машинного обучения, вы сможете программным способом отправлять в эту службу данные и получать от нее ответы.

На панели мониторинга предоставлена вся информация, необходимая для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе, а страницы справки по API помогут вам приступить к созданию кода.

Дополнительную информацию о доступе к веб-службе машинного обучения см. в статье [Как использовать веб-службу машинного обучения Azure, развернутую из эксперимента машинного обучения](machine-learning-consume-Web-services.md).

### <a name="manage-the-web-service"></a>Управление веб-службой

Веб-службу можно отслеживать с помощью различных действий. Ее можно обновить или удалить. Кроме того, для классической веб-службы можно добавить дополнительные конечные точки (в дополнение к той, что была создана при развертывании).

Дополнительные сведения см. в статьях [Управление рабочей областью машинного обучения Azure](machine-learning-manage-workspace.md) и [Управление новой веб-службой машинного обучения](machine-learning-manage-new-webservice.md).
  
<!-- When this article gets published, fix the link and uncomment
For more information on how to manage Azure Machine Learning Web service endpoints using the REST API, see **Azure machine learning Web service endpoints**.
-->

## <a name="update-the-web-service"></a>Обновление веб-службы

В веб-службу можно вносить изменения. Например, в модель можно добавить дополнительные обучающие данные и повторно развернуть ее, перезаписав исходную веб-службу.

Чтобы обновить веб-службу, откройте исходный прогнозный эксперимент, который вы использовали для развертывания веб-службы, и создайте редактируемую копию с помощью функции **Сохранить как**. Внесите изменения и щелкните **Deploy Web Service** (Развернуть веб-службу). 

Так как этот эксперимент уже был развернут, отобразится запрос на перезапись (для классической веб-службы) или обновление (для новой веб-службы) существующей службы. Если нажать **Да** или **Обновить**, существующая веб-служба будет остановлена и вместо нее будет развернут новый прогнозный эксперимент.

> [AZURE.NOTE] Если ранее вы изменили конфигурацию исходной веб-службы, например ввели новое отображаемое имя или описание, эти сведения нужно будет ввести еще раз.

Один из вариантов обновления веб-службы — переобучить модель программно. Дополнительные сведения см. в статье [Программное переобучение моделей машинного обучения](machine-learning-retrain-models-programmatically.md).


<!-- internal links -->
[Создание обучающего эксперимента]: #create-a-training-experiment
[Преобразование обучающего эксперимента в прогнозный]: #convert-the-training-experiment-to-a-predictive-experiment.
[новая]: #deploy-the-predictive-experiment-as-a-new-Web-service
[классическая]: #deploy-the-predictive-experiment-as-a-new-Web-service
[Доступ]: #access-the-Web-service
[Управление]: #manage-the-Web-service-in-the-azure-management-portal
[Обновление]: #update-the-Web-service



<!--HONumber=Oct16_HO2-->


