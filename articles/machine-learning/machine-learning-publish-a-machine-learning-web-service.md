<properties
	pageTitle="Развертывание веб-службы машинного обучения | Microsoft Azure"
	description="Как преобразовать обучающий эксперимент в прогностический эксперимент, подготовить его к развертыванию, а затем развернуть как веб-службу машинного обучения Azure."
	services="machine-learning"
	documentationCenter=""
	authors="garyericson"
	manager="jhubbard"
	editor="cgronlun"/>

<tags
	ms.service="machine-learning"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/06/2016"
	ms.author="garye"/>

# Развертывание веб-службы машинного обучения Azure

Машинное обучение Azure позволяет создавать, тестировать и развертывать решения для прогнозной аналитики.

Этот процесс можно обобщить до трех этапов:

- **[Создание эксперимента обучения]** — Студия машинного обучения Azure Studio представляет собой среду совместной визуальной разработки, используемую для обучения и проверки модели прогнозирования с помощью обучающих данных, предоставляемых вами.
- **[Преобразование в прогнозный эксперимент]** — когда модель обучена с помощью существующих данных и готова для оценки новых данных, вы подготавливаете и оптимизируете свой эксперимент для прогнозов.
- **Развертывание в качестве веб-службы** — вы можете развернуть свой прогнозный эксперимент как [новую] или как [классическую] веб-службу Azure. Пользователи могут отправлять данные в вашу модель и получать ее прогнозы.

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## Создание эксперимента по обучению

Чтобы обучить модель прогнозирующей аналитики использовании, с помощью Студии машинного обучения Azure вы создаете эксперимент по обучению с различными модулями для загрузки обучающих данных, необходимой подготовки данных, применения алгоритмов машинного обучения и оценки результатов. Вы можете выполнять итерации эксперимента и испытывать разные алгоритмы машинного обучения, чтобы сравнить и оценить результаты.

Процесс создания экспериментов по обучению и управления ими рассматривается более подробно в других материалах. Дополнительную информацию и примеры см. в этих статьях:

- [Создание простого эксперимента в Студии машинного обучения Azure](machine-learning-create-experiment.md)
- [Разработка прогнозирующего решения с помощью машинного обучения Azure](machine-learning-walkthrough-develop-predictive-solution.md)
- [Импорт обучающих данных в Студию машинного обучения Azure](machine-learning-data-science-import-data.md)
- [Управление итерациями экспериментов в Студии машинного обучения Azure](machine-learning-manage-experiment-iterations.md)

## Преобразование обучающего эксперимента в прогностический эксперимент

После обучения модели вы можете использовать ее для оценки новых данных. Для этого нужно преобразовать обучающий эксперимент в прогностический эксперимент.

После преобразования в прогностический эксперимент ваша модель обучения готова к развертыванию в качестве оценивающей веб-службы. Пользователи веб-службы будут отправлять входные данные модели, которая, в свою очередь, будет отправлять обратно результаты прогнозов. Поэтому при преобразовании в прогностический эксперимент следует учитывать предполагаемое использование модели другими пользователями.

Для преобразования обучающего эксперимента в прогностический нажмите кнопку **Выполнить** в нижней части области эксперимента, затем нажмите **Настроить веб-службу** и **Прогностическая веб-служба**.

![Преобразование в эксперимент по оценке](./media/machine-learning-publish-a-machine-learning-web-service/figure-1.png)

Дополнительные сведения о том, как выполнить это преобразование, см. в статье [Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент](machine-learning-convert-training-experiment-to-scoring-experiment.md).

Ниже показано, как развернуть прогнозный эксперимент в качестве новой веб-службы.

Ниже описано, как развернуть прогнозный эксперимент в качестве [новой] веб-службы. Также можно развернуть эксперимент в качестве [классической] веб-службы.

## Развертывание прогнозного эксперимента в качестве новой веб-службы

Теперь, когда прогностический эксперимент был необходимым образом подготовлен, его можно развернуть в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть прогнозный эксперимент, в нижней части области эксперимента щелкните **Run** (Выполнить). После завершения выполнения эксперимента щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [New]** (Развернуть веб-службу [новую]). Откроется страница развертывания портала веб-служб машинного обучения.

### Страница развертывания эксперимента портала веб-служб машинного обучения
На странице "Deploy Experiment" (Развертывание эксперимента) введите имя веб-службы. Выберите ценовой план. Если у вас уже имеется ценовой план, то можно выбрать его. В противном случае необходимо создать ценовой план для службы.

1.	Из раскрывающегося списка **Price Plan** (Ценовой план) выберите существующий план или параметр **Select new plan** (Выбрать новый план).
2.	В поле **Имя плана** введите имя для идентификации плана в счете.
3.	Выберите один из вариантов **Monthly Plan Tier** (Уровень ежемесячного плана). Обратите внимание, что по умолчанию указаны уровни плана для вашего региона по умолчанию, и веб-служба развертывается в этом регионе.

Щелкните **Deploy** (Развернуть). Откроется страница **Quickstart** (Быстрый запуск) для веб-службы.

Страница быстрого запуска веб-службы предоставляет доступ и рекомендации к наиболее распространенным задачам, выполняемым после создания новой веб-службы. С нее легко перейти на страницу "Test" (Тестирование) и "Consume" (Использование).

<!-- ![Deploy the web service](./media/machine-learning-publish-a-machine-learning-web-service/figure-2.png)-->

### Тестирование веб-службы

Чтобы протестировать новую веб-службу, в разделе общих задач щелкните **Test web service** (Тестировать веб-службу). На странице тестирования вы можете проверить свою службу как службу "запрос-ответ" (RRS) или как службу пакетного выполнения (BES).

На странице тестирования RRS отображаются входные и выходные данные, а также все глобальные параметры, которые были определены для эксперимента. Для тестирования веб-службы можно вручную ввести необходимые значения для входных данных или предоставить тестовые значения в формате файла данных с разделителями-запятыми (CSV).

Для тестирования с помощью службы RRS в режиме представления списка введите необходимые значения для входных данных и щелкните **Test Request-Response** (Тестировать "запрос-ответ"). В выходном столбце слева отобразятся результаты прогноза.

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-5-test-request-response.png)

Для тестирования службы BES щелкните **Batch** (Пакетная служба). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файлов и вы создали прогнозный эксперимент с помощью Студии машинного обучения, то можно скачать набор данных для прогнозного эксперимента и воспользоваться им.

Чтобы скачать набор данных, откройте Студию машинного обучения. Откройте прогнозный эксперимент и щелкните правой кнопкой мыши входные данные для своего эксперимента. В контекстном меню выберите **dataset** (набор данных), а затем выберите **Download** (Скачать).

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-7-mls-download.png)

Нажмите **Проверить**. Состояние задания пакетного выполнения отобразится справа в разделе **Test Batch Jobs** (Тестирование пакетных заданий).

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-6-test-batch-execution.png)

<!--![Test the web service](./media/machine-learning-publish-a-machine-learning-web-service/figure-3.png)-->

На странице **CONFIGURATION** (НАСТРОЙКА) можно изменить описание, заголовок, обновить ключ учетной записи хранения, а также включить образцы данных для веб-службы.

![Настройка веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-8-arm-configure.png)

После развертывания веб-службы можно сделать следующее:

- **обращаться** к ней через API веб-службы;
- **управлять** этой веб-службой через портал веб-служб Машинного обучения Microsoft Azure или классический портал Azure;
- **обновлять** ее при изменении модели.

### Доступ к веб-службе

После развертывания веб-службы из студии машинного обучения в эту службу можно отправлять данные и программным способом получать ответы.

Страница **Consume** (Использование) предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе.

Дополнительную информацию о доступе к веб-службе машинного обучения см. в разделе [Как использовать развернутую веб-службу Машинного обучения Azure](machine-learning-consume-web-services.md).

### Управление новой веб-службой

С помощью портала веб-служб Машинного обучения можно осуществлять управление классическими веб-службами. На [главной странице портала](https://services.azureml-test.net/) щелкните **Web Services** (Веб-службы). На странице веб-служб можно удалить службу или скопировать ее. Для наблюдения за конкретной службой выберите службу и щелкните **Dashboard** (Панель мониторинга). Для наблюдения за выполнением пакетных заданий, связанных с веб-службой, щелкните **Batch Request Log** (Журнал пакетных запросов).

## Развертывание прогнозного эксперимента в качестве классической веб-службы

Теперь, когда прогностический эксперимент был необходимым образом подготовлен, его можно развернуть в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть свой прогностический эксперимент, нажмите **Выполнить** в нижней части области эксперимента, затем нажмите **Развернуть веб-службу**. Веб-служба будет настроена, затем отобразится ее панель мониторинга.

![Развертывание веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-2.png)

Чтобы протестировать веб-службу, щелкните ссылку **Проверить** на панели мониторинга веб-службы. Появится диалоговое окно, предлагающее ввести входные данные для службы. Это столбцы, ожидаемые экспериментом по оценке. Введите набор данных и нажмите кнопку **ОК**. Результаты, созданные веб-службой, отображаются внизу панели мониторинга.

![Тестирование веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-3.png)

На вкладке **КОНФИГУРАЦИЯ** можно изменить отображаемое имя службы и добавить ее описание. Имя и описание отображаются на [классическом портале Azure](http://manage.windowsazure.com/), на котором осуществляется управление веб-службами.

Можно предоставить описание входных данных, выходных данных и параметров веб-службы, заполнив строку для каждого столбца в разделах **СХЕМА ВХОДНЫХ ДАННЫХ**, **СХЕМА ВЫХОДНЫХ ДАННЫХ** и **ПАРАМЕТР ВЕБ-СЛУЖБЫ**. Эти описания используются в документации по примерам кода для веб-службы. Также можно включить ведение журнала диагностики сбоев, которые наблюдаются при обращении к веб-службе.

Дополнительную информацию см. в разделе [Включение функции ведения журналов для веб-служб машинного обучения](machine-learning-web-services-logging.md).

![Настройка веб-службы](./media/machine-learning-publish-a-machine-learning-web-service/figure-4.png)

### Доступ к веб-службе

После развертывания веб-службы из студии машинного обучения в эту службу можно отправлять данные и программным способом получать ответы.

Панель мониторинга предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе, а страницы справки по API помогут вам приступить к созданию кода.

Дополнительную информацию о доступе к веб-службе машинного обучения см. в разделе [Как использовать развернутую веб-службу Машинного обучения Azure](machine-learning-consume-web-services.md).

### Управление веб-службой на классическом портале Azure

На [классическом портале Azure](http://manage.windowsazure.com/) можно управлять веб-службами. Для этого щелкните службу **Машинное обучение** и в открывшейся рабочей области машинного обучения выберите необходимую веб-службу на вкладке **WEB SERVICES** (ВЕБ-СЛУЖБЫ). На этой странице можно наблюдать за веб-службой, а также обновить или удалить ее. Можно также добавить вторую конечную точку для веб-службы в дополнение к конечной точке по умолчанию, которая создается при развертывании.

Подробнее: [Управление рабочей областью машинного обучения Azure](machine-learning-manage-workspace.md).
<!-- When this article gets published, fix the link and uncomment
For more information on how to manage Azure Machine Learning web service endpoints using the REST API, see **Azure machine learning web service endpoints**.
-->

## Обновление веб-службы

Вы можете внести изменения в веб-службу, например обновить модель дополнительными обучающими данными, и развернуть ее снова, перезаписав исходную веб-службу.

Чтобы обновить веб-службу, откройте исходный прогностический эксперимент, использованный для развертывания веб-службы, и создайте редактируемую копию, нажав **СОХРАНИТЬ КАК**. Внесите изменения и нажмите **Развернуть веб-службу**.

Так как этот эксперимент уже был развернут, отобразится запрос на перезапись (для классической веб-службы) или обновление (для новой веб-службы) существующей службы. Если нажать **YES** (ДА) или **Update** (Обновить), то существующая веб-служба будет остановлена, а вместо нее будет развернут новый прогнозный эксперимент.

> [AZURE.NOTE] Если вы внесли изменения в конфигурацию исходной веб-службы, например, введя новое отображаемое имя или описание, необходимо будет снова ввести эти значения.

Один из вариантов обновления веб-службы — переобучить модель программно. Дополнительные сведения см. в статье [Программное переобучение моделей машинного обучения](machine-learning-retrain-models-programmatically.md).


<!-- internal links -->
[Создание эксперимента обучения]: #create-a-training-experiment
[Преобразование в прогнозный эксперимент]: #convert-the-training-experiment-to-a-predictive-experiment
[new]: #deploy-the-predictive-experiment-as-a-new-web-service
[новой]: #deploy-the-predictive-experiment-as-a-new-web-service
[новую]: #deploy-the-predictive-experiment-as-a-new-web-service
[классической]: #deploy-the-predictive-experiment-as-a-new-web-service
[классическую]: #deploy-the-predictive-experiment-as-a-new-web-service
[Access]: #access-the-web-service
[Manage]: #manage-the-web-service-in-the-azure-management-portal
[Update]: #update-the-web-service

<!---HONumber=AcomDC_0914_2016-->