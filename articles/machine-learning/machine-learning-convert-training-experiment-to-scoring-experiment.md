<properties 
	pageTitle="Преобразование эксперимента по обучению в машинном обучении в эксперимент по оценке | Azure" 
	description="Как преобразовать эксперимент по обучению в машинном обучении, используемый для обучения модели прогнозной аналитики, в эксперимент по оценке, который можно опубликовать в качестве веб-службы." 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/10/2015" 
	ms.author="garye"/>

#Преобразование эксперимента по обучению в машинном обучении в эксперимент по оценке

Машинное обучение Azure позволяет создавать, тестировать и развертывать решения для прогнозной аналитики. 

Если вы создали *training experiment* и выполнили по нему итерацию для обучения модели прогнозной аналитики, а также готовы использовать его для оценки новых данных, вам необходимо подготовить и оптимизировать свой эксперимент по оценке. Затем можно опубликовать этот *scoring experiment* в качестве веб-службы Azure, чтобы пользователи могли отправлять данные в модель и получать от нее прогнозы.

Выполнив преобразование в эксперимент по оценке, вы получите обученную модель, готовую к публикации в качестве веб-службы для оценки. Пользователи веб-службы будут отправлять входные данные модели, которая, в свою очередь, будет отправлять обратно результаты прогнозов. Поэтому при преобразовании в эксперимент по оценке следует учитывать предполагаемое использование модели другими пользователями.

Процесс преобразования эксперимента по обучению в эксперимент по оценке состоит из трех этапов.

1.	Сохраните обученную модель машинного обучения, а затем замените алгоритм машинного обучения и модули **Обучение модели** сохраненной обученной моделью.
2.	Ограничьте эксперимент только теми модулями, которые необходимы для оценки. Эксперимент по обучению включает в себя несколько модулей, необходимых для обучения. Однако как только модель будет обучена и готова к использованию для оценки, необходимость в них отпадет.
3.	Определите, в каком расположении своего эксперимента вы будете принимать данные от пользователей веб-службы и какие данные будут возвращаться.

##Кнопка "Создать эксперимент по оценке"

Кнопка **Создать эксперимент по оценке** в нижней части холста эксперимента позволяет выполнить три шага преобразования эксперимента по обучению в эксперимент по оценке.

1.	При этом обученная модель сохраняется в качестве модуля в разделе **Обученные модели** палитры модулей (слева от холста эксперимента), а затем алгоритм машинного обучения и модули **Обучение модели** заменяются сохраненной обученной моделью. 
2.	Модули, которые явно не нужны, удаляются. В нашем примере это модуль **Разделение**, второй модуль **Оценка модели** и модуль **Анализ модели**.
3.	Она создает модули входных и выходных данных веб-службы и добавляет их в расположение по умолчанию в эксперименте.

Например, следующий эксперимент предусматривает обучение модели двухклассового увеличивающегося дерева принятия решений с использованием примера данных переписи:

![Training experiment][figure1]

Модули в этом эксперименте в сущности выполняют четыре разные функции:

![Module functions][figure2]

При преобразовании этого эксперимента по обучению в эксперимент по оценке некоторые из этих модулей будут ненужны или у них будет другое предназначение:

- **Данные**. Данные в этом примере набора данных не используются при оценке. Пользователь веб-службы предоставит данные, которые необходимо оценить. Однако обученная модель использует из этого набора данных метаданные, такие как типы данных. Поэтому в эксперименте по оценке необходимо сохранить набор данных, чтобы он мог предоставлять эти метаданные.

- **Подготовка**. Возможно, эти модули понадобятся для обработки входных данных. Это зависит от данных, которые будут отправлены для оценки. 

	Например, в данном случае в примере набора данных могут отсутствовать некоторые значения и присутствовать столбцы, которые не нужны для обучения модели. Поэтому в решение включен модуль **Очистка недостающих данных** для устранения недостающих значений и модуль **Столбцы проекта** для исключения этих дополнительных столбцов из потока данных. Если известно, что в данных, которые будут отправлены для оценки через веб-службу, не будет недостающих значений, можно удалить модуль **Очистка недостающих данных**. Однако так как модуль **Столбцы проекта** помогает определить набор оцениваемых признаков, его необходимо оставить.

- **Обучение**. После успешного обучения модели сохраните ее в качестве единого модуля обученной модели. Затем замените отдельные модули сохраненной обученной моделью.

- **Оценка**. Чтобы разделить поток данных на набор проверочных данных и набор данных для обучения, в этом примере используется модуль "Разделение". Он не требуется в эксперименте по оценке, и его можно удалить. Аналогичным образом второй модуль **Оценка модели** и модуль **Анализ модели** используются для сравнения результатов проверочных данных, поэтому эти модули также не нужны для эксперимента по оценке. Однако оставшийся модуль **Оценка модели** необходим для возврата результатов оценки через веб-службу.

После нажатия кнопки **Создать эксперимент по оценке** наш эксперимент выглядит следующим образом:	

![Converted scoring experiment][figure3]

Этого может быть достаточно, чтобы подготовить эксперимент к публикации в качестве веб-службы. Однако в зависимости от эксперимента могут потребоваться дополнительные действия.

###Настройка модулей входных и выходных данных

В своем эксперименте по обучению вы использовали набор данных для обучения, а затем выполнили обработку, чтобы получить данные в формате, необходимом для алгоритма машинного обучения. Если для данных, которые вы рассчитываете получить через веб-службу, не нужно выполнять такую обработку, **модуль входных данных веб-службы** можно переместить на другой узел в вашем эксперименте.

Например, при нажатии кнопки **Создать эксперимент по оценке** модуль **Входные данные веб-службы** по умолчанию помещается в верхнюю часть потока данных, как показано на рисунке выше. Однако, если не нужно обрабатывать входные данные, можно разместить модуль **Входные данные веб-службы** после модулей обработки данных вручную:

![Moving the web service input][figure4]

Теперь входные данные, предоставленные через веб-службу, будут передаваться непосредственно в модуль "Оценка модели" без предварительной обработки.

Аналогичным образом нажатие кнопки **Создать эксперимент по оценке** по умолчанию помещает модуль выходных данных веб-службы в нижнюю часть потока данных. В этом примере веб-служба будет возвращать пользователю выходные данные модуля **Оценка модели**, который включает полный вектор входных данных и результаты оценки.

Однако, если вам необходимо, чтобы возвращались другие данные, например только результаты оценки, а не весь вектор входных данных, можно вставить модуль **Столбцы проекта**, чтобы исключить все столбцы, кроме результатов оценки. Затем переместите модуль **Выходные данные веб-службы** в выходные данные модуля **Столбцы проекта**:

![Moving the web service output][figure5]

###Добавление и удаление дополнительных модулей обработки данных

Если вам известно, что в эксперименте есть модули, которые не будут нужны при оценке, их можно удалить. Например, из эксперимента по оценке можно удалить модуль **Очистка недостающих данных**, так как мы поместили модуль **Входные данные веб-службы** после модуля обработки данных. 

Теперь наш эксперимент по оценке выглядит следующим образом:

![Removing additional module][figure6]

###Добавление дополнительных параметров веб-службы

В некоторых случаях необходимо разрешить пользователю веб-службы менять поведение модулей при получении доступа к службе. Это можно сделать с помощью *Web Service Parameters*.

Типичные примеры - настройка модуля **Средство чтения**, при которой пользователь опубликованной веб-службы может указать другой источник данных при получении доступа к веб-службе, и настройка модуля **Средство записи**, позволяющего указать другое назначение. 

Можно определить параметры веб-службы и связать их с одним или несколькими параметрами модуля. Вы также можете указать, являются они обязательными или нет. Затем при получении доступа к веб-службе пользователь может указать значения для этих параметров, и действия модуля будут изменены соответствующим образом.

Дополнительную информацию о параметрах веб-службы см. в статье [Использование параметров веб-службы в Машинном обучении Azure
][webserviceparameters].

[webserviceparameters]: machine-learning-web-service-parameters.md


##Публикация эксперимента по оценке в качестве веб-службы

Теперь, когда эксперимент по оценке подготовлен в достаточной мере, его можно опубликовать в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Дополнительную информацию обо всем процессе публикации см. в разделе [Публикация веб-службы Машинного обучения Azure][publish]

[publish]: machine-learning-publish-a-machine-learning-web-service.md


<!-- Images -->
[figure1]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure1.png
[figure2]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure2.png
[figure3]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure3.png
[figure4]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure4.png
[figure5]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure5.png
[figure6]:./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure6.png


<!--HONumber=49--> 