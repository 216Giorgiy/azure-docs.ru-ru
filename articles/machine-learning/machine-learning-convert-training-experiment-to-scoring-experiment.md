<properties
	pageTitle="Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент | Microsoft Azure"
	description="Как преобразовать обучающий эксперимент машинного обучения, используемый для обучения модели прогнозной аналитики, в прогностический эксперимент, который можно опубликовать в качестве веб-службы."
	services="machine-learning"
	documentationCenter=""
	authors="garyericson"
	manager="paulettm"
	editor="cgronlun"/>

<tags
	ms.service="machine-learning"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="02/03/2016"
	ms.author="garye"/>

# Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент

Машинное обучение Azure позволяет создавать, тестировать и развертывать решения для прогнозной аналитики.

Если вы создали и выполнили по нему итерацию *эксперимент по обучению* для обучения модели прогнозной аналитики, а также готовы использовать его для оценки новых данных, вам необходимо подготовить и оптимизировать свой эксперимент по оценке. Затем этот *прогностический эксперимент* можно развернуть в качестве веб-службы Azure, чтобы пользователи могли отправлять данные в вашу модель и получать от нее прогнозы.

После преобразования в прогностический эксперимент ваша модель обучения готова к развертыванию в качестве веб-службы. Пользователи веб-службы будут отправлять входные данные модели, которая, в свою очередь, будет отправлять обратно результаты прогнозов. Поэтому при преобразовании в прогностический эксперимент следует учитывать предполагаемое использование модели другими пользователями.

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

Процесс преобразования обучающего эксперимента в прогностический эксперимент состоит из трех этапов.

1.	Сохраните обученную модель машинного обучения, а затем замените алгоритм машинного обучения и модули [Обучение модели][train-model] сохраненной обученной моделью.
2.	Ограничьте эксперимент только теми модулями, которые необходимы для оценки. Эксперимент по обучению включает в себя несколько модулей, необходимых для обучения. Однако как только модель будет обучена и готова к использованию для оценки, необходимость в них отпадет.
3.	Определите, в каком расположении своего эксперимента вы будете принимать данные от пользователей веб-службы и какие данные будут возвращаться.

## Кнопка «Настроить веб-службу»

После запуска вашего эксперимента (кнопкой **ВЫПОЛНИТЬ** в нижней части области эксперимента) кнопка **Настроить веб-службу** (выберите параметр **Прогностическая веб-служба**) выполнит три этапа преобразования обучающего эксперимента в прогностический:

1.	При этом обученная модель сохраняется в качестве модуля в разделе **Обученные модели** палитры модулей (слева от холста эксперимента), а затем алгоритм машинного обучения и модули [Обучение модели][train-model] заменяются сохраненной обученной моделью.
2.	Модули, которые явно не нужны, удаляются. В нашем примере это модуль [Разделение][split], второй модуль [Оценка модели][score-model] и модуль [Анализ модели][evaluate-model].
3.	Она создает модули входных и выходных данных веб-службы и добавляет их в расположение по умолчанию в эксперименте.

Например, следующий эксперимент предусматривает обучение модели двухклассового увеличивающегося дерева принятия решений с использованием примера данных переписи:

![Эксперимент по обучению][figure1]

Модули в этом эксперименте в сущности выполняют четыре разные функции:

![Функции модуля][figure2]

При преобразовании этого обучающего эксперимента в прогностический некоторые из этих модулей будут не нужны или у них будет другое назначение:

- **Данные**. Данные в этом примере набора данных не используются при оценке. Пользователь веб-службы предоставит данные, которые необходимо оценить. Однако обученная модель использует из этого набора данных метаданные, такие как типы данных. Поэтому в прогностическом эксперименте необходимо сохранить набор данных, чтобы он мог предоставлять эти метаданные.

- **Подготовка**. Возможно, эти модули понадобятся для обработки входных данных. Это зависит от данных, которые будут отправлены для оценки.

	Например, в данном случае в примере набора данных могут отсутствовать некоторые значения и присутствовать столбцы, которые не нужны для обучения модели. Поэтому в решение включен модуль [Очистка недостающих данных][clean-missing-data] для устранения недостающих значений и модуль [Столбцы проекта][project-columns] для исключения этих дополнительных столбцов из потока данных. Если известно, что в данных, которые будут отправлены для оценки через веб-службу, не будет недостающих значений, можно удалить модуль [Очистка недостающих данных][clean-missing-data]. Однако так как модуль [Столбцы проекта][project-columns] помогает определить набор оцениваемых признаков, его необходимо оставить.

- **Обучение**. После успешного обучения модели сохраните ее в качестве единого модуля обученной модели. Затем замените отдельные модули сохраненной обученной моделью.

- **Оценка**. Чтобы разделить поток данных на набор проверочных данных и набор данных для обучения, в этом примере используется модуль «Разделение». В прогностическом эксперименте он не требуется, и его можно удалить. Аналогично второй модуль [Оценка модели][score-model] и модуль [Анализ модели][evaluate-model] используются для сравнения результатов проверочных данных, поэтому эти модули также не нужны в прогностическом эксперименте. Однако оставшийся модуль [Оценка модели][score-model] необходим для возврата результатов оценки через веб-службу.

После нажатия кнопки **Настроить веб-службу** наш пример выглядит следующим образом:

![Преобразованный прогностический эксперимент][figure3]

Этого может быть достаточно для подготовки эксперимента к развертыванию в качестве веб-службы. Однако в зависимости от эксперимента могут потребоваться дополнительные действия.

### Настройка модулей входных и выходных данных

В своем эксперименте по обучению вы использовали набор данных для обучения, а затем выполнили обработку, чтобы получить данные в формате, необходимом для алгоритма машинного обучения. Если для данных, которые вы рассчитываете получить через веб-службу, не нужно выполнять такую обработку, **модуль входных данных веб-службы** можно переместить на другой узел в вашем эксперименте.

Например, при нажатии кнопки **Настройка веб-службы** модуль **Входные данные веб-службы** по умолчанию помещается в верхнюю часть потока данных, как показано на рисунке выше. Однако, если не нужно обрабатывать входные данные, можно разместить модуль **Входные данные веб-службы** после модулей обработки данных вручную:

![Перемещение входных данных веб-службы][figure4]

Теперь входные данные, предоставленные через веб-службу, будут передаваться непосредственно в модуль «Оценка модели» без предварительной обработки.

Аналогичным образом при нажатии кнопки **Настройка веб-службы** модуль выходных данных веб-службы по умолчанию помещается в нижнюю часть потока данных. В этом примере веб-служба будет возвращать пользователю выходные данные модуля [Оценка модели][score-model], который включает полный вектор входных данных и результаты оценки.

Однако, если вам необходимо, чтобы возвращались другие данные, например только результаты оценки, а не весь вектор входных данных, можно вставить модуль [Столбцы проекта][project-columns], чтобы исключить все столбцы, кроме результатов оценки. Затем переместите модуль **Выходные данные веб-службы** в выходные данные модуля [Столбцы проекта][project-columns]\:

![Перемещение выходных данных веб-службы][figure5]

### Добавление и удаление дополнительных модулей обработки данных

Если вам известно, что в эксперименте есть модули, которые не будут нужны при оценке, их можно удалить. Например, так как мы поместили модуль **Входные данные веб-службы** после модулей обработки данных, можно удалить модуль [Очистка недостающих данных][clean-missing-data] из прогностического эксперимента.

Теперь наш прогностический эксперимент выглядит следующим образом:

![Удаление дополнительного модуля][figure6]

### Добавление дополнительных параметров веб-службы

В некоторых случаях необходимо разрешить пользователю веб-службы менять поведение модулей при получении доступа к службе. *Параметры веб-службы* позволяют это сделать.

Типичный пример — настройка модуля [Средство чтения][reader], благодаря которому пользователь развернутой веб-службы может указать другой источник данных при обращении к веб-службе. и настройка модуля [Средство записи][writer], позволяющего указать другое назначение.

Можно определить параметры веб-службы и связать их с одним или несколькими параметрами модуля. Вы также можете указать, являются они обязательными или нет. Затем при получении доступа к веб-службе пользователь может указать значения для этих параметров, и действия модуля будут изменены соответствующим образом.

Дополнительную информацию о параметрах веб-службы см. в статье [Использование параметров веб-службы в Машинном обучении Azure][webserviceparameters].

[webserviceparameters]: machine-learning-web-service-parameters.md


## Развертывание прогностического эксперимента в качестве веб-службы

Теперь, когда прогностический эксперимент был необходимым образом подготовлен, его можно развернуть в качестве веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Дополнительную информацию обо всем процессе развертывания см. в разделе [Развертывание веб-службы машинного обучения Azure][deploy].

[deploy]: machine-learning-publish-a-machine-learning-web-service.md


<!-- Images -->
[figure1]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure1.png
[figure2]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure2.png
[figure3]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure3.png
[figure4]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure4.png
[figure5]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure5.png
[figure6]: ./media/machine-learning-convert-training-experiment-to-scoring-experiment/figure6.png


<!-- Module References -->
[clean-missing-data]: https://msdn.microsoft.com/library/azure/d2c5ca2f-7323-41a3-9b7e-da917c99f0c4/
[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/
[project-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[reader]: https://msdn.microsoft.com/library/azure/4e1b0fe6-aded-4b3f-a36f-39b8862b9004/
[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/
[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/
[writer]: https://msdn.microsoft.com/library/azure/7a391181-b6a7-4ad4-b82d-e419c0d6522c/

<!---HONumber=AcomDC_0204_2016-->