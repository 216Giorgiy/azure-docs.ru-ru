<properties 
	pageTitle="Создание простого эксперимента в Machine Learning Studio | Azure" 
	description="Как создать эксперимент для обучения и проверки простой модели в Студии машинного обучения Azure" 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/07/2015" 
	ms.author="garye"/>

#Создание простого эксперимента в Azure Machine Learning Studio 
 
Эксперимент по прогнозной аналитике, по сути, состоит из компонентов для  создания модели, обучения модели, а также оценки и тестирования модели. Вы можете комбинировать их для создания эксперимента, который принимает данные, по ним обучает модель и применяет модель к новым данным. Вы также можете добавить модули для предварительной обработки данных и выбрать признаки, разделить данные на наборы для обучения и проверки, а также оценить качество модели или провести его перекрестную проверку.  

В этой статье мы воспользуемся Студией машинного обучения Azure для разработки и выполнения итерации простого эксперимента по прогнозной аналитике. Чтобы открыть Студию машинного обучения, щелкните следующую ссылку: [https://studio.azureml.net/Home](https://studio.azureml.net/Home). Дополнительную информацию о начале работы со Студией машинного обучения см. на [домашней странице Студии машинного обучения Microsoft Azure](https://studio.azureml.net/). 
 

##Пять шагов для создания эксперимента 

Ниже приведено пять основных шагов для создания эксперимента в Студии машинного обучения, которые позволяют создавать, обучать и оценивать свою модель.  

- Создание модели 
	- [Шаг 1. Получение данных]
	- [Шаг 2. Предварительная обработка данных]
	- [Шаг 3. Определение признаков]
- Обучение модели 
	- [Шаг 4. Выбор и применение алгоритма обучения]
- Оценка и тестирование модели 
	- [Шаг 5. Прогнозирование новых данных] 

[Шаг 1. Получение данных]: #step-1-get-data
[Шаг 2. Предварительная обработка данных]: #step-2-preprocess-data
[Шаг 3. Определение признаков]: #step-3-define-features
[Шаг 4. Выбор и применение алгоритма обучения]: #step-4-choose-and-apply-a-learning-algorithm
[Шаг 5. Прогнозирование новых данных]: #step-5-predict-over-new-data 

В данном примере мы поэтапно создадим регрессионную модель с использованием выборки по данным об автомобилях. Цель заключается в прогнозировании стоимости автомобиля с использованием различных переменных, таких как дата производства и технические характеристики. 

### Шаг 1. Получение данных

В комплект поставки Студии машинного обучения входят несколько примеров наборов данных. Данные также можно импортировать из множества источников. Для данного примера мы воспользуемся прилагающимся примером набора данных **Данные о ценах на автомобили (необработанные)**, представляющим собой информацию о стоимости автомобилей.

1. Запустите новый эксперимент, щелкнув **+СОЗДАТЬ** в нижней части окна Студии машинного обучения, и выберите **ЭКСПЕРИМЕНТ**, а затем - "Пустой эксперимент". В верхней части холста выберите имя эксперимента по умолчанию и присвойте ему понятное имя, например **Прогнозирование цен на автомобили**.

2. В левой части области эксперимента расположена выборка данных и модулей. Введите **автомобили** в поле поиска в верхней части палитры и найдите набор данных с названием **Данные о ценах на автомобили (необработанные)**. 

	![Palette search][screen1a]

3. Перетащите выборку в область эксперимента. 

	![Dataset][screen1]

Чтобы просмотреть, как выглядят эти данные, щелкните два раза порт вывода в нижней части набора данных по автомобилям и выберите **Визуализировать**. Переменные в выборке выводятся в виде столбцов, каждый экземпляр автомобиля - в виде строк. Крайний правый столбец (столбец 26 с именем "Цена") - это та переменная, которую мы собираемся спрогнозировать. 

![Dataset visualization][screen1b]

Закройте окно визуализации, щелкнув **x** в правом верхнем углу.

### Шаг 2. Предварительная обработка данных

Перед анализом, как правило, требуется определенная предварительная обработка набора данных. Вы могли заметить, что в столбцах некоторых строк отсутствуют значения. Чтобы проанализировать данные, эти недостающие значения необходимо очистить. В нашем случае мы удалим все строки, в которых есть недостающие значения. Кроме того, в столбце **Нормированные потери** отсутствует очень много значений, так что мы полностью исключим этот столбец из модели. 

> [AZURE.TIP] Удаление недостающих значений из входных данных является необходимым условием для использования большинства модулей. 

Сначала мы удалим столбец **Нормированные потери**, а затем удалим все строки с недостающими данными. 

1. Введите **столбцы проекта** в поле поиска в верхней части палитры модулей, чтобы найти модуль **Столбцы проекта**, а затем перетащите его на холст эксперимента и подключите к порту вывода набора данных **Данные о ценах на автомобили (необработанные)**. Этот модуль позволяет выбрать, какие столбцы данных нужно включить в модель или исключить из нее. 

2. Выберите модуль **Столбцы проекта** и щелкните **Запустить средство выбора столбцов** в области свойств. 

	- Убедитесь, что в раскрывающемся списке фильтров **Начать с** выбрано значение **Все столбцы**. В этом случае модуль **Столбцы проекта** будет проходить все столбцы (кроме тех, которые мы собираемся исключить). 
	- В следующем ряду выберите **Исключить** и **названия столбцов**, а затем щелкните внутри текстового поля. Отобразится список столбцов. Выберите в нем **нормированные потери**, и этот столбец будет добавлен в текстовое поле. 
	- Нажмите кнопку "ОК", чтобы закрыть средство выбора столбцов.

    ![Select columns][screen3]
	
	Область свойств **Столбцы проекта** показывает, что обрабатываться будут все столбцы набора данных, за исключением столбца **Нормированные потери**. 

    ![Project Columns properties][screen4]

    > [AZURE.TIP] Дважды щелкните модуль и введите текст, чтобы добавить комментарий. Это поможет вам увидеть описание модуля и его действие в рамках эксперимента. В данном случае дважды щелкните модуль **Столбцы проекта** и введите комментарий "Исключены нормированные потери". 

3. Перетащите модуль **Очистка недостающих значений** на холст эксперимента и подключите его к модулю **Столбцы проекта**. В области **Свойства** выберите **Удалить строку полностью** в раскрывающемся списке **Для недостающих значений**, чтобы очистить данные путем удаления строк, содержащих недостающие значения. Дважды щелкните модуль и введите комментарий "Удаление строк с недостающими значениями".

	![Missing Values Scrubber properties][screen4a]

4. Запустите эксперимент, щелкнув **ПУСК** ниже холста эксперимента.

После завершения эксперимента у всех модулей должен появиться зеленый флажок, означающий их успешное завершение. Обратите также внимание на состояние **Работа завершена** в правом верхнем углу.

![First experiment run][screen5]

Все, что мы выполнили в эксперименте до этого момента, - это очистка данных. Чтобы просмотреть очищенный набор данных, щелкните порт вывода модуля **Очистка недостающих значений** и выберите **Визуализировать**. Обратите внимание, что столбца **Нормированные потери** больше нет. Кроме того, теперь нет недостающих значений.

После очистки данных мы готовы к заданию свойств, которые будут использоваться в прогнозной модели.

### Шаг 3. Определение признаков

В машинном обучении под *features* понимаются отдельные измеримые признаки интересующих объектов. В нашем наборе данных каждая строка представляет собой один автомобиль, а каждый столбец - его признак. Чтобы подобрать подходящий набор признаков для создания прогнозной модели, нужно разбираться в проблеме, которую необходимо решить, и провести ряд экспериментов. Некоторые свойства лучше подходят для прогнозирования цели, чем другие. Кроме того, некоторые признаки сильно коррелирую с другими признаками, например расход топлива при движении по городу и расход топлива при движении по шоссе. Таким образом, они не добавят много новой информации в модель и могут быть удалены.

Давайте создадим модель, которая использует подмножество свойств в нашей выборке. Можно вернуться назад и выбрать различные свойства, заново запустить эксперимент и оценить результаты. В качестве первого предположения мы выберем следующие признаки (столбцы) модуля **Столбцы проекта**. Обратите внимание, что для обучения модели нам необходимо включить значение *price*, которое мы собираемся спрогнозировать.

	make, body-style, wheel-base, engine-size, horsepower, peak-rpm, highway-mpg, price

1. Перетащите еще один модуль **Столбцы проекта** на холст эксперимента и подключите его к модулю **Очистка недостающих значений**. Дважды щелкните модуль и введите: "Выбор признаков для прогнозирования".

2. В области **Свойства** щелкните **Запустить средство выбора столбцов**. 

3. В средстве выбора столбцов выберите **Нет столбцов** в раскрывающемся списке **Начать с**, а затем выберите **Включить** и **названия столбцов** в строке фильтра. Введите наш список столбцов. В этом случае модуль будет передавать на вывод только указанные нами столбцы.

	> [AZURE.TIP] Так как мы запустили эксперимент, определения столбцов для наших данных передаются из исходного набора данных через модуль **Очистка недостающих значений**. После подключения модуля **Столбцы проекта** к модулю **Очистка недостающих значений** модуль **Столбцы проекта** получает информацию обо всех определениях столбцов наших данных. Если щелкнуть мышью в поле **названия столбцов**, отобразится список столбцов, и вы сможете выбрать столбцы для добавления в список. 

4. Щелкните значок с изображением флажка (кнопка "ОК").

![Select columns][screen6]

В результате получится набор данных, который будет использоваться в алгоритме обучения на последующих этапах. Позже вы сможете вернуться назад и заново попробовать выбрать другой набор признаков. 

### Шаг 4. Выбор и применение алгоритма обучения

Теперь, когда данные готовы, процесс создания прогнозной модели состоит из обучения и проверки.  *Classification* и  *regression* - это два типа методов контролируемого машинного обучения. Классификация используется, чтобы сформировать прогноз по заданной выборке значений, таких как цвет (красный, синий, или зеленый). Регрессия используется для того, чтобы сформировать прогноз по непрерывному множеству значений, таких как возраст человека.

Мы хотим предсказать цену автомобиля, которая может принимать любое значение, поэтому мы будем использовать модель регрессии. В этом примере мы будем обучать простую модель *linear regression*, а на следующем этапе будем ее тестировать. 

1. Разделим данные на обучающую и тестовую выборки. Выберите и перетащите модуль **Разделение** на холст эксперимента и подключите его к выводу модуля **Столбцы проекта**. Установите для параметра **Доля строк в первом выходном наборе данных** значение "0,75". Таким образом, мы используем 75 % данных для обучения модели и оставим 25 % для тестирования.

	> [AZURE.TIP] Изменяя параметр **Случайное значение**, вы можете создавать различные случайные выборки для обучения и тестирования. Этот параметр задает начальное значение для генератора псевдослучайных чисел.
	
2. Запустите эксперимент. При этом модули **Столбцы проекта** и **Разделение** передают определения столбцов в модули, которые будут добавлены на следующем этапе.  

3. Для выбора алгоритма обучения разверните категорию **Машинное обучение** на палитре модулей слева на холсте эксперимента, а затем разверните **Инициализировать модель**. Появится несколько категорий модулей, которые можно использовать для инициализации алгоритма обучения. 

	Для эксперимента выберите модуль **Линейная регрессия** из категории **Регрессия** (чтобы его найти, также можно ввести "Линейная регрессия" в поле поиска палитры) и перетащите его на холст эксперимента.

4. Найдите и переместите модуль **Обучение модели** в эксперимент. Подключите левый порт ввода к порту вывода модуля **Линейная регрессия**. Подключите правый порт ввода к порту вывода данных для обучения (левому порту) модуля **Разделение**.

5. Запустите эксперимент для передачи определений столбцов в модуль **Обучение модели**.
 
6. Выберите модуль **Обучение модели**, щелкните **Запустить средство выбора столбцов** в области **Свойства** и выберите столбец **цена**. Это значение, которое наша модель собирается спрогнозировать.

	![Select "price" column][screen7]

7. Запустите эксперимент. 

В результате получим обученную регрессионную модель, которую можно использовать для оценки новых значений с целью прогнозирования. 

![Applying the learning algorithm][screen8]

### Шаг 5. Прогнозирование новых данных 

После того, как мы обучили модель, ее можно использовать для оценки оставшихся 25 % наших данных, чтобы проверить, насколько хорошо она работает. 

1. Найдите и перетащите модуль **Оценка модели** на холст эксперимента и подключите левый порт ввода к порту вывода модуля **Обучение модели**. Подключите правый порт ввода к выводу проверочных данных (правому порту) модуля **Разделение**.  

	![Score Model module][screen8a]

2. Запустите эксперимент и проверьте вывод модуля **Оценка модели** (щелкните порт вывода и выберите **Визуализировать**). На порту вывода будут показаны прогнозируемые значения цены вместе с известными значениями проверочных данных.  

3. Наконец, чтобы проверить качество результатов, выберите и перетащите модуль **Анализ модели** на холст эксперимента и подключите левый порт ввода к порту вывода модуля **Оценка модели**. (Так как модуль **Анализ модели** можно использовать для сравнения двух моделей, предусмотрено два порта ввода.)
 
4. Запустите эксперимент и проверьте вывод модуля **Анализ модели** (щелкните порт вывода и выберите **Визуализировать**). Для нашей модели будет выведена следующая статистика.

	- **Средняя абсолютная погрешность** (MAE) - среднее значение абсолютных погрешностей ( *error* - это разница между спрогнозированным и фактическим значением).
	- **Среднеквадратичное отклонение** (RMSE) - квадратный корень из среднего значения возведенных в квадрат арифметических отклонений спрогнозированных значений от тестового набора данных.
	- **Относительная абсолютная погрешность** - среднее арифметическое отклонение по отношению к абсолютной разнице между фактическими значениями и средним арифметическим всех фактических значений.
	- **Относительное среднеквадратичное отклонение**- среднее арифметическое среднеквадратичных отклонений по отношению к среднеквадратичной разнице между фактическими значениями и средним арифметическим всех фактических значений.
	- **Коэффициент детерминации**  (или **R в квадрате**) - статистический показатель, который оценивает соответствие модели данным.
	
	Чем меньше значение каждой погрешности, тем лучше. Меньшее значение указывает на то, что прогноз лучше соответствует фактическим значениям. Прогноз тем точнее, чем ближе значение показателя **коэффициента детерминации** к единице (1,0).

	![Evaluation results][screen9]

В окончательном виде эксперимент должен выглядеть следующим образом:

![Complete experiment][screen10]

### Что дальше?

После настройки эксперимента можно запустить его еще раз, чтобы попытаться улучшить модель. Например, можно изменить свойства, которые используются в прогнозировании. Либо вы можете изменить свойства алгоритма **линейной регрессии**, либо попробовать использовать вместе с ним другой алгоритм. Можно даже добавить в эксперимент несколько алгоритмов одновременно и сравнивать их, используя модуль **Анализ модели**. 

> [AZURE.TIP] Используйте кнопку **СОХРАНИТЬ КАК** под холстом эксперимента, чтобы создать копию любой итерации вашего эксперимента. Вы можете просмотреть все итерации вашего эксперимента, нажав кнопку **ПРОСМОТР ИСТОРИИ ЗАПУСКОВ** ниже холста эксперимента. Дополнительную информацию см. в разделе [Управление итерациями экспериментов в Студии машинного обучения Azure][runhistory].

[runhistory]: machine-learning-manage-experiment-iterations.md

Если вы удовлетворены результатами своей модели, вы можете опубликовать ее в качестве веб-службы, чтобы ее можно было использовать для прогнозирования цен на автомобили, используя новые данные. Дополнительную информацию см. в разделе [Публикация веб-службы Машинного обучения Azure][publish].

[publish]: machine-learning-publish-a-machine-learning-web-service.md

Более обширное и подробное пошаговое руководство по созданию, обучению, оценке и публикации прогнозной модели см. в разделе [Разработка прогнозирующего решения с помощью машинного обучения Azure][walkthrough]. 

[walkthrough]: machine-learning-walkthrough-develop-predictive-solution.md

<!-- Images -->
[screen1]:./media/machine-learning-create-experiment/screen1.png
[screen1a]:./media/machine-learning-create-experiment/screen1a.png
[screen1b]:./media/machine-learning-create-experiment/screen1b.png
[screen2]:./media/machine-learning-create-experiment/screen2.png
[screen3]:./media/machine-learning-create-experiment/screen3.png
[screen4]:./media/machine-learning-create-experiment/screen4.png
[screen4a]:./media/machine-learning-create-experiment/screen4a.png
[screen5]:./media/machine-learning-create-experiment/screen5.png
[screen6]:./media/machine-learning-create-experiment/screen6.png
[screen7]:./media/machine-learning-create-experiment/screen7.png
[screen8]:./media/machine-learning-create-experiment/screen8.png
[screen8a]:./media/machine-learning-create-experiment/screen8a.png
[screen9]:./media/machine-learning-create-experiment/screen9.png
[screen10]:./media/machine-learning-create-experiment/screen10.png

<!--HONumber=49--> 