---
title: "Шаг 4. Обучение и анализ моделей прогнозирующей аналитики | Документация Майкрософт"
description: "Четвертый этап пошагового руководства по разработке прогнозного решения: обучение и оценка нескольких моделей в студии машинного обучения Azure."
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: d905f6b3-9201-4117-b769-5f9ed5ee1cac
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/04/2016
ms.author: garye
translationtype: Human Translation
ms.sourcegitcommit: 2ea002938d69ad34aff421fa0eb753e449724a8f
ms.openlocfilehash: 434e7e2c40f98956de44435c23642bdee6072379


---
# <a name="walkthrough-step-4-train-and-evaluate-the-predictive-analytic-models"></a>Шаг 4. Обучение и анализ моделей прогнозирующей аналитики
Это четвертая часть пошагового руководства [по разработке решения для прогнозной аналитики в Машинном обучении Azure](machine-learning-walkthrough-develop-predictive-solution.md).

1. [Создание рабочей области машинного обучения](machine-learning-walkthrough-1-create-ml-workspace.md)
2. [Отправка существующих данных](machine-learning-walkthrough-2-upload-data.md)
3. [Создание нового эксперимента](machine-learning-walkthrough-3-create-new-experiment.md)
4. **Обучение и анализ моделей**
5. [Развертывание веб-службы](machine-learning-walkthrough-5-publish-web-service.md)
6. [Доступ к веб-службе](machine-learning-walkthrough-6-access-web-service.md)

- - -
Одним из преимуществ использования студии машинного обучения Azure для создания моделей машинного обучения является возможность проверки нескольких типов модели и сравнения результатов во время эксперимента. Этот тип экспериментов помогает найти наилучшее решение проблемы.

В эксперименте, разрабатываемом в этом пошаговом руководстве, мы создадим два разных типа модели и сравним результаты их оценки, чтобы решить, какой алгоритм мы хотим использовать в нашем финальном эксперименте.  

Существует множество моделей, которые можно выбрать. Чтобы просмотреть доступные модели, разверните узел **Машинное обучение** в палитре модулей, а затем **Initialize Model** (Инициализация модели) и узлы под ним. Для данного эксперимента мы выберем метод опорных векторов (SVM) и двухклассовые увеличивающиеся деревья решений.    

> [!TIP]
> Чтобы решить, какой алгоритм машинного обучения лучше всего подойдет для решения конкретной задачи, изучите статью [Выбор алгоритмов Машинного обучения Microsoft Azure](machine-learning-algorithm-choice.md).
> 
> 

## <a name="train-the-models"></a>Обучение моделей
Сначала давайте настроим модель увеличивающегося дерева решений.  

1. Найдите модуль [Двухклассовое повышенное дерево принятия решений][two-class-boosted-decision-tree] в палитре модулей и перетащите его на холст.
2. Найдите модуль [Обучение модели][train-model], перетащите его на холст, а затем подключите порт вывода модуля повышенного дерева принятия решений к левому порту ввода (Untrained model (Необученная модель)) модуля [Обучение модели][train-model].
   
   Модуль [Двухклассовое повышенное дерево принятия решений][two-class-boosted-decision-tree] инициализирует универсальную модель, а модуль [Обучение модели][train-model] использует данные для обучения, чтобы обучить модель. 
3. Подключите левый порт вывода модуля [Выполнение скрипта R][execute-r-script] слева к правому порту ввода (Dataset (Набор данных)) модуля [Обучение модели][train-model].
   
   > [!TIP]
   > Для этого эксперимента не нужны два порта ввода и один порт вывода модуля [Выполнение скрипта R][execute-r-script], и мы просто оставим их неподключенными. 
   > 
   > 
4. Выберите модуль [Обучение модели][train-model]. В области **Свойства** щелкните **Launch column selector** (Запустить средство выбора столбцов), выберите в раскрывающемся списке значение **Все типы** для параметра **Available Columns** (Доступные столбцы) и введите в текстовом поле Credit risk (Кредитный риск). Выберите значение **Все типы** в раскрывающемся списке **Selected Columns** (Выбранные столбцы). Выберите значение Credit risk (Кредитный риск) и нажмите кнопку со стрелкой, чтобы переместить его в **Selected Columns** (Выбранные столбцы). 
5. Щелкните **Сохранить**.

Теперь эта часть эксперимента выглядит следующим образом.  

![Обучение модели][1]

Теперь настроим модель SVM.  

Сначала немного информации о SVM. "Повышенные" деревья принятия решения хорошо работают с атрибутами любого типа. Однако поскольку модуль SVM создает линейный классификатор, генерируемая им модель имеет наименьшую ошибку при проверке среди всех атрибутов одного масштаба. Чтобы свести все числовые признаки к одному масштабу, мы используем преобразование Tanh, которое включено в модуль [Нормализация данных][normalize-data]. Этот алгоритм преобразует все числа в значения, лежащие в интервале [0,1]. Модуль SVM преобразовывает строковые признаки в категориальные, а затем в бинарные атрибуты 0/1, поэтому вручную их преобразовывать не нужно. Кроме того, мы не хотим преобразовывать столбец кредитного риска (столбец 21) — он числовой, но мы обучаем модель прогнозировать именно его значение, поэтому нам не нужно его трогать.  

Чтобы настроить модель SVM, выполните следующие действия:

1. Найдите модуль [Двухклассовый метод опорных векторов][two-class-support-vector-machine] в палитре модулей и перетащите его на холст.
2. Щелкните правой кнопкой мыши модуль [Обучение модели][train-model], выберите команду **Копировать**, а затем щелкните правой кнопкой мыши холст и выберите пункт **Вставить**. Обратите внимание, что у копии модуля [Обучение модели][train-model] такой же набор выбранных столбцов, что и у оригинала.
3. Подключите порт вывода модуля SVM к левому порту ввода (Untrained model (Необученная модель)) второго модуля [Обучение модели][train-model].
4. Найдите модуль [Нормализация данных][normalize-data] и перетащите его на холст.
5. Подключите порт ввода этого модуля к левому порту вывода левого модуля [Выполнение скрипта R][execute-r-script] (обратите внимание, что порт вывода модуля может быть подключен к нескольким модулям).
6. Подключите левый порт вывода (Transformed Dataset (Преобразованный набор данных)) модуля [Нормализация данных][normalize-data] к правому порту ввода (Dataset (Набор данных)) второго модуля [Обучение модели][train-model].
7. На панели **Свойства** для модуля [Нормализация данных][normalize-data] выберите значение **Tanh** для параметра **Transformation method** (Метод преобразования).
8. Щелкните **Запустить средство выбора столбцов** (Launch column selector), укажите для параметра **Begin With** (Начало с) значение No columns (Без столбцов). В первом раскрывающемся списке выберите пункт **Включение**, во втором — **column type** (тип столбца), а в третьем — **Числовой**. Это указывает, что будут преобразованы все числовые столбцы (и только числовые).
9. Щелкните знак плюса (+) в правой части этой строки. Это позволит создать строку с раскрывающимися списками. Выберите значение **Исключить** в первом раскрывающемся списке, затем **column names** (Имена столбцов) во втором раскрывающемся списке. Щелкните текстовое поле и выберите значение Credit risk (Кредитный риск) в списке столбцов. Это указывает, что столбец "Кредитный риск" должен игнорироваться (это необходимо сделать, так как он является числовым и в противном случае будет преобразован).
10. Нажмите кнопку **ОК**.  

Теперь модуль [Нормализация данных][normalize-data] настроен для преобразования Tanh для всех числовых столбцов, кроме Credit risk (Кредитный риск).  

Теперь эта часть эксперимента должна выглядеть следующим образом:  

![Обучение второй модели][2]  

## <a name="score-and-evaluate-the-models"></a>Оценка и анализ моделей
Чтобы оценить обученные модели, мы будем использовать проверочные данные, которые отделены модулем [Разделение данных][split]. Затем можно сравнить результаты двух моделей, чтобы увидеть, которая модель создает лучший результат.  

1. Найдите модуль [Оценка модели][score-model] и перетащите его на холст.
2. Подключите модуль [Обучение модели][train-model], который подключен к модулю [Двухклассовое повышенное дерево принятия решений][two-class-boosted-decision-tree], к левому порту ввода нового модуля [Оценка модели][score-model].
3. Подключите правый порт ввода модуля [Оценка модели][score-model] к левому порту вывода правого модуля [Выполнение сценария R][execute-r-script].
   
   Теперь модуль [Оценка модели][score-model] может получать сведения о кредите из тестовых данных, пропустить их через модель и сравнить созданные ею прогнозы с фактическими данными из столбца кредитного риска в проверочных данных.
4. Скопируйте и вставьте модуль [Оценка модели][score-model], чтобы создать вторую копию, или перетащите новый модуль на холст.
5. Подключите левый порт ввода этого модуля к модели SVM (т. е. подключите его к порту вывода модуля [Обучение модели][train-model], который подключен к модулю [Двухклассовый метод опорных векторов][two-class-support-vector-machine]).
6. Для модели SVM необходимо выполнить то же самое преобразование тестовых данных, которое делалось для обучающих данных. Поэтому скопируйте и вставьте модуль [Нормализация данных][normalize-data], чтобы создать вторую копию, и подключите ее к левому порту вывода правого модуля [Выполнение сценария R][execute-r-script].
7. Подключите правый порт ввода модуля [Оценка модели][score-model] к левому порту вывода модуля [Нормализация данных][normalize-data].  

Чтобы проанализировать два результата оценки, мы будем использовать модуль [Анализ модели][evaluate-model].  

1. Найдите модуль [Анализ модели][evaluate-model] и перетащите его на холст.
2. Подключите левый порт ввода к порту вывода модуля [Оценка модели][score-model], связанного с моделью повышенного дерева принятия решений.
3. Подключите правый порт ввода к другому модулю [Оценка модели][score-model].  

Нажмите кнопку **ЗАПУСТИТЬ** внизу холста, чтобы запустить эксперимент. Это может занять несколько минут. В каждом модуле будет отображаться вращающийся индикатор, показывающий, что модуль выполняется, а когда модуль завершит работу, появится зеленая галочка. Если эта галочка появилась во всех модулях, значит эксперимент завершил выполнение.

Теперь наш эксперимент должен выглядеть следующим образом:  

![Сравнение обеих моделей][3]

Чтобы проверить результаты, щелкните правой кнопкой мыши порт вывода модуля [Анализ модели][evaluate-model] и выберите команду **Visualize** (Визуализировать).  

Модуль [Анализ модели][evaluate-model] создает пару кривых и метрики, позволяющие сравнить результаты двух оцененных моделей. Результаты можно видеть в виде кривых ROC (рабочих характеристик приемника), кривых точности/полноты или кривых точности прогноза. Дополнительные отображаемые данные включают матрицу несоответствий, накопительные значения для области под кривой (AUC) и другие метрики. Вы можете изменить пороговое значение, перемещая ползунок влево или вправо, чтобы посмотреть, как это влияет на набор метрик.  

В правой части графика щелкните **Scored dataset** (Оцененный набор данных) или **Scored dataset to compare** (Оцененный набор данных для сравнения), чтобы выделить соответствующую кривую и отобразить внизу соответствующие метрики. В условных обозначениях для кривых Scored dataset (Оцененный набор данных) соответствует левому порту ввода модуля [Анализ модели][evaluate-model] (в нашем случае это модель повышенного дерева принятия решений). "Оцененный набор данных для сравнения" соответствует правому входному порту — в нашем случае это модель SVM. Щелкните одну из этих меток, чтобы выделить кривую и отобразить внизу метрики для соответствующей модели, как показано на графике ниже.  

![Кривые ROC для моделей][4]

Изучив эти значения, можно определить, какая модель обеспечивает более точные результаты. Можно вернуться назад и выполнить итерацию в эксперименте, изменяя значения в разных моделях. 

> [!TIP]
> При каждом выполнении эксперимента запись об этой итерации сохраняется в журнале выполнения. Эти итерации можно просмотреть и вернуться к любой из них, нажав кнопку **ПРОСМОТР ЖУРНАЛА ВЫПОЛНЕНИЯ** под холстом. Можно также щелкнуть **Prior Run** (Предыдущее выполнение) на панели **Свойства**, чтобы открыть результаты предыдущей попытки сравнения.
> 
> Можно сделать копию любой итерации эксперимента, нажав кнопку **SAVE AS** (Сохранить как) под холстом. 
> Чтобы отслеживать, какие данные вы сравнивали на каждом этапе выполнения эксперимента, используйте свойства эксперимента **Сводка** и **Описание**.
> 
> Дополнительные сведения см. в статье [Управление итерациями экспериментов в Студии машинного обучения Azure](machine-learning-manage-experiment-iterations.md).  
> 
> 

- - -
**Дальнейшие действия: [Развертывание веб-службы](machine-learning-walkthrough-5-publish-web-service.md)**

[1]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train1.png
[2]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train2.png
[3]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train3.png
[4]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train4.png


<!-- Module References -->
[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/
[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/
[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/
[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/
[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/



<!--HONumber=Nov16_HO3-->


