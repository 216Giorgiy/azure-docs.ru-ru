<properties
	pageTitle="Использование веб-службы машинного обучения Azure с шаблоном веб-приложения | Microsoft Azure"
	description="Использование шаблона веб-приложения в Azure Marketplace для использования прогнозной веб-службы в машинном обучении Azure."
	keywords="веб-служба, ввод в эксплуатацию, REST API, машинное обучение"
	services="machine-learning"
	documentationCenter=""
	authors="garyericson"
	manager="paulettm"
	editor="cgronlun"/>

<tags
	ms.service="machine-learning"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="10/26/2015"
	ms.author="garye;raymondl"/>

# Использование веб-службы машинного обучения Azure с шаблоном веб-приложения

Разработав прогнозную модель и развернув ее в виде веб-службы Azure при помощи Студии машинного обучения или таких средств, как R или Python, вы можете обращаться к рабочей модели с помощью REST API.

Существует несколько способов использования REST API и доступа к веб-службе. Например, можно создать приложение в C#, R или Python, используя образец кода, созданного при развертывании веб-службы (доступен на странице справки API на панели мониторинга веб-службы в Студии машинного обучения). Кроме того, можно использовать созданный образец книги Microsoft Excel (также доступен на панели мониторинга веб-службы в Студии).

Но самым быстрым и легким способом доступа к веб-службе является доступ через шаблоны веб-приложений, доступные в [Azure Web App Marketplace](https://azure.microsoft.com/marketplace/web-applications/all/).

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## Шаблоны веб-служб машинного обучения Azure

С помощью шаблонов веб-служб, доступных в Azure Marketplace, можно создать пользовательское веб-приложение, которое «знает» входные данные вашей веб-службы и ожидаемые результаты. Вам нужно всего лишь предоставить веб-приложению доступ к веб-службе и данным, а шаблон выполнит все остальные действия.

Доступны два шаблона:

- [шаблон веб-приложения службы «запрос — ответ» Azure ML](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlaspnettemplateforrrs/);
- [шаблон веб-приложения службы пакетного выполнения Azure ML](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlbeswebapptemplate/).

Каждый шаблон создает образец приложения ASP.NET, используя URI API и ключ для вашей веб-службы, и развертывает его как веб-сайт в Azure. Шаблон службы «запрос — ответ» (RRS) создает веб-приложение, которое позволяет отправлять одну строку данных в веб-службу для получения одного результата. Шаблон службы пакетного выполнения (BES) создает веб-приложение, которое позволяет отправлять несколько строк данных, чтобы получить несколько результатов.

Для использования этих шаблонов не требуется создавать код. Вы просто предоставляете URI API и ключ, а шаблон создается в приложении.

## Использование шаблона службы «запрос-ответ» (RRS)

После развертывания веб-службы можно выполнить следующие действия, чтобы использовать шаблон веб-приложения RRS, как показано на схеме ниже.

![Использование веб-шаблона RRS][image1]

1. В Студии машинного обучения откройте вкладку **Веб-службы**, а затем откройте веб-службу, к которой нужно получить доступ. Скопируйте ключ, указанный в разделе **Ключ API**, и сохраните его.

	![Ключ API][image3]

2. Откройте страницу справки API **ЗАПРОС — ОТВЕТ**. В верхней части страницы справки в разделе **Запрос** скопируйте значение **URI запроса** и сохраните его. Это значение будет выглядеть следующим образом:

		https://ussouthcentral.services.azureml.net/workspaces/<workspace-id>/services/<service-id>/execute?api-version=2.0&details=true

	![URI запроса][image4]

3. Перейдите по ссылке [Веб-приложение службы ответов на запросы Azure ML](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlaspnettemplateforrrs/) и нажмите кнопку **Создать веб-приложение**. Шаблон перенаправит вас на классический портал Microsoft Azure, где создается новое веб-приложение.

	- Присвойте веб-приложению уникальное имя. URL-адресом веб-приложения будет это имя с текстом `.azurewebsites.net.`. Например: `http://carprediction.azurewebsites.net.`

	- Выберите подписку Azure и службы, с которыми работает ваша веб-служба.

	- Щелкните **Создать**.

	![Создание веб-приложения][image5]

4. Когда служба Azure завершит развертывание веб-приложения, щелкните **URL-адрес** на странице параметров веб-приложения в Azure или введите URL-адрес в веб-браузере. Например, `http://carprediction.azurewebsites.net.`

5. При первом запуске веб-приложение запросит **URL-адрес записи API** и **Ключ API**. Введите значения, которые были сохранены ранее:
	- **URI запроса** со страницы справки API в поле **URL-адрес записи API**;
	- **ключ API** со страницы панели мониторинга веб-службы в поле **Ключ API**.

	Нажмите кнопку **Submit** (Отправить).

	![Введите Post URI и ключ API][image6]

6. Веб-приложение отобразит страницу **Конфигурация веб-приложения** с текущими параметрами веб-службы. Здесь можно вносить изменения в параметры, используемые веб-приложением.

	> [AZURE.NOTE]Изменение этих параметров влияет только на параметры этого веб-приложения. Это не изменяет параметры веб-службы по умолчанию. Например, если изменить параметр **Описание**, описание, отображаемое на панели мониторинга веб-службы в Студии машинного обучения, не изменится.

	Когда все будет готово, нажмите кнопку **Сохранить изменения**, а затем щелкните **Перейти на домашнюю страницу**.

7. На домашней странице можно ввести значения для отправки в веб-службу, нажать кнопку **Отправить** и получить результат.

Если вы хотите вернуться на страницу **Конфигурация**, перейдите на страницу веб-приложения `setting.aspx`. Например: `http://carprediction.azurewebsites.net/setting.aspx.`. Вам будет предложено ввести ключ API снова, чтобы получить доступ к странице и обновить параметры.

На классическом портале Azure можно остановить, перезапустить или удалить данное веб-приложение, как и любое другое веб-приложение. При условии что приложение работает, можно перейти к домашнему веб-адресу и ввести новые значения.

## Использование шаблона службы пакетного выполнения (BES)

Шаблон веб-приложения BES можно использовать так же, как и шаблон RRS. Исключение состоит только в том, что создаваемое веб-приложение позволит передавать несколько строк данных и получать несколько результатов.

Результаты веб-службы пакетного выполнения хранятся в контейнере хранилища Azure. Входные значения могут поступать из хранилища Azure или из локального файла. Таким образом, вам потребуется контейнер хранилища Azure для хранения результатов, возвращаемых веб-приложением. Вам также нужно будет подготовить входные данные.

![Использование веб-шаблона BES][image2]

1. Чтобы создать веб-приложение BES, выполните ту же процедуру, что и для шаблона RRS, кроме таких действий:
	- получить **URI запроса** со страницы справки API **ПАКЕТНОГО ВЫПОЛНЕНИЯ** для веб-службы;
	- перейти по ссылке [Шаблон веб-приложения службы пакетного выполнения Azure ML](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlbeswebapptemplate/), чтобы открыть шаблон BES в Azure Marketplace, а затем нажать кнопку **Создать веб-приложение**.

2. Чтобы указать, куда следует сохранить результаты, введите сведения о целевом контейнере на домашней странице веб-приложения. Кроме того, укажите источник входных значений для веб-приложения: локальный файл или контейнер хранилища Azure. Нажмите кнопку **Submit** (Отправить).

	![Сведения о хранилище][image7]

Веб-приложение отобразит страницу с состоянием задания. После завершения задания будет указано расположение результатов в хранилище больших двоичных объектов Azure. Результаты также можно загрузить в локальный файл.

## Дополнительные сведения

Дополнительная информация.

- Создание эксперимента машинного обучения в Студии машинного обучения — см. раздел [Создание первого эксперимента в Студии машинного обучения Azure](machine-learning-create-experiment.md).

- Развертывание эксперимента машинного обучения как веб-службы — см. раздел [Развертывание веб-службы машинного обучения Azure](machine-learning-publish-a-machine-learning-web-service.md).

- Другие способы доступа к веб-службе — см. раздел [Использование веб-службы машинного обучения Azure](machine-learning-consume-web-services.md).


[image1]: media\machine-learning-consume-web-service-with-web-app-template\rrs-web-template-flow.png
[image2]: media\machine-learning-consume-web-service-with-web-app-template\bes-web-template-flow.png
[image3]: media\machine-learning-consume-web-service-with-web-app-template\api-key.png
[image4]: media\machine-learning-consume-web-service-with-web-app-template\post-uri.png
[image5]: media\machine-learning-consume-web-service-with-web-app-template\create-web-app.png
[image6]: media\machine-learning-consume-web-service-with-web-app-template\web-service-info.png
[image7]: media\machine-learning-consume-web-service-with-web-app-template\storage.png

<!---HONumber=AcomDC_1203_2015-->