---
title: "Глубокое обучение реальным сценариям прогнозного обслуживания в Azure | Документация Майкрософт"
description: "Узнайте больше о репликации руководства по глубокому обучению для прогнозного обслуживания с использованием Azure Machine Learning Workbench."
services: machine-learning
author: ehrlinger
ms.author: jehrling
manager: ireiter
ms.reviewer: garyericson, jasonwhowell, mldocs
ms.service: machine-learning
ms.workload: data-services
ms.custom: mvc
ms.devlang: 
ms.topic: article
ms.date: 11/22/2017
ms.openlocfilehash: 7d4fe98b5c45767fb06391218e80789fc0c96a3b
ms.sourcegitcommit: 95500c068100d9c9415e8368bdffb1f1fd53714e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2018
---
# <a name="deep-learning-for-predictive-maintenance-real-world-scenario"></a>Глубокое обучение реальным сценариям прогнозного обслуживания.

Глубокое обучение является одной из самых популярных тенденций в машинном обучении вместе с приложениями для множества областей, включая:
- беспилотные автомобили и робототехнику;
- программы распознавания речи и изображений;
- финансовое прогнозирование.

Эти методы, также известны как глубокие нейронные сети (DNN), построенные по принципу работы отдельных нейронов человеческого мозга (биологических нейронных сетей).

Незапланированный простой оборудования может оказывать неблагоприятное влияние на предприятие. Важно поддерживать рабочее состояние используемого оборудования, чтобы обеспечить максимально эффективное использование ресурсов, добиться максимальной производительности и минимизировать время затратных незапланированных простоев. Раннее определение проблем позволяет выделить ограниченные ресурсы обслуживания с наименьшими затратами, а также повысить качество и эффективность выполнения процессов логистической цепочки. 

Стратегия прогнозного обслуживания (PM) использует методы машинного обучения для определения состояния оборудования, чтобы выполнять обслуживание заблаговременно для поддержки должного уровня производительности компьютера. В прогнозном обслуживании динамические данные время от времени анализируются для мониторинга состояния компьютера, чтобы обнаружить шаблоны, которые можно использовать для прогнозирования сбоев. Сети [долгой краткосрочной памяти (LSTM)](http://colah.github.io/posts/2015-08-Understanding-LSTMs/) полезны в этом сценарии, так как они предназначены для получения сведений из последовательности данных.

## <a name="link-to-the-gallery-github-repository"></a>Ссылка на репозиторий коллекции на GitHub

Вот ссылка на общедоступный репозиторий GitHub для оформления отчета о проблемах и вкладах: [https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance](https://github.com/Azure/MachineLearningSamples-DeepLearningforPredictiveMaintenance) 

## <a name="use-case-overview"></a>Обзор варианта использования

Для демонстрации процесса моделирования прогнозного обслуживания в этом руководстве используется пример имитированных событий эксплуатации двигателей самолета до отказа. Этот сценарий описан в статье о [прогнозном обслуживании](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Template-3).

Основное предположение в этом сценарии: снижение функциональности двигателя в течение времени его существования. Снижение функциональности можно обнаружить по измерениям датчика двигателя. Стратегия прогнозного обслуживания пытается смоделировать связь между изменениями в значениях этого датчика и произошедшими сбоями. Затем на основе измерений текущего состояния датчика можно будет спрогнозировать, когда случится сбой в двигателе.

Этот сценарий создает сеть LSTM для прогнозирования оставшегося срока полезного использования (RUL) двигателей самолета с применением исторических значений датчика. Используя платформу глубокого обучения [Keras](https://keras.io/) с [Tensorflow](https://www.tensorflow.org/) в качестве системы вычислений, этот сценарии обучает сеть LSTM, применяя один набор двигателей, и тестирует сети на многих неучитываемых двигателях.

## <a name="prerequisites"></a>предварительным требованиям
- [Учетная запись Azure](https://azure.microsoft.com/free/) (доступны бесплатные пробные версии).
- Azure Machine Learning Workbench с созданной рабочей областью.
- Для ввода модели в эксплуатацию: компонент Azure Machine Learning Operationalization с настроенной средой для локального развертывания и [учетной записью Управления моделями машинного обучения Azure](model-management-overview.md).

## <a name="create-a-new-workbench-project"></a>Создание проекта в Workbench

Создайте проект, используя в качестве шаблона следующий пример:

1. Откройте Machine Learning Workbench.
2. На странице **Projects** (Проекты) щелкните **+** и выберите **New Project** (Создать проект).
3. В области **Create New Project** (Создание проекта) введите информацию о новом проекте.
4. В поле поиска **Search Project Templates** (Поиск шаблонов проектов) введите "Прогнозное обслуживание" и выберите шаблон **Deep Learning for Predictive Maintenance Scenario** (Сценарий глубокого обучения для прогнозного обслуживания).
5. Нажмите кнопку **Создать**.

## <a name="prepare-the-notebook-server-computation-target"></a>Подготовка целевого объекта вычислений для сервера записных книжек

Чтобы запустить проект на локальном компьютере, в меню `File` AML Workbench выберите пункт `Open Command Prompt` или `Open PowerShell CLI`. Интерфейс CLI предоставляет доступ к службам Azure с помощью команд `az`. Сначала войдите в свою учетную запись Azure с помощью команды:

```
az login
``` 

Эта команда предоставляет ключ аутентификации для использования с URL-адресом `https:\\aka.ms\devicelogin`. CLI ожидает, пока операция входа в устройство не вернет данные о подключении. Затем, если у вас выполнена локальная установка [docker](https://www.docker.com/get-docker), подготовьте локальную вычислительную среду с помощью следующих команд:

```
az ml experiment prepare --target docker --run-configuration docker
```

Выполнять эту задачу рекомендуется на [виртуальной машине для обработки и анализа данных для Linux (Ubuntu)](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/microsoft-ads.linux-data-science-vm-ubuntu) с учетом требований к памяти и диску. После настройки DSVM подготовьте удаленную среду Docker с помощью следующих двух команд:

```
az ml computetarget attach remotedocker --name [Connection_Name] --address [VM_IP_Address] --username [VM_Username] --password [VM_UserPassword]
```

После подключения к удаленному контейнеру Docker подготовьте вычислительную среду DSVM Docker с помощью следующей команды: 

```
az ml experiment prepare --target [Connection_Name] --run-configuration [Connection_Name]
```

Подготовив вычислительную среду Docker, откройте сервер записных книжек Jupyter, используя вкладку записных книжек в AML Workbench, или запустите сервер в браузере с помощью команды: 
```
az ml notebook start
```

Примеры записных книжек хранятся в каталоге `Code`. Записные книжки настроены на последовательный запуск, начиная с первой (`Code\1_data_ingestion.ipynb`). При открытии каждой записной книжки вам будет предложено выбрать ядро для вычислений. Выберите ядро `[Project_Name]_Template [Connection_Name]` для выполнения на ранее настроенной машине DSVM.

## <a name="data-description"></a>Описание данных

В шаблоне используется три набора данных в качестве входных данных в файлах **PM_train.txt**, **PM_test.txt** и **PM_truth.txt**. 

-  **Данные для обучения**: данные эксплуатации двигателя самолета до отказа. Данные для обучения (PM_train.txt) состоят из нескольких многомерных линейных временных рядов, в которых *цикл* используется в качестве единицы времени. Они содержат 21 показание датчика для каждого цикла. 

    - Каждый временной ряд создан из другого двигателя того же типа. Каждый двигатель начинает работу с разной степенью начального износа и уникальными производственными разновидностями. Эти сведения неизвестны пользователю. 

    - В этих смоделированных данных предполагается, что двигатель нормально работает в начале каждого временного ряда. Интенсивность его работы начинает снижаться в определенный момент в течение нескольких циклов работы. Снижение производительности прогрессирует и увеличивается. 

    - При достижении предварительно определенного порогового значения двигатель считается небезопасным для дальнейшей эксплуатации. Последний цикл каждого временного ряда является точкой сбоя этого двигателя.

-   **Данные для тестирования**: данные эксплуатации двигателя самолета без регистрируемых событий сбоя. В данных для тестирования (PM_test.txt) используется та же схема данных, что и в данных для обучения. Единственное отличие заключается в том, что данные не указывают время возникновения сбоя (последний период *не* представляет собой точку сбоя). Неизвестно, сколько еще циклов этот двигатель может отработать до сбоя.

- **Экспериментальные данные**: сведения об оставшихся циклах для каждого двигателя в данных тестирования. Экспериментальные данные указывают количество оставшихся рабочих циклов для двигателей в данных тестирования.

## <a name="scenario-structure"></a>Структура сценария

Рабочий процесс сценария состоит из трех шагов, каждый из которых выполняется в записной книжке Jupyter. Каждая записная книжка выводит данные артефактов, которые сохраняются локально для использования в следующих записных книжках. 

### <a name="task-1-data-ingestion-and-preparation"></a>Задача 1. Прием и подготовка данных

Записная книжка Jupyter для приема данных в `Code/1_data_ingestion_and_preparation.ipnyb` загружает три набора входных данных в формате кадров данных Pandas. Затем она подготавливает данные для моделирования и выполняет их предварительную визуализацию. Эти наборы данных хранятся локально в контексте вычислений для использования в записной книжке создания моделей.

### <a name="task-2-model-building-and-evaluation"></a>Задача 2. Создание и оценка модели

Записная книжка Jupyter для создания моделей в `Code/2_model_building_and_evaluation.ipnyb` считывает наборы данных для обучения и тестирования с диска и создает сеть LSTM с наборами данных для обучения. Производительность модели измеряется в тестовом наборе. Результирующая модель сериализуется и сохраняется в локальном контексте вычислений для использования в задаче ввода в эксплуатацию.

### <a name="task-3-operationalization"></a>Задача 3. Ввод модели в эксплуатацию

Записная книжка Jupyter для ввода в эксплуатацию в `Code/3_operationalization.ipnyb` использует сохраненную модель для создания функций и схемы для вызова модели в веб-службе, размещенной в Azure. Записная книжка тестирует функции, а затем сжимает ресурсы в файл `LSTM_o16n.zip`, который загружается в контейнер хранилища Azure для развертывания.

Файл развертывания `LSTM_o16n.zip` содержит следующие артефакты.

- `webservices_conda.yaml` — определяет пакеты Python, необходимые для запуска модели LSTM на целевом объекте развертывания.  
- `service_schema.json` — определяет схему данных, ожидаемую в модели LSTM.     
- `lstmscore.py` — определяет функции, выполняющиеся целевым объектом развертывания для оценки новых данных.    
- `modellstm.json` — определяет архитектуру LSTM. Функции lstmscore.py считывают архитектуру и весовые коэффициенты для инициализации модели.
- `modellstm.h5` — определяет модель весовых коэффициентов.
- `test_service.py` — сценарий теста, вызывающий конечную точку развертывания, используя тестовые записи данных. 
- `PM_test_files.pkl` — сценарий `test_service.py` считывает исторические данные двигателя из файла `PM_test_files.pkl` и отправляет в веб-службу достаточное количество циклов для LSTM, чтобы определить вероятность сбоя двигателя.

Записная книжка проверяет функции, используя определения модели, а затем упаковывает эти ресурсы для развертывания. Инструкции по настройке и тестированию веб-службы содержатся в конце записной книжки `Code/3_operationalization.ipnyb`.

## <a name="conclusion"></a>Заключение

В этом руководстве используется простой сценарий, применяющий значения датчика для создания прогнозов. Более сложные сценарии прогнозного обслуживания, такие как [Predictive Maintenance Modelling Guide R Notebook](https://gallery.cortanaintelligence.com/Notebook/Predictive-Maintenance-Modelling-Guide-R-Notebook-1) (Записная книжка R руководства по моделированию прогнозного обслуживания), могут использовать много источников данных (например, исторические записи обслуживания, журналы ошибок и возможности компьютера). В глубоком обучении для дополнительных источников данных может потребоваться использование различных способов обработки.


## <a name="references"></a>Ссылки

Другие примеры использования прогнозного обслуживания также доступны для разных платформ:

* [Сборник тренировочных заданий для шаблона решения Cortana Intelligence для прогнозируемого обслуживания в аэрокосмических и других компаниях](https://docs.microsoft.com/azure/machine-learning/cortana-analytics-playbook-predictive-maintenance)
* [Predictive Maintenance Modelling Guide](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Modelling-Guide-1) (Руководство по моделированию прогнозного обслуживания)
* [Predictive Maintenance Modeling Guide using SQL R Services](https://gallery.cortanaintelligence.com/Tutorial/Predictive-Maintenance-Modeling-Guide-using-SQL-R-Services-1) (Руководство по моделированию прогнозного обслуживания с помощью служб R SQL)
* [Predictive Maintenance Modelling Guide Python Notebook](https://gallery.cortanaintelligence.com/Notebook/Predictive-Maintenance-Modelling-Guide-Python-Notebook-1) (Руководство по моделированию прогнозного обслуживания с помощью записной книжки Python)
* [Predictive Maintenance using PySpark](https://gallery.cortanaintelligence.com/Tutorial/Predictive-Maintenance-using-PySpark) (Прогнозное обслуживание с помощью PySpark)

* [Реальный сценарий прогнозного обслуживания](https://docs.microsoft.com/en-us/azure/machine-learning/preview/scenario-predictive-maintenance)

## <a name="next-steps"></a>Дополнительная информация

В Azure Machine Learning Workbench есть много других примеров сценариев, которые описывают дополнительные возможности продукта. 