--- 
title: "Реальный сценарий прогнозного обслуживания | Документация Майкрософт"
description: "Реальный сценарий прогнозного обслуживания с помощью PySpark."
services: machine-learning
author: jaymathe
ms.author: jaymathe
manager: jhubbard
ms.reviewer: garyericson, jasonwhowell, mldocs
ms.service: machine-learning
ms.workload: data-services
ms.topic: article
ms.custom: mvc
ms.date: 09/25/2017
ms.translationtype: HT
ms.sourcegitcommit: c3a2462b4ce4e1410a670624bcbcec26fd51b811
ms.openlocfilehash: 7bb5672a2b9de0a62af8b6155bfdead6a0105eb5
ms.contentlocale: ru-ru
ms.lasthandoff: 09/25/2017

--- 

# <a name="predictive-maintenance-real-world-scenario"></a>Реальный сценарий прогнозного обслуживания


Незапланированный простой оборудования может оказывать неблагоприятное влияние на предприятие. Поэтому важно поддерживать рабочее состояние оборудования, используемого в области, чтобы обеспечить максимально эффективное использование ресурсов и добиться максимальной производительности, сводя к минимуму время затратного незапланированного простоя. Раннее определение проблем позволяет выделить ограниченные ресурсы обслуживания с наименьшими затратами, а также повысить качество и эффективность выполнения процессов логистической цепочки. 

В этом сценарии мы будем использовать [данные относительно больших объемов](https://github.com/Microsoft/SQL-Server-R-Services-Samples/tree/master/PredictiveMaintanenceModelingGuide/Data), чтобы ознакомить пользователя с основными шагами для приема данных, проектирования признаков, создания модели и, наконец, для ввода модели в эксплуатацию и ее развертывания. Код для всего процесса написан на языке PySpark и реализован с помощью записных книжек Jupyter в Azure ML Workbench. Модель с наилучшими показателями будет введена в эксплуатацию с помощью службы управления моделями Машинного обучения Azure. Она будет использоваться в рабочей среде, чтобы прогнозировать сбои в реальном времени.   

## <a name="link-to-the-gallery-github-repository"></a>Ссылка на репозиторий коллекции на GitHub

Вот ссылка на общедоступный репозиторий GitHub: [https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance)


## <a name="use-case-overview"></a>Обзор варианта использования

Основная проблема, с которой сталкиваются предприятия тяжелой промышленности, — это значительные затраты, связанные с задержкой из-за технических неполадок. Большинство предприятий заинтересованы в упреждающем прогнозировании этих проблем, позволяющем предотвратить их еще до возникновения. Это уменьшает затраты за счет сокращения времени простоя и в некоторых случаях повышает безопасность. Подробное описание распространенных вариантов использования и метода моделирования для прогнозного обслуживания см. в статье [Сборник тренировочных заданий для шаблона решения Cortana Intelligence для прогнозируемого обслуживания в аэрокосмических и других компаниях](https://docs.microsoft.com/en-us/azure/machine-learning/cortana-analytics-playbook-predictive-maintenance).

Этот сценарий использует некоторые сведения из этого сборника, чтобы предоставить шаги для реализации прогнозной модели для сценария, основанного на сочетании нескольких реальных проблем предприятий. В этом примере собраны все распространенные элементы данных, используемые во многих вариантах использования прогнозного обслуживания.

При использовании смоделированных данных компании сталкиваются с такой сложностью, как прогнозирование проблем, вызванных сбоем компонентов. В сфере бизнеса вопрос звучит так: *Какова вероятность сбоя компьютера из-за сбоя компонента*? Эта проблема форматируется как проблема многоклассовой классификации (несколько компонентов на каждом компьютере). Для создания прогнозной модели используется алгоритм машинного обучения. Эта модель обучается на основе данных журнала, собранных с компьютеров. В этом сценарии пользователь выполнит несколько шагов реализации этой модели в среде Azure Machine Learning Workbench.

## <a name="prerequisites"></a>Предварительные требования

* [Учетная запись Azure](https://azure.microsoft.com/en-us/free/) (доступны бесплатные пробные версии).
* Установленная копия [Azure Machine Learning Workbench](./overview-what-is-azure-ml.md). Чтобы установить эту программу и создать рабочую область, выполните инструкции из [краткого руководства по установке](./quickstart-installation.md).
* Промежуточные результаты для использования во всех записных книжках Jupyter в этом сценарии хранятся в контейнере хранилища BLOB-объектов Azure. Инструкции по настройке учетной записи хранения Azure доступны по этой [ссылке](https://docs.microsoft.com/en-us/azure/storage/blobs/storage-python-how-to-use-blob-storage). 
* Для [ввода в эксплуатацию](https://github.com/Azure/Machine-Learning-Operationalization) модели лучше всего, если пользователь запустит [модуль Docker](https://www.docker.com/), установленный локально. В противном случае можно использовать вариант с кластером. Имейте в виду, что запуск [Службы контейнеров Azure (ACS)](https://azure.microsoft.com/en-us/services/container-service/) часто может быть затратным.
* В этом сценарии предполагается, что пользователь запускает Azure ML Workbench на компьютере Windows 10 с модулем Docker, установленным локально. 
* Этот сценарий был создан и протестирован на компьютере с Windows 10 со следующими характеристиками: процессор Intel Core i7-4600U 2,10 ГГц, 8 ГБ ОЗУ, 64-разрядная операционная система, x64-разрядный процессор с версией Docker 17.06.0-ce-win19 (12801). 
* Ввод модели в эксплуатацию был выполнен с помощью командной строки Машинного обучения Azure версии: azure-cli-ml==0.1.0a22.

## <a name="create-a-new-workbench-project"></a>Создание проекта в Workbench

Создайте проект, используя в качестве шаблона следующий пример:
1.  Откройте Azure Machine Learning Workbench.
2.  На странице **Projects** (Проекты) щелкните знак **+** и выберите **New Project** (Создать проект).
3.  В области **Create New Project** (Создание проекта) введите информацию о новом проекте.
4.  В поле поиска **Search Project Templates** (Поиск шаблонов проектов) введите Predictive Maintenance (Прогнозное обслуживание) и выберите шаблон.
5.  Нажмите кнопку **Создать**

## <a name="data-description"></a>Описание данных

[Смоделированные данные](https://github.com/Microsoft/SQL-Server-R-Services-Samples/tree/master/PredictiveMaintanenceModelingGuide/Data) состоят из пяти файлов данных с разделителями-запятыми (CSV-файлы). 

* [machines.](https://pdmmodelingguide.blob.core.windows.net/pdmdata/machines.csv) Признаки, дифференцирующие каждый компьютер. Например, срок использования и модель.
* [error.](https://pdmmodelingguide.blob.core.windows.net/pdmdata/errors.csv) Журнал ошибок содержит список некритических ошибок, которые не прерывают работу компьютера. Эти ошибки не рассматриваются в качестве сбоев, хотя они могут спрогнозировать событие сбоя в будущем. Дата и время ошибок округляются до ближайшего часа, так как данные телеметрии собираются по часовому тарифу.
* [maintenance.](https://pdmmodelingguide.blob.core.windows.net/pdmdata/maint.csv) Журнал обслуживания содержит записи запланированных и незапланированных обслуживаний. Запланированное обслуживание представляет собой регулярную проверку компонентов. Незапланированное обслуживание может возникать из-за механической неисправности или других причин снижения производительности. Дата и время обслуживания округляются до ближайшего часа, так как данные телеметрии собираются по часовому тарифу.
* [telemetry.](https://pdmmodelingguide.blob.core.windows.net/pdmdata/telemetry.csv) Данные временных рядов телеметрии содержат сведения о напряжении, вращении, давлении и вибрации датчика, собранные с каждого компьютера в реальном времени. Значения данных усредняются за час и хранятся в журналах телеметрии.
* [failures.](https://pdmmodelingguide.blob.core.windows.net/pdmdata/failures.csv) Сбои соответствуют записи о замене компонентов в журнале обслуживания. Каждая запись содержит идентификатор компьютера, тип компонента, дату и время замены. Эти записи используются для создания меток машинного обучения, которые модель пытается спрогнозировать.

Просмотрите сценарий [приема данных](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/Code/1_data_ingestion.ipynb) записной книжки Jupyter в разделе кода, чтобы скачать наборы необработанных данных из репозитория GitHub и создать наборы данных PySpark для этого анализа.

## <a name="scenario-structure"></a>Структура сценария
Содержимое этого сценария доступно в [репозитории GitHub](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance). 

Репозиторий содержит файл [Readme](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/README.md), описывающий процессы от подготовки данных до создания нескольких моделей и, наконец, ввод одной из наилучших моделей в эксплуатацию. Четыре записные книжки Jupyter доступны в репозитории в папке [Code](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/tree/master/Code).   

Далее мы пошагово рассмотрим рабочий процесс этого сценария. Полный сценарий написан на языке PySpark и разделен на четыре записные книжки, как показано ниже.

* [Прием данных.](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/Code/1_data_ingestion.ipynb) С помощью этой записной книжки можно обрабатывать прием данных пяти входных CSV-файлов, выполнять некоторую предварительную очистку, создавать некоторые графические сводки, чтобы проверить загрузку данных, и, наконец, сохранить итоговые наборы данных в контейнере больших двоичных объектов Azure для использования в следующих записных книжках.

* [Проектирование признаков.](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/Code/2_feature_engineering.ipynb) Используя очищенный набор данных с предыдущего шага, будут созданы признаки задержек для датчиков телеметрии. Для создания переменных, например числа дней после последней замены, будут выполнены дополнительные шаги проектирования признаков. Наконец, ошибки помечаются для соответствующих записей, чтобы создать итоговый набор данных, который сохраняется в контейнере больших двоичных объектов Azure для последующего шага. 

* [Создание модели.](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/Code/3_model_building.ipynb) Итоговый набор данных спроектированных признаков затем разделяется на два набора данных, а именно для обучения и тестирования, на основе метки даты и времени. Затем две модели, а именно классификатор случайного леса и классификатор дерева принятия решений, создаются на основе набора данных для обучения и оцениваются по тестовому набору данных. 

* [Ввод модели в эксплуатацию и ее развертывание.](https://github.com/Azure/MachineLearningSamples-PredictiveMaintenance/blob/master/Code/4_operationalization.ipynb) Созданная на предыдущем шаге модель с лучшими показателями сохраняется в качестве в виде файла MODEL вместе с соответствующим JSON-файлом схемы для развертывания. Функции init() и run() сначала выполняются локально, прежде чем ввести модель в эксплуатацию с помощью среды управления моделями Машинного обучения Azure для использования в рабочей среде с целью прогнозирования ошибок в реальном времени.  

## <a name="conclusion"></a>Заключение

Этот сценарий предоставляет пользователю общие сведения о создании комплексного решения для прогнозного обслуживания с помощью PySpark в среде записной книжки Jupyter в Azure ML Workbench. Здесь также содержатся сведения о том, как ввести в эксплуатацию и развернуть модель с лучшими показателями с помощью среды управления моделями Машинного обучения Azure. И все это — чтобы использовать модель в рабочей среде для прогнозирования ошибок в реальном времени. Пользователь может изменять соответствующие части сценария в соответствии с потребностями предприятия.  

## <a name="references"></a>Ссылки

Этот вариант использования был ранее разработан на нескольких платформах, как показано ниже.

* [Сборник тренировочных заданий для шаблона решения Cortana Intelligence для прогнозируемого обслуживания в аэрокосмических и других компаниях](https://docs.microsoft.com/en-us/azure/machine-learning/cortana-analytics-playbook-predictive-maintenance)
* [Predictive Maintenance Modelling Guide](https://gallery.cortanaintelligence.com/Collection/Predictive-Maintenance-Modelling-Guide-1) (Руководство по моделированию прогнозного обслуживания)
* [Predictive Maintenance Modeling Guide using SQL R Services](https://gallery.cortanaintelligence.com/Tutorial/Predictive-Maintenance-Modeling-Guide-using-SQL-R-Services-1) (Руководство по моделированию прогнозного обслуживания с помощью служб R SQL)
* [Predictive Maintenance Modelling Guide Python Notebook](https://gallery.cortanaintelligence.com/Notebook/Predictive-Maintenance-Modelling-Guide-Python-Notebook-1) (Руководство по моделированию прогнозного обслуживания с помощью записной книжки Python)
* [Predictive Maintenance using PySpark](https://gallery.cortanaintelligence.com/Tutorial/Predictive-Maintenance-using-PySpark) (Прогнозное обслуживание с помощью PySpark)



