---
title: "Комплексное руководство по использованию подготовки данных в Машинном обучении Azure | Документация Майкрософт"
description: "В этой статье содержится обзор и подробности по решению проблем с данными с помощью подготовки данных в Машинном обучении Azure"
services: machine-learning
author: euangMS
ms.author: euang
manager: lanceo
ms.reviewer: 
ms.service: machine-learning
ms.workload: data-services
ms.custom: 
ms.devlang: 
ms.topic: article
ms.date: 09/07/2017
ms.translationtype: HT
ms.sourcegitcommit: c3a2462b4ce4e1410a670624bcbcec26fd51b811
ms.openlocfilehash: 22389ba85edb119acdd21b63f2deae2d71f31373
ms.contentlocale: ru-ru
ms.lasthandoff: 09/25/2017

---
# <a name="data-preparation-user-guide"></a>Руководство по подготовке данных 
Процесс подготовки данных обеспечивает расширенные возможности, которые подробно описаны в разделах ниже.

### <a name="step-execution-history-and-caching"></a>Выполнение действий, журнал и кэширование 
Журнал действий по подготовке данных поддерживает ряд кэшей для повышения производительности. Если вы щелкните действие и оно попадет в кэш, его нельзя будет выполнить повторно. Если в конце журнала действий имеется блок записи, и если возвращаться к действиям, не выполняя при этом никаких изменений, то после первого выполнения запись не активируется. Если же: 
- внести изменения в блок записи;
- добавить новый блок преобразования и переместить его выше блока записи, что приводит к недействительности кэша;
- изменить свойства этого блока выше;
- а также выбрать обновление образца (что сделает недействительными кэши).

В этих случаях появится новая запись, которая перезапишет предыдущую.

### <a name="error-values"></a>Ошибочные значения

Преобразование данных может завершиться ошибкой для входного значения из-за его неправильной обработки. Например, операция приведения типа завершается сбоем, если значение строки ввода нельзя привести к указанному типу целевого объекта. Операция приведения типа должна преобразовывать столбец строкового типа в числовой или логический тип. То же касается попытки создать копию столбца, который не существует (результат перемещения операции удаления столбца X перед выполнением операции копирования столбца X).

В этих случаях в выходных данных вы увидите ошибку **ошибочного значения**. Ошибочные значения указывают, что предыдущая операция для данного значения завершилась сбоем. Изнутри их можно рассматривать как тип значения первого класса, но их наличие не влияет на базовый тип столбца, даже если столбец включает только ошибочные значения.

Ошибочные значения легко определить. Они выделяются красным цветом и обозначаются "Ошибка". Чтобы определить причину ошибки, наведите указатель мыши на ее значение. Вы получите описание сбоя.

Ошибочные значения распространяются. После первого появления этого значения оно отображается как ошибка в большинстве операций. Тем не менее в настоящее время существует три способа удалить или заменить их:

1) Замените
    -  Щелкните правой кнопкой мыши столбец и выберите *замену ошибочных значений*. Затем можно выбрать значение для замены для каждого ошибочного значения в столбце.

2) Удалить
    - Подготовка данных включает интерактивные фильтры, чтобы сохранить или удалить ошибочные значения.
    - Щелкните правой кнопкой мыши столбец и выберите *Столбец фильтра*. Чтобы сохранить или удалить ошибочные значения, создайте условие *is error* (является ошибкой) или *is not error* (не является ошибкой).

3) Используйте выражение Python для условной обработки ошибочных значений. Дополнительные сведения см. в статье [о расширениях Python](data-prep-python-extensibility-overview.md).

### <a name="sampling"></a>Выборка
Файл источника данных принимает необработанные данные из одного или нескольких источников либо из локальной файловой системы или удаленного расположения. Блок образцов позволяет указать, когда необходимо работать с подмножеством данных путем создания образцов. Работа с образцами данных, а не большим набором данных, улучшает производительность при выполнении последующих операций.

Для каждого файла источника данных можно создать и сохранить несколько образцов. Однако только один образец можно задать как активный. Вы можете создавать, изменять или удалять образцы в мастере источников данных или путем изменения блока образцов. Любой файл подготовки данных, который изначально содержит ссылку на источник данных, использует образец, указанный в файле источника данных.

Есть ряд доступных стратегий выборки, каждая из которых содержит различные настраиваемые параметры.

#### <a name="top"></a>Первые
Эту стратегию можно применить к локальным или удаленным файлам. В источнике данных задействуются первые N строк (как указано в счетчике).

#### <a name="random-n"></a>Случайное количество 
Эту стратегию можно применить только к локальным файлам. В источнике данных задействуются случайные N строк (как указано в счетчике). Для создания того же образца можно указать конкретное начальное значение (в счетчике также должно быть указано прежнее значение).

#### <a name="random-"></a>Случайные, % 
Эту стратегию можно применить к локальным или удаленным файлам. В этих случаях необходимо указать вероятность и начальное значение, как в стратегии случайного количества.

Для образцов удаленных файлов необходимо указать дополнительные параметры.

- Генератор образцов 
  - Выберите кластер Spark или удаленный объект вычислений Docker для создания образцов. Объект вычислений необходимо создать для проекта заранее, чтобы он появился в этом списке. Чтобы создать эти объекты, ознакомьтесь с соответствующим разделом статьи [по использованию GPU в Машинном обучении Azure](how-to-use-gpu.md).
- Хранилище образцов 
  - Укажите промежуточное расположение хранилища для хранения удаленных образцов. Этот путь должен представлять другой каталог из расположения входного файла.

#### <a name="full-file"></a>Весь файл 
Эту стратегию можно применить только к локальным файлам. В источник данных перемещается полный файл. Если файл слишком большой, использование этого параметра может привести к замедленному выполнению последующих операций в приложении. Поэтому можно рассмотреть вариант использования другой стратегии.


### <a name="forking-merging-and-appending"></a>Разветвление, объединение и добавление

При применении фильтра к набору данных данные разбиваются на два результирующих набора: один представляет записи без сбоев, а второй — записи, завершившиеся ошибкой. В любом случае пользователь может выбрать результирующий набор для отображения. Он также может отменить другой набор данных или поместить его в новый поток данных. Второй вариант известен как *разветвление*.

Чтобы выполнить разветвление, выберите столбец, щелкните его правой кнопкой мыши и выберите "Столбец фильтра".
- В разделе "Желаемое действие" выберите *Сохранить строки*, чтобы отобразить результирующий набор, который прошел фильтр, или *Удалить строки*, чтобы отобразить набор со сбоями.
- После раздела условий выберите *создание потока данных с отфильтрованными строками* для разветвления набора, который не отобразился, в новый поток данных.


Такой подход чаще всего применяется для разделения набора данных, который требует дополнительной подготовки. После согласования разветвленного набора данных можно объединить эти данные с результирующим набором в исходном потоке данных. Чтобы выполнить "слияние" (действие, обратное от "разветвления"), выполните одно из действий ниже:
- *Добавьте строки*. Вертикально объедините два или более потоков данных (на уровне строки). 
- *Добавьте столбцы*. Горизонтально объедините два или более потоков данных (на уровне столбца).


>[!NOTE]
>Добавление столбцов завершится ошибкой в случае их конфликта.


После операции слияния исходный поток данных будет содержать ссылку на один или несколько потоков данных. В правом нижнем углу приложения под списком действий будет показано уведомление.


Чтобы выполнить любую операцию с потоком данных, на который приводится ссылка, родительский поток данных должен обновить образец, используемый из этого потока данных. В этом случае в правом нижнем углу диалоговое окно подтверждения заменит уведомление о ссылке на поток данных. В этом диалоговом окне содержится подтверждение, что вам необходимо обновить поток данных для синхронизации изменений с любыми зависимыми потоками данных.

### <a name="list-of-appendices"></a>Список приложений 
[Приложение 2. Поддерживаемые источники данных](data-prep-appendix2-supported-data-sources.md)  
[Приложение 3. Поддерживаемые трансформации](data-prep-appendix3-supported-transforms.md)  
[Приложение 4. Поддерживаемые инспекторы](data-prep-appendix4-supported-inspectors.md)  
[Приложение 5. Поддерживаемые назначения](data-prep-appendix5-supported-destinations.md)  
[Приложение 6. Примеры выражений фильтра в Python](data-prep-appendix6-sample-filter-expressions-python.md)  
[Приложение 7. Примеры выражений трансформации потока данных в Python](data-prep-appendix7-sample-transform-data-flow-python.md)  
[Приложение 8. Примеры источников данных в Python](data-prep-appendix8-sample-source-connections-python.md)  
[Приложение 9. Примеры подключений к назначению в Python](data-prep-appendix9-sample-destination-connections-python.md)  
[Приложение 10. Примеры преобразований столбцов в Python](data-prep-appendix10-sample-custom-column-transforms-python.md)  

