---
title: Обучение и развертывание моделей из VS Code
titleSuffix: Azure Machine Learning service
description: Сведения о расширении Azure Machine Learning for Visual Studio Code и о том, как начать обучение и развертывание моделей машинного и глубокого обучения с помощью Службы машинного обучения Azure в Visual Studio Code.
services: machine-learning
ms.service: machine-learning
ms.component: core
ms.topic: conceptual
ms.author: shwinne
author: swinner95
ms.date: 12/04/2018
ms.custom: seodec18
ms.openlocfilehash: 0910cce92c410a68dce6e2c44d29e72e594cd153
ms.sourcegitcommit: 7fd404885ecab8ed0c942d81cb889f69ed69a146
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2018
ms.locfileid: "53271714"
---
# <a name="use-visual-studio-code-to-train-and-deploy-machine-learning-models"></a>Использование Visual Studio Code для обучения и развертывания моделей машинного обучения

Из этой статьи вы узнаете, как использовать расширение **Azure Machine Learning for Visual Studio Code** для обучения и развертывания моделей машинного обучения и глубокого обучения с помощью Службы машинного обучения Azure в Visual Studio Code.

Служба "Машинное обучение Azure" предоставляет поддержку для выполнения экспериментов локально и на удаленных целевых объектах вычислений. Для каждого эксперимента вы можете отслеживать множество запусков, которые можно выполнять как угодно часто с целью итеративной проверки разных методик, гиперпараметров и т. п. Службу "Машинное обучение Azure" можно использовать для отслеживания пользовательских метрик и экспериментов, обеспечивая повторяемость и возможность проверки для задач обработки и анализа данных.

Также вы можете развернуть эти модели для тестирования и производственных задач.

## <a name="prerequisites"></a>Предварительные требования

+ Если у вас еще нет подписки Azure, создайте бесплатную учетную запись Azure, прежде чем начинать работу. Опробуйте [бесплатную или платную версию Службы машинного обучения Azure](http://aka.ms/AMLFree).

+ Установите расширение [Azure Machine Learning for VS Code](how-to-vscode-tools.md).

+ [Пакет SDK службы "Машинного обучения Azure" для Python](how-to-vscode-tools.md), установленный в VS Code.

## <a name="create-and-manage-compute-targets"></a>Создание целевых объектов вычислений и управление ими

Расширение Azure Machine Learning for VS Code позволяет подготовить данные, обучить модели и развернуть их как локально, так и на удаленных целевых объектах вычислений.

Это расширение поддерживает несколько удаленных целевых объектов вычислений для службы "Машинное обучение Azure". См. [полный список целевых объектов вычислений](how-to-set-up-training-targets.md), поддерживаемых службой "Машинное обучения Azure".

### <a name="create-compute-targets-for-azure-machine-learning-in-vs-code"></a>Создание целевых объектов вычислений для службы "Машинное обучение Azure" с помощью VS Code

**Чтобы создать целевой объект вычислений, выполните следующие действия:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Azure: Machine Learning" (Машинное обучение Azure).

2. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". В примере, показанном на анимированном изображении, имя подписки — Free Trial, а рабочее пространство — TeamWorkspace. 

3. В узле рабочей области щелкните правой кнопкой мыши узел **Compute** (Вычисления) и выберите **Create Compute** (Создать вычислительный ресурс).

4. Выберите из списка тип целевого объекта вычислений. 

5. Настройте дополнительные свойства в файле конфигурации JSON, который откроется в новой вкладке. В этом файле можно указать уникальное имя целевого объекта вычислений.

6. Завершив настройку целевого объекта вычислений, щелкните **Submit** (Отправить) в правом нижнем углу.

Ниже приведен для Вычислительной среды Машинного обучения Azure (AMLCompute). [![Создание Вычислительной среды AML в VS Code](./media/vscode-tools-for-ai/CreateAMLCompute.gif)](./media/vscode-tools-for-ai/CreateAMLCompute.gif#lightbox)

### <a name="use-remote-computes-for-experiments-in-vs-code"></a>Использование удаленных вычислительных ресурсов для экспериментов в VS Code

Чтобы использовать для обучения удаленный целевой объект вычислений, создайте файл конфигурации запуска. Этот файл указывает службе "Машинное обучение Azure" не только место выполнения эксперимента, но и метод подготовки среды.

#### <a name="the-run-configuration-file"></a>Файл конфигурации запуска

Расширение для VS Code автоматически создает конфигурацию запуска для сред **local** и **docker** на локальном компьютере.

Здесь представлен фрагмент файла с конфигурацией запуска по умолчанию.

Если вы хотите самостоятельно установить все библиотеки и зависимости, задайте `userManagedDependencies: True`. Теперь локальные запуски экспериментов будут использовать окружение Python по умолчанию, которая настроена в расширении VS Code для Python.

```yaml
# user_managed_dependencies=True indicates that the environment will be user managed. False indicates that AzureML will manage the user environment.
    userManagedDependencies: False
# The python interpreter path
    interpreterPath: python
# Path to the conda dependencies file to use for this run. If a project
# contains multiple programs with different sets of dependencies, it may be
# convenient to manage those environments with separate files.
    condaDependenciesFile: aml_config/conda_dependencies.yml
# Docker details
    docker:
# Set True to perform this run inside a Docker container.
    enabled: false
```

#### <a name="the-conda-dependencies-file"></a>Файл зависимостей conda

По умолчанию создается новая среда conda, которая управляет устанавливаемыми зависимостями. Но сами зависимости следует включить в файл `aml_config/conda_dependencies.yml`.

Ниже представлен фрагмент файла aml_config/conda_dependencies.yml, используемого по умолчанию.
Вы можете добавить в файл конфигурации дополнительные зависимости.

```yaml
# The dependencies defined in this file will be automatically provisioned for runs with userManagedDependencies=False.

name: project_environment
dependencies:
  # The python interpreter version.

  # Currently Azure ML only supports 3.5.2 and later.

- python=3.6.2

- pip:
    # Required packages for AzureML execution, history, and data preparation.

  - --index-url https://azuremlsdktestpypi.azureedge.net/sdk-release/Preview/E7501C02541B433786111FE8E140CAA1
  - --extra-index-url https://pypi.python.org/simple
  - azureml-defaults

```

## <a name="train-and-tune-models"></a>Обучение и тонкая настройка моделей

Работа со службой "Машинное обучение Azure для VS Code" (предварительная версия) позволяет выполнять быструю итерации кода, пошаговое выполнение и отладку, а также использовать любую систему управления версиями. 

**Чтобы запустить эксперимент с помощью службы "Машинное обучение Azure", выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Azure: Machine Learning" (Машинное обучение Azure).

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". 

1. В узле рабочей области разверните узел **Compute** (Вычисления) и щелкните правой кнопкой мыши **Run Config** (Выполнить конфигурацию) для вычислительного ресурса, который вы хотите использовать. 

1. Щелкните **Run Experiment** (Выполнить эксперимент).

1. Щелкните **View Experiment Run** (Просмотр выполнения эксперимента), чтобы открыть встроенный портал службы "Машинное обучение Azure", где вы сможете отслеживать запуски и просматривать обученные модели.

## <a name="deploy-and-manage-models"></a>Развертывание моделей и управление ими
Служба "Машинное обучение Azure" позволяет развертывать модели машинного обучения и управлять ими в облаке и на пограничных устройствах. 

### <a name="register-your-model-to-azure-machine-learning-from-vs-code"></a>Регистрация модели в службе "Машинное обучение Azure" с помощью VS Code

После того как вы завершили обучение модели, ее можно зарегистрировать в рабочей области.
Зарегистрированные модели можно отслеживать и развертывать.

**Чтобы зарегистрировать модель, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Azure: Machine Learning" (Машинное обучение Azure).

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области щелкните правой кнопкой мыши **Models** (Модели) и выберите **Register Model** (Зарегистрировать модель).

1. Выберите в списке, нужно ли отправить **model file** (файл модели для одной модели) или **model folder** (папку модели для моделей с несколькими файлами, например Tensorflow). 

1. Выберите папку или файл.

1. Завершив настройку свойств модели, щелкните **Submit** (Отправить) в правом нижнем углу. 



### <a name="deploy-your-service-from-vs-code"></a>Развертывание службы с помощью VS Code

С помощью VS Code веб-службу можно развернуть в следующих расположениях:
+ экземпляр контейнера Azure (ACI) — для тестирования;
+ служба Azure Kubernetes (AKS) — для производственных задач. 

Контейнеры ACI для тестирования не нужно создавать заранее, так как они создаются автоматически. Но кластеры AKS нужно обязательно настраивать заранее. 

См. дополнительные сведения [о развертывании в службе "Машинное обучение Azure"](how-to-deploy-and-where.md).

**Чтобы развернуть веб-службу, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Azure: Machine Learning" (Машинное обучение Azure).

1. В представлении дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области, разверните узел **Models** (Модели).

1. Щелкните правой кнопкой мыши модель, которую вы намерены развернуть, и выберите в контекстном меню команду **Deploy Service from Registered Model** (Развернуть службу из зарегистрированной модели).

1. На палитре команд из списка выберите целевой объект вычислений для развертывания службы. 

1. В текстовом поле укажите имя для этой службы. 

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл сценария.

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл зависимости.

1. Завершив настройку свойств службы, щелкните **Submit** (Отправить) в правом нижнем углу. В этом файле свойства службы можно указать локальный файл Docker или файл schema.json, который требуется использовать.

Теперь веб-служба развернута.

## <a name="next-steps"></a>Дополнительная информация

Пошаговые инструкции по обучению с помощью Машинного обучения без VS Code вы найдете в разделе [Руководство по обучению модели классификации изображений с помощью Службы машинного обучения Azure](tutorial-train-models-with-aml.md).

Пошаговые инструкции по редактированию, запуску и отладке кода Python на локальном компьютере см. в [руководстве Hello World по языку Python](https://code.visualstudio.com/docs/python/python-tutorial).
