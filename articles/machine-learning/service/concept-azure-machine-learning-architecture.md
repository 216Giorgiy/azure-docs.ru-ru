---
title: 'Машинное обучение в облаке: терминология и архитектура'
titleSuffix: Azure Machine Learning service
description: Узнайте об архитектуре, терминологии и понятиях, которые составляют службу машинного обучения Azure. Вы также узнаете о общем рабочем процессе использования службы и службах Azure, которые используются службой машинного обучения Azure.
services: machine-learning
ms.service: machine-learning
ms.component: core
ms.topic: conceptual
ms.author: haining
author: hning86
ms.reviewer: larryfr
ms.date: 12/04/2018
ms.custom: seodec18
ms.openlocfilehash: 3966d4b27f0e3d42f47d84fb5c9f5c8519a27b6c
ms.sourcegitcommit: 5b869779fb99d51c1c288bc7122429a3d22a0363
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2018
ms.locfileid: "53184735"
---
# <a name="how-the-azure-machine-learning-service-works-architecture-and-concepts"></a>Как работает служба машинного обучения Azure: архитектура и понятия

Этот документ описывает архитектуру и основные понятия службы машинного обучения Azure. На следующей схеме показаны основные компоненты службы, а также показан общий рабочий процесс при использовании службы: 

[![Архитектура и рабочий процесс службы машинного обучения Azure](./media/concept-azure-machine-learning-architecture/workflow.png)](./media/concept-azure-machine-learning-architecture/workflow.png#lightbox)

Рабочий процесс обычно включает следующие шаги:

1. Создайте скрипты обучения машинного обучения на __Python__.
1. Создайте и настройте __целевой объект вычислений__.
1. __Отправьте скрипты__ в настроенный целевой объект вычислений для запуска в этой среде. Во время обучения целевой объект вычислений сохраняет записи о выполнении в __хранилище данных__. Там эти записи сохраняются в __эксперимент__.
1. __Отправьте запрос в эксперимент__ для получения записанных метрик текущего и прошлых запусков. Если метрики не указывают желаемый результат, необходимо вернуться обратно к шагу 1 и выполнить итерацию скриптов.
1. После успешного запуска зарегистрируйте сохраненную модель в __реестре моделей__.
1. Создайте скрипт оценки.
1. __Создайте образ__ и зарегистрируйте его в __реестре образов__. 
1. __Разверните образ__ как __веб-службу__ в Azure.


> [!NOTE]
> Хотя в этом документе определяются термины и понятия, используемые машинным обучением Azure, здесь не приводятся термины и понятия для платформы Azure. Дополнительные сведения о терминологии платформы Azure см. в разделе [Словарь терминов Microsoft Azure](https://docs.microsoft.com/azure/azure-glossary-cloud-terminology).

## <a name="workspace"></a>Рабочая область

Рабочая область — это ресурс верхнего уровня для службы машинного обучения Azure. Она предоставляет централизованное расположение для работы со всеми артефактами, создаваемыми при использовании службы машинного обучения Azure.

Рабочая область хранит список целевых объектов вычислений, которые могут быть использованы для обучения модели. Она также хранит историю обучающих запусков, включая журналы, метрики, выходные данные и моментальный снимок скриптов. Эта информация используется для выбора обучающего запуска с оптимальной моделью.

Модели регистрируются в рабочей области. Зарегистрированная модель и скрипты оценки используются для создания образа. Образ затем можно развернуть в Экземпляры контейнеров Azure, службу Azure Kubernetes или программируемую пользователем вентильную матрицу (ППВМ) в качестве конечной точки HTTP на основе REST. Его также можно развернуть на устройстве Azure IoT Edge как модуль.

Вы можете создать несколько рабочих областей, и каждая рабочая область может совместно использоваться несколькими пользователями. При совместном использовании рабочей области вы управляете доступом к ней путем назначения пользователям следующих ролей:

* Владелец.
* участник;
* Читатель

При создании новой рабочей области она автоматически создает несколько ресурсов Azure, которые используются в рабочей области:

* [Реестр контейнеров Azure](https://azure.microsoft.com/services/container-registry/) — регистрирует контейнеры Docker, которые используются во время обучения и при развертывании модели.
* [Служба хранилища Azure](https://azure.microsoft.com/services/storage/) — используется как хранилище данных по умолчанию для рабочей области.
* [Azure Application Insights](https://azure.microsoft.com/services/application-insights/) — хранит сведения о мониторинге для моделей.
* [Azure Key Vault](https://azure.microsoft.com/services/key-vault/) — хранит секреты, используемые целевыми объектами вычисления, и другие конфиденциальные сведения, необходимые рабочей области.

> [!NOTE]
> Вместо создания новых версий можно также использовать существующие службы Azure. 

На следующей схеме показана схема рабочей области:

[![Схема рабочей области](./media/concept-azure-machine-learning-architecture/azure-machine-learning-taxonomy.svg)](./media/concept-azure-machine-learning-architecture/azure-machine-learning-taxonomy.png#lightbox)

## <a name="model"></a>Модель

В простейшем смысле модель представляет собой фрагмент кода, который принимает входные данные и создает выходные данные. Создание модели машинного обучения включает в себя выбор алгоритма, предоставление ему данных и настройку гиперпараметров. Обучение — это итеративный процесс, который создает обученную модель, включающую в себя все, чему модель научилась в процессе обучения.

Модель создается путем выполнения в машинном обучении Azure. Можно также использовать модель, обученную вне машинного обучения Azure. Модель можно зарегистрировать в рабочей области службы машинного обучения Azure.

Служба машинного обучения Azure не зависит от платформы. Можно использовать любую популярную платформу машинного обучения при создании модели, например scikit-learn, xgboost, PyTorch, TensorFlow, Chainer и CNTK.

Пример обучения модели приведен в документе [Краткое руководство. Начало работы со Службой машинного обучения Azure с помощью портала Azure](quickstart-get-started.md).

### <a name="model-registry"></a>Реестр моделей

В реестре моделей хранятся сведения обо всех моделях в рабочей области службы машинного обучения Azure. 

Модели идентифицируются по имени и версии. При регистрации модели с уже существующим именем реестр предполагает, что это новая версия. Номер версии увеличивается, и новая модель регистрируется под тем же именем.

Вы можете указать дополнительные теги метаданных при регистрации модели, а затем использовать эти теги для поиска моделей.

Невозможно удалить модели, которые используются образом.

Пример регистрации модели см. в документе [Обучение модели классификации изображений с помощью машинного обучения Azure](tutorial-train-models-with-aml.md).

## <a name="image"></a>Образ —

Образы позволяют надежно развернуть модель, а также все компоненты, необходимые для использования модели. Образ содержит следующие элементы:

* Модель.
* Скрипт или приложение оценки. Этот скрипт используется для передачи входных данных модели и возвращения выходных данных из модели.
* Зависимости, необходимые модели, скрипту или приложению оценки.  Например, можно включить файл среды Conda, содержащий зависимости пакетов Python.

Существует два типа образов, которые могут создаваться машинным обучением Azure:

* Образ ППВМ. Используется при развертывании в программируемую пользователем вентильную матрицу в облаке Azure.
* Образ Docker. Используется при развертывании в целевые объекты вычисления, отличные от ППВМ. Например, экземпляры контейнеров Azure и служба Azure Kubernetes.

Пример создания образа см. в документе [Развертывание модели классификации изображений в экземпляре контейнера Azure](tutorial-deploy-models-with-aml.md).

### <a name="image-registry"></a>Реестр образов

Реестр образов содержит сведения об образах, созданных из модели. При создании образа можно предоставить дополнительные теги метаданных. Теги метаданных хранятся в реестре образов, их можно запрашивать для поиска образа.

## <a name="deployment"></a>Развертывание

Развертывание — это установка образа в веб-службе, которая может размещаться в облаке, или модуле Интернета вещей для развертываний интегрированных устройств. 

### <a name="web-service"></a>Веб-служба

Развернутая веб-служба может использовать экземпляры контейнеров Azure, службу Azure Kubernetes или программируемые пользователем вентильные матрицы (ППВМ).
Служба создается из образа, который инкапсулирует вашу модель, скрипт и связанные файлы. Образ включает конечную точку HTTP с балансировкой нагрузки, которая получает запросы на оценку, отправляемые в веб-службу.

Azure помогает отслеживать развертывание веб-службы путем сбора данных телеметрии Application Insight и (или) данных телеметрии модели, если вы решили включить эту функцию. Данные телеметрии доступны только вам и хранятся в Application Insights и экземплярах учетной записи хранения.

Если вы включили автоматическое масштабирование, Azure будет автоматически масштабировать ваше развертывание.

Пример развертывания модели как веб-службы см. в документе [Развертывание модели классификации изображений в экземпляре контейнера Azure](tutorial-deploy-models-with-aml.md).

### <a name="iot-module"></a>Модуль Интернета вещей

Развернутый модуль Интернета вещей — это контейнер Docker, который содержит вашу модель и соответствующий скрипт или приложение и все дополнительные зависимости. Эти модули развертываются с помощью Azure IoT Edge на граничных устройствах. 

Если вы включили функцию мониторинга, Azure собирает данные телеметрии из модели в модуле Azure IoT Edge. Данные телеметрии доступны только вам и хранятся в вашем экземпляре учетной записи хранения.

Azure IoT Edge гарантирует, что модуль будет запущен и начнет отслеживать устройство, на котором он размещен.

## <a name="datastore"></a>Хранилище данных

Хранилище данных — это абстракция хранилища через учетную запись хранения. Хранилище данных может использовать контейнер больших двоичных объектов Azure или файловый ресурс Azure в качестве внутреннего хранилища. Каждая рабочая область содержит хранилище данных по умолчанию. Вы можете зарегистрировать дополнительные хранилища данных. 

Используйте API пакета SDK для Python или интерфейс командной строки машинного обучения Azure для хранения и извлечения файлов из хранилища данных. 

## <a name="run"></a>Выполнить

Запуск — это запись, которая содержит следующие сведения:

* метаданные о запуске (метка времени, длительность и т. д.);
* метрики, записанные в журнал с помощью скрипта;
* Выходные файлы, автоматически собранные экспериментом или явным образом загруженные вами.
* моментальный снимок каталога, содержащего скрипты, до запуска;

Запуск создается при отправке скрипта для обучения модели. Запуск может иметь ноль или более дочерних запусков. Например, запуск верхнего уровня может иметь два дочерних запуска, каждый из которых может иметь свои дочерние запуски.

Пример просмотра запусков при обучении модели приведен в документе [Краткое руководство. Начало работы со Службой машинного обучения Azure с помощью портала Azure](quickstart-get-started.md).

## <a name="experiment"></a>Эксперимент

Эксперимент представляет собой совокупность нескольких запусков одного скрипта. Он всегда принадлежит рабочей области. При отправке запуска укажите имя эксперимента. Сведения о запуске хранятся в этом эксперименте. Если при отправке запуска вы укажете несуществующее имя эксперимента, автоматически создается новый эксперимент с таким именем.

Пример использования эксперимента приведен в документе [Краткое руководство. Начало работы со Службой машинного обучения Azure с помощью портала Azure](quickstart-get-started.md).

## <a name="pipeline"></a>Конвейер

Конвейеры машинного обучения используются для создания и управления рабочими процессами, которые совмещают этапы машинного обучения. Например, конвейер может включать подготовку данных, обучение модели, развертывание модели и этапы вывода. Каждый этап может охватывать несколько шагов, каждый из которых может автоматически выполняться в различных целевых объектах вычисления.

Дополнительные сведения о конвейерах машинного обучения этой службы см. в статье [Конвейеры и служба "Машинное обучение Azure"](concept-ml-pipelines.md).

## <a name="compute-target"></a>Целевой объект вычисления

Целевой объект вычисления — это вычислительный ресурс, используемый для запуска сценария обучения или размещения развертывания службы. Поддерживаются следующие целевые объекты вычислений: 

| Целевой объект вычисления | Обучение | Развертывание |
| ---- |:----:|:----:|
| Локальный компьютер | ✓ | &nbsp; |
| Вычислительная среда Машинного обучения Azure | ✓ | &nbsp; |
| Виртуальная машина Linux в Azure</br>(например, виртуальная машина для обработки и анализа данных) | ✓ | &nbsp; |
| Azure Databricks | ✓ | &nbsp; | &nbsp; |
| Аналитика озера данных Azure | ✓ | &nbsp; |
| Apache Spark для HDInsight | ✓ | &nbsp; |
| Экземпляр контейнера Azure | &nbsp; | ✓ |
| Служба Azure Kubernetes | &nbsp; | ✓ |
| Edge Интернета вещей Azure | &nbsp; | ✓ |
| Project Brainwave</br>(программируемая пользователем вентильная матрица) | &nbsp; | ✓ |

Целевые объекты вычисления присоединяются к рабочей области. Целевые объекты вычислений, кроме локального компьютера, являются общими для пользователей рабочей области.

### <a name="managed-and-unmanaged-compute-targets"></a>Управляемые и неуправляемые целевые объекты вычислений

**Управляемые** целевые объекты вычислений создаются Службой машинного обучения Azure и управляются ею. Эти целевые объекты вычислений оптимизированы для рабочих нагрузок машинного обучения. __Вычислительная среда Машинного обучения Azure__ — единственный управляемый целевой объект вычислений на текущий момент (4 декабря 2018 года). В будущем могут быть добавлены дополнительные управляемые целевые объекты вычислений. Экземпляры Вычислительной среды ML могут создаваться непосредственно в рабочей области с помощью портала Azure, пакета SDK для Машинного обучения Azure или Azure CLI. Все прочие целевые объекты вычислений необходимо создать вне рабочей области, а затем подключить их к ней.

**Неуправляемые** целевые объекты вычислений не управляются Службой машинного обучения Azure. Может потребоваться создать их вне Машинного обучения Azure, а затем подключить эти объекты к рабочей области перед использованием. Для обслуживания этих целевых объектов вычислений могут потребоваться дополнительные действия или повышение производительности ресурсов, используемых для рабочих нагрузок Машинного обучения.

Сведения о выборе целевого объекта вычислений для обучения см. в документе [Выбор и использование целевого объекта вычислений для обучения модели](how-to-set-up-training-targets.md).

Сведения о выборе целевого объекта вычислений для развертывания см. в документе [Модели развертывания в службе машинного обучения Azure](how-to-deploy-and-where.md).

## <a name="run-configuration"></a>Конфигурация запуска

Конфигурация запуска — это набор инструкций, который определяет, как запустить скрипт в заданном целевом объекте вычисления. Он включает широкий набор определений поведения, например, следует ли использовать существующую среду Python или среду Conda, созданную из спецификации.

Конфигурацию запуска можно сохранять в файл внутри каталога, содержащего скрипт обучения, или создать как объект в памяти и использовать для отправки запуска.

Пример конфигураций запуска см. в документе [Выбор и использование целевого объекта вычислений для обучения модели](how-to-set-up-training-targets.md).

## <a name="training-script"></a>Скрипт обучения

Чтобы обучить модель, необходимо указать каталог, содержащий скрипт обучения и связанные файлы. Можно также указать имя эксперимента, который используется для хранения сведений, собранных во время обучения. Во время обучения весь каталог копируется в среду обучения (целевой объект вычислений), и запускается скрипт, указанный в конфигурации запуска. Моментальный снимок каталога также хранится в эксперименте в рабочей области.

Пример см. в статье [Краткое руководство. Начало работы со Службой машинного обучения Azure с помощью портала Azure](quickstart-get-started.md)

## <a name="logging"></a>Ведение журналов

При разработке решения используйте пакет SDK Python для машинного обучения Azure в скрипте Python для записи произвольных метрик. После запуска запросите метрики, чтобы определить, удалось ли в ходе запуска создать модель, которую вы хотите развернуть. 

## <a name="snapshot"></a>Снимок

При отправке запуска машинное обучение Azure сжимает каталог, содержащий скрипт, как ZIP-файл и отправляет его в целевой объект вычислений. ZIP-файл затем разворачивается, и скрипт выполняется в нем. Машинное обучение Azure также сохраняет ZIP-файл в качестве моментального снимка как часть записи о выполнении. Любой пользователь с доступом к рабочей области может просмотреть запись о выполнении и загрузить моментальный снимок.

## <a name="activity"></a>Действие

Действие представляет собой длительную операцию. Следующие операции являются примерами действий:

* Создание или удаление целевого объекта вычислений
* Запуск скрипта на целевом объекте вычисления

Действия могут предоставлять уведомления через пакет SDK или веб-интерфейс, чтобы можно было легко отслеживать ход выполнения этих операций.

## <a name="next-steps"></a>Дополнительная информация

Чтобы приступить к работе с машинным обучением Azure, воспользуйтесь следующими ссылками:

* [Что такое служба машинного обучения Azure](overview-what-is-azure-ml.md)
* [Краткое руководство. Создание рабочей области с помощью Python](quickstart-get-started.md)
* [Руководство. Обучение модели](tutorial-train-models-with-aml.md)
