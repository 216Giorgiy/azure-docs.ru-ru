---
title: Подготовка данных для руководства "Классификация цветков ириса" в службе "Машинное обучение Azure" (предварительная версия) | Документация Майкрософт
description: Из этого полного руководства вы узнаете, как использовать службу "Машинное обучение Azure" (предварительная версия). Это первая часть, в которой рассматривается подготовка данных.
services: machine-learning
author: hning86
ms.author: haining
manager: mwinkle
ms.reviewer: jmartens, jasonwhowell, mldocs, gcampanella
ms.service: machine-learning
ms.workload: data-services
ms.custom: mvc
ms.topic: tutorial
ms.date: 3/7/2018
ms.openlocfilehash: 1e8ad7a85739f67bf8130011ba18243ad0b4b9d0
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
---
# <a name="tutorial-1-classify-iris---preparing-the-data"></a>Руководство 1. Классификация цветков ириса: подготовка данных

Служба "Машинное обучение Azure" (предварительная версия) — это полнофункциональное интегрированное аналитическое решение для специалистов по обработке и анализу данных. Оно помогает подготавливать данные, разрабатывать эксперименты и развертывать модели в масштабе облака.

Это руководство представляет собой **первую часть серии, состоящей из трех частей**. Это руководство содержит основные сведения о службе "Машинное обучение Azure" (предварительная версия) и в нем показано, как выполнить следующие действия:

> [!div class="checklist"]
> * Создание проекта в Azure Machine Learning Workbench
> * Создание пакета подготовки данных
> * Создание кода Python или PySpark для вызова пакета подготовки данных

В этом руководстве используется классический [набор данных "Ирисы Фишера"](https://en.wikipedia.org/wiki/Iris_flower_data_set). 

## <a name="prerequisites"></a>предварительным требованиям

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

Для работы с этим руководством требуется:
- Учетная запись службы "Экспериментирование в Машинном обучении Azure".
- Установленное приложение Azure Machine Learning Workbench.

Если у вас нет этих компонентов, выполните шаги в статье [Создание учетной записи для предварительной версии службы "Машинное обучение Azure" и установка Azure Machine Learning Workbench](../service/quickstart-installation.md). 

## <a name="create-a-new-project-in-workbench"></a>Создание проекта в Workbench

Если вы уже создали проект, выполнив инструкции в статье [Создание учетной записи для предварительной версии службы "Машинное обучение Azure" и установка Azure Machine Learning Workbench](../service/quickstart-installation.md), можно пропустить этот шаг и перейти к следующему разделу.

1. Откройте приложение Azure Machine Learning Workbench и при необходимости выполните вход. 
   
   + В Windows запустите его с помощью ярлыка на рабочем столе **Machine Learning Workbench**. 
   + В macOS выберите **Azure ML Workbench** на панели запуска.

1. В области **Проекты** щелкните значок плюса (+), чтобы создать **проект**.  

   ![Новая рабочая область](./media/tutorial-classifying-iris/new_ws.png)

1. Заполните поля форм и нажмите кнопку **Создать**, чтобы создать проект в Workbench.

   Поле|Предлагаемое значение для руководства|ОПИСАНИЕ
   ---|---|---
   Имя проекта | myIris |Введите уникальное имя для идентификации учетной записи. Вы можете использовать настоящее имя, название отдела или проекта, которое лучше всего подходит для этого эксперимента. Имя должно содержать от 2 до 32 алфавитно-цифровых символов и дефис (-). 
   каталог проекта; | c:\Temp\ | Укажите каталог, в котором создается проект.
   описание проекта; | _Не указывайте_ | Дополнительное поле, полезное для описания проектов.
   Visualstudio.com GIT Repository URL (URL-адрес репозитория Git на сайте Visualstudio.com) |_Не указывайте_ | Дополнительное поле. Проект можно связать с репозиторием Git в Visual Studio Team Services для системы управления версиями и совместной работы. [Узнайте, как настроить это](https://docs.microsoft.com/azure/machine-learning/desktop-workbench/using-git-ml-project#step-3-set-up-a-machine-learning-project-and-git-repo). 
   Selected workspace (Выбранная рабочая область) | IrisGarden (если он существует) | Выберите рабочую область, созданную для учетной записи службы "Экспериментирование" на портале Azure. <br/>Если вы следовали краткому руководству, у вас должна быть рабочая область с именем IrisGarden. В противном случае выберите ту, которая была создана при создании учетной записи службы "Экспериментирование", или любую другую, которую вы хотите использовать.
   Шаблон проекта | Classifying Iris (Классификация цветков ириса) | Шаблоны, содержащие скрипты и данные, которые можно использовать для изучения продукта. Этот шаблон содержит скрипты и данные, необходимые для этого краткого руководства и других руководств на этом сайте документации. 

   ![Новый проект](media/tutorial-classifying-iris/new_project.png)
 
 Новый проект создан. Вместе с ним откроется панель мониторинга. На этом этапе вы можете изучить домашнюю страницу проекта, источники данных, записные книжки и файлы исходного кода. 

   ![Открытие проекта](media/tutorial-classifying-iris/project-open.png)
 

## <a name="create-a-data-preparation-package"></a>Создание пакета подготовки данных

После этого можно просмотреть данные и начать их подготовку в Azure Machine Learning Workbench. Каждое преобразование, выполняемое в Workbench, хранится в формате JSON в пакете подготовки локальных данных (DPREP-файл). Этот пакет является основным контейнером для подготовки данных в Workbench.

Его можно позже передать для выполнения в среду выполнения (например, local-C#/CoreCLR, Scala/Spark или Scala/HDI). 

1. Щелкните значок папки, чтобы открыть представление "Файлы", а затем откройте файл **iris.csv**.

   В этом файле содержится таблица с 5 столбцами и 50 строками. Четыре столбца являются числовыми столбцами признаков. Пятый столбец является целевым строковым столбцом. Ни один из столбцов не имеет имен заголовков.

   ![iris.csv](media/tutorial-classifying-iris/show_iris_csv.png)

   >[!NOTE]
   > Не включайте файлы данных в папку проекта, особенно если они большие. Так как файл данных **iris.csv** очень мал, он был включен в этот шаблон в целях демонстрации. Дополнительные сведения см. в статье [Сохранение изменений и работа с большими файлами](how-to-read-write-files.md).

2. В **представлении данных** щелкните значок плюса (**+**), чтобы добавить новый источник данных. Откроется страница **Добавление источника данных**. 

   ![Представление данных в Azure Machine Learning Workbench](media/tutorial-classifying-iris/data_view.png)

3. Выберите **Текстовые файлы (\*.csv, \*.json, \*.txt, …)** и нажмите кнопку **Далее**.
   ![Источник данных в Azure Machine Learning Workbench](media/tutorial-classifying-iris/data-source.png)

4. Перейдите к файлу **iris.csv** и щелкните **Готово**. В результате для таких параметров, как разделитель и типы данных, будут использоваться значения по умолчанию.

   >[!IMPORTANT]
   >Обязательно выберите файл **iris.csv** из текущего каталога проекта для этого упражнения. Иначе последующие шаги могут завершиться ошибкой.
 
   ![Выбор файла iris](media/tutorial-classifying-iris/select_iris_csv.png)
   
5. Будет создан файл с именем **iris-1.dsource**. Файлу присвоено уникальное имя "-1", так как пример проекта уже содержит ненумерованный файл **iris.dsource**.  

   Откроется файл, и отобразятся данные. Набор заголовков столбцов от **Column1** до **Column5** добавляется в этот набор данных автоматически. Прокрутите страницу вниз и обратите внимание, что последняя строка набора данных пуста. Она пуста, так CSV-файл содержит дополнительный разрыв строки.

   ![Представление данных iris](media/tutorial-classifying-iris/iris_data_view.png)

1. Нажмите кнопку **Метрики**. Гистограммы будут созданы и отобразятся на экране.

   Вы можете переключиться обратно в представление данных, нажав кнопку **Данные**.
   
   ![Представление данных iris](media/tutorial-classifying-iris/iris_data_view_metrics.png)

1. Просмотрите гистограммы. Для каждого столбца вычислен полный набор статистических данных. 

   ![Представление данных iris](media/tutorial-classifying-iris/iris_metrics_view.png)

8. Чтобы приступить к созданию пакета подготовки данных, нажмите кнопку **Подготовка**. Откроется диалоговое окно **Подготовка**. 

   Пример проекта содержит файл подготовки данных **iris.dprep**, выбранный по умолчанию. 

   ![Представление данных iris](media/tutorial-classifying-iris/prepare.png)

1. Создайте пакет подготовки данных, выбрав в раскрывающемся меню **+ New Data Preparation Package** (+ Создать пакет подготовки данных).

   ![Представление данных iris](media/tutorial-classifying-iris/prepare_new.png)

1. Введите новое значение для имени пакета (используйте **iris-1**) и нажмите кнопку **ОК**.

   Будет создан пакет подготовки данных с именем **iris-1.dprep**, который откроется в редакторе подготовки данных.

   ![Представление данных iris](media/tutorial-classifying-iris/prepare_iris-1.png)

   Теперь подготовим данные. 

1. Выбирайте заголовок каждого столбца, чтобы редактировать текст заголовка. Затем переименуйте каждый столбец следующим образом: 

   Введите значения **длины чашелистика**, **ширины чашелистика**, **длины лепестка**, **ширины лепестка** и **видов цветов** в соответствующих столбцах.

   ![Переименование столбцов](media/tutorial-classifying-iris/rename_column.png)

1. Посчитайте разные значения:
   1. Выберите столбец **Виды цветов**.
   1. Щелкните его правой кнопкой мыши. 
   1. В раскрывающемся меню выберите пункт **Value Counts** (Число значений). 

   Откроется панель **инспекторов**, расположенная под данными. Отобразится гистограмма с четырьмя полосами. Целевой столбец имеет четыре разных значения: **Iris_virginica**, **Iris_versicolor**, **Iris-setosa**и **(null)**.

   ![Выбор числа значений](media/tutorial-classifying-iris/value_count.png)

   ![Гистограмма "Число значений"](media/tutorial-classifying-iris/filter_out.png)

1. Чтобы отфильтровать значения null, выберите строку "(null)" и значок минуса (**-**). 

   Затем строка (null) станет серого цвета, указывая, что она была отфильтрована. 

   ![Фильтрация значений null](media/tutorial-classifying-iris/filter_out2.png)

1. Обратите внимание на отдельные шаги по подготовке данных, которые описаны в области **Шаги**. Так как вы переименовали столбцы и отфильтровали строки со значением null, эти действия засчитаны как этап подготовки данных. Можно изменить отдельные действия, чтобы настроить их параметры, изменить порядок действий и даже удалить их.

   ![Действия](media/tutorial-classifying-iris/steps.png)

1. Закройте редактор подготовки данных. Выберите значок **x** на вкладке **iris-1** со значком графика, чтобы закрыть вкладку. Изменения будут автоматически сохранены в файле **iris-1.dprep**, который отображается под заголовком **Data Preparations** (Подготовка данных).

   ![закройте](media/tutorial-classifying-iris/close.png)

## <a name="generate-pythonpyspark-code-to-invoke-a-data-preparation-package"></a>Создание кода Python или PySpark для вызова пакета подготовки данных

 Выходные данные пакета подготовки данных можно использовать непосредственно в записной книжке Python или Jupyter. Пакеты можно выполнять в разных средах выполнения, например в локальных средах Python, Spark (в том числе в Docker) и HDInsight. 

1. Найдите файл **iris 1.dprep** на вкладке "Подготовка данных".

1. Щелкните файл **iris-1.dprep** правой кнопкой мыши и выберите пункт **Generate Data Access Code File** (Создать файл с кодом доступа к данным) из контекстного меню. 

   ![Создание кода](media/tutorial-classifying-iris/generate_code.png)

   Откроется новый файл с именем **iris-1.py** со следующей строкой кода. Он вызовет логику, созданную в качестве пакета подготовки данных:

   ```python
   # Use the Azure Machine Learning data preparation package
   from azureml.dataprep import package

   # Use the Azure Machine Learning data collector to log various metrics
   from azureml.logging import get_azureml_logger
   logger = get_azureml_logger()

   # This call will load the referenced package and return a DataFrame.
   # If run in a PySpark environment, this call returns a
   # Spark DataFrame. If not, it will return a Pandas DataFrame.
   df = package.run('iris-1.dprep', dataflow_idx=0)

   # Remove this line and add code that uses the DataFrame
   df.head(10)
   ```

   В зависимости от контекста, в котором выполняется этот код, параметр `df` представляет разновидность кадров данных.
   + При выполнении в среде выполнения Python используется [кадр данных pandas](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html).
   + При выполнении контекста Spark используется [кадр данных Spark](https://spark.apache.org/docs/latest/sql-programming-guide.html). 
   
   Дополнительные сведения о том, как подготовить данные в Azure Machine Learning Workbench, см. в руководстве [Начало работы со службой подготовки данных](data-prep-getting-started.md).

## <a name="clean-up-resources"></a>Очистка ресурсов

[!INCLUDE [aml-delete-resource-group](../../../includes/aml-delete-resource-group.md)]

## <a name="next-steps"></a>Дополнительная информация

В этом руководстве мы использовали Azure Machine Learning Workbench для выполнения следующих задач:
> [!div class="checklist"]
> * Создание нового проекта
> * Создание пакета подготовки данных
> * Создание кода Python или PySpark для вызова пакета подготовки данных

Теперь вы можете перейти к следующей части серии руководств, из которой вы узнаете, как создать модель службы "Машинное обучение Azure".
> [!div class="nextstepaction"]
> [Часть 2. Классификация цветков ириса: создание модели](tutorial-classifying-iris-part-2.md)
