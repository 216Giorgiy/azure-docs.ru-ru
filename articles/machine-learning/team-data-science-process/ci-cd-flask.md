---
title: DevOps в приложениях с искусственным интеллектом (AI). Создание конвейера непрерывной интеграции в Azure с помощью Docker, Kubernetes и приложения Flask Python
description: DevOps в приложениях с искусственным интеллектом (AI). Создание конвейера непрерывной интеграции в Azure с помощью Docker и Kubernetes
services: machine-learning, team-data-science-process
documentationcenter: ''
author: jainr
manager: deguhath
editor: cgronlun
ms.assetid: b8fbef77-3e80-4911-8e84-23dbf42c9bee
ms.service: machine-learning
ms.component: team-data-science-process
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/22/2018
ms.author: jainr
ms.openlocfilehash: 4d95fc25ed6f2f2efec8313e5b208b3cccbb619f
ms.sourcegitcommit: f606248b31182cc559b21e79778c9397127e54df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2018
ms.locfileid: "38968797"
---
# <a name="devops-for-artificial-intelligence-ai-applications-creating-continuous-integration-pipeline-on-azure-using-docker-and-kubernetes"></a>DevOps в приложениях с искусственным интеллектом (AI). Создание конвейера непрерывной интеграции в Azure с помощью Docker и Kubernetes
Для приложения AI существуют часто используемые два рабочих потока, создаваемые модели машинного обучения с помощью обработки и анализа данных и разработчики приложений, которые создают приложение и предоставляют его для потребления конечным пользователям. В этой статье будет продемонстрирована реализация конвейера непрерывной интеграции (CI) или непрерывной доставки (CD) для приложения AI. AI-приложение является сочетанием кода приложения, который внедрен в модель предварительного машинного обучения (ML). Из этой статьи вы узнаете, как извлекать предварительно обработанную модель из частной учетной записи хранения BLOB-объектов (вместо нее можно использовать учетную запись AWS S3). В этой статье будут использованы простые примеры веб-приложения Flask Python.

> [!NOTE]
> Это один из нескольких способов выполнения CI/CD. У средств и других необходимых требований, упомянутых ниже, существуют альтернативы. Они будут публиковаться по мере разработки дополнительного содержимого.
>
>

## <a name="github-repository-with-document-and-code"></a>Код и документы репозитория GitHub
Исходный код можно скачать с [GitHub](https://github.com/Azure/DevOps-For-AI-Apps). Более подробное руководство доступно [здесь](https://github.com/Azure/DevOps-For-AI-Apps/blob/master/Tutorial.md).

## <a name="pre-requisites"></a>Предварительные требования
Ниже приведены условия, необходимые для выполнения описанного конвейера CI/CD:
* [Учетная запись Visual Studio Team Services](https://docs.microsoft.com/vsts/accounts/create-account-msa-or-work-student)
* [интерфейс командной строки Azure](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest)
* [развернутый кластер Kubernetes в службе контейнеров Azure](https://docs.microsoft.com/azure/container-service/kubernetes/container-service-tutorial-kubernetes-deploy-cluster);
* [учетная запись реестра контейнеров на портале Azure](https://docs.microsoft.com/azure/container-registry/container-registry-get-started-portal);
* [установленный Kubectl для запуска команд в кластере Kubernetes](https://kubernetes.io/docs/tasks/tools/install-kubectl/). Он понадобится, чтобы получить конфигурацию кластера ACS. 
* Репозиторий, скопированный в учетную запись GitHub.

## <a name="description-of-the-cicd-pipeline"></a>Описание конвейера CI/CD
Для каждого нового события конвейер запускается, проводит набор тестов, и если они окажутся успешными, он принимает последнюю сборку, а затем упаковывает ее в контейнер Docker. Затем с помощью службы контейнеров Azure (ACS) выполняется развертывание контейнера, а изображения безопасно хранятся в реестре контейнеров Azure (ACR). По умолчанию ACS, которая управляет кластером контейнера, работает в Kubernetes, но его можно заменить на Docker, Swarm или Mesos.

Приложение безопасно извлекает последнюю версию модели из учетной записи службы хранилища Azure и упаковывает ее в качестве части приложения. Развернутое приложение содержит код приложения и модель машинного обучения, которая упакована как единый контейнер. Это отделяет разработчиков приложений и специалистов по обработке и анализу данных и позволяет убедиться, что их рабочее приложение всегда использует последний код вместе с последней моделью машинного обучения.

Архитектура конвейера приведена ниже. 

![Архитектура](./media/ci-cd-flask/Architecture.PNG?raw=true)

## <a name="steps-of-the-cicd-pipeline"></a>Этапы конвейера CI/CD
1. Разработчики работают над кодом приложения в выбранной ими интегрированной среде разработки (IDE).
2. Затем они передают код выбранной системе управления версиями для проверки (в VSTS присутствует качественная поддержка различных элементов управления исходным кодом).
3. В свою очередь, специалисты по анализу и обработке данных отдельно работают над разработкой моделей разработчиков.
4. После получения удовлетворительных результатов они публикуют модель в репозитории моделей. Для этого используется учетная запись хранилища BLOB-объектов. Эти действия можно легко заменить с помощью службы управления моделью Azure ML Workbench посредством их API REST.
5. Сборка запускается в VSTS, который основывается на фиксации в GitHub.
6. Конвейер сборки VSTS извлекает последнюю модель из контейнера BLOB-объектов и создает новый контейнер.
7. VSTS перемещает изображение в частный репозиторий изображений в реестре контейнеров Azure.
8. Конвейер выпуска будет запущен согласно установленному расписанию (ночью).
9. Последняя версия изображения будет извлечена из ACR и развернута в кластере Kubernetes в ACS.
10. Пользовательский запрос приложения проходит через DNS-сервер.
11. DNS-сервер передает запрос балансировщику нагрузки и отправляет ответ пользователю.

## <a name="next-steps"></a>Дополнительная информация
* Чтобы соответствовать требованиям и реализовать конвейер CI/CD для собственного приложения, обратитесь к [руководству]((https://github.com/Azure/DevOps-For-AI-Apps/blob/master/Tutorial.md)).

## <a name="references"></a>Ссылки
* [Командный процесс обработки и анализа данных (TDSP)](https://aka.ms/tdsp).
* [Документация по службам машинного обучения Azure (предварительная версия)](https://docs.microsoft.com/azure/machine-learning/service/)
* [Visual Studio Team Services](https://www.visualstudio.com/vso/)
* [Общие сведения о предварительной версии службы Azure Kubernetes (AKS)](https://docs.microsoft.com/azure/aks/intro-kubernetes)