<properties
   pageTitle="Перенос схемы в хранилище данных SQL | Microsoft Azure"
   description="Советы по переносу схемы в хранилище данных SQL Azure для разработки решений."
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/>

<tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="08/17/2016"
   ms.author="jrj;barbkess;sonyama"/>

# Перенос схемы в хранилище данных SQL#

Следующие сводные данные помогут вам понять различия между SQL Server и хранилищем данных SQL и перенести базу данных.

### Компоненты таблицы
Хранилище данных SQL не использует и не поддерживает такие компоненты:

- первичные ключи;
- внешние ключи;
- проверочные ограничения;
- уникальные ограничения;
- уникальные индексы;
- вычисляемые столбцы;
- разреженные столбцы;
- пользовательские типы;
- индексированные представления;
- удостоверения;
- последовательности;
- триггеры;
- синонимы;


### различия типов данных.
Хранилище данных SQL поддерживает общие типы бизнес-данных:

- bigint;
- binary;
- bit;
- char;
- дата;
- datetime;
- datetime2;
- datetimeoffset;
- decimal;
- float;
- int;
- money;
- nchar;
- nvarchar;
- numeric
- real;
- smalldatetime;
- smallint;
- smallmoney;
- sysname
- time
- tinyint;
- varbinary;
- varchar.
- uniqueidentifier

С помощью этого запроса можно в хранилище данных определить столбцы, которые содержат несовместимые типы.

```sql
SELECT  t.[name]
,       c.[name]
,       c.[system_type_id]
,       c.[user_type_id]
,       y.[is_user_defined]
,       y.[name]
FROM sys.tables  t
JOIN sys.columns c on t.[object_id]    = c.[object_id]
JOIN sys.types   y on c.[user_type_id] = y.[user_type_id]
WHERE y.[name] IN
                (   'geography'
                ,   'geometry'
                ,   'hierarchyid'
                ,   'image'
                ,   'ntext'
                ,   'sql_variant'
                ,   'text'
                ,   'timestamp'
                ,   'xml'
                )
AND  y.[is_user_defined] = 1
;

```

Запрос включает в себя любые пользовательские типы данных, которые также не поддерживаются.

Если в базе данных есть неподдерживаемые типы, это не проблема. Некоторые альтернативные варианты предложены ниже.

Используйте такую замену:

- Вместо **geometry** используйте varbinary.
- Вместо **geography** используйте varbinary.
- **hierarchyid** — этот тип CLR не поддерживается.
- Вместо **image**, **text**, **ntext** используйте varchar/nvarchar (чем меньше, тем лучше).
- Не используйте **sql\_variant**. Вместо этого разделите столбец на несколько строго типизированных столбцов.
- **table** преобразуйте во временные таблицы.
- Не используйте **timestamp**, но переработайте код, чтобы использовать datetime2 и функцию `CURRENT_TIMESTAMP`. Обратите внимание, что невозможно использовать current\_timestamp как ограничение по умолчанию. Если нужно перенести значения rowversion из типизированного столбца timestamp, используйте binary(8) или varbinary(8) для значений версии строки NOT NULL или NULL.
- Преобразуйте **пользовательские типы** обратно в их исходный тип, если это возможно.
- Вместо **xml** используйте varchar(max) или меньшую версию для лучшей производительности. Разделите на столбцы при необходимости.

Для повышения производительности:

- Вместо nvarchar(max) используйте nvarchar(4000) или меньшую версию для лучшей производительности.
- Вместо nvarchar(max) используйте varchar(8000) или меньшую версию для лучшей производительности.

Частичная поддержка:

- Ограничения по умолчанию поддерживает только литералы и константы. Недетерминированные выражения или функции, такие как `GETDATE()` или `CURRENT_TIMESTAMP`, не поддерживаются.

> [AZURE.NOTE] Определяйте таблицы таким образом, чтобы при использовании PolyBase для загрузки максимальный размер строки не превышал 32 767 байтов. Важно помнить, что максимальный размер строки включает в себя полную длину столбцов переменной длины. Хотя можно определить строку с данными переменной длины, превышающими это значение, но на текущий момент такие данные невозможно загрузить с помощью PolyBase. В качестве временной меры используйте BCP для загрузки широких строк. Наконец, попробуйте ограничить размер столбцов переменной длины, чтобы еще оптимизировать пропускную способность, нужную для выполнения запросов.

## Дальнейшие действия
После успешного переноса схемы базы данных в хранилище данных SQL вы можете перейти к одной из приведенных ниже статей.

- [Перенос данных][]
- [Перенос кода][]

Дополнительные советы по разработке см. в статье [Общие сведения о разработке][].

<!--Image references-->

<!--Article references-->
[Перенос кода]: sql-data-warehouse-migrate-code.md
[Перенос данных]: sql-data-warehouse-migrate-data.md
[Общие сведения о разработке]: sql-data-warehouse-overview-develop.md

<!--MSDN references-->


<!--Other Web references-->

<!---HONumber=AcomDC_0824_2016-->