<properties
   pageTitle="Общие сведения о хранилище данных SQL Azure | Microsoft Azure"
   description="Распределенная база данных корпоративного класса, способная обрабатывать петабайты реляционных и нереляционных данных. Это первое облачное хранилище в отрасли, в котором можно увеличивать и уменьшать количество вычислительных ресурсов, а также приостанавливать их работу в считанные секунды."
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="lodipalm"
   manager="barbkess"
   editor=""/>

<tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="05/10/2016"
   ms.author="lodipalm;barbkess;mausher;jrj;sonyama;"/>


# Что такое хранилище данных SQL Azure?

Хранилище данных SQL Azure — это развернутая в облаке база данных, способная обрабатывать большие объемы реляционных и нереляционных данных. Опираясь на архитектуру вычислений с массовым параллелизмом (MPP), хранилище данных SQL может обрабатывать рабочую нагрузку целого предприятия.

Преимущества хранилища данных SQL:

- Объединяет возможности надежной реляционной базы данных SQL Server и возможности развертывания в облаке Azure. За считанные секунды вычисления можно масштабировать, приостанавливать или возобновлять. Это позволяет сократить затраты благодаря развертыванию ЦП по необходимости и сокращению использования в периоды минимальной загрузки.
- Использует платформу Azure. Это обеспечивает простоту развертывания и поддержки, а также полную отказоустойчивость благодаря автоматическому резервному копированию. 
- Дополняет экосистему SQL Server. При разработке можно использовать знакомые средства SQL Server и T-SQL.

Далее в этой статье подробно описаны ключевые функции хранилища данных SQL.

## Оптимизация

### Архитектура вычислений с массовым параллелизмом (MPP)

В хранилище данных SQL используется архитектура вычислений с массовым параллелизмом (MPP) от Майкрософт, предназначение которой — работа с самыми крупными в мире локальными хранилищами.

В настоящее время архитектура MPP распределяет данные по 60 хранилищам и процессорам, не использующим общие ресурсы. Данные хранятся в избыточных геореплицированных BLOB-объектах службы хранилища Azure и связываются с вычислительными узлами для выполнения запросов. Благодаря такой архитектуре при выполнении сложных запросов T-SQL можно использовать метод разобщения. Во время обработки управляющий узел анализирует запрос, после чего каждый вычислительный узел получает свою часть данных в параллельном режиме.

Благодаря объединению архитектуры MPP и функций службы хранилища Azure хранилище данных SQL обеспечивает следующие возможности:

- увеличение или уменьшение размера хранилища независимо от вычислений;
- увеличение или уменьшение масштаба вычислений без перемещения данных; 
- приостановка вычислений без изменения данных;
- моментальное возобновление вычислений.

Архитектура подробно описана ниже.

![Архитектура хранилища данных SQL][1]


- **Управляющий узел**. Управляющий узел контролирует систему. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Управляющий узел в хранилище данных SQL работает на платформе базы данных SQL, и подключение к нему выполняется соответствующим образом. Управляющий узел скрыто координирует все перемещения данных и вычисления, необходимые для выполнения параллельных запросов к распределенным данным. При отправке TSQL-запроса в хранилище данных SQL управляющий узел преобразует его в отдельные запросы, которые будут выполняться на каждом вычислительном узле в параллельном режиме.

- **Вычислительные узлы**. Вычислительные узлы — это движущая сила хранилища данных SQL. Они представляют собой базы данных SQL, которые обрабатывают этапы запросов действия и управляют данными. При добавлении данных хранилище данных SQL распределяет строки с помощью вычислительных узлов. Вычислительные узлы также являются рабочими узлами, выполняющими параллельные запросы к данным. После обработки они передают результаты обратно на управляющий узел. Чтобы завершить запрос, управляющий узел объединяет результаты и возвращает конечный результат.


- **Хранилище**. Данные хранятся в BLOB-объектах службы хранилища Azure. Когда вычислительные узлы взаимодействуют с данными, они выполняют запись и чтение непосредственно в хранилище BLOB-объектов. Так как служба хранилища Azure расширяется прозрачно и бесконечно, хранилище данных SQL обладает теми же свойствами. Вычисления и хранение данных не зависят друг от друга, поэтому хранилище данных SQL может автоматически масштабировать хранилище отдельно от масштабирования вычислений, и наоборот. Хранилище Azure также полностью отказоустойчиво и упрощает процесс резервного копирования и восстановления.
   

- **Служба перемещения данных**. Служба перемещения данных (DMS) — это технология для перемещения данных между узлами. DMS обеспечивает доступ вычислительных узлов к данным, необходимым для операций объединения и агрегирования. DMS не относится к службам Azure. Это служба Windows, которая работает вместе с базой данных SQL на всех узлах. Так как служба DMS выполняется в фоновом режиме, вам не придется взаимодействовать с ней напрямую. Тем не менее, взглянув на планы запросов, можно заметить, что они включают некоторые операции DMS, так как перемещение данных в той или иной форме требуется для выполнения каждого запроса в параллельном режиме.


### Оптимизированная производительность запросов

Помимо стратегии разобщения, подход MPP поддерживается различными средствами оптимизации производительности хранилища, включая приведенные ниже.

- Оптимизатор распределенных запросов и сложный статистический набор для всех данных. Информация о размере данных и их распределении помогает службе оптимизировать запросы. Для этого используется оценка стоимости конкретных распределенных операций с запросами.

- Усовершенствованные алгоритмы и методы, интегрированные в процесс перемещения данных, которые эффективно перемещают данные между вычислительными ресурсами в зависимости от потребности в выполнении запроса. Эти операции перемещения данных являются встроенными, а оптимизация службы перемещения данных происходит автоматически.

- Кластеризованные индексы columnstore (по умолчанию). В хранилище данных SQL, где принцип хранения данных основан на столбцах, наблюдается пятикратное увеличение сжатия данных (по сравнению с хранилищем с традиционным построчным хранением) и десятикратное увеличение производительности запросов. Аналитические запросы, которым необходимо сканировать большое количество строк, отлично работают в индексах columnstore.

## Масштабируемость

Архитектура хранилища данных SQL разделяет хранилище и вычислительные ресурсы, что позволяет масштабировать их независимо друг от друга. Благодаря структуре Базы данных SQL, обеспечивающей быстрое и простое развертывание, дополнительные вычисления можно выполнять в кратчайшие сроки. Это преимущество дополняет использование больших двоичных объектов службы хранилища Azure. Использование BLOB-объектов не только является залогом стабильного реплицированного хранилища, но также обеспечивает инфраструктуру для простого расширения по низкой цене. Использование масштабируемого облачного хранилища вместе с вычислительными ресурсами Azure в хранилище данных SQL позволяет платить за использование хранилища запросов по мере необходимости. Чтобы изменить объем вычислений, достаточно всего лишь переместить соответствующий ползунок на портале Azure вправо или влево. Кроме того, вычисления можно планировать, используя T-SQL и PowerShell.

Благодаря возможности полностью контролировать вычислительные ресурсы независимо от хранилища хранилище данных SQL позволяет вам полностью приостановить использование своего хранилища данных. При этом хранилище останется на своем месте, а все вычисления мгновенно помещаются в основной пул Azure, что обеспечивает экономию денег. При необходимости просто возобновите использование вычислительных ресурсов и сделайте свои данные и вычислительные ресурсы доступными для рабочей нагрузки.

Использование вычислительных ресурсов в хранилище данных SQL измеряется в единицах использования хранилища данных SQL (DWU). DWU — это единица измерения базовой мощности хранилища данных, разработанная для постоянного обеспечения стандартного уровня производительности хранилища. DWU, в частности, используется для обеспечения следующих преимуществ:

- возможность эффективного масштабирования хранилища, не беспокоясь о базовом оборудовании или программном обеспечении;

- возможность сформировать представление о производительности на основе уровня DWU до изменения размера хранилища данных;

- изменение или перемещение базового оборудования и программного обеспечения экземпляра без влияния на производительность при рабочей нагрузке;

- настройка базовой архитектуры службы без влияния на производительность при рабочей нагрузке;

- повышение производительности, обеспечивающее масштабируемость системы и равномерное влияние (благодаря возможности быстрого повышения производительности в хранилище данных SQL).

### Единицы использования хранилища данных

Мы рассмотрим единицы использования хранилища данных в качестве единиц измерения трех точных метрик, которые тесно связаны с производительностью при рабочей нагрузке хранилища данных. Наша цель — линейное масштабирование метрик рабочей нагрузки в соответствии с выбранными для хранилища данных DWU, что позволит нам обеспечить общую доступность.

**Сканирование или объединение.** Эта метрика рабочей нагрузки использует стандартный запрос хранения данных, который сканирует большое количество строк, а затем выполняет сложное объединение. Эта операция требует большого количества операций ввода-вывода и интенсивного использования ЦП.

**Загрузка.** Эта метрика отображает возможность приема данных в службе. Во время завершения загрузки PolyBase загружает репрезентативный набор данных из большого двоичного объекта службы хранилища Azure. Эта метрика предназначена для тестирования нагрузки сети и ЦП службы.

**CREATE TABLE AS SELECT.** CREATE TABLE AS SELECT измеряет возможность создания копии таблицы. Эта функция предусматривает чтение данных из хранилища, их распространение по различным узлам устройства и повторную запись в хранилище. Она требует интенсивного использования ЦП и сети.

### Выбор времени масштабирования

В целом DWU предназначены для простоты использования. Если вы хотите получить результаты быстрее, увеличьте количество DWU за отдельную оплату. Если вам не нужна большая вычислительная мощность, уменьшите количество DWU и оплачивайте только необходимые ресурсы. Вот несколько случаев, в которых следует рассматривать изменение количества DWU:

- В периоды, когда вам не нужно выполнять запросы, например вечером или в выходные дни, приостановите работу вычислительных ресурсов. Все выполняемые запросы будут отменены, а все DWU, выделенные для хранилища данных, — освобождены.

- Если при выполнении ресурсоемкой загрузки данных или их преобразовании нужно увеличить масштаб, чтобы получить данные быстрее.

- Чтобы определить оптимальное значение DWU, попробуйте увеличить и уменьшить масштаб, а также выполнить несколько запросов после загрузки данных. Так как масштабирование выполняется достаточно быстро, попробуйте использовать разные уровни производительности не дольше одного часа.

> [AZURE.NOTE] Обратите внимание, что в связи с архитектурой или хранилищем данных SQL ожидаемое увеличение производительности может не произойти при небольшом объеме данных. Чтобы получить точные показатели прироста производительности, мы рекомендуем использовать 1 TБ в качестве начального объема.

## Интеграция

Хранилище данных SQL работает на основе проверенного реляционного ядра СУБД и предусматривает множество функций, необходимых для работы с корпоративным хранилищем данных. Если вы уже знакомы с Transact-SQL, вы можете легко применить свои знания при работе с хранилищем данных SQL. Примеры в документации помогут вам начать работу, независимо от того, есть ли у вас опыт или вы только приступаете к работе с хранилищем. В целом при разработке элементов языка для хранилища данных SQL мы предусмотрели следующие принципы:

- Хранилище данных SQL использует синтаксис Transact-SQL сервера SQL Server для многих операций и поддерживает широкий набор традиционных конструкций SQL, таких как хранимые процедуры, пользовательские функции, секционирование таблиц, индексы и параметры сортировки.

- Хранилище данных SQL также включает в себя ряд передовых функций SQL Server, в том числе кластеризованные индексы columnstore, интеграцию PolyBase и аудит данных (предусматривающий также оценку угроз).

- Так как хранилище данных SQL еще находится на стадии разработки, некоторые элементы языка Transact-SQL используются не во всех рабочих нагрузках хранилищ данных, а только в более новых версиях SQL Server, которые сейчас могут быть недоступны. Дополнительные сведения по этой теме см. в документации по миграции.

Используя Transact-SQL и схожесть функций между SQL Server, хранилищем данных SQL, базой данных SQL и системой аналитических платформ, можно разрабатывать решения, которые соответствуют вашим требованиям к хранению и обработке данных. Вы можете выбрать место для хранения данных, исходя из требований к производительности, безопасности и масштабированию, а затем переносить данные между разными системами.

В дополнение к использованию контактной зоны Transact-SQL хранилище данных SQL можно интегрировать с многими инструментами, уже знакомыми пользователям SQL Server. В частности, мы предусмотрели интеграцию хранилища данных SQL с инструментами нескольких категорий, среди которых:

**Традиционные инструменты SQL Server.** Доступна полная интеграция служб SQL Server Analysis Services, служб интеграции и Reporting Services с хранилищем данных SQL.

**Облачные инструменты.** Хранилище данных SQL можно использовать с рядом новых инструментов в Azure. Кроме этого, оно тесно интегрировано с фабрикой данных Azure, Stream Analytics, машинным обучением и Power BI.

**Сторонние инструменты.** Сертифицированную интеграцию с хранилищем данных SQL поддерживает большое количество сторонних инструментов. Просмотрите полный список.

## Гибридная среда

Хранилище данных SQL с PolyBase позволяет переносить данные в пределах своей экосистемы, что ранее было недоступно. Это, в свою очередь, позволяет настраивать расширенные гибридные сценарии, предусматривающие использование нереляционных локальных источников данных.

Технология PolyBase проста в применении и обеспечивает использование данных из различных источников, выполняя уже знакомые команды T-SQL. PolyBase позволяет отправлять запросы на нереляционные данные, которые находятся в хранилище BLOB-объектов Azure, как если бы они находились в обычной таблице. С помощью Polybase можно отправлять запросы к нереляционным данным или импортировать такие данные в хранилище данных SQL.

- Для доступа к нереляционным данным технология PolyBase использует внешние таблицы. Определения таблиц находятся в хранилище данных SQL. Их можно открывать с помощью SQL и любых других инструментов, подобно обычным реляционным данным.

- Интеграция Polybase не зависит используемых технологий. PolyBase предоставляет одинаковые компоненты и функциональные возможности для всех поддерживаемых ресурсов. Технология Polybase позволяет читать данные в различных форматах, включая файлы с разделителями и ORC-файлы.

- PolyBase можно использовать для доступа к хранилищу BLOB-объектов, которое также может служить хранилищем кластера HD Insight, предоставляя новейшие методы доступа к одним и тем же данным как с помощью реляционных, так и нереляционных инструментов.

## Дальнейшие действия

Теперь, когда вам уже известны некоторые сведения о хранилище данных SQL, просмотрите дополнительные сведения о [рабочей нагрузке хранилища данных], [подготовке к работе] хранилища данных SQL и загрузке [демонстрационных данных]. Или ознакомьтесь со следующими ресурсами, посвященными хранилищу данных SQL.

- [Блоги] 
- [Запросы функций.]
- [Видеоролики]
- [Блоги группы CAT]
- [Создание запроса в службу поддержки]
- [Форум MSDN]
- [Форум Stack Overflow]
- [Twitter]


<!--Image references-->
[1]: ./media/sql-data-warehouse-overview-what-is/dwarchitecture.png

<!--Article references-->
[Создание запроса в службу поддержки]: ./sql-data-warehouse-get-started-create-support-ticket.md
[рабочей нагрузке хранилища данных]: ./sql-data-warehouse-overview-workload.md
[демонстрационных данных]: ./sql-data-warehouse-get-started-manually-load-samples.md
[подготовке к работе]: ./sql-data-warehouse-get-started-provision.md

<!--MSDN references-->

<!--Other Web references-->
[Блоги]: https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/
[Блоги группы CAT]: https://blogs.msdn.microsoft.com/sqlcat/tag/sql-dw/
[Запросы функций.]: https://feedback.azure.com/forums/307516-sql-data-warehouse
[Форум MSDN]: https://social.msdn.microsoft.com/Forums/ru-RU/home?forum=AzureSQLDataWarehouse
[Форум Stack Overflow]: http://stackoverflow.com/questions/tagged/azure-sqldw
[Twitter]: https://twitter.com/hashtag/SQLDW
[Видеоролики]: https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse

<!---HONumber=AcomDC_0511_2016-->