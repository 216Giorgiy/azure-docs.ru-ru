---
title: "Краткий справочник по хранилищу данных SQL Azure | Документы Microsoft"
description: "Ссылки, советы и рекомендации для быстрого построения решений для хранилища данных SQL Azure."
services: sql-data-warehouse
documentationcenter: NA
author: acomet
manager: jhubbard
editor: 
ms.assetid: 51f1e444-9ef7-4e30-9a88-598946c45196
ms.service: sql-data-warehouse
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-services
ms.custom: manage
ms.date: 12/14/2017
ms.author: acomet
ms.openlocfilehash: dc55f4333bef1c609978887f293539bbee8b1c29
ms.sourcegitcommit: 901a3ad293669093e3964ed3e717227946f0af96
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="cheat-sheet-for-azure-sql-data-warehouse"></a>Памятка для хранилища данных SQL Azure
Эта страница поможет при разработке для основное назначение решения хранилища данных. Это памятку должен быть отличную поддержку в поездке построить хранилище данных мирового класса, но настоятельно рекомендуется дополнительной информацией о каждый шаг подробно. Во-первых, рекомендуется прочитать этот замечательную статью о какое хранилище данных SQL  **[и не]**.

Ниже приведен эскиза процесса, которые необходимо выполнить при начале разработки хранилище данных SQL.

![Эскиз]

## <a name="queries-and-operations-across-tables"></a>Запросы и операции по таблицам

Действительно важно знать заранее, наиболее важные операции и запросы происходило в хранилище данных. Архитектуры хранилища данных должен иметь приоритет для выполнения этих операций. Типичными примерами операций может быть:
* При присоединении одной или двух таблиц фактов с измерением таблицы фильтрации этой таблицы в течение заданного времени и добавить результаты в Киоск данных
* Создание больших или маленьких обновлений на факт продажи
* Добавление данных только в таблицах

Зная тип операций помогает оптимизировать структуру таблицы.

## <a name="data-migration"></a>Перенос данных

Корпорация Майкрософт рекомендует для первой загрузки данных  **[в ADLS]**  или хранилища больших двоичных объектов. Затем следует использовать Polybase для загрузки данных в хранилище данных SQL в промежуточную таблицу. Мы рекомендуем следующую конфигурацию:

| Проектирование | Рекомендации |
|:--- |:--- |
| Дистрибутив | Циклический перебор, |
| Индексация | Куча |
| Секционирование | Нет |
| Класс ресурсов | largerc или xlargerc |

Дополнительные сведения о  **[переноса данных], [загрузка данных]**  с  **[подробное руководство] при загрузке**. 

## <a name="distributed-or-replicated-tables"></a>Распределенные или реплицируемых таблиц

Корпорация Майкрософт рекомендует следующие стратегии в зависимости от свойств таблицы.

| type | Отлично подходит для | Наблюдайте if...|
|:--- |:--- |:--- |
| Репликация | • Малых измерений таблиц в схеме типа «звезда» с менее чем 2 ГБ хранилища после сжатия (сжатие ~ 5 x) |• Многие записи транзакций для таблицы (например: вставка, вставка, удаление, обновление)<br></br>• Изменить данные хранилища единицы (DWU) часто подготовки<br></br>• Используются только столбцы 2-3 и таблица содержит много столбцов<br></br>• Индекса реплицируемой таблицы |
| Циклический перебор (по умолчанию) | • Временную или промежуточную таблицу<br></br> • Не очевидно, объединение столбцов ключа или хорошим кандидатом |• Снижения производительности из-за перемещение данных |
| Хэш | • Таблицы фактов<br></br>• Большие таблицы измерений |• Ключ распределения не может быть обновлен |

**Полезные советы**
* Начинается с циклического перебора, но ориентироваться в стратегию распространения hash преимуществами масштабных параллельных архитектуры
* Убедитесь, что общие ключи хэш имеют один и тот же формат данных
* Не распределение в формате varchar
* Таблицы измерений с общим ключом хэш с таблицей фактов с операций часто соединения хэш можно распределить
* Используйте  *[sys.dm_pdw_nodes_db_partition_stats]*  для анализа данных любой точкой с запятой
* Используйте  *[sys.dm_pdw_request_steps]*  для анализа перемещения данных за запросов, отслеживать время вещания и операции в случайном порядке. Полезно просмотреть стратегии распространения.

Дополнительные сведения о  **[в реплицированных таблицах] и [распределенных таблиц]**.

## <a name="indexing-your-table"></a>Индексирования таблицы

Индексирование — **отлично** для быстрого чтения таблицы. Есть уникальный набор технологий, которые можно использовать в зависимости от потребностей:

| type | Отлично подходит для | Наблюдайте if...|
|:--- |:--- |:--- |
| Куча | • Промежуточного хранения или временную таблицу<br></br>• Небольших таблиц с помощью небольшого поиска |• Подстановки, просматривает всю таблицу |
| Кластеризованный индекс | • Не более 100 млн строк таблицы<br></br>• Больших таблиц (более 100 млн строк) со столбцами, 1 – 2 активно используются |•, Используемые в реплицированной таблице<br></br>• Сложные запросы с несколькими Join, Group By операций<br></br>• Создание обновления на индексированных столбцах, он принимает памяти |
| Кластеризованный индекс Columnstore (CCI) (по умолчанию) | • Больших таблиц (более 100 млн строк) | •, Используемые в реплицированной таблице<br></br>• Внесения значительных операции update в таблице<br></br>• Чрезмерно секционировать таблицу: группы строк не охватывать иное распределение узлов и секций |

**Полезные советы**
* Поверх кластеризованный индекс может потребоваться добавить некластеризованный индекс для столбца, используемого сильно для фильтра. 
* Следите за управление памяти для таблицы с CCI. При загрузке данных требуется пользователь (или запрос), для использования преимуществ класса ресурс большого объема. Вы убедитесь избежать усечения и создание групп много небольших сжатая строка
* Оптимизированный для вычисления уровня rocks с CCI
* Для CCI снижения производительности может быть вызвано низкой сжатие групп строк, может потребоваться перестроить или реорганизовать вашей CCI. Требуется по крайней мере 100 тысяч строк в сжатые группы строк. Идеальному составляет 1-m строк в группе строк.
* На основе частоты добавочную загрузку и размер, можно автоматизировать при реорганизации или перестроения индексов. Очистка Spring всегда является полезным.
* Быть стратегического, если необходимо для усечения группы строк: размер групп строк open? Объем данных планируется загрузить в течение нескольких дней?

Дополнительные сведения о  **[индексы]**.

## <a name="partitioning"></a>Секционирование
Возможно секционирование таблиц, при наличии большие таблицы фактов (> 1B строк таблицы). 99% случаев ключ секции должно быть основано на дату. Старайтесь не чрезмерное секции, особенно в том случае, если у вас есть кластеризованный индекс Columnstore.
С промежуточных таблиц, которые требуют ETL, можно преимущества секционирования. Он облегчает управление жизненным циклом данных.
Следует избегать overpartition данных, особенно на кластеризованный индекс Columnstore.

Дополнительные сведения о  **[секций]**.

## <a name="incremental-load"></a>Добавочная загрузка

Во-первых необходимо выделять больше классов ресурса для загрузки данных. Мы рекомендуем использовать Polybase и ADF V2 для автоматизации конвейеры ETL в хранилища данных SQL.

Для большого пакета обновлений в данных с предысторией рекомендуется сначала удаление области данных. Можно создать массовой вставки новых данных. Этот шаг 2 подход является более эффективным.

## <a name="maintain-statistics"></a>Обеспечение статистики
Автоматическое статистики будут скоро станет общедоступной. До тех пор хранилище данных SQL требуется вручную обслуживания статистики. Очень важно обновить статистические данные, как **значительные** произойти изменения в данные. Это помогает оптимизировать планы запросов. Если обнаружится, что выполняется слишком долго, чтобы сохранить все статистики, можно иметь большую избирательность о столбцы, которые имеют статистики. Можно также определить частоту обновления. Например, можно ежедневно обновлять столбцы дат, в которые добавляются новые значения. Получить максимальную выгоду, наличие статистики для столбцов, участвующих в соединения, столбцы, используемые в предложении WHERE и столбцы, найденные в GROUP BY.

Дополнительные сведения о  **[статистики]**.

## <a name="resource-class"></a>Класс ресурсов
Чтобы выделить память для выполнения запросов, в хранилище данных SQL используются группы ресурсов. Если вам требуется больше памяти, чтобы повысить запросов и скорость загрузки, необходимо выделить более высоких классов ресурса. С другой стороны использование больших ресурсов классов влияет параллелизма. Необходимо учитывать его до перемещения всех пользователей в больших ресурсов класса.

Если вы заметили, что запросы слишком долго, проверьте, что пользователи не выполняются в классы ресурс большого объема. Ресурс большого объема классы занимают много слоты параллелизма. Они могут вызвать другие запросы в очередь.

Наконец при использовании уровня оптимизированных вычислений, каждый класс ресурсов получает 2.5 x больше памяти, чем на уровне эластичной оптимизирован.

Дополнительные сведения по работе с  **[классы ресурсов и параллелизм]**.

## <a name="lower-your-cost"></a>Уменьшить стоимость
В хранилище данных SQL предоставляется возможность приостановить ресурсы, если вы их не используете. Счет выставляется только за используемые вычислительные ресурсы. Еще одной ключевой возможностью выступает масштабирование ресурсов. Приостановить работу и выполнить масштабирование ресурсов можно с помощью портала Azure или команд PowerShell.

Автомасштабирование теперь во время, вы можете с помощью функций Azure.

<a href="https://ms.portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FMicrosoft%2Fsql-data-warehouse-samples%2Fmaster%2Farm-templates%2FsqlDwTimerScaler%2Fazuredeploy.json" target="_blank">
<img src="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.png"/>
</a>

## <a name="optimize-you-architecture-for-performance"></a>Оптимизация вы архитектура для производительности

Мы рекомендуем, учитывая базы данных SQL и Azure Analysis Services в архитектуре с концентратором и периферийными серверами. Это решение может обеспечить изоляцию рабочей нагрузки между различными группами пользователей, а также применяет некоторые дополнительные функции безопасности из базы данных SLQ и Azure Analysis Services. Это способ предоставления неограниченного параллелизма для пользователей.

Дополнительные сведения о  **[типичные архитектуры использование хранилища данных SQL]**.

Развертывание щелчком вашей спицы в базах данных баз данных SQL Server из хранилища данных SQL.

<a href="https://ms.portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FMicrosoft%2Fsql-data-warehouse-samples%2Fmaster%2Farm-templates%2FsqlDwSpokeDbTemplate%2Fazuredeploy.json" target="_blank">
<img src="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.png"/>
</a>


<!--Image references-->
[Эскиз]:media/sql-data-warehouse-cheat-sheet/picture-flow.png

<!--Article references-->
[загрузка данных]:./design-elt-data-loading.md
[подробное руководство]: ./guidance-for-loading-data.md
[индексы]:./sql-data-warehouse-tables-index.md
[секций]:./sql-data-warehouse-tables-partition.md
[статистики]:./sql-data-warehouse-tables-statistics.md
[классы ресурсов и параллелизм]:./sql-data-warehouse-develop-concurrency.md

<!--MSDN references-->


<!--Other Web references-->
[типичные архитектуры использование хранилища данных SQL]: https://blogs.msdn.microsoft.com/sqlcat/2017/09/05/common-isv-application-patterns-using-azure-sql-data-warehouse/
[и не]:https://blogs.msdn.microsoft.com/sqlcat/2017/09/05/azure-sql-data-warehouse-workload-patterns-and-anti-patterns/
[переноса данных]:https://blogs.msdn.microsoft.com/sqlcat/2016/08/18/migrating-data-to-azure-sql-data-warehouse-in-practice/
[в реплицированных таблицах]:https://docs.microsoft.com/en-us/azure/sql-data-warehouse/design-guidance-for-replicated-tables
[распределенных таблиц]:https://docs.microsoft.com/en-us/azure/sql-data-warehouse/sql-data-warehouse-tables-distribute
[в ADLS]: https://docs.microsoft.com/en-us/azure/data-factory/connector-azure-data-lake-store
[sys.dm_pdw_nodes_db_partition_stats]: https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-db-partition-stats-transact-sql
[sys.dm_pdw_request_steps]:https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-pdw-request-steps-transact-sql
