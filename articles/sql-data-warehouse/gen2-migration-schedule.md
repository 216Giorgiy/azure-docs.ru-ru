---
title: Перенос существующего хранилища данных SQL Azure в хранилище 2-го поколения | Документация Майкрософт
description: Инструкции по переносу существующего хранилища данных в хранилище 2-го поколения и планирование переноса по регионам.
services: sql-data-warehouse
author: mlee3gsd
ms.author: anumjs
ms.reviewer: jrasnick
manager: craigg
ms.assetid: 04b05dea-c066-44a0-9751-0774eb84c689
ms.service: sql-data-warehouse
ms.topic: article
ms.date: 02/09/2019
ms.openlocfilehash: a3ec74d0b22bfafb4353eca400b389b07a58ba39
ms.sourcegitcommit: b3d74ce0a4acea922eadd96abfb7710ae79356e0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2019
ms.locfileid: "56246333"
---
# <a name="upgrade-your-data-warehouse-to-gen2"></a>Обновление до хранилища данных 2-го поколения
Корпорация Майкрософт помогает снизить начальные расходы на хранилище данных, способное обрабатывать ресурсоемкие запросы, добавляя более низкие уровни вычислений для Хранилища данных SQL Azure. Полный текст объявления см. в [записи блока о поддержке более низкого уровня вычислений для хранилища 2-го поколения](https://azure.microsoft.com/blog/azure-sql-data-warehouse-gen2-now-supports-lower-compute-tiers/). Новое предложение уже доступно в регионах, указанных в таблице ниже. В поддерживаемых регионах существующие хранилища данных 1-го поколения можно обновить до 2-го поколения с помощью таких механизмов:
- **Процесс автоматического обновления**. Автоматические обновления не запускаются сразу, когда служба станет доступна в регионе.  Когда автоматическое обновление будет запущено в определенном регионе, во время запланированного вами обслуживания произойдет обновление отдельных хранилищ данных. 
- **Самостоятельное обновление до 2-го поколения**. Если вы хотите управлять обновлением, вы можете выполнить самостоятельное обновление до 2-го поколения. Если ваш регион еще не поддерживается, вы можете переместить хранилище данных в поддерживаемый регион, а затем выполнить самостоятельное обновление до 2-го поколения.

## <a name="automated-schedule-and-region-availability-table"></a>Таблица доступности по регионам и автоматического расписания
В следующей таблице приведены данные по регионам о том, когда будет доступен низкий уровень вычислений 2-го поколения и когда начнется автоматическое обновление. Даты могут меняться. Следите за обновлениями, чтобы узнать, когда ваш регион станет доступен.

\* указывает, что определенное расписание для региона в настоящее время недоступно.

| **Регион** | **Низкий уровень 2-ого поколения доступен** | **Начало автоматических обновлений** |
|:--- |:--- |:--- |
| Центральная Австралия 1 |1 марта 2019 г. |15 июня 2019 г. |
| Центральная Австралия 2 |1 марта 2019 г. |15 июня 2019 г. |
| Восточная часть Австралии |Доступна |1 мая 2019 г. |
| Юго-Восточная часть Австралии |1 марта 2019 г. |15 июня 2019 г. |
| Южная часть Бразилии |\* |\* |
| Центральная Канада |Доступна |1 мая 2019 г. |
| Восточная Канада |\* |\* |
| Центральный регион США |Доступна |1 мая 2019 г. |
| Восток Китая |\* |\* |
| Северный Китай 1 |\* |\* |
| Восточная Азия |Доступна |1 мая 2019 г. |
| Восточная часть США 1 |Доступна |16 марта 2019 г. |
| Восток США 2 |Доступна |16 марта 2019 г. |
| Центральная Франция |1 марта 2019 г. |1 мая 2019 г. |
| Центральная Германия |\* |\* |
| Центральная Индия |Доступна |1 мая 2019 г. |
| Южная Индия 1 |1 марта 2019 г. |15 июня 2019 г. |
| Восточная часть Японии |Доступна |1 мая 2019 г. |
| Западная часть Японии |Доступна |15 июня 2019 г. |
| Центральная Корея |1 марта 2019 г. |1 мая 2019 г. |
| Республика Корея, южный регион 1 |1 марта 2019 г. |15 июня 2019 г. |
| Центрально-северная часть США |1 марта 2019 г. |15 июня 2019 г. |
| Северная Европа |Доступна |16 марта 2019 г. |
| Центрально-южная часть США |Доступна |1 мая 2019 г. |
| Юго-Восточная Азия |Доступна |16 марта 2019 г. |
| Южная часть Великобритании |1 марта 2019 г. |1 мая 2019 г. |
| Западная часть Соединенного Королевства 1 |1 марта 2019 г. |15 июня 2019 г. |
| Западно-центральная часть США |\* |\* |
| Западная Европа |Доступна |16 марта 2019 г. |
| Западная часть США 1 |1 марта 2019 г. |15 июня 2019 г. |
| Западный регион США 2 |Доступна |16 марта 2019 г. |

## <a name="automatic-upgrade-process"></a>Процесс автоматического обновления

Начиная с 16 марта 2019 г. мы начнем планирование автоматических обновлений для экземпляров 1-го поколения. Чтобы избежать непредвиденного прерывания доступности хранилища данных, выполнение автоматических обновлений будет планироваться на период запланированного обслуживания. Дополнительные сведения о расписаниях см. в статье [Просмотр расписания обслуживания](viewing-maintenance-schedule.md).

Процесс обновления вызовет краткое прерывание подключения (примерно 5 минут) при перезапуске хранилища данных.  После перезапуска хранилище данных будет полностью доступно для использования. Однако, пока процесс обновления продолжает обновлять файлы данных в фоновом режиме, вы можете заметить снижение производительности. Общее время замедления зависит от размера файлов данных.

Вы можете ускорить процесс обновления файлов данных, выполнив команду [Alter Index rebuild](sql-data-warehouse-tables-index.md) во всех основных таблицах columnstore. После перезапуска этих таблиц будет использоваться более высокий целевой уровень обслуживания и класс ресурсов.

> [!NOTE]
> Операция "Alter Index rebuild" — это автономная операция. Таблицы будут недоступны до завершения повторной сборки.

## <a name="self-upgrade-to-gen2"></a>Самостоятельное обновление до 2-го поколения

Если же вы хотите выполнить обновление сейчас, вы можете самостоятельно сделать это, следуя этим шагам в существующем хранилище данных 1-го поколения. Если вы выберете этот вариант, самостоятельное обновление следует выполнить до начала процесса автоматического обновления в соответствующем регионе. Иначе автоматические обновления могут вызвать конфликт.

Есть два варианта выполнения самостоятельного обновления.  Вы можете либо обновить текущее хранилище данных, либо восстановить хранилище данных 1-го поколения в экземпляре 2-го поколения.

- [Обновление на месте](upgrade-to-latest-generation.md). При выборе этого варианта имеющееся хранилище данных 1-го поколения будет обновлено до 2-го поколения. Процесс обновления вызовет краткое прерывание подключения (примерно 5 минут) при перезапуске хранилища данных.  После перезапуска хранилище данных будет полностью доступно для использования. Если по какой-либо причине необходимо восстановить экземпляр 1-го поколения из 2-го, откройте [запрос в службу поддержки](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-get-started-create-support-ticket).
- [Обновления из точки восстановления](sql-data-warehouse-restore.md). При выборе этого варианта в текущем хранилище данных 1-го поколения создается определяемая пользователем точка восстановления, а затем выполняется восстановление напрямую в экземпляр 2-го поколения. Существующее хранилище данных 1-го поколения остается. После завершения восстановления хранилище данных 2-го поколения будет полностью доступно.  После выполнения всех процессов тестирования и проверки восстановленного экземпляра 2-го поколения первоначальный экземпляр 1-го поколения будет удален.
    - Шаг 1. [Создайте на портале Azure точку восстановления, определяемую пользователем](sql-data-warehouse-restore.md#create-a-user-defined-restore-point-using-the-azure-portal).
    - Шаг 2. При восстановлении из определяемой пользователем точки восстановления задайте для уровня производительности предпочтительный уровень 2-го поколения.

Во время выполнения процесса обновления файлов данных в фоновом режиме вы можете столкнуться с временным снижением производительности. Общее время замедления зависит от размера файлов данных.

Для ускорения фонового процесса перемещения данных вы можете сразу инициировать перемещение данных, выполнив инструкцию [Alter Index rebuild](sql-data-warehouse-tables-index.md) для всех основных таблиц columnstore, которые вы сможете запрашивать при наличии более высокого целевого уровня обслуживания и оптимального класса ресурсов.

> [!NOTE]
> Операция "Alter Index rebuild" — это автономная операция. Таблицы будут недоступны до завершения повторной сборки.

Если с хранилищем данных возникнут проблемы, [создайте запрос в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md) и укажите в качестве возможной причины "Обновление до 2-го поколения".

Дополнительные сведения см. в статье [Оптимизация производительности путем обновления хранилища данных SQL](upgrade-to-latest-generation.md).

## <a name="migration-frequently-asked-questions"></a>Часто задаваемые вопросы о переносе

**Вопрос. Плата за 2-е поколение такая же, как и за 1-е поколение?**
- Ответ. Да.

**Вопрос. Как обновление повлияет на мои сценарии автоматизации?**
- Ответ. Любой сценарий автоматизации, который ссылается на целевой уровень обслуживания, должен быть изменен в соответствии с эквивалентом 2-го поколения.  Дополнительные сведения см. [здесь](upgrade-to-latest-generation.md#sign-in-to-the-azure-portal).

**Вопрос. Сколько обычно занимает самостоятельное обновление?**
- Ответ. Вы можете выполнять обновление на месте или обновление из точки восстановления.  
   - Обновление вызовет немедленную остановку и возобновление работы хранилища данных.  Фоновый процесс будет продолжать выполняться, пока хранилище данных подключено.  
   - Обновление через точку восстановления занимает больше времени, так как обновление будет проходить через полный процесс восстановления.

**Вопрос. Сколько времени займет автоматическое обновление?**
- Ответ. Фактический простой для обновления — это только время, необходимое для приостановки и возобновления обслуживания, которое составляет от 5 до 10 минут. После краткого простоя фоновый процесс выполнит перенос хранилища. Продолжительность фонового процесса зависит от размера хранилища данных.

**Вопрос. Когда будет происходить автоматическое обновление?**
- Ответ. Во время запланированного обслуживания. Использование выбранного расписания обслуживания минимизирует время простоя вашего бизнеса.

**Вопрос. Что делать, если фоновый процесс обновления завис?**
 - Ответ. Начните повторную индексацию таблиц Columnstore. Обратите внимание, что во время повторного индексирования таблица будет находиться в автономном режиме.

**Вопрос. Что, если 2-е поколение не обладает целевым уровнем обслуживания, который есть у меня в 1-ом поколении?**
- Ответ. Если вы используете хранилище DW600 или DW1200 1-го поколения, рекомендуется использовать DW500c или DW1000c соответственно, так как 2-е поколение предоставляет больше памяти, ресурсов и более высокую производительность по сравнению с 1-м поколением.

**Вопрос. Можно ли отключить геоизбыточное резервное копирование?**
- Ответ. № Геоизбыточное резервное копирование — это корпоративная функция, обеспечивающая доступность хранилища данных в случае, если регион становится недоступным. Если у вас возникнут дополнительные вопросы, откройте [запрос в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md).

**Вопрос. Есть ли отличия в синтаксисе T-SQL между поколением 1 и 2?**
- Ответ. Различия в синтаксисе языка T-SQL между поколением 1 и 2 отсутствуют.

**Вопрос. Поддерживает ли поколение 2 периоды обслуживания устройств?**
- Ответ. Да.

**Вопрос. Могу ли я создать новый экземпляр 1-го поколения после обновления моего региона?**
- Ответ. № После обновления региона создание новых экземпляров 1-го поколения будет отключено.

## <a name="next-steps"></a>Дополнительная информация

- [Действия по обновлению](upgrade-to-latest-generation.md)
- [Период обслуживания](maintenance-scheduling.md)
- [Мониторинг работоспособности ресурсов](https://docs.microsoft.com/azure/service-health/resource-health-overview)
- [что нужно знать перед началом миграции](upgrade-to-latest-generation.md#before-you-begin)
- [Обновление на месте или обновление из точки восстановления](upgrade-to-latest-generation.md)
- [Создание определяемой пользователем точки восстановления](sql-data-warehouse-restore.md#restore-through-the-azure-portal)
- [Сведения о восстановлении до поколения 2](sql-data-warehouse-restore.md#restore-an-active-or-paused-database-using-the-azure-portal)
- [Открытие запроса в службу поддержки касательно Хранилища данных SQL Azure](https://go.microsoft.com/fwlink/?linkid=857950)