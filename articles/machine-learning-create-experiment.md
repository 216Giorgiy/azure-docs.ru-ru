<properties title="Create a simple experiment in Azure Machine Learning Studio" pageTitle="Create a simple experiment in Machine Learning Studio | Azure" description="How to create an experiment to train and test a simple model in Azure Machine Learning Studio" metaKeywords="" services="machine-learning" solutions="" documentationCenter="" authors="garye" videoId="" scriptId="" />

<tags ms.service="machine-learning" ms.workload="tbd" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="garye"/>

# Создание простого эксперимента в Azure Machine Learning Studio

Эксперимент по прогнозной аналитике, по сути, состоит из компонентов для *создания модели*, *обучения модели* и *оценки и проверки модели*. Вы можете комбинировать их для создания эксперимента, который принимает данные, по ним обучает модель и применяет модель к новым данным. Вы также можете добавить модули для предварительной обработки данных и выбрать свойства, разделить данные на обучающие и тестовые выборки и оценить или провести перекрестную проверку качества модели.

В этой статье мы воспользуемся Microsoft Azure Machine Learning Studio для разработки и выполнения простого эксперимента по прогнозной аналитике.

## Пять шагов для создания эксперимента

Пять основных шагов для создания эксперимента в ML Studio позволяют создавать, обучать и оценить свою модель:

-   Создание модели

    -   [Шаг 1: Получение данных][]
    -   [Шаг 2: Предварительная подготовка данных][]
    -   [Шаг 3: Define features][]
-   Обучение модели

    -   [Шаг 4: Выбор и применение алгоритма обучения][]
-   Оценка и тестирование модели

    -   [Шаг 5: Прогнозирование по новым данным][]

В данном примере мы создадим регрессионную модель с использованием образцовой выборки по данным об автомобилях. Цель заключается в прогнозировании стоимости автомобиля с использованием различных переменных, таких как дата производства и технические характеристики.

### Шаг 1. Получение данных

В комплект поставки ML Studio входят несколько образцов наборов данных, также вы можете импортировать данные из множества различных источников. Для данного примера вы воспользуемся комплектным образцом набора данных, **Данные о ценах на автомобили (Raw)**, представляющим собой данные о стоимости автомобилей.

1.  Начните новый эксперимент, нажав кнопку **+NEW** в нижней части окна ML, и выберите **EXPERIMENT**. Переименуйте его с «Untitled» на имеющее смысл название, например «Прогноз цен на автомобили».

2.  В левой части области эксперимента расположена выборка данных и модулей. Введите «автомобили» в поле поиска в верхней части палитры и найдите выборку данных под названием **Данные о ценах на автомобили (необработанные)**.

    ![Поиск в палитре][]

3.  Перетащите выборку в область эксперимента.

    ![Выборка][]

Чтобы просмотреть, как выглядят эти данные, щелкните два раза по выходному порту в нижней части выборки по автомобилям и выберите **Визуализировать**. Переменные в выборке выводятся в виде столбцов, каждый экземпляр автомобиля — в виде строк. Самый правый столбец «Цена» (столбец 26) — это та переменная, которую мы попытаемся спрогнозировать.

![Визуализация выборки данных][]

Закройте окно визуализации, нажав «**x**» в правом верхнем углу.

### Шаг 2. Предварительная подготовка данных

Выборка данных, как правило, требует некоторой предварительной обработки, прежде чем ее можно подвергнуть анализу. Вы, возможно, заметили, что в столбцах некоторых строк присутствуют недостающие значения — для анализа данных эти недостающие значения должны быть очищены. В нашем случае мы просто удалим все строки, в которых имеются недостающие значения. Кроме того, в столбце «Нормированные потери» имеется очень большая доля отсутствующих значений, так что мы просто полностью исключим этот столбец из модели.

> **Совет:** Очистка недостающих значений из входных данных является необходимым условием для использования большинства модулей.

Сначала мы удалим столбец «Нормированные потери», а затем удалим все строки с недостающими данными.

1.  Перетащите модуль **Столбцы проекта** на область эксперимента и подключите его к выходному порту выборки **Данные о ценах на автомобили (необработанные)**. Этот модуль позволяет выбрать, какие столбцы данных нужно включить или исключить из модели.

2.  Выберите модуль **Столбцы проекта** и щелкните **Запустить средство выбора столбцов** в области свойств.

    -   Убедитесь, что выбрано значение **Все столбцы** в выпадающем списке фильтров **Начать с**. В этом случае модуль **Столбцы проекта** будет проходить все столбцы (за исключением тех, которые мы собираемся исключить).
    -   В следующем ряду выберите **Исключить** и **названия столбцов**, а затем щелкните внутри текстового поля. Отобразится список столбцов, выберите в нем «Нормированные потери», он будет добавлен в текстовое поле.
    -   Щелкните флажок **OK**, чтобы закрыть средство выбора столбцов.

    ![Выбор столбцов][]

    Область свойств **Столбцы проекта** показывает, что обрабатываться будут все столбцы выборки, за исключением «Нормированные потери».

    ![Свойства столбцов проекта][]

    > **Совет:** Можно добавить комментарий к модулю, дважды щелкнув по нему и введя текст. Это поможет вам увидеть описание модуля и его действие в рамках эксперимента. В данном случае дважды щелкните модуль **Столбцы проекта** и введите комментарий «Исключены нормированные потери».

3.  Перетащите модуль **Очистка отсутствующих значений** в область эксперимента и подключите его к модулю **Столбцы проекта**. В области свойств выберите **Удалять строку полностью** в **Для отсутствующих значений**, чтобы очистить данные путем удаления строк, имеющих отсутствующие значения. Дважды щелкните модуль и введите комментарий «Удаление строк с отсутствующими значениями».

    ![Свойства модуля очистки значений][]

4.  Запустите эксперимент, щелкнув **ПУСК** ниже в области эксперимента.

После завершения эксперимента у всех модулей должен появиться зеленый флажок, означающий их успешное завершение. Также обратите внимание на состояние «Работа завершена» в правом верхнем углу.

![Первый запуск эксперимента][]

На данный момент все, что сделал эксперимент, — это очистка данных. Чтоб просмотреть очищенную выборку, дважды щелкните выходной порт модуля **Очистка отсутствующих значений** и выберите **Визуализировать**. Обратите внимание, что столбца «Нормированные потери» нет, также не включены отсутствующие значения.

После очистки данных мы готовы к заданию свойств, которые будут использоваться в прогнозной модели.

### Шаг 3. Определение свойств

В машинном обучении под *свойствами* понимаются отдельные измеримые свойства интересующих объектов. В нашей выборке каждая строка представляет собой один автомобиль, а каждый столбец — свойство этого автомобиля. Подбор подходящего набора свойств для создания прогнозной модели требует экспериментирования и знаний о проблеме. Некоторые свойства лучше подходят для прогнозирования цели, чем другие. Кроме того, некоторые свойства имеют сильную корреляцию с другими свойствами, например расход топлива при движении по городу и расход топлива при движении по шоссе. Таким образом, они не добавят много новой информации в модель и могут быть удалены.

Давайте создадим модель, которая использует подмножество свойств в нашей выборке. Можно вернуться назад и выбрать различные свойства, заново запустить эксперимент и оценить результаты. В качестве первого предположения мы выберем следующие свойства (столбцы) модуля **Столбцы проекта**. Обратите внимание, что для обучения модели нам необходимо включить значение *цена*, которое мы собираемся спрогнозировать.

    make, body-style, wheel-base, engine-size, horsepower, peak-rpm, highway-mpg, price

1.  Перетащите еще один модуль **Столбцы проекта** в область эксперимента и подключите его к модулю **Очистка отсутствующих значений**. Дважды щелкните модуль и введите: «Выбор свойств для прогнозирования».

2.  Щелкните **Запустить средство выбора столбцов** в области свойств.

3.  В средстве выбора столбцов выберите **Нет столбцов** для **Начать с**, затем выбрать **Включить** и **названия столбцов** в строке фильтра. Введите наш список столбцов. В этом случае модуль будет передавать на выход только указанные нами столбцы.

    > **Совет:** Так как мы запустили эксперимент на данном этапе, определения столбцов для наших данных передаются из первоначальной выборки через модуль **Очистка отсутствующих значений**. После подключения **Столбцы проекта** к **Очистка отсутствующих значений** модуль **Столбцы проекта** получает информацию обо всех определениях столбцов наших данных. При щелчке мышью в поле названий столбцов отобразится список столбцов, и вы сможете выбрать столбцы по одному для добавления в список.

4.  Нажмите кнопку **ОК**.

![Выбор столбцов][1]

В результате получится выборка данных, которая будет использоваться в обучающем алгоритме на последующих этапах. Позже вы сможете вернуться назад и заново попробовать выбрать другой набор свойств.

### Шаг 4. Выбор и применение алгоритма обучения

Теперь, когда данные готовы, процесс построения прогнозной модели состоит из обучения и тестирования. *Классификация* и *регрессия* — это два типа методов машинного обучения с учителем. Классификация используется, чтобы сформировать прогноз по заданной выборке значений, таких как цвет (красный, синий, или зеленый). Регрессия используется, чтобы сформировать прогноз по непрерывному множеству значений, таких как возраст человека.

Мы хотим предсказать цену автомобиля, которая может принимать любое значение, поэтому мы будем использовать модель регрессии. Для этого примера мы будем обучать простую модель *линейной регрессии* и на следующем этапе будем тестировать ее.

1.  Разделим данные на обучающую и тестовую выборки. Выберите и перетащите модуль **Разделение** в область эксперимента и подключите его к выходу модуля **Столбцы проекта**. Установите значение параметра **Доля строк в первой выходной выборке** в 0,75. Таким образом, мы используем 75% данных для обучения модели и оставим 25% для тестирования.

    > **Совет:** Изменяя параметр **Псевдослучайные числа**, вы можете создавать различные случайные выборки для обучения и тестирования. Этот параметр задает начальное значение для генератора псевдослучайных чисел.

2.  Запустите эксперимент. При этом модули **Столбцы проекта** и **Разделение** передают определения столбцов в модули, которые будут добавлены на следующем этапе.

3.  Для выбора алгоритма обучения разверните категорию **Машинное обучение** в палитре модулей слева в области эксперимента, затем разверните **Инициализировать модуль**. Будут отображены несколько категорий модулей, которые можно использовать для инициализации алгоритма обучения.

    Для учебного эксперимента выберите модуль **Линейная регрессия** из категории **Регрессия** (также вы можете найти модуль, введя «Линейная регрессия» в строке поиска палитры) и перетащите его в область эксперимента.

4.  Найдите и переместите модуль **Обучение модели** в эксперимент. Щелкните **Запустить средство выбора столбцов** и выберите столбец *цена*. Это значение, которое наша модель собирается спрогнозировать.

    ![Выберите столбец «Цена»][]

5.  Соедините левый входной порт с выходом модуля **Линейная регрессия** и правый входной порт с выходом обучающих данных (левый порт) модуля **Разделение**.

6.  Запустите эксперимент.

В результате получим обученную регрессионную модель, которую можно использовать для оценки новых значений с целью прогнозирования.

![Применение обучающего алгоритма][]

### Шаг 5. Прогнозирование по новым данным

После того, как мы обучили модель, ее можно использовать для оценки оставшихся 25% наших данных и проверить, насколько хорошо она работает.

1.  Найдите и перетащите модуль **Оценка модели** в поле эксперимента и подключите левый входной порт к выходу модуля **Обучение модели** и правый входной порт с выходом тестовых данных (правый порт) модуля **Разделение**.

    ![Модуль «Оценка модели»][]

2.  Запустите эксперимент и проверьте вывод модуля **Оценка модели** (дважды щелкните выходной порт и выберите **Визуализировать**). В выходном порту будут показаны спрогнозированные значения цены вместе с известными значениями тестовой выборки.

3.  И наконец, для проверки качества результатов выберите и перетащите модуль **Оценка модели** в область эксперимента и соедините левый входной порт с выходом модуля **Оценка модели** (модуль **Оценка модели** имеет два входа, так как он имеет возможность сравнения двух моделей).

4.  Запустите эксперимент и проверьте вывод модуля **Оценка модели** (дважды щелкните выходной порт и выберите **Визуализировать**). Для нашей модели будет выедена следующая статистика.

    -   **Среднее арифметическое отклонение** (MAE) — среднее значение арифметических отклонений (*отклонение* — это разница между спрогнозированным значением и его фактическим значением).
    -   **Среднеквадратичное отклонение** (RMSE) — квадратный корень из среднего значения возведенных в квадрат арифметических отклонений спрогнозированных значений от тестовой выборки.
    -   **Относительное арифметическое отклонение** — среднее арифметическое отклонение по отношению к абсолютной разнице между фактическими значениями и средним арифметическим всех фактических значений.
    -   **Относительное среднеквадратичное отклонение** — среднее арифметическое среднеквадратичных отклонение по отношению к абсолютной разнице между фактическими значениями и средним арифметическим всех фактических значений.
    -   **Коэффициент смешанной корреляции** — также известен как «R в квадрате», статистический показатель, который оценивает соответствие модели данным.

    Для каждого из показателей отклонений чем меньше значение, тем лучше: меньшее значение указывает на то, что прогноз более точно соответствует фактическим значениям. Для показателя **коэффициент смешанной корреляции** чем ближе его значение к единице (1,0), тем точнее прогноз.

    ![Результаты оценки][]

В окончательном виде эксперимент должен выглядеть следующим образом:

![Завершенный эксперимент][]

### Что дальше?

После настройки эксперимента можно запустить его еще раз, чтобы попытаться улучшить модель. Например, можно изменить свойства, которые используются в прогнозировании. Либо вы можете изменить свойства алгоритма **Линейной регрессии**, либо попробовать использовать вместе с ним другой алгоритм. Можно даже добавить одновременно несколько алгоритмов в эксперимент и сравнивать их (два за один раз), используя модуль **Оценка модели**.

> **Совет:** Используйте кнопку **СОХРАНИТЬ КАК** ниже области эксперимента, чтобы создать копию любого запуска вашего эксперимента. Вы можете просмотреть все запуски вашего эксперимента, нажав кнопку **ПРОСМОТР ИСТОРИИ ЗАПУСКОВ** ниже области эксперимента. Дополнительные сведения см. в разделе справки ML Studio **Просмотр истории запусков**.

Когда вы будете удовлетворены результатами вашей модели, вы можете опубликовать ее в качестве веб-службы, чтобы ее можно было использовать для прогнозирования цен на автомобили, используя новые данные. Дополнительные сведения см. в разделе справки ML Studio **Публикация экспериментов**.

Для более обширного и подробного пошагового руководства по созданию, подготовке, оценке и публикации прогнозной модели см. [Пошаговое руководство: Разработка прогнозного решения с помощью машинного обучения Azure][].

<!-- Images -->

  [Шаг 1: Получение данных]: #step-1-get-data
  [Шаг 2: Предварительная подготовка данных]: #step-2-pre-process-data
  [Шаг 3: Define features]: #step-3-define-features
  [Шаг 4: Выбор и применение алгоритма обучения]: #step-4-choose-and-apply-a-learning-algorithm
  [Шаг 5: Прогнозирование по новым данным]: #step-5-predict-over-new-data
  [Поиск в палитре]: ./media/machine-learning-create-experiment/screen1a.png
  [Выборка]: ./media/machine-learning-create-experiment/screen1.png
  [Визуализация выборки данных]: ./media/machine-learning-create-experiment/screen1b.png
  [Выбор столбцов]: ./media/machine-learning-create-experiment/screen3.png
  [Свойства столбцов проекта]: ./media/machine-learning-create-experiment/screen4.png
  [Свойства модуля очистки значений]: ./media/machine-learning-create-experiment/screen4a.png
  [Первый запуск эксперимента]: ./media/machine-learning-create-experiment/screen5.png
  [1]: ./media/machine-learning-create-experiment/screen6.png
  [Выберите столбец «Цена»]: ./media/machine-learning-create-experiment/screen7.png
  [Применение обучающего алгоритма]: ./media/machine-learning-create-experiment/screen8.png
  [Модуль «Оценка модели»]: ./media/machine-learning-create-experiment/screen8a.png
  [Результаты оценки]: ./media/machine-learning-create-experiment/screen9.png
  [Завершенный эксперимент]: ./media/machine-learning-create-experiment/screen10.png
  [Пошаговое руководство: Разработка прогнозного решения с помощью машинного обучения Azure]: http://azure.microsoft.com/en-us/documentation/articles/machine-learning-walkthrough-develop-predictive-solution/
