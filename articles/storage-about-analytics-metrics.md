<properties 
	pageTitle="Информация о метриках аналитики хранилища" 
	description="Информация об использовании аналитики хранилища, включая метрики транзакций и метрики емкости, а также том, как хранятся метрики и как получить доступ к данным метрик." 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor="cgronlun"/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/20/2015" 
	ms.author="tamram"/>

# Информация о метриках аналитики хранилища

## Обзор

Аналитика хранилища может хранить метрики, включающие сводную статистику по транзакциям и данные о емкости запросов к службе хранилища. Сообщения о транзакциях предоставляются как на уровне операций API, так и на уровне службы хранилища, а сообщения о емкости предоставляются на уровне службы хранилища. Данные метрик можно использовать для анализа использования службы хранилища, диагностики проблем с запросами к службе хранилища и повышения производительности приложений, использующих службу.

Для использования аналитики хранилища ее необходимо включить отдельно для каждой из отслеживаемых служб. Ее можно включить на [портале управления Azure](https://manage.windowsazure.com/). Дополнительную информацию см. в разделе [Как отслеживать учетные записи хранения на портале управления Azure](../how-to-monitor-a-storage-account). Аналитику хранилища также можно включить программно через REST API или клиентскую библиотеку. [Чтобы включить аналитику хранилища для каждой службы, используйте операции Get Blob Service Properties, Get Queue Service Properties](https://msdn.microsoft.com/library/hh452239.aspx) и [Get Table Service Properties](https://msdn.microsoft.com/library/hh452238.aspx).

##Метрики транзакций

Широкий набор данных записывается раз в час или раз в минуту для каждой службы хранилища и запрошенных операций API, включая входящие и выходящие данные, информацию о доступности, ошибки и процент категоризованных запросов. Полный список информации о транзакциях см. в разделе [Схема таблицы метрик аналитики хранилища](https://msdn.microsoft.com/library/hh343264.aspx).

Данные транзакций записываются на двух уровнях - уровне служб и уровне операций API. На уровне службы статистика, суммирующая все запрошенные операции API, записывается в сущность таблицы каждый час, даже если запросов к службе не было. На уровне операции API статистика записывается в сущность, только если в течение этого часа были запрошены операции.

Например, при выполнении операции **GetBlob** в службе BLOB-объектов метрики аналитики хранилища будут регистрировать запрос и включать его в объединенные данные для службы BLOB-объектов и операции **GetBlob**. Но, если в течение часа операция **GetBlob** не запрашивается, сущность не записывается в $MetricsTransactionsBlob для этой операции.

Метрики транзакций записываются как для запросов пользователей, так и для запросов, сделанных самой аналитикой хранилища. Например, записываются запросы аналитики хранилища для записи сущностей журналов и таблиц. Дополнительную информацию о выставлении счетов для этих запросов см. в разделе [Аналитики хранилища и выставление счетов](https://msdn.microsoft.com/library/hh360997.aspx).

##Метрики емкости

>[AZURE.NOTE] В настоящее время метрики емкости доступны только для службы BLOB-объектов. Метрики емкости для службы таблиц и службы очередей будут доступны в будущих версиях аналитики хранилища.

Данные о емкости записываются ежедневно для службы BLOB-объектов учетной записи хранения, и при этом записываются две сущности таблицы. Одна сущность содержит статистику пользовательских данных, а другая - статистику для контейнера больших двоичных объектов $logs, используемого аналитикой хранилища. Таблица $MetricsCapacityBlob содержит следующую статистику:

- **Capacity**: Объем хранилища, используемый службой BLOB-объектов учетной записи хранения, в байтах.

- **ContainerCount**: Количество контейнеров больших двоичных объектов в службе BLOB-объектов учетной записи хранения.

- **ObjectCount**: Количество зафиксированных и незафиксированных блочных или страничных больших двоичных объектов в службе BLOB-объектов учетной записи хранения.

Дополнительную информацию о метриках емкости см. в разделе "Схема таблицы метрик аналитики хранилища".

##Как хранятся метрики

Все данные метрик для каждой из служб хранилища хранятся в таблицах, зарезервированных для этой службы: одна таблица для данных о транзакциях, вторая для данных о минутных транзакциях и третья для данных о емкости. Информация о транзакциях и минутных транзакциях включает в себя данные запросов и ответов, а информация о емкости содержит данные об использовании хранилища. Часовые метрики, минутные метрики и емкость для службы BLOB-объектов учетной записи хранения можно получить в таблицах, имена которых приведены в следующей таблице.

| Уровень метрик                      	| Имена таблиц                                                                                                                 	| Поддерживается в версиях                                                                                                                       	|
|------------------------------------	|-----------------------------------------------------------------------------------------------------------------------------	|----------------------------------------------------------------------------------------------------------------------------------------------	|
| Часовые метрики, основное расположение   	|  $MetricsTransactionsBlob <br/>$MetricsTransactionsTable <br/> $MetricsTransactionsQueue                                              	| Только версии до 15.08.2013 г. Таблицы с такими именами по-прежнему поддерживаются, но рекомендуется перейти на использование таблиц, приведенных ниже. 	|
| Часовые метрики, основное расположение   	| $MetricsHourPrimaryTransactionsBlob <br/>$MetricsHourPrimaryTransactionsTable <br/>$MetricsHourPrimaryTransactionsQueue             	| Все версии, включая 15.08.2013 г.                                                                                                           	|
| Минутные метрики, основное расположение   	| $MetricsMinutePrimaryTransactionsBlob <br/>$MetricsMinutePrimaryTransactionsTable <br/>$MetricsMinutePrimaryTransactionsQueue       	| Все версии, включая 15.08.2013 г.                                                                                                           	|
| Часовые метрики, вторичное расположение 	| $MetricsHourSecondaryTransactionsBlob <br/>$MetricsHourSecondaryTransactionsTable <br/>$MetricsHourSecondaryTransactionsQueue       	| Все версии, включая 15.08.2013 г. Должна быть включена геоизбыточная репликация с доступом для чтения.                                                   	|
| Минутные метрики, вторичное расположение 	| $MetricsMinuteSecondaryTransactionsBlob <br/>$MetricsMinuteSecondaryTransactionsTable <br/>$MetricsMinuteSecondaryTransactionsQueue 	| Все версии, включая 15.08.2013 г. Должна быть включена геоизбыточная репликация с доступом для чтения.                                                   	|
| Емкость (только для службы BLOB-объектов)       	| $MetricsCapacityBlob                                                                                                        	| Все версии, включая 15.08.2013 г.                                                                                                           	|



Эти таблицы автоматически создаются при включении аналитики хранилища для учетной записи хранения. Доступ к ним осуществляется через пространство имен учетной записи хранения, например: `https://<accountname>.table.core.windows.net/Tables("$MetricsTransactionsBlob")`.


##Доступ к данным метрик

Доступ ко всем данным в таблицах метрик можно получить с помощью API службы таблиц, включая API-интерфейсы .NET, предоставленные в управляемой библиотеке Azure. Администратор учетной записи хранения может читать и удалять сущности таблиц, но не может создавать или обновлять их.

##Дальнейшие действия
###Основные понятия
[Включение и настройка аналитик хранилища](https://msdn.microsoft.com/library/hh360996.aspx)

[Схема таблицы метрик аналитики хранилища](https://msdn.microsoft.com/library/hh343264.aspx)

[Операции с протоколированием и сообщения о состоянии аналитик хранилища](https://msdn.microsoft.com/library/hh343260.aspx) 

[Информация о ведении журнала аналитики хранилища](https://msdn.microsoft.com/library/hh343262.aspx) 

###Другие ресурсы

[Мониторинг учетной записи хранения](../how-to-monitor-a-storage-account) 
<!--HONumber=47-->
