<properties
   pageTitle="Создание образа виртуальной машины для Azure Marketplace | Microsoft Azure"
   description="Подробные инструкции по созданию образа виртуальной машины для Azure Marketplace для приобретения другими пользователями."
   services="Azure Marketplace"
   documentationCenter=""
   authors="HannibalSII"
   manager=""
   editor=""/>

<tags
   ms.service="marketplace"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="Azure"
   ms.workload="na"
   ms.date="10/09/2015"
   ms.author="hascipio; v-divte"/>

# Руководство по созданию образа виртуальной машины для Azure Marketplace

Эта статья (**шаг 2**) содержит инструкции по подготовке виртуальных жестких дисков (VHD), развертываемых в Azure Marketplace. Виртуальные жесткие диски являются основой номера SKU. Процесс подготовки будет отличаться в зависимости от типа номера SKU (на основе Linux или Windows). В этой статье рассматриваются оба сценария. Описываемую процедуру можно выполнять параллельно с [созданием и регистрацией учетной записи][link-acct-creation].

## 1\. Определение предложений и номеров SKU

В этом разделе вы узнаете, как определять предложения и соответствующие номера SKU.

Предложение является «родительским» по отношению ко всем номерам SKU, из которых оно состоит. Вы можете создать несколько предложений. Вы сами можете решить, как структурировать свои предложения. Когда предложение переходит к стадии промежуточного хранения, вместе с ним переводятся все связанные с ним номера SKU. Тщательно продумайте идентификаторы SKU, так как они будут видимы в URL-адресе.

- Azure.com: http://azure.microsoft.com/marketplace/partners/{PartnerNamespace}/{OfferIdentifier}-{SKUidentifier}

- Портал предварительной версии Azure: https://portal.azure.com/#gallery/{PublisherNamespace}.{OfferIdentifier}{SKUIDdentifier}

Номер SKU — это коммерческое название для образа виртуальной машины (VM). Образ VM содержит один диск операционной системы и от нуля до нескольких дисков данных. Он представляет собой полный профиль хранения для виртуальной машины. Для одного диска требуется один VHD. VHD необходимо создавать даже для пустых дисков данных.

Вне зависимости от используемой операционной системы добавляйте минимальное количество дисков данных, необходимое для номера SKU. Ваши клиенты не смогут удалить диски, которые являлись частью образа на стадии развертывания, однако при необходимости всегда смогут добавить новые диски во время или после развертывания.

### 1\.1. Добавление предложения

1. Войдите на [портал публикации][link-pubportal], используя свою учетную запись продавца.
2. На портале публикации перейдите на вкладку **Виртуальные машины**. В поле для ввода укажите название предложения. Названием предложения обычно является название продукта (или службы), который вы планируете продавать в Azure Marketplace.
3. Нажмите кнопку **Создать**.

### 1\.2. Определение номера SKU
Добавив предложение, следует определить (идентифицировать) номера SKU. У вас может быть несколько предложений, и каждое из них может содержать несколько номеров SKU. Когда предложение переходит к стадии промежуточного хранения, вместе с ним переводятся все связанные с ним номера SKU.

1. **Добавьте номер SKU.** Для номера SKU необходим идентификатор, который используется в URL-адресе. Идентификатор должен быть уникальным в вашем профиле публикации. При этом риск совпадения идентификаторов с другими издателями отсутствует.

> [AZURE.NOTE]Предложение и идентификатор SKU будут отображаться в URL-адресе предложения в Marketplace.

2. **Добавьте сводное описание для номера SKU.** Описания предназначены для клиентов, поэтому рекомендуем составить текст так, чтобы он легко читался. Эти сведения не должны блокироваться до стадии «Переход к промежуточному хранению». До этого момента вы сможете их редактировать.
3. Если вы используете номера SKU для Windows, используйте предложенные ссылки, чтобы приобрести утвержденные версии Windows Server.

## 2\. Создание виртуального жесткого диска, совместимого с Azure (для Linux)
В следующем разделе приводятся рекомендации по созданию образа виртуальной машины Linux для Azure Marketplace. Пошаговые инструкции см. в статье [Создание и передача виртуального жесткого диска с операционной системой Linux][link-azure-vm-1].

> [AZURE.TIP]Многие из следующих действий (связанные, например, с установкой агента и параметрами загрузки ядра) уже выполнены для образов Linux, доступных в коллекции образов Microsoft Azure. Таким образом, если вы начнете работу с одним из этих образов, взятым за основу, вы сэкономите больше времени, чем при настройке образа Linux, несовместимого с Azure.

### 2\.1. Выбор правильного размера виртуального жесткого диска
Опубликованные номера SKU (образы виртуальных машин) должны работать с виртуальными машинами любых размеров, которые поддерживают определенное количество дисков для данного номера SKU. Вы можете указать рекомендуемые размеры дисков, однако они не будут применяться принудительно.

1. Виртуальный жесткий диск с операционной системой Linux. VHD с ОС Linux в образе виртуальной машины должен иметь фиксированный формат и размер от 30 до 50 ГБ. Минимальный размер равен 30 ГБ. Если физический размер меньше размера VHD, то VHD необходимо разбить на части. Виртуальные жесткие диски для Linux размером более 50 ГБ будут рассматриваться в индивидуальном порядке. Если у вас уже есть VHD в другом формате, вы можете использовать [командлет PowerShell Convert-VHD, чтобы изменить его формат][link-technet-1].
2. VHD для диска данных. Размер дисков данных может достигать 1 ТБ. Виртуальные жесткие диски для дисков данных должны создаваться в фиксированном формате. Тем не менее их также следует разбивать на части. Выбирая размер диска, помните, что конечные пользователи не смогут изменить размер VHD в образе.

### 2\.2. Установка последней версии агента Linux для Azure
При подготовке VHD операционной системы необходимо установить последнюю версию [агента Linux для Azure][link-azure-vm-2] с помощью пакетов RPM или Deb. Пакет часто называется walinuxagent или WALinuxAgent, но лучше уточнить имя, проверив дистрибутив. Этот агент обеспечивает работу ключевых функций для развертывания IaaS на основе Linux в Azure — таких функций, как подготовка виртуальной машины и работа в сети.

Хотя агент можно настроить разными способами, для обеспечения максимальной совместимости мы рекомендуем использовать основную конфигурацию агента. Агент можно установить и вручную, но мы настоятельно рекомендуем использовать предварительно настроенные пакеты из вашего дистрибутива (при наличии).

Если вы все же решите установить агент вручную из [репозитория GitHub][link-github-waagent], сначала скопируйте файл Waagent в каталог /usr/sbin и запустите следующие команды в корневом каталоге:

    # chmod 755 /usr/sbin/waagent
    # /usr/sbin/waagent -install

Файл конфигурации агента будет помещен в файл /etc/waagent.conf.

### 2\.3. Убедитесь, что к файлу прилагаются все необходимые библиотеки
Кроме агента Linux для Azure, необходимо включить также следующие библиотеки:

1. На уровне ядра должны быть включены [службы интеграции Linux][link-intsvc] 3.0 или более поздней версии. См. [требования к ядру Linux](../virtual-machines/virtual-machines-linux-create-upload-vhd-generic/#linux-kernel-requirements).
2. [Исправление ядра](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/scsi/storvsc_drv.c?id=5c1b10ab7f93d24f29b5630286e323d1c5802d5c) для стабильности операций ввода-вывода Azure (скорее всего, не потребуется для ядер последних версий, но это необходимо проверить).
3. [Python][link-python] 2.6 или более поздней версии.
4. Пакет Python pyasn1, если он еще не установлен.
5. [OpenSSL][link-openssl] (рекомендуется версия 1.0 или выше).

### 2\.4. Настройка разделов дисков
Мы не рекомендуем использовать диспетчер логических томов. Создайте один корневой раздел для диска операционной системы. Не используйте раздел swap ни на дисках с операционной системой, ни на дисках данных. Мы настоятельно рекомендуем удалить раздел swap, даже если он не подключен в каталоге /etc/fstab. Если необходимо, раздел swap можно создать на локальном диске ресурсов (/dev/sdb) с помощью агента Linux.

### 2\.5. Добавление необходимых параметров строки загрузки ядра
В строку загрузки ядра необходимо добавить следующие параметры:

        console=ttyS0 earlyprintk=ttyS0 rootdelay=300

Это позволяет службе поддержки Azure предоставлять клиентам выходные данные последовательной консоли при необходимости. Кроме того, это позволяет обеспечить достаточное время ожидания для подключения диска с операционной системой из облачного хранилища. Даже если ваш номер SKU будет блокировать пользователей при попытке прямого SSH-подключения к виртуальной машине, последовательный вывод консоли все равно нужно включить.

### 2\.6. Включите сервер SSH по умолчанию
Мы настоятельно рекомендуем включить SSH для пользователя. Если сервер SSH включен, добавьте функцию обеспечения постоянной работы SSH в файл конфигурации SSHD со следующим параметром: **ClientAliveInterval 180**. Хотя рекомендуется указывать значение 180, приемлемое значение можно взять из диапазона от 30 до 235. Не все приложения должны предоставлять пользователям прямой доступ к виртуальной машине через SSH. Если протокол SSH явно заблокирован, параметр **ClientAliveInterval** можно не настраивать.

### 2\.7. Выполнение требований к сети
Ниже представлены требования к сети для образа виртуальной машины Linux, совместимого с Azure.

- Во многих случаях рекомендуется отключить NetworkManager. Единственным исключением являются системы на основе CentOS 7.x (и производные), для которых компонент NetworkManager должен быть включен.
- Конфигурация сети должна управляться с помощью сценариев **ifup** и **ifdown**. Агент Linux может использовать эти команды для перезапуска сети во время подготовки.
- Пользовательская настройка сети не допускается. В качестве последнего шага следует удалить файл resolv.conf. Обычно это делается в рамках отмены подготовки (см. [руководство пользователя агента Linux для Azure](../virtual-machines/virtual-machines-linux-agent-user-guide/)). Кроме того, вы можете выполнить этот шаг вручную, используя следующую команду:

        rm /etc/resolv.conf

- Сетевое устройство необходимо настроить на включение при загрузке и использовании DHCP.
- IPv6 не поддерживается в Azure. Если это свойство будет включено, работать оно не будет.

### 2\.8. Убедитесь, что вы используете наиболее эффективные способы обеспечения безопасности
Для номеров SKU в Azure Marketplace критически важно следовать передовым рекомендациям в области безопасности. К ним относятся:

- Установите все исправления безопасности, выпущенные для используемого вами дистрибутива.
- Следуйте рекомендациям по обеспечению безопасности дистрибутива.
- Не создавайте учетные записи по умолчанию, остающиеся одинаковыми во всех экземплярах подготовки.
- Сбросьте записи журнала командной оболочки Bash.
- Установите программное обеспечение IPTables (брандмауэр), но не используйте никаких правил. Это обеспечит клиентам удобную работу при использовании параметров по умолчанию. Пользователи, которые захотят использовать брандмауэр виртуальной машины для создания дополнительных конфигураций, могут настроить правила IPTables в соответствии со своими предпочтениями.

### 2\.9. Подготовка образа
Все образы в Azure Marketplace должны быть пригодны для повторного использования в первоначальном виде, что подразумевает отключение некоторых специфических компонентов конфигурации. Чтобы добиться этого в Linux, необходимо отменить подготовку VHD с операционной системой.

Команда Linux для отмены подготовки выглядит следующим образом:

        # waagent -deprovision

Эта команда автоматически выполняет следующие операции:

- удаляет конфигурацию сервера имен в файле /etc/resolv.conf;
- удаляет кэшированные аренды DHCP-клиентов;
- возвращает имя узла localhost.localdomain.

Мы рекомендуем настроить файл конфигурации (/etc/waagent.conf), выполнив следующие действия.

- Установите для параметра Provisioning.RegenerateSshHostKeyPair значение «y» в файле конфигурации, чтобы удалить все ключи узла SSH.
- Установите для параметра Provisioning.DeleteRootPassword значение «y» в файле конфигурации, чтобы удалить пароль привилегированного пользователя из каталога /etc/shadow. Документы о содержимом файла конфигурации см. в разделе Configuration файла Readme на странице агента Linux в репозитории GitHub (перейдите по ссылке [https://github.com/Azure/WALinuxAgent](https://github.com/Azure/WALinuxAgent) и прокрутите вниз).  

На этом этапе подготовку виртуальной машины Linux можно считать завершенной. Завершите работу виртуальной машины на портале Azure, из командной строки или с виртуальной машины. Завершив работу виртуальной машины, переходите к шагу 3.4.

## 3\. Создание виртуального жесткого диска, совместимого с Azure (на основе Windows)
Следующий раздел содержит шаги по созданию номера SKU на основе Windows Server для Azure Marketplace.

### 3\.1. Убедитесь, что вы используете подходящие базовые диски VHD
Виртуальный жесткий диск с ОС для вашего образа виртуальной машины должен быть основан на базовом образе, одобренном для Azure и содержащем Windows Server или SQL Server.

Для начала создайте виртуальную машину из одного из следующих образов, расположенных на [портале Microsoft Azure][link-azure-portal]\:

- Windows Server ([2012 R2 Datacenter][link-datactr-2012-r2], [2012 Datacenter][link-datactr-2012], [2008 R2 с пакетом обновления 1 (SP1)][link-datactr-2008-r2]);
- SQL Server 2014 ([Enterprise][link-sql-2014-ent], [Standard][link-sql-2014-std], [Web][link-sql-2014-web]);
- SQL Server 2012 с пакетом обновления 2 (SP2) ([Enterprise][link-sql-2012-ent], [Standard][link-sql-2012-std], [Web][link-sql-2012-web]).

Эти ссылки можно найти также на портале для публикаций на странице номера SKU.

> [AZURE.TIP]Если вы используете текущую версию портала Azure или PowerShell, используйте образы Windows Server, опубликованные 8 сентября 2014 г. или позднее, одобренные для Azure.


### 3\.2. Создайте виртуальную машину Windows
Используя портал Microsoft Azure, вы можете создать виртуальную машину на основе одобренного базового образа всего за несколько простых шагов. Ниже приведен обзор этого процесса.

1. На странице базового образа нажмите кнопку **Создать виртуальную машину**, чтобы перейти на новый [портал Microsoft Azure][link-azure-portal].

    ![рисунок][img-acom-1]

2. Войдите на портал, используя учетную запись Майкрософт и пароль подписки Azure, которую вы хотите использовать.
3. Следуйте инструкциям на экране, чтобы создать VM с помощью выбранного базового образа. Вам потребуется указать имя узла (компьютера), имя пользователя (зарегистрированного как администратор), а также пароль для виртуальной машины.

    ![рисунок][img-portal-vm-create]

4. Выберите размер виртуальной машины для развертывания.

    а. Если вы планируете локальную разработку VHD, размер не имеет значения. Мы рекомендуем использовать виртуальные машины небольшого размера.

    b. Если вы планируете разработку образа в среде Azure, лучше использовать один из рекомендуемых размеров виртуальной машины для выбранного образа.

    c. С ценами можно ознакомиться в разделе **Рекомендуемые ценовые категории** на портале. В этом разделе можно найти три рекомендуемых размера, предоставленных издателем (в данном случае издателем является Майкрософт).

    ![рисунок][img-portal-vm-size]

5. Задайте свойства.

    а. Для быстроты развертывания можно оставить значения по умолчанию для свойств в разделе **Необязательная конфигурация** и **Группа ресурсов**.

    b. Если нужно, в разделе **Учетная запись хранения** можно выбрать учетную запись хранения, в которой будет храниться VHD с операционной системой.

    c. Если нужно, в разделе **Группа ресурсов** можно выбрать логическую группу, в которой будет размещена виртуальная машина.
6. Выберите **расположение** для развертывания.

    а. Если вы планируете локальную разработку VHD, расположение не имеет значения, так как вы сможете загрузить образ в Azure позднее.

    b. Если вы планируете разработку образа в Azure, рекомендуем с самого начала использовать один из регионов Microsoft Azure в США. Это позволит ускорить копирование VHD, которое выполняет корпорация Майкрософт от вашего имени при отправке образа для сертификации.

    ![рисунок][img-portal-vm-location]

7. Щелкните **Создать**. Начнется развертывание виртуальной машины. Всего через несколько минут у вас появится успешно развернутая виртуальная машина и вы сможете начать создание образа для номера SKU.

### 3\.3. Разработка VHD в облаке
Мы настоятельно рекомендуем разрабатывать VHD в облаке, используя протокол удаленного рабочего стола (RDP). Подключение к удаленному рабочему столу будет осуществляться по протоколу RDP с именем пользователя и паролем, указанным при подготовке.

> [AZURE.IMPORTANT]В случае локальной разработки VHD (не рекомендуется) см. статью [Локальное создание образа виртуальной машины](marketplace-publishing-vm-image-creation-on-premise.md). Загрузка VHD при разработке в облаке не является обязательной.


**Подключение по протоколу RDP через [портал Microsoft Azure][link-azure-portal]**

1. Выберите **Просмотр** > **Виртуальные машины**.
2. Откроется колонка «Виртуальные машины». Убедитесь, что виртуальная машина, к которой вы хотите подключиться, запущена, и выберите ее из списка развернутых виртуальных машин.
3. Откроется колонка с описанием выбранной виртуальной машины. Щелкните **Подключить** в верхней части экрана.
4. Появится запрос на ввод имени пользователя и пароля, которые вы указали при подготовке.

**Подключение по протоколу RDP с помощью PowerShell**

Чтобы загрузить файл удаленного рабочего стола на локальный компьютер, используйте [командлет Get-AzureRemoteDesktopFile][link-technet-2]. Чтобы использовать этот командлет, необходимо знать имя службы и имя виртуальной машины. Если вы создали виртуальную машину с помощью [портала Microsoft Azure][link-azure-portal], эти сведения можно найти в свойствах виртуальной машины.

1. На портале Microsoft Azure выберите **Обзор**, а затем — **Виртуальные машины**.
2. Откроется колонка «Виртуальные машины». Выберите развернутую виртуальную машину.
3. Откроется колонка с описанием выбранной виртуальной машины.
4. Щелкните **Свойства**.
5. Первая часть доменного имени является именем службы. Имя узла представляет собой имя виртуальной машины.

    ![рисунок][img-portal-vm-rdp]

6. Командлет для скачивания RDP-файла для созданной виртуальной машины на локальный компьютер администратора выглядит так:

        Get‐AzureRemoteDesktopFile ‐ServiceName “baseimagevm‐6820cq00” ‐Name “BaseImageVM” –LocalPath “C:\Users\Administrator\Desktop\BaseImageVM.rdp”

Дополнительные сведения об RDP можно найти на сайте MSDN в статье [Подключение к виртуальной машине Azure с помощью RDP или SSH](http://msdn.microsoft.com/library/azure/dn535788.aspx).

**Настройка виртуальной машины и создание номера SKU**

Скачав VHD с операционной системой, используйте клиент Hyper-V и настройте виртуальную машину, чтобы начать создание номера SKU. Подробные инструкции можно найти по следующей ссылке на сайт TechNet: [Установка Hyper-V и настройка виртуальной машины](http://technet.microsoft.com/library/hh846766.aspx).

### 3\.4. Выбор правильного размера VHD
VHD с операционной системой Windows в образе виртуальной машины должен иметь фиксированный формат и размер 128 ГБ.

Если физический размер меньше 128 ГБ, VHD необходимо разбить на части. Предоставляемые базовые образы Windows и SQL Server уже соответствуют этим требованиям. Не меняйте формат и размер полученного виртуального жесткого диска.

Размер дисков данных может достигать 1 ТБ. Выбирая размер диска, помните, что конечные пользователи не смогут изменить размер виртуальных жестких дисков в образе во время развертывания. Виртуальные жесткие диски для дисков данных должны создаваться в фиксированном формате. Тем не менее их также следует разбивать на части. Диски данных могут быть пустыми или содержать данные.


### 3\.5. Установка последних исправлений Windows
Базовые образы содержат последние исправления вплоть до даты публикации. Перед публикацией созданного VHD с операционной системой убедитесь, что Центр обновления Windows запущен и установлены последние критические и важные обновления безопасности.

### 3\.6. Выполнение дополнительной настройки и задание расписания для выполнения задач по мере необходимости
Если необходима дополнительная настройка, попробуйте использовать запланированную задачу, которая сработает при запуске и внесет последние изменения в виртуальную машину сразу после ее развертывания.

- Лучше всего настроить самостоятельное удаление задачи после ее успешного выполнения.
- Ни одна из конфигураций не должна использовать диски, отличные от C или D, так как это единственные два диска, наличие которых гарантировано. Диск C служит для размещения операционной системы, а диск D является временным локальным диском.

### 3\.7. Подготовка образа
Все образы в Azure Marketplace должны быть доступны для повторного использования в первоначальном виде. Другими словами, VHD с операционной системой необходимо подготовить.

- Для Windows образ должен быть подготовлен таким образом, чтобы все конфигурации поддерживали команду **sysprep**.
- Вы можете запустить следующую команду из каталога %windir%\\System32\\Sysprep.

        sysprep.exe /generalize /oobe /sshutdown

  Рекомендации по подготовке операционной системы к использованию команды sysprep приведены на шаге 1 статьи MSDN [Создание и передача виртуального жесткого диска Windows Server в Azure](../virtual-machines/virtual-machines-create-upload-vhd-windows-server/).

## 4\. Развертывание виртуальной машины из дисков VHD
Передав виртуальные жесткие диски (подготовленный VHD с ОС и от нуля до нескольких VHD данных) в учетную запись хранения Azure, их можно зарегистрировать как пользовательский образ виртуальной машины. Затем можно приступать к тестированию образа. Обратите внимание: так как VHD с ОС является подготовленным, вы не можете напрямую развертывать виртуальную машину, указав URL-адрес этого VHD.

Дополнительные сведения об образах виртуальных машин см. в следующих публикациях блога.

- [Образ виртуальной машины](https://azure.microsoft.com/blog/vm-image-blog-post/)
- [Способы использования PowerShell при работе с образами виртуальных машин](https://azure.microsoft.com/blog/vm-image-powershell-how-to-blog-post/)
- [Образы виртуальных машин в Azure](https://msdn.microsoft.com/library/azure/dn790290.aspx)

### 4\.1. Создание пользовательского образа виртуальной машины
Чтобы создать пользовательский образ VM, используя номер SKU для развертывания нескольких виртуальных машин, необходимо воспользоваться [REST API для создания образа виртуальной машины](http://msdn.microsoft.com/library/azure/dn775054.aspx) (это позволит зарегистрировать диски VHD как образ VM).

Для создания образа виртуальной машины с помощью PowerShell можно использовать командлет **Invoke-WebRequest**. В приведенном ниже сценарии PowerShell показано, как создать образ VM, содержащий диск с операционной системой и один диск данных. Обратите внимание, что к этому моменту сеанс PowerShell и подписка уже должны быть настроены.

        # Image Parameters to Specify
        $ImageName=’ENTER-YOUR-OWN-IMAGE-NAME-HERE’
        $Label='ENTER-YOUR-LABEL-HERE'
        $Description='DESCRIBE YOUR IMAGE HERE’
        $osCaching='ReadWrite'
        $os = 'Windows'
        $state = 'Generalized'
        $osMediaLink = 'https://mystorageaccount.blob.core.windows.net/vhds/myosvhd.vhd'
        $dataCaching='None'
        $lun='1'
        $dataMediaLink='http://mystorageaccount.blob.core.windows.net/vhds/mydatavhd.vhd'
        # Subscription-Related Properties
        $SrvMngtEndPoint='https://management.core.windows.net'
        $subscription = Get-AzureSubscription -Current -ExtendedDetails
        $certificate = $subscription.Certificate
        $SubId = $subscription.SubscriptionId
        $body =  
        "<VMImage xmlns=`"http://schemas.microsoft.com/windowsazure`" xmlns:i=`"http://www.w3.org/2001/XMLSchema-instance`">" + Name>" + $ImageName + "</Name>" +
        "<Label>" + $Label + "</Label>" +
        "<Description>" + $Description + "</Description>" + "<OSDiskConfiguration>" +
        "<HostCaching>" + $osCaching + "</HostCaching>" +
        "<OSState>" + $state + "</OSState>" +
        "<OS>" + $os + "</OS>" +
        "<MediaLink>" + $osMediaLink + "</MediaLink>" +
        "</OSDiskConfiguration>" +
        "<DataDiskConfigurations>" +
        "<DataDiskConfiguration>" +
        "<HostCaching>" + $dataCaching + "</HostCaching>" +
        "<Lun>" + $lun + "</Lun>" +
        "<MediaLink>" + $dataMediaLink + "</MediaLink>" +
        "</DataDiskConfiguration>" +
        "</DataDiskConfigurations>" +
        "</VMImage>"
        $uri = $SrvMngtEndPoint + "/" + $SubId + "/" + "services/vmimages" $headers = @{"x-ms-version"="2014-06-01"}
        $response = Invoke-WebRequest -Uri $uri -ContentType "application/xml" -Body
        $body -Certificate $certificate -Headers $headers -Method POST
        if ($response.StatusCode -ge 200 -and $response.StatusCode -lt 300)
        {
        echo "Accepted"
        } else {
        echo "Not Accepted" }
        $opId = $response.Headers.'x-ms-request-id'
        $uri2 = $SrvMngtEndPoint + "/" + $SubId + "/" + "operations" + "/" + $opId $response2 = Invoke-WebRequest -Uri $uri2 -ContentType "application/xml" -
        Certificate $certificate -Headers $headers -Method GET
        $response2.RawContent


Выполнив этот сценарий, вы создадите пользовательский образ виртуальной машины с именем myVMImage, указанным в параметре ImageName. Этот образ состоит из одного диска с операционной системой и одного диска данных.

Этот API-интерфейс представляет собой асинхронную операцию и возвращает код 202 (принято). Чтобы узнать, создан ли образ виртуальной машины, вам потребуется запросить состояние операции. Команда x-ms-request-id должна завершаться отображением идентификатора операции. Этот идентификатор должен быть задан в параметре $opId ниже.

        $opId = #Fill In With Operation ID
        $uri2 = $SrvMngtEndPoint + "/" + $SubId + "/" + "operations" + "/" + "opId"
        $response2 = Invoke‐WebRequest ‐Uri $uri2 ‐ContentType "application/xml" ‐Certificate $certificate ‐Headers $headers ‐Method GET

Чтобы создать образ виртуальной машины из диска VHD с операционной системой и дополнительных пустых дисков данных (при условии, что у вас нет созданных VHD для этого диска) средствами API для создания образа виртуальной машины, используйте следующий сценарий:

        # Image Parameters to Specify
        $ImageName=’myVMImage’
        $Label='IMAGE_LABEL'
        $Description='My VM Image to Test’
        $osCaching='ReadWrite'
        $os = 'Windows'
        $state = 'Generalized'
        $osMediaLink = 'http://mystorageaccount.blob.core.windows.net/containername/myOSvhd.vhd'
        $dataCaching='None'
        $lun='1'
        $emptyDiskSize= 32
        # Subscription-Related Properties
        $SrvMngtEndPoint='https://management.core.windows.net'
        $subscription = Get‐AzureSubscription –Current ‐ExtendedDetails
        $certificate = $subscription.Certificate
        $SubId = $subscription.SubscriptionId
        $body =
        "<VMImage xmlns="http://schemas.microsoft.com/windowsazure" xmlns:i="http://www.w3.org/2001/XMLSchema‐instance">" +
        "<Name>" + $ImageName + "</Name>" +
        "<Label>" + $Label + "</Label>" +
        "<Description>" + $Description + "</Description>" +
        "<OSDiskConfiguration>" +
        "<HostCaching>" + $osCaching + "</HostCaching>" +
        "<OSState>" + $state + "</OSState>" +
        "<OS>" + $os + "</OS>" +
        "<MediaLink>" + $osMediaLink + "</MediaLink>" +
        "</OSDiskConfiguration>" +
        "<DataDiskConfigurations>" +
        "<DataDiskConfiguration>" +
        "<HostCaching>" + $dataCaching + "</HostCaching>" +
        "<Lun>" + $lun + "</Lun>" +
        "<MediaLink>" + $dataMediaLink + "</MediaLink>" +
        "<LogicalDiskSizeInGB>" + $emptyDiskSize + "</LogicalDiskSizeInGB>" +
        "</DataDiskConfiguration>" +
        "</DataDiskConfigurations>" +
        "</VMImage>"
        $uri = $SrvMngtEndPoint + "/" + $SubId + "/" + "services/vmimages"
        $headers = @{"x‐ms‐version"="2014‐06‐01"}
        $response = Invoke‐WebRequest ‐Uri $uri ‐ContentType "application/xml" ‐Body $body ‐Certificate $certificate ‐Headers $headers ‐Method POST
        if ($response.StatusCode ‐ge 200 ‐and $response.StatusCode ‐lt 300)
        {
        echo "Accepted"
        }
        else
        {
        echo "Not Accepted"
        }

Выполнив этот сценарий, вы создадите пользовательский образ виртуальной машины с именем myVMImage, указанным в параметре ImageName. Этот образ состоит из одного диска с операционной системой и одного диска данных.

Этот API-интерфейс представляет собой асинхронную операцию и возвращает код 202 (принято). Чтобы узнать, создан ли образ виртуальной машины, вам потребуется запросить состояние операции. Команда x-ms-request-id должна завершаться отображением идентификатора операции. Этот идентификатор должен быть задан в параметре $opId ниже.

        $opId = #Fill In With Operation ID
        $uri2 = $SrvMngtEndPoint + "/" + $SubId + "/" + "operations" + "/" + "$opId"
        $response2 = Invoke-WebRequest -Uri $uri2 -ContentType "application/xml" Certificate $certificate -Headers $headers -Method GET

Чтобы создать образ виртуальной машины из диска VHD с операционной системой и дополнительных пустых дисков данных (при условии, что у вас нет созданных VHD для этого диска) средствами API для создания образа виртуальной машины, используйте следующий сценарий:

        # Image Parameters to Specify
        $ImageName=’myVMImage’
        $Label='IMAGE_LABEL'
        $Description='My VM Image to Test’
        $osCaching='ReadWrite'
        $os = 'Windows'
        $state = 'Generalized'
        $osMediaLink =
        'http://mystorageaccount.blob.core.windows.net/containername/myOSvhd.vhd'
        $dataCaching='None'
        $lun='1'
        $emptyDiskSize= 32
        # Subscription-Related Properties
        $SrvMngtEndPoint='https://management.core.windows.net'
        $subscription = Get-AzureSubscription –Current -ExtendedDetails
        $certificate = $subscription.Certificate
        $SubId = $subscription.SubscriptionId
        $body =  
        "<VMImage xmlns=`"http://schemas.microsoft.com/windowsazure`" xmlns:i=`"http://www.w3.org/2001/XMLSchema-instance`">" +
        "<Name>" + $ImageName + "</Name>" +
        "<Label>" + $Label + "</Label>" +
        "<Description>" + $Description + "</Description>" + "<OSDiskConfiguration>" + "<HostCaching>" + $osCaching + "</HostCaching>" +
        "<OSState>" + $state + "</OSState>" +
        "<OS>" + $os + "</OS>" +
        "<MediaLink>" + $osMediaLink + "</MediaLink>" +
        "</OSDiskConfiguration>" +
        "<DataDiskConfigurations>" +
        "<DataDiskConfiguration>" +
        "<HostCaching>" + $dataCaching + "</HostCaching>" +
        "<Lun>" + $lun + "</Lun>" +
        "<MediaLink>" + $dataMediaLink + "</MediaLink>" +
        "<LogicalDiskSizeInGB>" + $emptyDiskSize + "</LogicalDiskSizeInGB>" + "</DataDiskConfiguration>" +
        "</DataDiskConfigurations>" +
        "</VMImage>"
        $uri = $SrvMngtEndPoint + "/" + $SubId + "/" + "services/vmimages"
        $headers = @{"x-ms-version"="2014-06-01"}
        $response = Invoke-WebRequest -Uri $uri -ContentType "application/xml" -Body $body Certificate $certificate -Headers $headers -Method POST
        if ($response.StatusCode -ge 200 -and $response.StatusCode -lt 300)
        { echo "Accepted"
        } else
        { echo "Not Accepted"
        }

Выполнив этот сценарий, вы создадите пользовательский образ виртуальной машины с именем myVMImage, указанным в параметре ImageName. Этот образ состоит из одного диска с операционной системой, основанного на переданном вами диске VHD, и одного пустого диска данных объемом 32 ГБ.

### 4\.2 Развертывание виртуальной машины из пользовательского образа VM
Чтобы развернуть виртуальную машину из пользовательского образа VM, можно использовать текущую версию [портала Azure](https://manage.windowsazure.com) или PowerShell.

**Развертывание виртуальной машины с помощью текущей версии портала Azure**

1. Выберите последовательно **Создать** > **Среда выполнения приложений** > **Виртуальная машина** > **Из коллекции**.

    ![рисунок][img-manage-vm-new]

2. Перейдите в раздел **Мои образы** и выберите образ виртуальной машины, из которого следует выполнить развертывание виртуальной машины.
  1. Обратите особое внимание на то, какой образ вы выбираете, так как представление **Мои образы** содержит как образы операционных систем, так и образы виртуальных машин.
  2. Указанное количество дисков поможет определить тип развертываемого образа, так как большинство образов виртуальных машин будут иметь более одного диска. Кроме того, возможно использование образа VM только с одним диском с операционной системой. У такого образа параметр **Количество дисков** будет иметь значение 1.

    ![рисунок][img-manage-vm-select]

3. Следуйте инструкциям мастера создания VM и укажите имя виртуальной машины, ее размер, расположение, имя пользователя и пароль.

**Развертывание виртуальной машины из PowerShell**

Чтобы развернуть большую виртуальную машину из только что созданного подготовленного образа VM, можно использовать следующие командлеты:

    $img = Get‐AzureVMImage ‐ImageName "myVMImage"
    $user = "user123"
    $pass = "adminPassword123"
    $myVM = New‐AzureVMConfig ‐Name "VMImageVM" ‐InstanceSize "Large" ‐ImageName $img.ImageName | Add‐AzureProvisioningConfig ‐Windows ‐AdminUsername $user ‐Password $pass
    New‐AzureVM ‐ServiceName "VMImageCloudService" ‐VMs $myVM ‐Location "West US" ‐WaitForBoot

## 5\. Получение сертификата для образа виртуальной машины
Следующий шаг при подготовке образа виртуальной машины для Azure Marketplace — это сертификация.

Этот процесс включает запуск специального средства сертификации, передачу результатов проверки в контейнер Azure с вашими дисками VHD, добавление предложения, определение номера SKU и отправку образа виртуальной машины для сертификации.

### 5\.1. Загрузка и запуск средства проверки сертификации Azure
Средство сертификации будет работать на запущенной виртуальной машине, подготовленной на основе вашего пользовательского образа виртуальной машины. Оно позволит обеспечить совместимость образа виртуальной машины с Microsoft Azure. Средство проверит соответствие рекомендациям и требованиям, предъявляемым к подготовке диска VHD, и выдаст отчет о совместимости, который нужно будет передать на портал публикации при запросе сертификации.

Средство сертификации можно использовать с виртуальными машинами Windows и Linux. Оно подключается к виртуальным машинам Windows через PowerShell, а к виртуальным машинам Linux — через SSH.Net.

1. Сначала загрузите средство сертификации из [Центра загрузки Майкрософт][link-msft-download].
2. Откройте средство сертификации и нажмите кнопку **Начать новый тест**.
3. На экране **Сведения о проверке** введите имя для тестового запуска.
4. Выберите операционную систему для вашей виртуальной машины — Linux или Windows. В зависимости от выбранного варианта выберите последующие параметры.

### **Подключение средства сертификации к образу виртуальной машины Linux**

1. Выберите режим проверки подлинности SSH: пароль или файл ключа.
2. При использовании проверки подлинности на основе пароля введите DNS-имя, имя пользователя и пароль.
3. При использовании проверки подлинности с помощью файла ключа введите DNS-имя, имя пользователя и расположение закрытого ключа.

  ![Проверка пароля для образа виртуальной машины Linux][img-cert-vm-pswd-lnx]

  ![Проверка подлинности файла ключа для образа виртуальной машины Linux][img-cert-vm-key-lnx]

### **Подключение средства сертификации к образу виртуальной машины Windows**

1. Введите полное доменное имя виртуальной машины (например, MyVMName.ClOudapp.net).
2. Введите имя пользователя и пароль.

  ![Проверка пароля для образа виртуальной машины Windows][img-cert-vm-pswd-win]

Задав нужные параметры для образа виртуальной машины Linux или Windows, нажмите кнопку **Проверить подключение**, чтобы убедиться, что SSH.Net или PowerShell имеет допустимое подключение для тестирования. Когда подключение будет установлено, нажмите кнопку **Далее**, чтобы начать проверку.

После его завершения вы получите результаты («Пройден», «Не пройден» или «Предупреждение») для каждого проверяемого элемента.

![Тестовые случаи для образа виртуальной машины Linux][img-cert-vm-test-lnx]

![Тестовые случаи для образа виртуальной машины Windows][img-cert-vm-test-win]

Если хотя бы один из тестов не будет пройден, образ не будет сертифицирован. В этом случае изучите требования и внесите необходимые изменения.

После автоматической проверки вам будет предложено указать дополнительные входные данные для образа виртуальной машины на экране анкеты. Ответьте на вопросы и нажмите кнопку **Далее**.

![Анкета средства сертификации][img-cert-vm-questionnaire]

![Анкета средства сертификации][img-cert-vm-questionnaire-2]

Заполнив анкету, можно указать дополнительные сведения, например данные для доступа по протоколу SSH для образа VM Linux, а также разъяснения для непройденных проверок. Вы можете скачать результаты проверки и файлы журналов выполненных проверок, а также свои ответы на вопросы анкеты. Сохраните результаты в том же контейнере, что и диски VHD.

![Сохранение результатов теста для сертификации][img-cert-vm-results]

### 5\.2. Получение URI подписанного URL-адреса для образов виртуальных машин

Во время публикации необходимо будет указать URI всех виртуальных жестких дисков, созданных для вашего номера SKU. Майкрософт понадобится доступ к этим дискам во время сертификации. Таким образом, вам потребуется создать URI подписанного URL-адреса для каждого виртуального жесткого диска. Этот URI необходимо ввести на вкладке **Образы** портала публикации.

Созданный URI подписанного URL-адреса должен соответствовать следующим требованиям.

- Для создания URI подписанного URL-адреса для виртуальных жестких дисков достаточно разрешений на создание списков и на чтение. Не предоставляйте разрешения на запись или удаление.
- Продолжительность предоставляемого доступа должна составлять минимум семь рабочих дней с момента создания URI подписанного URL-адреса.
- Чтобы избежать немедленного возникновения ошибок из-за рассинхронизации часов, укажите время на 15 минут раньше текущего.

Чтобы создать URI подписанного URL-адреса, можно использовать инструкции из статей [Подписи общего доступа. Часть 1. Общие сведения о модели SAS][link-azure-1] и [Подписи общего доступа. Часть 2. Создание и использование подписи общего доступа с помощью службы BLOB-объектов][link-azure-2].

Ключ общего доступа можно создать не только с помощью кода, но и с помощью средств хранилища, таких как [обозреватель хранилищ Azure][link-azure-codeplex].

**Использование обозревателя хранилищ Azure для создания ключа общего доступа**

1. Скачайте [обозреватель хранилищ Azure][link-azure-codeplex] версии 6 или более поздней с сайта CodePlex.
2. После установки откройте приложение.
3. Щелкните **Добавить учетную запись**.

    ![рисунок][img-azstg-add]

4. Укажите имя и ключ учетной записи хранения, а также домен конечных точек хранилища. Не устанавливайте флажок **Использовать HTTPS**.

    ![рисунок][img-azstg-setup-1]

5. В результате обозреватель хранилищ Azure будет подключен к нужной вам учетной записи хранения. В нем будут отображаться все контейнеры из учетной записи хранения. Выберите контейнер, в который вы скопировали VHD-файл с диском операционной системы (а также диски данных, если они используются в вашем случае).

    ![рисунок][img-azstg-setup-2]

6. После выбора контейнера BLOB-объектов запустится обозреватель хранилищ Azure, в котором отобразятся файлы, содержащиеся в контейнере. Выберите файл образа (VHD), который необходимо отправить.

    ![рисунок][img-azstg-setup-3]

7. Выбрав VHD-файл в контейнере, перейдите на вкладку **Безопасность**.

    ![рисунок][img-azstg-setup-4]

8. В диалоговом окне **Безопасность контейнера BLOB-объектов** на вкладке **Уровень доступа** оставьте значения по умолчанию и перейдите на вкладку **Подписанные URL-адреса**.

    ![рисунок][img-azstg-setup-5]

9. Выполните следующие действия, чтобы создать URI подписанного URL-адреса для VHD-образа.

    ![рисунок][img-azstg-setup-6]

    а. **Доступ разрешен с.** Чтобы сохранить время в формате UTC, выберите дату начала за день до текущей даты. Например, если сегодня 6 октября 2014 г., выберите 05.10.2014.

    b. **Доступ разрешен до.** Выберите дату, которая наступит через 7–8 дней после даты **Доступ разрешен с**.

    c. **Разрешенные действия.** Выберите разрешения на **создание списков** и **чтение**.

    d. Если VHD-файл выбран правильно, то ваш файл с расширением VHD отобразится рядом с **именем BLOB-объекта**.

    д. Щелкните **Создать подпись**.

    Е. Проверьте содержимое поля **Созданный URI подписанного URL-адреса для контейнера** согласно следующим условиям.

    - 	URL-адрес не должен начинаться с префикса https.
    - 	URI должен включать имя файла образа и расширение VHD.
    - 	В конце URL-адреса должны быть символы «=rl». Это показывает, что права на чтение и создание списков успешно предоставлены.

    ж. Чтобы проверить работу созданного URI подписанного URL-адреса, щелкните **Проверить в браузере**. Должен начаться процесс загрузки.
10. Скопируйте URI подписанного URL-адреса. Этот код URI необходимо вставить на портал публикации.
11. Повторите эти шаги для каждого виртуального жесткого диска в номере SKU.

### 5\.3. Указание сведений об образе виртуальной машины и запросите сертификацию на портале публикации
Создав предложение и номер SKU, нужно ввести сведения об образе, связанные с этим номером SKU.

1. Перейдите на [портал публикации][link-pubportal] и выполните вход с использованием своей учетной записи продавца.
2. Выберите вкладку **Образы виртуальных машин**.
3. Идентификатор вверху страницы является идентификатором предложения, а не идентификатором номера SKU.
4. Задайте свойства в разделе **номеров SKU**.

    ![рисунок][img-pubportal-vm-skus]

5. В разделе **Семейство операционных систем** выберите тип операционной системы, связанный с VHD операционной системы.
6. В поле **Операционная система** введите описание операционной системы. Рекомендуется использовать формат «Семейство ОС, тип, версия, обновления». Например, Windows Server Datacenter 2014 R2.
7. Выберите три рекомендуемых размера виртуальной машины. Эти рекомендации будут отображаться для конечных пользователей в колонке «Ценовая категория» на портале Azure, когда они примут решение приобрести и развернуть ваш образ.

  >[AZURE.NOTE]Это всего лишь рекомендации. Конечный пользователь может выбрать любой размер виртуальной машины, который соответствует дискам, указанным в образе.

8. Введите версию. В поле «Версия» указана семантическая версия для идентификации продукта и его обновлений.
  -	Формат версии должен иметь вид X.Y.Z, где X, Y и Z являются целыми числами.
  -	Образы в разных номерах SKU могут иметь различные основные и дополнительные версии.
  -	Версии в номере SKU должны изменяться только пошагово, увеличивая версию исправления (Z из X.Y.Z).
9. В поле **URL-адрес VHD с ОС** введите URI подписанного URL-адреса, созданного для VHD с операционной системой.
10. Если с этим номером SKU связаны диски данных, выберите логический номер устройства (LUN), к которому должен подключаться этот диск при развертывании.
11. В поле **URL-адрес VHD LUN X** введите URI подписанного URL-адреса, созданного для первого VHD с данными.
12.	Щелкните **Передать результаты проверки**.
13.	Щелкните **Запросить сертификацию**.
14.	Повторите шаги 11, 12 и 13 для каждого дополнительного виртуального жесткого диска данных.

    ![рисунок][img-pubportal-vm-skus-2]

## Дальнейшие действия
Отправив номера SKU образа виртуальной машины для сертификации, можно перейти к [руководству по маркетинговому содержимому Azure Marketplace][link-pushstaging]. На этом шаге публикации следует указать маркетинговые сведения, цены и другую информацию, которую необходимо предоставить до выполнения шага 3 **Тестирование предложения виртуальной машины при промежуточном хранении**. На этом шаге вы можете протестировать предложение виртуальной машины при различных сценариях использования, прежде чем развертывать его в Azure Marketplace для общего доступа и приобретения.

## См. также
- [Приступая к работе: как опубликовать предложение в Azure Marketplace](marketplace-publishing-getting-started.md)

[img-acom-1]: media/marketplace-publishing-vm-image-creation/vm-image-acom-datacenter.png
[img-portal-vm-size]: media/marketplace-publishing-vm-image-creation/vm-image-portal-size.png
[img-portal-vm-create]: media/marketplace-publishing-vm-image-creation/vm-image-portal-create-vm.png
[img-portal-vm-location]: media/marketplace-publishing-vm-image-creation/vm-image-portal-location.png
[img-portal-vm-rdp]: media/marketplace-publishing-vm-image-creation/vm-image-portal-rdp.png
[img-azstg-add]: media/marketplace-publishing-vm-image-creation/vm-image-storage-add.png
[img-azstg-setup-1]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup.png
[img-azstg-setup-2]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup-2.png
[img-azstg-setup-3]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup-3.png
[img-azstg-setup-4]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup-4.png
[img-azstg-setup-5]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup-5.png
[img-azstg-setup-6]: media/marketplace-publishing-vm-image-creation/vm-image-storage-setup-6.png
[img-manage-vm-new]: media/marketplace-publishing-vm-image-creation/vm-image-manage-new.png
[img-manage-vm-select]: media/marketplace-publishing-vm-image-creation/vm-image-manage-select.png
[img-cert-vm-key-lnx]: media/marketplace-publishing-vm-image-creation/vm-image-certification-keyfile-linux.png
[img-cert-vm-pswd-lnx]: media/marketplace-publishing-vm-image-creation/vm-image-certification-password-linux.png
[img-cert-vm-pswd-win]: media/marketplace-publishing-vm-image-creation/vm-image-certification-password-win.png
[img-cert-vm-test-lnx]: media/marketplace-publishing-vm-image-creation/vm-image-certification-test-sample-linux.png
[img-cert-vm-test-win]: media/marketplace-publishing-vm-image-creation/vm-image-certification-test-sample-win.png
[img-cert-vm-results]: media/marketplace-publishing-vm-image-creation/vm-image-certification-results.png
[img-cert-vm-questionnaire]: media/marketplace-publishing-vm-image-creation/vm-image-certification-questionnaire.png
[img-cert-vm-questionnaire-2]: media/marketplace-publishing-vm-image-creation/vm-image-certification-questionnaire-2.png
[img-pubportal-vm-skus]: media/marketplace-publishing-vm-image-creation/vm-image-pubportal-skus.png
[img-pubportal-vm-skus-2]: media/marketplace-publishing-vm-image-creation/vm-image-pubportal-skus-2.png

[link-pushstaging]: marketplace-publishing-push-to-staging.md
[link-github-waagent]: https://github.com/Azure/WALinuxAgent
[link-azure-codeplex]: https://azurestorageexplorer.codeplex.com/
[link-azure-2]: ../storage/storage-dotnet-shared-access-signature-part-2/
[link-azure-1]: ../storage/storage-dotnet-shared-access-signature-part-1/
[link-msft-download]: http://www.microsoft.com/download/details.aspx?id=44299
[link-technet-3]: https://technet.microsoft.com/library/hh846766.aspx
[link-technet-2]: https://msdn.microsoft.com/library/dn495261.aspx
[link-azure-portal]: https://portal.azure.com
[link-pubportal]: https://publish.windowsazure.com
[link-sql-2014-ent]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014enterprisewindowsserver2012r2/
[link-sql-2014-std]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014standardwindowsserver2012r2/
[link-sql-2014-web]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2014webwindowsserver2012r2/
[link-sql-2012-ent]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2enterprisewindowsserver2012/
[link-sql-2012-std]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2standardwindowsserver2012/
[link-sql-2012-web]: http://azure.microsoft.com/marketplace/partners/microsoft/sqlserver2012sp2webwindowsserver2012/
[link-datactr-2012-r2]: http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2012r2datacenter/
[link-datactr-2012]: http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2012datacenter/
[link-datactr-2008-r2]: http://azure.microsoft.com/marketplace/partners/microsoft/windowsserver2008r2sp1/
[link-acct-creation]: marketplace-publishing-accounts-creation-registration.md
[link-azure-vm-1]: ../virtual-machines/virtual-machines-linux-create-upload-vhd/
[link-technet-1]: https://technet.microsoft.com/library/hh848454.aspx
[link-azure-vm-2]: ../virtual-machines/virtual-machines-linux-agent-user-guide/
[link-openssl]: https://www.openssl.org/
[link-intsvc]: http://www.microsoft.com/download/details.aspx?id=41554
[link-python]: https://www.python.org/

<!---HONumber=Nov15_HO4-->