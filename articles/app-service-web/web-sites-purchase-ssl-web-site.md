---
title: "Добавление SSL-сертификата в приложение службы приложений Azure | Документация Майкрософт"
description: "Сведения о добавлении SSL-сертификата в приложение службы приложений."
services: app-service
documentationcenter: .net
author: ahmedelnably
manager: stefsch
editor: cephalin
tags: buy-ssl-certificates
ms.assetid: cdb9719a-c8eb-47e5-817f-e15eaea1f5f8
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/19/2016
ms.author: apurvajo;aelnably
translationtype: Human Translation
ms.sourcegitcommit: 0b53a5ab59779dc16825887b3c970927f1f30821
ms.openlocfilehash: 00e252e249dbd1a38a4649e435071685860722e4
ms.lasthandoff: 04/07/2017


---

# <a name="add-an-ssl-certificate-to-your-app-service-app"></a>Добавление SSL-сертификата в приложение службы приложений
> [!div class="op_single_selector"]
> * [Приобретение и настройка сертификата SSL для службы приложений Azure](web-sites-purchase-ssl-web-site.md)
> * [Защита личного домена приложения с помощью протокола HTTPS](web-sites-configure-ssl-certificate.md)
> 
> 

По умолчанию в [службе приложений Azure](http://go.microsoft.com/fwlink/?LinkId=529714) уже включен протокол HTTPS для вашего веб-приложения с групповым сертификатом для домена \*.azurewebsites.net. Если вы не планируете настраивать пользовательский домен, можно воспользоваться сертификатом HTTPS по умолчанию. Но как и [все домены с подстановочными знаками](https://casecurity.org/2014/02/26/pros-and-cons-of-single-domain-multi-domain-and-wildcard-certificates), групповой сертификат Azure не так безопасен, как личный домен с собственным сертификатом.

Служба приложений позволяет легко приобрести SSL-сертификат и управлять им на портале Azure. 

В этой статье объясняется, как приобрести и настроить SSL-сертификат для вашего приложения [службы приложений](http://go.microsoft.com/fwlink/?LinkId=529714). 

> [!NOTE]
> Вы не можете использовать SSL-сертификаты для имен личных доменов с приложениями, размещенными в плане службы приложений "Общий" или "Бесплатный". Чтобы использовать SSL-сертификаты, веб-приложение должно быть размещено в плане службы приложений "Базовый", "Стандартный" или "Премиум". Изменение типа подписки может повлиять на сумму в выставляемых за подписку счетах. Дополнительные сведения см. на странице [цен на службу приложений](https://azure.microsoft.com/pricing/details/web-sites/).
> 
> 

> [!WARNING]
> Не пытайтесь приобрести SSL-сертификат с помощью подписки, к которой не привязана действительная кредитная карта. Это может привести к отключению подписки. 
> 
> 

## <a name="prerequisites"></a>Предварительные требования
Чтобы включить протокол HTTPS для личного домена, необходимо сначала [сопоставить имя пользовательского домена с приложением Azure](web-sites-custom-domain-name.md).

Перед запросом SSL-сертификата сначала определите, какие доменные имена будут защищены с помощью этого сертификата. От этого зависит требуемый тип сертификата. Если вам необходимо защитить одно доменное имя, например contoso.com *или* www.contoso.com, используйте сертификат уровня "Стандартный" или "Базовый". Если необходимо защитить несколько доменных имен, например contoso.com, www.contoso.com *и* mail.contoso.com, можно использовать [групповой сертификат](http://en.wikipedia.org/wiki/Wildcard_certificate).

## <a name="bkmk_purchasecert"></a>Приобретение SSL-сертификата

1. На [портале Azure](https://portal.azure.com/) в меню щелкните **Обзор**. В поле **поиска** введите **Сертификат службы приложений**. В результатах поиска выберите **Сертификаты службы приложений**. 

   ![Создание с помощью кнопки "Обзор"](./media/app-service-web-purchase-ssl-web-site/browse.jpg)
   
2. На странице **Сертификаты службы приложений** выберите **Добавить**. 

   ![Добавление сертификата](./media/app-service-web-purchase-ssl-web-site/add.jpg)

3. Введите **имя** SSL-сертификата.
4. Введите **имя узла**.
   
   > [!WARNING]
   > Это один из наиболее важных этапов процесса покупки. Убедитесь, что введено правильное имя узла (имя личного домена), который необходимо защитить с помощью этого сертификата. *Не* добавляйте в начале имени узла префикс www. Например, если в качестве имени личного домена используется www.contoso.com, введите **contoso.com** в поле **Имя узла**. Сертификат будет защищать домен www и корневой домен. 
   > 

5. Выберите свою **подписку**. 
   
   Если у вас несколько подписок, создайте SSL-сертификат в той же подписке, которая используется для пользовательского домена или веб-приложения.

6. Выберите или создайте **группу ресурсов**.
   
   Используйте группы ресурсов, чтобы управлять связанными ресурсами Azure как единым целым. Группы ресурсов полезны при установке правил управления доступом на основе ролей для приложений. Дополнительные сведения см. в статье "Управление ресурсами Azure".

7. Выберите **SKU сертификата**. 
   
   Затем выберите SKU сертификата, который соответствует требованиям, и нажмите кнопку **Создать**. 
   
   В службе приложений можно использовать один из двух номеров SKU:
   * **S1.** Сертификат уровня "Стандартный" со сроком действия 1 год и автоматическим обновлением.  
   * **W1.** Групповой сертификат со сроком действия 1 год и автоматическим обновлением.       
  
    ![SKU сертификата](./media/app-service-web-purchase-ssl-web-site/SKU.jpg)

    Дополнительные сведения см. на странице [цен на службу приложений](https://azure.microsoft.com/pricing/details/web-sites/).

> [!NOTE]
> Создание SSL-сертификата может занять до 10 минут. Процесс состоит из нескольких действий, выполняемых в фоновом режиме.  
> 
> 

## <a name="bkmk_StoreKeyVault"></a>Сохранение сертификата в Azure Key Vault

1. После завершения покупки SSL-сертификата перейдите к колонке **Сертификаты службы приложений** на портале Azure.

   ![Сертификат готов к хранению в Key Vault](./media/app-service-web-purchase-ssl-web-site/ReadyKV.jpg)
   
   Обратите внимание, что сертификат находится в состоянии **Ожидание выдачи**. Прежде чем воспользоваться этим сертификатом, нужно сделать кое-что.

2. В колонке **Свойства сертификата** выберите **Конфигурация сертификата**. Чтобы сохранить этот сертификат в Key Vault, выберите **Шаг 1. Сохранение**.
3. В колонке **Состояние Key Vault** выберите **Репозиторий Key Vault**, чтобы выбрать существующее хранилище ключей для сохранения сертификата.  Чтобы создать хранилище ключей в той же подписке и группе ресурсов, выберите **Создать новое Key Vault**.

   ![Создание Key Vault](./media/app-service-web-purchase-ssl-web-site/NewKV.jpg)
   
   > [!NOTE]
   > Расходы для хранения сертификата в Azure Key Vault будут минимальными. Дополнительные сведения см. на странице [цен на Azure Key Vault](https://azure.microsoft.com/pricing/details/key-vault/).
   > 
   > 

4. После выбора репозитория Key Vault для хранения сертификата в верхней части колонки **Состояние Key Vault** нажмите кнопку **Хранилище**.  
   
Чтобы проверить выбранные параметры, нажмите кнопку обновления браузера. По завершении этого шага появится зеленый флажок.

## <a name="bkmk_VerifyOwnership"></a>Проверка владельца домена

1. Выберите **Шаг 2. Проверка** в колонке **Конфигурация сертификата**.
2. Выберите варианты проверки, используя следующие сведения. 

Сертификаты службы приложений поддерживают 3 типа проверки домена:

   * проверка домена;
   * проверка почты;
   * проверка вручную.

### <a name="domain-verification"></a>Проверка домена 
     
Метод проверки домена наиболее удобен, *только* если вы приобрели [личный домен в службе приложений Azure](custom-dns-web-site-buydomains-web-app.md).

1. Чтобы завершить этот шаг, выберите **Проверить**.
2. Выберите **Обновить**, чтобы обновить состояние сертификата после завершения проверки. Проверка может занять несколько минут.

### <a name="mail-verification"></a>Проверка почты
     
Проверочное сообщение уже было отправлено по адресам электронной почты, связанным с этим пользовательским доменом. 

1. Чтобы завершить шаг проверки электронной почты, откройте его и щелкните ссылку для проверки. 
2. Если необходимо повторно отправить проверочное сообщение, нажмите кнопку **Переотправить сообщение электронной почты**.

### <a name="manual-verification"></a>Проверка вручную    
     
**Проверка веб-страницы HTML (работает только с номером SKU сертификата уровня "Стандартный")**

1. Создайте HTML-файл starfield.html. Содержимое этого файла должно совпадать с маркером проверки домена. (Маркер можно скопировать из колонки **состояния проверки домена**.)
2. Отправьте этот файл в корень веб-сервера, на котором размещается ваш домен. Например, /.well-known/pki-validation/starfield.html.
3.  Выберите **Обновить**, чтобы обновить состояние сертификата после завершения проверки. Проверка может занять несколько минут.

    Например, если вы приобретаете сертификат уровня "Стандартный" для **contosocertdemo.com** с маркером проверки домена **tgjgthq8d11ttaeah97s3fr2sh**, то веб-запрос по адресу **http://contosocertdemo.com/.well-known/pki-validation/starfield.html** должен вернуть ответ **tgjgthq8d11ttaeah97s3fr2sh**.

**Проверка записей типа TXT DNS**
        
1. С помощью диспетчера DNS создайте запись типа TXT в поддомене **@** со значением, идентичным **маркеру проверки домена**.
2. Выберите **Обновить**, чтобы обновить состояние сертификата после завершения проверки. Проверка может занять несколько минут.
 
   Например, для проверки группового сертификата с именем узла **\*.contosocertdemo.com** или **\*.subdomain.contosocertdemo.com** и маркером проверки домена **tgjgthq8d11ttaeah97s3fr2sh** создайте запись типа TXT на **contosocertdemo.com** со значением **tgjgthq8d11ttaeah97s3fr2sh**.     

## <a name="bkmk_AssignCertificate"></a>Назначение сертификата приложению службы приложений

> [!NOTE]
> Прежде чем выполнять действия, описанные в этом разделе, необходимо связать имя личного домена с приложением. Дополнительные сведения см. в статье [Сопоставление имени личного домена с приложением Azure](web-sites-custom-domain-name.md).
> 
> 

1. На [портале Azure](https://portal.azure.com/) в меню выберите **Служба приложений**.
2. Выберите имя приложения, которому вы хотите назначить этот сертификат. 
3. Последовательно выберите пункты **Параметры** > **SSL-сертификаты** > **Импортировать сертификат службы приложений**, а затем выберите сертификат.

   ![Импорт сертификата](./media/app-service-web-purchase-ssl-web-site/ImportCertificate.png)

4. В разделе **SSL-привязки** выберите **Add bindings** (Добавить привязки).
5. В колонке **Добавить привязку SSL** выберите имя домена, которое требуется защитить с помощью SSL-сертификата. Выберите сертификат, который нужно использовать. Вы также можете выбрать SSL на основе [указания имени сервера](http://en.wikipedia.org/wiki/Server_Name_Indication) или IP-адреса.

   ![Привязки SSL](./media/app-service-web-purchase-ssl-web-site/SSLBindings.png)
   
    * Чтобы связать сертификат с доменным именем, SSL на основе IP-адреса сопоставляет выделенный общедоступный IP-адрес сервера с доменным именем. При использовании протокола SSL на основе IP-адреса каждому имени домена (например, contoso.com или fabricam.com), связанному с вашей службой, необходимо предоставить выделенный IP-адрес. Это традиционный метод сопоставления SSL-сертификатов с веб-сервером.
    * SSL на основе SNI является расширением SSL и [протокола TLS](http://en.wikipedia.org/wiki/Transport_Layer_Security). При использовании SSL на основе SNI несколько доменов могут совместно использовать один IP-адрес. Каждому домену предоставляется отдельный сертификат безопасности. Большинство современных браузеров, включая Internet Explorer, Chrome, Firefox и Opera, поддерживают SNI. Более старые браузеры могут не поддерживать SNI. Дополнительные сведения об SNI см. в статье Википедии [Server Name Indication](http://en.wikipedia.org/wiki/Server_Name_Indication).

6. Чтобы сохранить изменения и активировать SSL, выберите **Добавить привязку**.

Если выбран **вариант SSL-подключения на основе IP** и пользовательский домен настроен с помощью записи А, необходимо выполнить следующие дополнительные шаги:

1.  После настройки привязки SSL-подключения на основе IP вашему веб-приложению будет предоставлен выделенный IP-адрес. Чтобы найти IP-адрес, последовательно выберите **Параметры** > **Пользовательский домен**. Прямо над разделом **Имена узлов** IP-адрес будет указан как **Внешний IP-адрес**.

   ![SSL на основе IP-адреса](./media/app-service-web-purchase-ssl-web-site/virtual-ip-address.png)
    
  Обратите внимание, что этот IP-адрес отличается от виртуального IP-адреса, который использовался ранее для настройки записи A для вашего домена. Если приложение настроено для использования SSL на основе SNI или не настроено использование SSL, то IP-адрес не будет указан.

2.  С помощью средств, предоставляемых регистратором имени домена, измените запись A для имени личного домена, чтобы она соответствовала IP-адресу из предыдущего шага.

3.  Чтобы подтвердить правильность настройки сертификата, перейдите к приложению, используя HTTPS://, а не HTTP://.

## <a name="bkmk_Export"></a>Экспорт сертификата службы приложений
Вы можете создать локальную копию (PFX-файл) сертификата службы приложения. При наличии локальной копии сертификат можно использовать с другими службами Azure. Дополнительные сведения см. в записи блога [Creating a local PFX copy of App Service Certificate](https://blogs.msdn.microsoft.com/appserviceteam/2017/02/24/creating-a-local-pfx-copy-of-app-service-certificate/) (Создание локальной копии (PFX-файла) сертификата службы приложения).

## <a name="bkmk_Renew"></a>Автообновление сертификата службы приложений
Чтобы настроить параметры автообновления для сертификата или обновить сертификат вручную, выберите параметр **Параметры автовозобновления** в колонке **Свойства сертификата**. 

![Параметры автовозобновления](./media/app-service-web-purchase-ssl-web-site/autorenew.png)

Если вы хотите, чтобы сертификат автоматически обновлялся до истечения его срока действия, установите для параметра **Автовозобновление** значение **Вкл.** Это вариант по умолчанию. Если включено автовозобновление, мы попытаемся обновить ваш сертификат за 90 дней до истечения его срока действия. При создании привязок SSL к приложениям службы приложений на портале Azure привязки также будут обновлены, когда сертификат будет готов (как и при повторном создании ключей или синхронизации сценариев). 

Если вы хотите обрабатывать обновления вручную, установите для параметра **Автовозобновление** значение **Откл.** Сертификат службы приложений можно обновить вручную, только если его срок действия не превышает 90 дней.

## <a name="bkmk_Rekey"></a>Повторное назначение ключа и синхронизация сертификата

1. Если вам когда-либо придется повторно назначить ключ сертификата (по соображениям безопасности), выберите **Повторное создание ключей и синхронизация** в колонке **Свойства сертификата**. 
2. Выберите **Повторное создание ключей**. На завершение процесса может потребоваться до 10 минут. 

   ![Повторное создание ключа SSL](./media/app-service-web-purchase-ssl-web-site/Rekey.jpg)

Ниже представлены некоторые полезные сведения о повторном создании ключей.

* Повторное создание ключей для сертификата приведет к его замене на новый сертификат, выданный центром сертификации.
* Повторное назначение ключа не тарифицируется в течение времени существования сертификата. 
* При повторном создании ключей сертификат переходит в состояние **ожидания выдачи**. 
* Когда сертификат будет готов, синхронизируйте ресурсы с помощью этого сертификата, чтобы работа службы не прерывалась.
* Синхронизация не доступна для сертификатов, не назначенных веб-приложению. 

## <a name="next-steps"></a>Дальнейшие действия

* [Защита личного домена приложения с помощью протокола HTTPS](web-sites-configure-ssl-certificate.md)
* [Приобретение и настройка имени личного домена для службы приложений Azure](custom-dns-web-site-buydomains-web-app.md)
* [Центр управления безопасностью Microsoft Azure](https://azure.microsoft.com/en-us/support/trust-center/)

> [!NOTE]
> Чтобы приступить к работе со службой приложений Azure до регистрации и получения учетной записи Azure, перейдите на страницу [пробной версии службы приложений Azure](https://azure.microsoft.com/try/app-service/). Вы сможете создать в службе приложений кратковременное начальное веб-приложение. Не требуется никаких кредитных карт и обязательств.
> 
> 

