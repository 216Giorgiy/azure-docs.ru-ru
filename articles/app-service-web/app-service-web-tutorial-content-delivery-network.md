---
title: "Добавление сети доставки содержимого в службу приложений Azure | Документация Майкрософт"
description: "Сведения о добавлении сети доставки содержимого в службу приложений Azure для доставки статических файлов из граничных узлов."
services: app-service
author: syntaxc4
ms.author: cfowler
ms.date: 04/03/2017
ms.topic: hero-article
ms.service: app-service-web
manager: erikre
translationtype: Human Translation
ms.sourcegitcommit: 9eafbc2ffc3319cbca9d8933235f87964a98f588
ms.openlocfilehash: 7ba3737566401152a3171e8926beca188045230c
ms.lasthandoff: 04/22/2017

---
# <a name="add-a-content-deliver-network-on-an-azure-app-service"></a>Добавление сети доставки содержимого в службу приложений Azure

В этом руководстве описано, как добавить сеть доставки содержимого (CDN) в службу приложений Azure для доставки статического содержимого на граничные узлы, а также как создать профиль CDN, который может состоять из 10 конечных точек CDN.

Сеть доставки содержимого кэширует статическое веб-содержимое в стратегически расположенных точках. Это позволяет обеспечить максимальную пропускную способность для доставки содержимого пользователям. Использование сети CDN для кэширования ресурсов веб-сайтов приносит следующие преимущества.

* Повышение производительности и улучшение взаимодействия с конечными пользователями, особенно для тех приложений, в которых для загрузки содержимого требуется много циклов приема-передачи.
* Высокий уровень масштабирования, который улучшает обработку пиковых нагрузок, например при запуске нового продукта.
* Снижение трафика, отправляемого на источник содержимого, благодаря распределению запросов пользователей и доставке контента с пограничных серверов.

> [!TIP]
> Просмотрите обновленный список [расположений POP Azure CDN](https://docs.microsoft.com/en-us/azure/cdn/cdn-pop-locations).
>

## <a name="deploy-the-sample"></a>Развертывание примера

В рамках этого руководства вам потребуется развернуть приложение в веб-приложении. Чтобы получить основные компоненты, необходимые для работы с этим руководством, выполните действия, описанные в статье [Создание статического веб-приложения HTML в Azure за пять минут](app-service-web-get-started-html.md).

## <a name="step-1---login-to-azure-portal"></a>Шаг 1. Вход на портал Azure

Сначала откройте свой браузер и перейдите на [портал](https://portal.azure.com) Azure.

## <a name="step-2---create-a-cdn-profile"></a>Шаг 2. Создание профиля CDN

В области навигации слева нажмите кнопку `+ New` и щелкните **Интернет+мобильные устройства**. В категории "Интернет+мобильные устройства" выберите **CDN**.

Укажите следующие значения полей:

| Поле | Образец значения | Описание |
|---|---|---|
| Имя | myCDNProfile | Имя профиля CDN. |
| Расположение | Западная Европа | Это расположение Azure, где будут храниться данные профиля сети CDN. Оно не влияет на расположение конечных точек сети CDN. |
| Группа ресурсов | myResourceGroup | Дополнительные сведения о группах ресурсов см. в [этом разделе](../azure-resource-manager/resource-group-overview.md#resource-groups). |
| Ценовая категория  | Akamai уровня "Стандартный" | Сравнение ценовых категорий см. в [обзоре CDN](../cdn/cdn-overview.md#azure-cdn-features). |

Щелкните **Создать**.

В области навигации слева откройте центр групп ресурсов и выберите **myResourceGroup**. В списке ресурсов выберите **myCDNProfile**.

![azure-cdn-profile-created](media/app-service-web-tutorial-content-delivery-network/azure-cdn-profile-created.png)

## <a name="step-3---create-a-cdn-endpoint"></a>Шаг 3. Создание конечной точки CDN

В командах возле поля поиска щелкните **+ Endpoint** (+ Конечная точка). После этого запустится колонка создания конечной точки.

Укажите следующие значения полей:

| Поле | Образец значения | Описание |
|---|---|
| Имя |  | Это имя будет использоваться для доступа к кэшированным ресурсам в домене `<endpointname>.azureedge.net`. |
| Тип источника | Веб-приложение | Если выбрать тип источника, откроются контекстные меню оставшихся полей, а если настраиваемый источник — текстовое поле для ввода имени узла источника. |
| Имя узла источника | |  В раскрывающемся списке будут перечислены все доступные источники указанного типа. Если в качестве значения параметра "Тип источника" вы выбрали "Настраиваемый источник", потребуется ввести домен вашего настраиваемого источника.  |

Щелкните **Добавить**.

После создания конечной точки сети доставки содержимого состояние изменится на **Выполняется**.

![azure-cdn-endpoint-created](media/app-service-web-tutorial-content-delivery-network/azure-cdn-endpoint-created.png)

## <a name="step-4---serve-from-azure-cdn"></a>Шаг 4. Обслуживание из Azure CDN

После **запуска** конечной точки CDN вы сможете обращаться к ее содержимому.

Учитывая, что при подготовке к работе с этим руководством мы использовали статью [Создание статического веб-приложения HTML в Azure за пять минут](app-service-web-get-started-html.md), в сети доставки содержимого должны находиться следующие папки: `css`, `img` и `js`.

Пути к содержимому между URL-адресом веб-приложения `http://<app_name>.azurewebsites.net/img/` и URL-адресом конечной точки CDN `http://<endpointname>.azureedge.net/img/` совпадают. Это означает, что вы можете просто добавить в домен конечной точки CDN любое статическое содержимое для последующей обработки из CDN.

Давайте извлечем первое изображение из конечной точки CDN. В предпочитаемом браузере перейдите по следующему URL-адресу:

```bash
http://<endpointname>.azureedge.net/img/03-enterprise.png
```

Теперь статическое содержимое доступно в CDN. Вы можете обновить приложение, что позволит доставить содержимое к пользователю через конечную точку CDN.

В зависимости от языка создания сайта для восстановления размещения CDN можно использовать множество платформ. Например, ASP.NET предоставляет поддержку [объединения и минификации](https://docs.microsoft.com/en-us/aspnet/mvc/overview/performance/bundling-and-minification#using-a-cdn), что, в свою очередь, предоставляет возможности восстановления размещения CDN.

Если используемый язык не имеет библиотеки или встроенной поддержки восстановления размещения CDN, вы можете использовать платформу JavaScript (например, [FallbackJS](http://fallback.io/)), которая поддерживает загрузку [скриптов](https://github.com/dolox/fallback/tree/master/examples/loading-scripts), [таблиц стилей](https://github.com/dolox/fallback/tree/master/examples/loading-stylesheets) и [изображений](https://github.com/dolox/fallback/tree/master/examples/loading-images).

## <a name="step-5---purge-the-cdn"></a>Шаг 5. Очистка CDN

Возможно, в некоторых случаях вы захотите принудительно очистить сеть доставки содержимого, например, чтобы удалить содержимое до истечения срока жизни.

Это можно сделать вручную в колонке профиля или конечной точки CDN. Выполняя очистку на странице профиля, вы должны выбрать конечную точку, которую необходимо очистить.

Чтобы очистить содержимое, введите пути к содержимому, которые необходимо очистить. Вы можете передать полный путь к файлу, чтобы очистить отдельный файл, или сегмент пути, чтобы очистить и обновить содержимое определенной папки.

Предоставив все пути к содержимому, нажмите кнопку **Очистить**.

![app-service-web-purge-cdn](media/app-service-web-tutorial-content-delivery-network/app-service-web-purge-cdn.png)

## <a name="step-6---map-a-custom-domain"></a>Шаг 6. Сопоставление личного домена

Сопоставив личной домен с конечной точкой CDN, вы получите уникальный домен для своего веб-приложения.

Чтобы сопоставить личный домен с конечной точкой CDN, создайте запись CNAME с помощью регистратора доменных имен.

> [!NOTE]
> Запись CNAME — это компонент DNS, позволяющий сопоставить исходный (например, `www.contosocdn.com` или `static.contosocdn.com`) и целевой домены.

В этом случае мы добавим исходный домен `static.contosocdn.com` и укажем конечный домен (конечная точка CDN).

| Исходный домен | Конечный домен |
|---|---|
| static.contosocdn.com | &lt;Имя_конечной_точки&gt;.azureedge.net |

В колонке обзора конечной точки CDN нажмите кнопку `+ Custom domain`.

В колонке "Добавление пользовательского домена" диалогового окна введите личный домен и поддомен. Например, введите имя домена в формате `static.contosocdn.com`.

Щелкните **Добавить**.

## <a name="step-7---version-content"></a>Шаг 7. Версия содержимого

Вернитесь в колонку конечной точки CDN. В области навигации слева под заголовком "Параметры" выберите **Кэш**.

В колонке **Кэш** можно настроить параметры обработки строк запроса в CDN.

> [!NOTE]
> Сведения о параметрах кэширования строк запроса см. в статье [Управление режимом кэширования Azure CDN с помощью строк запросов](../cdn/cdn-query-string.md).

В качестве параметра кэширования строк запроса в раскрывающемся списке выберите **Кэшировать каждый уникальный URL-адрес**.

Щелкните **Сохранить**.

## <a name="next-steps"></a>Дальнейшие действия

* [What is Azure CDN](../best-practices-cdn.md?toc=%2fazure%2fcdn%2ftoc.json) (Что такое сеть доставки содержимого Azure)
* [Включение протокола HTTPS для личного домена Azure CDN](../cdn/cdn-custom-ssl.md)
* [Повышение производительности за счет сжатия файлов в Azure CDN](../cdn/cdn-improve-performance.md)
* [Предварительная загрузка ресурсов на конечной точке CDN Azure](../cdn/cdn-preload-endpoint.md)

