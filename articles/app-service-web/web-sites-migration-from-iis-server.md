---
title: "Миграция корпоративного веб-приложения в службу приложений Azure"
description: "В этой статье описано, как с помощью помощника по миграции веб-приложений можно быстро перенести существующие веб-сайты IIS в веб-приложения службы приложений Azure"
services: app-service
documentationcenter: 
author: cephalin
writer: cephalin
manager: erikre
editor: 
ms.assetid: 2e846fc0-37cc-42e6-ac57-ff442ef16e85
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/01/2016
ms.author: cephalin
ms.translationtype: HT
ms.sourcegitcommit: f76de4efe3d4328a37f86f986287092c808ea537
ms.openlocfilehash: 18d6a8da38b42dcf5c1500f7fc26638aea26a809
ms.contentlocale: ru-ru
ms.lasthandoff: 07/11/2017


---
# <a name="migrate-an-enterprise-web-app-to-azure-app-service"></a>Миграция корпоративного веб-приложения в службу приложений Azure
Вы можете легко перенести в [веб-приложения службы приложений](http://go.microsoft.com/fwlink/?LinkId=529714)существующие веб-сайты, которые работают в службах IIS версии 6 или более поздней версии. 

> [!IMPORTANT]
> Срок поддержки Windows Server 2003 истек 14 июля 2015 года. Если веб-сайты на IIS-сервере хранятся в Windows Server 2003, можно поддерживать их работу на основе веб-приложений Azure, безопасного, экономичного и эффективного решения, при этом помощник по миграции веб-приложений позволит автоматизировать процесс переноса необходимых данных. 
> 
> 

[Помощник по миграции веб-приложений](https://www.movemetothecloud.net/) проанализирует установку IIS-сервера, определит, какие сайты можно перенести в службу приложений, выделит элементы, которые перенести не удастся или которые не поддерживает платформа, а затем перенесет веб-сайты и связанные с ними базы данных на платформу Azure.

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="elements-verified-during-compatibility-analysis"></a>Элементы, проверяемые во время анализа совместимости
Помощник по миграции создает отчет о готовности, чтобы выявить потенциальные проблемы или критические препятствия, которые могут помешать успешной миграции с локального сервера IIS на веб-приложения службы приложений Azure. Ниже указаны некоторые ключевые моменты, которые необходимо учесть.

* Привязки портов. Служба веб-приложений Azure поддерживает только порт 80 для HTTP-трафика и порт 443 для HTTPS-трафика. Конфигурации других портов будут проигнорированы, а трафик будет направлен на порт 80 или 443. 
* Проверка подлинности. Служба веб-приложений Azure поддерживает анонимную проверку подлинности по умолчанию и проверку подлинности на основе форм, указанную в приложении. Проверка подлинности Windows может использоваться только при интеграции в Azure Active Directory и ADFS. Другие формы проверки подлинности, например обычная проверка подлинности, сейчас не поддерживаются. 
* Глобальный кэш сборок (GAC) не поддерживается веб-приложениями. Если приложение ссылается на сборки, которые обычно развертываются в глобальном кэше сборок, их необходимо развернуть в папку корзины приложения в веб-приложениях. 
* Режим совместимости с IIS5 не поддерживается в веб-приложениях. 
* Пулы приложений. Каждый сайт и его дочерние приложения в веб-приложениях Azure работают в одном пуле приложений. Если сайт имеет несколько дочерних приложений, которые используют различные пулы приложений, их необходимо объединить в единый пул приложений с общими настройками или перенести каждое приложение в отдельное веб-приложение.
* Компоненты COM. Веб-приложения Azure не разрешают регистрацию COM-компонентов на платформе. Если веб-сайты или приложения используют COM-компоненты, то их необходимо переписать в управляемый код и развернуть вместе с веб-сайтом или приложением.
* Расширения ISAPI. Веб-приложения поддерживают использование расширений ISAPI. Сделайте следующее.
  
  * Разверните библиотеки DLL вместе с веб-приложением. 
  * Зарегистрируйте библиотеки DLL с помощью [Web.config](http://www.iis.net/configreference/system.webserver/isapifilters)
  * Поместите файл applicationHost.xdt в корневой каталог сайта с содержимым, указанным в разделе "Allowing arbitrary ISAPI extensions to be loaded" (Как разрешить загрузку произвольных расширений ISAPI) [этой статьи](https://github.com/projectkudu/kudu/wiki/Xdt-transform-samples). 
    
  
    
    Другие примеры использования преобразований документа XML с помощью веб-сайта см. в разделе [Преобразование веб-сайта Microsoft Azure](http://blogs.msdn.com/b/waws/archive/2014/06/17/transform-your-microsoft-azure-web-site.aspx).
* Другие компоненты, например SharePoint, серверные расширения главных страниц (FPSE), FTP-служба и SSL-сертификаты, перенесены не будут.

## <a name="how-to-use-the-web-apps-migration-assistant"></a>Использование помощника по миграции веб-приложений
В этом разделе мы рассмотрим пошаговый пример переноса нескольких веб-сайтов, использующих базу данных SQL Server и работающих на локальном компьютере Windows Server 2003 R2 (IIS 6.0).

1. На IIS-сервере или на клиентской машине перейдите на веб-сайт [https://www.movemetothecloud.net/](https://www.movemetothecloud.net/) 
   
   ![](./media/web-sites-migration-from-iis-server/migration-tool-homepage.png)
2. Установите помощник по миграции веб-приложений, нажав кнопку **Выделенный сервер IIS** . Дополнительные параметры можно будет настроить на следующих этапах. 
3. Нажмите кнопку **Средство установки** и установите помощник по миграции веб-приложений на свой компьютер.
   
   ![](./media/web-sites-migration-from-iis-server/install-page.png)
   
   > [!NOTE]
   > В качестве альтернативы можно щелкнуть **Download for offline install** (Загрузить для установки вне сети), загрузить ZIP-файл и установить помощник на серверах без подключения к Интернету. Либо можно выбрать пункт **Загрузить имеющийся отчет о готовности к переносу**— расширенный вариант для работы с имеющимся отчетом о готовности к переносу, который был создан перед этим (процесс создания рассмотрен ниже).
   > 
   > 
4. В окне **Установка приложения** щелкните **Установить**, чтобы начать установку службы на компьютер. При необходимости будут также установлены связанные компоненты, такие как Web Deploy, DacFX и IIS. 
   
   ![](./media/web-sites-migration-from-iis-server/install-progress.png)
   
   После установки помощник по миграции веб-приложений запускается автоматически.
5. Выберите пункт **Перенести сайты и базы данных с удаленного сервера на платформу Azure**. Введите учетные данные администратора удаленного сервера и нажмите кнопку **Продолжить**. 
   
   ![](./media/web-sites-migration-from-iis-server/migrate-from-remote.png)
   
   Конечно, можно перенести данные и с локального сервера. Вариант удаленного переноса полезен в тех случаях, когда необходимо перенести веб-сайты с рабочего сервера IIS.
   
   На этом этапе средство переноса проверит конфигурацию сервера IIS (сайты, приложения, пулы приложений и компоненты), чтобы определить, какие веб-сайты готовы к миграции. 
6. Ниже на снимке экрана показаны три веб-сайта: **Default Web Site**, **TimeTracker** и **CommerceNet4**. У всех этих сайтов есть базы данных, которые необходимо перенести. Выберите все сайты, которые необходимо проверить, и нажмите кнопку **Далее**.
   
   ![](./media/web-sites-migration-from-iis-server/select-migration-candidates.png)
7. Нажмите кнопку **Отправить** , чтобы начать передачу отчета о готовности к переносу. Если нажать кнопку **Сохранить файл локально**, то можно запустить средство переноса и отправить сохраненный отчет о готовности к переносу позже.
   
   ![](./media/web-sites-migration-from-iis-server/upload-readiness-report.png)
   
   Когда отчет о готовности будет передан, Azure выполнит анализ готовности и выведет результаты. Прежде чем продолжить, прочтите детали оценки каждого веб-сайта и убедитесь, что все задачи понятны и решены. 
   
   ![](./media/web-sites-migration-from-iis-server/readiness-assessment.png)
8. Щелкните **Begin Migration** (Начать перенос), чтобы начать перенос данных. Произойдет перенаправление на платформу Azure для входа в учетную запись. Важно войти учетную запись с активной подпиской Azure. Если у вас нет учетной записи Azure, то зарегистрироваться для получения бесплатной пробной версии можно [здесь](https://azure.microsoft.com/pricing/free-trial/?WT.srch=1&WT.mc_ID=SEM_). 
9. Выберите учетную запись клиента, подписку Azure и регион для использования веб-приложений и баз данных, перенесенных в Azure, а затем нажмите кнопку **Start Migration**(Начать миграцию). Выбрать веб-сайты для переноса можно позже.
   
   ![](./media/web-sites-migration-from-iis-server/choose-tenant-account.png)
10. В следующем окне можно изменить настройки по умолчанию:
    
    * использовать существующую базу данных SQL Azure или создать новую базу данных SQL Azure и настроить учетные данные для нее;
    * выбрать веб-сайты для переноса;
    * определить имена для веб-приложений Azure и связанных с ними баз данных SQL;
    * настроить глобальные параметры и параметров на уровне веб-сайта.
    
    На следующем снимке экрана показаны все выбранные для миграции веб-сайты с параметрами по умолчанию.
    
    ![](./media/web-sites-migration-from-iis-server/migration-settings.png)
    
    > [!NOTE]
    > Флажок **Включить Azure Active Directory** в пользовательских настройках позволяет интегрировать веб-приложение Azure с [Azure Active Directory](../active-directory/active-directory-whatis.md) (**каталог по умолчанию**). Дополнительные сведения о синхронизации службы Azure Active Directory с локальной службой Active Directory см. в статье [Интеграция служб каталогов](http://msdn.microsoft.com/library/jj573653).
    > 
    > 
11. После внесения всех необходимых изменений нажмите кнопку **Создать** , чтобы запустить процесс миграции. Средство миграции создаст базу данных SQL Azure и веб-приложение Azure, а затем опубликует содержимое веб-сайта и баз данных. Процесс миграции четко отображается в средстве миграции, а по окончании миграции отобразится окно сводки, в котором будут указаны сведения о перенесенных компонентах сайтов, результатах миграции, а также ссылки на созданные веб-приложения Azure. 
    
    Если в процессе миграции возникнут ошибки, то в средстве миграции отобразится сбой и будет выполнен откат изменений. Можно также нажать кнопку **Отправить отчет об ошибке** , чтобы отправить команде разработчиков отчет об ошибке вместе со стеком вызовов ошибки и текстом сообщения. 
    
    ![](./media/web-sites-migration-from-iis-server/migration-error-report.png)
    
    Если миграция завершена успешно, то можно нажать кнопку **Отправить отзыв** , чтобы оставить свой комментарий. 
12. Перейдите по ссылкам на веб-приложения Azure и проверьте результаты миграции.
13. Теперь вы можете управлять перенесенными веб-приложениями в службе приложений Azure. Для этого войдите на [портал Azure](https://portal.azure.com).
14. На портале Azure откройте колонку веб-приложений, чтобы просмотреть перенесенные веб-сайты (отображаются как веб-приложения), а затем щелкните один из них, чтобы начать управлять веб-приложением, например настроить непрерывную публикацию, создать резервные копии, выполнить автоматическое масштабирование и мониторинг использования и производительности.
    
    ![](./media/web-sites-migration-from-iis-server/TimeTrackerMigrated.png)

> [!NOTE]
> Чтобы приступить к работе со службой приложений Azure до создания учетной записи Azure, перейдите к разделу [Пробное использование службы приложений](https://azure.microsoft.com/try/app-service/), где вы можете быстро создать кратковременное веб-приложение начального уровня в службе приложений. Никаких кредитных карт и обязательств.
> 
> 

## <a name="whats-changed"></a>Изменения
* Руководство по переходу от веб-сайтов к службе приложений см. в статье [Служба приложений Azure и существующие службы Azure](http://go.microsoft.com/fwlink/?LinkId=529714).


