<properties
   pageTitle="Создание веб-приложения ASP.NET 5 в Visual Studio Code"
   description="В этом учебнике показано, как создать приложение ASP.NET 5, используя Visual Studio Code."
   services="app-service\web"
   documentationCenter=".net"
   authors="erikre"
   manager="wpickett"
   editor="jimbe"/>

<tags
	ms.service="app-service-web" 
	ms.workload="web" 
	ms.tgt_pltfrm="dotnet" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="10/12/2015" 
	ms.author="erikre"/>

# Создание веб-приложения ASP.NET 5 в Visual Studio Code

## Обзор

В этом учебнике показано, как создать веб-приложение ASP.NET 5, используя [Visual Studio Code (VSCode)](http://code.visualstudio.com//Docs/whyvscode), и развернуть его в [службе приложений Azure](../app-service/app-service-value-prop-what-is.md). ASP.NET 5 является существенно переработанной версией ASP.NET. Это новая кроссплатформенная среда с открытым кодом, предназначенная для создания современных облачных веб-приложений с использованием .NET. Дополнительную информацию см. в статье [Введение в ASP.NET 5](http://docs.asp.net/en/latest/conceptual-overview/aspnet.html). Дополнительную информацию о веб-приложениях службы приложений Azure см. в статье [Обзор веб-приложений](app-service-web-overview.md).

[AZURE.INCLUDE [app-service-web-try-app-service.md](../../includes/app-service-web-try-app-service.md)]

## Предварительные требования  

* Установка [VSCode](http://code.visualstudio.com/Docs/setup).
* Установите [Node.js](http://nodejs.org) — Node.js — это платформа для создания быстрых и масштабируемых серверных приложений с помощью JavaScript. Node — это среда выполнения (Node), а [npm](http://www.npmjs.com/) — диспетчер пакетов для модулей Node. Мы будем использовать npm в этом учебнике для формирования шаблонов веб-приложения ASP.NET 5.
* Установите Git. Можно установить систему с любого из этих сайтов: [Chocolatey](https://chocolatey.org/packages/git) или [git-scm.com](http://git-scm.com/downloads). Если вы не знакомы с Git, выберите [git-scm.com](http://git-scm.com/downloads) и выберите параметр **Использовать Git из командной строки Windows**. После установки Git также необходимо задать имя пользователя Git и его адрес электронной почты, так как это потребуется далее в этом учебнике (при выполнении фиксации из VSCode).  

## Установка ASP.NET 5 и DNX
ASP.NET 5 и DNX представляют собой простой стек .NET для сборки современных облачных и веб-приложений, работающих в OS X, Linux и Windows. Он был создан с нуля, чтобы предоставить платформу для разработки, оптимизированную для приложений, которые можно разворачивать в облачной или локальной среде. Он состоит из модульных компонентов с минимальными служебными данными, что позволяет сохранить гибкость при построении решений.

> [AZURE.NOTE]ASP.NET 5 и DNX (среда выполнения .NET) в OS X и Linux находятся на стадии ранней бета-версии или предварительной версии.

Этот учебник позволяет приступить к созданию приложений с помощью последних версий ASP.NET 5 и DNX для разработчиков. Приведенные ниже указания относятся только к Windows. Более подробные указания по установке для OS X, Linux и Windows см. в разделе [Установка ASP.NET 5 и DNX](https://code.visualstudio.com/Docs/ASPnet5#_installing-aspnet-5-and-dnx).

1. Чтобы установить диспетчер версий .NET (DNVM) в Windows, выполните в командной строке следующую команду:

		@powershell -NoProfile -ExecutionPolicy unrestricted -Command "&{$Branch='dev';iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/aspnet/Home/dev/dnvminstall.ps1'))}"

	Она скачает сценарий DNVM и поместит его в каталог профиля пользователя.

2. Перезапустите Windows, чтобы завершить установку DNVM.

3. Чтобы проверить расположение DNVM, откройте командную строку и введите эту команду:

		where dnvm

	В командной строке будет отображаться путь, подобный этому:

	![dnvm location](./media/web-sites-create-web-app-using-vscode/00-where-dnvm.png)

4. Теперь, установив DNVM, необходимо с его помощью скачать DNX для запуска приложений. Выполните в командной строке эту команду:

		dnvm upgrade

5. Проверьте установку DNVM и активную среду выполнения. Для этого введите в командной строке эту команду:

		dnvm list

	В командной строке будет показана подробная информация об активной среде выполнения.

	![Расположение DNVM](./media/web-sites-create-web-app-using-vscode/00b-dnvm-list.png)

6. Если указано несколько сред выполнения DNX, то нужно выбрать активную среду выполнения DNX той версии, которую использует генератор ASP.NET 5 при создании веб-приложения далее в этом учебнике. Для этого введите в командной строке следующее. *Если используется последняя доступная среда выполнения, ее изменение может не потребоваться.*

		dnvm use 1.0.0-beta4 –p

> [AZURE.NOTE]Более подробные указания по установке для OS X, Linux и Windows см. в разделе [Установка ASP.NET 5 и DNX](https://code.visualstudio.com/Docs/ASPnet5#_installing-aspnet-5-and-dnx).

## Создание веб-приложения 

В этом разделе показано, как сформировать шаблон нового веб-приложения ASP.NET. Вы будете использовать диспетчер пакетов Node (NPM), чтобы установить [Yeoman](http://yeoman.io/) (инструмент формирования шаблонов приложений — эквивалент операции VSCode **Файл > Создать проект** в Visual Studio), [Grunt](http://gruntjs.com/) (инструмент выполнения задач JavaScript) и [Bower](http://bower.io/) (диспетчер пакетов клиента).

1. Откройте командную строку с правами администратора и перейдите к папке, в которой нужно создать проект ASP.NET. Например, создайте каталог *vscodeprojects* в корне диска C:.

2. Введите следующую команду в командной строке, чтобы установить Yeoman и вспомогательные инструменты:

		npm install -g yo grunt-cli generator-aspnet bower

3. Введите следующую команду в командной строке, чтобы создать папку проекта и сформировать шаблон приложения:

		yo aspnet

4. Используйте клавиши со стрелками, чтобы выбрать тип **Веб-приложение** в меню генератора ASP.NET 5, и нажмите клавишу **&lt;ВВОД>**.

	![Yeoman — генератор ASP.NET 5](./media/web-sites-create-web-app-using-vscode/01-yo-aspnet.png)

5. Задайте для нового веб-приложения ASP.NET имя **SampleWebApp**. Оно используется в учебнике, поэтому если выбрать другое имя, то потребуется использовать его вместо каждого вхождения **SampleWebApp**. После того как вы нажмете клавишу **&lt;ВВОД>**, Yeoman создаст папку с именем **SampleWebApp** и файлы, необходимые для нового приложения.

6. Откройте VSCode, введя следующее в окне командной строки.

		code .

7. В VSCode щелкните **Файл > Открыть папку** и выберите папку, содержащую веб-приложение ASP.NET.

	![Диалоговое окно «Выбор папки»](./media/web-sites-create-web-app-using-vscode/02-open-folder.png)

	VSCode загрузит проект и отобразит его в окне **Произвольное тестирование**.

	![Отображение проекта SampleWebApp в VSCode](./media/web-sites-create-web-app-using-vscode/03-vscode-project.png)

8. Щелкните **Представление > Палитра команд**.

9. В **палитре команд** введите следующие команды:

		dnx:dnu restore - (SampleWebApp)

	Начав ввод, вы увидите полную командную строку в списке.

	![Команда Restore](./media/web-sites-create-web-app-using-vscode/04-dnu-restore.png)

	Команда Restore устанавливает пакеты NuGet, необходимые для запуска приложения. По завершении в командном окне отобразится сообщение **Восстановление завершено**.

## Локальный запуск веб-приложения

Теперь, когда веб-приложение создано и для него получены все пакеты NuGet, можно запустить его локально.

1. В VSCode в **палитре команд** введите следующую команду, чтобы запустить приложение локально:

		dnx: kestrel - (SampleWebApp, Microsoft.AspNet.Hosting --server Microsoft.AspNet.Server.Kestrel --config hosting.ini)

	В командном окне отобразится состояние *Запущено*. Если в командной строке не отображается состояние *Запущено*, в нижнем левом углу VSCode проверьте наличие ошибок в проекте.
	
	> [AZURE.NOTE]Для запуска команд из **палитры команды** необходим символ **>** в начале командной строки. Также можно просмотреть подробные сведения о команде kestrel в файле *project.json*.

2. Откройте браузер и перейдите по следующему URL-адресу:

	****http://localhost:5000**

	> [AZURE.NOTE]Команда kestrel, указанная в файле *project.json*, указывает на файл со сведениями о размещении (*hosting.ini*), в котором указано расположение локального приложения. В данном случае приложение доступно с помощью URL-адреса, указанного выше.

	Страница веб-приложения по умолчанию будет выглядеть так.

	![Веб-приложение, запущенное локально в браузере](./media/web-sites-create-web-app-using-vscode/08-web-app.png)

3. Закройте браузер. Нажмите **Ctrl + C** в командной строке, чтобы завершить работу приложения, или закройте окно командной строки.

## Создание веб-приложения на портале предварительной версии Azure

Ниже описаны шаги, которые помогут вам создать веб-приложение на портале предварительной версии Azure.

1. Выполните вход на [портал предварительной версии Azure](https://portal.azure.com).

2. Щелкните команду **СОЗДАТЬ** в верхнем левом углу портала.

3. Щелкните **Веб-приложения > Веб-приложение**.

	![Новое веб-приложение Azure](./media/web-sites-create-web-app-using-vscode/09-azure-newwebapp.png)

4. Введите значение в поле **Имя**, например **SampleWebAppDemo**. Обратите внимание, что имя должно быть уникальным. Это обязательное требование, которое будет проверено при вводе. Если вы введете другое значение, вам необходимо будет заменить на него все вхождения **SampleWebAppDemo**, приведенные в этом учебнике.

5. Выберите существующий план службы приложений в поле **План службы приложений** или создайте новый. При создании нового плана выберите ценовую категорию, расположение и другие параметры. Дополнительную информацию о планах службы приложений см. в статье [Подробный обзор планов службы приложений Azure](../app-service/azure-web-sites-web-hosting-plans-in-depth-overview.md).

	![Колонка нового веб-приложения Azure](./media/web-sites-create-web-app-using-vscode/10-azure-newappblade.png)

6. Щелкните **Создать**.

	![Колонка веб-приложения](./media/web-sites-create-web-app-using-vscode/11-azure-webappblade.png)

## Включение публикации Git для нового веб-приложения

Git — это распределенная система управления версиями, которую можно использовать для развертывания веб-приложения службы приложений Azure. Код, созданный для веб-приложения, будет храниться в локальном репозитории Git, а для развертывания кода в Azure он будет передаваться в удаленный репозиторий.

1. Войдите на [портал предварительной версии Azure](https://portal.azure.com).

2. Щелкните **Обзор**.

3. Щелкните **Веб-приложения**, чтобы просмотреть список веб-приложений, связанных с подпиской Azure.

4. Выберите веб-приложение, созданное в этом учебнике.

5. В колонке веб-приложения перейдите к разделу **Развертывание** и щелкните пункт **Настройка непрерывного развертывания**.

	![Хост веб-приложений Azure](./media/web-sites-create-web-app-using-vscode/14-azure-deployment.png)

6. Щелкните **Выбор источника > Локальный репозиторий Git**.

7. Нажмите кнопку **ОК**.

	![Локальный репозиторий Git для Azure](./media/web-sites-create-web-app-using-vscode/15-azure-localrepository.png)

8. Если ранее вы не настроили учетные данные развертывания для публикации веб-приложения или другого приложения службы приложений, сделайте это сейчас, как показано ниже.

	* Щелкните **Настройки** > **Учетные данные развертывания**. Появится колонка **Учетные данные развертывания**.

	* Укажите имя пользователя и пароль. Этот пароль потребуется позднее при настройке Git.

	* Щелкните **Сохранить**.

9. В колонке веб-приложения щелкните **Параметры > Свойства**. В разделе **URL-адрес GIT** отображается URL-адрес удаленного репозитория Git, в который выполняется развертывание.

10. Скопируйте значение из поля **URL-АДРЕС GIT** для последующего использования в этом учебнике.

	![URL-адрес Git для Azure](./media/web-sites-create-web-app-using-vscode/17-azure-giturl.png)

## Публикация веб-приложения в службе приложений Azure

В этом разделе вы создадите локальный репозиторий Git и выполните принудительную отправку содержимого из него в Azure, чтобы развернуть веб-приложение в Azure.

1. В VSCode выберите параметр **Git** на панели навигации слева.

	![Значок Git в VSCode](./media/web-sites-create-web-app-using-vscode/git-icon.png)

2. В VSCode выберите **Инициализировать репозиторий Git**, чтобы задействовать управление версиями Git в рабочей области.

	![Инициализация Git](./media/web-sites-create-web-app-using-vscode/19-initgit.png)

3. Откройте командную строку и перейдите в каталог, в котором размещено веб-приложение. Затем введите следующую команду:

		git config core.autocrlf false

	Эта команда предотвращает проблемы, связанные с символами конца строк CRLF и LF.

4. В VS Code добавьте сообщение о фиксации и щелкните значок флажка **Фиксировать все**.

	![«Фиксировать все» в Git](./media/web-sites-create-web-app-using-vscode/20-git-commit.png)

5. После завершения обработки Git вы увидите, что в окне Git в разделе **Изменения** отсутствуют файлы.

	![Git без изменений](./media/web-sites-create-web-app-using-vscode/no-changes.png)

6. Вернитесь обратно в окно командной строки, в котором открыт каталог веб-приложения.

7. Создайте внешнюю ссылку для отправки обновлений в веб-приложение, используя URL-адрес Git (заканчивающийся на «.git»), скопированный ранее.

		git remote add azure [URL for remote repository]

8. Выберите в настройках Git вариант локального хранения учетных данных. Благодаря этому эти данные будут автоматически добавляться в ваши команды отправки, созданные с помощью VS Code.

		git config credential.helper store

9. Отправьте обновления в Azure с помощью следующей команды. После этой начальной отправки в Azure вы сможете выполнить все команды отправки из VS Code.

		git push -u azure master

	Появится запрос на ввод пароля, который вы создали ранее в Azure. **Примечание. Ваш пароль не будет отображаться.**

	Вывод этой команды завершается сообщением об успешном развертывании.

		remote: Deployment successful.
		To https://user@testsite.scm.azurewebsites.net/testsite.git
		[new branch]      master -> master

> [AZURE.NOTE]При внесении изменений в приложение можно выполнить повторную публикацию непосредственно в VS Code с помощью встроенных функций Git. Для этого выберите элемент **Фиксировать все**, а затем — **Отправить**. Команда **Отправить** находится в раскрывающемся меню рядом с кнопками **Фиксировать все** и **Обновить**.

При совместной работе над проектом рассмотрите возможность отправки изменений в GitHub до отправки в Azure.

## Запуск приложения в Azure
Теперь, когда веб-приложение развернуто, запустим его в Azure.

Это можно сделать двумя способами:

* Откройте браузер и введите имя веб-приложения в следующем формате.   

		http://SampleWebAppDemo.azurewebsites.net
 
* На портале предварительной версии Azure перейдите к колонке веб-приложения и щелкните **Обзор** для просмотра приложения
* в браузере по умолчанию.

![Веб-приложение Azure](./media/web-sites-create-web-app-using-vscode/21-azurewebapp.png)

## Сводка
В этом учебнике вы узнали, как создавать веб-приложение в VSCode и развертывать его в Azure. Дополнительную информацию о VSCode см. в разделе [Зачем использовать Visual Studio Code?](https://code.visualstudio.com/Docs/). Дополнительную информацию о веб-приложениях службы приложений Azure см. в статье [Обзор веб-приложений](app-service-web-overview.md).

<!---HONumber=Oct15_HO3-->