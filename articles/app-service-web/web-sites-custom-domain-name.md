.<properties
	pageTitle="Сопоставление имени личного домена с приложением Azure"
	description="Сведения о сопоставлении имени личного домена с приложением в службе приложение Azure."
	services="app-service"
	documentationCenter=""
	authors="cephalin"
	manager="wpickett"
	editor="jimbe"
	tags="top-support-issue"/>

<tags
	ms.service="app-service"
	ms.workload="na"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/27/2016"
	ms.author="cephalin"/>

# Сопоставление имени личного домена с приложением Azure

[AZURE.INCLUDE [web-selector](../../includes/websites-custom-domain-selector.md)]

В этой статье показано, как вручную сопоставить имя личного домена с веб-приложением, серверной частью мобильного приложения и приложением API в [службе приложений Azure](../app-service/app-service-value-prop-what-is.md).

При создании приложению назначается уникальный поддомен azurewebsites.net. Например, если приложение называется **contoso**, то оно его доменным именем будет **contoso.azurewebsites.net**. Тем не менее вы можете сопоставить имя личного домена с приложением, чтобы URL-адрес, например `www.contoso.com`, представлял имя вашей компании.

>[AZURE.NOTE] Обратитесь за помощью к экспертам на [форумах Azure](https://azure.microsoft.com/support/forums/). Чтобы получить более квалифицированную помощь, перейдите на [сайт поддержки Azure](https://azure.microsoft.com/support/options/) и щелкните **Получить поддержку**.

[AZURE.INCLUDE [нижний колонтитул](../../includes/custom-dns-web-site-intro-notes.md)]

## Приобретение имени личного домена на портале Azure

Если вы еще не приобрели имя личного домена, его можно приобрести на [портале Azure](https://portal.azure.com) и там же управлять им непосредственно в параметрах приложения. Таким образом проще сопоставить личный домен с приложением, независимо от того, использует ли приложение [диспетчер трафика Azure](web-sites-traffic-manager-custom-domain-name.md).

Инструкции см. в статье [Приобретение и настройка личного домена для службы приложений Azure](custom-dns-web-site-buydomains-web-app.md).

## Сопоставление личного домена, приобретенного не на портале Azure

Если вы приобрели личный домен в службе [Azure DNS](https://azure.microsoft.com/services/dns/) или у стороннего поставщика, для его сопоставления с приложением необходимо выполнить три основных шага:

1. [Получить IP-адрес приложения *(только для записи A)*](#vip).
2. [Создать записи DNS, которые сопоставляют домен с приложением](#createdns).
    - **Где**: в средстве управления регистратора домена (например, Azure DNS, GoDaddy и т. д.).
    - **Почему**: чтобы ваш регистратор доменных имен сопоставлял нужный личный домен с приложением Azure.
1. [Включить имя личного домена для приложения Azure](#enable).
    - **Где**: на [портале Azure](https://portal.azure.com).
    - **Почему**: чтобы приложение отвечало на запросы к имени личного домена.
3. [Проверить распространение DNS](#verify).

### Типы доменов, которые можно сопоставить

Служба приложений Azure позволяет сопоставить с приложением личные домены следующих типов:

- **Корневой домен** — имя домена, зарезервированное с помощью регистратора доменных имен (как правило, представлен записью узла `@`). Например, **contoso.com**.
- **Поддомен** — любой домен, который относится к вашему корневому домену. Например, **www.contoso.com** (представлен записью узла `www`). Разные поддомены одного корневого домена можно сопоставить с разными приложениями в Azure.
- **Домен с подстановочным знаком** — [любой поддомен, в имени которого в качестве крайней левой DNS-метки используется знак `*`](https://en.wikipedia.org/wiki/Wildcard_DNS_record) (например, записи узла `*` и `*.blogs`). Например, ***.contoso.com**.

### Типы записей DNS, которые можно использовать

В зависимости от потребностей для сопоставления личного домена можно использовать стандартные записи DNS двух типов:

- [A](https://en.wikipedia.org/wiki/List_of_DNS_record_types#A) — сопоставляет имя личного домена непосредственно с виртуальным IP-адресом приложения Azure.
- [CNAME](https://en.wikipedia.org/wiki/CNAME_record) — сопоставляет имя личного домена с доменным именем Azure, например **&lt;*имя\_приложения*>.azurewebsites.net**.

Преимущество записи CNAME заключается в том, что она сохраняется при изменении IP-адреса. Виртуальный IP-адрес может измениться при удалении и повторном создании приложения или переходе с более высокой ценовой категории на уровень **Общий**. В случае такого изменения запись CNAME останется действительной, а запись А потребует обновления.

В этом руководстве описана процедура использования как записи A, так и записи CNAME.

>[AZURE.IMPORTANT] Не создавайте запись CNAME для корневого домена (т. е. "корневую запись"). Дополнительные сведения см. в статье [Why can't a CNAME record be used at the root domain](http://serverfault.com/questions/613829/why-cant-a-cname-record-be-used-at-the-apex-aka-root-of-a-domain) (Использование записи CNAME для корневого домена). Чтобы сопоставить корневой домен с приложением Azure, используйте запись А.

<a name="vip"></a>
## Шаг 1. Получение IP-адреса приложения *(только для записи A)*
Чтобы сопоставить имя личного домена с помощью записи A, требуется IP-адрес приложения Azure. Если для сопоставления будет использоваться запись CNAME, пропустите этот шаг и перейдите к следующему разделу.

1.	Войдите на [портал Azure](https://portal.azure.com).

2.	В меню слева щелкните **Службы приложений**.

4.	Выберите приложение и щелкните **Параметры** > **Личные домены и SSL** > **Предоставить внешние домены**.

6.  Запишите IP-адрес.

    .![Сопоставление имени личного домена с помощью записи А: получение IP-адреса для приложения службы приложений Azure](./media/web-sites-custom-domain-name/virtual-ip-address.png)

7.  Не закрывайте эту колонку портала. Вы вернитесь к ней после создания записей DNS.

<a name="createdns"></a>
## Шаг 2. Создание записей DNS

Войдите в систему вашего регистратора доменных имен и воспользуйтесь его средством добавления записи A или записи CNAME. Пользовательские интерфейсы разных регистраторов несколько отличаются, поэтому следует просмотреть документацию своего поставщика. Ниже приведены некоторые общие рекомендации.

1.	Найдите страницу управления записями DNS. Найдите ссылки или области сайта, обозначенные как **Имя домена**, **DNS** или **Управление сервером доменных имен**. Часто ссылку можно найти, открыв сведения о своей учетной записи и найдя такую ссылку, как **Мои домены**.
2.	Поищите ссылку, которая позволяет добавлять или изменять записи DNS. Это может быть ссылка **Файл зоны**, **Записи DNS** или **Дополнительно**.
3.  Создайте запись и сохраните изменения.
    - Инструкции по использованию записи A см. [здесь](#a).
    - Инструкции по использованию записи CNAME см. [здесь](#cname).

<a name="a"></a>
### Создание записи A

Чтобы выполнять сопоставление с IP-адресом приложения Azure по записи A, необходимо создать и запись A, и запись CNAME. Запись A нужна для разрешения DNS, а запись CNAME — для проверки того, что вы являетесь владельцем имени личного домена, осуществляемой в Azure.

Настройте запись A следующим образом (@ обычно представляет корневой домен).
 
<table cellspacing="0" border="1">
  <tr>
    <th>Пример полного доменного имени</th>
    <th>Узел для записи A</th>
    <th>Значение для записи A</th>
  </tr>
  <tr>
    <td>contoso.com (корневой домен)</td>
    <td>@</td>
    <td>IP-адрес, записанный на <a href="#vip">шаге 1</a></td>
  </tr>
  <tr>
    <td>www.contoso.com (поддомен)</td>
    <td>www</td>
    <td>IP-адрес, записанный на <a href="#vip">шаге 1</a></td>
  </tr>
  <tr>
    <td>*.contoso.com (с подстановочным знаком)</td>
    <td>*</td>
    <td>IP-адрес, записанный на <a href="#vip">шаге 1</a></td>
  </tr>
</table>

Дополнительная запись CNAME использует соглашение, в соответствии с которым awverify.&lt;*поддомен*>.&lt;*корневой\_домен*> сопоставляется с awverify.&lt;*поддомен*>.azurewebsites.net. Настройте запись CNAME следующим образом.

<table cellspacing="0" border="1">
  <tr>
    <th>Пример полного доменного имени</th>
    <th>Узел записи CNAME</th>
    <th>Значение записи CNAME</th>
  </tr>
  <tr>
    <td>contoso.com (корневой домен)</td>
    <td>awverify</td>
    <td>awverify.&lt;<i>имя_приложения</i>>.azurewebsites.net</td>
  </tr>
  <tr>
    <td>www.contoso.com (поддомен)</td>
    <td>awverify.www</td>
    <td>awverify.&lt;<i>имя_приложения</i>>.azurewebsites.net</td>
  </tr>
  <tr>
    <td>*.contoso.com (с подстановочным знаком)</td>
    <td>awverify</td>
    <td>awverify.&lt;<i>имя_приложения</i>>.azurewebsites.net</td>
  </tr>
</table>

<a name="cname"></a>
### Создание записи CNAME

Если вы используете запись CNAME для сопоставления с именем домена по умолчанию приложения Azure, не нужно создавать дополнительную запись CNAME, как при использовании записи A.

>[AZURE.IMPORTANT] Не создавайте запись CNAME для корневого домена (т. е. "корневую запись"). Дополнительные сведения см. в статье [Why can't a CNAME record be used at the root domain](http://serverfault.com/questions/613829/why-cant-a-cname-record-be-used-at-the-apex-aka-root-of-a-domain) (Использование записи CNAME для корневого домена). Чтобы сопоставить корневой домен с приложением Azure, используйте [запись А](#a).

Настройте запись CNAME следующим образом (@ обычно представляет корневой домен).

<table cellspacing="0" border="1">
  <tr>
    <th>Пример полного доменного имени</th>
    <th>Узел записи CNAME</th>
    <th>Значение записи CNAME</th>
  </tr>
  <tr>
    <td>www.contoso.com (поддомен)</td>
    <td>www</td>
    <td>&lt;<i>имя_приложения</i>>.azurewebsites.net</td>
  </tr>
  <tr>
    <td>*.contoso.com (с подстановочным знаком)</td>
    <td>*</td>
    <td>&lt;<i>имя_приложения</i>>.azurewebsites.net</td>
  </tr>
</table>

<a name="enable"></a>
## Шаг 3. Включение имени личного домена для приложения

В колонке **Предоставить внешние домены** на портале Azure (см. [шаг 1](#vip)) необходимо добавить в список полное доменное имя личного домена.

1.	Перейдите на [портал Azure](https://portal.azure.com), если вы еще этого не сделали.

2.	На портале Azure в меню слева щелкните **Службы приложений**.

4.	Выберите приложение и щелкните **Параметры** > **Личные домены и SSL** > **Предоставить внешние домены**.

2.	Добавьте в список полное доменное имя личного домена (например, **www.contoso.com**).

    ![Сопоставление имени личного домена с приложением Azure: добавление в список имен доменов](./media/web-sites-custom-domain-name/add-custom-domain.png)

    >[AZURE.NOTE] Azure попытается проверить доменное имя, указанное здесь. Убедитесь, что это доменное имя, для которого вы создали запись DNS на [шаге 2](#createdns).

6.  Щелкните **Сохранить**.

7.  Когда Azure завершит настройку нового имени личного домена, перейдите по нему в браузере. В браузере откроется приложение Azure. Это означает, что пользовательское имя домена настроено правильно.

<a name="verify"></a>
## Проверка распространения DNS

После завершения настройки в зависимости от поставщика DNS распространение изменений может занять некоторое время. Чтобы проверить, что распространение DNS выполняется соответствующим образом, перейдите по ссылке [http://digwebinterface.com/](http://digwebinterface.com/). Перейдя на веб-сайт, в соответствующем текстовом поле введите имена узлов и щелкните **Получить подробную информацию**. Просмотрите результаты, чтобы убедиться, что последние изменения вступили в силу.

![Сопоставление имени личного домена с приложением Azure: проверка распространения DNS](./media/web-sites-custom-domain-name/1-digwebinterface.png)

> [AZURE.NOTE] Распространение записей DNS может занимать до 48 часов (иногда больше). Даже если настройка выполнена правильно, все равно нужно дождаться успешного выполнения распространения.

## Дальнейшие действия
Узнайте, как защитить имя личного домена с помощью протокола HTTPS, [приобретя SSL-сертификат в Azure](web-sites-purchase-ssl-web-site.md) или [используя SSL-сертификат из другого источника](web-sites-configure-ssl-certificate.md).

>[AZURE.NOTE] Чтобы приступить к работе со службой приложений Azure до создания учетной записи Azure, перейдите к разделу [Пробное использование службы приложений](http://go.microsoft.com/fwlink/?LinkId=523751), где вы можете быстро создать кратковременное веб-приложение начального уровня в службе приложений. Никаких кредитных карт и обязательств.

[Создание зоны DNS с помощью PowerShell](../dns/dns-getstarted-create-dnszone.md) [Создание записей DNS для веб-приложения в пользовательском домене](../dns/dns-web-sites-custom-domain.md) [Делегирование домена в Azure DNS](../dns/dns-domain-delegation.md)


<!-- Images -->
[subdomain]: media/web-sites-custom-domain-name/azurewebsites-subdomain.png

<!---HONumber=AcomDC_0817_2016-->