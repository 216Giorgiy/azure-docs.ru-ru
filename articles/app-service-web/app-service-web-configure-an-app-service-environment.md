<properties 
	pageTitle="Настройка среды службы приложений" 
	description="Настройка и мониторинг среды службы приложений, а также управление ею" 
	services="app-service" 
	documentationCenter="" 
	authors="ccompy" 
	manager="stefsch" 
	editor=""/>

<tags 
	ms.service="app-service" 
	ms.workload="na" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="09/11/2015" 
	ms.author="ccompy"/>

# Настройка среды службы приложений #

## Обзор ##

Среды службы приложений — новая функциональная возможность уровня Премиум службы приложений Azure, которая предоставляет новые возможности масштабирования и доступа к сети. Эта новая возможность масштабирования позволяет разместить экземпляр службы приложений Azure в виртуальной сети. Если вы не знакомы со средой службы приложений, см. статью [Знакомство со средой службы приложений](app-service-app-service-environment-intro.md). Сведения о том, как создать такую среду, см. в статье [Создание среды службы приложений](app-service-web-how-to-create-an-app-service-environment.md).

На высоком уровне среда службы приложений состоит из нескольких основных компонентов:

- вычислительные ресурсы, работающие в размещенной службе среды приложений Azure;
- Хранилище
- База данных
- Классическая виртуальная сеть v1, включающая по крайней мере одну подсеть;
- подсеть, в которой работает размещенная служба среды приложений Azure.

Для управления средами службы приложений и их мониторинга вы можете воспользоваться соответствующим пользовательским интерфейсом. Для этого на портале предварительной версии Azure выберите "Обзор -> Среды службы приложений". В первом выпуске не будет всех функций, которые нужны для управления системой. Улучшения для него будут выходить следующие несколько недель.

![][1]

[AZURE.INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## Мониторинг ##

В первоначальной версии предварительного просмотра недоступны многие возможности метрики, но они будут выпущены в скором времени. Эти возможности метрики позволят администраторам принимать решения по поводу операций и масштабирования системы.

Даже теперь на портале вы можете указать все планы службы приложений и все веб-приложения, находящиеся в среде службы приложений. Для просмотра любого из этих списков перейдите к разделу "Параметры" и выберите элемент, который вас интересует.

![][3]

В обоих списках отображено задание пула работников, количество экземпляров и объем используемых вычислительных ресурсов. Сведения о производительности, касающиеся какого-либо плана службы приложений, будут доступны так, как обычно, то есть в пользовательском интерфейсе плана службы приложений.

![][4]

## Вычислительные ресурсы ##

Вычислительными ресурсами, хранилищем и базой данных управляет служба приложений Azure. С другой стороны, количество и объем вычислительных ресурсов задает пользователь.

Независимо от объема вычислительных ресурсов минимальная конфигурация должна иметь два внешних сервера и два работника. Среду службы приложений можно настроить для использования до 55 вычислительных ресурсов. Из этих 55 вычислительных ресурсов только 50 можно использовать для размещения рабочих нагрузок. Для этого есть две причины. Существует как минимум 2 вычислительных ресурса для интерфейсов. Остается максимум 53 ресурса для поддержки распределения пула работников. Но для обеспечения отказоустойчивости необходимо иметь дополнительные вычислительные ресурсы, распределенные по таким правилам:

- для каждого пула работников требуется по крайней мере один дополнительный вычислительный ресурс, которому нельзя назначать рабочую нагрузку;
- если количество вычислительных ресурсов в пуле превышает определенное значение, требуется другой вычислительный ресурс.

Согласно требованиям к отказоустойчивости любого пула работников данное значение X ресурсов назначается пулу работников при таких условиях:

- если переменная X — это число от 2 до 20, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-1;
- если переменная X — это число от 21 до 40, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-2;
- если переменная X — это число от 41 до 53, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-3.

Вы можете не только управлять количеством вычислительных ресурсов, которые можно назначить данному пулу, но и контролировать размер вычислительного ресурса. Для сред службы приложений можно выбрать четыре разных размера с метками от P1 до P4. Сведения о размерах и их стоимости см. в статье [Цены службы приложений](../app-service/app-service-value-prop-what-is.md). Размеры с P1 по P3 — это те же размеры, что обычно доступны. Вычислительный ресурс размера P4 состоит из 8 ядер с 14 ГБ ОЗУ и доступен только в среде службы приложений.

Как отмечалось ранее, сейчас доступна только предварительная версия среды службы приложений и в ней есть что улучшать. По мере того как среда службы приложений будет приближаться к состоянию общей доступности, кроме дополнительных возможностей мониторинга будут появляться новые функции управления. Пока что в имеющемся интерфейсе вы можете управлять лишь несколькими аспектами работы:

- количеством вычислительных ресурсов в каждом пуле;
- объемом вычислительных ресурсов в каждом пуле;
- количеством доступных IP-адресов.

Для управления этими аспектами выберите элемент конфигурации "Масштаб" вверху.

![][2]

Здесь вы можете изменить количество и объем вычислительных ресурсов в каждом пуле. Однако перед внесением изменений нужно учесть некоторые моменты.

- Чтобы внести изменение, может понадобиться, в зависимости от его размера, несколько часов.
- Когда вы изменяете конфигурацию среды службы приложений, нельзя запустить второе изменение.
- Если изменить объем вычислительных ресурсов, используемых в пуле работников, это может привести к простою веб-приложений, запущенных в этом пуле.

Добавление экземпляров в пул работников не представляет опасности и не влияет на систему. А вот изменение объема вычислительных ресурсов — это совсем другая история. Чтобы, изменяя объем пула работников, избежать простоя приложений, вот что нужно сделать:

- вызовите экземпляры, нужные для достижения требуемого размера, с помощью неиспользуемого пула работников;
- измените масштаб планов службы приложений для работы с новым пулом работников.  
 
Работе запущенных приложений это помешает значительно меньше, чем изменение объема вычислительных ресурсов при активных рабочих нагрузках. Сведения о масштабировании веб-приложений в среде службы приложений см. в статье [Масштабирование веб-приложений в среде службы приложений](app-service-web-scale-a-web-app-in-an-app-service-environment.md).

## Виртуальная сеть ##

[Виртуальной сетью][virtualnetwork] и подсетью управляет пользователь. Среда службы приложений имеет некоторые требования сети, но все остальное — в руках пользователя. Вот какие требования имеет среда службы приложений:

- классическая виртуальная сеть v1, включающая по крайней мере 512 адресов;
- подсеть, включающая по крайней мере 8 адресов; 
- виртуальная сеть должна быть региональной.  
 
Администрирование виртуальной сети выполняется через стандартный пользовательский интерфейс виртуальной сети.

Так как эта возможность помещает службу приложений Azure в виртуальную сеть, это значит, что ваши приложения, размещенные в ASE, могут теперь получать доступ к ресурсам, теперь доступны ресурсы через ExpressRoute или напрямую через VPN типа "сеть-сеть". Чтобы использовать ресурсы, доступные в сети, в которой размещена среда службы приложений, приложениям этой среды не нужны дополнительные сетевые компоненты.

Если необходимо, сейчас вы можете управлять доступом с помощью групп сетевой безопасности. Эта возможность позволяет настроить среду службы приложений так, чтобы в ней использовались только нужные вам IP-адреса. Дополнительные сведения о том, как это сделать, см. в статье [Управление входящим трафиком в среде службы приложений](app-service-app-service-environment-control-inbound-traffic.md).

## Удаление среды службы приложений ##

Если вы хотите удалить среду службы приложений, просто воспользуйтесь действием удаления в верхней части колонки среды. При этом помните, что нельзя удалить эту среду, если в ней есть содержимое. Чтобы удалить среду службы приложений, обязательно удалите все веб-приложения и планы службы приложений.

## Приступая к работе

Чтобы начать работу со средами службы приложений, см. статью [Создание среды службы приложений](app-service-web-how-to-create-an-app-service-environment.md).

Дополнительные сведения о платформе службы приложений Azure см. в статье [Служба приложений Azure](../app-service/app-service-value-prop-what-is.md).

[AZURE.INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[AZURE.INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!--Image references-->
[1]: ./media/app-service-web-configure-an-app-service-environment/configureaseblade.png
[2]: ./media/app-service-web-configure-an-app-service-environment/configurescale.png
[3]: ./media/app-service-web-configure-an-app-service-environment/configureasplist.png
[4]: ./media/app-service-web-configure-an-app-service-environment/configurewebapplist.png

<!--Links-->
[WhatisASE]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[Appserviceplans]: http://azure.microsoft.com/documentation/articles/azure-web-sites-web-hosting-plans-in-depth-overview/
[HowtoCreateASE]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[HowtoScale]: http://azure.microsoft.com/documentation/articles/app-service-web-scale-a-web-app-in-an-app-service-environment/
[ControlInbound]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[AppServicePricing]: http://azure.microsoft.com/pricing/details/app-service/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
 

<!---HONumber=Oct15_HO2-->