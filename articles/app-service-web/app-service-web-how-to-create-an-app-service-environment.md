<properties 
	pageTitle="Создание среды службы приложения" 
	description="Описание процесса создания сред службы приложений" 
	services="app-service\web" 
	documentationCenter="" 
	authors="ccompy" 
	manager="stefsch" 
	editor=""/>

<tags 
	ms.service="app-service" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="get-started-article" 
	ms.date="09/11/2015" 
	ms.author="ccompy"/>

# Создание среды службы приложения #

Среды служб приложения (ASE) — это расширенный параметр службы приложений Azure, который на данный момент доступен в предварительной версии. Он обеспечивает возможность расширенной настройки, которая недоступна в многоклиентских штампах. Чтобы узнать больше о возможностях, доступных в средах службы приложений, см. документацию [Возможности среды службы приложений][WhatisASE].

[AZURE.INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

### Обзор ###

Функция ASE фактически развертывает службу приложений Azure в виртуальной сети клиента. Для этого клиенту понадобятся:

- Классическая региональная виртуальная сеть v1, включающая по крайней мере 512 (/23) адресов
- Подсеть, включающая по крайней мере 8 (/29) адресов
- Подсеть **не должна содержать какие-либо другие вычислительные ресурсы**. В подсети можно развернуть только одну среду службы приложений. Если в подсети существуют другие вычислительные ресурсы, попытка создания завершится ошибкой.

Если у вас нет виртуальной сети для размещения среды службы приложений, вы можете создать ее во время создания среды службы приложений.

Каждое развертывание ASE является размещенной службой, которая управляется и обслуживается платформой Azure. Вычислительные ресурсы, на которых размещены роли системы ASE, недоступны для клиента, хотя клиент регулирует количество экземпляров и их размер.

## Создание среды службы приложений ##

Вы можете получить доступ к пользовательскому интерфейсу создания ASE двумя способами. Чтобы найти его, выполните поиск в Azure Marketplace по запросу ***Среда службы приложений*** или откройте меню "Создать -> Интернет + мобильные устройства".

### Быстро создать ###
После входа в пользовательский интерфейс создания вы можете быстро создать ASE, для этого просто введите имя для развертывания. После этого будут созданы виртуальная сеть с 512 адресами, подсеть с 256 адресами в этой виртуальной сети и среда ASE с двумя внешними интерфейсами и двумя исполнителями в пуле исполнителей 1. Не забудьте выбрать расположение для размещения системы и подписку, в которой она должна находиться. В подписке, используемой для создания ASE, должны находиться только учетные записи, которые могут использовать ASE для размещения содержимого.

Имя, указанное для ASE, будет использоваться для веб-приложений, созданных в ASE. Если для ASE указано имя appsvcenvdemo, то доменным именем будет .*appsvcenvdemo.p.azurewebsites.net*. Если создать веб-приложение с именем mytestapp, к нему можно будет обращаться по адресу *mytestapp.appsvcenvdemo.p.azurewebsites.net*. В имени нельзя использовать пробелы. Если вы используете в имени символы верхнего регистра, в доменном имени будут использоваться такие же символы нижнего регистра.


![][1]

### Пулы вычислительных ресурсов ###

Управление вычислительными ресурсами, которые используются для среды службы приложений, выполняется в пулах вычислительных ресурсов. Эти пулы определяют конфигурацию экземпляров вычислительных ресурсов, а также их размер. Среда службы приложений состоит из внешних серверов и исполнителей. Внешние серверы обрабатывают нагрузку подключения приложения, а исполнители запускают код приложения. Управление внешними серверами выполняется из специального пула вычислительных ресурсов. Управление исполнителями в свою очередь выполняется из трех отдельных пулов вычислительных ресурсов с именами

- Пул исполнителей 1
- Пул исполнителей 2
- Пул исполнителей 3

Если для простых веб-приложений поступает большое количество запросов, вам, скорее всего, потребуется масштабировать внешние интерфейсы и уменьшить количество исполнителей. Если у вас есть веб-приложения, которые используют много ресурсов ЦП и памяти, вам не потребуется много внешних интерфейсов, но, скорее всего, потребуется больше исполнителей.

Независимо от объема вычислительных ресурсов минимальная конфигурация должна иметь два внешних сервера и два работника. Среду службы приложений можно настроить для использования до 55 вычислительных ресурсов. Из этих 55 вычислительных ресурсов только 50 можно использовать для размещения рабочих нагрузок. Для этого есть две причины. Существует как минимум 2 вычислительных ресурса для интерфейсов. Остается максимум 53 ресурса для поддержки распределения пула работников. Но для обеспечения отказоустойчивости необходимо иметь дополнительные вычислительные ресурсы, распределенные по таким правилам:

- для каждого пула работников требуется по крайней мере один дополнительный вычислительный ресурс, которому нельзя назначать рабочую нагрузку;
- если количество вычислительных ресурсов в пуле превышает определенное значение, требуется другой вычислительный ресурс.

Согласно требованиям к отказоустойчивости любого пула работников данное значение X ресурсов назначается пулу работников при таких условиях:

- если переменная X — это число от 2 до 20, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-1;
- если переменная X — это число от 21 до 40, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-2;
- если переменная X — это число от 41 до 53, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-3.

Вы можете не только управлять количеством вычислительных ресурсов, которые можно назначить данному пулу, но и контролировать размер вычислительного ресурса. Для сред службы приложений можно выбрать четыре разных размера с метками от P1 до P4. Информацию об этих размерах и их ценах см. в разделе [Ценовые категории службы приложений][AppServicePricing]. Размеры вычислительных ресурсов от P1 до P3 совпадают с размерами, доступными в многопользовательских средах. Вычислительный ресурс размера P4 состоит из 8 ядер с 14 ГБ ОЗУ и доступен только в среде службы приложений.

Цены сред службы приложений зависят от назначенных вычислительных ресурсов. Вы платите за вычислительные ресурсы, выделенные для вашей среды службы приложений независимо от того, размещены ли на них рабочие нагрузки.



### Создание виртуальной сети ###
Функция быстрого создания автоматически создает новую виртуальную сеть. Кроме того, этот компонент также поддерживает выбор существующей виртуальной сети и создание виртуальной сети вручную. Вы можете выбрать существующую виртуальную сеть (в настоящее время поддерживаются только классические виртуальные сети v1), если она имеет достаточный размер для поддержки развертывания среды службы приложений. Виртуальная сеть должна содержать как минимум 512 адресов. При выборе существующей виртуальной сети также необходимо указать подсеть или создать новую. Подсеть должна содержать по крайней мере 8 адресов.

Если вы используете пользовательский интерфейс для создания виртуальной сети необходимо указать следующие параметры.

- Имя виртуальной сети
- Диапазон адресов виртуальной сети в нотации CIDR
- Имя подсети
- Диапазон адресов подсети в нотации CIDR

Если вы не знакомы с нотацией CIDR, она имеет такую форму: 10.0.0.0/22, где /22 указывает диапазон. В этом примере /22 означает диапазон 1024 адресов или от 10.0.0.0 до 10.0.3.255. /23 означает 512 адреса и т. д.

![][2]

### Определение размера среды службы приложений ###

Теперь необходимо настроить масштаб системы. По умолчанию она состоит из двух внешних интерфейсов на вычислительных ресурсах P2, двух исполнителей P1 и одного IP-адреса. Два внешних интерфейса обеспечивают высокую доступность и распределение нагрузки. Минимальный размер для внешних интерфейсов — P2, этот размер обеспечивает их достаточной емкостью для поддержки небольшой системы. Если известно, что система должна поддерживать большое количество запросов, можно настроить количество внешних интерфейсов и размер сервера.

Как отмечалось ранее, в среде ASE есть 3 пула исполнителей, которые может определить клиент. Вычислительный ресурс может иметь размер от P1 до P4. По умолчанию в одном пуле исполнителей настроено только два исполнителя размера P1. Этого достаточно для поддержки одного плана службы приложений с одним экземпляром.

Ползунки регулируются автоматически и отображают общие вычислительные ресурсы, доступные в среде службы приложений. По мере того, как ползунки регулируются в одном из пулов, другие ползунки меняют положение, отображая доступное количество вычислительных ресурсов, оставшихся до достижения показателя 55.
 
![][3]

Для добавления новых экземпляров в доступные может потребоваться время. Если вам известно, что вам потребуются дополнительные вычислительные ресурсы, следует подготовить их заранее. Время подготовки может занять несколько часов в зависимости от того, сколько ресурсов добавляется в систему. Чтобы система соответствовала требованиям к отказоустойчивости, каждая среда ASE должна иметь резервный экземпляр в каждом пуле исполнителей.

По умолчанию среда ASE поставляется с одним IP-адресом, доступным для SSL IP-адреса. Если вы знаете, что вам понадобится больше адресов, вы можете указать это здесь или изменить эти настройки после создания.
  
### После создания среды службы приложений ###

После создания ASE можно настроить такие параметры:

- Количество внешних интерфейсов (минимальное: 2)
- Количество исполнителей (минимальное: 2)
- Количество IP-адресов
- Размеры вычислительных ресурсов, используемых внешними интерфейсами или исполнителями (минимальный размер для внешнего интерфейса — P2)

Нельзя изменить:

- Расположение
- Подписка
- Группа ресурсов
- Используемая виртуальная сеть
- Используемая подсеть

Дополнительную информацию об управлении средами служб управления и их мониторинге см. здесь: [Настройка среды служб приложений][ASEConfig]

Существуют дополнительные зависимости, которые невозможно настроить, такие как база данных и хранилище. Они обрабатываются платформой Azure и поставляются с системой. Хранилище системы поддерживает до 500 ГБ памяти для всей среды службы приложений.


## Приступая к работе

Чтобы начать работу со средами службы приложений, см. статью [Введение в среды службы приложений][WhatisASE]

Дополнительные сведения о платформе службы приложений Azure см. в статье [Служба приложений Azure][AzureAppService].

[AZURE.INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[AZURE.INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]
 

<!--Image references-->
[1]: ./media/app-service-web-how-to-create-an-app-service-environment/createaseblade.png
[2]: ./media/app-service-web-how-to-create-an-app-service-environment/createasenetwork.png
[3]: ./media/app-service-web-how-to-create-an-app-service-environment/createasescale.png

<!--Links-->
[WhatisASE]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[ASEConfig]: http://azure.microsoft.com/documentation/articles/app-service-web-configure-an-app-service-environment/
[AppServicePricing]: http://azure.microsoft.com/pricing/details/app-service/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/

<!---HONumber=Sept15_HO3-->