<properties 
	pageTitle="Создание среды службы приложения" 
	description="Описание процесса создания сред службы приложений" 
	services="app-service" 
	documentationCenter="" 
	authors="ccompy" 
	manager="stefsch" 
	editor=""/>

<tags 
	ms.service="app-service" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/14/2016" 
	ms.author="ccompy"/>

# Создание среды службы приложения #

Среды службы приложений (ASE) — возможность службы приложений Azure уровня Премиум, которая предоставляет возможность расширенной настройки, недоступную в многопользовательских метках. Функция ASE фактически развертывает службу приложений Azure в виртуальной сети клиента. Чтобы узнать больше о возможностях, доступных в средах службы приложений, см. документацию [Возможности среды службы приложений][WhatisASE].

### Обзор ###

При создании среды ASE пользователям нужно указать следующие сведения:

- имя среды ASE;
- подписка, которая будет использоваться для среды ASE;  
- resource group
- выбранная виртуальная сеть Azure (VNET) и подсеть;
- определение пула ресурсов ASE.

Есть важная информация о каждом из этих элементов.
- Имя ASE будет использоваться в поддомене для любых приложений, созданных в этой среде ASE.
- Все приложения, созданные в ASE, будут находиться в той же подписке, что и ASE.
- Если у вас нет доступа к подписке, использованной для создания ASE, вы не сможете использовать ASE для создания приложений.
- Виртуальные сети, используемые для размещения ASE, должны быть региональными классическими виртуальными сетями версии 1. 
- Подсеть, используемая для размещения ASE, не должна содержать какие-либо другие вычислительные ресурсы.
- В подсети может находиться только одна среда ASE.

Каждое развертывание ASE является размещенной службой, которая управляется и обслуживается платформой Azure. Вычислительные ресурсы, на которых размещены роли системы ASE, недоступны для клиента, хотя клиент регулирует количество экземпляров и их размер.

Вы можете получить доступ к пользовательскому интерфейсу создания ASE двумя способами. Чтобы найти его, выполните поиск в Azure Marketplace по запросу ***Среда службы приложений*** или откройте меню "Создать -> Интернет + мобильные устройства".

Чтобы у подсети и среды ASE были разные группы ресурсов, вам сначала нужно отдельно создать виртуальную сеть, а затем указать ее при создании ASE. Кроме того, чтобы создать подсеть в существующей виртуальной сети во время создания ASE, ASE должна входить в ту же группу ресурсов, что виртуальная сеть.

### Быстро создать ###
Вы можете быстро создать среду ASE с помощью набора значений по умолчанию. Чтобы быстро создать ASE, просто введите имя для развертывания. После этого в ближайшем к вам регионе будет создана среда ASE со следующими характеристиками:

- виртуальная сеть с 512 адресами; 
- подсеть с 256 адресами;
- интерфейсный пул с двумя вычислительными ресурсами P2;
- рабочий пул с двумя вычислительными ресурсами P1;
- один IP-адрес для использования SSL на основе IP.

Для интерфейсных пулов требуется вычислительный ресурс уровня P2 или выше. Внимательно выберите подписку, в которую будет включена среда ASE. В подписке, используемой для создания ASE, должны находиться только учетные записи, которые могут использовать ASE для размещения содержимого.

![][1]

Имя, указанное для ASE, будет использоваться для веб-приложений, созданных в этой среде ASE. Если для ASE указано имя appsvcenvdemo, доменным именем будет .*appsvcenvdemo.p.azurewebsites.net*. Если создать веб-приложение с именем *mytestapp*, к нему можно будет обращаться по адресу *mytestapp.appsvcenvdemo.p.azurewebsites.net*. В имени ASE нельзя использовать пробелы. Если вы используете в имени символы верхнего регистра, в доменном имени будут использоваться такие же символы нижнего регистра.

В некоторых ситуациях очень удобно использовать значения по умолчанию. Но бывают и другие ситуации, когда вам нужно что-то настроить вручную. В следующих разделах описана настройка всех необходимых параметров конфигурации ASE.

### Виртуальная сеть ###
Функция быстрого создания автоматически создает новую виртуальную сеть. Кроме того, этот компонент также поддерживает выбор существующей виртуальной сети и создание виртуальной сети вручную. Вы можете выбрать существующую виртуальную сеть (в настоящее время поддерживаются только классические виртуальные сети v1), если она имеет достаточный размер для поддержки развертывания среды службы приложений. Виртуальная сеть должна содержать минимум восемь адресов.

При выборе существующей виртуальной сети также необходимо указать подсеть или создать новую. Подсеть должна содержать не менее восьми адресов; также она не может включать другие ресурсы. Создание среды ASE завершится ошибкой при попытке использовать подсеть, которая уже содержит выделенные виртуальные машины.

Если вы используете пользовательский интерфейс для создания виртуальной сети необходимо указать следующие параметры.

- Имя виртуальной сети
- Диапазон адресов виртуальной сети в нотации CIDR
- Место проведения

Расположение виртуальной сети — это расположение среды ASE, так как ASE развертывается в этой виртуальной сети.

Указав нужную виртуальную сеть, создайте или выберите подсеть. Здесь необходимо указать следующие данные.
- Имя подсети
- Диапазон адресов подсети в нотации CIDR

Если вы не знакомы со схемой адресации CIDR (бесклассовой междоменной маршрутизации), просто запомните, что нотация выглядит как IP-адрес, разделенный косой чертой от значения CIDR, например *10.0.0.0/22*. CIDR-значение обозначает количество старших битов, определяющих маску для IP-адреса. Иными словами, значения CIDR обеспечивают диапазон IP-адресов. В этом примере адрес 10.0.0.0/22 означает диапазон, состоящий из 1024 адресов (от 10.0.0.0 до 10.0.3.255). /23 означает 512 адреса и т. д.

Также помните о том, что при создании подсети в существующей виртуальной сети ASE должна входить в ту же группу ресурсов, что и виртуальная сеть. Чтобы среда ASE и виртуальная сеть входили в разные группы ресурсов, перед созданием ASE нужно убедиться в том, что виртуальная сеть и подсеть разделены.

![][2]


### Пулы вычислительных ресурсов ###

Во время создания среды ASE можно задать требуемое для каждого пула ресурсов количество ресурсов, а также их размер. Задать размеры пулов ресурсов можно при создании среды ASE, а изменить их можно позже, используя функции ручного или автоматического масштабирования.

Как отмечалось ранее, среда ASE состоит из серверов переднего плана и рабочих ролей. Внешние серверы обрабатывают нагрузку подключения приложения, а исполнители запускают код приложения. Управление внешними серверами выполняется из специального пула вычислительных ресурсов. Управление исполнителями в свою очередь выполняется из трех отдельных пулов вычислительных ресурсов с именами

- Пул исполнителей 1
- Пул исполнителей 2
- Пул исполнителей 3

Если к простым веб-приложениям поступает большое количество запросов, вам, скорее всего, потребуется масштабировать внешние интерфейсы и уменьшить количество рабочих ролей. Если у вас есть веб-приложения, которые используют много ресурсов ЦП и памяти, вам не потребуется много внешних интерфейсов, но, скорее всего, потребуется больше исполнителей.

![][3]

Независимо от объема вычислительных ресурсов минимальная конфигурация должна иметь два внешних сервера и два работника. Среду ASE можно настроить для использования до 55 вычислительных ресурсов. Из этих 55 вычислительных ресурсов только 50 можно использовать для размещения рабочих нагрузок. Для этого есть две причины. Существует как минимум 2 вычислительных ресурса для интерфейсов. Остается максимум 53 ресурса для поддержки распределения пула работников. При этом для обеспечения отказоустойчивости требуются дополнительные вычислительные ресурсы, распределенные в соответствии с следующими правилами:

- для каждого пула работников требуется по крайней мере один дополнительный вычислительный ресурс, которому нельзя назначать рабочую нагрузку;
- если количество вычислительных ресурсов в пуле превышает определенное значение, требуется другой вычислительный ресурс.

Согласно требованиям к отказоустойчивости любого пула работников данное значение X ресурсов назначается пулу работников при таких условиях:

- если переменная X — это число от 2 до 20, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-1;
- если переменная X — это число от 21 до 40, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-2;
- если переменная X — это число от 41 до 53, количество доступных вычислительных ресурсов, которые можно использовать для рабочих нагрузок, равно X-3.

Вы можете не только управлять количеством вычислительных ресурсов, которые можно назначить данному пулу, но и контролировать размер вычислительного ресурса. Для сред службы приложений можно выбрать четыре разных размера с метками от P1 до P4. Информацию об этих размерах и их ценах см. в разделе [Ценовые категории службы приложений][AppServicePricing]. Размеры вычислительных ресурсов от P1 до P3 совпадают с размерами, доступными в многопользовательских средах. Вычислительный ресурс размера P4 состоит из 8 ядер с 14 ГБ ОЗУ и доступен только в среде службы приложений.

Цены сред службы приложений зависят от назначенных вычислительных ресурсов. Вы платите за вычислительные ресурсы, выделенные для вашей среды службы приложений независимо от того, размещены ли на них рабочие нагрузки.

По умолчанию среда ASE поставляется с одним IP-адресом, доступным для SSL IP-адреса. Если вы знаете, что вам понадобится больше адресов, вы можете указать это здесь или изменить эти настройки после создания.
  
### После создания среды службы приложений ###

После создания ASE можно настроить такие параметры:

- Количество внешних интерфейсов (минимальное: 2)
- Количество исполнителей (минимальное: 2)
- Количество IP-адресов, доступных для SSL на основе IP
- Размеры вычислительных ресурсов, используемых внешними интерфейсами или исполнителями (минимальный размер для внешнего интерфейса — P2)

Нельзя изменить:

- Расположение
- Подписка
- Группа ресурсов
- Используемая виртуальная сеть
- Используемая подсеть

Дополнительные сведения о масштабировании и мониторинге сред службы приложений, а также их управлении вручную см. в статье [Настройка среды службы приложений][ASEConfig].

Дополнительные сведения об автоматическом масштабировании см. в статье [Настройка автоматического масштабирования среды службы приложений][ASEAutoscale].

Существуют дополнительные зависимости, которые невозможно настроить, такие как база данных и хранилище. Они обрабатываются платформой Azure и поставляются с системой. Система хранения предоставляет до 500 ГБ для среды ASE, а Azure при необходимости регулирует размер базы данных в соответствии с масштабом системы.


## Приступая к работе

Чтобы начать работу со средами службы приложений, см. статью [Введение в среды службы приложений][WhatisASE]

Дополнительные сведения о платформе службы приложений Azure см. в статье [Служба приложений Azure][AzureAppService].

[AZURE.INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[AZURE.INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]
 

<!--Image references-->
[1]: ./media/app-service-web-how-to-create-an-app-service-environment/asecreate-basecreateblade.png
[2]: ./media/app-service-web-how-to-create-an-app-service-environment/asecreate-vnetcreation.png
[3]: ./media/app-service-web-how-to-create-an-app-service-environment/asecreate-resources.png

<!--Links-->
[WhatisASE]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[ASEConfig]: http://azure.microsoft.com/documentation/articles/app-service-web-configure-an-app-service-environment/
[AppServicePricing]: http://azure.microsoft.com/pricing/details/app-service/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[ASEAutoscale]: http://azure.microsoft.com/documentation/articles/app-service-environment-auto-scale/

<!---HONumber=AcomDC_0302_2016-->