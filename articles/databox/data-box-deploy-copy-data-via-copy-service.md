---
title: Копирование данных в Microsoft Azure Data Box через SMB | Документация Майкрософт
description: Сведения о копировании данных в Azure Data Box с помощью службы копирования данных
services: databox
author: alkohli
ms.service: databox
ms.subservice: pod
ms.topic: tutorial
ms.date: 01/10/2019
ms.author: alkohli
ms.openlocfilehash: a71635abd036bb89546dd3421af97cd9b88f4327
ms.sourcegitcommit: 9999fe6e2400cf734f79e2edd6f96a8adf118d92
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2019
ms.locfileid: "54440051"
---
# <a name="tutorial-use-data-copy-service-to-directly-ingest-data-into-azure-data-box-preview"></a>Руководство. Прием данных напрямую в Azure Data Box (предварительная версия) с помощью службы копирования данных

Это руководство содержит инструкции по приему данных с использованием службы копирования данных без наличия промежуточного узла. Служба копирования данных запускается локально в службе Data Box, подключается к устройству NAS по протоколу SMB и копирует данные в Data Box.

Служба копирования данных используется:

- В средах запоминающего устройства, подключаемого к сети (NAS), где промежуточные узлы могут быть недоступны.
- Для небольших файлов, прием и передача данных которых занимает недели. Эта служба значительно сокращает время приема и передачи данных.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * копирование данных в Data Box;
> * подготовка Data Box к отправке.

## <a name="prerequisites"></a>Предварительные требования

Перед тем как начать, убедитесь в следующем.

1. Вы завершили работу со статьей [Руководство: присоединение кабелей и подключение к Azure Data Box](data-box-deploy-set-up.md).
2. Вы получили Data Box. Состояние заказа на портале — **Доставлено**.
3. У вас есть учетные данные исходного устройства NAS, к которому вы выполняете подключение для копирования данных.
4. Ваш компьютер подключен к высокоскоростной сети. Настоятельно рекомендуем использовать хотя бы одно соединение Ethernet со скоростью передачи данных 10 Гбит/с. Если подключение 10 Гбит/с недоступно, можно использовать канал передачи данных 1 Гбит/с, но при этом скорость копирования будет снижена.

## <a name="copy-data-to-data-box"></a>копирование данных в Data Box;

После подключения к запоминающему устройству, подключаемому к сети, можно скопировать данные. Прежде чем начать копирование данных, ознакомьтесь со следующими моментами.

- При копировании данных убедитесь, что размер данных соответствует ограничениям на размер, указанным в статье [Ограничения Azure Data Box](data-box-limits.md).
- Если данные, отправляемые Data Box, одновременно отправляются другими приложениями за пределами Data Box, это может привести к сбоям заданий отправки и повреждению данных.
- Если данные чередуются во время считывания службой копирования данных, могут происходить сбои или повреждение данных.

Чтобы скопировать данные с помощью службы копирования данных, необходимо создать задание. Чтобы создать задание копирования данных, сделайте следующее.

1. В локальном пользовательском интерфейсе Data Box перейдите в раздел **Управление > Копирование данных**.
2. На странице **Копирование данных** щелкните **Создание**.

    ![Щелкните **Создание** на странице **Копирование данных**](media/data-box-deploy-copy-data-via-copy-service/click-create.png)

3. В диалоговом окне **Настроить и запустить** предоставьте следующие данные.
    
    |Поле                          |Значение    |
    |-------------------------------|---------|
    |Имя задания                       |Уникальное имя для задания, содержащее менее 230 символов. В имени задания нельзя использовать такие символы:\<, \>, \|, \?, \*, \\, \:, \/ и \\\..         |
    |Исходное расположение                |Укажите путь SMB к источнику данных в формате `\\<ServerIPAddress>\<ShareName>` или `\\<ServerName>\<ShareName>`.        |
    |Имя пользователя                       |Имя пользователя для доступа к источнику данных.        |
    |Пароль                       |Пароль для доступа к источнику данных.           |
    |Целевая учетная запись хранения    |Выберите целевую учетную запись хранения для передачи данных из раскрывающегося списка.         |
    |Destination storage type (Тип целевого хранилища)       |Выберите тип целевого хранилища: блочный BLOB-объект, страничный BLOB-объект или Файлы Azure.        |
    |Целевой контейнер или общая папка    |Введите имя контейнера или общей папки для отправки данных в целевую учетную запись хранения. Вы можете указать имя общей папки или контейнера. Например, `myshare` или `mycontainer`. Вы также можете ввести имя в облаке в формате `sharename\directory_name` или `containername\virtual_directory_name`.        |
    |Копировать файлы, соответствующие шаблону    | Введите соответствующий шаблон имени файла следующими двумя способами.<ul><li>**Использование выражений с подстановочными знаками.** В выражениях с подстановочными знаками поддерживаются только `*` и `?`. Например, `*.vhd` в этом выражении соответствует всем файлам с расширением VHD. Аналогичным образом `*.dl?` соответствует всем файлам с расширением `.dl` или `.dll`. Кроме того, `*foo` будет соответствовать всем файлам, имена которых заканчиваются на `foo`.<br>Выражение с подстановочными знаками можно ввести непосредственно в поле. По умолчанию значение, введенное в поле, рассматривается как выражение с подстановочными знаками.</li><li>**Использование регулярных выражений.** Поддерживаются регулярные выражения на основе POSIX. Например, регулярное выражение `.*\.vhd` будет соответствовать всем файлам с расширением `.vhd`. Для регулярного выражения предоставьте `<pattern>` непосредственно в качестве `regex(<pattern>)`. <li>Дополнительные сведения о регулярных выражениях см. в статье [Элементы языка регулярных выражений — краткий справочник](https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference).</li><ul>|
    |Оптимизация файлов              |Если этот параметр включен, файлы упакованы при приеме. Его применение ускоряет копирование данных для небольших файлов.        |
 
4. Нажмите **Запуск**. При использовании этого параметра выполняется проверка входных данных, и, если проверка прошла успешно, запускается задание. Запуск задания может занять несколько минут.

    ![Запуск задания из диалогового окна "Настройка задания и запуск"](media/data-box-deploy-copy-data-via-copy-service/configure-and-start.png)

5. Создано задание с указанными настройками. Установите флажок. После этого вы сможете приостановить и возобновить, отменить или перезапустить задание.

    ![Управление заданием с помощью страницы копирования данных](media/data-box-deploy-copy-data-via-copy-service/select-job.png)
    
    - Вы можете приостановить это задание, если оно влияет на ресурсы NAS в часы максимальной нагрузки.

        ![Приостановка задания](media/data-box-deploy-copy-data-via-copy-service/pause-job.png)

        Позже вы можете возобновить выполнение задания во время наименьшей нагрузки.

        ![Возобновление задания](media/data-box-deploy-copy-data-via-copy-service/resume-job.png)

    - Выполнение задания можно отменить в любое время.

        ![Отмена задания](media/data-box-deploy-copy-data-via-copy-service/cancel-job.png) При отмене задания необходимо подтвердить действие.

        ![Подтверждение отмены задания](media/data-box-deploy-copy-data-via-copy-service/confirm-cancel-job.png)

        Если вы решите отменить задание, уже скопированные данные не удаляются. Чтобы удалить любые данные, скопированные в Data Box, сбросьте настройки устройства.

        ![Сброс настроек устройства](media/data-box-deploy-copy-data-via-copy-service/reset-device.png)

        >[!NOTE]
        > Если отменить или приостановить задание, большие копируемые файлы могут копироваться только наполовину. Эти файлы отправляются в Azure в том же состоянии. При попытке отменить или приостановить выполнение задания убедитесь, что файлы копируются правильно. Чтобы проверить файлы, просмотрите папки SMB или скачайте файл метки порядка байтов (BOM).

    - Вы можете перезапустить задание, если при его выполнении случился внезапный сбой из-за временной ошибки, например из-за сбоя сети. Вы не можете перезапустить задание, если оно достигло конечного состояния (например, завершилось успешно или с ошибками). Ошибки могут возникать из-за проблем с размером или именем файла. Эти ошибки регистрируются, но после завершения задания его невозможно перезапустить.

        ![Перезапуск невыполненного задания](media/data-box-deploy-copy-data-via-copy-service/restart-failed-job.png)

        Если возникнет сбой и вам не удастся перезапустить задание, скачайте журналы ошибок и просмотрите ошибки в файлах журнала. После устранения проблемы можно создать задание копирования файлов. Вы также можете [скопировать файлы по протоколу SMB](data-box-deploy-copy-data.md).
    
    - В этом выпуске нельзя удалять задание.
    
    - Вы можете создать неограниченное количество заданий, но параллельно запускать можно до 10 заданий в любой момент времени.
    - Если включена оптимизация файлов, для повышения производительности копирования небольшие файлы упаковываются при приеме. В таких случаях вы увидите упакованный файл (GUID в качестве имени), как показано на следующем снимке экрана.

        ![Пример упакованного файла](media/data-box-deploy-copy-data-via-copy-service/packed-file-on-ingest.png)

6. Во время выполнения задания на странице **Копирование данных** могут отображаться следующие данные:

    - В столбце **Состояние** вы можете просмотреть состояние задания копирования. Состояние может быть:
        - **Выполнение**
        - **Сбой**
        - **Успешно**
        - **Переход в режим приостановки**
        - **Приостановлено**
        - **Идет отмена**
        - **Canceled**
        - **Завершено с ошибками**
    - В столбце **Файлы** отобразится количество и размер всех копируемых файлов.
    - В столбце **Обработано** отобразится количество и размер всех обработанных файлов.
    - В столбце **Сведения** щелкните **View** (Представление), чтобы просмотреть сведения задания.
    - При наличии ошибок во время копирования, как показано в столбце **Число ошибок**, перейдите к столбцу **Журнал ошибок** и скачайте журналы ошибок для устранения неполадок.

Дождитесь окончания заданий копирования. После регистрации некоторых ошибок на странице **Подключиться и копировать** убедитесь, что задания копирования завершены без ошибок, прежде чем переходить к выполнению следующего шага.

![Отсутствие ошибок на странице **Подключиться и копировать**](media/data-box-deploy-copy-data-via-copy-service/verify-no-errors-on-connect-and-copy.png)

Чтобы обеспечить целостность данных, при копировании данных система вычисляет их контрольные суммы. По завершении копирования проверьте использованное и свободное место на устройстве.
    
![Проверка свободного и использованного места на панели мониторинга](media/data-box-deploy-copy-data-via-copy-service/verify-used-space-dashboard.png)

После завершения задания копирования можно перейти к **подготовке к отправке**.

>[!NOTE]
> Подготовка к отправке недоступна во время выполнения заданий копирования.

## <a name="prepare-to-ship"></a>Подготовка к отправке

[!INCLUDE [data-box-prepare-to-ship](../../includes/data-box-prepare-to-ship.md)]


## <a name="next-steps"></a>Дополнительная информация

В этом руководстве были освещены следующие темы относительно Azure Data Box.

> [!div class="checklist"]
> * копирование данных в Data Box;
> * Подготовка Data Box к отправке

Перейдите к следующему руководству, чтобы узнать, как отправить свой Data Box обратно в корпорацию Майкрософт.

> [!div class="nextstepaction"]
> [Отправка Azure Data Box в корпорацию Майкрософт](./data-box-deploy-picked-up.md)

