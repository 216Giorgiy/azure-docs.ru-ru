<properties
   pageTitle="Сбор журналов с помощью системы диагностики Azure для Linux | Microsoft Azure"
   description="В этой статье описывается, как настроить систему диагностики Azure для сбора журналов из работающего в Azure кластера Service Fabric под управлением Linux."
   services="service-fabric"
   documentationCenter=".net"
   authors="mani-ramaswamy"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotNet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="09/28/2016"
   ms.author="subramar"/>


# Сбор журналов с помощью системы диагностики Azure

> [AZURE.SELECTOR]
- [Windows](service-fabric-diagnostics-how-to-setup-wad.md)
- [Linux](service-fabric-diagnostics-how-to-setup-lad.md)

Во время работы кластера Azure Service Fabric рекомендуется централизованно собирать журналы со всех узлов. Если все журналы хранятся централизованно, это упрощает анализ и устранение проблем со службами, приложениями и кластером. Для отправки и сбора журналов рекомендуется использовать расширение системы диагностики Azure, которое отправляет журналы в службу хранилища Azure. Можно считать события из хранилища и поместить их, например, в [эластичный поиск](service-fabric-diagnostic-how-to-use-elasticsearch.md) или другое решение для анализа журналов.

## Различные источники журналов, которые вы можете собирать
1. **Журналы Service Fabric**. Создаются платформой с помощью LTTng и отправляются в вашу учетную запись хранения. Журналами могут быть операционные события или события среды выполнения, создаваемые платформой. Эти журналы хранятся в расположении, указанном в манифесте кластера (выполните поиск по тегу AzureTableWinFabETWQueryable и найдите строку StoreConnectionString, чтобы получить сведения об учетной записи хранения).
2. **События приложений**. События, созданные кодом ваших служб. Вы можете использовать любое решение для ведения журналов, которое записывает текстовые файлы журнала, например [LTTng](http://lttng.org). Сведения о трассировке приложения см. в документации LTTng.


## Развертывание расширений системы диагностики
Первым шагом при сборе журналов является развертывание расширения системы диагностики на каждой виртуальной машине в кластере Service Fabric. Расширение системы диагностики собирает журналы на каждой виртуальной машине и отправляет их в указанную учетную запись хранения. Действия зависят от того, что вы используете — портал Azure или Azure Resource Manager.

### Развертывание расширения диагностики в ходе создания кластера 
Чтобы развернуть расширение диагностики на виртуальных машинах в кластере в ходе его создания, переключите параметр "Диагностика" в состояние **Вкл**. После создания кластера этот параметр нельзя изменить на портале.

В системе диагностики Azure для Linux (LAD) настройте сбор файлов и их добавление в учетную запись хранения клиента. Этот процесс объясняется в разделе "Сценарий 3. Передача файлов журнала" в статье [Использование диагностического расширения Linux для мониторинга данных о состоянии и производительности виртуальных машин под управлением Linux](../virtual-machines/virtual-machines-linux-classic-diagnostic-extension.md). В рамках этого процесса вы получаете доступ к трассировкам, которые можно отправить в любой визуализатор.


Кроме того, расширение диагностики можно развернуть с помощью Azure Resource Manager. Для Windows и Linux применяется один и тот же процесс. Он описан в документации по кластерам Windows в статье [Сбор журналов с помощью системы диагностики Azure](service-fabric-diagnostics-how-to-setup-wad.md).

Вы также можете использовать OMS, как описано в записи блога [OMS log analytics with linux](https://blogs.technet.microsoft.com/hybridcloud/2016/01/28/operations-management-suite-log-analytics-with-linux/) (OMS Log Analytics и Linux).

Когда настройка будет завершена, агент LAD начнет отслеживать указанные файлы журнала. Каждый раз при добавлении в файл новой строки агент создает запись в системном журнале, которая отправляется в указанное пользователем хранилище.


## Дальнейшие действия
Ознакомьтесь с [документацией LTTng](http://lttng.org/docs) и [сведениями об использовании LAD](../virtual-machines/virtual-machines-linux-classic-diagnostic-extension.md), чтобы лучше понять, на какие события следует обращать внимание в процессе устранения неполадок.

<!---HONumber=AcomDC_0928_2016-->