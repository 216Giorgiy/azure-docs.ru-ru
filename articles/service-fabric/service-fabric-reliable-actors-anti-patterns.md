<properties
   pageTitle="Некоторые антишаблоны использования субъектов Azure Service Fabric | Microsoft Azure"
   description="Некоторые проблемы, с которыми могут столкнуться пользователи, изучающие субъекты Azure Service Fabric."
   services="service-fabric"
   documentationCenter=".net"
   authors="vturecek"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/11/2015"
   ms.author="vturecek"/>

# Конструктивный шаблон Reliable Actors: некоторые антишаблоны

Мы определили некоторые ошибки, которые могут допускать пользователи, изучающие субъекты Reliable Actors, предоставляемые платформой Service Fabric.

* Рассмотрение надежных субъектов в качестве системы транзакций. Субъекты Reliable Actors платформы Service Fabric — это не двухфазная система фиксации с типичными характеристиками транзакций, атомарности, согласованности, изоляции и надежности (ACID). Если вы не реализовали дополнительное сохранение, а компьютер, на котором выполняется субъект, выходит из строя, его текущее состояние не сохраняется. Работа субъекта будет моментально восстановлена на другом узле, но если резервное сохранение не реализовано, состояние субъекта восстановить не удастся. Тем не менее использование механизма повторных попыток, фильтрации дубликатов и (или) идемпотентного подхода к разработке помогут вам обеспечить высокий уровень надежности и согласованности.

* Блокировка. Все операции с субъектами Reliable Actors должны выполняться асинхронно. Как правило, это не является проблемой, так как платформа Майкрософт предоставляет немало асинхронных API. Однако если вам нужно взаимодействовать с системой, поддерживающей только блокирующий API, такой API придется поместить в оболочку, которая явно использует пул потоков .NET.

* Усложнение архитектуры и работающая среда. Часто разработчикам, которые занимаются параллельными коллекциями и блокировками или используют специальные инструменты для компиляции объектов из XML, сложно представить, что можно просто написать класс, выполняющий простые операции, такие как присвоение значения переменной или планирование расписания задач. Встроенные запланированные задачи и ненужные блокировки. Состояние больше не является заклятым врагом. Чтобы привыкнуть к этому, разработчикам, которые выполняют задачи, связанные с работой серверных компонентов в крупномасштабных средах, обычно требуется время.

* Переполнение отдельных субъектов. В эту ловушку довольно легко попасть, добавляя миллионы субъектов в один экземпляр другого субъекта. Используйте агрегирование — подход, описанный в статье [Шаблон разработки Reliable Actors: распределенные вычисления](service-fabric-reliable-actors-pattern-distributed-computation.md).

* Сопоставление моделей сущностей вслепую. Об этом нужно помнить разработчикам из реляционной вселенной, где проблемы моделируют с использованием сущностей и связей между ними. Хотя этот подход можно использовать для изучения предметной области, его следует сочетать с сервис-ориентированной парадигмой.

<!---HONumber=AcomDC_0121_2016-->