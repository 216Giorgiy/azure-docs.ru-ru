<properties
   pageTitle="Некоторые антишаблоны использования субъектов Azure Service Fabric"
   description="Некоторые проблемы, с которыми могут столкнуться пользователи, изучающие субъекты Azure Service Fabric."
   services="service-fabric"
   documentationCenter=".net"
   authors="jessebenson"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/11/2015"
   ms.author="claudioc"/>

# Шаблон проектирования надежных субъектов: антишаблоны

Мы выявили следующие ошибки, которые могут допускать пользователи, изучающие надежные субъекты Service Fabric.

* Рассмотрение надежных субъектов в качестве системы транзакций. Надежные субъекты Service Fabric — это не двухфазная система фиксации с типичными характеристиками транзакций (ACID). Если дополнительное сохранение не реализовано и компьютер, на котором выполняется субъект, выходит из строя, его текущее состояние не сохраняется. Работа субъекта очень быстро будет восстановлена на другом узле, но, если резервное сохранение не реализовано, состояние субъекта будет утеряно безвозвратно. Тем не менее алгоритм использования повторных попыток, фильтрация дубликатов и идемпотентный подход к разработке помогут вам обеспечить высокий уровень надежности и согласованности.

* Блокировка. Все операции с надежными субъектами должны выполняться асинхронно. Как правило, это не вызывает проблем, так как платформа Майкрософт предоставляет немало асинхронных API. Однако, если по какой-то причине вам требуется взаимодействовать с системой, поддерживающей только блокирующий API, его придется поместить в оболочку, которая явно использует пул потоков .NET.

* Слишком сложная архитектура. Не нужно усложнять рабочую среду. Часто разработчикам, привыкшим заниматься параллельными коллекциями и блокировками или использовать специальные инструменты для компиляции объектов из XML, сложно представить, что можно просто написать класс, выполняющий простые операции, такие как присвоение значения переменной или планирование расписания задач. Задачи, выполняющиеся по расписанию, встроены. Блокировки не требуются. Состояние больше не является заклятым врагом. Пользователям, которые много работали с крупномасштабными средами и выполняли задачи на стороне сервера, как правило, требуется время, чтобы привыкнуть к этим изменениям.

* Переполнение отдельных субъектов. В эту ловушку довольно легко попасть, добавляя миллионы субъектов в один экземпляр другого субъекта. Используйте агрегирование, которое мы продемонстрировали в статье об [использовании распределенных вычислений в разработке](service-fabric-reliable-actors-pattern-distributed-computation.md).

* Сопоставление моделей сущностей вслепую. Об этом нужно помнить разработчикам из реляционной вселенной, где для решения проблем их моделируют, используя сущности и связи между ними. Хотя этот подход можно использовать для изучения предметной области, его следует сочетать с сервис-ориентированной парадигмой.

<!---HONumber=August15_HO7-->