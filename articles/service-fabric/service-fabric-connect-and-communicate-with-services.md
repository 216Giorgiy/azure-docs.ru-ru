<properties
   pageTitle="Структура служб Microsoft Azure Обмен данными со службами"
   description="В настоящей статье представлен способ подключения и обмена данными со службами в приложениях структуры служб."
   services="service-fabric"
   documentationCenter=".net"
   authors="kunaldsingh"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/21/2015"
   ms.author="kunalds"/>


# Обмен данными со службами
В мире микрослужб комплексное решение состоит из множества различных служб, каждая из которых выполняет специализированную задачу. Между этими микрослужбами выполняется обмен данными, чтобы обеспечить непрерывный рабочий процесс. Существуют также клиентские приложения, которые подключаются и обмениваются данными со службами. В этом документе рассматривается, как при помощи структуры служб можно легко настроить взаимодействие со службами, вписанными в структуру служб.

## Основные понятия
Ниже приведены несколько ключевых понятий, которые необходимо учитывать при настройке взаимодействия со службами.
### Обмен данными представлен в контексте "клиент-сервер"
API обмена данными структуры служб используются в качестве средства обеспечения взаимодействия "клиент-сервер", даже если обмен данными выполняется между двумя службами в одном кластере. Целевая служба, к которой будет подключен клиент или другая служба, действует как сервер, прослушивая входящие запросы. Клиент, который может быть просто другой службой в этом же кластере, подключается к серверу и формирует запросы для него.
### Перемещение служб
В распределенной системе запущенные экземпляры служб могут со временем перемещаться с одной машины на другую по разным причинам, таким как балансировка нагрузки (при конфигурации с метриками загрузки для балансировки ресурсов или из-за обновлений, отработки отказа, горизонтального масштабирования и в других разнообразных ситуациях). Это приводит к тому, что адреса конечных точек экземпляра служб могут измениться и для настройки обмена данными с любым рассматриваемым экземпляром служб необходимо будет выполнить следующий цикл. Эти сведения извлекаются у вас при использовании API обмена данными, представляемыми структурой служб.

* **Разрешение**. Все экземпляры служб в структуре служб обладают уникальными URI, например fabric:/MyApplication/MyService, которые не изменяются со временем. Каждый экземпляр службы делает доступными также конечные точки, которые могут меняться при перемещении экземпляров службы. Это аналогично веб-сайтам, URL-адреса которых не меняются, даже когда могут меняться их IP-адреса. Подобно службе DNS в Интернете, которая разрешает URL веб-сайтов до IP-адресов, платформа структуры служб также обладает системной службой, которая разрешает URI-адреса до конечных точек. Этот шаг подразумевает разрешение URI экземпляра служб до конечной точки.

* **Подключение**. После того как URI службы был разрешен до адреса конечной точки, следующим шагом будет попытка подключения к этой службе. Такое подключение может дать сбой, если адрес конечной точки изменился из-за перемещения службы, вызванного, например, аппаратным отказом или вследствие балансировки нагрузки.

* **Повторение попытки**. Если при попытке подключения произойдет отклонение предыдущей операции разрешения и возникнет необходимость повтора всех шагов по подключению, этот цикл повторяется до успешной установки подключения.

## Принятие решения о том, какой API обмена данными будет использоваться
В составе структуры служб мы предоставляем несколько различных вариантов API обмена данными, при этом решение относительно того, какой из них оптимально использовать, зависит от выбора модели программирования, среды коммуникаций и языка программирования, на котором будут написаны службы.
### Обмен данными для Reliable Actors
Для служб, написанных при помощи API Reliable Actors, все сведения об обмене данными имеются в кратком виде, а обмен данными осуществляется как вызовы метода на ActorProxy.

### Параметры обмена данными для Reliable Services
Существует пара различных вариантов на тот случай, если служба написана при помощи API Reliable Services. Выбранный вами протокол обмена данными поможет выбрать наиболее подходящий API структуры служб.

* **Нет конкретного протокола обмена данными, который необходимо использовать, следует просто создать и запустить некоторую службу**. Если вы не сделали определенного выбора среды коммуникаций, идеальным вариантом будет выбор [стека по умолчанию](service-fabric-reliable-services-communication-default.md), допускающего использование модели, подобной модели обмена данными Actor. Это самый простой и наиболее быстрый способ начать обмен данными между службами. Он обеспечивает выраженный обмен данными RPC, который исключает множество подробной информации об обмене данными так, что вызов метода на удаленной службе в коде выглядит как метод на локальном экземпляре объекта. Эти классы выделяют разрешение, подключение, повторные попытки и обработку ошибок, одновременно настраивая канал обмена данными, и позволяют реализовать модель обмена данными путем вызова методов. Для этого при обмене данными на стороне сервера будет использоваться класс `ServiceCommunicationListener`, а на стороне клиента будет использоваться класс `ServiceProxy`.

* **HTTP**. Чтобы использовать гибкость, которую предоставляет обмен данными на основе HTTP, можно применить API обмена данными структуры служб, которые позволяют определить механизм обмена данными, в то время как логические операции разрешения, подключения и повторения попыток остаются за кадром. Например, можно использовать Web API для задания механизма обмена данными и использования [классов `ICommunicationClient` и `ServicePartitionClient`](service-fabric-reliable-services-communication.md) для настройки обмена данными.
* **WCF**. Если имеется уже существующий код, который использует WCF как среду обмена данными, то можно использовать класс WcfCommunicationListener для серверной стороны и классы WcfCommunicationClient и ServicePartitionClient для клиентской стороны. Дополнительные сведения см. в [этой статье](service-fabric-reliable-services-communication-wcf.md).

* **Другие платформы обмена данными, в том числе пользовательские протоколы**. Если планируется использовать какие-либо другие протоколы обмена данными, в том числе пользовательские протоколы, реализованные в API обмена данными в структуре служб, в которые можно включить свой стек обмена данными, в то время как все действия по обнаружению и подключению скрыты от вас. Дополнительные сведения см. в [этой статье](service-fabric-reliable-services-communication.md).

### Обмен данными между службами, написанными на разных языках программирования
Все API обмена данными структуры служб в настоящий момент доступны только на C#, поэтому, если у вас имеется служба, написанная на каком-либо другом языке программирования, например Java или Node.JS, потребуется создать собственный механизм обмена данными.

## Дальнейшие действия
* [Стек обмена данными по умолчанию, предоставляемый платформой Reliable Services](service-fabric-reliable-services-communication-default.md)
* [Модель обмена данными Reliable Services](service-fabric-reliable-services-communication.md)
* [Начало работы со службами Web API структуры служб Microsoft Azure с собственным хостом OWIN](service-fabric-reliable-services-communication-webapi.md)
* [Стек обмена данными WCF для Reliable Services](service-fabric-reliable-services-communication-wcf.md)

<!---HONumber=Oct15_HO3-->