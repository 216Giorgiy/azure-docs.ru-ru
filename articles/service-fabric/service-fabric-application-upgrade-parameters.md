
<properties
   pageTitle="Обновление приложений: параметры обновления | Microsoft Azure"
   description="Описывает параметры, относящиеся к обновлению приложения Service Fabric, включая проверки работоспособности и политики для автоматической отмены обновления."
   services="service-fabric"
   documentationCenter=".net"
   authors="mani-ramaswamy"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="07/17/2015"
   ms.author="subramar"/>



# Параметры обновления приложений

В настоящей статье описаны различные параметры, которые применяются во время обновления приложения Azure Service Fabric. Параметры включают название и версию приложения. Это элементы управления временем ожидания и проверками работоспособности, которые применяются во время обновления и указывают политики, которые должны применяться при сбое обновления.


<br>

| Параметр | Описание |
| --- | --- |
| ApplicationName | Имя обновляемого приложения. Примеры: fabric:/VisualObjects, fabric:/ClusterMonitor |
| TargetApplicationTypeVersion | Версия типа приложения, для которой предназначено обновление. |
| FailureAction | Действие, которое должно быть предпринято Service Fabric при сбое обновления. Может быть выполнен откат приложения до последней версии перед обновлением, или обновление приложения будет остановлено на уровне текущего домена обновления, а режим обновления изменится на ручной. Допустимые значения этого свойства: Rollback (Откат) и Manual (Вручную). |
| HealthCheckWaitDurationSec | Время ожидания (в секундах) после завершения обновления на уровне домена обновления перед тем, как Service Fabric выполнит оценку работоспособности приложения. Этот срок можно рассматривать как время, в течение которого приложение должно быть запущено, чтобы оно могло рассматриваться работоспособным. После успешной проверки работоспособности процесс обновления переходит к следующему домену обновления. При сбое проверки работоспособности структура службы будет ожидать в течение определенного времени (UpgradeHealthCheckInterval) перед возобновлением попытки выполнить проверку работоспособности снова до момента истечения срока, заданного свойством HealthCheckRetryTimeout. По умолчанию и рекомендуемое значение — "0 секунд". |
| HealthCheckRetryTimeoutSec | Продолжительность (в секундах), в течение которой структура службы продолжит выполнение оценки работоспособности перед выводом уведомления о сбое обновления. По умолчанию используется значение "600 секунд". Этот срок запускается после достижения конечного значения HealthCheckWaitDuration. В течение этого времени ожидания HealthCheckRetryTimeout структура службы может выполнить несколько проверок работоспособности приложения. Значение по умолчанию — 10 минут, его следует изменить в соответствии с вашим приложением. |
| HealthCheckStableDurationSec | Продолжительность (в секундах) ожидания завершения проверки и заключения о стабильности приложения перед переходом в следующий домен обновления или завершением обновления. Это время ожидания используется для того, чтобы предотвратить возможность пропуска необнаруженных проблем работоспособности сразу после выполнения проверки работоспособности. Значение по умолчанию — 0 секунд, его следует изменить в соответствии с вашим приложением. |
| UpgradeDomainTimeoutSec | Максимальное время (в секундах) для обновления одного домена обновления. По истечении этого времени ожидания обновление остановится, после чего будет предпринято действие, определяемое атрибутом UpgradeFailureAction. Значение по умолчанию — "никогда" (бесконечно). Его рекомендуется изменить в соответствии с вашим приложением. |
| UpgradeTimeout | Время ожидания (в секундах), применяемое для всего обновления. По истечении этого времени ожидания обновление остановится, после чего будет запущено действие UpgradeFailureAction. Значение по умолчанию — "никогда" (бесконечно). Его рекомендуется изменить в соответствии с вашим приложением. |
| UpgradeHealthCheckInterval | Частота проверки состояния работоспособности. Этот параметр указан в разделе ClusterManager _манифеста_ _кластера_. (Он не указывается как часть командлета обновления.) Значение по умолчанию составляет 60 секунд. |






<br>
## Оценка работоспособности службы во время обновления приложения

<br> Критерии оценки работоспособности указывать не обязательно. Если критерии оценки работоспособности не указываются перед началом обновления, Service Fabric использует политики работоспособности приложения, указанные в файле ApplicationManifest.xml экземпляра приложения, для которого выполняется обновление.


<br>

| Параметр | Описание |
| --- | --- |
| ConsiderWarningAsError | Значение по умолчанию — False. Считать предупреждения работоспособности приложения ошибками при оценке работоспособности приложения во время обновления. По умолчанию Service Fabric не считает предупреждения работоспособности ошибками (сбоями), чтобы обновление могло продолжиться даже при появлении предупреждений. |
| MaxPercentUnhealthyDeployedApplications | По умолчанию и рекомендуемое значение — "0". Укажите максимальное количество развертываемых приложений (см. [раздел "Работоспособность"](service-fabric-health-introduction.md)), которые могут быть сочтены неработоспособными перед тем, как само приложение будет сочтено неработоспособным и возникнет сбой обновления. Здесь имеется в виду работоспособность пакета приложения на этом узле, поэтому эта функция полезна для обнаружения неполадок во время обновления, когда развернутый на узле пакет приложения неработоспособен (его работа неожиданно прерывается и т. п.). В обычном случае реплики приложения будут сбалансированы по нагрузке на другой узел, таким образом, приложение по-прежнему будет выглядеть работоспособным, позволяя выполнить дальнейшее обновление. При указании строгого значения работоспособности в атрибуте MaxPercentUnhealthyDeployedApplications Service Fabric может очень быстро обнаружить проблему с пакетом приложения, что приведет к сбою быстрого обновления. |
| MaxPercentUnhealthyServices | По умолчанию и рекомендуемое значение — "0". Укажите максимальное количество служб в экземпляре приложения, которое может быть признано неработоспособным до того, как само приложение будет сочтено неработоспособным, что приведет к сбою обновления. |
| MaxPercentUnhealthyPartitionsPerService | По умолчанию и рекомендуемое значение — "0". Укажите максимальное количество разделов в службе, которые могут быть признаны неработоспособными, прежде чем служба будет сочтена неработоспособной. |
| MaxPercentUnhealthyReplicasPerPartition | По умолчанию и рекомендуемое значение — "0". Укажите максимальное количество реплик в разделе, которые могут быть признаны неработоспособными до того, как весь раздел будет признан неработоспособным. |
| UpgradeReplicaSetCheckTimeout | **Служба без отслеживания состояния** — при работе в одном домене обновления Service Fabric пытается обеспечить доступность дополнительных экземпляров службы. Если количество целевых экземпляров превышает один, Service Fabric ожидает, пока не появится несколько экземпляров, до истечения максимального значения времени ожидания (которое указано в свойстве UpgradeReplicaSetCheckTimeout). По истечении времени ожидания Service Fabric продолжает обновление вне зависимости от количества экземпляров службы. Если счетчик целевых экземпляров имеет значение "1", структура службы не ожидает обновления, а сразу переходит к обновлению. **Служба с отслеживанием состояния** — в одном домене обновления Service Fabric пытается обеспечить наличие кворума в наборе реплик. Service Fabric ожидает доступности кворума вплоть до достижения максимального значения времени ожидания (указанного в свойстве UpgradeReplicaSetCheckTimeout). По истечении времени ожидания Service Fabric продолжает обновление вне зависимости от кворума. Этот параметр имеет значение "никогда" (бесконечно) при откате до следующей версии (используется, когда обновление выполняется как ожидалось) и "900 секунд" при откате до предыдущей версии (используется, когда при обновлении возникают ошибки и происходит откат). |
| ForceRestart | Если вы обновите пакет конфигурации или данных, не обновив код службы, Service Fabric не перезапустит службу, если для свойства ForceRestart при вызове API не установлено значение true. По завершении обновления структура служб уведомляет службу о том, что доступен новый пакет конфигурации или пакет данных. Ответственность за применение изменений принадлежит службе. При необходимости служба может самостоятельно перезапуститься. |



<br> <br> Критерии MaxPercentUnhealthyServices, MaxPercentUnhealthyPartitionsPerService и MaxPercentUnhealthyReplicasPerPartition можно указать для каждого типа службы в экземпляре приложения. Это необходимо для того, чтобы, если приложение содержит различные типы служб, для него можно было установить отличные политики оценки для каждого типа служб. Например, значения параметра MaxPercentUnhealthyPartitionsPerService для типов службы "шлюз без отслеживания состояния" и "механизм с отслеживанием состояния" могут отличаться для конкретного экземпляра приложения.

## Дальнейшие действия


[Обновление приложения Service Fabric с помощью Visual Studio](service-fabric-application-upgrade.md)

[Обновление приложения Service Fabric с помощью PowerShell](service-fabric-application-upgrade-tutorial-powershell.md)

[Обновление вручную и с помощью пакета Diff](service-fabric-application-upgrade-advanced.md)

[Поиск и устранение неисправностей при обновлении приложения](service-fabric-application-upgrade-troubleshooting.md)

[Сериализация данных](service-fabric-application-upgrade-data-serialization.md)

<!---HONumber=AcomDC_0121_2016-->