<properties
    pageTitle="Нагрузочное тестирование приложения с помощью Visual Studio Team Services | Microsoft Azure"
    description="Узнайте, как выполнить нагрузочное тестирование приложений Azure Service Fabric с помощью Visual Studio Team Services."
    services="service-fabric"
    documentationCenter="na"
    authors="cawams"
    manager="timlt"
    editor="" />

<tags
    ms.service="multiple"
    ms.devlang="dotnet"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="multiple"
    ms.date="10/28/2015"
    ms.author="cawa" />

# Нагрузочное тестирование приложения с помощью Visual Studio Team Services

В этой статье показано, как выполнить нагрузочное тестирование приложения с помощью функций нагрузочного тестирования Visual Studio. В ней используются служба с отслеживанием состояния Service Fabric в серверной части и служба без отслеживания состояния в клиентской части. Используемый здесь пример приложения представляет собой симулятор расположения самолета. Вы указываете идентификатор самолета, точки отправления и прибытия. Серверная часть приложения обрабатывает запросы, а клиентская часть отображает на карте самолет в соответствии с заданными критериями.

Структура приложения Service Fabric, которое вы будете тестировать, показана на следующей схеме.

![][0]

## Предварительные требования
Перед началом работы необходимо сделать следующее.

- Получите учетную запись Visual Studio Team (VSTS). Это можно сделать бесплатно на веб-сайте [Visual Studio Team Services](https://www.visualstudio.com).
- Загрузите и установите Visual Studio 2013 или Visual Studio 2015. В этой статье используется выпуск Visual Studio 2015 Enterprise, но Visual Studio 2013 и другие выпуски должны работать аналогичным образом.
- Разверните свое приложение в промежуточной среде. Сведения об этом см. в разделе [Развертывание приложений на удаленном кластере с помощью Visual Studio](service-fabric-publish-app-remote-cluster.md).
- Поймите схему использования вашего приложения. Эта информация используется для моделирования шаблона нагрузки.
- Поймите цель нагрузочного тестирования. Это помогает интерпретировать и анализировать результаты нагрузочного тестирования.

## Создание и запуск проекта веб-тестов производительности и нагрузочных тестов

### Создание проекта веб-тестов производительности и нагрузочных тестов

1. Откройте Visual Studio 2015. Выберите **Файл** > **Создать** > **Проект** в меню. Откроется диалоговое окно **Новый проект**.

1. Разверните узел **Visual C#** и выберите **Тест** > **Проект веб-тестов производительности и нагрузочных тестов**. Укажите имя проекта и нажмите кнопку **ОК**.

    ![][1]

    На экране должен появиться новый проект веб-тестов производительности и нагрузочных тестов.

    ![][2]

### Запись веб-теста производительности

1. Откройте проект .webtest.

1. Щелкните значок **Добавить запись** для запуска сеанса записи в браузере.

    ![][3]

    ![][4]

1. Перейдите к приложению Service Fabric. На панели записи должны отображаться веб-запросы.

    ![][5]

1. Выполните последовательность действий, которую вы ожидаете от пользователя. Эти действия используются в качестве шаблона для создания нагрузки.

1. Когда закончите, нажмите кнопку **Остановить**, чтобы остановить запись.

    ![][6]

    Проект .webtest в Visual Studio должен захватить последовательности запросов. Динамические параметры заменяются автоматически. На этом этапе можно удалить любые излишние и повторяющиеся зависимые запросы, которые не являются частью сценария тестирования.

1. Сохраните проект и выберите **Запустить тест** для запуска веб-теста производительности локально и убедитесь, что все работает правильно.

    ![][7]

### Параметризация веб-теста производительности

Веб-тест производительности можно параметризовать, преобразовав его в закодированный веб-тест производительности и внеся изменения в код. В качестве альтернативы можно привязать веб-тест производительности к списку данных, так чтобы тест перебирал эти данные. Сведения о преобразовании веб-теста производительности в закодированный тест см. в статье [Создание и запуск закодированного веб-теста производительности](https://msdn.microsoft.com/library/ms182552.aspx), а сведения о привязке данных к веб-тесту производительности — в статье [Добавление источника данных к веб-тесту производительности](https://msdn.microsoft.com/library/ms243142.aspx).

В этом примере мы преобразуем веб-тест производительности в закодированный тест, и вы сможете заменить идентификатор самолета созданным идентификатором GUID, а также добавить дополнительные запросы для отправки рейсов в другие места.

### Создание проекта нагрузочного теста

Проект нагрузочного теста состоит из одного или нескольких сценариев, описываемых веб-тестом производительности и модульным тестом, и дополнительных параметров нагрузочного теста. Ниже показано, как создать проект нагрузочного теста.

1. В контекстном меню проекта веб-тестов производительности и нагрузочных тестов выберите **Добавить** > **Нагрузочный тест**. В мастере **Нагрузочный тест** нажмите кнопку **Далее**, чтобы настроить параметры теста.

1. В разделе **Шаблон нагрузки** выберите, хотите ли вы использовать постоянную пользовательскую нагрузку или пошаговую пользовательскую нагрузку, которая начинается с нескольких пользователей, и с течением времени их количество увеличивается.

    Если у вас хорошее представление об объеме пользовательской нагрузки и вы хотите посмотреть, как с ней справится текущая система, выберите **Постоянная нагрузка**. Если вы хотите узнать, будет ли система работать стабильно при различных объемах нагрузки, выберите **Пошаговая нагрузка**.

1. В разделе **Сочетание тестов** нажмите кнопку **Добавить** и выберите тест, который хотите включить в нагрузочный тест. Для указания доли каждого теста в общем количестве запущенных тестов воспользуйтесь столбцом **Распределение**.

1. В разделе **Параметры запуска** укажите длительность нагрузочного теста.
    >[AZURE.NOTE]Параметр **Итерации теста** доступен только при запуске нагрузочного теста локально с помощью Visual Studio.

1. В подразделе **Расположение** раздела **Параметры запуска** укажите расположение, в котором формируются запросы нагрузочного теста. Мастер может попросить вас войти в вашу учетную запись Team Services. Войдите в учетную запись Team Services и выберите географическое расположение. По завершении нажмите кнопку **Готово**.

1. После создания нагрузочного теста откройте проект .loadtest и выберите текущие параметры запуска, например: **Параметры запуска** > **Параметры запуска 1 [Активные]**. Параметры запуска откроются в окне **Свойства**.

1. В разделе **Результаты** окна **Параметры запуска** для параметра **Хранилище сведений о времени** по умолчанию должно быть установлено значение **Нет**. Измените это значение на **Все индивидуальные сведения** для получения дополнительных сведений о результатах нагрузочного теста. Дополнительные сведения о том, как подключиться к Visual Studio Team Services и запустить нагрузочный тест, см. в статье [Нагрузочное тестирование](https://www.visualstudio.com/load-testing.aspx).

### Запуск нагрузочного теста с помощью Visual Studio Team Services

Для запуска теста выберите **Запустить нагрузочный тест**.

![][8]

## Просмотр и анализ результатов нагрузочного теста

По мере выполнения нагрузочного теста информация о производительности появляется на графике. У вас должен отобразиться примерно такой график.

![][9]

1. Выберите ссылку **Загрузить отчет** в верхней части страницы. После загрузки отчета нажмите кнопку **Просмотреть отчет**.

    На вкладке **График** можно увидеть графики для различных счетчиков производительности. На вкладке **Сводка** показываются общие результаты теста. На вкладке **Таблицы** отображается общее количество успешных и неудачных нагрузочных тестов.

1. Выберите ссылки с номерами в столбцах **Тесты** > **Неудачные** и **Ошибки** > **Количество**, чтобы просмотреть подробные сведения об ошибке.

    На вкладке **Сведения** отображается информация о виртуальных пользователях и сценариях тестов для неудачных запросов. Эти данные могут быть полезными, если нагрузочный тест содержит несколько сценариев.

Дополнительные сведения о просмотре результатов нагрузочного тестирования см. в статье [Анализ результатов нагрузочного тестирования в графическом представлении диаграмм анализатора нагрузочного тестирования](https://www.visualstudio.com/load-testing.aspx).

## Автоматизация нагрузочного тестирования

Нагрузочный тест Visual Studio Team Services предоставляет интерфейсы API, которые позволяют управлять нагрузочными тестами и анализировать результаты в учетной записи Team Services. Дополнительные сведения см. в статье [Интерфейсы API Rest для облачного нагрузочного тестирования](http://blogs.msdn.com/b/visualstudioalm/archive/2014/11/03/cloud-load-testing-rest-apis-are-here.aspx).

## Дальнейшие действия
- [Мониторинг и диагностика состояния служб в локальной среде разработки](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[0]: ./media/service-fabric-vso-load-test/OverviewDiagram.png
[1]: ./media/service-fabric-vso-load-test/NewProjectDialog.png
[2]: ./media/service-fabric-vso-load-test/Project.png
[3]: ./media/service-fabric-vso-load-test/AddRecording.png
[4]: ./media/service-fabric-vso-load-test/AddRecording2.png
[5]: ./media/service-fabric-vso-load-test/ActionSequence.png
[6]: ./media/service-fabric-vso-load-test/StopRecording.png
[7]: ./media/service-fabric-vso-load-test/RunTest.png
[8]: ./media/service-fabric-vso-load-test/RunTest2.png
[9]: ./media/service-fabric-vso-load-test/Graph.png

<!---HONumber=AcomDC_1217_2015-->