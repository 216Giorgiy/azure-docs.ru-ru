---
title: "Интерфейс командной строки Azure Service Fabric : sfctl cluster | Документация Майкрософт"
description: "Описание команд sfctl cluster интерфейса командной строки Azure Service Fabric."
services: service-fabric
documentationcenter: na
author: rwike77
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: cli
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: multiple
ms.date: 09/22/2017
ms.author: ryanwi
ms.translationtype: HT
ms.sourcegitcommit: cb9130243bdc94ce58d6dfec3b96eb963cdaafb0
ms.openlocfilehash: dc2ed59d6adaca97b23dddcb7ec968d90171b483
ms.contentlocale: ru-ru
ms.lasthandoff: 09/26/2017

---
# <a name="sfctl-cluster"></a>sfctl cluster
Выбор кластеров Service Fabric, управление ими и их эксплуатация.

## <a name="commands"></a>Команды

|Команда|Описание|
| --- | --- |
|    code-versions| Возвращает список версий кода структуры, которые были подготовлены в кластере Service Fabric.|
|    config-versions | Возвращает список версий конфигураций структуры, которые были подготовлены в кластере Service Fabric.|
|    health       | Возвращает состояние работоспособности кластера Service Fabric.|
|    manifest     | Возвращает манифест кластера Service Fabric.|
|    operation-cancel| Отменяет операцию при ошибке, вызываемую пользователем.|
|    operationgit | Возвращает список операций при ошибке, вызываемых пользователем, отфильтрованный по введенным параметрам.|
|    provision     | Подготавливает пакеты кода или конфигурации кластера Service Fabric.|
|    recover-system  | Указывает кластеру Service Fabric, что следует попытаться восстановить системные службы, которые в настоящее время находятся в состоянии потери кворума.|
|report-health   | Отправляет отчет о работоспособности кластера Service Fabric.|
|    select       | Выполняет подключение к конечной точке кластера Service Fabric.|
| unprovision     | Отменяет подготовку пакетов кода или конфигурации кластера Service Fabric.|
|    upgrade         | Запускает обновление пакетов кода или конфигурации кластера Service Fabric.|
|    upgrade-resume  | Выполняет переход процесса обновления кластера к следующему домену обновления.|
|    upgrade-rollback| Откатывает обновление кластера Service Fabric.|
|    upgrade-status  | Возвращает ход выполнения текущего обновления кластера.|
|upgrade-update  | Обновляет параметры обновления кластера Service Fabric.|


## <a name="sfctl-cluster-health"></a>sfctl cluster health
Возвращает состояние работоспособности кластера Service Fabric.

Возвращает состояние работоспособности кластера Service Fabric. EventsHealthStateFilter используется для фильтрации получаемой коллекции событий работоспособности кластера на основе состояния работоспособности. Аналогично используются NodesHealthStateFilter и ApplicationsHealthStateFilter для фильтрации получаемой коллекции узлов и приложений на основе их общего состояния работоспособности. 

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --applications-health-state-filter| Позволяет фильтровать состояние работоспособности приложений.
                                                    objects returned in the result of cluster health
                                                    query based on their health state. The possible
                                                    values for this parameter include integer value
                                                    obtained from members or bitwise operations on
                                                    members of HealthStateFilter enumeration. Only
                                                    applications that match the filter are returned.
                                                    All applications are used to evaluate the
                                                    aggregated health state. If not specified, all
                                                    entries are returned. The state values are flag
                                                    based enumeration, so the value could be a
                                                    combination of these values obtained using
                                                    bitwise 'OR' operator. For example, if the
                                                    provided value is 6 then health state of
                                                    applications with HealthState value of OK (2)
                                                    and Warning (4) are returned. - Default -
                                                    Default value. Matches any HealthState. The
                                                    value is zero. - None - Filter that doesn't
                                                    match any HealthState value. Used in order to
                                                    return no results on a given collection of
                                                    states. The value is 1. - Ok - Filter that
                                                    matches input with HealthState value Ok. The
                                                    value is 2. - Warning - Filter that matches
                                                    input with HealthState value Warning. The value
                                                    is 4. - Error - Filter that matches input with
                                                    HealthState value Error. The value is 8. - All -
                                                    Filter that matches input with any HealthState value. The value is 65535.|
| --events-health-state-filter   | Позволяет отфильтровать коллекцию возвращаемых объектов HealthEvent на основе состояния работоспособности. Возможные значения для этого параметра — целочисленное значение одного из приведенных ниже состояний работоспособности. Возвращаются только те события, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все события. Если фильтр не указан, возвращаются все записи. Значения состояния представляют собой перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора "ИЛИ". Например, если указано значение 6, то возвращаются все события со значениями HealthState "ОК" (2) и "Warning" (4). -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю. -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1. -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2. -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning".
Значение равно 4. -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8. -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535.| | --exclude-health-statistics                   | Указывает, должна ли возвращаться статистика работоспособности в результате запроса. Значение по умолчанию: false. Статистика содержит число дочерних сущностей в состоянии работоспособности "Ok", "Warning" и "Error".| |   --include-system-application-health-statistics| Указывает, следует ли включать в статистику работоспособности сведения о приложении fabric:/System. Значение по умолчанию: false. Если для IncludeSystemApplicationHealthStatistics задано значение true, то статистика работоспособности включает в себя сущности, относящиеся к приложению fabric:/System. В противном случае результат запроса содержит только статистику работоспособности приложений пользователя. Для применения этого параметра в результат запроса должна быть включена статистика работоспособности.| | --nodes-health-state-filter    | Позволяет фильтровать объекты состояния работоспособности узла, возвращаемые в результате запроса работоспособности кластера, по состоянию работоспособности. Возможные значения для этого параметра — целочисленное значение одного из приведенных ниже состояний работоспособности. Возвращаются только те узлы, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все узлы. Если фильтр не указан, возвращаются все записи. Значения состояния представляют собой перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора "ИЛИ". Например, если указано значение 6, то возвращается состояние работоспособности узлов со значениями HealthState "ОК" (2) и "Warning" (4). -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю. -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1. -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2. -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning".
Значение равно 4. -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8. -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535.| | --timeout -t                            | Время ожидания сервера в секундах.  Значение по умолчанию: 60.|

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug                        | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
| --help -h                      | Отображение этого справочного сообщения и выход.|
| --output -o                    | Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.                    Значение по умолчанию: json.|
| --query                        | Строка запроса JMESPath. Дополнительные сведения и примеры доступны на сайте http://jmespath.org.|
| --verbose                      | Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные журналы отладки.|

## <a name="sfctl-cluster-manifest"></a>sfctl cluster manifest
Возвращает манифест кластера Service Fabric.

Возвращает манифест кластера Service Fabric. Манифест кластера содержит свойства кластера, которые включают в себя различные типы узлов в кластере, конфигурацию безопасности, топологии доменов сбоя и доменов обновления и т. д. Эти свойства определяются в файле ClusterConfig.JSON при развертывании изолированного кластера. Однако большая часть информации в манифесте кластера создается внутренними процессами Service Fabric во время развертывания кластера в других сценариях развертывания (например, при использовании [портала Azure](https://portal.azure.com)). Содержимое манифеста кластера является исключительно информационным, и пользователи не должны устанавливать зависимости от формата содержимого этого файла или его интерпретации. 

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --timeout -t| Время ожидания сервера в секундах.  Значение по умолчанию: 60.|

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug  | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
| --help -h| Отображение этого справочного сообщения и выход.|
| --output -o | Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.  Значение по умолчанию: json.|
| --query  | Строка запроса JMESPath. Дополнительные сведения и примеры доступны на сайте http://jmespath.org.|
| --verbose| Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные журналы отладки.|

## <a name="sfctl-cluster-provision"></a>sfctl cluster provision
Подготавливает пакеты кода или конфигурации кластера Service Fabric.

        Validate and provision the code or configuration packages of a Service Fabric cluster.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
|--cluster-manifest-file-path| Путь к файлу манифеста кластера.|
|    --code-file-path            | Путь к файлу пакета кода кластера.|
|    --timeout -t                | Время ожидания сервера в секундах.  Значение по умолчанию: 60.|

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
| --help -h  | Отображение этого справочного сообщения и выход.|
| --output -o| Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.  Значение по умолчанию: json.|
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры доступны на сайте http://jmespath.org.|
| --verbose  | Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные журналы отладки.|

## <a name="sfctl-cluster-select"></a>sfctl cluster select
Выполняет подключение к конечной точке кластера Service Fabric.

При подключении к защищенному кластеру укажите сертификат (CRT-файл) и файл ключа (KEY-файл) или отдельный файл, содержащий сертификат и ключ (PEM-файл). Не указывайте и то, и другое. При необходимости при подключении к защищенному кластеру укажите также путь к файлу пакета ЦС или каталогу сертификатов доверенного ЦС.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --endpoint [обязательный параметр]| URL-адрес конечной точки кластера, включая порт и префикс HTTP или HTTPS.|
| --aad             | Использование аутентификации Azure Active Directory.|
| --ca              | Путь к каталогу сертификатов ЦС, которые следует считать действительными, или путь к файлу пакета ЦС.|
| --cert            | Путь к файлу сертификата клиента.|
| --key             | Путь к файлу ключа сертификата клиента.|
| --no-verify       | Отключает проверку сертификатов при использовании HTTPS. Примечание. Это небезопасный параметр, и он не должен использоваться для рабочей среды.|
| --pem             | Путь к PEM-файлу сертификата клиента.|

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug           | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
| --help -h         | Отображение этого справочного сообщения и выход.|
| --output -o       | Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.  Значение по умолчанию: json.|
| --query           | Строка запроса JMESPath. Дополнительные сведения и примеры доступны на сайте http://jmespath.org.|
| --verbose         | Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные журналы отладки.|

## <a name="sfctl-cluster-unprovision"></a>sfctl cluster unprovision
Отменяет подготовку пакетов кода или конфигурации кластера Service Fabric.

        Unprovision the code or configuration packages of a Service Fabric cluster.

### <a name="arguments"></a>Аргументы
|Аргумент|Описание|
| --- | --- |
|--code-version  | Версия пакета кода кластера.|
|    --config-version| Версия манифеста кластера.|
|    --timeout -t    | Время ожидания сервера в секундах.  Значение по умолчанию: 60.|

### <a name="global-arguments"></a>Глобальные аргументы
|Аргумент|Описание|
| --- | --- |
|--debug         | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
 |   --help -h       | Отображение этого справочного сообщения и выход.|
 |   --output -o     | Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.  Значение по умолчанию: json.|
 |   --query         | Строка запроса JMESPath. Дополнительные сведения и примеры доступны на сайте
                      http://jmespath.org.|
 |   --verbose       | Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные журналы отладки.|


## <a name="sfctl-cluster-upgrade"></a>sfctl cluster upgrade
Запускает обновление пакетов кода или конфигурации кластера Service Fabric.

        Validate the supplied upgrade parameters and start upgrading the code or configuration
        version of a Service Fabric cluster if the parameters are valid.

### <a name="arguments"></a>Аргументы
|Аргумент|Описание|
| --- | --- |
|    --app-health-map                      | Словарь в формате JSON, содержащий пары из имени приложения и максимального процента
                                            неработоспособности, по достижении которого порождается ошибка.|
 |   --app-type-health-map                 | Словарь в формате JSON, содержащий пары из имени приложения и максимального процента неработоспособности, по достижении которого порождается ошибка.
                                            name and maximum percentage unhealthy before raising
                                            error.|
 |   --code-version                        | Версия кода кластера.| |   --config-version                      |  Версия конфигурации кластера.| |   --delta-health-evaluation             | Включает разностную оценку работоспособности вместо абсолютной оценки работоспособности после завершения выполнения каждого домена обновления.| |   --delta-unhealthy-nodes               | Максимальный процент неработоспособных узлов, допускаемый во время обновления кластера.  Значение по умолчанию — 10.
Разница измеряется между состоянием узлов в начале обновления и во время оценки работоспособности. Проверка выполняется после завершения обновления каждым доменом обновления, чтобы обеспечить глобальное состояние кластера в допустимых пределах.| |   --failure-action                      | Возможные значения: "Invalid", "Rollback", "Manual".| |   --force-restart                       | Принудительная перезагрузка.| |   --health-check-retry                  | Время ожидания повтора проверки работоспособности в миллисекундах.| |   --health-check-stable                 | Длительность стабильной проверки работоспособности в миллисекундах.| |  --health-check-wait                   | Время ожидания проверки работоспособности в миллисекундах.| |  --replica-set-check-timeout           | Время ожидания проверки обновления набора реплик в секундах.| |   --rolling-upgrade-mode                | Возможные значения: "Invalid", "UnmonitoredAuto", "UnmonitoredManual", "Monitored".  Значение по умолчанию: UnmonitoredAuto.| |  --timeout -t                          | Время ожидания сервера в секундах.  Значение по умолчанию: 60.| |  --unhealthy-applications              | Максимально допустимый процент неработоспособных приложений, по достижении которого отображается сообщение об ошибке.
Например, чтобы разрешить 10 % неработоспособных приложений, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных приложений, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере одно неработоспособное приложение, то состояние работоспособности оценивается как "Warning". Это значение вычисляется путем деления числа неработоспособных приложений на общее число экземпляров приложения в кластере, за исключением приложений, типы которых указаны в ApplicationTypeHealthPolicyMap. При вычислении выполняется округление, позволяющее допустить один сбой при небольшом количестве приложений.| |   --unhealthy-nodes                     | Максимально допустимый процент неработоспособных узлов, по достижении которого отображается сообщение об ошибке.
Например, чтобы разрешить 10 % неработоспособных узлов, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных узлов, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере один неработоспособный узел, то состояние работоспособности оценивается как "Warning". Это процентное значение вычисляется путем деления числа неработоспособных узлов за общее число узлов в кластере. Расчет округляется: на небольшом количестве узлов допускается один сбой. В больших кластерах некоторые узлы всегда будут неработоспособны или недоступны из-за операций восстановления, поэтому нужно настроить данное процентное значение, чтобы допустить это.| |   --upgrade-domain-delta-unhealthy-nodes| Максимально допустимый процент неработоспособных узлов домена обновления во время обновления кластера.
Значение по умолчанию: 15.
Разница измеряется между состоянием узлов домена обновления в начале обновления и во время оценки работоспособности. Проверка выполняется после завершения обновления каждым доменом обновления для всех доменов обновления, завершивших обновление, чтобы убедиться, что состояние доменов обновления находится в допустимых пределах.| |   --upgrade-domain-timeout              | Время ожидания домена обновления в миллисекундах.| |   --upgrade-timeout                     | Время ожидания обновления в миллисекундах.| |   --warning-as-error                    | Предупреждения учитываются с той же степенью серьезности, что и ошибки.|

### <a name="global-arguments"></a>Глобальные аргументы
    |Аргумент|Описание|
| --- | --- |
|--debug                               | Увеличение уровня детализации ведения журнала для отображения всех журналов отладки.|
|    --help -h                             | Отображение этого справочного сообщения и выход.|
|    --output -o                           | Формат выходных данных.  Допустимые значения: json, jsonc, table, tsv.
                                            Значение по умолчанию: json.|
|    --query                               | Строка запроса JMESPath. Дополнительные сведения и примеры
                                            доступны на сайте http://jmespath.org.|
|    --verbose                             | Повышение уровня детализации ведения журнала. Используйте параметр --debug, чтобы получить полные
                                            журналы отладки.|

## <a name="next-steps"></a>Дальнейшие действия
- [Настройте](service-fabric-cli.md) интерфейс командной строки Service Fabric.
- Узнайте, как использовать интерфейс командной строки Service Fabric, с помощью [примеров сценариев](/azure/service-fabric/scripts/sfctl-upgrade-application).
