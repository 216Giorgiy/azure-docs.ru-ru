<properties
   pageTitle="Учебник по обновлению приложения Service Fabric | Microsoft Azure"
   description="В этой статье рассматривается процесс развертывания приложения Service Fabric, изменения кода и развертывания обновления с помощью Visual Studio."
   services="service-fabric"
   documentationCenter=".net"
   authors="mani-ramaswamy"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="07/17/2015"
   ms.author="subramar"/>



# Учебник по обновлению приложений Service Fabric с помощью Visual Studio

Service Fabric упрощает процесс обновления облачных приложений за счет того, что обновляются только измененные службы, кроме того, в процессе обновления отслеживается работоспособность приложения, и при обнаружении проблем автоматически выполняется откат к предыдущей версии приложения. Обновление приложений Service Fabric выполняется *без времени простоя*. В этом учебнике описывается развертывание простого обновления из Visual Studio.


## Шаг 1. Построение и публикация примера приложения Visual Objects

Эти шаги можно выполнить путем загрузки приложения из github и добавления файлов **webgl utils.js** и **gl-matrix-min.js** в проект, как указано в файле сведений примера. Без выполнения этого шага приложение работать не будет. Добавив эти элементы в проект, создайте и опубликуйте приложение, щелкнув правой кнопкой мыши проект приложения **VisualObjectsApplication** и выбрав команду публикации в меню Service Fabric следующим образом.

![Контекстное меню для приложения Service Fabric][image1]

Появится другое всплывающее окно, в котором вы можете задать значение **Локальный кластер** для параметра **Конечная точка подключения**. Окно должно выглядеть следующим образом, прежде чем вы нажмете кнопку **Опубликовать**.

![Публикация приложения Service Fabric][image2]

Теперь в диалоговом окне можно нажать кнопку публикации. Для просмотра кластера и приложения теперь можно использовать [обозреватель Service Fabric](service-fabric-visualizing-your-cluster.md). Приложение Visual Objects включает веб-службу, к которой можно перейти в браузере, указав в адресной строке адрес [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects). Вы сможете увидеть десять плавающих визуальных объектов, перемещающихся по экрану.

## Шаг 2. Обновление образца визуальных объектов

Вы можете заметить, что в версии, развернутой на шаге 1, визуальные объекты не вращаются. Давайте обновим это приложение до версии, в которой визуальные объекты будут вращаться.

Выберите проект VisualObjects.ActorService в решении VisualObjects и откройте файл StatefulVisualObjectActor.cs. В этом файле перейдите к методу `MoveObject`, а затем закомментируйте `this.State.Move()` и раскомментируйте `this.State.Move(true)`. Это изменение заставит объекты вращаться после обновления службы. Теперь можно построить (не перестроить) решение, что приведет к сборке измененных проектов (если выбрать пункт "Перестроить все", потребуется обновить версии для всех проектов).

Необходимо также задать версию приложения. Чтобы изменить версию приложения, в Visual Studio можно щелкнуть решение правой кнопкой мыши и выбрать пункт меню **Изменить файлы манифеста**. Откроется диалоговое окно версий выпуска:

![Диалоговое окно "Управление версиями"][image3]

Перейдите на вкладку **Изменение версий манифеста** и обновите версии для измененных проектов, соответствующих пакетов кода и приложения до версии 2.0.0. После внесения изменений манифест должен выглядеть следующим образом (полужирным шрифтом выделены измененные части):

![Обновление версий][image4]

Инструменты Visual Studio могут осуществлять автоматическое развертывание версий (при выборе пункта **Автоматически обновлять версии приложения и службы**). При использовании [SemVer](http://www.semver.org) вам потребуется обновлять только версию кода и (или) пакета конфигурации, если выбран этот параметр. Сохраните изменения и установите флажок **Обновить приложение**.


## Шаг 3. Обновление приложения

Ознакомьтесь с [параметрами обновления приложений](service-fabric-application-upgrade-parameters.md) и [процессом обновления](service-fabric-application-upgrade.md) для лучшего понимания различных параметров обновления, значений времени ожидания и применяемых критериев. В этом пошаговом руководстве мы оставим значение критерия оценки работоспособности по умолчанию (неотслеживаемый режим). Это значение можно установить, выбрав пункт **Настроить параметры обновления** и изменив параметры по мере необходимости.

Теперь у нас все готово к тому, чтобы запустить обновление приложения нажатием кнопки **Опубликовать**. В результате приложение будет обновлено до версии 2.0.0, в которой объекты вращаются. Вы увидите, что Service Fabric обновляет один домен обновления за раз (некоторые объекты будут обновлены первыми, другие — позже) и что служба доступна в течение этого времени через клиент (браузер).


По мере обновления приложения этот процесс можно отслеживать с помощью обозревателя Service Fabric (вкладка **Выполняемые обновления** в разделе приложений).

Через несколько минут должны быть обновлены все домены обновления, и в окне выходных данных Visual Studio также должно появиться сообщение о том, что обновление выполнено. Кроме того, вы должны увидеть, что *все* визуальные объекты в окне браузера начали вращаться.

Вы можете попробовать изменить версии и перейти от версии 2.0.0 к версии 3.0.0 в качестве упражнения или даже от версии 2.0.0 назад к версии 1.0.0. Измените значения времени ожидания и политики работоспособности в качестве тренировки. При развертывании в кластере Azure используемые параметры будут отличаться от тех, которые применялись при развертывании в локальном кластере. Рекомендуется использовать консервативный подход при установке значений времени ожидания.


## Дальнейшие действия

Пошаговое руководство [Обновление приложения с помощью PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) поможет вам выполнить обновление приложения с помощью PowerShell.

Управление обновлениями приложения осуществляется с помощью [параметров обновления](service-fabric-application-upgrade-parameters.md).

Узнайте, как использовать [сериализацию данных](service-fabric-application-upgrade-data-serialization.md), чтобы обеспечить совместимость обновлений приложения.

[Дополнительные разделы](service-fabric-application-upgrade-advanced.md) содержат сведения о работе с расширенными функциями при обновлении приложения.

Сведения об устранении распространенных проблем при обновлении приложений см. в разделе [Устранение неполадок обновления приложения](service-fabric-application-upgrade-troubleshooting.md).
 


[image1]: media/service-fabric-application-upgrade-tutorial/upgrade7.png
[image2]: media/service-fabric-application-upgrade-tutorial/upgrade1.png
[image3]: media/service-fabric-application-upgrade-tutorial/upgrade5.png
[image4]: media/service-fabric-application-upgrade-tutorial/upgrade6.png

<!---HONumber=Nov15_HO4-->