<properties
   pageTitle="Защита кластера, работающего под управлением Windows, с помощью системы безопасности Windows | Microsoft Azure"
   description="Узнайте, как настроить безопасность обмена данными между узлами или между клиентом и узлом в автономном кластере, работающем под управлением Windows, с помощью системы безопасности Windows."
   services="service-fabric"
   documentationCenter=".net"
   authors="rwike77"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/25/2016"
   ms.author="ryanwi"/>


# Защита автономного кластера под управлением Windows с помощью системы безопасности Windows

Во избежание несанкционированного доступа к кластеру Service Fabric следует защитить его, особенно если на нем выполняются рабочие нагрузки. В этой статье описывается, как настроить безопасность обмена данными между узлами, а также между клиентом и узлом с помощью системы безопасности Windows в файле *ClusterConfig.JSON*. Это соответствует шагу по настройке безопасности в статье о [создании автономного кластера, работающего под управлением Windows](service-fabric-cluster-creation-for-windows-server.md). Дополнительные сведения об использовании системы безопасности Windows в Service Fabric см. в разделе [Сценарии обеспечения безопасности кластера](service-fabric-cluster-security.md).

>[AZURE.NOTE]
Выбирать вариант безопасности для защиты обмена данными между узлами следует тщательно, так как один вариант безопасности кластера нельзя обновить до другого. Чтобы изменить вариант безопасности, необходимо перестроить весь кластер.

## Настройка безопасности Windows
В примере файла конфигурации *ClusterConfig.Windows.JSON*, скачанном с пакетом автономного кластера [Microsoft.Azure.ServiceFabric.WindowsServer.<версия>.zip](http://go.microsoft.com/fwlink/?LinkId=730690), содержится шаблон для настройки безопасности Windows. Безопасность Windows настраивается в разделе **Properties**.

```
"security": {
            "ClusterCredentialType": "Windows",
            "ServerCredentialType": "Windows",
            "WindowsIdentities": {
		"ClusterIdentity" : "[domain\machinegroup]",
                "ClientIdentities": [{
                    "Identity": "[domain\username]",
                    "IsAdmin": true
                }]
            }
        }
```

|**Параметр конфигурации**|**Описание**|
|-----------------------|--------------------------|
|ClusterCredentialType|Безопасность Windows можно включить, задав для параметра **ClusterCredentialType** значение *Windows*.|
|ServerCredentialType|Безопасность Windows для клиентов можно включить, задав для параметра **ServerCredentialType** значение *Windows*. Это указывает, что клиенты кластера и сам кластер работают внутри домена Active Directory.|
|WindowsIdentities|Содержит удостоверения кластера и клиента.|
|ClusterIdentity|Настраивает безопасность обмена данными между узлами. Список групповых управляемых учетных записей служб или имен компьютеров через запятую.|
|ClientIdentities|Настраивает безопасность обмена данными между клиентами и узлами. Массив учетных записей клиентов.|
|Удостоверение|Удостоверение клиента, пользователь домена.|
|IsAdmin|Значение true указывает, что у пользователя домена есть клиентский доступ с правами администратора, а значение false — клиентский доступ с правами пользователя.|

[Безопасность обмена данными между узлами](service-fabric-cluster-security.md#node-to-node-security) настраивается с помощью параметра **ClusterIdentity**. Чтобы создать отношения доверия между узлами, им нужно сообщить друг о друге. Это можно сделать двумя разными способами: указав групповую управляемую учетную запись, которая включает все узлы в кластере, или удостоверения всех узлов домена в кластере. Настоятельно рекомендуем применять подход с использованием [групповой управляемой учетной записи службы](https://technet.microsoft.com/library/hh831782.aspx), в частности для больших кластеров (более 10 узлов) или для кластеров, размер которых может изменяться. При этом подходе можно добавлять узлы в групповую управляемую учетную запись службы или удалять их оттуда, не изменяя манифест кластера. Кроме того, этот подход не требует создания группы домена, администраторам кластера которой были предоставлены права доступа для добавления и удаления участников. Дополнительные сведения см. в статье [Getting Started with Group Managed Service Accounts](http://technet.microsoft.com/library/jj128431.aspx) (Приступая к работе с групповыми управляемыми учетными записями служб).

[Безопасность обмена данными между клиентом и узлом](service-fabric-cluster-security.md#client-to-node-security) настраивается с помощью параметра **ClientIdentities**. Чтобы установить отношение доверия между клиентом и кластером, необходимо настроить кластер таким образом, чтобы ему были известны удостоверения клиентов, которым можно доверять. Это можно сделать двумя разными способами: указав пользователей группы домена или узла домена, которые могут подключаться. Service Fabric поддерживает два разных типа контроля доступа для клиентов, подключенных к кластеру Service Fabric: администраторский и пользовательский. Благодаря контролю доступа администратор кластера может ограничить доступ разных групп пользователей на выполнение определенных типов операций в кластере, повысив тем самым уровень безопасности кластера. Администраторы имеют полный доступ к возможностям управления (включая возможности чтения и записи). Пользователи по умолчанию имеют доступ только на чтение для управления (например, при работе с запросами) и возможность разрешения приложений и служб.

В следующем примере раздела **security** настраивается безопасность Windows и указывается, что компьютеры в *ServiceFabric/clusterA.contoso.com* — это часть кластера, а также что у *CONTOSO\\usera* есть клиентский доступ с правами администратора.

```
"security": {
    "ClusterCredentialType": "Windows",
    "ServerCredentialType": "Windows",
    "WindowsIdentities": {
		"ClusterIdentity" : "ServiceFabric/clusterA.contoso.com",
        "ClientIdentities": [{
            "Identity": "CONTOSO\\usera",
        "IsAdmin": true
        }]
    }
},
```

## Дальнейшие действия

После настройки безопасности Windows в файле *ClusterConfig.JSON* возобновите процесс создания кластера, который описан в разделе [Создание кластера под управлением Windows Server и управление им](service-fabric-cluster-creation-for-windows-server.md).

Дополнительные сведения о безопасности обмена данными между узлами, между клиентом и узлом и об управлении доступом на основе ролей см. в разделе [Сценарии защиты кластера Service Fabric](service-fabric-cluster-security.md).

Примеры подключений с помощью PowerShell или FabricClient см. в статье [Безопасное подключение к кластеру](service-fabric-connect-to-secure-cluster.md).

<!---HONumber=AcomDC_0831_2016-->