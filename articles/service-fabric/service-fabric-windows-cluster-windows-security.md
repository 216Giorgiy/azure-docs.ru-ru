---
title: "Защита кластера, работающего под управлением Windows, с помощью системы безопасности Windows | Документация Майкрософт"
description: "Узнайте, как настроить безопасность обмена данными между узлами или между клиентом и узлом в изолированном кластере, работающем под управлением Windows, с помощью системы безопасности Windows."
services: service-fabric
documentationcenter: .net
author: rwike77
manager: timlt
editor: 
ms.assetid: ce3bf686-ffc4-452f-b15a-3c812aa9e672
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 01/17/2017
ms.author: ryanwi
translationtype: Human Translation
ms.sourcegitcommit: a087df444c5c88ee1dbcf8eb18abf883549a9024
ms.openlocfilehash: 6294a6fac8748f70c807df76feb425cb627bf4c3
ms.lasthandoff: 03/15/2017


---
# <a name="secure-a-standalone-cluster-on-windows-by-using-windows-security"></a>Защита изолированного кластера под управлением Windows с помощью системы безопасности Windows
Чтобы предотвратить несанкционированный доступ к кластеру Service Fabric, его необходимо защитить. Безопасность особенно важна при выполнении в кластере производственных рабочих нагрузок. В этой статье описывается, как настроить безопасность обмена данными между узлами или между клиентом и узлом с помощью системы безопасности Windows и файла *ClusterConfig.JSON*.  Описываемый процесс соответствует шагу по настройке безопасности из раздела [Создание изолированного кластера под управлением Windows Server](service-fabric-cluster-creation-for-windows-server.md). Дополнительные сведения об использовании системы безопасности Windows в Service Fabric см. в статье [Сценарии защиты кластера Service Fabric](service-fabric-cluster-security.md).

> [!NOTE]
> Выбирать способ защиты обмена данными между узлами следует внимательно, так как один способ защиты кластера невозможно будет сменить на другой. Чтобы изменить способ защиты, потребуется заново создать весь кластер.
>
>

## <a name="configure-windows-security"></a>Настройка безопасности Windows  
В примере файла конфигурации *ClusterConfig.Windows.JSON*, скачанном с пакетом изолированного кластера [Microsoft.Azure.ServiceFabric.WindowsServer<version>.zip](http://go.microsoft.com/fwlink/?LinkId=730690), содержится шаблон для настройки системы безопасности Windows. Безопасность Windows настраивается в разделе **Properties** .

```
"security": {
            "ClusterCredentialType": "Windows",
            "ServerCredentialType": "Windows",
            "WindowsIdentities": {
                "ClusterIdentity" : "[domain\machinegroup]",
                "ClientIdentities": [{
                    "Identity": "[domain\username]",
                    "IsAdmin": true
                }]
            }
        }
```

| **Параметр конфигурации** | **Описание** |
| --- | --- |
| ClusterCredentialType |Задайте значение *Windows*, чтобы включить систему безопасности Windows. |
| ServerCredentialType |Задайте значение *Windows*, чтобы включить систему безопасности Windows для клиентов.<br /><br />Это указывает, что клиенты кластера и сам кластер работают внутри домена Active Directory. |  
| WindowsIdentities |Содержит удостоверения кластера и клиента. |  
| ClusterIdentity |Используйте имя группы компьютеров "домен\группа_компьютеров", чтобы настроить защиту обмена данными между узлами. |  
| ClientIdentities |Настраивает безопасность обмена данными между клиентами и узлами. Массив учетных записей клиентов. |  
| Удостоверение |Добавьте пользователя домена "домен\имя_пользователя" для удостоверения клиента. |  
| IsAdmin |Задайте значение true, чтобы указать, что у пользователя домена есть клиентский доступ с правами администратора, или значение false, чтобы указать наличие клиентского доступа с правами пользователя. |  

[Защиту обмена данными между узлами](service-fabric-cluster-security.md#node-to-node-security) можно настроить с помощью параметра **ClusterIdentity**. Чтобы создать отношения доверия между узлами, им нужно предоставить информацию друг о друге. Это можно сделать, создав группу домена, содержащую все узлы в кластере. Имя этой группы необходимо указать в параметре **ClusterIdentity**. Дополнительные сведения см. в статье [How to Create a Group in Active Directory](https://msdn.microsoft.com/library/aa545347(v=cs.70).aspx) (Как создать группу в Active Directory).  

[Защиту обмена данными между клиентом и узлом](service-fabric-cluster-security.md#client-to-node-security) можно настроить с помощью параметра **ClientIdentities**. Чтобы установить отношения доверия между клиентом и кластером, необходимо настроить кластер таким образом, чтобы ему были известны удостоверения клиентов, которым можно доверять. Установить отношения доверия можно двумя разными способами:

- указать пользователей группы домена, которые могут подключаться;
- указать пользователей узла домена, которые могут подключаться.

Service Fabric поддерживает два разных типа контроля доступа для клиентов, подключенных к кластеру Service Fabric: администраторский и пользовательский. Благодаря контролю доступа администратор кластера может ограничить доступ разных групп пользователей к операциям определенных типов в кластере, повысив тем самым уровень его безопасности.  Администраторы имеют полный доступ к возможностям управления (включая возможности чтения и записи). Пользователи по умолчанию имеют доступ только на чтение для управления (например, при работе с запросами) и возможность разрешения приложений и служб.  

В следующем примере раздела **security** настраивается система безопасности Windows и указывается, что компьютеры в *ServiceFabric/clusterA.contoso.com* — это часть кластера, а также что у *CONTOSO\usera* есть клиентский доступ с правами администратора.

```
"security": {
    "ClusterCredentialType": "Windows",
    "ServerCredentialType": "Windows",
    "WindowsIdentities": {
        "ClusterIdentity" : "ServiceFabric/clusterA.contoso.com",
        "ClientIdentities": [{
            "Identity": "CONTOSO\\usera",
            "IsAdmin": true
        }]
    }
},
```

> [!NOTE]
> Службу Service Fabric не нужно развертывать на контроллере домена. Убедитесь, что ClusterConfig.json не содержит IP-адрес контроллера домена, если вы используете группы компьютеров или группу управляемых учетных записей службы (gMSA).
>
>

## <a name="next-steps"></a>Дальнейшие действия
После настройки безопасности Windows в файле *ClusterConfig.JSON* возобновите процесс создания кластера, который описан в разделе [Создание кластера под управлением Windows Server и управление им](service-fabric-cluster-creation-for-windows-server.md).

Дополнительные сведения о защите обмена данными между узлами, между клиентом и узлом и об управлении доступом на основе ролей см. в статье [Сценарии защиты кластера Service Fabric](service-fabric-cluster-security.md).

Примеры подключений с помощью PowerShell или FabricClient см. в статье [Безопасное подключение к кластеру без AAD](service-fabric-connect-to-secure-cluster.md).

