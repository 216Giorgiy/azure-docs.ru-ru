---
title: "Диспетчер кластерных ресурсов Service Fabric: стоимость перемещения | Документация Майкрософт"
description: "Общие сведения о стоимости перемещения служб Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: f022f258-7bc0-4db4-aa85-8c6c8344da32
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/19/2016
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: 219dcbfdca145bedb570eb9ef747ee00cc0342eb
ms.openlocfilehash: 54cdfee64360543e0d1011f04c9b79400e912582


---
# <a name="service-movement-cost-for-influencing-cluster-resource-manager-choices"></a>Влияние стоимости перемещения службы на выбор диспетчера кластерных ресурсов
Важным фактором, который принимаемым во внимание при попытке определить, какие изменения вносить в кластер и как оценить данное решения, является общая стоимость реализации этого решения.

Как минимум перемещение экземпляров службы или реплик требует затрат процессорного времени и пропускной способности сети. Для служб с отслеживанием состояния также оплачивается объем пространства на диске, необходимый для создания копии состояния перед завершением работы старых реплик. Разумеется, нужно свести к минимуму затраты на любое решение, представленное диспетчером кластерных ресурсов Azure Service Fabric. Но при этом не хотелось бы игнорировать решения, которые могли бы значительно улучшить распределение ресурсов кластера.

В диспетчере кластерных ресурсов есть два способа вычисления затрат и их ограничения, применяемых даже при попытке управлять кластером в соответствии с другими его целями. Во-первых, когда диспетчер кластерных ресурсов планирует новый макет для кластера, он подсчитывает каждое действие, которое потребуется выполнить. В самом простом случае, если вы получите два решения примерно с одинаковым общим балансом (оценкой), то сможете просто выбрать решение с наиболее низкими затратами (общим числом перемещений).

Этот метод превосходно работает. Но, как и в случае нагрузок по умолчанию или статических нагрузок, маловероятно, что в любой сложной системе все будут перемещения равнозначны. Некоторые могут быть намного более затратными.

## <a name="changing-a-replicas-move-cost-and-factors-to-consider"></a>Изменение стоимости перемещения реплики и факторы, которые следует учитывать
Как и при создании отчетов о нагрузке (еще одна функция диспетчера кластерных ресурсов), вы предоставляете службе возможность самостоятельно сообщать о том, насколько затратно ее перемещать в определенный момент времени.

Код:

```csharp
this.ServicePartition.ReportMoveCost(MoveCost.Medium);
```

MoveCost имеет четыре уровня: Zero, Low, Medium и High. Все эти уровни определены относительно друг друга, кроме уровня Zero. Zero означает, что перемещение реплики бесплатно и не должно учитываться при оценке решения. Если настроить стоимость перемещения High, это *не* гарантирует, что реплика не будет перемещена. Просто она не будет перемещена без веской причины.

![Влияние стоимости перемещения на выбор реплик для перемещения.][Image1]

Параметр MoveCost помогает найти решения, которые в целом приводят к меньшему прерыванию работы и позволяют легче достичь равноценного баланса. Понятие стоимости службы может зависеть от многих факторов. Ниже перечислены наиболее распространенные факторы, учитываемые при вычислении стоимости перемещения.

* Объем данных состояния или информации, перемещаемой для службы.
* Стоимость отключения клиентов. Стоимость перемещения первичной реплики будет выше, чем стоимость перемещения вторичной реплики.
* Стоимость прерывания текущих операций. Некоторые операции уровня хранилища данных или операции, выполняемые по вызову клиента, являются дорогостоящими. После определенного момента вы не станете останавливать их, если только это не вынужденная мера. Поэтому во время эксплуатации вы увеличиваете стоимость, чтобы уменьшить вероятность перемещения реплики или экземпляра службы. А после завершения операции восстанавливаете ее обычное значение.

## <a name="next-steps"></a>Дальнейшие действия
* С помощью метрик диспетчер кластерных ресурсов Service Fabric управляет потреблением и емкостью в кластере. Чтобы узнать больше о метрик и их настройке, ознакомьтесь с разделом [Управление потреблением ресурсов и нагрузкой в Service Fabric с помощью метрик](service-fabric-cluster-resource-manager-metrics.md).
* Чтобы узнать, как диспетчер кластерных ресурсов управляет нагрузкой кластера и балансирует ее, ознакомьтесь со статьей [Балансировка кластера Service Fabric](service-fabric-cluster-resource-manager-balancing.md).

[Image1]:./media/service-fabric-cluster-resource-manager-movement-cost/service-most-cost-example.png



<!--HONumber=Nov16_HO3-->


