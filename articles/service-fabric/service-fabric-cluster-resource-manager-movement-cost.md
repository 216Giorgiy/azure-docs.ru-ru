---
title: "Диспетчер кластерных ресурсов Service Fabric: стоимость перемещения | Документация Майкрософт"
description: "Общие сведения о стоимости перемещения служб Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: f022f258-7bc0-4db4-aa85-8c6c8344da32
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 01/05/2017
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: dafaf29b6827a6f1c043af3d6bfe62d480d31ad5
ms.openlocfilehash: f85365a36aea39b4179805e728c7ddafa140f08b


---
# <a name="service-movement-cost-for-influencing-cluster-resource-manager-choices"></a>Влияние стоимости перемещения службы на выбор диспетчера кластерных ресурсов
Важным фактором, который диспетчер кластерных ресурсов Service Fabric принимает во внимание при попытке определить, какие изменения вносить в кластер, является общая стоимость реализации этого решения. Понятие стоимости компромиссно по отношению к оптимальному балансу, которого можно достичь.

Как минимум перемещение экземпляров службы или реплик требует затрат процессорного времени и пропускной способности сети. Для служб с отслеживанием состояния также оплачивается объем пространства на диске и в памяти, необходимый для создания копии состояния перед завершением работы старых реплик. Разумеется, нужно свести к минимуму затраты на любое решение, представленное диспетчером кластерных ресурсов Azure Service Fabric. Но при этом не хотелось бы игнорировать решения, которые могли бы значительно улучшить распределение ресурсов кластера.

В диспетчере кластерных ресурсов есть два способа вычисления затрат и их ограничения, применяемых даже при попытке управлять кластером в соответствии с другими его целями. Во-первых, когда диспетчер кластерных ресурсов планирует новый макет для кластера, он подсчитывает каждое действие, которое потребуется выполнить. Если создано два решения примерно с одинаковым общим балансом (оценкой), выберите более дешевое решение (общее число ходов).

Эта стратегия хорошо работает. Но, как и в случае нагрузок по умолчанию или статических нагрузок, маловероятно, что в любой сложной системе все будут перемещения равнозначны. Некоторые могут быть намного более затратными.

## <a name="changing-a-replicas-move-cost-and-factors-to-consider"></a>Изменение стоимости перемещения реплики и факторы, которые следует учитывать
Как и при создании отчетов о нагрузке (еще одна функция диспетчера кластерных ресурсов), службы в любое время имеют возможность самостоятельно сообщать о том, насколько затратно их перемещать.

Код:

```csharp
this.ServicePartition.ReportMoveCost(MoveCost.Medium);
```

При создании службы также можно указать стоимость перемещения по умолчанию.

MoveCost имеет четыре уровня: Zero, Low, Medium и High. MoveCosts определены относительно друг друга, кроме уровня Zero. Стоимость перемещения Zero означает, что перемещение является бесплатным и не должно учитываться при оценке решения. Если настроить стоимость перемещения High, это *не* гарантирует, что реплика не будет перемещена.

<center>
![Влияние стоимости перемещения на выбор реплик для перемещения][Image1]
</center>

Параметр MoveCost помогает найти решения, которые в целом приводят к меньшему прерыванию работы и позволяют легче достичь равноценного баланса. Понятие стоимости службы может зависеть от многих факторов. Ниже перечислены наиболее распространенные факторы, учитываемые при вычислении стоимости перемещения.

* Объем данных состояния или информации, перемещаемой для службы.
* Стоимость отключения клиентов. Стоимость перемещения первичной реплики будет выше, чем стоимость перемещения вторичной реплики.
* Стоимость прерывания текущих операций. Некоторые операции уровня хранилища данных или операции, выполняемые по вызову клиента, являются дорогостоящими. После определенного момента вы не станете останавливать их, если только это не вынужденная мера. Поэтому пока происходит операция, увеличьте стоимость перемещения этого объекта службы, чтобы снизить вероятность его перемещения. А после завершения операции восстановите обычное значение стоимости перемещения.

## <a name="next-steps"></a>Дальнейшие действия
* С помощью метрик диспетчер кластерных ресурсов Service Fabric управляет потреблением и емкостью в кластере. Чтобы узнать больше о метрик и их настройке, ознакомьтесь с разделом [Управление потреблением ресурсов и нагрузкой в Service Fabric с помощью метрик](service-fabric-cluster-resource-manager-metrics.md).
* Чтобы узнать, как диспетчер кластерных ресурсов управляет нагрузкой кластера и балансирует ее, ознакомьтесь со статьей [Балансировка кластера Service Fabric](service-fabric-cluster-resource-manager-balancing.md).

[Image1]:./media/service-fabric-cluster-resource-manager-movement-cost/service-most-cost-example.png



<!--HONumber=Jan17_HO1-->


