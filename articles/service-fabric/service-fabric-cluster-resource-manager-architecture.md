---
title: "Архитектура диспетчера ресурсов | Документация Майкрософт"
description: "Общие сведения об архитектуре диспетчера кластерных ресурсов Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 6c4421f9-834b-450c-939f-1cb4ff456b9b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 01/05/2017
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: dafaf29b6827a6f1c043af3d6bfe62d480d31ad5
ms.openlocfilehash: 67f07bad8f6f89d9e5e68326f0cc194d920e841b


---
# <a name="cluster-resource-manager-architecture-overview"></a>Общие сведения об архитектуре диспетчера кластерных ресурсов
Для управления ресурсами в кластере диспетчеру кластерных ресурсов Service Fabric нужна определенная информация. Он должен знать, какие службы в нем существуют и какой объем ресурсов эти службы используют на данный момент (или по умолчанию). Чтобы отслеживать доступные ресурсы кластера, он должен знать емкость узлов в кластере и объем ресурсов, потребляемых на каждом из них. В разное время одна и та же служба может использовать разный объем ресурсов, при этом службы обычно зависят от нескольких типов ресурсов. В разных службах могут учитываться как реальные физические, так и логические ресурсы. Например, службы контролируют такие физические показатели, как потребление памяти и места на диске. Но еще чаще их интересуют логические метрики, например WorkQueueDepth (Длина очереди заданий) или TotalRequests (Общее количество запросов). Как логическими, так и физическими метриками могут широко пользоваться самые разные виды служб. А какие-то метрики могут быть доступны только для нескольких определенных служб.

## <a name="other-considerations"></a>Дополнительные рекомендации
Иногда службы создаются не теми же людьми, которые управляют кластером. Если же это один человек, то он выступает здесь в разных ролях. У разработчика службы есть некоторое представление о том, какие ресурсы для нее потребуются и как нужно разместить компоненты этой службы. Но у сотрудника, который должен реагировать на инцидент с объектом, на котором работает эта служба, будут совсем другие приоритеты и ему нужны другие инструменты. Кроме того, конфигурация кластера и службы не является статической:

* количество узлов в кластере может увеличиваться и уменьшаться;
* могут добавляться и исчезать узлы различных размеров и типов;
* службы могут создаваться и изменяться, а также для них меняются потребности в ресурсах;
* кластер может обновляться и подвергаться другим операциям управления, и в любой момент могут происходить сбои.

## <a name="cluster-resource-manager-components-and-data-flow"></a>Компоненты и поток данных диспетчера кластерных ресурсов
Диспетчер кластерных ресурсов должен отслеживать потребности отдельных служб и потребление ресурсов отдельными объектами, входящими в эти службы. Для достижения этой цели диспетчер кластерных ресурсов разделен на два независимых элемента: агенты, которые выполняются на каждом узле, и отказоустойчивая служба. Агенты на каждом узле отслеживают информацию о нагрузке от служб, агрегируют ее и периодически передают в отчетах. Служба диспетчера кластерных ресурсов собирает все данные от локальных агентов и выполняет определенные действия в зависимости от текущей конфигурации.

Посмотрите на схему ниже.

<center>
![Архитектура балансировщика ресурсов][Image1]
</center>

Во время выполнения могут произойти разные изменения. Например, изменяется объем ресурсов, потребляемых службами, некоторые службы прекращают работу, отдельные узлы добавляются к кластеру или удаляются из него. Все изменения на узле собираются и периодически отправляются в службу диспетчера кластерных ресурсов (1,2), где они собираются снова, анализируются и сохраняются. Каждые несколько секунд эта служба просматривает все изменения и определяет, нужно ли выполнять какие-либо действия (3). Например, она может определить, что в кластер добавлены пустые узлы, и перенести в них некоторые службы. Также диспетчер кластерных ресурсов может зафиксировать, что один из узлов перегружен или одна из служб не работает (либо была удалена), то есть освободила некоторые ресурсы.

Посмотрите на следующую схему, которая показывает, что происходит далее. Предположим, диспетчер кластерных ресурсов определяет, что необходимы изменения. Он вносит необходимые изменения по согласованию с другими службами (в частности с диспетчером отработки отказов). На соответствующие узлы отправляются необходимые команды (4). В данном случае диспетчер ресурсов заметил, что узел 5 перегружен, и решил перенести службу B с узла 5 на узел 4. После перенастройки (5) кластер выглядит следующим образом:

<center>
![Архитектура балансировщика ресурсов][Image2]
</center>

## <a name="next-steps"></a>Дальнейшие действия
* Диспетчер кластерных ресурсов предоставляет много параметров для описания кластера. Дополнительные сведения об этих параметрах см. в статье с [описанием кластера Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md).

[Image1]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png



<!--HONumber=Jan17_HO1-->


