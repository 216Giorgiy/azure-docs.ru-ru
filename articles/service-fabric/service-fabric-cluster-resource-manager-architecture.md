<properties
   pageTitle="Архитектура диспетчера ресурсов | Microsoft Azure"
   description="Общие сведения об архитектуре диспетчера кластерных ресурсов Service Fabric."
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="03/03/2016"
   ms.author="masnider"/>

# Общие сведения об архитектуре диспетчера кластерных ресурсов
Для управления ресурсами в кластере диспетчеру кластерных ресурсов требуется несколько параметров. Он должен знать, какие службы в нем существуют и какой объем ресурсов они используют на данный момент (или по умолчанию). Он должен знать фактическую емкость входящих в кластер, а значит, и объем ресурсов, доступных для всего кластера и для отдельного узла. Нам придется иметь дело с тем, что в течение времени одна и та же служба может использовать разный объем ресурсов, а также учитывать, что службы, как правило, зависят более чем от одного ресурса. Существуют как "реальные" ресурсы, такие как память и дисковое пространство, которыми широко пользуются самые разные виды служб, так и ресурсы, к которым прибегает только одна определенная служба.

Дополнительную сложность создает тот факт, что владельцы и операторы кластера часто не являются авторами служб либо выступают в качестве мастера на все руки. Например, разработчик службы знает, какие ресурсы для нее потребуются и как развернуть различные компоненты, а человек, имеющий дело с рабочим экземпляром этой службы, выполняет совсем другую работу и нуждается в совершенно других инструментах. Кроме того, ни кластер, ни служба не отличаются статичностью конфигурации: количество узлов в кластере может увеличиваться и уменьшаться, узлы различных размеров — появляться и исчезать, а службы — менять распределение ресурсов, создаваться и удаляться. Кластер может обновляться и подвергаться другим операциям управления, и, разумеется, никто не застрахован от сбоев.

Наш диспетчер ресурсов должен много знать о кластере в целом, а также о требованиях каждой отдельной службы. Для этого в Service Fabric реализованы агенты диспетчера ресурсов, работающие на отдельных узлах и собирающие данные об использовании локальных ресурсов, и централизованная отказоустойчивая служба диспетчера ресурсов, которая собирает всю информацию о службах и кластере и реагирует на изменения с учетом настройки требуемого состояния кластера и службы. Отказоустойчивость обеспечивается по тому же принципу, который мы применяем для ваших служб, а именно за счет репликации состояния службы в определенное количество реплик (обычно их 7).

![Архитектура балансировщика ресурсов][Image1]

Для примера рассмотрим схему на рис. 1. В среде выполнения может происходить целый ряд изменений. Это могут быть изменения в том, какой объем ресурсов задействуют службы, сбои в некоторых службах, увеличение и уменьшение числа узлов в кластере и т. д. Все изменения на каждом отдельном узле собираются и периодически отправляются в центральную службу диспетчера ресурсов (1,2), где они собираются снова, анализируются и сохраняются. Каждые несколько секунд центральная служба просматривает все изменения и определяет все необходимые действия (3). Например, она может определить, что в кластер добавлены новые, пустые узлы, и перенести в них некоторые службы. Центральная служба также может зафиксировать, что какой-то узел перегружен или одна из служб не работает (либо была удалена) и, таким образом, высвобождает ресурсы на других узлах.

Теперь посмотрите на следующую схему (рис. 2). Допустим, диспетчер ресурсов определяет, что необходимы изменения. Он вносит необходимые изменения по согласованию с другими службами (в частности с диспетчером отработки отказов). На соответствующие узлы отправляются запросы на изменения (4). В данном случае диспетчер ресурсов заметил, что узел 5 перегружен, и решил перенести службу B с узла 5 на узел 4. После перенастройки (5) кластер выглядит следующим образом:

![Архитектура балансировщика ресурсов][Image2]

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->
<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->
## Дальнейшие действия
- [Дополнительные сведения об архитектуре диспетчера кластерных ресурсов](service-fabric-cluster-resource-manager-architecture.md)
- [Описание кластера](service-fabric-cluster-resource-manager-cluster-description.md)

[Image1]: ./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]: ./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png

<!---HONumber=AcomDC_0309_2016-->