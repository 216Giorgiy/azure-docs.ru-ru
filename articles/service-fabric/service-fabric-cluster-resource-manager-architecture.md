---
title: "Архитектура диспетчера ресурсов | Документация Майкрософт"
description: "Общие сведения об архитектуре диспетчера кластерных ресурсов Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 6c4421f9-834b-450c-939f-1cb4ff456b9b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/19/2016
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: dcda8b30adde930ab373a087d6955b900365c4cc
ms.openlocfilehash: 3ec8800b947c227d4d1087283b0964ce22eca4df


---
# <a name="cluster-resource-manager-architecture-overview"></a>Общие сведения об архитектуре диспетчера кластерных ресурсов
Для управления ресурсами в кластере диспетчеру кластерных ресурсов Service Fabric требуется несколько параметров. Он должен знать, какие службы в нем существуют и какой объем ресурсов эти службы используют на данный момент (или по умолчанию). Он должен знать фактическую емкость входящих в кластер, а значит, и объем ресурсов, доступных для всего кластера и для отдельного узла. В течение времени одна и та же служба может использовать разный объем ресурсов. Также учитывайте, что службы, как правило, зависят более чем от одного ресурса. Среди множества различных служб могут быть как "реальные" физические ресурсы, измеряемые и отображаемые в отчетах в виде метрик (например память и дисковое пространство), так и (на самом деле используемые чаще) логические метрики, такие как WorkQueueDepth или TotalRequests. Как логическими, так и физическими метриками могут широко пользоваться самые разные виды служб. А какие-то метрики могут быть доступны только для нескольких определенных служб.

## <a name="other-considerations"></a>Дополнительные рекомендации
Владельцы и операторы кластера часто не являются авторами служб либо выступают в качестве мастера на все руки. Например, разработчик службы знает, какие ресурсы для нее потребуются и как развернуть различные компоненты, а человек, имеющий дело с рабочим экземпляром этой службы, выполняет совсем другую работу и нуждается в совершенно других инструментах. Кроме того, ни кластер, ни служба не отличаются статичностью конфигурации: количество узлов в кластере может увеличиваться и уменьшаться, узлы различных размеров — появляться и исчезать, а службы — создаваться, удаляться и менять распределение ресурсов в режиме реального времени. Кластер может обновляться и подвергаться другим операциям управления, и, разумеется, никто не застрахован от сбоев.

## <a name="cluster-resource-manager-components-and-data-flow"></a>Компоненты и поток данных диспетчера кластерных ресурсов
Диспетчер кластерных ресурсов должен много знать о кластере в целом, а также о требованиях каждой отдельной службы и формирующих ее экземпляров без отслеживания или реплик с отслеживанием состояния. Для этого реализованы агенты диспетчера кластерных ресурсов, работающие на отдельных узлах и собирающие данные об использовании локальных ресурсов, и централизованная отказоустойчивая служба диспетчера кластерных ресурсов, которая собирает всю информацию о службах и кластере и реагирует, исходя из своей текущей конфигурации. Отказоустойчивость службы диспетчера кластерных ресурсов (и всех других системных служб) обеспечивается по тем же принципам, которые мы применяем для ваших служб, а именно за счет репликации состояния службы в кворумы с определенным количеством реплик (обычно их 7).

![Архитектура балансировщика ресурсов][Image1]

Для примера рассмотрим схему выше. В среде выполнения может происходить целый ряд изменений. Это могут быть изменения в том, какой объем ресурсов задействуют службы, сбои в некоторых службах, увеличение и уменьшение числа узлов в кластере и т. д. Все изменения на каждом отдельном узле собираются и периодически отправляются в службу диспетчера кластерных ресурсов (1,2), где они собираются снова, анализируются и сохраняются. Каждые несколько секунд служба просматривает все изменения и определяет все необходимые действия (3). Например, она может определить, что в кластер добавлены новые, пустые узлы, и перенести в них некоторые службы. Центральная служба также может зафиксировать, что какой-то узел перегружен или одна из служб не работает (либо была удалена) и, таким образом, высвобождает ресурсы на других узлах.

Рассмотрим следующую схему и узнаем, что происходит далее. Предположим, диспетчер кластерных ресурсов определяет, что необходимы изменения. Он вносит необходимые изменения по согласованию с другими службами (в частности с диспетчером отработки отказов). На соответствующие узлы отправляются запросы на изменения (4). В данном случае диспетчер ресурсов заметил, что узел 5 перегружен, и решил перенести службу B с узла 5 на узел 4. После перенастройки (5) кластер выглядит следующим образом:

![Архитектура балансировщика ресурсов][Image2]

## <a name="next-steps"></a>Дальнейшие действия
* В диспетчере кластерных ресурсов много параметров для описания кластера. Чтобы узнать о них больше, ознакомьтесь с этой статьей об [описании кластера Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md)

[Image1]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png



<!--HONumber=Dec16_HO2-->


