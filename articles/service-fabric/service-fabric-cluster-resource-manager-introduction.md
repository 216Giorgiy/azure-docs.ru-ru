<properties
   pageTitle="Общие сведения о диспетчере кластерных ресурсов Service Fabric | Microsoft Azure"
   description="Введение в работу с диспетчера кластерных ресурсов Service Fabric."
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/19/2016"
   ms.author="masnider"/>

# Общие сведения о диспетчере кластерных ресурсов Service Fabric
Как правило, для управления ИТ-системами или набором служб выделяется несколько компьютеров или виртуальных машин. Многие крупные службы разбиваются на веб-уровень и уровень данных (или хранилище), иногда используя специализированные компоненты, такие как кэш. Другие типы приложений включают уровень обмена сообщениями, куда поступают и откуда исходят запросы, подключенный к рабочему уровню для выполнения анализа и преобразований, необходимых для обмена сообщениями. Для рабочей нагрузки каждого типа выделяются специальные компьютеры или виртуальные машины: пара — для базы данных и несколько — для веб-серверов. Если определенный тип рабочей нагрузки вызывает чрезмерно нагружает компьютер, на котором она выполняется, то для этого типа нагрузки выделяются дополнительные компьютеры или некоторые из уже имеющихся компьютеров заменяются более мощными. Все просто. Если на машине возникает сбой, соответствующая часть приложения выполняется с меньшей емкостью, пока машина не будет восстановлена. По-прежнему довольно просто (пусть и не слишком увлекательно).

А теперь допустим, что произошло расширение и число контейнеров и микрослужб резко возросло. Неожиданно у вас оказались сотни или даже тысячи компьютеров, десятки различных типов служб, возможно, даже сотни различных экземпляров этих служб, и каждая из них с одним или несколькими экземплярами или репликами для обеспечения высокого уровня доступности.

Внезапно управление средой оказалось гораздо сложнее, чем управление несколькими компьютерами, выделенными для отдельных типов рабочей нагрузки. Ваши серверы виртуальны и больше не имеют имен (в конце концов вы *переключились* с [мелкого на крупный рогатый скот](http://www.slideshare.net/randybias/architectures-for-open-and-scalable-clouds/20)). Настройка конфигурации теперь связана не столько с машинами, сколько с самими службами. Выделенное оборудование осталось в прошлом, и службы стали небольшими распределенными системами, охватывающими несколько небольших частей стандартного оборудования.

В результате такого разделения когда-то цельного многоуровневого приложения на отдельные службы, работающие на стандартном оборудовании, вам приходится принимать во внимание гораздо больше комбинаций. Кто решает, какие типы рабочей нагрузки можно выполнять на том или ином оборудовании и в каком количестве? Какие рабочие нагрузки хорошо работают на одном оборудовании, а какие конфликтуют? Как узнать, какие службы выполнялись на машине, если произошел сбой? Кто должен проследить за повторным запуском этой рабочей нагрузки? Нужно ли дожидаться возврата (виртуальной) машины, или рабочие нагрузки автоматически переключатся на другие виртуальные машины и продолжат выполнение? Требуется ли вмешательство? Как устанавливать обновления в подобных средах?

Как разработчикам и операторам такой среды, нам потребуется определенная помощь в управлении решением такой сложности, а у вас может создаться впечатление, что расширение штата и попытка уладить сложности при помощи дополнительного персонала — не лучшее решение.

Что делать?

## Знакомство с оркестраторами
Термин "оркестратор" означает элемент программного обеспечения, помогающий администраторам управлять такими типами сред. Оркестраторы — это компоненты, которые принимают запросы вида "Хочу, чтобы в моей среде выполнялось 5 копий этой службы", выполняют их и поддерживают (стараются поддерживать) работу системы.

Оркестраторы (а не люди) принимают меры при сбое машины или остановке рабочей нагрузки по непредвиденной причине. Большинство оркестраторов не просто устраняют отказы, но и помогают при выполнении новых развертываний, обработке обновления и контроле за использованием ресурсов, но в целом все это связано с тем, чтобы поддерживать среду в желаемом состоянии. Для этого вам нужно сообщить оркестратору свои пожелания и дать ему выполнить необходимые действия. Chronos или Marathon в Mesos, Fleet, Swarm, Kubernetes и Service Fabric — это все примеры оркестраторов или решений, в которые встроены оркестраторы. Со временем их число будет расти, поскольку сложность управления развертывания в различных средах и условиях продолжает увеличиваться и изменяться.

## Оркестрация как служба
Задание оркестратора в кластере Service Fabric преимущественно выполняет диспетчер кластерных ресурсов. Диспетчер кластерных ресурсов Service Fabric — одна из системных служб Service Fabric, которая автоматически запускается в каждом кластере. Как правило, задание диспетчера кластерных ресурсов делится на три части:

1. Применение правил
2. Оптимизация среды
3. Помощь в других процессах

### Чем это не является
В традиционных N-уровневых веб-приложениях всегда используется какая-либо подсистема балансировки нагрузки, которая обычно называется подсистемой балансировки сетевой нагрузки (NLB) или подсистемой балансировки нагрузки приложений (ALB) в зависимости от того, какое место в сетевом стеке она занимает. Одни подсистемы балансировки нагрузки используют оборудование как BigIP от F5, другие — программное обеспечение как NLB корпорации Майкрософт. В других средах в этой роли может выступать, например, HAProxy. В подобных архитектурах подсистема балансировки должна следить за тем, чтобы разнообразные управляющие машины без отслеживания состояния или машины в кластере получали примерно одинаковый объем работы. Для этого применяются различные стратегии от отправки каждого отдельного вызова на отдельный сервер до распределения (закрепления) сеансов, а также оценки и распределение вызовов в зависимости от ожидаемых расходов и нагрузки на текущую машину.

Обратите внимание, что в лучшем случае такой механизм обеспечивал балансировку только на веб-уровне. Стратегия балансировки на уровне данных совершенно иная, зависит от механизма хранения данных и обычно связана с сегментированием данных, кэшированием, контролем базы данных за представлением данных, хранимыми процедурами и т. п.

И хотя некоторые из этих стратегий довольно интересны, диспетчер кластерных ресурсов Service Fabric совсем не похож на подсистему балансировки нагрузки или кэш. Пока балансировщик сетевой нагрузки обеспечивает распределение нагрузки на внешние интерфейсы, направляя трафик туда, где выполняются службы, диспетчер кластерных ресурсов Service Fabric реализует совсем другую стратегию: по сути, Service Fabric переносит *службы* в наиболее подходящее место (предполагая, что трафик или нагрузка последует за ними). Это могут быть, например, узлы, которые простаивают, так как размещенные в них службы в этот момент не выполняют никакой значительной работы либо были удалены или перемещены в другое место. Кроме того, диспетчер кластерных ресурсов может переместить службу с виртуальной машины, которая должна быть обновлена или находится под чрезмерной нагрузкой из-за скачка в использовании службы, работающей на этой виртуальной машине. Так как диспетчер кластерных ресурсов отвечает за перемещение служб (а не доставляет сетевой трафик в расположения служб), набор его функций значительно отличается от балансировщика сетевой нагрузки, и он применяет совершенно иные стратегии для обеспечения эффективного использования аппаратных ресурсов в кластере.

## Дальнейшие действия
- Сведения об архитектуре и потоке информации в диспетчере кластерных ресурсов см. в [этой статье](service-fabric-cluster-resource-manager-architecture.md).
- В диспетчере кластерных ресурсов много параметров для описания кластера. Чтобы узнать о них больше, ознакомьтесь с этой статьей с [описанием кластера Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md).
- Дополнительные сведения о других вариантах настройки служб см. в статье [Настройка параметров диспетчера кластерных ресурсов для служб Service Fabric](service-fabric-cluster-resource-manager-configure-services.md).
- Метрики показывают, как диспетчер кластерных ресурсов Service Fabric управляет потреблением и емкостью в кластере. Дополнительные сведения о метриках и их настройке см. в [этой статье](service-fabric-cluster-resource-manager-metrics.md).
- Диспетчер кластерных ресурсов работает с функциями управления Service Fabric. Подробные сведения об этой интеграции см. в [этой статье](service-fabric-cluster-resource-manager-management-integration.md).
- Чтобы узнать, как диспетчер кластерных ресурсов управляет нагрузкой кластера и балансирует ее, ознакомьтесь со статьей о [балансировке нагрузки](service-fabric-cluster-resource-manager-balancing.md).

<!---HONumber=AcomDC_0824_2016-->