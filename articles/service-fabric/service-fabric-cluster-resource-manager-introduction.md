<properties
   pageTitle="Общие сведения о диспетчере кластерных ресурсов Service Fabric | Microsoft Azure"
   description="Введение в работу с диспетчера кластерных ресурсов Service Fabric."
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="05/20/2016"
   ms.author="masnider"/>

# Общие сведения о диспетчере кластерных ресурсов Service Fabric
Как правило, для управления ИТ-системами или набором служб выделяются несколько отдельных компьютеров. Многие крупные службы разбиваются на веб-уровень и уровень данных (или хранилище), иногда используя специализированные компоненты, такие как кэш. Другие типы приложений включают уровень обмена сообщениями, куда поступают и откуда исходят запросы, подключенный к рабочему уровню для выполнения анализа и преобразований, необходимых для обмена сообщениями. Каждая часть получает отдельные машины или пару машин: для базы данных выделяется пара машин, для веб-серверов — несколько. Если определенный тип рабочей нагрузки вызывает перегрев машины, на которой она выполняется, для этого типа нагрузки выделяют дополнительные машины или заменяют некоторые из имеющихся машин на более мощные. Все просто. Если на машине возникает сбой, соответствующая часть приложения выполняется с меньшей емкостью, пока машина не будет восстановлена. По-прежнему довольно просто (пусть и не слишком увлекательно).

А теперь допустим, что произошло расширение и число контейнеров и микрослужб резко возросло. Неожиданно у вас оказались сотни или даже тысячи машин, десятки различных типов службы, возможно даже сотни различных экземпляров этих служб и каждая из них с одним или несколькими экземплярами или репликами для обеспечения высокой доступности.

Внезапно управление средой оказалось гораздо сложнее, чем управление несколькими компьютерами, выделенными для отдельных типов рабочей нагрузки. Ваши серверы виртуальны и больше не имеют имен (в конце концов вы переключились с [мелкого на крупный рогатый скот](http://www.slideshare.net/randybias/architectures-for-open-and-scalable-clouds/20)), а машины больше не ограничиваются одним единственным типом рабочей нагрузки. Настройка конфигурации теперь связана не столько с машинами, сколько с самими службами.

В результате такого разделения когда-то цельного многоуровневого решения на отдельные службы вам приходится принимать во внимание гораздо больше комбинаций. Кто решает, какие типы рабочей нагрузки можно выполнять на определенной машине или параллельно? Как узнать, какие службы выполнялись на машине, если произошел сбой? Кто должен проследить за повторным запуском этой машины? Нужно ли дожидаться возврата (виртуальной) машины, или рабочие нагрузки автоматически переключатся на другие машины и продолжат выполнение? Требуется ли вмешательство? Как устанавливать обновления в подобных средах? Как разработчикам и операторам такой среды нам потребуется определенная помощь в управлении решением такой сложности, а у вас может создаться впечатление, что расширение штата и попытка уладить сложности при помощи дополнительного персонала — не лучшее решение.

Что делать?

## Знакомство с оркестраторами
Термин "оркестратор" означает элемент программного обеспечения, помогающий администраторам управлять такими типами развертываний. Оркестраторы — это компоненты, которые принимают запросы вида "Хочу, чтобы в моей среде выполнялось 5 копий этой службы", выполняют их и поддерживают (стараются поддерживать) работу системы.

Оркестраторы (а не люди) принимают меры при сбое машины или остановке рабочей нагрузки по непредвиденной причине. Большинство оркестраторов не просто устраняют отказы, но и помогают при выполнении новых развертываний, обработке обновления и контроле за использованием ресурсов, но в целом все это связано с тем, чтобы поддерживать среду в желаемом состоянии. Для этого вам нужно сообщить оркестратору свои пожелания и дать ему выполнить необходимые действия. Chronos или Marathon в Mesos, Fleet, Swarm, Kubernetes и Service Fabric — это оркестраторы или оболочки, в которые встроены оркестраторы. Со временем их число будет расти, поскольку сложность управления развертывания в различных средах и условиях продолжает увеличиваться и изменяться.

## Оркестрация как служба
Задание оркестратора в кластере Service Fabric преимущественно выполняет диспетчер кластерных ресурсов. Диспетчер кластерных ресурсов Service Fabric — одна из системных служб Service Fabric, которая автоматически запускается в каждом кластере. Как правило, задание диспетчера ресурсов делится на три части:

1. Применение правил
2. Оптимизация среды
3. Помощь в других процессах

Прежде чем мы изучать все возможности диспетчера ресурсов, рассмотрим, как он работает. Диспетчер кластерных ресурсов Service Fabric

## Общая архитектура и реализация
Прежде чем углубляться в описание диспетчера кластерных ресурсов и его функций, поговорим о том, что он собой представляет и как работает.

### Чем это не является
В традиционных N-уровневых веб-приложениях всегда используется какая-либо подсистема балансировки нагрузки, которая обычно называется подсистемой балансировки сетевой нагрузки (NLB) или подсистемой балансировки нагрузки приложений (ALB) в зависимости от того, какое место в сетевом стеке она занимает. Одни подсистемы балансировки нагрузки используют оборудование как BigIP от F5, другие — программное обеспечение как NLB корпорации Майкрософт. В подобных архитектурах подсистема балансировки должна следить за тем, чтобы разнообразные управляющие машины без отслеживания состояния или машины в кластере получали примерно одинаковый объем работы. Для этого применяются различные стратегии от отправки каждого отдельного вызова на отдельный сервер до распределения (закрепления) сеансов, а также оценки и распределение вызовов в зависимости от ожидаемых расходов и нагрузки на текущую машину.

Обратите внимание, что в лучшем случае такой механизм обеспечивал балансировку только на веб-уровне. Стратегия балансировки на уровне данных совершенно иная, зависит от механизма хранения данных и обычно связана с сегментированием данных, кэшированием, контролем базы данных за представлением данных, хранимыми процедурами и т. п.

И хотя некоторые из этих стратегий довольно интересны, диспетчер кластерных ресурсов Service Fabric совсем не похож на подсистему балансировки нагрузки или кэш. Пока подсистема балансировки нагрузки обеспечивает распределение нагрузки на внешних машинах, направляя трафик туда, где выполняются службы, диспетчер Resource Manager кластера Service Fabric выполняет совсем другую работу: по сути, он переносит *службы* в наиболее подходящее место (предполагая, что трафик или нагрузка последует за ними). Это могут быть, например, узлы, которые находятся в холодном состоянии, поскольку размещенные в них службы в этот момент не выполняют никакой значительной работы. Кроме того, диспетчер кластерных ресурсов может убрать службу из узла, который должен подвергнуться обновлению или находится под чрезмерной нагрузкой из-за скачка в использовании службы, размещенной на этом узле. Отвечая за перемещение служб (а не за доставку сетевого трафика туда, где эти службы уже находятся), диспетчер кластерных ресурсов Service Fabric отличается большей гибкостью и обладает более широкими возможностями для контроля за местом размещения служб и способами их перемещения.

## Дальнейшие действия
- Сведения об архитектуре и потоке информации в диспетчере кластерных ресурсов см. в [этой статье](service-fabric-cluster-resource-manager-architecture.md).
- В диспетчере кластерных ресурсов много параметров для описания кластера. Дополнительные сведения о них см. в статье с [описанием кластера Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md).
- Дополнительные сведения о других вариантах настройки служб см. в разделе о других конфигурациях Cluster Resource Manager в статье [Настройка параметров диспетчера кластерных ресурсов для служб Service Fabric](service-fabric-cluster-resource-manager-configure-services.md).
- Метрики показывают, как диспетчер кластерных ресурсов Service Fabric управляет потреблением и емкостью в кластере. Дополнительные сведения о метриках и их настройке см. в [этой статье](service-fabric-cluster-resource-manager-metrics.md).
- Диспетчер кластерных ресурсов работает с функциями управления Service Fabric. Подробные сведения об этой интеграции см. в [этой статье](service-fabric-cluster-resource-manager-management-integration.md).
- Чтобы узнать, как диспетчер кластерных ресурсов управляет нагрузкой кластера и балансирует ее, ознакомьтесь со статьей о [балансировке нагрузки](service-fabric-cluster-resource-manager-balancing.md).

<!---HONumber=AcomDC_0525_2016-->