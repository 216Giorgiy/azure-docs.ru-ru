<properties linkid="develop-python-web-site-with-django" urlDisplayName="Веб-сайты с Django" pageTitle="Веб-сайты Python с Django — учебник по Azure" metaKeywords="django Azure, веб-сайт django" description="Учебный курс, знакомящий с запуском веб-сайта Python в Azure." metaCanonical="" services="web-sites" documentationCenter="Python" title="Создание веб-сайтов с помощью Django" authors=""  solutions="" writer="" manager="" editor=""  />




# Создание веб-сайтов с помощью Django

В этом учебном курсе описывается, как начать работать с Python на веб-сайтах Azure.  Веб-сайты Azure предоставляют ограниченное бесплатное размещение и быстрое развертывание, и теперь можно использовать Python!  По мере роста вашего приложения можно переключиться на платное размещение, а также можно интегрировать его со всеми другими службами Azure.  

В этом учебном курсе показано, как развертывать приложение, созданное с помощью веб-платформы Django.  В этом учебном курсе также описываются действия для развертывания приложения и всех требуемых библиотек, включая Django.  Все это будет помещено в репозиторий Git, который позволяет быстро и просто помещать обновления на веб-сайт.  И наконец, вновь созданный сайт будет настроен через Azure таким образом, чтобы на нем выполнялось приложение Python.  

[WACOM.INCLUDE [create-account-and-websites-note](../includes/create-account-and-websites-note.md)]

В этом учебном руководстве используются Python 2.7 и Django 1.4.  Можно либо получить эти компоненты самостоятельно, либо быстро и легко установить их с помощью ссылки установщика Windows на странице [http://www.windowsazure.com/ru-ru/develop/python/](http://www.windowsazure.com/ru-ru/develop/python/)  

**Примечание**. Веб-сайты Azure теперь поставляются с предустановленными Python 2.7 и обработчиком wfastcgi.  Но веб-платформы, такие как Django, в установочный комплект не входят.  При желании по-прежнему можно использовать другой интерпретатор Python.  Нужно просто включить его в репозиторий Git и настроить для веб-сайта использование этого интерпретатора вместо уже установленного интерпретатора Python 2.7.

Также понадобится установить вариант развертывания для передачи сайта в Azure. Доступны различные средства развертывания, но в этом учебном курсе используется Git. Мы рекомендуем [msysgit](http://code.google.com/p/msysgit/). 

**Примечание**. Публикация TFS в настоящее время для проектов Python не поддерживается.

После установки Python, Django и Git все готово к началу работы.

## Создание веб-сайта на портале

Первым этапом в создании приложения является создание веб-сайта с помощью портала управления Azure.  Для этого понадобится войти на портал и нажать кнопку СОЗДАТЬ в нижнем левом углу. Откроется окно. Нажмите кнопку **Быстрое создание**, введите URL-адрес и выберите **Создать веб-сайт**.

![](./media/web-sites-python-create-deploy-django-app/django-ws-003.png)

Веб-сайт будет быстро создан.  Далее, можно добавить поддержку публикации с помощью Git.  Это можно сделать, выбрав **Настроить развертывания в системе управления версиями**.

![](./media/web-sites-python-create-deploy-django-app/django-ws-004.png)

Прокрутите вниз диалоговое окно **Настройка развертывания** и выберите вариант **Локальный репозиторий Git**. Для продолжения щелкните стрелку вправо.

![](./media/web-sites-python-create-deploy-django-app/django-ws-005.png)

После настройки публикации с помощью репозитория Git тут же появится страница, сообщающая о создании репозитория. Когда репозиторий будет готов, откроется вкладка развертываний. Вкладка развертываний содержит инструкции по подключению.  

![](./media/web-sites-python-create-deploy-django-app/django-ws-006.png)


## Разработка веб-сайта

Теперь, после создания репозитория Git в Azure, можно начать переносить на него веб-сайт с локального компьютера.  Первым делом необходимо создать копию существующего пустого сайта, используя предоставленный URL-адрес:

![](./media/web-sites-python-create-deploy-django-app/django-ws-007.png)

С этого момента все готово для настройки включения в состав веб-сайта.  Необходимо выполнить несколько действий:

1.  Добавить библиотеку Django и другие библиотеки, которые будут использоваться для работы веб-сайта.
2.  Добавить код приложения Django.

Во-первых, добавьте библиотеку Django.  Для этого создайте новый каталог с именем site-packages и скопируйте в него свою установленную версию Django с помощью следующих команд:

	mkdir site-packages
	cd site-packages
	xcopy /s C:\Python27\lib\site-packages\* .

Эти команды копируют все библиотеки, расположенные в каталоге site-packages, включая Django.  Если там есть библиотеки, не используемые веб-сайтом, их можно спокойно удалить.

![](./media/web-sites-python-create-deploy-django-app/django-ws-008.png)
 
Затем создайте свое первоначальное приложение Django.  Для создания проекта можно использовать, как и при создании любого другого приложения Django, командную строку или [Средства Python для Visual Studio](http://pytools.codeplex.com/).  Здесь показаны оба варианта.

**Вариант 1.** 
Чтобы создать новый проект из командной строки, выполните следующую команду. Следующая команда создает приложение Django в папке DjangoApplication:

	 C:\Python27\python.exe -m django.bin.django-admin startproject DjangoApplication

![](./media/web-sites-python-create-deploy-django-app/django-ws-010.png)

**Вариант 2.**  
Также новый веб-сайт можно создать, используя средства Python для Visual Studio.  Запустите Visual Studio с установленными средствами Python для Visual Studio и выберите **Файл**->**Создать проект**.  В разделе **Другие языки** откройте проекты Python и выберите **Приложения Django**.  Введите **DjangoApplication** в качестве имени проекта и убедитесь, что флажок **Создать каталог для решения** снят, чтобы получить точную структуру каталогов, такую же, как при создании приложения Django из командной строки. Этот вариант установит файл решения и проекта Visual Studio, который позволит получить опыт локальной разработки, включая отладку шаблонов и Intellisense.

![](./media/web-sites-python-create-deploy-django-app/django-ws-011.png)

Теперь нужно просто добавить все только что добавленные файлы и передать веб-сайт в репозиторий Git.  Для этого выполните следующие команды:

	git add DjangoApplication site-packages
	git commit -m "Initial site"
	git remote add azure https://dinov@pythonwebsite.scm.azurewebsites.net/PythonWebSite.git
	git push azure master

Первая команда добавит отслеживание для неотслеживаемых файлов.  Вторая команда применит файлы, только что добавленные в репозиторий.  Третья команда добавляет удаленный репозиторий с именем *azure* для вашего репозитория.  Последняя команда принимает изменения и передает их в удаленный репозиторий. Эта последняя команда также запускает развертывание.  После этого должен появиться результат, подобный следующему:

![](./media/web-sites-python-create-deploy-django-app/django-ws-013.png)

После выполнения передачи портал Azure обновится и появится активное развертывание:

![](./media/web-sites-python-create-deploy-django-app/django-ws-014.png)

## Настройка веб-сайта

Теперь необходимо настроить веб-сайт таким образом, чтобы сообщить ему о проекте Django и чтобы использовался обработчик wfastcgi.  Для этого можно выбрать вкладку "Настройка" в верхней части экрана и прокрутить ее вниз до нижней половины страницы с разделами **параметры приложения** и **сопоставления обработчиков**.  

Все параметры, заданные здесь, при выполнении фактического запроса превращаются в переменные среды.  То есть этот подход можно использовать для настройки переменных среды DJANGO\_SETTINGS\_MODULE, PYTHONPATH и WSGI\_HANDLER.  Если приложение использует другие значения конфигурации, их можно назначать здесь, а затем получать из среды.  Иногда требуется настроить путь к некоторому файлу на веб-сайте. Например, это может понадобиться для переменной PYTHONPATH.  Веб-сайт, если он работает как веб-сайт Azure, будет находиться в папке **D:\home\site\wwwroot\**, поэтому можно использовать эту переменную везде, где нужен полный путь к файлу на диске.

Чтобы настроить приложение Django, необходимо создать три переменные среды.  Первой является DJANGO\_SETTINGS\_MODULE, которая содержит имя модуля приложения Django, которое будет использоваться для конфигурации.  Вторая — это переменная среды PYTHONPATH, задающая пакет, в котором находится модуль настроек. Третьей является WSGI\_HANDLER.  Эта переменная содержит имя модуля/пакета, за которым следует атрибут в используемом модуле (например, mypackage.mymodule.handler).  Добавьте скобки, чтобы указать, что следует вызывать атрибут.  Поэтому настройте эти переменные следующим образом:
                
	DJANGO_SETTINGS_MODULE    DjangoApplication.settings
	PYTHONPATH                D:\home\site\wwwroot\DjangoApplication;D:\home\site\wwwroot\site-packages
	WSGI_HANDLER              django.core.handlers.wsgi.WSGIHandler()

![](./media/web-sites-python-create-deploy-django-app/django-ws-015.png)

Теперь необходимо настроить сопоставление для используемого обработчика.  Для этого зарегистрируйте обработчик для всех расширений, используя путь к интерпретатору Python и путь к сценарию wfastcgi.py:

	EXTENSION                 *
	SCRIPT PROCESSOR PATH     D:\python27\python.exe
	ADDITIONAL ARGUMENTS      D:\python27\scripts\wfastcgi.py

![](./media/web-sites-python-create-deploy-django-app/django-ws-016.png)

В этот момент можно нажать внизу кнопку **Сохранить**.

Наконец, вернитесь на панель мониторинга. Перейдите вниз к полю **URL-АДРЕС САЙТА** с левой стороны. Щелкните ссылку и откройте новый сайт Django, который будет выглядеть следующим образом:

![](./media/web-sites-python-create-deploy-django-app/django-ws-017.png)

## Дальнейшие действия

С этого момента можно продолжить разработку приложения Django с помощью уже используемых средств. При использовании для разработки [средств Python для Visual Studio](http://pytools.codeplex.com/), вероятно, понадобится установить [VisualGit](http://code.google.com/p/visualgit/) для интеграции с системой управления версиями из Visual Studio.  

Зависимости приложений могут не ограничиваться Python и Django.  Если Python устанавливался с помощью установщика на странице [http://www.windowsazure.com/ru-ru/develop/python/](http://www.windowsazure.com/ru-ru/develop/python/), PIP уже будет установлен, и его можно использовать для быстрого добавления новых зависимостей.  Например, чтобы установить набор средств естественного языка и все его зависимости, введите следующую команду:

	pip install nltk

Затем нужно обновить каталог site-packages, скопировав файлы из C:\Python27\Lib\site-packages в локальный каталог site-packages.

После копирования файлов выполните команду **git status**, чтобы просмотреть только что добавленные файлы, и команду **git add**, а затем **git commit** для применения изменений в репозитории.  Наконец, можно выполнить команду **git push**, которая развертывает обновленный веб-сайт в Azure.

Теперь можно перейти в каталог DjangoApplication и использовать manage.py, как обычно, чтобы начать добавлять новые приложения в проект Django.  

