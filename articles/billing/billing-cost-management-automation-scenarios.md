---
title: Сценарии автоматизации для выставления счетов и управления затратами в Azure | Документация Майкрософт
description: Узнайте, как соотносятся распространенные сценарии выставления счетов и управления затратами с разными API.
services: billing
documentationcenter: ''
author: Erikre
manager: dougeby
editor: ''
tags: billing
ms.assetid: 204b15b2-6667-4b6c-8ea4-f32c06f287fd
ms.service: billing
ms.devlang: na
ms.topic: reference
ms.tgt_pltfrm: na
ms.workload: billing
ms.date: 6/13/2018
ms.author: erikre
ms.openlocfilehash: c5445eb5e936fe73d51a41936b052f6495b1bcc6
ms.sourcegitcommit: 4de6a8671c445fae31f760385710f17d504228f8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/08/2018
ms.locfileid: "39633921"
---
# <a name="billing-and-cost-management-automation-scenarios"></a>Сценарии автоматизации для выставления счетов и управления затратами

Ниже описаны распространенные сценарии для выставления счетов и управления затратами с привязкой к разным API, которые можно использовать в этих сценариях. В разделе "Сопоставления сценариев и API" представлен обзор всех доступных API и предоставляемых ими функциональных возможностях. 

## <a name="common-scenarios"></a>Распространенные сценарии

API-интерфейсы выставления счетов и управления затратами можно применить во многих сценариях для решения вопросов, связанных с затратами и потреблением.  Ниже приводится краткий обзор распространенных сценариев.

- **Сверка счетов**. Правильно ли корпорация Майкрософт определила сумму к оплате?  Сколько мне нужно платить и как мне проверить эти вычисления?

- **Взаимозачет**. Я знаю сумму моих расходов, а как их распределить между субъектами внутри организации?

- **Оптимизация затрат**. Я знаю сумму моих расходов, но могу ли я более эффективно использовать средства, которые тратятся на Azure?

- **Отслеживание затрат**. Я хочу точно контролировать суммы затрат и объемы потребления за разные периоды времени. Какие тенденции здесь можно заметить? Что и в какой области я могу улучшить?

- **Затраты на Azure в течение месяца**. Какая сумма расходов уже накопилась за текущий месяц? Возможно, нужно как-то скорректировать расходы и (или) режим потребления ресурсов Azure? В какой период месяца ресурсы Azure используются наиболее активно?

- **Настройка оповещений**. Я хочу настроить оповещения, основанные на объемах потребления ресурсов или суммах расходов в денежном выражении.

## <a name="scenario-to-api-mappings"></a>Сопоставления сценариев и API

|         API или сценарий        | Сверка счетов    | Взаимозачет    | Оптимизация затрат    | Отслеживание затрат    | Расходы за неоконченный месяц    | Оповещения    |
|:---------------------------:|:-------------------------:|:----------------:|:--------------------:|:----------------:|:------------------:|:---------:|
| сведения о бюджете;                     |                           |                  |           X          |                  |                    |     X     |
| Marketplace                |             X             |         X        |           X          |         X        |          X         |     X     |
| Прейскурант                 |             X             |         X        |           X          |         X        |          X         |           |
| Рекомендации по резервированию |                           |                  |           X          |                  |                    |           |
| Сведения о резервировании         |                           |                  |           X          |         X        |                    |           |
| Сводные данные о резервировании       |                           |                  |           X          |         X        |                    |           |
| Сведения о потреблении               |             X             |         X        |           X          |         X        |          X         |     X     |
| Расчетный период             |             X             |         X        |           X          |         X        |                    |           |
| Счета                    |             X             |         X        |           X          |         X        |                    |           |
| RateCard                    |             X             |                  |           X          |         X        |          X         |           |
| Неоплачиваемое потребление               |             X             |                  |           X          |                  |          X         |           |

> [!NOTE]
> Представленное ниже сопоставление сценариев и API-интерфейсов не включает API-интерфейсы потребления для организаций. По возможности следует применять стандартные API потребления, чтобы использовать новые сценарии разработки.

## <a name="api-summaries"></a>Сводные данные по API

### <a name="consumption"></a>Потребление
(*Клиенты Web Direct и Enterprise для всех интерфейсов API, за исключением отдельно перечисленных ниже*)

-   **Бюджеты** (*Только для клиентов Enterprise*). [API бюджетов](https://docs.microsoft.com/rest/api/consumption/budgets) можно использовать, чтобы создавать бюджеты затрат или потребления для ресурсов, групп ресурсов или измерителей для выставления счетов.  Создав свои бюджеты, можно настроить оповещения о превышении порогов бюджета, установленных пользователем. Также можно настроить автоматические действия, выполняемые при достижении ограничений бюджета.
-   **Marketplaces**. Используйте [API расходов Marketplace](https://docs.microsoft.com/rest/api/consumption/marketplaces), чтобы получить сведения о расходах и потреблении для всех ресурсов Marketplace (предложения сторонних производителей для Azure). Эти сведения позволяют оценить совокупные расходы по всем ресурсам Marketplace или изучить затраты и потребление для конкретных ресурсов.
-   **Прейскурант** (*только для клиентов Enterprise*). Корпоративные клиенты могут использовать [API прейскурантов](https://docs.microsoft.com/rest/api/consumption/pricesheet), чтобы узнать свои цены для всех показателей. Организации могут объединять эти данные с информацией о потреблении для собственных ресурсов и Marketplace, чтобы рассчитать затраты на них. 
-   **Рекомендации по резервированию**. Используйте [API рекомендаций по резервированию](https://docs.microsoft.com/rest/api/consumption/reservationrecommendations), чтобы получать советы по приобретению зарезервированных экземпляров виртуальных машин. Эти рекомендации помогут пользователям оценить ожидаемую экономию и объемы закупок.
-   **Сведения о резервировании**. С помощью [API сведений о резервировании](https://docs.microsoft.com/rest/api/consumption/reservationsdetails) можно просмотреть сведения о приобретенных ранее зарезервированных виртуальных машинах, например, сравнить зарезервированные и фактические объемы потребления. Эти данные можно отобразить с детализацией до конкретной виртуальной машины.
-   **Сводные данные о резервировании**. С помощью [API сводных данных о резервировании](https://docs.microsoft.com/rest/api/consumption/reservationssummaries) вы можете просмотреть обобщенные сведения о приобретенных ранее зарезервированных виртуальных машинах, например сравнение средних зарезервированных и фактических объемов потребления. 
-   **Подробные сведения о потреблении**. [API подробных сведений о потреблении](https://docs.microsoft.com/rest/api/consumption/usagedetails) позволяет получить данные о стоимости и потреблении для всех собственных ресурсов Azure. Эти данные предоставляются в форме записей с информацией о потреблении, которые в настоящее время создаются ежедневно для каждой средства измерения. Эти сведения позволяют оценить совокупные расходы по всем ресурсам или изучить затраты и потребление для конкретных ресурсов.
-   **RateCard**: клиенты Web Direct могут использовать [API RateCard](https://msdn.microsoft.com/library/azure/mt219005.aspx) для получения своих ставок по разным показателям. Полученные данные в сочетании со сведениями о потреблении ресурсов позволят вручную вычислить ожидаемые расходы. 
-   **Неоплачиваемое потребление**. Этот [API неоплачиваемого потребления](https://msdn.microsoft.com/library/azure/mt219003.aspx) позволяет получить необработанные сведения о потреблении без применения алгоритмов Azure для оценки и выставления счетов.

### <a name="billing"></a>Выставление счетов
-   **Расчетный период**. Используйте [API расчетных периодов](https://docs.microsoft.com/rest/api/billing/billingperiods), чтобы определить период выставления счетов, который нужно проанализировать, а также идентификаторы счетов за этот период. Идентификаторы счетов можно применить в описанном ниже API счетов. 
-   **Счета**. Используйте [API счетов](https://docs.microsoft.com/rest/api/billing/invoices) для получения URL-адреса, по которому можно скачать счет в формате PDF за указанный период.

### <a name="enterprise-consumption"></a>Потребление организации
*(Все API только для клиентов Enterprise)*

-   **Сводная информация о балансе**. [API сводной информации о балансе](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-balance-summary) возвращает ежемесячную сводку о состоянии баланса, новых покупках, расходах на службу Azure Marketplace, корректировках и плате за превышение. Эту информацию можно получить для текущего расчетного периода или за любой период в прошлом. Предприятия могут использовать эти данные для сравнения с суммами расходов, вычисленными вручную. Этот API не предоставляет сведений по конкретным ресурсам или статистического представления затрат.
-   **Подробные сведения о потреблении**. Используйте [API подробных сведений о потреблении](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-usage-detail), чтобы получить собственные подробные сведения о потреблении встроенных служб Azure за текущий месяц, за определенный расчетный период или за произвольный период. Организации могут на основе этих данных вручную рассчитать суммы к оплате, исходя из цен и объемов потребления, а также для распределения расходов внутри организации или между организациями. Из этих данных можно узнать о потреблении и затратах с учетом специфики ресурсов.
-   **Затраты на Marketplace Store**. Используйте [API затрат на Marketplace Store](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-marketplace-storecharge), чтобы получить подробные сведения о потреблении служб Azure сторонних поставщиков за текущий месяц, за определенный расчетный период или за произвольный период дат. Организации могут на основе этих данных вручную рассчитать суммы к оплате, исходя из цен и объемов потребления, а также для распределения расходов внутри организации или между организациями. API затрат на Marketplace предоставляет сведения о потреблении и затратах с учетом специфики ресурсов.
-   **Прейскурант**. [API прейскурантов](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-pricesheet) предоставляет соответствующий тариф для каждой метрики в отдельной регистрации и за определенный расчетный период. Эти сведения о ценах в сочетании с данными о потреблении и использовании marketplace позволяют вручную рассчитать ожидаемые расходы.
-   **Периоды оплаты**. Используйте [API периодов оплаты](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-billing-periods) для получения списка расчетных периодов и свойства, указывающего на путь API для четырех наборов данных API организации, относящихся к этому расчетному периоду — сводные сведения о балансе, подробные сведения о потреблении, затраты на Marketplace и прейскуранты.
-   **Рекомендации по резервированию Azure**. [API рекомендаций по резервированию экземпляров](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-reserved-instance-recommendation) оценивает сведения об использовании клиентом виртуальных машин за 7, 30 или 60 дней и предлагает на их основе рекомендации по отдельному и общему резервированию. API зарезервированных экземпляров позволяет клиентам оценить ожидаемую экономию и рекомендуемые объемы закупок.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="what-is-the-difference-between-the-enterprise-reporting-apis-and-the-consumption-apis-when-should-i-use-each"></a>Каковы отличия между API для корпоративной отчетности и API потребления? Когда их нужно использовать?
Эти API имеют аналогичный набор функций и могут ответить на тот же широкий набор вопросов в сфере выставления счетов и управления затратами. Тем не менее каждый API предназначен для разных категорий: 

- **API для корпоративной отчетности**. Эти API доступны для клиентов, подписавших Соглашение Enterprise с корпорацией Майкрософт, которое предоставляет им доступ к согласованным денежным обязательствам и индивидуальным ценам. API требуется использовать ключ, который можно получить через [Enterprise Portal](https://ea.azure.com). Описание этих API см. в статье [Обзор API-интерфейсов отчетов для корпоративных клиентов](billing-enterprise-api.md).

- **API потребления**. Эти API доступны для всех клиентов, за некоторыми исключениями. Дополнительные сведения см. в статье [Общие сведения об API потребления ресурсов Azure](billing-consumption-api-overview.md) и в [справочник по API потребления](https://docs.microsoft.com/rest/api/consumption/). Предоставленные API являются рекомендуемым решением для последних сценариев разработки. 

### <a name="what-is-the-difference-between-the-usage-details-api-and-the-usage-api"></a>Какова разница между API сведений о потреблении и API использования?
Эти API обеспечивают совершенно разные данные:

- **Сведения о потреблении**. [API сведений о потреблении](https://docs.microsoft.com/rest/api/consumption/usagedetails) предоставляет информацию о потреблении и затратах в Azure по экземпляру показателя. Предоставленные данные уже переданы по системе измерения затрат Azure. Затраты уже применены наряду с другими возможными изменениями:

    - Изменения в учетной записи для использования предоплаченных денежных обязательств.
    - Изменения в учетной записи для зависимостей потребления, обнаруживаемых Azure.

- **Использование**. [API использования](https://msdn.microsoft.com/library/Mt219003.aspx) предоставляет необработанные сведения по потреблению Azure, прежде чем они будут переданы по системе изменения затрат Azure. Эти данные могут не быть связаны с показателями потребления или суммой затрат, которые отображаются после системы измерения платежей Azure.

### <a name="what-is-the-difference-between-the-invoice-api-and-the-usage-details-api"></a>Каковы отличия между API счетов и API сведений о потреблении?
Эти API обеспечивают различное представление тех же данных. [API счетов](https://docs.microsoft.com/rest/api/billing/invoices) предназначен только для клиентов Web Direct и обеспечивает ежемесячное сведение счетов на основе статистических платежей для каждого типа показателя. [API сведений о потреблении](https://docs.microsoft.com/rest/api/consumption/usagedetails) обеспечивает подробное представление записей о потреблении или затратах за каждый день и может использоваться как клиентами Enterprise, так и Web Direct.

### <a name="what-is-the-difference-between-the-price-sheet-api-and-the-ratecard-api"></a>Каковы различия между API прейскурантов и API RateCard?
Эти API предоставляют похожие наборы данных, но имеют разные аудитории. См. информацию ниже.

- [API прейскурантов](https://docs.microsoft.com/rest/api/consumption/pricesheet) предоставляет пользовательские цены, которые были согласованы для корпоративного клиента.
- [API RateCard](https://msdn.microsoft.com/library/mt219005.aspx) предоставляет общие цены, которые применяются к клиентам Web Direct.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения по использованию API Azure для получения аналитики о потреблении Azure программными средствами см. в статье [Общие сведения об API потребления ресурсов Azure](billing-consumption-api-overview.md) и [Использование API выставления счетов Azure для программного получения ценных сведений об использовании Azure](billing-usage-rate-card-overview.md).
- Чтобы сравнить счет и файл с подробными данными о ежедневном использовании, а также отчеты об управлении затратами на портале Azure, ознакомьтесь со статьей [Расшифровка счета за использование Microsoft Azure](billing-understand-your-bill.md)
- Если у вас есть дополнительные вопросы, [обратитесь в службу поддержки](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade), которая поможет быстро устранить проблему.
