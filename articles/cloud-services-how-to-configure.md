<properties linkid="manage-services-how-to-configure-a-cloud-service" urlDisplayName="How to configure" pageTitle="How to configure a cloud service - Azure" metaKeywords="Configuring cloud services" description="Learn how to configure cloud services in Azure. Learn to update the cloud service configuration and configure remote access to role instances." metaCanonical="" services="cloud-services" documentationCenter="" title="How to Configure Cloud Services" authors="davidmu" solutions="" manager="" editor="" />

<tags ms.service="cloud-services" ms.workload="tbd" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="davidmu"></tags>

# <span id="configurecloudservice"></span></a>Как настроить облачные службы

[WACOM.INCLUDE [отказ от ответственности][отказ от ответственности]]

Часто используемые параметры облачной службы можно настроить на портале управления Azure. Также можно напрямую изменить файлы конфигурации. Для этого загрузите и измените нужный файл, а затем отправьте его для обновления конфигурации облачной службы. В любом случае обновления конфигурации применяются ко всем экземплярам ролей.

Также можно разрешить подключения удаленного рабочего стола к одной или всем ролям в облачной службе. Это позволит получить доступ к рабочему столу выполняющегося приложения для диагностики и устранения неполадок. Такие подключения к роли можно устанавливать даже в том случае, если при развертывании приложения не настроен файл определения службы (CSDEF) для удаленного рабочего стола. Повторное развертывание приложения для настройки подключений удаленного рабочего стола не требуется.

При наличии как минимум двух экземпляров (виртуальных машин) для каждой роли в процессе обновления конфигурации Azure обеспечивается доступность службы в течение 99,95 % времени. Такая конфигурация позволяет обрабатывать запросы клиентов на одной виртуальной машине во время обновления другой. Дополнительные сведения см. в разделе [Соглашения об уровне обслуживания][Соглашения об уровне обслуживания].

## Оглавление

-   [Практическое руководство. Обновление конфигурации облачной службы][Практическое руководство. Обновление конфигурации облачной службы]
-   [Практическое руководство. Настройка удаленного доступа к экземплярам ролей][Практическое руководство. Настройка удаленного доступа к экземплярам ролей]

## <span id="update"></span></a>Практическое руководство. Обновление конфигурации облачной службы

1.  Войдите на [Портал управления][Портал управления] и щелкните **Облачные службы**. Щелкните имя облачной службы, чтобы открыть панель мониторинга.

2.  Нажмите **Настроить**.

    На странице **Настройка** можно задать параметры мониторинга, обновить настройки ролей, а также выбрать гостевую операционную систему и семейство для экземпляров роли (виртуальные машины).

    ![Страница «Конфигурация»][Страница «Конфигурация»]

3.  В параметрах мониторинга задайте уровень "Подробно" или "Минимальный" и настройте строки подключения диагностики, необходимые для подробного мониторинга. Инструкции см. в разделе [Мониторинг облачных служб][Мониторинг облачных служб].

4.  Для ролей службы, сгруппированных по ролям, можно обновить следующие параметры:

    > -   **Настройки** — измените значения параметров конфигурации, определенных в элементах *ConfigurationSettings* файла конфигурации службы (CSCFG-файла).

    > -   **Сертификаты** — измените отпечаток сертификата, используемый при SSL-шифровании для роли. Чтобы сменить сертификат, загрузите новый сертификат на странице **Сертификаты**. После этого обновите отпечаток сертификата в строке в параметрах роли.

5.  В **параметрах операционной системы** можно задать версию или семейство ОС для экземпляров роли (виртуальные машины), а также выбрать параметр **Автоматически**, который позволяет возобновить автоматическое обновление в текущей версии ОС. Параметры операционной системы применяются к веб-ролям и рабочим ролям, но не распространяются на роли виртуальных машин, добавленные в размещенные службы в предыдущей версии портала управления Azure.

    При развертывании новой облачной службы можно выбрать операционную систему Windows Server 2008 R2, Windows Server 2008 с пакетом обновления 2 (SP2) или Windows Server 2012. В процессе развертывания на все экземпляры роли устанавливается последняя версия ОС с включенным по умолчанию автоматическим обновлением.

    Если требования к совместимости кода предусматривают работу с облачной службой в другой версии операционной системы, можно выбрать нужные версию и семейство ОС. При выборе конкретной версии ОС автоматическое обновление для облачной службы приостанавливается. В этом случае необходимо настроить обновление операционных систем.

    Если в последней версии ОС все проблемы с совместимостью приложений устранены, выберите версию **Автоматически**, чтобы возобновить автоматическое обновление операционной системы.

    ![Параметры ОС][Параметры ОС]

6.  Чтобы сохранить параметры конфигурации и передать их в экземпляры ролей, нажмите кнопку **Сохранить**. (Чтобы отменить изменения, нажмите кнопку **Отменить**.) Кнопки **Сохранить** и **Отменить** добавляются в панель команд после изменения параметра.

### Обновление файла конфигурации облачной службы вручную

1.  Загрузите файл конфигурации облачной службы (CSCFG) с текущей конфигурацией. На странице **Настройка** облачной службы щелкните **Загрузить**. Далее выберите команды **Сохранить** или **Сохранить как** для сохранения файла.

2.  Чтобы применить обновления конфигурации, передайте новый файл в службу:

    а) На странице **Настройка** щелкните элемент **Отправить**.

    Откроется окно **Передать файл конфигурации**.

    ![Отправка конфигурации][Отправка конфигурации]

    б) В разделе **Файл конфигурации** нажмите кнопку **Обзор** и выберите обновленный CSCFG-файл.

    в) Если в облачной службе содержатся роли с одним экземпляром, установите флажок **Применить, даже если одна или несколько ролей содержат отдельный экземпляр**, чтобы обеспечить обновление конфигурации ролей.

    Если для каждой роли не определены как минимум два экземпляра, Azure не гарантирует доступность службы в течение 99,95 % времени в процессе обновления конфигурации. Дополнительные сведения см. в разделе [Соглашения об уровне обслуживания][1].

    г) Нажмите кнопку «ОК» (флажок).

## <span id="remoteaccess"></span></a>Практическое руководство. Настройка удаленного доступа к экземплярам ролей

С помощью удаленного рабочего стола обеспечивается доступ к рабочему столу экземпляра, работающего в Azure. Подключение к удаленному рабочему столу позволяет диагностировать и устранять неполадки выполняющегося приложения. Включить такие подключения можно на этапе разработки приложения, а также после его развертывания в Azure при выполнении роли. Чтобы включить подключение к удаленному рабочему столу для выполняющейся роли на портале управления, не требуется повторное развертывание приложения. Для проверки подлинности такого подключения можно использовать как ранее переданный, так и новый сертификат.

На странице **Настройка** облачной службы можно включить удаленный рабочий стол, изменить учетную запись и пароль локального администратора для подключения к виртуальным машинам, выбрать сертификат для проверки подлинности, а также установить срок его действия.

<div class="dev-callout"> 
<b>Примечание.</b> 
<p>Если ваша облачная служба состоит из двух или более подключенных виртуальных машин на основе Windows Server, настраивать удаленный доступ не нужно, поскольку такие машины автоматически настраиваются для поддержки удаленного рабочего стола.</p> 
</div>

### Настройка удаленного доступа в файле определения службы

Добавьте в файл определения службы (CSDEF) элементы **Import**, позволяющие импортировать модули RemoteAccess и RemoteForwarder в модель службы. В этом случае Azure автоматически добавит параметры конфигурации удаленного рабочего стола в файл конфигурации службы. Чтобы завершить настройку удаленного рабочего стола, импортируйте в Azure сертификат и определите его в файле конфигурации службы. Дополнительную информацию см. в разделе [Настройка удаленного подключения к рабочему столу для роли в Azure][Настройка удаленного подключения к рабочему столу для роли в Azure].

### Включение или изменение параметров удаленного доступа для экземпляров роли на портале управления

1.  Войдите на [портал управления][Портал управления] и щелкните элемент **Облачные службы**. Щелкните имя облачной службы, чтобы открыть панель мониторинга.

2.  На странице **Настройка** облачной службы щелкните элемент **Удаленный доступ**.

    В окне **Настройка удаленного рабочего стола** будут показаны параметры, добавленные в файл конфигурации облачной службы в процессе развертывания (см. ниже).

    ![Удаленный доступ к облачным службам][Удаленный доступ к облачным службам]

> [WACOM.NOTE]
> **Внимание!** Если включить удаленный рабочий стол и нажать кнопку «ОК» (флажок), все экземпляры роли будут перезапущены. Если в роли установлен сертификат для шифрования пароля, перезапуск не производится. Если сертификат не установлен, отобразится такой параметр: ![CloudServices\_CreateNewCertDropDown][CloudServices\_CreateNewCertDropDown]

    To prevent a restart, install a certificate and then return to this dialog (see [Using Remote Desktop with Azure Roles][Using Remote Desktop with Azure Roles] for more information). If you choose an existing certificate, then a configuration update will be sent to all the instances in the role.

1.  В разделе **Роли** выберите роль службы, которую требуется обновить, или щелкните **Все**, чтобы задать все роли.

2.  Внесите любые из следующих изменений:

-   Чтобы включить удаленный рабочий стол, установите флажок **Включить удаленный рабочий стол**. Если доступ к удаленному рабочему столу не требуется, снимите этот флажок.

-   Создайте учетную запись, которая будет использоваться в подключениях к удаленному рабочему столу в экземплярах роли.

-   Обновите пароль существующей учетной записи.

-   Выберите сертификат, который будет использоваться для аутентификации: новый или переданный с помощью раздела **Отправка** на странице **Сертификаты**).

-   Измените срок действия для конфигурации удаленного рабочего стола.

1.  По завершении обновления нажмите кнопку «ОК» (флажок).

2.  Подключение к экземпляру роли:

    а) Щелкните элемент **Экземпляры**, чтобы перейти на страницу **Экземпляры**.

    б) Выберите экземпляр роли, для которого настроен удаленный рабочий стол.

    в) Щелкните **Подключить** и откройте рабочий стол виртуальной машины, следуя выводимым на экран инструкциям.

    г) Щелкните **Открыть** и затем **Подключить**, чтобы запустить подключение к удаленному рабочему столу.

### Отключение удаленного доступа для экземпляров роли на портале управления

1.  Войдите на [портал управления][Портал управления] и щелкните элемент **Облачные службы**. Щелкните имя облачной службы, чтобы открыть панель мониторинга.

2.  На странице **Настройка** облачной службы щелкните элемент **Удаленный доступ**.

3.  В разделе **Роли** выберите роль службы, которую требуется обновить, или щелкните **Все**, чтобы задать все роли.

4.  Снимите флажок **Включить удаленный рабочий стол**.

5.  Нажмите кнопку «ОК» (флажок).

  [отказ от ответственности]: ../includes/disclaimer.md
  [Соглашения об уровне обслуживания]: https://www.windowsazure.com/ru-ru/support/legal/sla/
  [Практическое руководство. Обновление конфигурации облачной службы]: #update
  [Практическое руководство. Настройка удаленного доступа к экземплярам ролей]: #remoteaccess
  [Портал управления]: http://manage.windowsazure.com/
  [Страница «Конфигурация»]: ./media/cloud-services-how-to-configure/CloudServices_ConfigurePage1.png
  [Мониторинг облачных служб]: ../how-to-monitor-a-cloud-service/
  [Параметры ОС]: ./media/cloud-services-how-to-configure/CloudServices_ConfigurePage_OSSettings.png
  [Отправка конфигурации]: ./media/cloud-services-how-to-configure/CloudServices_UploadConfigFile.png
  [1]: http://www.windowsazure.com/ru-ru/support/legal/sla/
  [Настройка удаленного подключения к рабочему столу для роли в Azure]: http://msdn.microsoft.com/ru-ru/library/windowsazure/hh124107.aspx
  [Удаленный доступ к облачным службам]: ./media/cloud-services-how-to-configure/CloudServices_Remote.png
  [CloudServices\_CreateNewCertDropDown]: ./media/cloud-services-how-to-configure/CloudServices_CreateNewCertDropDown.png
