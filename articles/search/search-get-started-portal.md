<properties 
	pageTitle="Начало работы со службой поиска Azure | Microsoft Azure | Облачная служба поиска | DocumentDB" 
	description="Это руководство поможет вам создать решение на основе службы поиска Azure. Узнайте, как создать индекс службы поиска Azure с помощью данных DocumentDB. Вы сможете это сделать без необходимости писать код, используя встроенные функции портала и мастер импорта данных." 
	services="search" 
	documentationCenter="" 
	authors="HeidiSteen" 
	manager="mblythe" 
	editor=""
    tags="azure-portal"/>

<tags 
	ms.service="search" 
	ms.devlang="na" 
	ms.workload="search" 
	ms.topic="hero-article" 
	ms.tgt_pltfrm="na" 
	ms.date="02/10/2016" 
	ms.author="heidist"/>

# Начало работы со службой поиска Azure на портале Azure

Служба поиска Microsoft Azure — это облачная служба, которая позволяет добавлять в пользовательские приложения возможности поиска. Это поисковая система и хранилище для данных, к которым можно обращаться (в том числе для управления), используя портал Azure, пакет SDK для .NET или REST API.

В этой статье в общих чертах (без примеров кода) описывается использование службы поиска Azure с помощью средств портала. Для работы с руководством вам понадобится [образец базы данных Azure DocumentDB](#apdx-sampledata). Следуя инструкциям, вы сможете создать этот образец с помощью нашего образца данных или с использованием существующих данных, содержащихся в базе данных DocumentDB или SQL.

> [AZURE.NOTE] Также вам понадобится [подписка Azure](../includes/free-trial-note.md) и [служба поиска Azure](search-create-service-portal.md). Если вы не хотите регистрироваться и получать пробную подписку, пропустите это руководство и обратитесь вместо него к [службе ознакомления с приложениями Azure](search-tryappservice.md). Выбрав этот альтернативный вариант, вы сможете пользоваться поиском Azure с веб-приложением ASP.NET бесплатно (в течение одного часа за один сеанс); подписка в таком случае не требуется.
 
## Поиск службы

1. Войдите на [портал Azure](https://portal.azure.com).

2. Откройте служебную панель службы поиска Azure. Найти панель мониторинга можно несколькими способами.
	- В указателе щелкните **Службы поиска**. В указателе отображаются все службы, подготовленные в вашей подписке. Если служба поиска определена, вы увидите в списке пункт **Службы поиска**.
	- В указателе щелкните **Обзор** и введите в поле поиска слово "поиск". Отобразится список всех служб поиска, созданных в ваших подписках.

## Проверка доступного пространства

Многие пользователи предпочитают начать работу с бесплатной службой. В бесплатной версии можно использовать только три индекса, три источника данных и три индексатора. Перед выполнением инструкций убедитесь, что у вас достаточно места для дополнительных элементов. В этом руководстве каждый объект создается один раз.

## Создание индекса и загрузка данных

Поисковые запросы выполняют итерацию по *индексу*, содержащему доступные для поиска данные, метаданные и конструкции, которые используются для оптимизации способов поиска. Для начала необходимо определить и заполнить индекс.

Создать индекс можно несколькими способами. Эти подходы отличаются степенью автоматизации или интеграции. Если в хранилище, которое может просканировать служба поиска Azure (это может быть база данных SQL Azure, SQL Server на виртуальной машине Azure или DocumentDB), есть пригодные для использования данные, создайте и заполните индекс с помощью индексатора.

Для упрощения предположим, что у нас есть источник данных, который служба поиска Azure может просканировать с помощью одного из своих *индексаторов* и мастера **импорта данных**.

Для работы с этим руководством вам нужно создать [образец базы данных DocumentDB](#apdx-sampledata). Но вы можете использовать и собственные данные, следуя приведенным инструкциям.

<a id="defineDS"></a>
#### Этап 1. Определение источника данных

1. На панели мониторинга службы поиска Azure щелкните в командной строке **Импорт данных**. Запустится мастер, который создает и заполняет индекс.

2. Щелкните **Источник данных** > **DocumentDB** > **Имя**, а затем введите имя источника данных. Источник данных — это объект подключения в службе поиска Azure, который может использоваться с другими индексаторами. После создания он будет доступен в службе как существующий источник данных.

3. Выберите существующую учетную запись DocumentDB, а также базу данных и коллекцию. Если вы используете наш образец данных, определение источника данных будет выглядеть так:

  ![][2]

Обратите внимание, что мы пропускаем поле запроса. Это связано с тем, что сейчас мы не внедряем отслеживание изменений в наш набор данных. Если набор данных включает поле, которое отвечает за отслеживание обновления записи, вы можете настроить индексатор поиска Azure и отслеживать выборочные изменения индекса.

Щелкните **ОК**, чтобы завершить этот этап мастера.

#### Этап 2. Определение индекса

В окне мастера щелкните **Индекс**. Отобразится рабочая область конструирования, которая используется для создания индекса службы поиска Azure. Для индекса необходимо обязательно указать имя и коллекцию полей, а одно поле отметить как ключ документа. Поскольку мы используем набор данных DocumentDB, поля определяются мастером автоматически, а индекс загружается с предварительно назначенными полями и типами данных.

  ![][3]

Хотя поля и типы данных настроены, вам нужно назначить атрибуты. Флажки в верхней части списка полей — это *атрибуты индекса*, которые определяют, как используется поле.

- **Доступный для получения** означает, что поле отображается в списке результатов поиска. Вы можете отметить отдельные поля, чтобы исключить их из результатов поиска, например, если такие поля используются только в выражениях фильтра. 
- Атрибуты **Фильтруемый**, **Сортируемый** и **Аспектируемый** определяют, может ли поле использоваться в структуре фильтруемой, сортируемой или аспектной навигации. 
- **Доступный для поиска** означает, что поле включено в полнотекстовый поиск. Поиск по числовым и логическим полям часто исключается. 

Прежде чем покинуть эту страницу, отметьте поля в индексе, используя перечисленные параметры ("Доступный для получения", "Доступный для поиска" и т. д.). Большинство полей отмечаются как доступные для получения. Большинство строковых полей отмечаются как доступные для поиска (вам не нужно делать ключ доступным для поиска). Несколько полей, включая genre, orderableOnline, rating и tags, также являются фильтруемыми, сортируемыми и аспектируемыми.
	
Поле | Тип | Параметры |
------|------|---------|
key | Edm.String | |
albumTitle | Edm.String | Доступное для получения, доступное для поиска |
albumUrl | Edm.String | Доступное для получения, доступное для поиска |
genre | Edm.String | Доступное для получения, доступное для поиска, фильтруемое, сортируемое, аспектируемое |
genreDescription | Edm.String | Доступное для получения, доступное для поиска |
artistName | Edm.String | Доступное для получения, доступное для поиска |
orderableOnline | Edm.Boolean | Доступное для получения, фильтруемое, сортируемое, аспектируемое |
tags | Collection(Edm.String) | Доступное для получения, фильтруемое, аспектируемое |
price | Edm.Double | Доступное для получения, фильтруемое, аспектируемое |
margin | Edm.Int32 | |
рейтинг | Edm.Int32 | Доступное для получения, фильтруемое, сортируемое, аспектируемое |
inventory | Edm.Int32 | Доступный для получения |
lastUpdated | Edm.DateTimeOffset | |

Для сравнения на следующем снимке экрана показан индекс, соответствующий спецификации в предыдущей таблице.

 ![][4]

Щелкните **ОК**, чтобы завершить этот этап мастера.

#### Этап 3. Определение индексатора

В мастере **Импорт данных** щелкните **Индексатор** > **Имя**, введите имя индексатора и оставьте параметры по умолчанию для всех остальных значений. Этот объект определяет исполняемый процесс. После его создания вы можете задать для него повторяющееся расписание. А пока используйте параметр по умолчанию, чтобы однократно и немедленно запустить индексатор после нажатия кнопки **ОК**.

Все импортируемые элементы данных должны быть заполнены и готовы к работе.

  ![][5]

Нажмите кнопку **ОК**, чтобы запустить мастер и начать импорт, а затем закройте мастер.

## Проверка хода выполнения

Чтобы проверить ход выполнения, на панели мониторинга службы дважды щелкните плитку **Индексаторы**. Откроется список индексаторов. В списке вы увидите только что созданный индексатор, состояние, указывающее на выполнение или завершение, а также количество документов, проиндексированных в службе поиска Azure.

  ![][6]

## Запрос индекса

Теперь индекс службы поиска может создавать запросы.

**Обозреватель поиска** — это средство работы с запросами, встроенное в портал. Это поле для поиска, с помощью которого можно проверить, как условия поиска возвращают ожидаемые данные.

1. Щелкните **Обозреватель поиска** на панели команд.
2. Проверьте, какой индекс является активным. Если это не тот, который вы только что создали, на панели команд щелкните **Изменить индекс** и выберите нужный индекс.
2. Оставьте поле поиска пустым и нажмите кнопку **Поиск**, чтобы выполнить поиск с использованием подстановочных знаков, который возвращает все документы.
3. Введите несколько запросов для полнотекстового поиска. Просмотрев результаты поиска, в котором используются подстановочные знаки, вы можете ознакомиться с исполнителями, альбомами и жанрами и создавать на основе этих сведений запросы.
4. Попробуйте использовать другой синтаксис запросов (см. [примеры, приведенные в конце этой статьи](https://msdn.microsoft.com/library/azure/dn798927.aspx)), чтобы запрос включал строки поиска, которые предположительно можно найти в вашем индексе.

## Дальнейшие действия

После первого запуска мастера вы можете вернуться назад и просмотреть или изменить отдельные компоненты: индекс, индексатор или источник данных. Некоторые изменения, например изменение типа данных поля, недоступны в индексе, но большинство свойств и настроек можно изменять. Чтобы просмотреть отдельные компоненты, на панели мониторинга щелкните плитку **Индекс**, **Индексатор** или **Источник данных**. Отобразится список существующих объектов.

Дополнительные сведения о других возможностях, упоминаемых в этом руководстве, см. в следующих статьях.

- [Индексаторы](search-indexer-overview.md)
- [Create Index (Azure Search Service REST API)](https://msdn.microsoft.com/library/azure/dn798941.aspx) (Создание индекса (REST API службы поиска Azure)). Содержит подробное описание атрибутов индекса.
- [Обозреватель поиска](search-explorer.md)
- [Search Documents (Azure Search Service REST API)](https://msdn.microsoft.com/library/azure/dn798927.aspx) (Поиск по документам (REST API службы поиска Azure)). Содержит примеры синтаксиса запросов.

Попробуйте выполнить эти же действия, используя мастер импорта данных с другими источниками данных, например с базой данных SQL Azure или SQL Server на виртуальных машинах Azure.

> [AZURE.NOTE] Недавно на портале была реализована поддержка индексатора для сканирования хранилища BLOB-объектов Azure, но пока эта функция доступна только в режиме предварительной версии. Чтобы протестировать этот индексатор, необходимо написать код. Дополнительные сведения см. в статье [Индексирование документов в хранилище BLOB-объектов Azure с помощью службы поиска Azure](search-howto-indexing-azure-blob-storage.md). <a id="apdx-sampledata"></a>


## Приложение. Получение образца данных из базы данных DocumentDB

В этом разделе описывается создание небольшой базы данных в DocumentDB, которую можно использовать для работы с руководством.

Приведенные ниже инструкции содержат общие рекомендации, но не являются исчерпывающими. Если вам нужна дополнительная помощь по навигации или задачам на портале DocumentDB, см. документацию по DocumentDB. Большинство команд, которые вам понадобятся, находятся на панели команд службы в верхней части панели мониторинга или в колонке базы данных.

  ![][1]

Для этого набора данных доступно 246 документов JSON. Для отправки данных с помощью обозревателя документов вам нужно разбить это количество на несколько пакетов так, чтобы каждый пакет включал не более 100 документов.

[Щелкните здесь](https://github.com/HeidiSteen/azure-search-get-started-sample-data), чтобы загрузить файлы данных JSON из магазина музыки.

1. Добавьте DocumentDB в свою подписку, а затем откройте панель мониторинга службы.
2. Щелкните **Добавить базу данных**, чтобы создать базу данных с идентификатором `musicstoredb`. Созданная база данных будет отображаться в соответствующем списке на странице ниже.
2. Щелкните имя базы данных, чтобы открыть колонку базы данных.
3. Щелкните **Добавить коллекцию**, чтобы создать коллекцию с идентификатором `musicstorecoll`.
3. Щелкните **Обозреватель документов**.
4. Щелкните **Добавить документы**.
5. В окне **добавления документов** загрузите файлы JSON.
	- 386\.json
	- 387\.json
	- ...
6. Щелкните **Обозреватель запросов**, чтобы проверить отправку данных.
7. Проще всего это сделать, изменив запрос по умолчанию так, чтобы он выбирал 300 лучших результатов (всего доступно меньше 300 элементов). Вы также можете добавить `select * from musicstorecoll`, а затем нажать кнопку **Выполнить запрос**.

Вы должны получить выходные данные JSON, представленные набором документов с номерами 386–669. Загруженные данные можно [использовать на этом этапе](#defineDS) с помощью **мастера импорта** службы поиска Azure.


<!--Image references-->
[1]: ./media/search-get-started-portal/AzureSearch-GetStart-Docdbmenu1.png
[2]: ./media/search-get-started-portal/AzureSearch-GetStart-DataSource.png
[3]: ./media/search-get-started-portal/AzureSearch-GetStart-DefaultIndex.png
[4]: ./media/search-get-started-portal/AzureSearch-GetStart-FinishedIndex.png
[5]: ./media/search-get-started-portal/AzureSearch-GetStart-ImportReady.png
[6]: ./media/search-get-started-portal/AzureSearch-GetStart-IndexerList.png

<!---HONumber=AcomDC_0211_2016-->