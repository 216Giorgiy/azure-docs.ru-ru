<properties
	pageTitle="Индексы в службе поиска Azure | Microsoft Azure | Размещенная облачная служба поиска"
	description="Что такое индекс в службе поиска Azure и как он используется?"
	services="search"
	documentationCenter=""
	authors="HeidiSteen"
	manager="mblythe"
	editor=""
    tags="azure-portal"/>

<tags
	ms.service="search"
	ms.devlang="na"
	ms.workload="search"
	ms.topic="get-started-article"
	ms.tgt_pltfrm="na"
	ms.date="11/09/2015"
	ms.author="heidist"/>

# Индексы в службе поиска Azure
> [AZURE.SELECTOR]
- [Overview](search-what-is-an-index.md)
- [Portal](search-create-index-portal.md)
- [.NET](search-create-index-dotnet.md)
- [REST](search-create-index-rest-api.md)

Поиск Azure — это размещенная облачная служба поиска, состоящая из следующих компонентов: поисковая система, функции поиска, позволяющие выполнять поиск в пользовательском приложении так же, как в Bing или Google, программное обеспечение .NET и интерфейсы REST API для интеграции службы поиска Azure с веб-приложением или настольным приложением, а также хранилище данных для поиска, которые имеют формат *индексов*.

##Что такое индекс

*Индекс* — это постоянное хранилище *документов* и других конструкций, используемое службой поиска Azure. Документы являются основной единицей данных, доступных для поиска. Например, документу розничного магазина может соответствовать номер SKU, документу новостной организации — статья, а документу медиакомпании —видео или песня в библиотеке компании. Можно сравнить эти понятия с более знакомыми понятиями баз данных. В таком случае *индекс* похож на *таблицу*, а *документы* — на *строки* в ней.

Индекс с документами является плоским набором данных. Обычно он содержит данные, созданные или собранные в ходе стандартных бизнес-операций с применением компьютеризованных процессов. Такими процессами могут быть публикация материалов, сделки по продаже или покупке и т. п. Информация может храниться в реляционной базе данных или базе данных NoSQL. Индекс получает документы, когда пользователь передает или запрашивает набор данных, содержащий строки из других источников данных.

В контексте обработчика операций поиска индекс содержит все данные, которые нужны для обработки индекса, выполнения запроса и возврата следующих данных: список результатов поиска, структура фасетной навигации, страница подробной информации для одного документа. В поиске Azure индекс может содержать и недоступные для поиска данные, которые используются внутри системы в выражениях фильтрации или профилях повышения, которые содержат критерии для увеличения рейтинга.

##Когда следует создавать индекс?

При подготовке службы поиска для использования в приложении необходимо создать индекс. Основная задача при создании индекса — это определение его схемы. Как минимум для этого следует определить поля и настроить атрибуты. По желанию вы можете расширить индекс, включив в него профили повышения, предложения и значения по умолчанию.

Для создания схемы, которая определяет индекс, можно использовать портал или написать код, который вызывает REST API или пакет SDK для .NET.

Определив схему и создав индекс, его следует заполнить. Это отдельная операция. Дополнительные сведения о передаче данных после создания индекса см. в статье [Импорт данных в службу поиска Azure](search-what-is-data-import.md).

##Спецификация схемы JSON для индекса

Ниже указаны основные разделы индекса поиска Azure, выраженные в формате обмена данными JSON.

|Элемент схемы|Описание|
|--------------|-----------|
|Коллекция полей|Поля определяют документ. Набор данных, который вы помещаете в индекс путем передачи или опроса, должен содержать для каждого поля значения (или NULL), совместимые c типом и размером полей, которые определены в схеме.|
|[Атрибуты](#index-attributes)|Атрибуты или аннотации к полю указывают тип данных, длину, значение и типы поведения, разрешенные для этого поля. Вы можете указать, доступно ли каждое из полей для поиска, извлечения или сортировки данных. Можно также указать, какой анализатор языка имеет приоритет на уровне полей.
|[Профили оценки](https://msdn.microsoft.com/library/azure/dn798928.aspx)|Критерии, которые используются для повышения ранжирования найденного совпадения, если оно соответствует большему количеству характеристик, заданных в профиле. Например, в условии поиска задано имя продукта и описание продукта, а вы хотите, чтобы совпадения с названием продукта оценивались выше, чем совпадения с описанием.|
|[Средства подбора](https://msdn.microsoft.com/library/azure/mt131377.aspx)|Также называются запросами автозавершения или упреждающего ввода. Они определяются в отдельном разделе индекса.|
|[Анализаторы языков по умолчанию]()|По желанию вы можете задать их на уровне индекса, чтобы они применялись глобально для всех полей.|
|Параметры CORS|По желанию вы можете разрешить использовать общий доступ к ресурсам независимо от источника, т. е. использовать веб-страницы ресурсов, расположенных в другом домене. CORS по умолчанию всегда отключен, если вы не включите его для индекса явным образом.|

<a name="index-attributes"></a>
##Атрибуты индекса

Атрибуты устанавливаются для отдельных полей для определения того, как эти поля будут использоваться. Доступные атрибуты перечислены в следующей таблице.

|**Свойство**|Описание|
|------------|-----------|
|**Доступный для получения**|Указывает, возвращать ли поле в результатах поиска.|
|**Фильтруемый**|Позволяет использовать поле в запросах **$filter**.|
|**Сортируемый**|Позволяет использовать поле в качестве параметра сортировки набора результатов.|
|**Facetable**|Позволяет использовать поле в структуре фасетной навигации для автоматической фильтрации пользователем. Обычно для фасетной навигации подходят поля, содержащие повторяющиеся значения, которые можно использовать для группирования различных документов (например, если несколько документов относятся к одной и той же категории или к одному производителю).|
|**Ключ**|Уникальный строковый идентификатор (ключ) каждого документа, по которому выполняется обращение к документам. У каждого индекса должен быть один ключ. Ключом может быть только одно поле, и это поле должно иметь значение Edm.String.|
|**Доступный для поиска**|Помечает поле как доступное для полнотекстового поиска.|


##Использование индексов в службе поиска Azure

Все операции, связанные с данными, выполняемые в службе поиска Azure, используют или возвращают данные из индекса. Исключений нет: в качестве источника внешних данных, из которого служба поиска возвращает ответ, можно указать только индекс.

Для приложений, которые накапливают данные и оперируют ими (например, транзакции продаж в приложении интернет-магазина), индекс службы поиска Azure будет дополнительным источником данных в общем решении. Индекс — это выделенное хранилище данных, которое используется только службой поиска. Наличие выделенного источника данных, близкого к службе поиска, гарантирует согласованность в результатах поиска, уменьшает изменчивость данных, уменьшает число круговых путей между вашим приложением и службой поиска Azure, а также повышает общую производительность операций поиска, поскольку конкуренция за ресурсы или данные отсутствует.

##Рекомендации по определению схемы

Схемы создаются в виде JSON-структур. Вам необходимо создать один индекс для каждого пользовательского решения, которое интегрируется со службой поиска Azure. Нельзя связывать или объединять несколько индексов, но можно создавать сложные индексы, которые могут использоваться в различных сценариях поиска, необходимых для вашего решения. Например, если ваши приложения поддерживают несколько языков, коллекция полей в индексе может содержать варианты на разных языках для каждого поля.

Проектируя индекс, тщательно продумайте каждое решение на этапе планирования. Изменение индекса после развертывания повлечет за собой перестройку и повторную загрузку данных. Создать индекс в коде гораздо проще, чем создать его вручную на портале.

Для создания эффективной схемы необходимо четкое понимание исходного источника данных. Необходимо сопоставить типы данных, выбрать правильное поле в качестве *ключа*, который однозначно идентифицирует каждый документ в индексе, и определить поля, которые будут представлены в списке результатов поиска или на странице сведений.

**Приступая к работе с реляционными данными**

Реляционные данные не всегда легко преобразовать в плоский набор данных. Если возможно, используйте корпоративное хранилище данных или базу отчетов, если у компании такие есть. Такие ресурсы подходят лучше всего, поскольку используют денормализованную модель данных. В противном случае нужный набор строк придется получать с помощью запросов. Пример и объяснение того, как это сделать, см. в статье [Моделирование учетной базы данных AdventureWorks для службы поиска Azure](http://blogs.technet.com/b/onsearch/archive/2015/09/08/modeling-the-adventureworks-inventory-database-for-azure-search.aspx).

**Добавление двоичных данных**

Возможно, вы хотите выводить в результатах поиска изображения, аудио или видео. Такие данные будут храниться в других местах. В самом индексе нужно создать поле, в котором хранится URL-адрес внешнего ресурса. Любое (особенно двоичное) содержимое, по которому не выполняется поиск, желательно хранить в более дешевом хранилище и обращаться к нему по URI, который хранится в поле индекса.

**Синхронизация данных**

Как вы уже догадались, индекс должен регулярно синхронизироваться с другими источниками данных, которые используются в решении. В каталоге интернет-магазина база данных инвентаризации, в которой фиксируются транзакции продаж, должна содержать номера SKU, цены и данные о наличии, которые соответствуют данным, отображаемым в результатах поиска. В зависимости от времени задержки, приемлемого для вашего решения, можно настроить синхронизацию данных раз в неделю, раз в день или практически в реальном времени с помощью параллельных операций записи в базу данных инвентаризации и индекс службы поиска Azure. Подробные сведения см. в статье [Импорт данных в службу поиска Azure](search-what-is-data-import.md).

## Хранение в облаке

Поскольку служба поиска Azure является полностью управляемой, хранение данных обрабатывается как внутренняя операция. Программисты должны понимать, что нельзя обойти API-интерфейсы службы поиска Azure для прямого подключения к индексу. Кроме того, отслеживать размер или работоспособность индекса можно только с помощью уведомлений на портале или вызовов API. Нельзя создать резервную копию индекса, восстановить его, оптимизировать индекс или настроить его производительность на уровне хранилища. По сути данные хранятся в хранилище больших двоичных объектов, но лучше всего представить себе физическое хранение индекса и управление им в виде способа реализации, который в будущем может измениться. Одно из основных преимуществ службы заключается в том, что вам не нужно самостоятельно физически управлять вычислительными ресурсами поискового приложения.

Если объем запросов или требования к хранилищу данных изменятся со временем, можно увеличить или уменьшить емкость посредством добавления или перемещения реплик и разделов. Дополнительные сведения см. в статьях [Управление службой поиска в Microsoft Azure](search-manage.md) и [Ограничения поиска Azure](search-limits-quotas-capacity.md).

<!----HONumber=Nov15_HO4-->