<properties
	pageTitle="Начало работы со службой поиска Azure в Java | Microsoft Azure | Размещенная облачная служба поиска"
	description="Создание облачного приложения поиска в Azure с использованием Java в качестве языка программирования."
	services="search"
	documentationCenter=""
	authors="HeidiSteen"
	manager="mblythe"
	editor="v-lincan"/>

<tags
	ms.service="search"
	ms.devlang="na"
	ms.workload="search"
	ms.topic="hero-article"
	ms.tgt_pltfrm="na"
	ms.date="11/04/2015"
	ms.author="heidist"/>

# Начало работы с Поиском Azure в Java

Узнайте, как создать собственное приложение поиска на Java, использующее Поиск Azure. В этом руководстве [REST API службы поиска Azure](https://msdn.microsoft.com/library/dn798935.aspx) применяется для создания объектов и операций, используемых в этом уроке.

При создании и проверке этого примера мы использовали следующее программное обеспечение:

- [Интегрированная среда разработки Eclipse для разработчиков Java EE](https://eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/lunar). Обязательно загрузите версию EE. На одном из этапов проверки требуется функция, доступная только в этом выпуске.

- [JDK 8u40](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)

- [Apache Tomcat 8.0](http://tomcat.apache.org/download-80.cgi)

Чтобы запустить этот пример, вам потребуется служба поиска Azure, в которой можно зарегистрироваться на [портале управления Azure](https://portal.azure.com).

> [AZURE.TIP]Загрузите исходный код для этого учебника в разделе [Azure Search Java demo](http://go.microsoft.com/fwlink/p/?LinkId=530197) на Github.

## О данных

В этом примере приложения используются данные [Геологической службы США (USGS)](http://geonames.usgs.gov/domestic/download_data.htm), отфильтрованные по штату Род-Айленд для сокращения размера набора данных. Мы будем использовать эти данные при создании приложения поиска, возвращающего важные здания, такие как больницы и школы, а также геологические объекты, например реки, озера и вершины.

В этом приложении программа **SearchServlet.java** создает и загружает индекс с помощью конструкции [Indexer](https://msdn.microsoft.com/library/azure/dn798918.aspx), получая отфильтрованный набор данных USGS из общей Базы данных SQL Azure. Готовые учетные данные и сведения о подключении к сетевому источнику данных предоставляются в программном коде. С точки зрения доступа к данным дальнейшая настройка не требуется.

> [AZURE.NOTE]Мы применили фильтр к этому набору данных, чтобы не превысить ограничение бесплатной ценовой категории в 10 000 документов. При использовании стандартной категории это ограничение не накладывается, и вы можете изменять этот код для использования большего набора данных. Подробнее об ограничениях каждой ценовой категории см. в разделе [Ограничения](search-limits-quotas-capacity.md).

## Сведения о файлах программы

Ниже перечислены файлы, относящиеся к этому примеру.

- Search.jsp: предоставляет пользовательский интерфейс
- SearchServlet.java: предоставляет методы (аналогично контроллеру в MVC)
- SearchServiceClient.java: обрабатывает HTTP-запросы
- SearchServiceHelper.java: вспомогательный класс, предоставляющий статические методы
- Document.java: предоставляет модель данных
- config.properties: устанавливает URL-адрес и ключ API службы поиска
- Pom.xml: зависимость Maven


## Создание службы

1. Войдите на [портал Azure](https://portal.azure.com).

2. На панели быстрых переходов последовательно щелкните элементы **Создать** > **Данные+хранилище** > **Поиск**.

     ![][1]

3. Настройте имя службы, ценовую категорию, группу ресурсов, подписку и расположение. Эти параметры обязательны. Их невозможно изменить после подготовки службы.

     ![][2]

	- **Имя службы** должно быть уникальным и содержать не более 15 строчных символов без пробелов. Это имя относится к конечной точке службы поиска Azure. Дополнительные сведения о правилах именования см. в разделе [Правила именования](https://msdn.microsoft.com/library/azure/dn857353.aspx).

	- **Ценовая категория** определяет доступные возможности и порядок выставления счетов. Оба уровня обеспечивают аналогичные функции на разных уровнях ресурсов.

		- **Бесплатная служба** доступна на кластерах, используемых совместно с другими подписчиками. Этот уровень позволяет использовать учебники и писать экспериментальный код, однако не предназначен для рабочих приложений. Развертывание бесплатной службы обычно длится всего несколько минут.
		- **Стандартная служба** доступна на выделенных ресурсах и отличается высокой масштабируемостью. Изначально стандартная служба включает одну реплику и один раздел, но после создания службы вы можете изменить ее функциональные возможности. Развертывание стандартной службы занимает больше времени (обычно около пятнадцати минут).

	- **Группы ресурсов** — это контейнеры для служб и ресурсов, используемых для одной и той же цели. Например, если вы создаете пользовательское приложение поиска на основе Поиска Azure, Веб-сайтов Azure или хранилища больших двоичных объектов Azure, можно создать группу ресурсов, которая будет объединять все эти службы вместе на страницах портала управления.

	- В разделе **Подписка** вы можете выбрать одну из нескольких подписок (при наличии).

	- **Расположение** — это регион центра обработки данных. В настоящее время все ресурсы должны относиться к одному центру обработки данных. Распределение ресурсов между несколькими центрами обработки данных не поддерживается.

4. Нажмите кнопку **Создать**, чтобы подготовить службу.

Следите за уведомлениями на навигационной панели. Когда служба будет готова к использованию, отобразится соответствующее уведомление.

<a id="sub-2"></a>
## Поиск имени службы и ключа API службы поиска Azure

После создания службы можно вернуться на портал, чтобы получить URL-адрес и `api-key`. Для подключения к службе поиска вам потребуется как URL-адрес, так и `api-key`, чтобы проверить подлинность при вызове.

1. На навигационной панели нажмите кнопку **Главная** и выберите службу поиска, чтобы открыть панель мониторинга службы.

2. На панели мониторинга службы вы увидите элементы, указывающие на важную информацию, а также значок ключа для доступа к ключам администратора.

  	![][3]

3. Скопируйте URL-адрес службы и ключ администратора. Все эти элементы потребуются вам позже, при добавлении их в файл **config.properties**.

## Загрузка примеров файлов

1. Перейдите в раздел [AzureSearchJavaDemo](http://go.microsoft.com/fwlink/p/?LinkId=530197) на Github.

2. Нажмите кнопку **Загрузить ZIP-файл**, сохраните ZIP-файл на диск, после чего извлеките все содержащиеся в нем файлы. Вы можете извлечь файлы в рабочую область Java, чтобы облегчить поиск проекта в дальнейшем.

3. Примеры файлов доступны только для чтения. Щелкните правой кнопкой мыши папку, откройте ее свойства и снимите атрибут только для чтения.

Все последующие изменения и операторы выполнения будут применяться к файлам в этой папке.

## Импорт проекта

1. В Eclipse выберите **Файл** > **Импорт** > **Общие** > **Существующие проекты в рабочую область**.

    ![][4]

2. В поле **Выберите корневой каталог** перейдите в папку, содержащую примеры файлов. Выберите папку, содержащую папку .project. Проект должен отобразиться в списке **Проекты** как выбранный элемент.

    ![][12]

3. Нажмите кнопку **Готово**

4. Используйте **Обозреватель проектов** для просмотра и редактирования файлов. Если обозреватель еще не открыт, щелкните **Окно** > **Показать представление** > **Обозреватель проектов** или откройте его с помощью ярлыка.

## Настройка URL-адреса и ключа API службы

1. В **Обозревателе проектов** дважды щелкните файл **config.properties**, чтобы изменить параметры конфигурации, содержащие имя сервера и ключ API.

2. См. предыдущие шаги в этой статье, в рамках которых вы нашли URL-адрес и ключ API службы на [портале Azure](https://portal.azure.com), чтобы получить значения, которые вы теперь введете в файл **config.properties**.

3. В файле **config.properties** замените "Api Key" на ключ API для вашей службы. Затем имя службы (первый компонент URL-адреса http://servicename.search.windows.net) заменяет "service name" в том же файле.

	![][5]

## Настройка сред проекта, создания и выполнения

1. В Eclipse в обозревателе проектов щелкните проект правой кнопкой мыши, а затем выберите **Свойства** > **Аспекты проекта**.

2. Выберите **Динамический веб-модуль**, **Java** и **JavaScript**.

    ![][6]

3. Нажмите кнопку **Применить**.

4. Выберите **Окно** > **Настройки** > **Сервер** > **Среда выполнения** > **Добавить...**

5. Разверните Apache и выберите ранее установленную версию Apache Tomcat. В нашей системе мы установили версию 8.

	![][7]

6. На следующей странице укажите каталог установки Tomcat. На компьютере под управлением Windows это, скорее всего, будет C:\\Program Files\\Apache Software Foundation\\Tomcat *версия*

6. Нажмите кнопку **Готово**

7. Выберите **Окно** > **Настройки** > **Java** > **Установленные JRE** > **Добавить**.

8. В окне **Добавить JRE** выберите **Стандартная виртуальная машина**.

10. Нажмите кнопку **Далее**.

11. В разделе "Определение JRE" в главном окне выберите **Каталог**.

12. Перейдите в папку **Program Files** > **Java** и выберите ранее установленный пакет JDK. Важно выбрать пакет JDK в качестве JRE.

13. В разделе "Установленные JRE" выберите пакет **JDK**. Ваши параметры должны выглядеть примерно так.

    ![][9]

14. При необходимости выберите **Окно** > **Веб-браузер** > **Internet Explorer**, чтобы открыть приложение во внешнем окне браузера. Использование внешнего браузера обеспечивает лучшую работу веб-приложения.

    ![][8]

Процедура настройки завершена. Далее вы соберете и запустите проект.

## Сборка проекта

1. В обозревателе проектов щелкните имя проекта правой кнопкой мыши и выберите **Запуск от имени** > **Сборка Maven...**, чтобы настроить проект.

    ![][10]

8. В разделе "Изменить конфигурацию" в поле "Цели" введите "чистая установка" и нажмите **Выполнить**.

Сообщения о состоянии выводятся в окне консоли. Вы увидите сообщение "СБОРКА ПРОШЛА УСПЕШНО", указывающее на выполнение сборки проекта без ошибок.

## Запуск приложения

На последнем этапе вы запустите приложение в среде выполнения локального сервера.

Если вы еще не указали среду выполнения сервера в Eclipse, сделайте это в первую очередь.

1. В обозревателе проектов разверните **WebContent**.

5. Щелкните правой кнопкой мыши **Search.jsp** > **Запуск от имени** > **Запустить на сервере**. Выберите сервер Apache Tomcat и нажмите кнопку **Запуск**.

> [AZURE.TIP]Если для хранения проекта использовалась рабочая область не по умолчанию, вам придется изменить конфигурацию при запуске и указать расположение проекта, чтобы избежать ошибки при запуске сервера. В обозревателе проектов щелкните правой кнопкой мыши **Search.jsp** > **Запуск от имени** > **Конфигурации запуска**. Выберите сервер Apache Tomcat. Выберите **Аргументы**. Выберите **Рабочая область** или **Файловая система**, чтобы указать папку с проектом.

При запуске приложения должно отобразиться окно браузера с полем поиска для ввода условий поиска.

Подождите около одной минуты, прежде чем нажать кнопку **Поиск**, чтобы служба успела создать и загрузить индекс. Если возникает ошибка HTTP 404, подождите еще немного и попробуйте снова.

## Поиск по данным USGS

Набор данных USGS включает записи, относящиеся к штату Род-Айленд. Если нажать кнопку **Поиск** в пустом поле поиска, вы получите 50 первых записей. Это настройка по умолчанию.

Если ввести условие поиска, поисковая система будет искать конкретные записи. Попробуйте ввести региональное имя или название. "Роджер Уильямс" был первым губернатором Род-Айленда. В его честь названы многие парки, здания и школы.

![][11]

Вы также можете попробовать одно из следующих условий поиска:

- Потакет
- Пемброк
- гусь +мыс

## Дальнейшие действия

Это первый учебник по Поиску Azure на базе Java и набора данных USGS. Мы будем постепенно расширять это руководство, чтобы рассказать о дополнительных функциях поиска, которые вы можете использовать в собственных решениях.

Если у вас уже есть опыт работы с Поиском Azure, вы можете использовать этот пример как фундамент для дальнейших исследований, таких как улучшение [страницы поиска](search-pagination.md) или внедрение [фасетной навигации](search-faceted-navigation.md). Вы также можете улучшить страницу результатов поиска путем добавления счетчиков и пакетной обработки документов, чтобы пользователи могли просматривать результаты постранично.

Новичок в Поиске Azure? Мы рекомендуем ознакомиться с другими учебниками, чтобы получить представление о том, что вы можете создать. Посетите нашу [страницу документации](http://azure.microsoft.com/documentation/services/search/), чтобы найти дополнительные ресурсы. Вы также можете перейти по ссылкам в нашем [списке видео и учебников](search-video-demo-tutorial-list.md), чтобы получить дополнительные сведения.

<!--Image references-->
[1]: ./media/search-get-started-java/create-search-portal-1.PNG
[2]: ./media/search-get-started-java/create-search-portal-21.PNG
[3]: ./media/search-get-started-java/create-search-portal-31.PNG
[4]: ./media/search-get-started-java/AzSearch-Java-Import1.PNG
[5]: ./media/search-get-started-java/AzSearch-Java-config1.PNG
[6]: ./media/search-get-started-java/AzSearch-Java-ProjectFacets1.PNG
[7]: ./media/search-get-started-java/AzSearch-Java-runtime1.PNG
[8]: ./media/search-get-started-java/AzSearch-Java-Browser1.PNG
[9]: ./media/search-get-started-java/AzSearch-Java-JREPref1.PNG
[10]: ./media/search-get-started-java/AzSearch-Java-BuildProject1.PNG
[11]: ./media/search-get-started-java/rogerwilliamsschool1.PNG
[12]: ./media/search-get-started-java/AzSearch-Java-SelectProject.png

<!---HONumber=Nov15_HO3-->