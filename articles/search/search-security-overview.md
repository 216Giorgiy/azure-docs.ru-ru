---
title: Безопасность данных и операций в Поиске Azure | Документация Майкрософт
description: Безопасность службы "Поиск Azure" основывается на соответствии SOC 2, шифровании, проверке подлинности и доступе на основе удостоверений с использованием идентификаторов безопасности пользователей и групп в фильтрах этой службы.
services: search
documentationcenter: ''
author: HeidiSteen
manager: cgronlun
editor: ''
ms.assetid: ''
ms.service: search
ms.devlang: ''
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 01/19/2018
ms.author: heidist
ms.openlocfilehash: 35f875e5f6345b9ebb9abc4deb71b7bf9c78907d
ms.sourcegitcommit: 48ab1b6526ce290316b9da4d18de00c77526a541
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2018
---
# <a name="security-and-controlled-access-in-azure-search"></a>Безопасность и управляемый доступ в службе поиска Azure

Поиск Azure — это служба, [соответствующая SOC 2](https://servicetrust.microsoft.com/ViewPage/MSComplianceGuide?command=Download&downloadType=Document&downloadId=93292f19-f43e-4c4e-8615-c38ab953cf95&docTab=4ce99610-c9c0-11e7-8c2c-f908a777fa4d_SOC%20%2F%20SSAE%2016%20Reports), с эффективной архитектурой безопасности, которая объединяет физическую безопасность, зашифрованные передачи данных, зашифрованное хранилище и меры безопасности программного обеспечения для всей платформы. С точки зрения операций служба "Поиск Azure" принимает только запросы, прошедшие проверку подлинности. При необходимости можно добавить элементы управления доступом к содержимому для отдельного пользователя. В этой статье описывается безопасность на каждом уровне, но основное внимание уделяется способам защиты данных и операций в службе поиска Azure.

![Блок-схема уровней безопасности](media/search-security-overview/azsearch-security-diagram.png)

## <a name="physical-security"></a>Физическая безопасность

Центры обработки данных Майкрософт обеспечивают ведущую в отрасли физическую безопасность и соответствуют широкому спектру стандартов и нормативных требований. Дополнительные сведения см. на странице [глобальных центров обработки данных](https://www.microsoft.com/cloud-platform/global-datacenters) или ознакомьтесь с коротким видеороликом о безопасности центров обработки данных.

> [!VIDEO https://www.youtube.com/embed/r1cyTL8JqRg]

## <a name="encrypted-transmission-and-storage"></a>Зашифрованная передача и хранение

Шифрование действует во всем конвейере индексирования — от соединений, при передачах и до индексированных данных, хранящихся в службе поиска Azure.

| Уровень безопасности | ОПИСАНИЕ |
|----------------|-------------|
| Шифрование при передаче | Поиск Azure прослушивает через HTTPS-порт 443. Подключения к службам Azure по всей платформе зашифрованы. |
| Шифрование при хранении | Шифрование происходит внутренне в процессе индексирования и не оказывает заметного влияния на время выполнения индексирования или размер индекса. Оно выполняется автоматически во всех процессах индексирования, включая добавочные обновления индекса, который не полностью зашифрован (создан до января 2018 г.).<br><br>На внутреннем уровне шифрование основывается на [шифровании службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) с использованием 256-разрядного [шифрования AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).|
| [Соответствие SOC 2](https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/aicpasoc2report.html) | Все службы поиска полностью соответствуют AICPA SOC 2 во всех центрах обработки данных, поддерживающих службу "Поиск Azure". Чтобы просмотреть полный отчет, перейдите к [отчету типа II SOC 2 Azure для государственных организаций](https://servicetrust.microsoft.com/ViewPage/MSComplianceGuide?command=Download&downloadType=Document&downloadId=93292f19-f43e-4c4e-8615-c38ab953cf95&docTab=4ce99610-c9c0-11e7-8c2c-f908a777fa4d_SOC%20%2F%20SSAE%2016%20Reports). |

Шифрование является внутренним для службы поиска Azure, а сертификаты и ключи шифрования внутренне управляются корпорацией Майкрософт и применяются ко всем компонентам. Вы не можете включать или отключать шифрование, подставлять собственные ключи или управлять ими, просматривать параметры шифрования на портале или с помощью программных средств. 

Шифрование при хранении стало общедоступным 24 января 2018 года и применяется ко всем уровням службы, включая общие (бесплатные) службы во всех регионах. Для полного шифрования индексы, созданные до этой даты, необходимо удалить и создать заново, чтобы шифрование вступило в силу. В противном случае будут зашифрованы только новые данные, добавленные после 24 января.

## <a name="azure-wide-logical-security"></a>Логическая безопасность на уровне среды Azure

В Azure Stack есть несколько механизмов безопасности. Следовательно, они автоматически доступны для созданных вами ресурсов Поиска Azure.

+ [Блокировки на уровне подписки или ресурсов для предотвращения удаления](../azure-resource-manager/resource-group-lock-resources.md)
+ [Управление доступом на основе ролей (RBAC) для управления доступом к информации и административным операциям](../active-directory/role-based-access-control-what-is.md)

Все службы Azure поддерживают элементы управления доступом на основе ролей (RBAC) для согласованного задания уровней доступа во всех службах. Например, просматривать конфиденциальные данные, такие как ключ администратора, могут только пользователи с ролью владельца или участника, а состояние службы доступно для обладателей любой роли. RBAC предоставляет роли владельца, участника и читателя. По умолчанию все администраторы службы являются участниками роли владельца.

## <a name="service-access-and-authentication"></a>Доступ к службе и проверка подлинности

Кроме того, что Поиск Azure наследует меры безопасности платформы Azure, он также обеспечивает собственную проверку подлинности на основе ключей. Ключ API является строкой, состоящей из случайно сгенерированных букв и цифр. Тип ключа (администратор или запрос) определяет уровень доступа. Отправка допустимого ключа представляет собой доказательство того, что запрос исходит от доверенной сущности. Для доступа к вашей службе поиска используются два типа ключей:

* ключ администратора (применяется к любым операциям чтения и записи в отношении службы);
* ключ запроса (применяется только к операциям чтения, таким как запросы к индексу).

Ключи администратора создаются в процессе подготовки службы. Существует два ключа администратора, обозначенные для упорядочения как *первичный* и *вторичный*, хотя в действительности они являются взаимозаменяемыми. У каждой службы есть два ключа администратора, чтобы вы могли сменять их, не теряя доступа к службе. Вы можете восстановить любой ключ администратора, но вы не сможете добавить его к общему количеству ключей администратора. На одну службу поиска допускается не более двух ключей администратора.

Ключи запроса создаются по мере необходимости. Они предназначены для клиентских приложений, которые могут напрямую вызывать поиск. Вы можете создать до 50 ключей поисковых запросов. В коде приложения указывается URL-адрес поиска и ключ API запроса, чтобы разрешить доступ к службе только для чтения. Код приложения также указывает индекс, используемый приложением. Используемые вместе конечная точка, ключ API с доступом только для чтения и целевой индекс определяют область применения и уровень доступа для подключения из клиентского приложения.

Проверка подлинности требуется для каждого запроса, который состоит из обязательного ключа, операции и объекта. Для обеспечения полной безопасности операций службы достаточно двух уровней разрешений (полные или только для чтения) и контекста (например, для операции запроса к индексу). Дополнительные сведения о ключах см. в статье о [создании ключей api и управлении ими](search-security-api-keys.md).

## <a name="index-access"></a>Доступ к индексу

В Поиске Azure какой-либо индекс не является защищаемым объектом. Вместо этого доступ к индексу определяется на уровне службы (доступ на чтение или запись), а также контекстом операции.

В случае с доступом пользователей можно структурировать запросы в приложении для подключения с использованием ключа запроса (после чего любой запрос становится доступным только для чтения) и добавить конкретный индекс, используемый приложением. В запросе невозможно объединить индексы или получить доступ к нескольким индексам одновременно, поэтому все запросы по определению направляются к одному индексу. Таким образом структура самого запроса (ключ и один целевой индекс) определяет границы безопасности.

Доступ администратора и разработчика к индексам недифференцированный: для обоих типов доступа необходимо разрешение на запись для создания, удаления и обновления объектов, управляемых службой. Любой пользователь, имеющий ключ администратора к службе, может прочитать, изменить или удалить любой индекс в той же службе. Решением для защиты от случайного или злонамеренного удаления индексов являются внутренние средства управления исходным кодом для ресурсов кода, которые позволяют отменить нежелательное удаление или изменение индекса. Служба "Поиск Azure" выполняет отработку отказа в кластере для обеспечения доступности, но она не хранит и не выполняет ваш собственный код, используемый для создания или загрузки индексов.

Для мультитенантных решений, границы безопасности которых должны находиться на уровне индексов, такие решения, как правило, содержат средний уровень, на котором клиенты обрабатывают изоляцию индекса. Дополнительные сведения о вариантах использования мультитенантных решений см. в статье [Шаблоны разработки для мультитенантных приложений SaaS и Поиска Azure](search-modeling-multitenant-saas-applications.md).

## <a name="admin-access-from-client-apps"></a>Административный доступ из клиентских приложений

Интерфейс управления поисковой службой Azure REST API является расширением диспетчера ресурсов Azure и использует те же зависимости. Таким образом, для администрирования службы поиска Azure необходимо наличие Active Directory. Все административные запросы из клиентского кода должны проходить проверку подлинности с помощью Azure Active Directory, прежде чем они достигнут Resource Manager.

Запросы данных для конечной точки службы поиска Azure, например создание индекса (REST API службы Поиска Azure) или поиск документов (REST API службы поиска Azure), содержат ключ API в заголовке запроса.

Если код приложения обрабатывает операции администрирования службы, а также операции с данными в индексах поиска или документах, реализуйте два способа проверки подлинности в коде: ключ доступа Поиска Azure и методологию проверки подлинности Active Directory, необходимую для Resource Manager. 

Сведения о структурировании запроса в Поиске Azure см. в статье [Azure Search Service REST](https://docs.microsoft.com/rest/api/searchservice/) (REST службы поиска Azure). Дополнительные сведения о требованиях к проверке подлинности для Resource Manager см. в статье [Использование API аутентификации Resource Manager для доступа к подпискам](../azure-resource-manager/resource-manager-api-authentication.md).

## <a name="user-access-to-index-content"></a>Доступ пользователя к содержимому индекса

Доступ пользователя к содержимому индекса реализуется с помощью фильтров безопасности в запросах, возвращающих документы, связанные с заданным удостоверением безопасности. Вместо предопределенных ролей и назначений ролей управление доступом на основе удостоверений реализуется как фильтр, обрезающий результаты поиска документов и содержимого на основе удостоверений. В следующей таблице описаны два подхода к обрезке результатов поиска несанкционированного содержимого.

| Подход | ОПИСАНИЕ |
|----------|-------------|
|[Security filters for trimming results in Azure Search](search-security-trimming-for-azure-search.md) (Фильтры безопасности для обрезки результатов Поиска Azure)  | Документирует базовый рабочий процесс для реализации управления доступом на основе удостоверений пользователей. Описывает добавление удостоверений безопасности в индекс, а также объясняет фильтрацию этого поля для усечения результатов запрещенного содержимого. |
|[Security filters for trimming Azure Search results using Active Directory identities](search-security-trimming-for-azure-search-with-aad.md) (Фильтры безопасности для обрезки результатов Поиска Azure с использованием удостоверений Active Directory)  | Эта статья дополняет предыдущую статью, в ней приведены действия для получения удостоверений из Azure Active Directory (AAD), одной из [бесплатных служб](https://azure.microsoft.com/free/) на облачной платформе Azure. |

## <a name="table-permissioned-operations"></a>Таблица. Разрешенные операции

В следующей таблице приведены операции, разрешенные в Поиске Azure, и указано, какие ключи используются для разблокировки доступа к конкретной операции.

| Операция | Разрешения |
|-----------|-------------------------|
| создание службы; | Владелец подписки Azure|
| Масштабирование службы | Ключ администратора, владелец или участник RBAC ресурса  |
| удаление службы; | Ключ администратора, владелец или участник RBAC ресурса |
| Создание, изменение, удаление объектов в службе: <br>индексы и элементы компонентов (включая определения анализатора, профили оценки, параметры CORS), индексаторы, источники данных, синонимы, средства подбора. | Ключ администратора, владелец или участник RBAC ресурса  |
| Запрос индекса | Ключ администратора или запроса (RBAC не применяется) |
| Запрос сведений о системе, например возвращение статистики, количества и списков объектов. | Ключ администратора, RBAC ресурса (владелец, участник или читатель) |
| Управление ключами администратора | Ключ администратора, владелец или участник RBAC ресурса |
| Управление ключами запросов |  Ключ администратора, владелец или участник RBAC ресурса.  |


## <a name="see-also"></a>См. также

+ [Создание индекса службы поиска Azure с помощью пакета SDK для .NET](search-create-index-dotnet.md)
+ [Создание индекса службы поиска Azure с помощью REST API](search-create-index-rest-api.md)
+ [Security filters for trimming results in Azure Search](search-security-trimming-for-azure-search.md) (Фильтры безопасности для обрезки результатов Поиска Azure)
+ [Security filters for trimming Azure Search results using Active Directory identities](search-security-trimming-for-azure-search-with-aad.md) (Фильтры безопасности для обрезки результатов Поиска Azure с использованием удостоверений Active Directory)
+ [Фильтры в службе "Поиск Azure"](search-filters.md)