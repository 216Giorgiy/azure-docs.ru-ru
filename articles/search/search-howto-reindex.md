---
title: Перестроение индекса в службе "Поиск Azure" или обновление содержимого для поиска | Документация Майкрософт
description: Вы можете добавлять новые элементы, обновлять существующие элементы или документы и удалять устаревшие документы в процессе обновления индекса службы "Поиск Azure", выполняя полное перестроение или частичное добавочное индексирование.
services: search
author: HeidiSteen
manager: cgronlun
ms.service: search
ms.topic: conceptual
ms.date: 05/01/2018
ms.author: heidist
ms.openlocfilehash: 374e7601169647f0eb7d3a214cf15567b7b11090
ms.sourcegitcommit: 5892c4e1fe65282929230abadf617c0be8953fd9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2018
ms.locfileid: "34641430"
---
# <a name="how-to-rebuild-an-azure-search-index"></a>Как перестроить индекс службы "Поиск Azure"

Перестроение индекса изменяет его структуру и изменяет физическое выражение индекса в службе "Поиск Azure". С другой стороны, обновление индекса затрагивает только его содержимое, отражая свежие изменения во внешнем источнике исходных данных. В этой статье объясняется, как обновить структуру или содержимое индекса.

Для обновления индекса нужны разрешения на чтение и запись на уровне службы. Полное перестроение или добавочное индексирование содержимого можно выполнить программными средствами через REST API или API .NET, указав параметры для выбора метода обновления. 

Как правило, обновление индекса выполняется по требованию. Но для индексов, которые заполняются [индексаторами](search-indexer-overview.md), нацеленными на конкретный источник, вы можете использовать встроенный планировщик. Планировщик поддерживает обновление документов с частотой от 15 минут до любого требуемого интервала или расписания обновлений. Чтобы обновлять индекс чаще, придется инициировать обновления вручную, например через двойную запись при транзакциях или путем одновременного обновления внешнего источника данных и индекса Поиска Azure.

## <a name="full-rebuilds"></a>Полное перестроение

Для многих типов обновлений требуется полное перестроение. Полное перестроение по сути означает удаление индекса, всех его данных и метаданных, с последующим заполнением индекса из внешних источников данных. С программной точки зрения, перестроение индекса включает его [удаление](https://docs.microsoft.com/rest/api/searchservice/delete-index), [создание](https://docs.microsoft.com/rest/api/searchservice/create-index) и [перезагрузку](https://docs.microsoft.com/rest/api/searchservice/addupdate-or-delete-documents). 

Если вы выполняете тестирование частоты запросов и профилей повышений, после перестроения индекса следует ожидать некоторых изменений в результатах запросов, если изменялось базовое содержимое.

## <a name="when-to-rebuild"></a>Как часто нужно перестраивать индекс

Частое полное перестроение следует выполнять в период активной разработки, пока схемы индексов еще не полностью определены.

| Изменения | Состояние перестроения|
|--------------|---------------|
| Изменение имени поля, типа данных или [атрибутов индекса](https://docs.microsoft.com/rest/api/searchservice/create-index) | Изменение определения поля обычно требует перестроения индексов, за исключением нескольких [атрибутов индекса](https://docs.microsoft.com/rest/api/searchservice/create-index): Retrievable, SearchAnalyzer, SynonymMaps. Атрибуты Retrievable, SearchAnalyzer и SynonymMaps вы можете добавлять к существующим полям без необходимости перестроения индекса.|
| Добавление полей | Нет строгих требований перестроения. Во всех существующих в индексе документах новому полю присваивается значение null. При последующем перестроении индекса в службе "Поиск Azure" эти пустые значения заменятся сведениями из источника данных. |
| Удаление поля | Невозможно напрямую удалить поле из индекса службы "Поиск Azure". Вы можете лишь прекратить использовать "удаленное" поле в своем приложении. Физически определение и содержимое поля сохраняются в индексе до следующего перестроения индекса с использованием схемы, в которой это поле отсутствует.|

> [!Note]
> Также перестроение требуется при изменении уровня. Если в определенный момент вам потребуется дополнительная производительность, вы не сможете выполнить обновление на месте. Придется создавать службу с требуемым уровнем производительности и создавать для нее все индексы "с нуля". 

## <a name="partial-or-incremental-indexing"></a>Частичное или добавочное индексирование

Когда индекс будет передан в рабочую среду, по возможности ограничьте работу с ним до добавочного индексирования, чтобы не создавать перерывы в работе службы. Частичное или добавочное индексирование затрагивают только содержимое индекса. Эта рабочая нагрузка синхронизирует содержимое индекса поиска, чтобы отразить актуальное состояние содержимого в исходных источниках данных. Все документы, добавленные или удаленные в источнике, добавляются в индекс или удаляются из него. В коде вам нужно вызвать операцию [Добавление, обновление или удаление документов](https://docs.microsoft.com/rest/api/searchservice/addupdate-or-delete-documents) или ее аналог в .NET.

> [!Note]
> Если используются индексаторы, которые сканируют внешние источники данных, для добавочного индексирования применяются механизмы отслеживания изменений в исходных системах. Для [хранилища BLOB-объектов Azure](search-howto-indexing-azure-blob-storage.md#incremental-indexing-and-deletion-detection) используется поле `lastModified`. В [хранилище таблиц Azure](search-howto-indexing-azure-tables.md#incremental-indexing-and-deletion-detection) эти функции выполняет `timestamp`. В [индексаторе для Базы данных SQL Azure](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md#capture-new-changed-and-deleted-rows) и [индексаторе для Azure Cosmos DB](search-howto-index-cosmosdb.md#indexing-changed-documents) также используются поля, обозначающие обновление строки. Дополнительную информацию об индексаторах см. в [этом описании](search-indexer-overview.md).


## <a name="see-also"></a>См. также

+ [Обзор индексатора](search-indexer-overview.md)
+ [Индексирование с поддержкой горизонтального масштабирования в службе "Поиск Azure"](search-howto-large-index.md)
+ [Импорт данных в службу поиска Azure с помощью портала](search-import-data-portal.md)
+ [Подключение базы данных SQL Azure к Поиску Azure с помощью индексаторов](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md)
+ [Индексатор базы данных Azure Cosmos](search-howto-index-cosmosdb.md)
+ [Индексатор хранилища BLOB-объектов Azure](search-howto-indexing-azure-blob-storage.md)
+ [Индексатор хранилища таблиц Azure](search-howto-indexing-azure-tables.md)
+ [Безопасность и управляемый доступ в службе поиска Azure](search-security-overview.md)