<properties 
	pageTitle="Создание прототипа приложения для службы поиска Azure" 
	description="Создайте прототип первого приложения, чтобы начать работу со службой поиска Azure." 
	services="search" 
	documentationCenter="" 
	authors="HeidiSteen" 
	manager="mblythe" 
	editor=""/>

<tags 
	ms.service="search" 
	ms.devlang="rest-api" 
	ms.workload="search" 
	ms.topic="article" 
	ms.tgt_pltfrm="na" 
	ms.date="07/08/2015" 
	ms.author="heidist"/>

# Создание прототипа приложения для службы поиска Azure

Оценивая службу поиска Azure, разработчики почти всегда начинают с предварительного тестового приложения, которое покажет, стоит ли добавлять эту службу в пользовательское приложение. В этой статье мы предложим вам несколько стандартных блоков: которые позволят ускорить создание прототипа.
 
- Проект Visual Studio C#, включающий файлы data.json и schema.json. Наличие образца данных позволит вам быстро создать и запустить решение, а также проверить его работоспособность в вашей системе, прежде чем приступать к написанию кода. 

	По возможности постарайтесь заменить отдельные, разобщенные файлы схемы и данных данными своей организации. В этом случае при запуске приложения индекс будет создан на базе вашей схемы, а документы, основанные на ваших файлах, будут готовы к работе со службой поиска Azure.

- Руководство по структурированию данных, предназначенных для загрузки в службу поиска Azure. Для каждого индекса нужен один набор данных. Для сериализации данных служба поиска Azure использует JSON.

- И, наконец, мы рассмотрим ряд дополнительных функций, которые позволят вам вывести свой прототип на следующий уровень, оснастив его такими поисковыми возможностями, как фасетная навигация, профили оценки для настройки результатов, упреждающий ввод или автозаполнение запросов, а также функциями для работы со страницами поиска, недоступными при использовании только полнотекстового способа поиска.

В конечном итоге вы получите прототип приложения с использованием ваших данных, демонстрирующий все возможности работы со службой поиска Azure.

## Подготовка данных

Поиск выполняется по индексу, созданному в службе поиска Azure. Индекс состоит из множества компонентов, включая профили оценки и средства подбора, но основную его часть формируют поля данных, используемые в операциях поиска.

Набор данных с этими полями должен быть представлен файлом неструктурированных данных (JSON). Каждое поле в этом наборе данных должно соотноситься с эквивалентным полем в индексе, который вы собираетесь заполнить. Другие части индекса, такие как профиль оценки или параметры CORS, добавляются прямо в схему независимо друг от друга.

Источники данных, которые используют JSON изначально, такие как хранилище таблиц Azure, предоставляют данные, которые легче подвергаются переработке, чем относительные данные. Вам потребуется единое представление или таблица, где все поля будут показаны в одном наборе строк.

Для загрузки файлов схемы и данных с помощью кода в образце прототипа приложения перезапишите файлы схемы и данных, включенные в приложение по умолчанию.

> [AZURE.NOTE]Вы можете загружать множество файлов данных (включая пакетную загрузку данных), однако все файлы данных, загружаемые в один и тот же индекс, должны иметь одинаковую структуру данных. Индексы объединять нельзя; каждый индекс функционирует как отдельная совокупность искомых данных.

## Тестирование прототипа решения в системе

1. [Создайте службу поиска Azure на портале Azure](search-create-service-portal.md).

    Общую (бесплатную) версию службы можно добавить в любую существующую подписку Azure. Для прототипов часто используется общая служба. Помните, что общая служба предоставляет 50 МБ данных или 10 000 документов в зависимости от того, какое условие будет выполнено первым. Кроме того, для распределения данных и документов можно использовать не больше трех индексов.

    Если вы запустите прототип приложения из примера с встроенными образцами файлов данных, будет создан один индекс с именем musicstoreindex, содержащий 246 документов и занимающий 278 кБ в службе поиска Azure. Далее в этом пошаговом руководстве вы замените этот индекс на новый индекс с использованием данных Adventure Works, допускающий до ## документов и до ## МБ.

2. [Загрузите решение для создания прототипов](http://go.microsoft.com/fwlink/p/?LinkId=536479). Это решение Visual Studio 2013 на C#, которое собирает консольное приложение для создания, загрузки и запроса индекса. Если у вас нет Visual Studio, установите бесплатную версию [Visual Studio 2013 Express](http://www.visualstudio.com/products/visual-studio-express-vs.aspx).

3. Измените файл app.config, добавив параметры конфигурации для службы поиска и ключа API.

	Узнать URL-адрес и ключ API администратора позволяет [панель мониторинга службы на портале](search-create-service-portal.md). В качестве URL-адреса введите полный путь имени службы, включая префикс https и домен `search.windows.net`.

4. Создайте решение и убедитесь в отсутствии ошибок сборки. Для устранения ошибок сборки может потребоваться обновление пакетов. Щелкните **Управление пакетами NuGet** в решении правой кнопкой мыши и выберите обновление пакетов.

5. Запустите решение с использованием встроенных файлов схемы и данных. Этот шаг не является обязательным, но позволяет проверить работоспособность решения перед трудоемким добавлением собственных данных. На консоли отображаются следующие сообщения:

	- Индекс удален (отображается только при наличии индекса с именем musicstoreindex).
	- Индекс создан (в службе создан новый индекс с именем musicstoreindex).
	- Документы опубликованы (по одному сообщению для каждого файла JSON).
	- Ожидание: 5 секунд (позволяет завершить индексирование перед отправкой первого запроса).
	- Результаты поиска для термина "лучший" без повышения приоритета (выполняется простой запрос, подтверждающий, что данные загружены в индекс).

6. Остановите приложение и удалите индекс, чтобы освободить место.

    > [AZURE.TIP]Для удаления индекса можно использовать [портал](https://portal.azure.com). Щелкните имя индекса, чтобы открыть колонку индекса, и воспользуйтесь командой **Удалить**.

## Замена файлы схемы и данных JSON собственными данными

Прототип решения содержит один файл схемы и три файла данных: data1.json, data2.json и data3.json. Файл схемы (schema.json) нужно заменить схемой, описывающей ваши данные.

По умолчанию эти файлы хранятся в папке решения:

![][1]

Если вы можете перевести свои данные в файлы JSON, перезапишите существующие файлы своими данными и запустите приложение, чтобы создать и загрузить индекс. Распределение данных между несколькими файлами позволит продемонстрировать операцию пакетной загрузки.

В число других способов загрузки данных входит применение индексатора (требуется источник данных — Azure DocumentDB либо база данных SQL Azure). Образец кода, демонстрирующий дополнительные способы загрузки данных, см. в статье [Поиск Azure: учебники, видеодемонстрации и примеры](https://msdn.microsoft.com/library/azure/dn818681.aspx) на сайте MSDN.

### Изменение запроса

Запрос, встроенный в решение по умолчанию, ссылается на поля и структуры из встроенных файлов данных. Перезаписав файлы данных собственными данными, вы сможете либо прокомментировать код запроса, либо изменить его таким образом, чтобы он обращался к полям из вашей схемы. Дополнительные сведения о синтаксисе запросов поиска см. в статье [Поиск документов](https://msdn.microsoft.com/library/azure/dn798927.aspx).

### Создание и запуск приложения

Нажмите клавишу **F5**, чтобы запустить приложение. Как и раньше, вы увидите сообщения о создании индекса, его загрузке и возможности отправки запросов.

Теперь у вас есть рабочий индекс, который можно использовать как основу для дальнейшего анализа.

Возможно, на этом этапе вам придется переключиться для выполнения запросов на [Fiddler](search-fiddler.md) или [Chrome Postman](search-chrome-postman.md), изменить какие-либо образцы приложений, настроив их на использование вашей службы поиска и индекса, или добавить пользовательский код для визуализации данных.

## Добавление профиля оценки

Рекомендуем поэкспериментировать с [профилями оценки](search-get-started-scoring-profiles.md) через портал или с помощью кода. Профили оценки повышают важность обнаружения условия поиска в определенном поле. Например, если в качестве условия поиска указано название города, нужно, чтобы документы, в которых слово *Сиэтл* встречается в поле "Город", отображались в результатах поиска выше, чем документы, в которых слово *Сиэтл* встречается в поле "Описание".

При добавлении профиля оценки индекс изменяется, поэтому любое изменение схемы должно сопровождаться повторным созданием и загрузкой индекса. По этой причине рекомендуем добавить в прототип сегменты кода профилей оценки (или изменить образцы профилей оценки, настроив их на использование вашего кода индексации).

Справочную документацию по профилям оценки см. в статье [Добавление профилей оценки](https://msdn.microsoft.com/library/dn798928.aspx).

## Добавление средств подбора

Средства подбора обращаются к популярной функции поиска, выдающей список возможных условий поиска в зависимости от введенного пользователем текста (при вводе "пого" выдается список слов для автозаполнения условия поиска, включающий такие варианты, как "погода", "погодные условия", "погодный фон" и т. д.).

Чтобы добавить средства подбора, добавьте в схему индекса раздел, указывающий, какие поля будут использоваться для автозавершения или упреждающего ввода запросов. Поля, содержащие названия, или короткие строки с неповторяющимися значениями подходят для этой цели лучше всего. Дополнительные сведения см. в статье [Создание индекса](https://msdn.microsoft.com/library/dn798928.aspx).

## Попробуйте применить анализатор языка

Анализаторы языков предоставляют лингвистические правила для различения значимых и малозначимых слов, начальной формы слов и даже синонимов. По умолчанию в службе поиска Azure используется анализатор Lucene для английского языка. Вы можете указать в атрибутах индекса определенных полей другие анализаторы, что позволит вам создавать схемы и документы с полями, в которых используются другие анализаторы (например, в многоязычном приложении в одном и том же документе могут присутствовать поля для французского и английского языков). Дополнительные сведения см. в статье [Поддержка языков](https://msdn.microsoft.com/library/dn879793.aspx).

## Дальнейшие действия

В предыдущих разделах вы изменили индекс, добавив в прототип дополнительные функции. На этом этапе изменения в индексе практически завершены (мы не рассмотрели только включение CORS — единственное оставшееся изменение в схеме, которое еще можно внести).

Дальнейшая работа по созданию прототипа может продвигаться в двух разных направлениях: акцент на пользовательский интерфейс, включая добавление фасетной навигации или других фильтров, позволяющих сузить результаты поиска, или дальнейший анализ аспектов вашего решения, связанных с синхронизацией данных. Многие решения имеют дело с непостоянными данными. Зачастую, как только базовая работоспособность поиска подтверждается, разработчики переключаются на обновления синхронизации данных между транзакционными системами баз данных и индексом поиска Azure.

Дополнительные сведения см. по следующим ссылкам:

- [Типовые процедуры разработки проектов с использованием поиска Azure](search-workflow.md)

- [Настройка индексатора поиска Azure](search-indexers-customization.md)

- [Фасетная навигация в службе поиска Azure](search-faceted-navigation.md)

- [Разбивка результатов поиска на страницы в службе поиска Azure.](search-pagination-page-layout.md)


<!--Image references-->
[1]: ./media/search-build-prototype/azsearch-datafiles.png
 

<!---HONumber=July15_HO4-->