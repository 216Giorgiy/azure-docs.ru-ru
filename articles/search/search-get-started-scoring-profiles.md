<properties 
	pageTitle="Использование профилей повышения в поиске Azure | Microsoft Azure | Размещенная облачная служба поиска" 
	description="Настройте ранжирование поиска с помощью профилей повышения в Поиске Azure, размещенной облачной службе поиска в Microsoft Azure." 
	services="search" 
	documentationCenter="" 
	authors="HeidiSteen" 
	manager="mblythe" 
	editor=""/>

<tags 
	ms.service="search" 
	ms.devlang="rest-api" 
	ms.workload="search" 
	ms.topic="article" 
	ms.tgt_pltfrm="na" 
	ms.date="11/04/2015" 
	ms.author="heidist"/>

# Использование профилей оценки в службе поиска Azure

Профили оценки — компонент службы поиска Microsoft Azure, который позволяет настроить вычисление всех оценок поиска, влияющих на ранжирование элементов в списке результатов. Оценки профили можно представить как способ моделирования релевантности, с помощью которого оценка элементов, соответствующих стандартным критериям, увеличивается. Предположим, что приложение представляет собой сайт для бронирования отеля. Если повысить оценку поля `location`, операции поиска, содержащие такое ключевое слово, как "Сиэтл", получат более высокие оценки для элементов, содержащих слово "Сиэтл" в поле `location`. Обратите внимание, что можно использовать несколько профилей оценки или ни одного, если оценки по умолчанию достаточно для вашего приложения.

Чтобы вам проще экспериментировать с профилями оценки, можно загрузить пример приложения, использующего профили оценки для изменения порядка ранжирования результатов поиска. Пример представляет собой консольное приложение, возможно, не очень реалистичное, но полезное для обучения.

Пример приложения демонстрирует поведение оценок с использованием вымышленных данных, которые называются `musicstoreindex`. Простота примера приложения позволяет легко изменять профили оценки и запросы, а затем смотреть их влияние на порядок ранжирования при выполнении программы.

<a id="sub-1"></a>
## Предварительные требования

Образец приложения создан на языке C# с помощью Visual Studio 2013. Если приложение Visual Studio у вас не установлено, воспользуйтесь бесплатной версией [Visual Studio 2013 Express](http://www.visualstudio.com/products/visual-studio-express-vs.aspx).

Для работы с учебником вам потребуется подписка Azure и служба поиска Azure. Справку по настройке службы см. в разделе [Создание службы поиска на портале](search-create-service-portal.md).

[AZURE.INCLUDE [Для работы с данным руководством требуется учетная запись Azure.](../../includes/free-trial-note.md)]

<a id="sub-2"></a>
## Загрузка примера приложения

Для загрузки образца приложения, описанного в данном руководстве, откройте [демонстрацию профилей оценки для службы поиска Azure](https://azuresearchscoringprofiles.codeplex.com/) на сайте Codeplex.

На вкладке "Исходный код" нажмите **Загрузить**, чтобы получить ZIP-архив с решением.

 ![][12]

<a id="sub-3"></a>
## Редактирование app.config

1. После извлечения файлов откройте решение в среде Visual Studio, чтобы изменить файл конфигурации.
1. В обозревателе решений дважды щелкните файл **app.config**. Этот файл указывает конечную точку службы и `api-key`, используемый для проверки подлинности запроса. Эти значения можно получить на классическом портале.
1. Перейдите на [классический портал Azure](https://portal.azure.com).
1. Перейдите к панели мониторинга службы поиска Azure.
1. Щелкните плитку **Свойства**, чтобы скопировать URL-адрес службы.
1. Щелкните плитку **Ключи**, чтобы скопировать `api-key`.

После добавления URL-адреса и `api-key` в файл app.config параметры приложения должны выглядеть следующим образом:

   ![][11]


<a id="sub-4"></a>
## Обзор приложения

Вы почти готовы к построению и запуску приложения, но сначала рассмотрим файлы JSON, используемые для создания и заполнения индекса.

Файл **Schema.json** определяет индекс, включая профили оценки, выделенные в данной демонстрации. Обратите внимание, что схема определяет все используемые в индексе поля, включая недоступные для поиска поля, такие как `margin`, которые можно использовать в профиле оценки. Синтаксис профиля оценки описан в разделе [Добавление профиля оценки в индекс службы поиска Azure](http://msdn.microsoft.com/library/azure/dn798928.aspx).

В файле **Data1-3.json** содержатся данные: 246 альбомов в разных жанрах. Они представляют собой сочетание фактических сведений об альбомах и исполнителях с вымышленными полями, такими как `price` и `margin`, используемыми для иллюстрации операций поиска. Файлы данных соответствуют индексу и передаются в службу поиска Azure. После передачи и индексирования данных можно выполнять запросы к ним.

Функция **Program.cs** выполняет следующие операции:

- Открывает окно консоли.

- Подключается к службе поиска Azure, используя URL-адрес службы и `api-key`.

- Удаляет `musicstoreindex`, если он существует.

- Создает новый `musicstoreindex` с помощью файла schema.json.

- Заполняет индекс с помощью файлов данных.

- Запрашивает индекс с помощью четырех запросов. Обратите внимание, что профили оценки задаются в виде параметра запроса. Все запросы ищут один и тот же термин "best". Первый запрос демонстрирует оценку по умолчанию. Остальные три запроса используют профиль оценки.

<a id="sub-5"></a>
## Создание и запуск приложения

Чтобы исключить проблемы с подключением или ссылками на сборки, постройте и запустите приложение и проверьте, что оно работает нормально. Вы должны увидеть консольное приложение, открывшееся в фоновом режиме. Все четыре запросы выполняются последовательно без приостановки. Во многих системах вся программа выполняется в течение 15 секунд. Если консольное приложение отображает сообщение "Завершено. Нажмите клавишу ВВОД для продолжения", то программа выполнена успешно.

Для сравнения запросов можно выделить и скопировать и вставить результаты запросов из консоли и вставить их в файл Excel.

На следующем рисунке результаты первых трех запросов показаны бок о бок. Все запросы используют один термин, "best", который входит в названия многих альбомов.

   ![][10]

Первый запрос использует оценку по умолчанию. Поскольку термин есть только в названиях альбомов, а другие критерии не указаны, элементы с термином "best" возвращаются в том порядке, в котором их находит служба поиска.

Второй запрос использует оценку профиля, но обратите внимание, что он не оказывает никакого влияния. Результаты идентичны результатам первого запроса. Это вызвано тем, что профиль оценки продвигает поле "genre", не относящееся к запросу. Термин "best" не существует в полях "genre" какого-либо документа. Так как профиль оценки не оказывает влияния, результаты будут такими же, как у оценки по умолчанию.

Третий запрос — первое свидетельство влияния профиля оценки. Термин поиска — по-прежнему "best", поэтому мы работаем с тем же набором альбомов, но поскольку профиль оценки предоставляет дополнительные критерии, которые продвигают поля "rating" и "last-updated", некоторые элементы указаны в списке выше.

На следующем рисунке показан запрос четвертый, заключительный запрос, с продвинутым полем "margin". Поле "margin" недоступно для поиска и не может быть возвращено в результатах. Значение margin было вручную добавлено в электронную таблицу, чтобы проиллюстрировать тот факт, что элементы с большей маржей отображаются выше в списке результатов.

   ![][9]

Вы уже поэкспериментировали с профилями оценки, теперь попробуйте изменить программу для использования другого синтаксиса запроса, профиля оценки или более разнообразных данных. По ссылкам в следующем разделе представлена дополнительная информация.

<a id="next-steps"></a>
## Дальнейшие действия

Дополнительные сведения о профилях оценки. Дополнительные сведения см. в разделе [Добавление профиля оценки в индекс службы поиска Azure](http://msdn.microsoft.com/library/azure/dn798928.aspx).

Дополнительные сведения о синтаксисе и параметрах поисковых запросов. Дополнительные сведения см. в разделе [Поиск документов (API REST службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).

Хотите сделать шаг назад и узнать больше о создании индексов? [Посмотрите это видео](http://channel9.msdn.com/Shows/Cloud+Cover/Cloud-Cover-152-Azure-Search-with-Liam-Cavanagh), чтобы разобраться в основах.

<!--Anchors-->
[Prerequisites]: #sub-1
[Download the sample application]: #sub-2
[Edit app.config]: #sub-3
[Explore the application]: #sub-4
[Build and run the application]: #sub-5
[Next steps]: #next-steps

<!--Image references-->
[12]: ./media/search-get-started-scoring-profiles/AzureSearch_CodeplexDownload.PNG
[11]: ./media/search-get-started-scoring-profiles/AzureSearch_Scoring_AppConfig.PNG
[10]: ./media/search-get-started-scoring-profiles/AzureSearch_XLSX1.PNG
[9]: ./media/search-get-started-scoring-profiles/AzureSearch_XLSX2.PNG

<!---HONumber=AcomDC_1203_2015-->