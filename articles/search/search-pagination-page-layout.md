<properties 
	pageTitle="Разбивка результатов поиска на страницы в службе поиска Azure." 
	description="Разбивка на страницы в службе поиска Azure" 
	services="search" 
	documentationCenter="" 
	authors="HeidiSteen" 
	manager="mblythe" 
	editor=""/>

<tags 
	ms.service="search" 
	ms.devlang="rest-api" 
	ms.workload="search" 
	ms.topic="article" 
	ms.tgt_pltfrm="na" 
	ms.date="04/16/2015" 
	ms.author="heidist"/>

#Разбивка результатов поиска на страницы в службе поиска Azure.#

В данной статье приводятся рекомендации по использованию API REST службы поиска Azure для реализации стандартных элементов страницы результатов поиска, например, общего подсчета, извлечения документа, порядка сортировки и навигации.
 
В любом из перечисленных ниже случаев связанные со страницей параметры, добавляющие данные или информацию к странице результатов поиска, задаются в запросах [Поиск документа](http://msdn.microsoft.com/library/azure/dn798927.aspx), отправляемых службе поиска Azure. Запросы включают команду GET, путь и параметры запроса, уведомляющие службу о том, что запрашивается и как сформировать ответ.

> [AZURE.NOTE]Допустимый запрос содержит несколько элементов, например URL-адрес службы и путь, HTTP-команду, `api-version` и т. д. Для краткости в примерах указывается только синтаксис, касающийся разбивки на страницы. Подробную информацию о синтаксисе запроса см. в [API REST службы поиска Azure](http://msdn.microsoft.com/library/azure/dn798935.aspx).

## Общее количество совпадений и страниц ##

Практически для всех страниц поиска основным является отображение общего количества результатов запроса с последующим их выводом более мелкими порциями.

![][1]
 
В поиске Azure используйте параметры `$count`, `$top` и `$skip` для вывода этих значений. В следующем примере показан образец запроса для общего количества совпадений, возвращаемого как `@OData.count`:

    	GET /indexes/onlineCatalog/docs?$count=true

Получать документы группами по 15, а также показывать общее количество совпадений, начиная с первой страницы:

		GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=0&$count=true

Разбивка результатов на страницы требует наличия как `$top`, так и `$skip`, где `$top` показывает количество выводимых элементов на странице, а `$skip` — количество элементов, которые нужно пропустить. В следующем примере на каждой странице отображаются очередные 15 элементов, на что указывает пошаговое увеличение параметра `$skip`.

    	GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=0&$count=true

    	GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=15&$count=true

    	GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=30&$count=true

## Макет  ##

На странице результатов поиска может потребоваться отобразить эскиз страницы, подмножество полей и ссылку на страницу полной версии продукта.

 ![][2]
 
Для реализации данного интерфейса в Поиске Azure используйте `$select` и команду поиска.

Чтобы получить подмножество полей для мозаичного макета:

    	GET /indexes/ onlineCatalog/docs?search=*&$select=productName,imageFile,description,price,rating 

Непосредственный поиск в изображениях и файлах мультимедиа невозможен. Для уменьшения расходов они должны сохраняться на другой платформе хранения, такой как хранилище BLOB-объектов Azure. В индексе и документах определите поле, в котором содержится URL-адрес внешнего контента. Затем можно использовать это поле как ссылку на изображение. URL-адрес изображения должен находиться в документе.

Чтобы получить страницу описания продукта для события **onClick**, используйте [Поиск документа](http://msdn.microsoft.com/library/azure/dn798929.aspx) для передачи ключа документа, который нужно получить. Тип данных ключа — `Edm.String`. В данном примере это *246810*.
   
    	GET /indexes/onlineCatalog/docs/246810

## Сортировка по соответствию, оценке или цене ##

Порядок сортировки по соответствию часто задан по умолчанию, но обычно альтернативные порядки сортировки подготавливаются заранее, чтобы клиенты могли быстро реорганизовать имеющиеся результаты в другом порядке приоритетности.

 ![][3]

В Поиске Azure сортировка основывается на выражении `$orderby` для всех полей, которые индексируются как `"Sortable": true.`

Соответствие тесно связано с профилями оценки. Можно использовать оценки по умолчанию, зависящие от анализа текста и статистики для расстановки всех результатов по критерию выбора, при этом более высокая оценка дается документам с большим количеством или более точными совпадениями с условием поиска.

Альтернативные порядки сортировки обычно связаны с событиями **onClick**, вызывающими метод, который строит выбранный порядок сортировки. Например, если взять этот элемент страницы:

 ![][4]

Можно создать метод, который принимает выбранный параметр сортировки в качестве ввода и возвращает список, упорядоченный по критериям, связанным с этим параметром.

 ![][5]
 
> [AZURE.NOTE]В то время как оценка по умолчанию является достаточной для многих сценариев, рекомендуется, чтобы соответствие основывалось на пользовательском профиле оценки. Пользовательский профиль оценки предоставляет способ повышения приоритета элементов, имеющих большее значение для бизнеса. Более подробную информацию см. в разделе [Добавление профиля оценки](http://msdn.microsoft.com/library/azure/dn798928.aspx).

## Фасетная навигация ##

Навигация поиска обычно находится на странице результатов, часто сбоку или вверху страницы. В Поиске Azure фасетная навигация обеспечивает самостоятельный поиск на основе предварительно заданных фильтров. Более подробную информацию см. в [Фасетная навигация в службе поиска Azure](search-faceted-navigation.md).

## Фильтры на уровне страницы ##

Если решение поиска включает отдельные поисковые страницы для конкретных типов контента (например, приложение для розничной торговли в Интернете с перечнем отделов в верхней части страницы), можно вставить выражение фильтра наряду с событием **onClick**, чтобы затем открыть страницу в состоянии после первичного фильтра.

Можно отправлять фильтр с выражением поиска или без него. Например, следующий запрос осуществляет фильтрацию по имени бренда, выводя только те документы, которые соответствуют ему.

    	GET /indexes/onlineCatalog/docs?$filter=brandname eq ‘Microsoft’ and category eq ‘Games’

Более подробную информацию о выражениях `$filter` см. в разделе [Поиск документов (API службы поиска Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).

## См. также ##

- [REST API службы поиска Azure](http://msdn.microsoft.com/library/azure/dn798935.aspx)
- [Операции с индексами](http://msdn.microsoft.com/library/azure/dn798918.aspx)
- [Операции с документом](http://msdn.microsoft.com/library/azure/dn800962.aspx).
- [Поиск Azure: учебники, видеодемонстрации и примеры](http://msdn.microsoft.com/library/azure/dn818681.aspx)
- [Фасетная навигация в службе поиска Azure](search-faceted-navigation.md)


<!--Image references-->
[1]: ./media/search-pagination-page-layout/Pages-1-Viewing1ofNResults.PNG
[2]: ./media/search-pagination-page-layout/Pages-2-Tiled.PNG
[3]: ./media/search-pagination-page-layout/Pages-3-SortBy.png
[4]: ./media/search-pagination-page-layout/Pages-4-SortbyRelevance.png
[5]: ./media/search-pagination-page-layout/Pages-5-BuildSort.png
<!--HONumber=54--> 