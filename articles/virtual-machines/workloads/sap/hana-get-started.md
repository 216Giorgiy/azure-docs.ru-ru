---
title: "Краткое руководство по установке экземпляра SAP HANA вручную на виртуальных машинах Azure | Документация Майкрософт"
description: "Краткое руководство по установке экземпляра SAP HANA вручную на виртуальных машинах Azure"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
tags: azure-resource-manager
keywords: 
ms.assetid: c51a2a06-6e97-429b-a346-b433a785c9f0
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 09/15/2016
ms.author: hermannd
ms.translationtype: Human Translation
ms.sourcegitcommit: 9568210d4df6cfcf5b89ba8154a11ad9322fa9cc
ms.openlocfilehash: e95d3a57594d55b7d7176d873cde8abfa6e12ecd
ms.contentlocale: ru-ru
ms.lasthandoff: 05/15/2017


---
# <a name="quick-start-guide-manual-installation-of-single-instance-sap-hana-on-azure-vms"></a>Краткое руководство по установке экземпляра SAP HANA вручную на виртуальных машинах Azure
## <a name="introduction"></a>Введение
Это краткое руководство поможет вам настроить прототип или демонстрационную систему SAP HANA на уровне отдельного экземпляра на виртуальных машинах Azure после установки SAP NetWeaver 7.5 и SAP HANA 1.0 SP12 вручную. Это руководство не является альтернативой документации SAP. В нем больше внимания уделяется процессу развертывания в Azure.

>[!Note]
>Обратите внимание, что в данном руководстве рассматриваются развертывания SAP HANA на виртуальных машинах Azure. Развертывание SAP HANA в крупных экземплярах HANA рассматривается в отдельном руководстве, которое можно найти здесь: https://docs.microsoft.com/azure/virtual-machines/workloads/sap/get-started
 

В руководстве предполагается, что вы знакомы с основами Azure IaaS, в частности знаете:
 * как развертывать виртуальные машины или виртуальные сети на портале Azure или с помощью PowerShell;
 * как работать с кроссплатформенным средством командной строки Azure, включая возможность использовать шаблоны JavaScript Object Notification (JSON).

Здесь также предполагается, что вы знакомы с SAP HANA, SAP NetWeaver и способом их установки локально.

Дополнительные сведения, с которыми вам необходимо ознакомиться, чтобы установить и использовать экземпляры SAP HANA и приложения SAP в Azure, можно получить в приведенных ниже ресурсах.

Планирование развертывания SAP в Azure, включая планирование виртуальных сетей и использование хранилища Azure: [SAP NetWeaver на виртуальных машинах Windows. Руководство по планированию и внедрению](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/planning-guide).

Принципы развертывания и способы развертывания виртуальных машин в Azure см. в статье [Развертывание программного обеспечения SAP на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/deployment-guide).

Вопросы касательно уровня доступности экземпляров SAP NetWeaver ASCS, SCS и ERS рассматриваются в статье [Высокий уровень доступности SAP NetWeaver на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-guide).

Сведения по улучшению эффективности при использовании установки экземпляров ASCS и SCS с несколькими идентификаторами безопасности в Azure см. в статье [Создание конфигурации с несколькими идентификаторами безопасности SAP NetWeaver](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-multi-sid).

Принципы выполнения экземпляра SAP NetWeaver на виртуальных машинах под управлением Linux в Azure рассматриваются в статье [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux в Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/suse-quickstart). Внимательно ознакомьтесь с этим руководством, так как в нем описываются некоторые важные параметры для Linux на виртуальных машинах Azure, а также приведены сведения о том, как правильно присоединить диски хранилища Azure к виртуальным машинам Linux.

Виртуальные машины Azure сертифицированы SAP только для конфигураций вертикального масштабирования SAP HANA. Конфигурации горизонтального масштабирования при использовании рабочих нагрузок SAP HANA пока не поддерживаются. Сведения об обеспечении высокого уровня доступности SAP HANA для конфигураций вертикального масштабирования см. в статье [Высокий уровень доступности SAP HANA на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-high-availability).


Резервное копирование баз данных SAP HANA на виртуальных машинах Azure рассматривается в следующих руководствах:

* [Руководство по резервному копированию SAP HANA на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-guide)
* [Резервное копирование SAP HANA в Azure на уровне файлов](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-file-level)
* [Резервное копирование SAP HANA на основе моментальных снимков хранилища](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-storage-snapshots)

Ознакомиться с использованием библиотеки SAP Cloud Appliance Library для развертывания S/4HANA или BW/4HANA вы можете в статье [Развертывание SAP S/4HANA или BW/4HANA в Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/cal-s4h).

Дополнительные сведения о поддерживаемых операционных системах для SAP HANA см. в [примечании по поддержке SAP № 2235581](https://launchpad.support.sap.com/#/notes/2235581/E). На виртуальных машинах Azure поддерживаются только эти операционные системы. Для развертывания SAP HANA в Azure поддерживаются следующие операционные системы: 

* SUSE Linux Enterprise Server 12.x;
* Red Hat Enterprise Linux 7.2

Дополнительная документация SAP в отношении SAP HANA и различных операционных систем Linux включает следующие руководства:

* [SAP Support Note #171356 – SAP Software on Linux: General Information](https://launchpad.support.sap.com/#/notes/1984787) (Примечание по поддержке № 171356 — общие сведения о ПО SAP на платформе Linux);
* [SAP Support Note #1944799 – SAP HANA Guidelines for SLES Operating System Installation](http://go.sap.com/documents/2016/05/e8705aae-717c-0010-82c7-eda71af511fa.html) (Примечание по поддержке SAP № 1944799 — Рекомендации для установки SAP HANA на ОС SLES);
* [SAP Support Note #2205917 – SAP HANA DB Recommended OS Settings for SLES 12 for SAP Applications](https://launchpad.support.sap.com/#/notes/2205917/E) (Примечание по поддержке SAP № 2205917 — рекомендуемые параметры ОС для SLES 12 для приложений SAP);
* [SAP Support Note #1984787 – SUSE Linux Enterprise Server 12: Installation Notes](https://launchpad.support.sap.com/#/notes/1984787) (Примечание по поддержке SAP № 1984787 — примечания по установке SUSE LINUX Enterprise Server 12);
* [SAP Support Note #1391070 – Linux UUID Solutions](https://launchpad.support.sap.com/#/notes/1391070) (Примечание по поддержке № 1391070 — решения UUID для Linux).
* [SAP Support Note #2009879 - SAP HANA Guidelines for Red Hat Enterprise Linux (RHEL) Operating System](https://launchpad.support.sap.com/#/notes/2009879) (Примечание по поддержке SAP № 2009879. Рекомендации для установки SAP HANA на ОС Red Hat Enterprise Linux (RHEL));
* [2292690 - SAP HANA DB: Recommended OS settings for RHEL 7](https://launchpad.support.sap.com/#/notes/2292690/E) (Примечание по поддержке SAP № 2292690. База данных SAP HANA: рекомендуемые параметры операционной системы для RHEL 7).

Мы также советуем ознакомиться со следующими примечаниями по поддержке SAP, которые относятся к отслеживанию SAP в Azure:

* Сведения о расширенном мониторинге с помощью виртуальных машин Linux в Azure, приведенные в [примечании SAP № 2191498](https://launchpad.support.sap.com/#/notes/2191498/E).
* Сведения о SAPOSCOL в Linux: [примечание SAP № 1102124](https://launchpad.support.sap.com/#/notes/1102124/E).
* Ключевые метрики мониторинга для SAP в Microsoft Azure: [примечание SAP № 2178632](https://launchpad.support.sap.com/#/notes/2178632/E).


Типы виртуальных машин Azure и поддерживаемые сценарии рабочих нагрузок SAP для SAP HANA рассматриваются на [странице сертифицированных платформ IaaS](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html). Типы виртуальных машин Azure, которые могут использоваться, а также сертифицированы SAP для уровня приложения SAP NetWeaver или S/4HANA задокументированы здесь: [SAP Note 1928533 - SAP Applications on Azure: Supported Products and Azure VM types](https://launchpad.support.sap.com/#/notes/1928533/E) (Примечание по поддержке SAP № 1928533. Приложения SAP в Azure: поддерживаемые продукты и типы виртуальных машин Azure).

>[!Note]
>Сочетание SAP, Linux и Azure поддерживается только в модели развертывания с помощью Azure Resource Manager (ARM) и не поддерживается в классической модели развертывания (ASM). 


В этом руководстве описываются два разных способа установки SAP HANA на виртуальных машинах Azure вручную:

* использование диспетчера подготовки программного обеспечения SAP (SWPM) в рамках распределенной установки NetWeaver на шаге "Установка экземпляра базы данных";
* использование диспетчера управления жизненным циклом HANA (HDBLCM), а затем установка NetWeaver.

Кроме того, с помощью SWPM вы можете установить все компоненты (SAP HANA, сервер приложений SAP, экземпляр ASCS) на одной виртуальной машине, как описано [здесь](https://blogs.saphana.com/2013/12/31/announcement-sap-hana-and-sap-netweaver-as-abap-deployed-on-one-server-is-generally-available/). Однако этот метод не описывается в этом руководстве, но необходимые элементы должны совпадать.

Перед началом установки прочитайте раздел "Подготовка виртуальных машин Azure к установке SAP HANA вручную", который находится сразу после двух контрольных списков для установки SAP HANA. Это поможет предотвратить несколько основных ошибок, которые могут возникнуть при использовании только конфигурации виртуальной машины Azure по умолчанию.

## <a name="checklist-for-sap-hana-installation-using-sap-swpm"></a>Контрольный список для установки SAP HANA с использованием SAP SWPM
В этом разделе перечислены основные шаги для установки SAP HANA на уровне отдельного экземпляра вручную при использовании SAP SWPM для выполнения распределенной установки SAP NetWeaver 7.5. Некоторые отдельные компоненты подробно объясняются далее в руководстве, и к ним предоставлены снимки экрана.

* Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
* Разверните две виртуальные машины Azure с операционной системой (в нашем примере — SLES 12 с пакетом обновления 1 (SP1) или SLES for SAP Applications 12 с пакетом обновления 1 (SP1)) в соответствии с моделью Azure Resource Manager.
* Присоедините два диска хранилища класса Standard или Premium к виртуальной машине сервера приложений (например, диски 75- или 500 ГБ).
* Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в разделе о настройке диска.
* В зависимости от требований к размерам или пропускной способности подключите несколько дисков и создайте чередующиеся тома с помощью управления логическими томами (LVM) или служебной программы администрирования нескольких устройств (mdadm) на уровне операционной системы в виртуальной машине.
* Создайте на подключенных дисках или логических томах файловые системы XFS.
* Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для защиты программного обеспечения SAP, а другую для защиты, например, каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Это необходимо, чтобы предотвратить переполнение корневой файловой системы, которая имеет небольшой размер на виртуальных машинах Azure под управлением Linux.
* Введите локальные IP-адреса тестовых виртуальных машин в файле /etc/hosts.
* Добавьте в файл /etc/fstab параметр nofail.
* Задайте параметры ядра Linux в соответствии с примечаниями SAP, связанными с HANA и выпуском ОС Linux, который вы используете. Дополнительные сведения см. в разделе "Параметры ядра".
* Добавьте область буфера.
* При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
* Скачайте программное обеспечение SAP из SAP Service Marketplace.
* Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
* Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
* Установите на виртуальной машине сервера базы данных экземпляр базы данных, в том числе HANA, с помощью SWPM.
* Установите основной сервер приложений (PAS) на виртуальной машине сервера приложений.
* Запустите консоль управления SAP и подключите ее, например, с помощью графического пользовательского интерфейса SAP или SAP HANA Studio.

## <a name="checklist-for-sap-hana-installation-using-hdblcm"></a>Контрольный список для установки SAP HANA с использованием HDBLCM
В этом разделе перечислены основные шаги для установки экземпляра SAP HANA вручную в целях демонстрации или создания прототипов при использовании HDBLCM для выполнения распределенной установки SAP NetWeaver 7.5. Некоторые отдельные компоненты подробно объясняются далее в руководстве, и к ним предоставлены снимки экрана.

* Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
* Разверните две виртуальные машины Azure с операционной системой (в нашем примере — SLES 12 с пакетом обновления 1 (SP1) или SLES for SAP Applications 12 с пакетом обновления 1 (SP1)) в соответствии с моделью Azure Resource Manager.
* Присоедините два диска хранилища класса Standard или Premium к виртуальной машине сервера приложений (например, диски на 75 или 500 ГБ).
* Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в разделе о настройке диска.
* В зависимости от требований к размерам или пропускной способности подключите несколько дисков и создайте чередующиеся тома с помощью управления логическими томами (LVM) или служебной программы администрирования нескольких устройств (mdadm) на уровне операционной системы в виртуальной машине.
* Создайте на подключенных дисках или логических томах файловые системы XFS.
* Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для защиты программного обеспечения SAP, а другую для защиты, например, каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Это необходимо, чтобы предотвратить переполнение корневой файловой системы, которая имеет небольшой размер на виртуальных машинах Azure под управлением Linux.
* Введите локальные IP-адреса тестовых виртуальных машин в файле /etc/hosts.
* Добавьте в файл /etc/fstab параметр nofail.
* Задайте параметры ядра в соответствии с примечаниями SAP, связанными с HANA и выпуском ОС Linux, который вы используете. Дополнительные сведения см. в разделе "Параметры ядра".
* Добавьте область буфера.
* При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
* Скачайте программное обеспечение SAP из SAP Service Marketplace.
* Создайте на виртуальной машине сервера базы данных HANA группу sapsys с идентификатором 1001.
* Установите SAP HANA на виртуальной машине сервера базы данных с помощью диспетчера управления жизненным циклом базы данных HANA (HDBLCM).
* Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
* Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
* Установите на виртуальной машине сервера базы данных HANA экземпляр базы данных, в том числе HANA, с помощью SWPM.
* Установите основной сервер приложений (PAS) на виртуальной машине сервера приложений.
* Запустите и подключите консоль управления SAP с помощью графического пользовательского интерфейса SAP или SAP HANA Studio.

## <a name="prepare-azure-vms-for-a-manual-installation-of-sap-hana"></a>Подготовка виртуальных машин Azure к установке SAP HANA вручную
В этом разделе описываются следующие темы:

* обновления ОС;
* настройка диска;
* параметры ядра;
* файловые системы;
* файл /etc/hosts;
* файл /etc/fstab.

### <a name="os-updates"></a>обновления ОС;
Так как распространители ОС Linux предоставляют обновления и исправления для операционной системы, которые помогают обеспечить безопасность и бесперебойную работу, разумно проверить наличие доступных обновлений перед установкой дополнительного программного обеспечения.
Можно избежать множества звонков в службу поддержки, если поддерживать актуальный уровень установленных исправлений в системе. Используйте:
* SUSE Linux Enterprise Server для приложения SAP;
* Red Hat Enterprise Linux для приложения SAP или SAP HANA. 

В противном случае — зарегистрируйте развертывание операционной системы с помощью подписки Linux, предоставленной поставщиком Linux. Обратите внимание, что для SUSE есть также образы ОС SUSE для приложений SAP, которые уже содержат службы и зарегистрированы автоматически.

Например:  Для SUSE Linux проверьте наличие исправлений с помощью следующей команды:

 `sudo zypper list-patches`

В зависимости от типа ошибки исправления классифицируются по категориям и серьезности.

Часто используемые значения категорий: "Security" (Безопасность), "Recommended" (Рекомендуемое), "Optional" (Необязательное), "Feature" (Компонент), "Document" (Документ) или "YAST" (Еще один инструмент установки).

Часто используемые значения серьезности: "Critical" (Критическое), "Important" (Важное), "Moderate" (Средней важности), "Low" (Низкой важности) или "Unspecified" (Не указано).

zypper будет искать только обновления, необходимые для установленных пакетов.

Ниже приведен пример команды.

`sudo zypper patch  --category=security,recommended --severity=critical,important`

Добавив параметр *--dry-run*, можно проверить обновление, не устанавливая его в системе на самом деле.


### <a name="disk-setup"></a>настройка диска;
Размер корневой файловой системы на виртуальных машинах Linux в Azure ограничен. Поэтому для работы SAP на виртуальной машине Azure необходимо добавить дополнительное дисковое пространство. Для виртуальных машин Azure сервера приложений SAP приемлемо использование дисков хранилища Azure класса Standard. Однако для виртуальных машин Azure сервера СУБД SAP HANA использование дисков хранилища класса Premium для производственных и непроизводственных реализаций является обязательным.

На основе [требований программы SAP HANA TDI к хранилищу](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html) мы предлагаем следующую конфигурацию хранилища класса Premium: 

| SKU виртуальной машины | ОЗУ |  /hana/data и /hana/log, <br /> чередующиеся с диспетчером логических томов или MDAADM | /hana/shared | том /root | /usr/sap |
| --- | --- | --- | --- | --- | --- |
| GS5 | 448 ГБ | 2 x P30 | 1 x P20 | 1 x P10 | 1 x P10 | 

В конфигурации диска выше том данных и журнала HANA будут размещаться в одном наборе дисков хранилища класса Premium, чередующихся с диспетчером логических томов или MDAADM. Не нужно задавать какой-либо уровень избыточности RAID, так как хранилище Azure класса Premium сохраняет три образа дисков для обеспечения избыточности. Вы можете выбрать другую конфигурацию диска. Чтобы настроить достаточный объем хранилища, ознакомьтесь с руководствами по [требованиям программы SAP HANA TDI к хранилищу](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html) и [установке и обновлению сервера SAP HANA](http://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm). Мы рекомендуем также учитывать различные объемы пропускной способности виртуального жесткого диска (VHD) разных дисков хранилища класса Premium. Дополнительные сведения см. в статье [Высокопроизводительное хранилище класса Premium и управляемые диски для виртуальных машин Azure](https://docs.microsoft.com/azure/storage/storage-premium-storage). 

В зависимости от спроса можно добавить дополнительные диски хранилища класса Premium на виртуальные машины СУБД HANA, чтобы сохранить резервные копии журнала транзакций или базы данных.

Дополнительные сведения о двух основных инструментах для настройки чередования см. в следующих статьях:

* [Настройка программного RAID-массива в Linux](../../linux/configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [Настройка диспетчера логических томов на виртуальной машине Linux в Azure](../../linux/configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

Дополнительные сведения о присоединении дисков к виртуальным машинам Azure под управлением Linux в качестве гостевой ОС см. в статье [Добавление диска к виртуальной машине Linux](../../linux/add-disk.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

Хранилище Azure класса Premium позволяет определять режимы кэширования диска. Для чередующегося набора, который содержит тома /hana/data и /hana/log, кэширование диска нужно отключить. Для других томов (дисков) для режима кэширования необходимо установить значение "Только для чтения".

Дополнительные сведения см. в статье [Хранилище класса "Премиум": высокопроизводительная служба хранилища для рабочих нагрузок виртуальных машин Azure](../../../storage/storage-premium-storage.md).

Примеры шаблонов JSON для создания виртуальных машин см. на странице с [шаблонами быстрого запуска Azure](https://github.com/Azure/azure-quickstart-templates).
В шаблоне vm-simple-sles показан базовый шаблон, который содержит раздел хранилища с дополнительным диском данных емкостью 100 ГБ. Этот шаблон можно использовать в качестве базы. Его необходимо адаптировать для конкретной конфигурации.

>[!Note]
>Следует помнить, что важно добавить диск хранилища Azure с помощью UUID, как описано в статье [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux в Microsoft Azure](suse-quickstart.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).


В тестовой среде к виртуальной машине сервера приложений SAP необходимо подключить два диска стандартного хранилища Azure, как показано на следующем снимке экрана. На одном хранится программное обеспечение SAP для установки (например, NetWeaver 7.5, графический пользовательский интерфейс SAP, SAP HANA и т. д.). Второй диск обеспечивает достаточный объем свободного места для дополнительных требований (например, резервного копирования и тестовых данных) и предоставление общего доступа к каталогу /sapmnt (т. е. профилям SAP) всем виртуальным машинам, которые относятся к одному ландшафту SAP.

![Окно дисков сервера приложений SAP HANA, отображающее два диска данных и их размеры](./media/hana-get-started/image003.jpg)


### <a name="kernel-parameters"></a>параметры ядра;
Перед установкой SAP HANA необходимо указать определенные параметры ядра Linux, которые не относятся к стандартным образам из коллекции Azure и требуют настройки вручную. Для SUSE или Red Hat параметры могут отличаться. В примечаниях SAP, перечисленных выше, содержатся сведения об этих параметрах. На снимках экрана используется SUSE Linux 12 с пакетом обновления 1 (SP1). 

В общедоступной версии SLES for SAP Applications 12 GA и SLES for SAP Applications 12 с пакетом обновления 1 (SP1) добавлен новый инструмент, заменяющий устаревшую служебную программу sapconf. tuned-adm с особенным профилем SAP HANA. Чтобы настроить систему для SAP HANA, просто введите в качестве привилегированного пользователя: tuned-adm profile sap-hana

Дополнительные сведения об инструменте tuned-adm см. в документации по SUSE:

* [Документация SLES for SAP Applications 12 с пакетом обновления 1 (SP1) по профилю sap-hana для tuned-adm.](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip)

На следующем снимке экрана показаны значения transparent_hugepage и numa_balancing, измененные с помощью tuned-adm в соответствии с требуемыми параметрами SAP HANA.

![Инструмент tuned-adm изменяет значения в соответствии с требуемыми параметрами SAP HANA](./media/hana-get-started/image005.jpg)

Чтобы сделать параметры ядра SAP HANA постоянными, используйте в SLES 12 загрузчик GRUB2. Дополнительные сведения о загрузчике GRUB2 см. в [разделе о структуре файла конфигурации документации по SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

На следующем снимке экрана показаны измененные в файле конфигурации, а затем скомпилированные через grub2-mkconfig параметры ядра.

![Параметры ядра, измененные в файле конфигурации и скомпилированные с помощью grub2-mkconfig](./media/hana-get-started/image006.jpg)

Параметры ядра также можно изменить, используя Yast или выбрав параметры **Boot Loader** > **Kernel Parameters** (Загрузчик > Параметры ядра).

![Вкладка параметров Kernel Parameters (Параметры ядра) в загрузчике YaST](./media/hana-get-started/image007.jpg)

### <a name="file-systems"></a>Файловые системы
На следующем снимке экрана показаны две файловые системы, созданные на виртуальной машине сервера приложений SAP поверх двух подключенных дисков стандартного хранилища Azure. Эти файловые системы типа XFS подключены к /sapdata и /sapsoftware.

Структурировать файловые системы таким образом необязательно. Структурировать дисковое пространство можно и с помощью других параметров. Наиболее важно предотвратить нехватку свободного места в корневой файловой системе.

![Две файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image008.jpg)

Рассматривая виртуальную машину базы данных SAP HANA, важно помнить, что во время установки базы данных при использовании SWPM или обычного варианта установки, установка компонентов выполняется в /hana и /usr/sap. Резервная копия журналов SAP HANA по умолчанию хранится в расположении /usr/sap. Опять же, так как очень важно предотвратить нехватку свободного пространства для корневой файловой системы, перед установкой SAP HANA с помощью SWPM убедитесь, что в разделе /hana и /usr/sap достаточно свободного места.

Описание макета стандартной файловой системы SAP HANA см. в [руководстве по установке и обновлению сервера SAP HANA](http://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm).
![Дополнительные файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image009.jpg)

При установке SAP NetWeaver в среде SLES 12 или SLES for SAP Applications 12 из стандартного образа коллекции Azure отображается сообщение об отсутствии области буфера. Чтобы закрыть это сообщение, можно вручную добавить файл подкачки с помощью dd, mkswap и swapon. Сведения о том, как это сделать, см. в подразделе Adding a Swap File Manually (Добавление файла подкачки вручную) [раздела Using the YaST Partitioner (Использование модуля секционирования YaST) документации по SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

Область буфера можно также настроить с помощью агента виртуальной машины Linux. Дополнительные сведения см. в [руководстве пользователя агента Linux Azure](../../linux/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

![Всплывающее сообщение, предупреждающее о том, что в области буфера недостаточно места](./media/hana-get-started/image010.jpg)


### <a name="etchosts"></a>файл /etc/hosts;
Перед началом установки SAP важно также добавить в файл /etc/hosts имена узлов и IP-адреса виртуальных машин SAP. Разверните все виртуальные машины SAP в одной виртуальной сети Azure, а затем используйте внутренние IP-адреса.

![Имена узлов и IP-адреса виртуальных машин SAP, приведенные в файле /etc/hosts](./media/hana-get-started/image011.jpg)

### <a name="etcfstab"></a>файл /etc/fstab.

На стадии тестирования мы советуем добавить в файл /etc/fstab параметр nofail. При проблемах с дисками это позволит виртуальной машине загрузиться, а не зависнуть в процессе загрузки. Но уделите этому особое внимание, так как в этом сценарии дополнительное место на диске может оказаться недоступным и процессы могут заполнить корневую файловую систему. Если /hana отсутствует, SAP HANA не запустится.

![Добавление в fstab параметра nofail](./media/hana-get-started/image000c.jpg)

## <a name="install-graphical-gnome-desktop-on-sles-12sles-for-sap-applications-12"></a>Установка графического рабочего стола Gnome в SLES 12 или SLES for SAP Applications 12
В этом разделе описываются следующие темы:

* Установка рабочего стола Gnome и xrdp в SLES 12 или SLES for SAP Applications 12.
* Запуск консоли управления SAP на основе Java с помощью Firefox в SLES 12 или SLES for SAP Applications 12.

Вы можете также использовать альтернативные варианты, например Xterminal или VNC, но по состоянию на сентябрь 2016 г. в руководстве описывается только xrdp.

### <a name="installing-gnome-desktop-and-xrdp-on-sles-12sles-for-sap-applications-12"></a>Установка рабочего стола Gnome и xrdp в SLES 12 или SLES for SAP Applications 12.
При наличии операционной системы Microsoft Windows для запуска Firefox, Sapinst, графического пользовательского интерфейса SAP, консоли управления SAP или HANA Studio и подключения к виртуальной машине через удаленный рабочий стол с компьютера Windows можно легко использовать графический рабочий стол непосредственно в виртуальных машинах SAP под управлением Linux. Хотя это нецелесообразно выполнять для рабочего сервера базы данных, это нормально для демонстрационной среды или среды-прототипа. Чтобы установить рабочий стол Gnome на виртуальной машине Azure SLES 12 или SLES for SAP Applications 12, сделайте следующее.

Установите рабочий стол Gnome, введя следующую команду (например, в окне PuTTY):

`zypper in -t pattern gnome-basic`

Чтобы разрешить подключение к виртуальной машине через удаленный рабочий стол, установите xrdp:

`zypper in xrdp`

Измените файл /etc/sysconfig/windowmanager и установите Gnome в качестве диспетчера окон по умолчанию:

`DEFAULT_WM="gnome"`

Запустите chkconfig, чтобы убедиться, что xrdp автоматически запустится после перезагрузки:

`chkconfig -level 3 xrdp on`

Если с подключением к удаленному рабочему столу возникнут проблемы, попробуйте перезагрузить систему (в окне PuTTY):

`/etc/xrdp/xrdp.sh restart`

Если перезапуск xrdp, как указано выше, не выполняется, удалите PID-файл при его наличии.

Проверьте `check /var/run` и поищите `xrdp.pid`.

Удалите его и повторите попытку перезапуска.

### <a name="sap-mc"></a>Консоль управления SAP
После установки рабочего стола Gnome при запуске графической консоли управления SAP на основе Java из Firefox в виртуальной машине Azure SLES 12 или SLES for SAP Applications 12 может отображаться ошибка из-за отсутствия в браузере подключаемого модуля Java.

Чтобы запустить консоль управления SAP, используйте следующий URL-адрес: <server>:5<номер_экземпляра>13.

Дополнительные сведения см. в разделе [Starting the Web-Based SAP Management Console](https://help.sap.com/saphelp_nwce10/helpdata/en/48/6b7c6178dc4f93e10000000a42189d/frameset.htm) (Запуск консоли управления SAP на основе веб-технологий).

На следующем снимке экрана показано сообщение об ошибке, которое отображается при отсутствии в браузере подключаемого модуля Java.

![Сообщение об ошибке, указывающее на отсутствие в браузере подключаемого модуля Java](./media/hana-get-started/image013.jpg)

Чтобы решить эту проблему, достаточно установить отсутствующий подключаемый модуль с помощью YaST, как показано на следующем снимке экрана.

![Использование YaST для установки отсутствующего подключаемого модуля](./media/hana-get-started/image014.jpg)

При повторном вводе URL-адреса консоли управления SAP отображается диалоговое окно с предложением активировать подключаемый модуль.

![Диалоговое окно с запросом на активацию подключаемого модуля](./media/hana-get-started/image015.jpg)

Еще одна проблема, которая может возникнуть, — это сообщение об отсутствующем файле javafx.properties. Это связано с требованием наличия Oracle Java 1.8 для SAP GUI 7.4. [См. примечание к SAP 2059429.](https://launchpad.support.sap.com/#/notes/2059424) Ни версия Java для IBM, ни пакет openjdk, поставляемый в составе SLES или SLES for SAP Applications 12, не содержат необходимый файл javafx. Рекомендуется скачать и установить Java SE8 с сайта Oracle.

Статья, в который рассматривается подобная проблема с openjdk в openSUSE: [SAPGui 7.4 Java for openSUSE 42.1 Leap](https://scn.sap.com/thread/3908306) (SAPGui 7.4 Java для openSUSE 42.1 Leap).

## <a name="install-sap-hana-manually-by-using-swpm-as-part-of-a-netweaver-75-installation"></a>Установка SAP HANA вручную с использованием SWPM в рамках установки NetWeaver 7.5
На серии снимков экрана в этом разделе показаны основные действия по установке SAP NetWeaver 7.5 и SAP HANA SP12 при использовании SWPM (SAPinst). Во время установки NetWeaver 7.5 при использовании SWPM можно также установить отдельный экземпляр базы данных HANA.

В примере среды тестирования мы установили только один сервер приложений Advanced Business Application Programming (ABAP). Как показано на следующем снимке экрана, для установки ASCS и основных экземпляров сервера приложений на одной виртуальной машине Azure и SAP HANA в качестве системы баз данных на другой виртуальной машине Azure мы использовали параметр Distributed System (Распределенная система).

![ASCS и основные экземпляры сервера приложений, установленные с помощью параметра Distributed System (Распределенная система)](./media/hana-get-started/image012.jpg)

После установки экземпляра ASCS на виртуальной машине сервера приложений и задания ему значения green в консоли управления SAP для виртуальной машины сервера базы данных SAP HANA необходимо предоставить доступ к каталогу /sapmnt (содержащему каталог профилей SAP). Доступ к этому каталогу требуется во время установки базы данных. Лучший способ предоставить доступ — использовать клиент NFS, который можно настроить с помощью Yast.

![Консоль управления SAP, отображающая экземпляр ASCS, установленный на виртуальной машине сервера приложений, с заданным значением green](./media/hana-get-started/image016.jpg)

Общий доступ к каталогу /sapmnt на виртуальной машине сервера приложений необходимо предоставить через NFS-клиент с помощью параметров **rw** и **no_root_squash**. По умолчанию используются параметры ro и root_squash, но при установке экземпляра базы данных из-за них могут возникать проблемы.

![Предоставление общего доступа к каталогу /sapmnt через NFS-клиент с использованием параметров rw и no_root_squash](./media/hana-get-started/image017b.jpg)

На следующем снимке экрана показано, как на виртуальной машине сервера базы данных SAP HANA каталог /sapmnt, доступ к которому предоставляется с виртуальной машины сервера приложений, необходимо настроить через **NFS-клиент** (например, с помощью Yast).

![Каталог /sapmnt, настроенный с помощью NFS-клиента](./media/hana-get-started/image018b.jpg)

Для установки **экземпляра базы данных** в рамках распределенной установки NetWeaver 7.5, как показано на следующем снимке экрана, войдите на виртуальную машину сервера базы данных SAP HANA и запустите SWPM.

![Установка экземпляра базы данных путем входа на виртуальную машину сервера базы данных SAP HANA и запуска SWPM](./media/hana-get-started/image019.jpg)

Выбрав "обычную" установку и путь к установочному носителю, введите идентификатор безопасности базы данных, имя узла, количество экземпляров и пароль системного администратора базы данных.

![Страница входа в систему системного администратора базы данных SAP HANA](./media/hana-get-started/image035b.jpg)

Введите пароль схемы DBACockpit.

![Поле для ввода пароля для схемы DBACockpit](./media/hana-get-started/image036b.jpg)

Введите вопрос для пароля схемы SAPABAP1.

![Ввод вопроса для пароля схемы SAPABAP1](./media/hana-get-started/image037b.jpg)

После выполнения задания рядом с каждым этапом процесса установки базы данных появится зеленая галочка. В диалоговом окне отобразится сообщение с текстом Execution of ... Database Instance has completed (Выполнение экземпляра базы данных (...) завершено).

![Окно выполнения задачи, содержащее сообщение с подтверждением](./media/hana-get-started/image023.jpg)

После успешной установки в консоли управления SAP возле экземпляра базы данных также будет установлена зеленая галочка и отобразится список всех процессов SAP HANA (hdbindexserver, hdbcompileserver и т. д.).

![Окно консоли управления SAP со списком процессов SAP HANA](./media/hana-get-started/image024.jpg)

На следующем снимке экрана показаны части структуры файла в каталоге /hana/shared, созданном SWPM во время установки HANA. Так как было невозможно указать другой путь, перед установкой SAP HANA с помощью SWPM важно подключить дополнительное дисковое пространство в каталоге /hana, чтобы выделить корневой файловой системе достаточный объем памяти.

![Структура файла /hana/shared, созданная во время установки HANA](./media/hana-get-started/image025.jpg)

На этом снимке экрана показана структура файла каталога /usr/sap.

![Структура файла каталога usr/sap/](./media/hana-get-started/image026.jpg)

Последний шаг распределенной установки ABAP — это Primary Application Server Instance (Основной экземпляр сервера приложений).

![Установка ABAP, отображающая основной экземпляр сервера приложений в качестве завершающего этапа](./media/hana-get-started/image027b.jpg)

После установки основного экземпляра сервера приложений и графического пользовательского интерфейса SAP убедитесь, что установка SAP HANA выполнена правильно, используя транзакцию dbacockpit.

![Окно DBACockpit с подтверждением успешной установки](./media/hana-get-started/image028b.jpg)

В качестве последнего шага на виртуальной машине сервера приложений SAP можно установить SAP HANA Studio, а затем подключить ее к экземпляру SAP HANA, запущенному на виртуальной машине сервера базы данных.

![Установка SAP HANA Studio на виртуальной машине сервера приложений SAP](./media/hana-get-started/image038b.jpg)

## <a name="install-sap-hana-manually-by-using-the-hana-lifecycle-management-tool-hdblcm"></a>Установка SAP HANA вручную с использованием диспетчера управления жизненным циклом HANA (HDBLCM)
Помимо установки SAP HANA в рамках распределенной установки с помощью SWPM, можно сначала установить только HANA с помощью HDBLCM. После этого можно установить, например, SAP NetWeaver 7.5. На следующих снимках экрана показан этот процесс.

Дополнительные сведения о средстве HDBLCM HANA см. в следующих источниках:

* [Choosing the Correct SAP HANA HDBLCM for Your Task (Выбор подходящего средства SAP HANA HDBLCM для выполнения определенных заданий)](https://help.sap.com/saphelp_hanaplatform/helpdata/en/68/5cff570bb745d48c0ab6d50123ca60/content.htm)
* [SAP HANA Lifecycle Management Tools (Средства управления жизненным циклом SAP Hana)](http://saphanatutorial.com/sap-hana-lifecycle-management-tools/)
* [SAP HANA Server Installation and Update Guide (Руководство по установке и обновлению сервера SAP Hana)](http://help.sap.com/hana/SAP_HANA_Server_Installation_Guide_en.pdf)

Чтобы избежать проблем с настройкой идентификатора группы по умолчанию для пользователя \<HANA SID\>adm (созданного с помощью средства HDBLCM), перед установкой SAP HANA с помощью HDBLCM необходимо определить новую группу sapsys с идентификатором группы 1001.

![Новая группа sapsys, определенная с использованием идентификатора группы 1001](./media/hana-get-started/image030.jpg)

При запуске HDBLCM в первый раз отображается простое главное меню. Выберите пункт 1, **Install new system** (Установка новой системы), как показано на следующем снимке экрана.

![Параметр Install new system (Установка новой системы) в окне запуска HDBLCM](./media/hana-get-started/image031.jpg)

На следующем снимке экрана отображаются все ранее выбранные основные параметры.

> [!IMPORTANT]
> Каталоги, используемые для журналов и томов данных HANA, а также путь установки (/hana/shared в этом примере) и /usr/sap, не должны быть частью корневой файловой системы. Каталоги принадлежат к дискам данных Azure, которые присоединены к виртуальной машине, как описано в разделе по установке виртуальной машины Azure. Этот подход позволит избежать нехватки свободного места в корневой файловой системе. Вы также можете увидеть, что администратор имеет идентификатор 1005 и относится к группе sapsys (с идентификатором 1001), определенной перед установкой.

![Список всех выбранных ранее основных компонентов SAP HANA](./media/hana-get-started/image032.jpg)

В /etc/passwd можно просмотреть сведения о пользователе HANA \<HANA SID\>adm (на следующем снимке экрана — azdadm).

![Сведения о пользователе adm HANA \<ИД безопасности HANA\>, представленные в /etc/passwd](./media/hana-get-started/image033.jpg)

После установки SAP HANA с использованием HDBLCM в SAP HANA Studio отобразится структура файла. Схема SAPABAP1 со всеми таблицами SAP NetWeaver еще недоступна.

![Структура файла SAP HANA в SAP HANA Studio](./media/hana-get-started/image034.jpg)

После установки SAP HANA на его основе можно установить SAP NetWeaver. Как показано на следующем снимке экрана, установка была выполнена как "распределенная" с помощью SWPM (как описано в предыдущем разделе). При установке экземпляра базы данных с помощью SWPM вводятся те же данные, что и в случае использования HDBLCM (например, имя узла, идентификатор безопасности HANA и количество экземпляров). Затем SWPM использует имеющуюся установку HANA и добавляет дополнительные схемы.

![Распределенная установка, выполненная с помощью SWPM](./media/hana-get-started/image035b.jpg)

На следующем снимке экрана показан этап установки SWPM с вводом данных о схеме DBACockpit.

![Этап установки SWPM, на котором вводятся данные о схеме DBACockpit](./media/hana-get-started/image036b.jpg)

Введите данные о схеме SAPABAP1.

![Ввод данных о схеме SAPABAP1](./media/hana-get-started/image037b.jpg)

После установки экземпляра базы данных SWPM схема SAPABAP1 отобразится в SAP HANA Studio.

![Схема SAPABAP1 в SAP HANA Studio](./media/hana-get-started/image038b.jpg)

И наконец, после установки сервера приложений SAP и графического пользовательского интерфейса SAP можно проверить экземпляр базы данных HANA с помощью транзакции DBACockpit.

![Экземпляр базы данных HANA, проверенный с помощью транзакции DBACockpit](./media/hana-get-started/image039b.jpg)


## <a name="sap-software-downloads"></a>Скачивания программного обеспечения SAP
Программное обеспечение можно скачать с SAP Service Marketplace, как показано на следующих снимках экрана.

* Скачивание NetWeaver 7.5 для Linux и HANA.

 ![Окно установки и обновления службы SAP для скачивания NetWeaver 7.5](./media/hana-get-started/image001.jpg)
* Скачивание выпуска HANA SP12 Platform.

 ![Окно установки и обновления службы SAP для скачивания выпуска HANA SP12 Platform](./media/hana-get-started/image002.jpg)


