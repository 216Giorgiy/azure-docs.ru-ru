---
title: IBM Db2 pureScale в Azure
description: В этой статье показана архитектура для работы среды IBM Db2 pureScale в Azure.
services: virtual-machines-linux
documentationcenter: ''
author: njray
manager: edprice
editor: edprice
tags: ''
ms.assetid: ''
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 11/09/2018
ms.author: njray
ms.openlocfilehash: 5a7ae96a3730df2d0dae04dde6d7609ce69cdee5
ms.sourcegitcommit: 8314421d78cd83b2e7d86f128bde94857134d8e1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2018
ms.locfileid: "51978215"
---
# <a name="ibm-db2-purescale-on-azure"></a>IBM Db2 pureScale в Azure

Среда IBM Db2 pureScale предоставляет решение кластера баз данных для Linux с высоким уровнем доступности и масштабируемостью в операционных системах Linux. В этой статье показана архитектура для работы Db2 pureScale в Azure.

## <a name="overview"></a>Обзор

Предприятия давно используют традиционные платформы систем управления реляционной базой данных (RDBMS) для обработки транзакций в Интернете (OLTP). В настоящее время многие переносят свои среды баз данных на основе мейнфреймов в Azure, чтобы увеличить емкость, сократить расходы и поддерживать стабильную структуру эксплуатационных расходов.

Миграция зачастую является первым этапом модернизации устаревшей платформы. Допустим, предприятие недавно переместило свою среду IBM Db2 под управлением z/OS на платформу IBM Db2 pureScale в Azure. Хотя эта среда не идентична исходной, IBM Db2 pureScale в Linux предоставляет примерно те же функции обеспечения высокого уровня доступности и масштабируемости, что и IBM Db2 для z/OS в конфигурации Parallel Sysplex на мейнфрейме.

В этой статье описана архитектура, используемая для этой миграции в Azure. Для тестирования конфигурации использовалась операционная система Red Hat Linux 7.4. Эта версия доступна в Azure Marketplace. Прежде чем выбирать дистрибутив Linux, обязательно проверьте поддерживаемые в настоящее время версии. Дополнительные сведения см. в документации по [IBM Db2 pureScale](https://www.ibm.com/support/knowledgecenter/SSEPGG) и [GlusterFS](https://docs.gluster.org/en/latest/).

Эта статья представляет собой отправную точку для плана реализации Db2. Ваши бизнес-требования будут другими, но базовый шаблон остается без изменений. Этот архитектурный шаблон также можно использовать для приложений OLAP в Azure.

В этой статье не рассматриваются различия и возможные задачи миграции для перемещения базы данных IBM Db2 для z/OS на платформу IBM Db2 pureScale в Linux. Кроме того, в ней не представлены приблизительные эквивалентные размеры и данные анализа рабочих нагрузок для перехода с Db2 z/OS на Db2 pureScale. Чтобы помочь вам выбрать лучшую архитектуру Db2 pureScale для вашей среды, мы настоятельно рекомендуем провести полную оценку размера и установить гипотезу. Помимо прочих факторов, в исходной системе следует учитывать Db2 z/OS Parallel Sysplex с архитектурой обмена данными, конфигурацию раздела обеспечения взаимодействия и статистику использования DDF.

> [!NOTE]
> В этой статье описывается один из подходов к миграции Db2, но есть и другие. Например, Db2 pureScale также может работать в виртуализированных локальных средах. IBM поддерживает Db2 в Microsoft Hyper-V с различными конфигурациями. Дополнительные сведения см. в статье [Архитектура виртуализации Db2 pureScale](https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.qb.server.doc/doc/r0061462.html) на сайте IBM Knowledge Center.

## <a name="architecture"></a>Архитектура

Для поддержки высокого уровня доступности и масштабируемости в Azure, для Db2 pureScale можно использовать архитектуру общих данных с горизонтальным масштабированием. Приведенный ниже пример архитектуры использовался для нашей клиентской миграции.

![](media/db2-purescale-on-azure/pureScaleArchitecture.png "Db2 pureScale на виртуальных машинах Azure с хранилищем и сетью")


На архитектурной схеме показаны логические уровни, необходимые для кластера Db2 pureScale. В их число входят виртуальные машины для клиента, управления, кэширования, ядра СУБД и общего хранилища. Помимо узлов ядра СУБД, схема также включает два узла, используемых для так называемых разделов кэширования кластера (CF). Как минимум два узла используются для самого ядра СУБД. Сервер Db2, принадлежащий кластеру pureScale, называется участником. Кластер подключается через iSCSI к общему кластеру хранения GlusterFS с тремя узлами, чтобы обеспечить горизонтальное масштабирование хранилища и высокий уровень доступности. Db2 pureScale устанавливается на виртуальных машинах Azure под управлением Linux.

Этот подход представляет собой шаблон, который можно изменить в соответствии с размером и масштабом, необходимыми организации, и основан на следующих данных:

-   Два или несколько элементов базы данных совмещаются как минимум с двумя узлами CF, которые управляют глобальным буферным пулом (GBP) для общей памяти и глобальным диспетчером блокировки (GLM) для управления общим доступом и состязанием блокировки между несколькими активными элементами. Один узел CF выступает в качестве основного узла, а другой — в качестве дополнительного узла для отработки отказа. Во избежание создания среды с единой точкой отказа требуется как минимум четыре узла для кластера Db2 pureScale.

-   Высокопроизводительное общее хранилище (показанное с размером P30 на рисунке 1), используемое каждым из узлов Gluster FS.

-   Сетевые подключения высокой производительности для элементов данных и общего хранилища.

### <a name="compute-considerations"></a>Рекомендации по вычислениям

В этой архитектуре уровни приложений, хранилищ и данных работают на виртуальных машинах Azure. [Скрипты настройки развертывания](http://aka.ms/db2onazure) создают следующие компоненты:

-   Кластер Db2 pureScale. Необходимый тип вычислительных ресурсов в Azure зависит от конфигурации. В целом, можно использовать два подхода:

    -   Используйте сеть высокопроизводительных вычислений (HPC) с несколькими узлами, где несколько экземпляров от малого до среднего размера получают доступ к общему хранилищу. Для такой конфигурации типа HPC [виртуальные машины](https://docs.microsoft.com/azure/virtual-machines/windows/sizes) Azure серии E (оптимизированные для памяти) и серии L (оптимизированные для хранилища) предоставляют необходимую вычислительную мощность.

    -   Используйте меньше крупных экземпляров виртуальных машин для подсистем обработки данных. Что касается крупных экземпляров, самые большие виртуальные машины [серии M](https://azure.microsoft.com/pricing/details/virtual-machines/series/), оптимизированные для операций в памяти, идеально подходят для требовательных рабочих нагрузок в памяти. Однако может потребоваться выделенный экземпляр, в зависимости от размера логического раздела (LPAR), используемого для работы Db2.

-   CF Db2 использует оптимизированные для памяти виртуальные машины, например серии E и L.

-   Хранилище GlusterFS использует виртуальные машины Standard\_DS4\_v2 под управлением Linux.

-   Джамп-сервер GlusterFS использует виртуальные машины Standard\_DS2\_v2 под управлением Linux.

-   Клиент — это виртуальная машина Standard\_DS3\_v2 с Windows (используемая для тестирования).

-   Следящий сервер — это виртуальная машина Standard\_DS3\_v2 под управлением Linux (используемая для Db2 pureScale).

> [!NOTE]
> В кластере Db2 pureScale требуется как минимум два экземпляра Db2. Кроме того, необходимы экземпляры кэша и диспетчера блокировки.

### <a name="storage-considerations"></a>Рекомендации по работе с хранилищем

Как и Oracle RAC, Db2 pureScale представляет собой высокопроизводительную базу данных с блочным вводом-выводом и горизонтальным масштабированием. Рекомендуем использовать самый крупный из доступных вариантов [Службы хранилища Azure (цен. категория "Премиум")](https://docs.microsoft.com/azure/virtual-machines/windows/premium-storage), соответствующий вашим потребностям. Например, варианты хранилища меньшего размера могут подходить для сред разработки и тестирования, в то время как для рабочих сред требуется хранилище больше емкости. В примере архитектуры используется решение [P30](https://azure.microsoft.com/pricing/details/managed-disks/), выбранное из-за соотношения количества операций ввода-вывода в секунду с размером и стоимостью. Независимо от размера, для оптимальной производительности используйте хранилище класса Premium.

Db2 pureScale использует полностью общую архитектуру, где все данные доступны со всех узлов кластера. Хранилище класса Premium необходимо совместно использовать в нескольких экземплярах, будь то по запросу или в выделенных экземплярах.

Для крупного кластера Db2 pureScale может потребоваться 200 терабайт (ТБ) и общее хранилище класса выше Premium, где число операций ввода-вывода в секунду составляет 100 000. Db2 pureScale поддерживает интерфейс блоков iSCSI, который можно использовать в Azure. Интерфейсу iSCSI требуется кластер общего хранилища, который следует реализовать с помощью GlusterFS, S2D или другого средства. Решение этого типа создает устройство виртуальной сети хранения данных (vSAN) в Azure. Db2 pureScale использует сеть vSAN для установки кластеризованной файловой системы, применяемой для предоставления доступа к данным между несколькими виртуальными машинами.

Для этой архитектуры мы использовали файловую систему GlusterFS — бесплатную, масштабируемую, распределенную файловую систему с открытым кодом, оптимизированную специально для облачного хранилища.

### <a name="networking-considerations"></a>Рекомендации по работе с сетями

IBM рекомендует сети InfiniBand для всех элементов кластера Db2 pureScale. Db2 pureScale также по мере возможности применяет удаленный доступ к памяти (RDMA) для используемых CF.

Во время установки создается [группа ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview) Azure, содержащая все виртуальные машины. Как правило, ресурсы группируются в соответствии со временем существования ресурсов и пользователя, который ими управляет. Для виртуальных машин в этой архитектуре необходима [ускоренная сеть](https://azure.microsoft.com/blog/maximize-your-vm-s-performance-with-accelerated-networking-now-generally-available-for-both-windows-and-linux/) — функция Azure, предоставляющая согласованную, крайне низкую задержку сети через SR-IOV на виртуальной машине.

Каждая виртуальная машина Azure развертывается в виртуальной сети, сегментированной на несколько подсетей: основную сеть, интерфейсную сеть Gluster FS (gfsfe), фоновую сеть Gluster FS (bfsbe), Db2 pureScale (db2be) и интерфейсную сеть Db2 purescale (db2fe). Скрипт установки также создает основные [сетевые адаптеры](https://docs.microsoft.com/azure/virtual-machines/linux/multiple-nics) на виртуальных машинах в основной подсети.

[Группы безопасности сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) (NSG) применяются для ограничения сетевого трафика в виртуальной сети и изолирования подсетей.

В Azure сеть Db2 pureScale должна использовать для хранилища сетевое подключение по протоколу TCP/IP.

## <a name="next-steps"></a>Дополнительная информация

-   [Развертывание этой архитектуры в Azure](deploy-ibm-db2-purescale-azure.md)
