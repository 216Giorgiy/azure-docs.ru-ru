---
title: "Миграция виртуальных машин Windows между моделями развертывания в Azure | Документация Майкрософт"
description: "Эта статья является техническим руководством по поддерживаемому платформой переносу из классической модели в модель Azure Resource Manager."
services: virtual-machines-windows
documentationcenter: 
author: singhkays
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 1ee40d32-a5e8-42a2-97d0-3232fd3cbb98
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 1/23/2017
ms.author: kasing
translationtype: Human Translation
ms.sourcegitcommit: d835d5825268a4ec0fa5b761f9b5714e3236b0ce
ms.openlocfilehash: 2dd35a65d1b5b6db1401cdf5737b5355aa6d564b


---
# <a name="technical-deep-dive-on-platform-supported-migration-from-classic-to-azure-resource-manager"></a>Техническое руководство по поддерживаемому платформой переносу из классической модели в модель Azure Resource Manager
Давайте подробно рассмотрим миграцию из классической модели развертывания Azure в модель развертывания с помощью Azure Resource Manager. Мы рассмотрим ресурсы на уровне ресурсов и функций. Это поможет вам понять, как платформа Azure переносит ресурсы между двумя моделями развертывания. Чтобы получить дополнительную информацию, прочтите статью с объявлением о выпуске службы [Поддерживаемый платформой перенос ресурсов IaaS из классической модели в модель Azure Resource Manager](virtual-machines-windows-migration-classic-resource-manager.md).

## <a name="detailed-guidance-on-migration"></a>Подробное руководство по миграции
В таблице ниже представлены ресурсы в классической модели и модели Resource Manager. Остальные функции и ресурсы в настоящий момент не поддерживаются.

| Представление классической модели | Представление Resource Manager | Подробные примечания |
| --- | --- | --- |
| Имя облачной службы |DNS-имя |Во время миграции для каждой облачной службы создается новая группа ресурсов, которая именуется по шаблону `<cloudservicename>-migrated`. Эта группа ресурсов содержит все ваши ресурсы. Имя облачной службы становится DNS-именем, связанным с общедоступным IP-адресом. |
| Виртуальная машина. |Виртуальная машина. |Свойства, относящиеся к виртуальной машине, переносятся без изменений. Определенные данные osProfile, например имя компьютера, не хранятся в классической модели развертывания, и после миграции они остались пустыми. |
| Ресурсы дисков, подключенные к виртуальной машине |Скрытые диски, подключенные к виртуальной машине |Диски не моделируются в виде ресурсов верхнего уровня в модели развертывания с помощью Resource Manager. Они переносятся в качестве скрытых дисков в виртуальной машине. В настоящее время поддерживаются только диски, подключенные к виртуальной машине. Теперь виртуальные машины Resource Manager могут использовать классические учетные записи хранения, что позволяет легко перенести диски без каких-либо изменений. |
| Расширения виртуальных машин |Расширения виртуальных машин |Все расширения ресурсов (кроме расширений XML) переносятся из классической модели развертывания. |
| Сертификаты виртуальных машин |Сертификаты в хранилище ключей Azure |Если облачная служба содержит сертификаты службы, то для каждой облачной службы создается новое хранилище ключей Azure, в которое перемещаются эти сертификаты. В виртуальных машинах будут обновлены ссылки на сертификаты из хранилища ключей. <br><br> **Примечание**. Не удаляйте хранилище ключей, так как это может привести к сбою виртуальной машины. Мы работаем над улучшением серверной части, чтобы хранилища ключей можно было безопасно удалить или переместить вместе с виртуальной машиной в новую подписку. |
| Конфигурация WinRM |Конфигурация WinRM в osProfile |Конфигурация службы удаленного управления Windows в ходе миграции перемещается без изменений. |
| Свойство группы доступности |Ресурс группы доступности |Спецификация группы доступности являлась свойством в виртуальной машине в классической модели развертывания. Группы доступности становятся ресурсами верхнего уровня в ходе миграции. Не поддерживаются следующие конфигурации: несколько групп доступности на одну облачную службу либо одна или несколько групп доступности с виртуальными машинами, которые не находятся в какой-либо группе доступности в облачной службе. |
| Конфигурация сети в виртуальной машине |Основной сетевой интерфейс |Конфигурация сети в виртуальной машине после миграции представлена ресурсом основного сетевого интерфейса. У виртуальных машин, которые не находятся в виртуальной сети, при миграции изменится внутренний IP-адрес. |
| Несколько сетевых интерфейсов в виртуальной машине |Сетевые интерфейсы |Если с виртуальной машиной связано несколько сетевых интерфейсов, то в ходе миграции каждый из них (и все соответствующие свойства) становится ресурсом верхнего уровня в модели развертывания с помощью Resource Manager. |
| Набор конечных точек с балансировкой нагрузки |Подсистема балансировки нагрузки |В классической модели развертывания платформа назначает скрытый балансировщик нагрузки для каждой облачной службы. Во время миграции создается новый ресурс балансировщика нагрузки, а набор конечных точек с балансировкой нагрузки преобразовывается в правила балансировщика нагрузки. |
| Правила преобразования сетевых адресов для входящих подключений |Правила преобразования сетевых адресов для входящих подключений |При миграции входные конечные точки, определенные на виртуальной машине, преобразовываются в правила преобразования сетевых адресов для входящих подключений в балансировщике нагрузки. |
| Виртуальный IP-адрес |Общедоступный IP-адрес с DNS-именем |Виртуальный IP-адрес становится общедоступным IP-адресом, связанным с балансировщиком нагрузки. |
| Виртуальная сеть |Виртуальная сеть |Виртуальная сеть и все ее свойства переносятся в модель развертывания с помощью Resource Manager. Создается новая группа ресурсов с именем `-migrated`. Существует ряд [неподдерживаемых конфигураций](virtual-machines-windows-migration-classic-resource-manager.md). |
| Зарезервированные IP-адреса |Общедоступный IP-адрес с методом статического выделения |Зарезервированные IP-адреса, связанные с балансировщиком нагрузки, переносятся вместе с облачной службой или виртуальной машиной. Перенос несвязанных зарезервированных IP-адресов в настоящее время не поддерживается. |
| Общедоступный IP-адрес для каждой виртуальной машины |Общедоступный IP-адрес с методом динамического выделения |Общедоступный IP-адрес, связанный с виртуальной машиной, преобразуется в ресурс общедоступного IP-адреса со статическим методом выделения. |
| Группы NSG |Группы NSG |Группы безопасности сети, связанные с подсетью, в ходе миграции клонируются в модель развертывания с помощью Resource Manager. Группа безопасности сети в классической модели развертывания не удаляется в ходе миграции. Однако на период миграции для группы безопасности сети блокируются операции в плоскости управления. |
| "Серверы DNS" |"Серверы DNS" |DNS-серверы, связанные с виртуальной сетью или виртуальной машиной, переносятся в ходе миграции соответствующего ресурса вместе со всеми свойствами. |
| Определяемые пользователем маршруты |Определяемые пользователем маршруты |Определяемые пользователем маршруты, связанные с подсетью, в ходе миграции клонируются в модель развертывания с помощью Resource Manager. Определяемый пользователем маршрут (UDR) в классической модели развертывания не удаляется в ходе миграции. На период миграции для определяемого пользователем маршрута блокируются операции в плоскости управления. |
| Свойство IP-пересылки в конфигурации сети виртуальной машины |Свойство IP-пересылки в сетевой карте |Свойство IP-пересылки в виртуальной машине во время миграции преобразуется в свойство в сетевом интерфейсе. |
| Балансировщик нагрузки с несколькими IP-адресами |Балансировщик нагрузки с несколькими ресурсами IP-адресов |Каждый общедоступный IP-адрес, связанный с балансировщиком нагрузки, после миграции преобразуется в ресурс общедоступного IP-адреса и связывается с балансировщиком нагрузки. |
| Внутренние DNS-имена в виртуальной машине |Внутренние DNS-имена в сетевой карте |Во время миграции внутренние DNS-суффиксы виртуальных машин переносятся в свойство только для чтения InternalDomainNameSuffix в сетевой карте. После миграции суффикс не изменяется, не должно измениться и разрешение виртуальной машины. |
| Шлюз виртуальной сети |Шлюз виртуальной сети |Свойства шлюза виртуальной сети переносятся без изменений. Виртуальный IP-адрес, связанной со шлюзом, также не меняется. |
| Сайт локальной сети |Шлюз локальной сети |Свойства сайта локальной сети переносятся без изменений в новый ресурс, Local Network Gateway. Это касается префиксов локальных адресов и IP-адреса удаленного шлюза. |
| Ссылки на подключения |Подключение |Ссылки на подключения между шлюзом и сайтом локальной сети в конфигурации сети представлены новым ресурсом Connection в Resource Manager после переноса. Все свойства ссылки на подключение в файлах конфигурации сети копируются без изменений новый ресурс Connection. Подключение между виртуальными сетями в классической модели достигается путем создания двух туннелей IPsec для сайтов локальной сети, представляющих виртуальные сети. Это преобразуется в подключение типа Vnet2Vnet в модели Resource Manager, для которого не нужны шлюзы локальной сети. |

## <a name="illustration-of-a-simple-migration-walkthrough"></a>Демонстрация пошагового выполнения простой миграции
На следующем снимке экрана показана облачная служба с виртуальной машиной (не в виртуальной сети) после этапа подготовки.

![Представление классической модели после подготовки](./media/virtual-machines-windows-migration-classic-resource-manager/classic-migration-prepare-portal.png)

На следующем снимке экрана показано, что после завершения переноса в новой группе ресурсов были созданы новые ресурсы. ![Представление модели Resource Manager после подготовки](./media/virtual-machines-windows-migration-classic-resource-manager/resourcemanager-migration-prepare-portal.png)

## <a name="next-steps"></a>Дальнейшие действия
Теперь, когда вы получили представление о миграции классических ресурсов IaaS в Resource Manager, можно приступить к переносу ресурсов.

* [Перенос ресурсов IaaS из классической модели в модель Azure Resource Manager с помощью Azure PowerShell](virtual-machines-windows-ps-migration-classic-resource-manager.md)
* [Перенос ресурсов IaaS из классической модели в модель Azure Resource Manager с помощью интерфейса командной строки Azure](virtual-machines-linux-cli-migration-classic-resource-manager.md)
* [Поддерживаемый платформой перенос ресурсов IaaS из классической модели в модель Azure Resource Manager](virtual-machines-windows-migration-classic-resource-manager.md)
* [Клонирование классической виртуальной машины в Azure Resource Manager с помощью сценариев PowerShell](virtual-machines-windows-migration-scripts.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
* [Распространенные ошибки миграции](virtual-machines-migration-errors.md)




<!--HONumber=Jan17_HO5-->


