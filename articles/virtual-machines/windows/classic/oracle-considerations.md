---
title: "Рекомендации по использованию образов виртуальных машин Oracle | Документация Майкрософт"
description: "Перед началом развертывания узнайте о поддерживаемых конфигурациях и ограничениях для виртуальных машин Oracle на Windows Server в Azure."
services: virtual-machines-windows
documentationcenter: 
manager: timlt
author: rickstercdn
tags: azure-service-management
ms.assetid: 5d71886b-463a-43ae-b61f-35c6fc9bae25
ms.service: virtual-machines-windows
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 09/06/2016
ms.author: rclaus
translationtype: Human Translation
ms.sourcegitcommit: 356de369ec5409e8e6e51a286a20af70a9420193
ms.openlocfilehash: 4f6f8dd109a1f0d395782ba73fd425c7a6ccf0eb
ms.lasthandoff: 03/27/2017


---
# <a name="miscellaneous-considerations-for-oracle-virtual-machine-images"></a>Различные рекомендации по образам виртуальных машин Oracle
В этой статье рассматриваются рекомендации для виртуальных машин Oracle в Azure на основе образов программного обеспечения Oracle, предоставляемых Oracle.  

* Образы виртуальных машин для базы данных Oracle
* Образы виртуальных машин Oracle WebLogic Server
* Образы виртуальных машин JDK для Oracle

## <a name="oracle-database-virtual-machine-images"></a>Образы виртуальных машин для базы данных Oracle
### <a name="clustering-rac-is-not-supported"></a>Кластеризация (средство анализа стабильности системы) не поддерживается
На данный момент Azure не поддерживает кластеры реальных приложений Oracle (RAC) баз данных Oracle. Поддерживаются только автономные экземпляры баз данных Oracle. Это обусловлено тем, что на данный момент Azure не поддерживает общего доступа к виртуальным дискам в режиме чтения и записи для нескольких экземпляров виртуальной машины. Многоадресная рассылка по UDP также не поддерживается.

### <a name="no-static-internal-ip"></a>Статический внутренний IP-адрес отсутствует
Azure назначает внутренний IP-адрес каждой виртуальной машине. Если виртуальная машина является частью виртуальной сети, то IP-адрес виртуальной машины является динамическим и может измениться после перезапуска виртуальной машины. Это может вызвать проблемы, так как для базы данных Oracle требуется статический IP-адрес. Чтобы избежать этого, рассмотрите возможность добавления виртуальной машины в виртуальную сеть Azure. Дополнительные сведения см. в статьях [Виртуальная сеть](https://azure.microsoft.com/documentation/services/virtual-network/) и [Создание виртуальной сети в Azure](../../../virtual-network/virtual-networks-create-vnet-arm-pportal.md).

### <a name="attached-disk-configuration-options"></a>Варианты конфигурации подключенного диска
Файлы данных можно разместить на диске операционной системы виртуальной машины или на подключенных дисках, также известных как диски данных. Подключенные диски отличаются от дисков ОС более высокой производительностью и возможностью изменения размера. Диск операционной системы предпочтительно использовать только для баз данных, размер которых не превышает 10 гигабайт (ГБ).

Подключенные диски используют службу хранилища больших двоичных объектов Azure. Теоретически каждый диск способен выполнять максимум около 500 операций ввода-вывода в секунду (IOPS). Первоначально производительность подключенных дисков может быть неоптимальной, а производительность операций ввода-вывода может значительно повыситься после приработки в течение 60–90 минут непрерывной работы. Если после этого диск остается неактивным, производительность операций ввода-вывода может снизиться до очередного периода приработки (непрерывной работы). Иными словами, чем более активно используется диск, тем скорее он достигнет оптимальной производительности операций ввода-вывода в секунду.

Хотя подключение одного диска к виртуальной машине и размещение на нем всех файлов является самым простым подходом, этот подход также обладает наибольшими ограничениями с точки зрения производительности. Вместо этого эффективность производительности операций ввода-вывода в секунду зачастую можно повысить, использовав несколько подключенных дисков, распределив между ними данные базы данных, а затем применив Oracle Automatic Storage Management (ASM). Дополнительные сведения см. в статье [Обзор Oracle Automatic Storage](http://www.oracle.com/technetwork/database/index-100339.html). Несмотря на то что на уровне ОС можно использовать чередование нескольких дисков, мы не советуем применять такой подход, так как неизвестно, повышается ли от этого производительность операций ввода-вывода.

Рассмотрим два различных подхода к подключению нескольких дисков в зависимости от того, какие операции в базе данных самые приоритетные — операции чтения или записи.

* **Если использовать только Oracle ASM** , это может привести к повышению производительности операций записи и понижению производительности ввода-вывода в секунду для операций чтения по сравнению с подходом, при котором используются дисковые массивы. На следующем рисунке показана схема логического размещения при использовании такого подхода.  
    ![](media/mysql-2008r2/image2.png)

> [!IMPORTANT]
> Оцените разницу в производительности операций записи и чтения для каждого отдельного случая. При использовании этих подходов фактические результаты могут отличаться.
> 
> 

### <a name="high-availability-and-disaster-recovery-considerations"></a>Рекомендации по высокой доступности и аварийному восстановлению
При использовании базы данных Oracle в виртуальных машинах Azure вы отвечаете за реализацию решения, которое обеспечивает высокую доступность и аварийное восстановление во избежание простоев. Вы также отвечаете за резервное копирование данных и приложений.

Высокую доступность и аварийное восстановление в Oracle Database Enterprise Edition (без RAC) в Azure можно реализовать с помощью [Data Guard, Active Data Guard](http://www.oracle.com/technetwork/articles/oem/dataguardoverview-083155.html) или [Oracle Golden Gate](http://www.oracle.com/technetwork/middleware/goldengate), разместив две базы данных в двух отдельных виртуальных машинах. Обе виртуальные машины должны находиться в одной [облачной службе](../../linux/classic/connect-vms.md) и [виртуальной сети](https://azure.microsoft.com/documentation/services/virtual-network/), чтобы они могли обращаться друг к другу через частный постоянный IP-адрес.  Кроме того, рекомендуется размещать виртуальные машины в одной [группе доступности](../../virtual-machines-windows-manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), так как это позволяет Azure помещать их в отдельные домены сбоя и домены обновления. В одной и той же группе доступности можно разместить только виртуальные машины из одной и той же облачной службы. Каждая виртуальная машина должна иметь не менее 2 ГБ оперативной памяти и 5 ГБ дискового пространства.

При использовании Oracle Data Guard высокую доступность можно обеспечить, разместив базу данных источника в одной виртуальной машине и базу данных получателя (резервную) в другой виртуальной машине и настроив одностороннюю репликацию между ними. В результате можно получить доступ на чтение к копии базы данных. При использовании Oracle GoldenGate можно настроить двунаправленную репликацию между двумя базами данных. Дополнительные сведения о настройке высокой доступности для баз данных с помощью этих инструментов см. в документации по [Active Data Guard](http://www.oracle.com/technetwork/database/features/availability/data-guard-documentation-152848.html) и [GoldenGate](http://docs.oracle.com/goldengate/1212/gg-winux/index.html) на веб-сайте Oracle. Если вам требуется получить доступ на чтение и запись к копии базы данных, ознакомьтесь с документом [Oracle Active Data Guard](http://www.oracle.com/uk/products/database/options/active-data-guard/overview/index.html).

## <a name="oracle-weblogic-server-virtual-machine-images"></a>Образы виртуальных машин Oracle WebLogic Server
* **Кластеризация поддерживается только в выпуске Enterprise Edition.** Ваша лицензия дает право использовать кластеризацию WebLogic только при использовании выпуска WebLogic Server Enterprise Edition. Не используйте кластеризацию с выпуском WebLogic Server Standard Edition.
* **Время ожидания подключения:** если ваше приложение использует подключение к общедоступным конечным точкам другой облачной службы Azure (например, службы уровня базы данных), то Azure может закрыть эти открытые подключения по истечении четырех минут бездействия. Это может повлиять на компоненты и приложения, использующие пулы подключений, так как подключения, которые не используются в течение более длительного периода времени, могут стать недействительными. Если это влияет на ваше приложение, рассмотрите возможность включения логики проверки активности в пулах подключений.
  
   Если конечная точка является *внутренней* по отношению к развертыванию облачной службы Azure (например, виртуальная машина автономной базы данных, которая находится в *той же* облачной службе, что и виртуальные машины WebLogic), то подключение является прямым и не зависит от Azure Load Balancer. Таким образом, к этому подключению не применяется время ожидания подключения.
* **Не поддерживается многоадресная рассылка по UDP.** Azure поддерживает одноадресную рассылку по UDP, но не поддерживает ни многоадресную, ни широковещательную рассылку. WebLogic Server может использовать возможности одноадресной рассылки по UDP в Azure. Чтобы получить наилучшие результаты при использовании одноадресной рассылки по UDP, мы советуем не изменять размер кластера WebLogic и не размещать в кластере более 10 управляемых серверов.
* **WebLogic Server ожидает использования одинаковых общих и частных портов для доступа к каналу T3 (например, при использовании Enterprise JavaBeans).** Рассмотрим многоуровневый сценарий, при котором приложение уровня служб (EJB) выполняется в кластере WebLogic Server, состоящем из двух или более управляемых серверов, в облачной службе с именем **SLWLS**. Клиентский уровень расположен в другой облачной службе, которая выполняет простую программу Java, которая пытается вызвать EJB на уровне служб. Так как необходимо сбалансировать нагрузку для уровня служб, нужно создать общедоступную конечную точку с балансировкой нагрузки для виртуальных машин в кластере WebLogic Server. Если частный порт, заданный для этой конечной точки, отличается от общедоступного порта (например, 7006:7008), появится следующая ошибка:
  
       [java] javax.naming.CommunicationException [Root exception is java.net.ConnectException: t3://example.cloudapp.net:7006:
  
       Bootstrap to: example.cloudapp.net/138.91.142.178:7006' over: 't3' got an error or timed out]
  
   Это вызвано тем, что при любой установке удаленного доступа к каналу T3 WebLogic Server ожидает использования одинаковых портов балансировки нагрузки и портов управляемых серверов WebLogic. В приведенном выше примере клиент обращается к порту 7006 (порт балансировки нагрузки), а управляемый сервер прослушивает порт 7008 (частный порт). Это ограничение применяется только для доступа к каналу T3, а не к HTTP.
  
   Чтобы избежать этой проблемы, используйте одно из следующих решений:
  
  * Используйте частные и общие порты с одинаковыми номерами для конечных точек с балансировкой нагрузки, выделенных для получения доступа к каналу T3.
  * Добавьте следующий параметр виртуальной машины Java при запуске WebLogic Server:
    
         -Dweblogic.rjvm.enableprotocolswitch=true

Дополнительные сведения см. в статье базы знаний **860340.1** по адресу <http://support.oracle.com>.

* **Ограничения для динамической кластеризации и балансировки нагрузки.** Предположим, что вы хотите использовать динамический кластер в WebLogic Server и сделать его доступным через единственную общедоступную конечную точку с балансировкой нагрузки в Azure. Для этого нужно использовать порт с определенным номером для каждого из управляемых серверов (номер порта не должен динамически назначаться из диапазона). Количество запускаемых управляемых серверов не должно превышать количество виртуальных машин, которые отслеживает администратор (то есть не более одного управляемого сервера на одну виртуальную машину). Если количество серверов WebLogic в вашей конфигурации превышает количество виртуальных машин (то есть если несколько экземпляров WebLogic Server совместно используют одну и ту же виртуальную машину), то невозможно привязать к заданному номеру порта более одного экземпляра серверов WebLogic Server. Остальные экземпляры на этой виртуальной машине привязать не удастся.
  
   С другой стороны, если настроить сервер администратора таким образом, чтобы управляемым серверам автоматически назначались уникальные номера портов, то будет невозможна балансировка нагрузки, так как Azure не поддерживает сопоставление одного общедоступного порта с несколькими частными портами, которое потребовалось бы для этой конфигурации.
* **Несколько экземпляров сервера Weblogic Server на виртуальной машине.** В зависимости от требований вашего развертывания следует рассмотреть возможность запуска нескольких экземпляров WebLogic Server на одной и той же виртуальной машине при условии, что ее размер достаточно большой. Например, на виртуальной машине среднего размера с двумя ядрами можно запустить два экземпляра WebLogic Server. Обратите внимание, что мы все равно не рекомендуем использовать в архитектуре единые точки отказа, как может произойти при выполнении нескольких экземпляров WebLogic Server на одной виртуальной машине. Лучше использовать не менее двух виртуальных машин, на каждой из которых может выполняться несколько экземпляров WebLogic Server. При этом все эти экземпляры WebLogic Server могут быть частью одного и того же кластера. Тем не менее обратите внимание, что на данный момент невозможно использовать Azure для балансировки нагрузки конечных точек, предоставляемых такими развертываниями WebLogic Server в пределах одной и той же виртуальной машины, так как подсистема балансировки нагрузки Azure требует, чтобы серверы с балансировкой нагрузки были распределены между отдельными виртуальными машинами.

## <a name="oracle-jdk-virtual-machine-images"></a>Образы виртуальных машин JDK для Oracle
* **Последние обновления JDK 6 и 7.** Хотя мы советуем использовать последнюю общедоступную поддерживаемую версию Java (на данный момент это Java 8), в Azure также доступны образы JDK 6 и 7. Они предназначены для устаревших приложений, которые еще невозможно обновить до версии JDK 8. Хотя обновления для предыдущих образов JDK могут быть уже недоступными, благодаря сотрудничеству корпорации Майкрософт и компании Oracle образы JDK 6 и 7, предоставляемые Azure, будут содержать более свежее частное обновление, которое обычно предоставляется только избранной группе клиентов, поддерживаемых Oracle. Новые версии образов JDK, а также обновленные версии JDK 6 и 7 будут доступны со временем.
  
   Комплект JDK, доступный в этих образах JDK 6 и 7, а также виртуальные машины и образы, полученные из них, можно использовать только в Azure.
* **64-разрядный JDK.** Образы виртуальных машин Oracle WebLogic Server и Oracle JDK, предоставляемые Azure, содержат 64-разрядные версии Windows Server и JDK.

## <a name="additional-resources"></a>Дополнительные ресурсы
[Образы виртуальных машин Oracle для Azure](../../linux/classic/oracle-images.md)


