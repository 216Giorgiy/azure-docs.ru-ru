<properties
	pageTitle="Управление доступностью виртуальных машин | Microsoft Azure"
	description="Описывается, как использовать несколько виртуальных машин для обеспечения высокой доступности приложения Azure."
	services="virtual-machines"
	documentationCenter=""
	authors="kenazk"
	manager="timlt"
	editor="tysonn"
	tags="azure-resource-manager,azure-service-management"/>

<tags
	ms.service="virtual-machines"
	ms.workload="infrastructure-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/23/2015"
	ms.author="kenazk"/>

# Управление доступностью виртуальных машин

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-both-include.md)]

## Сравнение планового и внепланового обслуживания
На доступность ваших виртуальных машин могут повлиять такие два типа событий платформы Microsoft Azure: плановое и внеплановое обслуживание.

- **События запланированного обслуживания** — это периодические обновления, осуществляемые корпорацией Майкрософт на базовой платформе Azure для улучшения общей надежности, производительности и безопасности инфраструктуры платформы, на которой работают ваши виртуальные машины. Большинство таких обновлений выполняется без какого-либо воздействия на ваши виртуальные машины или облачные службы. Тем не менее в некоторых случаях требуется перезагрузить виртуальную машину, чтобы применить необходимые обновления к инфраструктуре платформы.

- **События незапланированного обслуживания** происходят в тех случаях, когда в оборудовании или физической инфраструктуре, на основе которых работает виртуальная машина, происходит какая-либо ошибка. Это могут быть сбои локальной сети или локальных жестких дисков, а также другие ошибки на уровне стойки. При выявлении такой ошибки платформа Azure автоматически выполнит перенос вашей виртуальной машины с неработоспособной физической машины, где она размещена, на исправную. Это происходит редко, но также может быть причиной перезагрузки вашей виртуальной машины.

## Следуйте рекомендациям, чтобы обеспечить высокий уровень доступности разрабатываемых вами приложений
Чтобы уменьшить воздействие простоя из-за одного или нескольких из описанных здесь событий, мы рекомендуем вам выполнить на своих виртуальных машинах следующие действия по обеспечению высокого уровня доступности.

* [Настройка нескольких виртуальных машин в группе доступности для обеспечения избыточности]
* [Настройка каждого уровня приложений в отдельной группе доступности]
* [Объединение подсистемы балансировки нагрузки с группами доступности]
* [Избежание наличия одиночных экземпляров виртуальных машин в группах доступности]

### Настройка нескольких виртуальных машин в группе доступности для обеспечения избыточности
Чтобы обеспечить избыточность для своего приложения, мы рекомендуем сгруппировать две или больше виртуальных машин в группе доступности. Эта конфигурация обеспечит доступность не менее одной виртуальной машины и достижение показателя 99,95 % уровня обслуживания (SLA) Azure как при событиях запланированного обслуживания, так и при незапланированного. Дополнительные сведения о соглашениях об уровне обслуживания см. в разделе «Облачные службы, виртуальные машины и виртуальная сеть» в [соглашении об уровне обслуживания](../../../support/legal/sla/).

Платформа Azure назначает каждой виртуальной машине в группе доступности домен обновления (UD) и домен сбоя (FD). Для заданной группы доступности присваивается пять доменов обновления, без возможности изменения пользователем, чтобы указать группы виртуальных машин и базовое физическое оборудование, которые могут быть одновременно перезагружены. Если в одной группе доступности настраивается более пяти виртуальных машин, то шестая виртуальная машина будет помещена в тот же домен обновления, что первая виртуальная машина, седьмая — что и вторая, и т. д. Порядок перезагрузки доменов обновления при выполнении запланированного обслуживания может не быть последовательным, но одновременно будет перезагружаться только один домен обновления.

Домены сбоя определяют группу виртуальных машин, которые совместно используют общий источник питания и сетевой коммутатор. По умолчанию виртуальные машины, настроенные вами в группе доступности, разделяются на два домена сбоя. Внесение виртуальных машин в группу доступности не защитит ваше приложение от сбоев, связанных с операционной системой или приложениями, однако это ограничит последствия сбоев физического оборудования, сети и электропитания.

<!--Image reference-->
   ![Настройка домена обновления и домена сбоя](./media/virtual-machines-manage-availability/ud-fd-configuration.png)

>[AZURE.NOTE]Необходимые инструкции см. в статье [Настройка группы доступности для виртуальных машин][].

### Настройка каждого уровня приложений в отдельной группе доступности
Если все виртуальные машины в группе доступности примерно идентичны и служат для одной и той же цели приложения, мы рекомендуем настраивать по одной группе доступности для каждого уровня приложения. Если разместить два различных уровня в одной группе доступности, то можно одновременно перезапускать все виртуальные машины на одном уровне приложения. Настроив хотя бы по две виртуальные машины в группе доступности для каждого уровня, вы гарантируете, что хотя бы одна виртуальная машина на каждом уровне будет доступна.

Например, вы можете поместить все виртуальные машины из внешнего интерфейса приложения под управлением IIS, Apache, Nginx и т. д. в одну группу доступности. Убедитесь, что в одну группу доступности помещены только виртуальные машины из интерфейсной части. Аналогичным образом убедитесь, что в другую группу доступности помещены только виртуальные машины уровня данных, например реплицированные виртуальные машины SQL Server или MySQL.

<!--Image reference-->
   ![Уровни приложений](./media/virtual-machines-manage-availability/application-tiers.png)


### Объединение подсистемы балансировки нагрузки с группами доступности
Для получения максимальной устойчивости приложения объедините подсистему балансировки нагрузки Azure с группой доступности. Подсистема балансировки нагрузки Azure распределяет трафик между несколькими виртуальными машинами. Наши виртуальные машины стандартного уровня включают в себя подсистему балансировки нагрузки Azure. Обратите внимание, что не все уровни виртуальных машин имеют балансировщик нагрузки Azure. Дополнительные сведения о балансировке нагрузки виртуальных машин см. в статье [Балансировка нагрузки виртуальных машин](../load-balance-virtual-machines.md).

Если подсистема балансировки нагрузки не настроена для балансировки трафика между несколькими виртуальными машинами, то любое запланированное событие обслуживания будет оказывать воздействие на единственную виртуальную машину, обслуживающую трафик, что приведет к сбою на уровне приложений. Если поместить несколько виртуальных машин одного уровня в одну подсистему балансировки нагрузки и группу доступности, то трафик будет непрерывно обслуживаться хотя бы одним экземпляром.

### Не оставляйте в группах доступности одиночные экземпляры виртуальных машин
Избегайте ситуации, когда в группе доступности остается один экземпляр виртуальной машины. В такой конфигурации виртуальные машины не смогут обеспечивать уровень обслуживания, предусмотренный соглашением об уровне обслуживания, и будут простаивать во время плановых сеансов обслуживания Azure. Обратите внимание, что на виртуальных машинах с несколькими экземплярами и запланированным уведомлением об обслуживании одиночный экземпляр виртуальной машины в группе доступности также будет получать дополнительные уведомления по электронной почте.

<!-- Link references -->
[Настройка нескольких виртуальных машин в группе доступности для обеспечения избыточности]: #configure-multiple-virtual-machines-in-an-availability-set-for-redundancy
[Настройка каждого уровня приложений в отдельной группе доступности]: #configure-each-application-tier-into-separate-availability-sets
[Объединение подсистемы балансировки нагрузки с группами доступности]: #combine-the-load-balancer-with-availability-sets
[Избежание наличия одиночных экземпляров виртуальных машин в группах доступности]: #avoid-single-instance-virtual-machines-in-availability-sets
[Настройка группы доступности для виртуальных машин]: virtual-machines-how-to-configure-availability.md

<!---HONumber=Oct15_HO4-->