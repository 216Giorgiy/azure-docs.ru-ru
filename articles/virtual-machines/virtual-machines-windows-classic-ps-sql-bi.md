<properties
	pageTitle="Бизнес-аналитика SQL Server | Microsoft Azure"
	description="В этой статье используются ресурсы, созданные с помощью классической модели развертывания, и описываются функции бизнес-аналитики, доступные для SQL Server, запущенного на виртуальных машинах Azure."
	services="virtual-machines-windows"
	documentationCenter="na"
	authors="guyinacube"
	manager="mblythe"
	editor="monicar"
	tags="azure-service-management"/>
<tags
	ms.service="virtual-machines-windows"
	ms.devlang="na"
	ms.topic="article"
	ms.tgt_pltfrm="vm-windows-sql-server"
	ms.workload="infrastructure-services"
	ms.date="05/13/2016"
	ms.author="asaxton" />

# Бизнес-аналитика SQL Server на виртуальных машинах Azure

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-classic-include.md)]Модель диспетчера ресурсов.


Коллекция виртуальных машин Microsoft Azure включает в себя образы, содержащие установки SQL Server. Выпуски SQL Server, поддерживаемые в образах коллекции, представляют сбой те же файлы установки, которые можно установить на локальных компьютерах и виртуальных машинах. В этом разделе приведены сводные данные об установленных в образах компонентах бизнес-аналитики SQL Server, а также о настройке, необходимой после подготовки виртуальной машины. Кроме того, в этом разделе описаны поддерживаемые топологии развертывания для компонентов бизнес-аналитики и рекомендации.

## Рекомендации по лицензированию

Существует два способа лицензирования SQL Server на виртуальных машинах Microsoft Azure.

1. Преимущества перемещения лицензий, предоставляемые в рамках программы Software Assurance. Дополнительные сведения см. в разделе [Перемещение лицензий в рамках программы Software Assurance в Azure](https://azure.microsoft.com/pricing/license-mobility/).

1. Оплата виртуальных машин Azure с установленным SQL Server по часовой ставке. См. раздел «SQL Server» на странице [Виртуальные машины: цены](https://azure.microsoft.com/pricing/details/virtual-machines/#Sql).

Дополнительные сведения о лицензировании и текущих тарифах см. в разделе [Часто задаваемые вопросы о лицензировании виртуальных машин](https://azure.microsoft.com/pricing/licensing-faq/%20/).

## Образы SQL Server, доступные в коллекции виртуальных машин Azure

Коллекция виртуальных машин Microsoft Azure включает в себя несколько образов, содержащих Microsoft SQL Server. Программное обеспечение, установленное в образах виртуальной машины, зависит от версии операционной системы и версии SQL Server. Список образов в коллекции виртуальных машин Azure часто изменяется.

![Образ SQL в коллекции виртуальных машин Azure](./media/virtual-machines-windows-classic-ps-sql-bi/IC741367.png)

![PowerShell](./media/virtual-machines-windows-classic-ps-sql-bi/IC660119.gif) Следующий сценарий PowerShell возвращает список образов Azure, содержащих значение «SQL-Server» в элементе ImageName:

	# assumes you have already uploaded a management certificate to your Microsoft Azure Subscription. View the thumbprint value from the "settings" menu in Azure classic portal.

	$subscriptionID = ""    # REQUIRED: Provide your subscription ID.
	$subscriptionName = "" # REQUIRED: Provide your subscription name.
	$thumbPrint = "" # REQUIRED: Provide your certificate thumbprint.
	$certificate = Get-Item cert:\currentuser\my\$thumbPrint # REQUIRED: If your certificate is in a different store, provide it here.-Ser  store is the one specified with the -ss parameter on MakeCert

	Set-AzureSubscription -SubscriptionName $subscriptionName -Certificate $certificate -SubscriptionID $subscriptionID

	Write-Host -foregroundcolor green "List of available gallery images where imagename contains 2016"
	Write-Host -foregroundcolor green ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
	get-azurevmimage | where {$_.ImageName -Like "*SQL-Server-2016*"} | select imagename,category, location, label, description

	Write-Host -foregroundcolor green "List of available gallery images where imagename contains 2014"
	Write-Host -foregroundcolor green ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
	get-azurevmimage | where {$_.ImageName -Like "*SQL-Server-2014*"} | select imagename,category, location, label, description

Дополнительные сведения о выпусках и функциях, поддерживаемых в SQL Server, см. в следующих разделах.

- [Выпуски SQL Server](https://www.microsoft.com/server-cloud/products/sql-server-editions/#fbid=Zae0-E6r5oh)

- [Features Supported by the Editions of SQL Server 2016](https://msdn.microsoft.com/library/cc645993.aspx) (Функции, поддерживаемые различными выпусками SQL Server 2016).

### Компоненты бизнес-аналитики, установленные в образах коллекции виртуальных машин SQL Server

В следующей таблице перечислены компоненты бизнес-аналитики, установленные в общих образах коллекции виртуальных машин Microsoft Azure, для SQL Server.

- SQL Server 2016 RC3

- SQL Server 2014 SP1 Enterprise

- SQL Server 2014 SP1 Standard

- SQL Server 2012 SP2 Enterprise

- SQL Server 2012 SP2 Standard

|Компонент бизнес-аналитики SQL Server|Установлен в образе коллекции|Примечания|
|---|---|---|
|**Собственный режим служб Reporting Services**|Да|Установлен, но требует настройки, включая URL-адрес диспетчера отчетов. См. раздел [Настройка служб Reporting Services](#configure-reporting-services).|
|**Режим SharePoint служб Reporting Services**|Нет|Образ коллекции виртуальных машин Microsoft Azure не включает в себя SharePoint или файлы установки SharePoint. <sup>1</sup>|
|**Многомерный и интеллектуальный анализ данных в службах Analysis Services (OLAP)**|Да|Установлен и настроен в качестве экземпляра служб Analysis Services по умолчанию.|
|**Табличный режим служб Analysis Services**|Нет|Поддерживается в образах SQL Server 2012, 2014 и 2016, но не устанавливается по умолчанию. Установите другой экземпляр служб Analysis Services. См. подраздел "Установка других служб и компонентов SQL Server" этого раздела.|
|**Power Pivot служб Analysis Services для SharePoint**|Нет|Образ коллекции виртуальных машин Microsoft Azure не включает в себя SharePoint или файлы установки SharePoint. <sup>1</sup>|

<sup>1</sup> Дополнительные сведения о SharePoint и виртуальных машинах Azure см. в статьях [Архитектура Microsoft Azure для SharePoint 2013](https://technet.microsoft.com/library/dn635309.aspx) и [Развертывание SharePoint на виртуальных машинах Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=34598).

![PowerShell](./media/virtual-machines-windows-classic-ps-sql-bi/IC660119.gif) Выполните следующую команду PowerShell, чтобы получить список установленных служб, в имени которых содержится значение «SQL».

	get-service | Where-Object{ $_.DisplayName -like '*SQL*' } | Select DisplayName, status, servicetype, dependentservices | format-Table -AutoSize

## Общие рекомендации

- При использовании SQL Server Enterprise Edition минимальный размер, рекомендуемый для виртуальной машины, — **A3**. Размер виртуальной машины **A4** рекомендуется использовать для развертывания бизнес-аналитики SQL Server в службах Analysis Services и Reporting Services.

	Сведения о текущих размерах виртуальных машин см. в разделе [Размеры виртуальных машин в Azure](virtual-machines-linux-sizes.md).

- В рамках управления дисками рекомендуется хранить данные, журналы и файлы резервных копий на дисках, отличных от **C:** и **D:**. Например, создайте диски данных **E:** и **F:**.

	- Политика кэширования диска для диска по умолчанию **C:** не является оптимальным выбором для работы с данными.

	- **D:** — это временный диск, который используется в основном для файла подкачки. Диск **D:** не является сохраняемым и не сохраняется в хранилище BLOB-объектов. Задачи управления, такие как изменение размера виртуальной машины, приводят к сбросу диска **D:**. **НЕ** рекомендуется использовать диск **D:** для файлов базы данных, включая tempdb.

	Дополнительные сведения о создании и подключении дисков см. в разделе [Подключение диска с данными к виртуальной машине](virtual-machines-windows-classic-attach-disk.md).

- Остановите или удалите службы, которые не планируете использовать. Например, если виртуальная машина используется только для служб Reporting Services, остановите или удалите службы Analysis Services и службы SQL Server Integration Services. На рисунке приведен пример служб, которые запускаются по умолчанию.

	![Службы SQL Server](./media/virtual-machines-windows-classic-ps-sql-bi/IC650107.gif)

	>[AZURE.NOTE] В поддерживаемых сценариях бизнес-аналитики требуется ядро СУБД SQL Server. В односерверной топологии ВМ ядро СУБД обязательно должно выполняться на той же ВМ.

	Дополнительные сведения см. в следующих разделах: [Удаление служб Reporting Services](https://msdn.microsoft.com/library/hh479745.aspx) и [Удаление экземпляра служб Analysis Services](https://msdn.microsoft.com/library/ms143687.aspx).

- Просмотрите раздел «Важные обновления» **Центра обновления Windows**. Образы виртуальных машин Microsoft Azure часто обновляются, однако важные обновления могут поступать из **Центра обновления Windows** уже после последнего обновления образа виртуальной машины.

## Пример топологий развертывания

Ниже приведены примеры развертываний, использующих виртуальные машины Microsoft Azure. На этих схемах приведено лишь несколько из множества возможных топологий, которые можно использовать совместно с функциями бизнес-аналитики SQL Server и виртуальными машинами Microsoft Azure.

### Одна виртуальная машина

Службы Analysis Services, Reporting Services, ядро СУБД SQL Server и источники данных на одной виртуальной машине.

![сценарий бизнес-аналитики iass с 1 виртуальной машиной](./media/virtual-machines-windows-classic-ps-sql-bi/IC650108.gif)

### Две виртуальные машины

- Службы Analysis Services, Reporting Services и ядро СУБД SQL Server на одной виртуальной машине. Данное развертывание включает в себя базы данных сервера отчетов.

- Источники данных на второй виртуальной машине. На второй виртуальной машине ядро СУБД SQL Server используется в качестве источника данных.

![сценарий бизнес-аналитики iass с 2 виртуальными машинами](./media/virtual-machines-windows-classic-ps-sql-bi/IC650109.gif)

### Смешанная среда Azure — данные в базе данных SQL Azure

- Службы Analysis Services, Reporting Services и ядро СУБД SQL Server на одной виртуальной машине. Данное развертывание включает в себя базы данных сервера отчетов.

- Источником данных является база данных SQL Azure.

![сценарии бизнес-аналитики iaas с виртуальной машиной и AzureSQL в качестве источника данных](./media/virtual-machines-windows-classic-ps-sql-bi/IC650110.gif)

### Гибридная среда — локальные данные

- В этом примере развертывания службы Analysis Services, Reporting Services и ядро СУБД SQL Server выполняются на одной виртуальной машине. На этой виртуальной машине размещаются базы данных сервера отчетов. Виртуальная машина присоединена к локальному домену через виртуальную сеть Azure или некоторое другое решение туннелирования VPN.

- Источник данных находится в локальной среде.

![сценарии бизнес-аналитики iaas с виртуальной машиной и локальными источниками данных](./media/virtual-machines-windows-classic-ps-sql-bi/IC654384.gif)

## Конфигурация собственного режима служб Reporting Services

Коллекция образов виртуальных машин для SQL Server включает в себя установленный собственный режим Reporting Services, однако сервер отчетов при этом не настроен. Действия, описанные в этом разделе, позволяют настроить сервер отчетов служб Reporting Services. Дополнительные сведения о настройке собственного режима служб Reporting Services см. в разделе [Установка сервера отчетов собственного режима служб Reporting Services (SSRS)](https://msdn.microsoft.com/library/ms143711.aspx).

>[AZURE.NOTE] Аналогичные материалы, где для настройки сервера отчетов используются сценарии Windows PowerShell, см. в разделе [Использование PowerShell для создания виртуальной машины Azure с помощью сервера отчетов, работающего в собственном режиме](virtual-machines-windows-classic-ps-sql-report.md).

### Подключение к виртуальной машине и запуск диспетчера конфигурации служб Reporting Services

Существуют две общие процедуры для подключения к виртуальной машине Azure:

- Для подключения выберите имя виртуальной машины и нажмите кнопку **Подключить**. Открывает подключение к удаленному рабочему столу, и автоматически заполняется имя компьютера.

	![подключение к виртуальной машине Azure](./media/virtual-machines-windows-classic-ps-sql-bi/IC650112.gif)

- Подключитесь к виртуальной машине с помощью подключения к удаленному рабочему столу Windows. В пользовательском интерфейсе удаленного рабочего стола выполните следующие действия.

	1. Введите **имя облачной службы** в качестве имени компьютера.

	1. Введите двоеточие (:) и номер общего порта, настроенного для конечной точки удаленного рабочего стола TCP.

		Моя\_служба.облачное\_приложение.net:63133

		Дополнительные сведения см. в разделе [Что такое облачная служба](https://azure.microsoft.com/manage/services/cloud-services/what-is-a-cloud-service/).

**Запустите диспетчер конфигурации служб Reporting Services.**

1. В **Windows Server 2012** выполните следующие действия.

1. На **начальном** экране введите **Reporting Services**, чтобы просмотреть список приложений.

1. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.

1. В **Windows Server 2008 R2** выполните следующие действия.

1. Нажмите кнопку **Пуск** и выберите **Все программы**.

1. Выберите пункт **Microsoft SQL Server 2016**.

1. Выберите **Средства настройки**.

1. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.

Или

1. Нажмите **Запуск**.

1. В диалоговом окне **Найти программы и файлы** введите **reporting services**. Если виртуальная машина запущена в Windows Server 2012, введите **reporting services** на начальном экране Windows Server 2012.

1. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.

	![поиск диспетчера конфигурации служб ssrs](./media/virtual-machines-windows-classic-ps-sql-bi/IC650113.gif)

### Настройка служб Reporting Services

**Учетная запись службы и URL-адрес веб-службы:**

1. Убедитесь, что в поле **Имя сервера** указано имя локального сервера, и нажмите кнопку **Подключение**.

1. Обратите внимание, что поле **Имя базы данных сервера отчетов** пусто. База данных создается после завершения настройки.

1. Убедитесь, что для параметра **Состояние сервера отчетов** указано значение **Запущен**. Если вы хотите проверить службу в Windows Server Manager, она является службой Windows **SQL Server Reporting Services**.

1. Щелкните **Учетная запись службы** и при необходимости измените учетную запись. Если виртуальная машина используется в среде без присоединения к домену, встроенной учетной записи **ReportServer** достаточно. Дополнительные сведения об учетной записи службы см. в статье [Учетная запись службы](https://msdn.microsoft.com/library/ms189964.aspx).

1. Щелкните **URL-адрес веб-службы** на левой панели.

1. Нажмите кнопку **Применить**, чтобы настроить значения по умолчанию.

1. Запишите значение **URL-адреса веб-службы сервера отчетов**. Обратите внимание, что TCP-порт по умолчанию имеет значение 80 и является частью URL-адреса. Позднее вы создадите для этого порта конечную точку виртуальной машины Microsoft Azure.

1. В области **Результаты** убедитесь, что действия успешно выполнены.

**База данных:**

1. Щелкните элемент **База данных** на левой панели.

1. Щелкните элемент **Изменение базы данных**.

1. Убедитесь, что выбран параметр **Создать новую базу данных сервера отчетов**, и нажмите кнопку «Далее».

1. Проверьте значение **Имя сервера** и щелкните **Проверка соединения**.

1. Если получен результат **Проверка соединения завершена успешно**, нажмите кнопку **ОК** и кнопку **Далее**.

1. Убедитесь, что в качестве имени базы данных используется **ReportServer**, а для параметра **Режим сервера отчетов** указано значение **Собственный**, а затем нажмите кнопку **Далее**.

1. На странице **Учетные данные** нажмите кнопку **Далее**.

1. На странице **Сводка** нажмите кнопку **Далее**.

1. На странице **Ход выполнения и завершение** нажмите кнопку **Далее**.

**URL-адрес веб-портала или URL-адрес диспетчера отчетов для выпусков 2012 и 2014:**

1. Щелкните **Web Portal URL** (URL-адрес веб-портала) или **URL-адрес диспетчера отчетов** для выпусков 2012 и 2014 в левой области.

1. Нажмите кнопку **Применить**.

1. В области **Результаты** убедитесь, что действия успешно выполнены.

1. Щелкните **Выход**.

Сведения о разрешениях сервера отчетов см. в разделе [Предоставление разрешений на сервер отчетов в собственном режиме](https://msdn.microsoft.com/library/ms156014.aspx).

### Переход в локальный диспетчер отчетов

Чтобы проверить конфигурацию, перейдите в диспетчер отчетов на виртуальной машине.

1. На виртуальной машине запустите Internet Explorer с правами администратора.

1. Перейдите в каталог http://localhost/reports на виртуальной машине.

### Подключение к удаленному веб-порталу или диспетчеру отчетов для выпусков 2012 и 2014

Если требуется подключиться к веб-порталу или диспетчеру отчетов для выпусков 2012 и 2014 на виртуальной машине с удаленного компьютера, создайте новую конечную точку TCP виртуальной машины. По умолчанию сервер отчетов прослушивает HTTP-запросы через **порт 80**. В случае настройки URL-адресов сервера отчетов на использование другого порта необходимо указать этот номер порта в следующих инструкциях.

1. Создайте конечную точку для виртуальной машины через TCP-порт 80. Дополнительные сведения см. в подразделе [Конечные точки виртуальной машины и порты брандмауэра](#virtual-machine-endpoints-and-firewall-ports) этого документа.

1. Откройте порт 80 в брандмауэре виртуальной машины.

1. Перейдите к веб-порталу или диспетчеру отчетов, используя **DNS-имя** виртуальной машины Azure в качестве имени сервера в URL-адресе. Например:

	**Сервер отчетов**: http://uebi.cloudapp.net/reportserver, **веб-портал**: http://uebi.cloudapp.net/reports.

	[Настройка брандмауэра для доступа к серверу отчетов](https://msdn.microsoft.com/library/bb934283.aspx)

### Создание и публикация отчетов на виртуальной машине Azure

В следующей таблице перечислены некоторые параметры, доступные для публикации существующих отчетов с локального компьютера на сервер отчетов, размещенный на виртуальной машине Microsoft Azure.

- **Построитель отчетов**. Виртуальная машина включает в себя ClickOnce-версию построителя отчетов Microsoft SQL Server для выпусков 2012 и 2014. Для первого запуска построителя отчетов на виртуальной машине с SQL 2016 сделайте следующее:

	1. Запустите браузер с правами администратора.

	1. Перейдите на веб-портал на виртуальной машине и выберите значок **Скачать** в правом верхнем углу.
	
	1. Выберите **Построитель отчетов**.

	Дополнительные сведения см. в разделе [Start Report Builder](https://msdn.microsoft.com/library/ms159221.aspx) (Запуск построителя отчетов).

- **SQL Server Data Tools**: виртуальная машина. Компонент SQL Server Data Tools устанавливается на виртуальной машине и может использоваться для создания **проектов сервера отчетов** и отчетов на виртуальной машине. SQL Server Data Tools может публиковать отчеты на сервере отчетов на виртуальной машине.

- **SQL Server Data Tools: удаленно**. Создайте на локальном компьютере проект служб Reporting Services в SQL Server Data Tools, содержащий отчеты служб Reporting Services. Настройте проект для подключения к URL-адресу веб-службы.

	![свойства проекта SSDT для проекта SSRS](./media/virtual-machines-windows-classic-ps-sql-bi/IC650114.gif)

- Создайте жесткий диск VHD, содержащий отчеты, а затем отправьте и подключите этот диск.

	1. Создайте на локальном компьютере жесткий диск VHD, содержащий ваши отчеты.

	1. Создайте и установите сертификат управления.

	1. Отправьте VHD-файл в Azure с помощью командлета Add-AzureVHD, руководствуясь указаниями из статьи [Создание и передача виртуального жесткого диска Windows Server в Azure](virtual-machines-windows-classic-createupload-vhd.md).

	1. Подключите диск к виртуальной машине.

## Установка других служб и компонентов SQL Server

Чтобы установить дополнительные службы SQL Server, такие как службы Analysis Services в табличном режиме, запустите мастер установки SQL Server. Файлы установки находятся на локальном диске виртуальной машины.

1. Нажмите кнопку **Пуск** и выберите **Все программы**.

1. Щелкните **Microsoft SQL Server 2016**, **Microsoft SQL Server 2014** или **Microsoft SQL Server 2012**, а затем выберите **Средства настройки**.

1. Щелкните **Центр установки SQL Server**.

Либо запустите файл C:\\SQLServer\_13.0\_full\\setup.exe, C:\\SQLServer\_12.0\_full\\setup.exe или C:\\SQLServer\_11.0\_full\\setup.exe.

>[AZURE.NOTE] При первом запуске программы установки SQL Server может потребоваться скачивание большего числа файлов установки, а также перезагрузка виртуальной машины и перезапуск программы установки SQL Server.
>
>Если необходимо многократно настраивать образ, выбранный из виртуальной машины Microsoft Azure, рекомендуется создать собственный образ SQL Server. Функциональные возможности SysPrep служб Analysis Services были включены в SQL Server 2012 SP1 CU2. Дополнительные сведения см. в статье [Вопросы по установке SQL Server с помощью SysPrep](https://msdn.microsoft.com/library/ee210754.aspx).

### Установка табличного режима служб Analysis Services

Действия, приведенные в этом разделе, **кратко описывают** установку табличного режима служб Analysis Services. Дополнительную информацию см. в следующих разделах.

- [Установка служб Analysis Services в табличном режиме](https://msdn.microsoft.com/library/hh231722.aspx)

- [Табличное моделирование (руководство по Adventure Works)](https://msdn.microsoft.com/library/140d0b43-9455-4907-9827-16564a904268)

**Порядок установки табличного режима служб Analysis Services:**

1. В левой области мастера установки SQL Server щелкните элемент **Установка**, а затем — элемент **Новая установка изолированного экземпляра SQL Server или добавление компонентов к существующей установке**.

	- Если вы видите элемент **Выбор папки**, перейдите к папке c:\\SQLServer\_13.0\_full, c:\\SQLServer\_12.0\_full или c:\\SQLServer\_11.0\_full и нажмите кнопку **ОК**.

1. Нажмите кнопку **Далее** на странице обновлений продуктов.

1. На странице **Тип установки** выберите **Выполнить новую установку SQL Server** и нажмите кнопку **Далее**.

1. На странице **Роль установки** щелкните **Установка компонентов SQL Server**.

1. На странице **Выбор компонентов** щелкните **Службы Analysis Services**.

1. На странице **Конфигурации экземпляра** введите описательное имя, например **Табличный режим**, в текстовых полях **Именованный экземпляр** и **Идентификатор экземпляра**.

1. На странице **Настройка служб Analysis Services** выберите **Табличный режим**. Добавьте текущего пользователя в список разрешений администратора.

1. Завершите процедуру и закройте мастер установки SQL Server.

## Настройка служб Analysis Services

### Удаленный доступ к серверу служб Analysis Services

Сервер служб Analysis Services поддерживает только проверку подлинности Windows. Для удаленного доступа к службам Analysis Services из клиентских приложений, таких как SQL Server Management Studio или SQL Server Data Tools, виртуальная машина должна быть присоединена к локальному домену с помощью виртуальной сети Azure. Дополнительные сведения см. в разделе [Виртуальная сеть Azure](../virtual-network/virtual-networks-overview.md).

**Экземпляр по умолчанию** служб Analysis Services прослушивает TCP-порт **2383**. Откройте этот порт в брандмауэре виртуальных машин. Порт **2383** прослушивается также кластеризованным именованным экземпляром служб Analysis Services.

Для **именованного экземпляра** служб Analysis Services для управления доступом к портам требуется служба обозревателя SQL Server. В качестве настройки по умолчанию для обозревателя SQL Server используется порт **2382**.

В брандмауэре виртуальных машин откройте порт **2382** и создайте статический порт именованного экземпляра служб Analysis Services.

1. Чтобы просмотреть порты, которые уже используются на виртуальной машине, и узнать, какой именно процесс использует эти порты, выполните следующую команду с правами администратора:

		netstat /ao

1. Используйте SQL Server Management Studio для создания статического порта именованного экземпляра служб Analysis Services, обновив значение "Порт" в общих свойствах служб Analysis Services в табличном режиме. Дополнительные сведения см. в разделе «Использование фиксированного порта для экземпляра по умолчанию или именованного экземпляра» статьи [Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services](https://msdn.microsoft.com/library/ms174937.aspx#bkmk_fixed).

1. Перезагрузите табличный экземпляр служб Analysis Services.

Дополнительные сведения см. в разделе **Конечные точки виртуальной машины и порты брандмауэра** этого документа.

## Конечные точки виртуальной машины и порты брандмауэра

В этом разделе перечислены конечные точки виртуальной машины Microsoft Azure, которые нужно создать, и порты, которые нужно открыть в брандмауэрах виртуальных машин. В следующей таблице перечислены **TCP**-порты, для которых нужно создать конечные точки, и порты, которые нужно открыть в брандмауэре виртуальных машин.

- Если вы используете одну виртуальную машины и выполняются два следующих условия, вам не нужно создавать конечные точки виртуальной машины и открывать порты в брандмауэре на этой виртуальной машине.

	- Вы не осуществляете удаленное подключение к компонентам SQL Server на виртуальной машине. Установка подключения удаленного рабочего стола к виртуальной машине и доступ к компонентам SQL Server локально в виртуальной машине не считаются удаленным подключением к компонентам SQL Server.

	- Вы не присоединяете виртуальную машину к локальному домену через виртуальную сеть Azure или некоторое другое решение туннелирования VPN.

- Если виртуальная машина не присоединена к домену, но требуется установить удаленное подключение к компонентам SQL Server на виртуальной машине, выполните следующие действия.

	- Откройте порты в брандмауэре на виртуальной машине.

	- Создайте конечные точки виртуальной машины для указанных портов (*).

- Если виртуальная машина присоединена к домену с помощью VPN-туннеля, такого как виртуальная сеть Azure, конечные точки не требуются. Однако следует открыть порты в брандмауэре на виртуальной машине.

	|Порт|Тип|Описание|
|---|---|---|
|**80**|TCP|Удаленный доступ к серверу отчетов (*).| |**1433**|TCP|SQL Server Management Studio (*).| |**1434**|UDP|Обозреватель SQL Server. Это необходимо, если виртуальная машина присоединена к домену.|
|**2382**|TCP|Обозреватель SQL Server.|
|**2383**|TCP|Экземпляр SQL Server Analysis Services по умолчанию и кластеризованные именованные экземпляры.|
|**Определяется пользователем**|TCP|Создайте статический порт именованного экземпляра служб Analysis Services для выбранного номера порта, а затем разблокируйте этот порт в брандмауэре.|

Дополнительную информацию о создании конечных точек см. в следующих разделах.

- Создание конечных точек: [Настройка конечных точек виртуальной машины](virtual-machines-windows-classic-setup-endpoints.md).

- SQL Server: см. раздел «Выполнение шагов по подключению к виртуальной машине с помощью SQL Server Management Studio» статьи [Подготовка виртуальной машины SQL Server в Azure](virtual-machines-windows-portal-sql-server-provision.md).

На следующей схеме показаны порты, которые необходимо открыть в брандмауэре виртуальной машины, чтобы разрешить удаленный доступ к функциям и компонентам на виртуальной машине.

![порты, которые необходимо открыть для приложений бизнес-аналитики в виртуальных машинах Azure](./media/virtual-machines-windows-classic-ps-sql-bi/IC654385.gif)

## Ресурсы

- Просмотрите политику поддержки серверного программного обеспечения Майкрософт, применяемую в среде виртуальных машин Azure. Ниже приведены сведения о поддержке таких компонентов, как BitLocker, отказоустойчивая кластеризация и балансировка сетевой нагрузки. [Поддержка серверного программного обеспечения Майкрософт для виртуальных машин Azure](http://support.microsoft.com/kb/2721672).

- [Обзор. SQL Server на виртуальных машинах Azure](virtual-machines-windows-sql-server-iaas-overview.md)

- [Виртуальные машины](https://azure.microsoft.com/documentation/services/virtual-machines/)

- [Подготовка виртуальной машины SQL Server в Azure](virtual-machines-windows-portal-sql-server-provision.md)

- [Подключение диска с данными к виртуальной машине](virtual-machines-windows-classic-attach-disk.md)

- [Миграция базы данных в SQL Server на виртуальной машине Azure](virtual-machines-windows-migrate-sql.md)

- [Определение режима работы сервера экземпляра служб Analysis Services](https://msdn.microsoft.com/library/gg471594.aspx)

- [Многомерное моделирование (руководство по Adventure Works)](https://technet.microsoft.com/library/ms170208.aspx)

- [Центр документации Azure](https://azure.microsoft.com/documentation/)

- [Использование Power BI в гибридной среде](https://msdn.microsoft.com/library/dn798994.aspx)

>[AZURE.NOTE] [Submit feedback and contact information through Microsoft SQL Server Connect](https://connect.microsoft.com/SQLServer/Feedback)

### Материалы сообщества

- [Управление базой данных SQL Azure с помощью PowerShell](http://blogs.msdn.com/b/windowsazure/archive/2013/02/07/windows-azure-sql-database-management-with-powershell.aspx)

<!---HONumber=AcomDC_0518_2016-->