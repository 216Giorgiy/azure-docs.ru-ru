<properties
	pageTitle="Устранение неполадок доступа к приложению на виртуальной машине | Microsoft Azure"
	description="Если не удается получить доступ к приложению, выполняющемуся в виртуальной машине Azure, выполните следующие действия, чтобы выявить источник проблемы."
	services="virtual-machines"
	documentationCenter=""
	authors="dsk-2015"
	manager="timlt"
	editor=""
	tags="top-support-issue,azure-service-management,azure-resource-manager"/>

<tags
	ms.service="virtual-machines"
	ms.workload="infrastructure-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="10/05/2015"
	ms.author="dkshir"/>

# Устранение неполадок доступа к приложению, выполняющемуся в виртуальной машине Azure

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-include.md)]В этой статье описывается устранение неполадок доступа к приложению на виртуальной машине, созданной с помощью классической модели развертывания или модели развертывания на основе диспетчера ресурсов.

В этой статье можно узнать о методах выявления причин возникновения и исправления проблемы, из-за которой не удается получить доступ к приложению, выполняющемуся в виртуальной машине Azure.

> [AZURE.NOTE]Чтобы получить справку по подключению к виртуальной машине Azure, см. раздел [Устранение неполадок подключений к удаленному рабочему столу виртуальной машины Azure на основе Windows](virtual-machines-troubleshoot-remote-desktop-connections.md) или [Устранение неполадок SSH-подключений к виртуальной машине Azure на основе Linux](virtual-machines-troubleshoot-ssh-connections.md).

Существуют четыре основных области для устранения неполадок доступа к приложению, которое выполняется в виртуальной машине Azure.

![](./media/virtual-machines-troubleshoot-access-application/tshoot_app_access1.png)

1.	Приложение, которое выполняется в виртуальной машине Azure.
2.	Виртуальная машина Azure
3.	Конечные точки Azure для облачной службы, содержащей виртуальную машину (для виртуальных машин, созданных с помощью API управления службами), правила преобразования сетевых адресов (NAT) для входящих подключений (для виртуальных машин, созданных в диспетчере ресурсов) и группы безопасности сети.
4.	Пограничное устройство Интернета.

Для клиентских компьютеров, которые получают доступ к приложению через подключение VPN типа «сеть-сеть» или ExpressRoute, проблемы в первую очередь могут возникать из-за приложения и виртуальной машины Azure. Чтобы определить источник проблемы и исправить ее, выполните приведенные ниже действия.

## Шаг 1. У вас есть доступ к приложению из целевой виртуальной машины?

Попробуйте получить доступ к приложению из соответствующей клиентской программы в виртуальной машине, в которой выполняется приложение. Используйте имя локального узла, локальный IP-адрес или петлевой адрес (127.0.0.1).

![](./media/virtual-machines-troubleshoot-access-application/tshoot_app_access2.png)

Например, если приложение является веб-сервером, запустите браузер в виртуальной машине и попытайтесь получить доступ к веб-странице, размещенной в виртуальной машине.

Если доступ к приложению есть, перейдите к [шагу 2](#step2).

Если доступ к приложению получить не удается, проверьте, удовлетворены ли следующие требования.

- Приложение выполняется в целевой виртуальной машине.
- Приложение прослушивает ожидаемые порты TCP и UDP.

В виртуальных машин на основе Windows и Linux используйте команду **netstat -a**, чтобы отобразить активные порты прослушивания. Изучите выходные данные для ожидаемых портов, которые должно прослушивать приложение. При необходимости перезапустите приложение или настройте его для использования ожидаемых портов.

## <a id="step2"></a>Шаг 2. Можете ли вы получить доступ к приложению из другой виртуальной машины в той же виртуальной сети?

Попытайтесь получить доступ к приложению из другой виртуальной машины в той же виртуальной сети, что и виртуальная машина, в которой выполняется приложение, используя имя узла виртуальной машины или назначенный ей Azure публичный или частный IP-адрес либо IP-адрес поставщика. Для виртуальных машин, созданных с помощью API управления службами, не используйте публичный IP-адрес облачной службы.

![](./media/virtual-machines-troubleshoot-access-application/tshoot_app_access3.png)

Например, если приложение является веб-сервером, попробуйте получить доступ к веб-странице из браузера в другой виртуальной машине из той же виртуальной сети.

Если у вас есть доступ к приложению, перейдите к [шагу 3](#step3).

Если доступ к приложению получить не удается, проверьте, удовлетворены ли следующие требования.

- Брандмауэр узла в целевой виртуальной машине позволяет проходить пакетам входящих запросов и исходящих ответов.
- Программы для обнаружения вторжений или для мониторинга сети, работающие в целевой виртуальной машине, разрешают прохождение сетевого трафика.
- Группы безопасности сети разрешают прохождение трафика.
- Отдельный компонент, выполняющийся в виртуальной сети на пути между тестовой виртуальной машиной и виртуальной машиной, такой как, например, балансировщик нагрузки или брандмауэр, разрешает прохождение трафика.

На виртуальной машине под управлением Windows используйте брандмауэр Windows в режиме повышенной безопасности для определения того, исключают ли правила брандмауэра входящий и исходящий трафик вашего приложения.

## <a id="step3"></a>Шаг 3. Можете ли вы получить доступ к приложению с компьютера, который находится за пределами виртуальной сети, но не подключен к сети, в которой находится ваш компьютер?

Попытайтесь получить доступ к приложению с компьютера за пределами виртуальной сети, где находится виртуальная машина, в которой выполняется приложение, но не из сети исходного клиентского компьютера.

![](./media/virtual-machines-troubleshoot-access-application/tshoot_app_access4.png)

Например, если приложение является веб-сервером, попробуйте получить доступ к веб-странице из браузера на компьютере, который находится не в виртуальной сети.

Если доступ к приложению получить не удается, проверьте, удовлетворены ли следующие требования.

- Для виртуальных машин, созданных с помощью API управления службами, конфигурация конечной точки для виртуальной машины разрешает входящий трафик, в частности для протокола (TCP или UDP), а также публичных и частных номеров портов. Дополнительные сведения см. в разделе [Настройка конечных точек виртуальной машины](virtual-machines-set-up-endpoints.md).
- Для виртуальных машин, созданных с помощью API управления службами, списки управления доступом (ACL) для конечной точки не блокируют входящий трафик из Интернета. Дополнительные сведения см. в разделе [Настройка конечных точек виртуальной машины](virtual-machines-set-up-endpoints.md).
- Для виртуальных машин, созданных в диспетчере ресурсов, конфигурация правила преобразования сетевых адресов для входящих подключений для виртуальной машины разрешает входящий трафик, в частности для протокола (TCP или UDP) и номеров общедоступных и частных портов.
- Группы безопасности сети разрешают трафик входящих запросов и исходящих ответов. Дополнительные сведения см. в разделе [Что такое группа безопасности сети?](virtual-networks-nsg.md).

Если виртуальная машина или конечная точка входит в комплект балансировки нагрузки, сделайте следующее.

- Проверьте правильность протокола зонда (TCP или UDP) и номера порта.
- Если протокол зонда и порт отличаются от протокола и порта для комплекта балансировки нагрузки, сделайте следующее.
	- Убедитесь, что приложение прослушивает протокол пробы (TCP или UDP) и номер порта (используйте **netstat -a** на целевой виртуальной машине).
	- Брандмауэр узла в целевой виртуальной машине разрешает трафик входящих запросов и исходящих ответов зонда.

Если у вас есть доступ к приложению, убедитесь, что пограничное устройство Интернета разрешает следующее:

- трафик исходящих запросов приложения с клиентского компьютера в виртуальную машину Azure;
- трафик входящих ответов приложения из виртуальной машины Azure.

## Дальнейшие действия

Если после выполнения шагов с 1 по 3, описанных в этой статье, необходима дополнительная помощь для решения этой проблемы, воспользуйтесь одним из следующих вариантов.

- Получите помощь специалистов по Azure со всего мира. Сообщите о своей проблеме на форуме MSDN Azure или форуме Stack Overflow. Дополнительные сведения см. в статье [Форумы Microsoft Azure](http://azure.microsoft.com/support/forums/).
- Отправьте запрос в службу поддержки Azure Перейдите на [сайт службы поддержки Azure](http://azure.microsoft.com/support/options/) и щелкните **Поддержка** в разделе **Техническая поддержка и поддержка по вопросам оплаты**.

## Дополнительные ресурсы

[Устранение неполадок с подключением к удаленному рабочему столу виртуальной машины Windows в службе Azure](virtual-machines-troubleshoot-remote-desktop-connections.md)

[Устранение неполадок с подключением Secure Shell (SSH) к виртуальной машине Azure под управлением Linux](virtual-machines-troubleshoot-ssh-connections.md)

<!---HONumber=Oct15_HO2-->