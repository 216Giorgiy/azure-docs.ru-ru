<properties
 pageTitle="Обзор агента и расширений виртуальной машины | Microsoft Azure"
 description="Статья описывает агент, расширения и способы установки агента."
 services="virtual-machines"
 documentationCenter=""
 authors="squillace"
 manager="timlt"
 editor=""/>
<tags
ms.service="virtual-machines"
 ms.devlang="na"
 ms.topic="article"
 ms.tgt_pltfrm="vm-multiple"
 ms.workload="infrastructure-services"
 ms.date="09/22/2015"
 ms.author="rasquill"/>
 
#Обзор агента и расширений виртуальной машины
Агент виртуальной машины Azure (агент ВМ) используется для установки, настройки, управления и запуска расширений виртуальной машины Azure (расширений ВМ). Расширения ВМ предоставляют динамические функции, предлагаемые Майкрософт и сторонними производителями. Агент и расширения обычно добавляются на портале управления, но для их добавления и настройки можно использовать также командлеты [Powershell](../install-configure-powershell.md) или [интерфейс командной строки Azure](xplat-install.md). Агент и расширения добавляются в новую виртуальную машину во время создания или в существующую.

> [AZURE.NOTE]В этом разделе описаны PowerShell и интерфейс командной строки Azure. Но здесь упоминаются вызовы при использовании классической модели развертывания, а не модели развертывания с помощью диспетчера ресурсов. Дополнительную информацию о моделях развертывания можно найти в статье [Поставщики вычислительных и сетевых ресурсов, а также ресурсов хранения Azure в диспетчере ресурсов Azure](virtual-machines-azurerm-versus-azuresm.md).


Расширения ВМ можно использовать в следующих целях.

-   Изменение функций безопасности и идентификации, в том числе сброс значений учетных записей и использование защиты от вредоносных программ.
-   Запуск, остановка и настройка функций мониторинга и диагностики.
-   Сброс или установка функций подключения, например RDP и SSH.
-   Диагностика и мониторинг виртуальных машин, а также управление ими.

Существует и множество других функций расширения виртуальной машины, ассортимент которых регулярно пополняется. В этой статье описываются агенты виртуальной машины Azure для Windows и Linux, а также их поддержка работы расширений виртуальных машин. Список расширений VM, в котором указаны категории компонентов, приводится в статье [Расширения и компоненты виртуальной машины Azure](virtual-machines-extensions-features.md).

##Агенты виртуальной машины Azure для Windows и Linux

Агент виртуальной машины Azure (агент ВМ) — это защищенный и нетребовательный к ресурсам процесс, который устанавливает, настраивает и удаляет расширения ВМ на экземплярах виртуальных машин Azure из коллекции образов и на пользовательских экземплярах виртуальных машин при наличии установленного агента ВМ. Агент ВМ выполняет роль локальной службы безопасности виртуальной машины Azure. Расширения, которые загружает агент, отвечают за определенные функции для повышения производительности во время работы экземпляра.

Существует два агента ВМ Azure: для виртуальных машин Windows и для виртуальных машин Linux. По умолчанию агент ВМ устанавливается автоматически при создании виртуальной машины из коллекции образов, но вы можете установить его и после создания экземпляра. Кроме того, вы можете установить агент ВМ в настраиваемом образе ВМ и самостоятельно передать этот образ на сервер.

>[AZURE.IMPORTANT]Агенты виртуальной машины представляют собой очень простые службы, обеспечивающие защищенное администрирование экземпляров виртуальных машин. Возможны ситуации, в которых вы захотите отключить агент виртуальной машины. В этом случае вам следует создать виртуальную машину, в которой не установлен агент ВМ. Агент ВМ можно удалить физически, но при этом реакция на события расширений ВМ на этом экземпляре будет неопределенной. Поэтому в настоящее время удаление агента ВМ после его установки не поддерживается.

Агент ВМ включается в следующих ситуациях.

-   Когда вы создаете экземпляр виртуальной машины на портале управления с помощью метода **Быстрое создание** или метода **Настраиваемое создание**, установив флажок **Установить агент ВМ** (как показано на рисунке ниже). Дополнительные сведения можно найти в статье [Создание настраиваемой виртуальной машины](virtual-machines-create-custom.md).

    ![Флажок агента ВМ](./media/virtual-machines-extensions-agent-about/IC719409.png "Флажок агента ВМ")

-   Когда вы создаете экземпляр виртуальной машины с помощью командлета [New-AzureVM](https://msdn.microsoft.com/library/azure/dn495254.aspx) или [New-AzureQuickVM](https://msdn.microsoft.com/library/azure/dn495183.aspx). Вы можете создать виртуальную машину и без установленного агента виртуальной машины. Для этого добавьте в командлет [Add-AzureProvisioningConfig](https://msdn.microsoft.com/library/azure/dn495299.aspx) параметр **– DisableGuestAgent**.

-   Если вы вручную скачаете и установите агента виртуальной машины (версию для Windows или Linux) на существующем экземпляре виртуальной машины, а затем установите значение **true** для параметра **ProvisionGuestAgent**с помощью Powershell или вызова REST. (Если вы не установите это значение после установки агента ВМ вручную, добавление агента ВМ не будет обнаружено). В следующем примере кода показано, как вы можете это сделать с помощью PowerShell, когда аргументы `$svc` и `$name` уже определены.

        $vm = Get-AzureVM –serviceName $svc –Name $name
        $vm.VM.ProvisionGuestAgent = $TRUE
        Update-AzureVM –Name $name –VM $vm.VM –ServiceName $svc

-   Когда вы создаете образ виртуальной машины, в котором до передачи в Azure был установлен агент ВМ. Для виртуальной машины Windows вы можете установить агент, скачав [MSI-файл агента виртуальной машины Windows](http://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409). Для виртуальной машины Linux установка выполняется из репозитория github, находящегося на веб-странице <https://github.com/Azure/WALinuxAgent>. Дополнительные сведения об установке агента виртуальной машины в Linux можно найти в статье [Руководство пользователя по агенту виртуальной машины Azure](virtual-machines-linux-agent-user-guide.md).

>[AZURE.NOTE]В PaaS агент виртуальной машины называется **GuestAgent** и всегда доступен в виртуальных машинах с веб-ролью и рабочей ролью. (Дополнительную информацию можно найти в статье [Архитектура ролей Azure](http://blogs.msdn.com/b/kwill/archive/2011/05/05/windows-azure-role-architecture.aspx).) Теперь агент ВМ для виртуальных машин с ролями может добавлять расширения в ВМ облачных служб таким же образом, как и в постоянные ВМ. Основное различие между расширениями ВМ на виртуальных машинах с ролями и на постоянных виртуальных машинах заключается в том, что на ВМ с ролями расширения добавляются сначала в облачную службу, а затем в развертывания в этой службе.

>Используйте командлет [Get AzureServiceAvailableExtension](https://msdn.microsoft.com/library/azure/dn722498.aspx), чтобы получить список всех доступных расширений для виртуальных машин с ролями.

##Поиск, добавление, обновление и удаление расширений виртуальной машины  

Дополнительные сведения об этих задачах можно найти в статье [Добавление, поиск, обновление и удаление расширений виртуальной машины Azure](virtual-machines-extensions-install.md).

<!---HONumber=Sept15_HO4-->