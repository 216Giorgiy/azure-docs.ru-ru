<properties
	pageTitle="Tomcat на виртуальной машине | Microsoft Azure"
	description="В этом учебнике используются ресурсы, созданные с помощью классической развертывания модели, а также приведены инструкции по созданию виртуальной машины Windows и ее настройке для работы сервера приложений Apache Tomcat."
	services="virtual-machines"
	documentationCenter="java"
	authors="rmcmurray"
	manager="wpickett"
	editor="jimbe"
    tags="azure-service-management" />

<tags
	ms.service="virtual-machines"
	ms.workload="web"
	ms.tgt_pltfrm="vm-windows"
	ms.devlang="Java"
	ms.topic="article"
	ms.date="09/22/2015"
	ms.author="robmcm"/>

# Использование сервера приложений Java на виртуальной машине, созданной с помощью классической модели развертывания.

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-classic-include.md)]Модель диспетчера ресурсов.


В Azure можно использовать виртуальную машину для обеспечения возможностей сервера. Например, виртуальную машину, работающую в Azure, можно настроить для размещения сервера приложений Java, такого как Apache Tomcat. Изучив данное руководство, вы получите представление о том, как создавать виртуальные машины в Azure и настраивать их для работы сервера приложений Java.

Вы узнаете:

* Как создать виртуальную машину с установленным комплектом разработчика Java (JDK).
* Как удаленно войти в виртуальную машину.
* Как установить сервер приложений Java на виртуальной машине.
* Как создать конечную точку для виртуальной машины.
* Как открыть порт в брандмауэре для сервера приложений.

Для целей данного учебника на виртуальной машине будет установлен сервер приложений Apache Tomcat. В результате будет установлен сервер Tomcat в следующей конфигурации.

![Виртуальная машина с Apache Tomcat][virtual_machine_tomcat]

[AZURE.INCLUDE [create-account-and-vms-note](../../includes/create-account-and-vms-note.md)]

## Для создания виртуальной машины

1. Войдите на [портал Azure](https://manage.windowsazure.com).
2. Нажмите **Создать**, **Среда выполнения приложений**, **Виртуальная машина**, а затем **Из галереи**.
3. В диалоговом окне **Выбор образа виртуальной машины** выберите пункт **JDK 7 Windows Server 2012**. Обратите внимание, что вариант **JDK 6 Windows Server 2012** доступен только в случае использования устаревших приложений, которые невозможно выполнять в JDK 7.
4. Нажмите кнопку **Далее**.
5. В диалоговом окне **Конфигурация виртуальной машины** выполните указанные ниже действия.
    1. Укажите имя виртуальной машины.
    2. Укажите размер виртуальной машины.
    3. Введите имя администратора в поле **Имя пользователя**. Запомните это имя, а также пароль, который вы введете далее. Они понадобятся для удаленного входа в виртуальную машину.
    4. Введите пароль в поле **Новый пароль** и повторно введите его в поле **Подтверждение**. Это пароль учетной записи администратора.
    5. Нажмите кнопку **Далее**.
6. В следующем диалоговом окне **Конфигурация виртуальной машины** выполните указанные ниже действия.
    1. Для **Облачных служб** используйте значение по умолчанию **Создать новую облачную службу**.
    2. Значение поля **DNS-имя облачной службы** должно быть уникальным для cloudapp.net. При необходимости измените это значение, чтобы система Azure показывала его уникальность.
    2. Укажите регион, территориальную группу или виртуальную сеть. Для целей данного учебника укажите регион, например **Западная часть США**.
    2. В поле **Учетная запись хранения** выберите **Использовать автоматически созданную учетную запись хранения**.
    3. В разделе **Группа доступности** выберите **(Нет)**.
    4. Нажмите кнопку **Далее**.
7. В последнем диалоговом окне **Конфигурация виртуальной машины** выполните указанные ниже действия.
    1. Примите стандартные параметры для конечной точки.
    2. Нажмите **Завершено**.

## Удаленный вход в виртуальную машину

1. Войдите на [портал управления](https://manage.windowsazure.com).
2. Нажмите **Виртуальные машины**.
3. Щелкните имя виртуальной машины, в которую необходимо войти.
4. После запуска виртуальной машины в нижней части страницы откроется всплывающее меню для подключений.
5. Щелкните **Подключить**.
6. Отвечайте на запросы, появляющиеся при подключении к виртуальной машине. После этого необходимо выполнить сохранение или открыть файл .rdp, содержащий сведения о подключении. Возможно, потребуется скопировать значение url:port (последняя часть первой строки RDP-файла) и вставить его в приложение удаленного входа.

## Вот как можно установить сервер приложений Java на виртуальной машине

Вы можете скопировать сервер приложений Java на виртуальную машину или установить сервер приложений Java с помощью установщика.

Для целей данного учебника будет установлен сервер Tomcat.

1. После входа в систему на виртуальной машине запустите сеанс браузера для сервера [Apache Tomcat](http://tomcat.apache.org/download-70.cgi).
2. Дважды щелкните ссылку на **Установщик службы Windows 32-разрядной и 64-разрядной версии**. При использовании этого метода сервер Tomcat будет установлен в качестве службы Windows.
3. При появлении запроса выберите выполнение установщика.
4. В мастере **Установка Apache Tomcat** следуйте указаниям по установке Tomcat. Для целей данного учебника можно принять значения по умолчанию. Когда отобразится диалоговое окно **Завершение работы мастера установки Apache Tomcat**, в нем можно установить флажок **Запустить Apache Tomcat**, чтобы немедленно запустить сервер Tomcat. Для завершения процесса установки Tomcat нажмите кнопку **Готово**.

## Вот как можно запустить Tomcat
Если вы не установили флажок запуска сервера Tomcat в диалоговом окне **Завершение работы мастера установки Apache Tomcat**, запустите его. Для этого откройте окно командной строки на виртуальной машине и выполните команду **net start Tomcat7**.

Теперь при запуске браузера в виртуальной машине и при открытии <http://localhost:8080> вы должны увидеть, что Tomcat выполняется.

Чтобы можно было наблюдать за работой сервера Tomcat с внешних компьютеров, необходимо создать конечную точку и открыть порт.

## Вот как можно создать конечную точку для виртуальной машины
1. Войдите на [портал управления](https://manage.windowsazure.com).
2. Нажмите **Виртуальные машины**.
3. Щелкните имя виртуальной машины, на которой выполняется сервер приложений Java.
4. Нажмите кнопку **Конечные точки**.
5. Щелкните **Добавить**.
6. В диалоговом окне **Добавить конечную точку** установите флажок **Добавить автономную конечную точку**, а затем нажмите кнопку **Далее**.
7. В диалоговом окне **Сведения о новой конечной точке** выполните указанные ниже действия.
    1. Укажите имя конечной точки, например **HttpIn**.
    2. Укажите **TCP** для протокола.
    3. Укажите **80** для общего порта.
    4. Укажите **8080** для частного порта.
    5. Чтобы закрыть диалоговое окно, нажмите кнопку **Завершено**. Теперь конечная точка создана.

## Вот как можно открыть порт в брандмауэре для виртуальной машины
1. Войдите в виртуальную машину.
2. Нажмите **кнопку "Пуск" в Windows**.
3. Нажмите **Панель управления**.
4. Нажмите кнопку **Система и безопасность**, **Брандмауэр Windows**, а затем нажмите **Расширенные настройки**.
5. Щелкните **Правила для входящих подключений**, а затем — **Создать правило**. ![Новое правило для входящего подключения][NewIBRule]
6. Для **Тип правила** выберите значение **Порт**, а затем нажмите кнопку **Далее**. ![Порт нового правила для входящего подключения][NewRulePort]
7. На экране **Протокол и порты** выберите **TCP**, укажите порт **8080** для **Определенные локальные порты** и нажмите кнопку **Далее**. ![Новое правило для входящего подключения][NewRuleProtocol]
8. На экране **Действие** выберите **Разрешить подключение** и нажмите кнопку **Далее**. ![Действие нового правила для входящего подключения][NewRuleAction]
9. На экране **Профиль** выберите **Доменный**, **Личный** и **Общий**, а затем нажмите кнопку **Далее**. ![Профиль нового правила для входящего подключения][NewRuleProfile]
10. На экране **Имя** укажите имя для правила, например **HttpIn** (имя правила необязательно должно совпадать с именем конечной точки), а затем нажмите кнопку **Готово**. ![Имя нового правила для входящего подключения][NewRuleName]

С этого момента ваш веб-сайт Tomcat должен быть доступен для просмотра во внешнем браузере при использовании URL-адреса следующего формата: **http://*your\_DNS\_name*.cloudapp.net**, где ***your\_DNS\_name*** — это DNS-имя, указанное при создании виртуальной машины.

## Вопросы, связанные с жизненным циклом приложения
* Вы можете создать собственный архив веб-приложения (WAR) и добавить его в папку **webapps**. Например, создайте динамический веб-проект базовой страницы службы Java и экспортируйте его как файл формата WAR, скопируйте WAR-файл в папку Apache Tomcat **webapps** на виртуальной машине и запустите его в браузере.
* По умолчанию после установки службы Tomcat она настроена на ручной запуск. Для переключения на автоматический запуск используйте оснастку служб. Запустите оснастку служб. Для этого нажмите кнопку **Пуск** в Windows, а затем последовательно щелкните **Администрирование** и **Службы**. Дважды щелкните службу **Apache Tomcat** и присвойте параметру **Тип запуска** значение **Автоматически**.

    ![Настройка службы для автоматического запуска][service_automatic_startup]

    Преимущество автоматического запуска Tomcat заключается в том, что при перезагрузке виртуальной машины (например, после установки обновлений программного обеспечения, требующих перезагрузки компьютера) Tomcat будет снова запущен.

## Дальнейшие действия
Дополнительную информацию о других службах (например, о службе хранилища Azure, служебной шине, Базе данных SQL), которые можно включить в приложения Java, см. в [Центре разработки Java](http://azure.microsoft.com/develop/java/).

[virtual_machine_tomcat]: ./media/virtual-machines-java-run-tomcat-application-server/WA_VirtualMachineRunningApacheTomcat.png

[service_automatic_startup]: ./media/virtual-machines-java-run-tomcat-application-server/WA_TomcatServiceAutomaticStart.png









[NewIBRule]: ./media/virtual-machines-java-run-tomcat-application-server/NewInboundRule.png
[NewRulePort]: ./media/virtual-machines-java-run-tomcat-application-server/NewRulePort.png
[NewRuleProtocol]: ./media/virtual-machines-java-run-tomcat-application-server/NewRuleProtocol.png
[NewRuleAction]: ./media/virtual-machines-java-run-tomcat-application-server/NewRuleAction.png
[NewRuleName]: ./media/virtual-machines-java-run-tomcat-application-server/NewRuleName.png
[NewRuleProfile]: ./media/virtual-machines-java-run-tomcat-application-server/NewRuleProfile.png

<!---HONumber=Oct15_HO3-->