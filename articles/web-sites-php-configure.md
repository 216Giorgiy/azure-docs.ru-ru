<properties
	pageTitle="Настройка PHP в веб-приложениях службы приложений Azure
	description="Узнайте, как настроить установку PHP по умолчанию или добавить пользовательскую установку PHP для веб-приложений в службе приложений Azure.
	services="app-service\web"
	documentationCenter="php"
	authors="tfitzmac"
	manager="wpickett"
	editor=""/>

<tags
	ms.service="app-service-web"
	ms.workload="web"
	ms.tgt_pltfrm="na"
	ms.devlang="PHP"
	ms.topic="article"
	ms.date="03/24/2015"
	ms.author="tomfitz"/>

#Настройка PHP в веб-приложениях службы приложений Azure 

## Введение

В этом руководстве показано, как настроить встроенную среду выполнения PHP в веб-приложениях [службы приложений Azure](http://go.microsoft.com/fwlink/?LinkId=529714), предоставить настраиваемую среду выполнения PHP и включить расширения. Чтобы использовать службу приложений, подпишитесь на [бесплатную пробную версию]. Чтобы это руководство было для вас максимально эффективным, необходимо сначала создать веб-приложение PHP в службе приложений.

## Практическое руководство. Изменение встроенной конфигурации PHP
По умолчанию при создании веб-приложения службы приложений устанавливается среда PHP 5.4, которая будет сразу готова для использования. Оптимальный способ увидеть доступные версии, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию [phpinfo()].

Версии PHP 5.5 и PHP 5.6 также доступны, но не включены по умолчанию. Чтобы обновить версию PHP, выполните такие действия:

1. Перейдите к своему веб-приложению на [портале Azure](http://go.microsoft.com/fwlink/?LinkId=529715) и нажмите кнопку **Параметры**.

	![Web App Settings][settings-button]

2. В колонке **Параметры** откройте **Параметры приложения** и выберите новую версию PHP.

    ![Application Settings][application-settings]

3. Нажмите кнопку **Сохранить** в верхней части колонки **Параметры веб-приложения**.

	![Save configuration settings][save-button]

Для любой встроенной среды выполнения PHP можно изменить параметры конфигурации, не являющиеся директивами system-level-only. Для этого выполните следующие действия: (Дополнительные сведения о директивах system-level-only см. в статье [Список директив php.ini]).

1. Добавьте файл [.user.ini] в свой корневой каталог.
2. Добавьте параметры конфигурации в файл `.user.ini`, используя тот же синтаксис, что и для файла `php.ini`. Например, если вы хотите включить параметр `display_errors` и установить для параметра `upload_max_filesize` значение 10М, в файле `.user.ini` будет указан следующий текст:

		; Example Settings
		display_errors=On
		upload_max_filesize=10M

3. Разверните свое веб-приложение.
4. Перезапустите свое веб-приложение. (Перезагрузка необходима, так как частота считывания PHP файлов `.user.ini` регулируется параметром `user_ini.cache_ttl`, который является параметром уровня системы; по умолчанию значение этого параметра составляет 300 секунд (5 минут). Перезапуск веб-приложения заставляет PHP читать новые параметры в файле `.user.ini`).

В качестве альтернативы использованию файла `.user.ini` можно использовать функцию [ini_set()] в скриптах для установки параметров конфигурации, не являющихся директивами system-level.

## Практическое руководство. Включение расширений в среде выполнения PHP по умолчанию
Как отмечалось в предыдущем разделе, оптимальный способ увидеть версию PHP по умолчанию, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию [phpinfo()]. Чтобы включить дополнительные расширения, выполните следующие действия.

1. Добавьте каталог `bin` в корневой каталог.
2. Поместите файлы с расширением `.dll` в каталог `bin` (например, `php_mongo.dll`). Убедитесь, что расширения совместимы с версией PHP по умолчанию (на момент написания этого учебника в качестве версии по умолчанию используется PHP 5.4), а также совместимы с VC9 и непотокобезопасной технологией (nts).
3. Разверните свое веб-приложение.
4. Перейдите к своему веб-приложению на портале Azure и нажмите кнопку **Параметры**.

	![Web App Settings][settings-button]

5. В колонке **Параметры** откройте **Параметры приложения** и прокрутите к разделу **Параметры приложения**.
6. В разделе **Параметры приложения** создайте ключ **PHP_EXTENSIONS**. Значением для этого ключа будет путь относительно корневого веб-сайта: **bin\your-ext-file**.

	![Enable extension in app settings][php-extensions]

7. Нажмите кнопку **Сохранить** в верхней части колонки **Параметры веб-приложения**.

	![Save configuration settings][save-button]

Расширения Zend также поддерживаются с помощью ключа **PHP_ZENDEXTENSIONS**. Чтобы включить несколько расширений, включите список разделенных запятыми файлов `.dll` для значения параметра приложения.

## Практическое руководство. Использование пользовательской среды PHP
Вместо среды выполнения PHP по умолчанию веб-приложения службы приложений могут использовать среду выполнения PHP, предоставляемую для выполнения скриптов PHP. Предоставляемую среду выполнения можно настроить с помощью файла `php.ini`, также предоставляемого пользователем. Чтобы использовать настраиваемую среду выполнения PHP с веб-приложениями:

1. Получите версию PHP для Windows, совместимую с VC9 и непотокобезопасной технологией (nts). Последние версии PHP для Windows можно найти здесь: [http://windows.php.net/download/]. Более старые версии можно найти в архиве по адресу [http://windows.php.net/downloads/releases/archives/].
2. Измените файл `php.ini` для среды выполнения. Обратите внимание, что все параметры конфигурации, являющиеся директивами system-level-only, будут игнорироваться веб-приложениями. (Дополнительную информацию о директивах только на уровне системы см. в разделе [Список директив php.ini]).
3. При необходимости добавьте расширения для вашей среды выполнения PHP и включите их в файл `php.ini`.
4. Добавьте каталог `bin` в корневой каталог и поместите в него каталог, в котором содержится ваша среда выполнения PHP (например, `bin\php`).
5. Разверните свое веб-приложение.
4. Перейдите к своему веб-приложению на портале Azure и нажмите кнопку **Параметры**.

	![Web App Settings][settings-button]

7. В колонке **Параметры** откройте **Параметры приложения** и прокрутите к разделу **Сопоставление обработчиков**. Добавьте расширение *.php а поле "Расширение" и путь - к исполняемому файлу `php-cgi.exe`. Если вы поместите свою среду выполнения PHP в каталог `bin` в корне вашего приложения, путь будет выглядеть так: `D:\home\site\wwwroot\bin\php\php-cgi.exe`.

	![Specify handler in hander mappings][handler-mappings]

8. Нажмите кнопку **Сохранить** в верхней части колонки **Параметры веб-приложения**.

	![Save configuration settings][save-button]

>[AZURE.NOTE] Если вы хотите начать работу со службой приложений Azure еще до создания учетной записи Azure, перейдите на страницу [ознакомительной версии службы приложений](http://go.microsoft.com/fwlink/?LinkId=523751). Там вы сможете сразу создать свое первое веб-приложение, правда срок его службы будет ограничен. Никаких кредитных карт и обязательств.

## Изменения
* Сведения об изменении веб-сайтов на службу приложений см. в статье [Служба приложений Azure и ее влияние на существующие службы Azure](http://go.microsoft.com/fwlink/?LinkId=529714)
* Сведения о переходе со старого портала на новый см. в статье [Справочная информация о навигации по предварительной версии портала](http://go.microsoft.com/fwlink/?LinkId=529715).

[бесплатная пробная версия]: https://www.windowsazure.com/pricing/free-trial/
[phpinfo()]: http://php.net/manual/en/function.phpinfo.php
[select-php-version]: ./media/web-sites-php-configure/select-php-version.png
[Список директив php.ini]: http://www.php.net/manual/en/ini.list.php
[.user.ini]: http://www.php.net/manual/en/configuration.file.per-user.php
[ini_set()]: http://www.php.net/manual/en/function.ini-set.php
[application-settings]: ./media/web-sites-php-configure/application-settings.png
[settings-button]: ./media/web-sites-php-configure/settings-button.png
[save-button]: ./media/web-sites-php-configure/save-button.png
[php-extensions]: ./media/web-sites-php-configure/php-extensions.png
[handler-mappings]: ./media/web-sites-php-configure/handler-mappings.png
[http://windows.php.net/download/]: http://windows.php.net/download/
[http://windows.php.net/downloads/releases/archives/]: http://windows.php.net/downloads/releases/archives/

<!--HONumber=49-->