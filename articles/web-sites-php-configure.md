<properties title="How to Configure PHP in Azure Websites" pageTitle="How to Configure PHP in Azure Websites" metaKeywords="Azure, Azure Web Sites, configuration, PHP" description="Learn how to configure the default PHP installation or add a custom PHP installation in Azure Websites." services="Web Sites" documentationCenter="PHP" authors="cephalin" manager="wpickett" />

<tags ms.service="web-sites" ms.workload="web" ms.tgt_pltfrm="na" ms.devlang="PHP" ms.topic="article" ms.date="01/01/1900" ms.author="cephalin"></tags>

# Настройка PHP на веб-сайтах Windows Azure

В этом руководстве показано, как настроить встроенную среду выполнения PHP на веб-сайтах Azure, создать настраиваемую среду выполнения PHP и включить расширения на веб-сайтах Azure. Чтобы использовать веб-сайты Azure, подпишитесь на [бесплатное пробное использование][бесплатное пробное использование]. Для максимально эффективного использования данного руководства необходимо сначала создать сайт PHP в Azure (см. [Центр разработчиков PHP — учебные курсы][Центр разработчиков PHP — учебные курсы]). Общие сведения о настройке сайтов в Azure см. в разделе [Настройка веб-сайтов][Настройка веб-сайтов].

## Оглавление

-   [Что такое веб-сайт Azure?][Что такое веб-сайт Azure?]
-   [Практическое руководство. Изменение конфигурации PHP по умолчанию][Практическое руководство. Изменение конфигурации PHP по умолчанию]
-   [Практическое руководство. Включение расширений во встроенной среде выполнения PHP][Практическое руководство. Включение расширений во встроенной среде выполнения PHP]
-   [Практическое руководство. Использование пользовательской среды PHP][Практическое руководство. Использование пользовательской среды PHP]
-   [Дальнейшие действия][Дальнейшие действия]

## <a name="WhatIs"></a>Что такое веб-сайты Azure?

Веб-сайты Azure позволяют создавать высокомасштабируемые веб-сайты в Azure. Быстро и легко развертывайте сайты в облачной среде с высокой масштабируемостью, которая позволяет начать с небольшого сайта и масштабировать его по мере роста трафика. Веб-сайты Azure используют языки и приложения с открытым исходным кодом по вашему выбору, а также поддерживают развертывание с помощью Git, FTP и TFS. Можно легко интегрировать другие службы, например базу данных MySQL, SQL, кэш, CDN и хранилище.

## <a name="ChangeBuiltInPHP"></a>Практическое руководство. Изменение встроенной конфигурации PHP

По умолчанию при создании веб-сайта Windows Azure устанавливается среда PHP 5.4, которая будет сразу готова для использования. Оптимальный способ увидеть доступные версии, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию [phpinfo()][phpinfo()].

PHP 5.5 также доступна по умолчанию, но не включена. Для ее включения выполните следующие действия:

1.  На портале Windows Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

    ![Вкладка "Настройка" на панели мониторинга веб-сайта][Вкладка "Настройка" на панели мониторинга веб-сайта]

2.  Щелкните PHP 5.5.

    ![Выберите версию PHP][Выберите версию PHP]

3.  В нижней части страницы нажмите кнопку **Сохранить**.

    ![Сохранение параметров конфигурации][Сохранение параметров конфигурации]

Для любой из встроенных сред выполнения PHP можно изменить параметры конфигурации, не являющиеся директивами только на уровне системы, выполнив следующие действия. (Дополнительные сведения о директивах только на уровне системы см. в разделе [Список директив php.ini][Список директив php.ini]).

1.  Добавьте файл [.user.ini][.user.ini] в корневой каталог.
2.  Добавьте параметры конфигурации в файл `.user.ini`, используя тот же синтаксис, что и для файла `php.ini`. Например, если вы хотите включить параметр `display_errors` и установить для параметра `upload_max_filesize` значение 10М, в файле `.user.ini` будет указан следующий текст:

        ; Example Settings
        display_errors=On
        upload_max_filesize=10M

3.  Разверните приложение.
4.  Перезапустите веб-сайт. (Перезагрузка необходима, так как частота считывания PHP файлов `.user.ini` регулируется параметром `user_ini.cache_ttl`, который является параметром уровня системы; по умолчанию значение этого параметра составляет 300 секунд (5 минут). Перезапуск сайта принудительно заставляет PHP считать новые параметры в файле `.user.ini`.)

В качестве альтернативы использованию файла `.user.ini` можно использовать функцию [ini\_set()][ini\_set()] в скрипте для установки параметров конфигурации, не являющихся директивами системного уровня.

## <a name="EnableExtDefaultPHP"></a>Практическое руководство. Включение расширений в среде выполнения PHP по умолчанию

Как было отмечено в предыдущем разделе, оптимальный способ увидеть версию PHP по умолчанию, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию [phpinfo()][phpinfo()]. Чтобы включить дополнительные расширения, выполните следующие действия.

1.  Добавьте каталог `bin` в корневой каталог.
2.  Поместите файлы с расширением `.dll` в каталог `bin` (например, `php_mongo.dll`). Убедитесь, что расширения совместимы с версией PHP по умолчанию (на момент написания этого учебника в качестве версии по умолчанию используется PHP 5.4), а также совместимы с VC9 и непотокобезопасной технологией (nts).
3.  Разверните приложение.
4.  На портале Windows Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

    ![Вкладка "Настройка" на панели мониторинга веб-сайта][Вкладка "Настройка" на панели мониторинга веб-сайта]

5.  В разделе **Параметры приложения** создайте ключ **PHP\_EXTENSIONS** и значение **bin\\your-ext-file**. Чтобы включить несколько расширений, используйте разделенный запятыми список файлов `.dll`.

    ![Включение расширения в параметрах приложения][Включение расширения в параметрах приложения]

6.  В нижней части страницы нажмите кнопку **Сохранить**.

    ![Сохранение параметров конфигурации][Сохранение параметров конфигурации]

## <a name="UseCustomPHP"></a>Практическое руководство. Использование пользовательской среды PHP

Вместо среды выполнения PHP по умолчанию веб-сайты Azure могут использовать среду выполнения PHP, предоставляемую для выполнения скриптов PHP. Предоставляемую среду выполнения можно настроить с помощью файла `php.ini`, также предоставляемого пользователем. Чтобы использовать настраиваемые среды выполнения PHP для веб-сайтов Azure, выполните следующие действия.

1.  Получите версию PHP для Windows, совместимую с VC9 и непотокобезопасной технологией (nts). Последние версии PHP для Windows можно найти здесь: [][]<http://windows.php.net/download/></a>. Более старые версии можно найти в архиве по адресу [][1]<http://windows.php.net/downloads/releases/archives/></a>.
2.  Измените файл `php.ini` для среды выполнения. Обратите внимание, что все параметры конфигурации, являющиеся директивами только системного уровня, будут игнорироваться веб-сайтами Azure. (Дополнительные сведения о директивах только системного уровня см. в разделе [Список директив php.ini][Список директив php.ini].)
3.  При необходимости добавьте расширения для вашей среды выполнения PHP и включите их в файл `php.ini`.
4.  Добавьте каталог `bin` в корневой каталог и поместите в него каталог, в котором содержится ваша среда выполнения PHP (например, `bin\php`).
5.  Разверните приложение.
6.  На портале Windows Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

    ![Вкладка "Настройка" на панели мониторинга веб-сайта][Вкладка "Настройка" на панели мониторинга веб-сайта]

7.  В разделе **сопоставления обработчика** добавьте к РАСШИРЕНИЮ `*.php` и добавьте путь к исполняемому файлу `php-cgi.exe`. Если вы поместите свою среду PHP в каталог `bin` в корне вашего приложения, путь будет таков: `D:\home\site\wwwroot\bin\php\php-cgi.exe`.

    ![Укажите обработчик в сопоставлении обработчика][Укажите обработчик в сопоставлении обработчика]

8.  В нижней части страницы нажмите кнопку **Сохранить**.

    ![Сохранение параметров конфигурации][Сохранение параметров конфигурации]

## <a name="NextSteps"></a>Дальнейшие действия

Вы изучили основные сведения о настройке PHP на веб-сайтах Azure. Дополнительные сведения можно найти по следующим ссылкам:

-   [Настройка, мониторинг и масштабирование веб-сайтов в Azure][Настройка, мониторинг и масштабирование веб-сайтов в Azure]
-   [Загрузка пакета Azure SDK для PHP][Загрузка пакета Azure SDK для PHP]

  [бесплатное пробное использование]: https://www.windowsazure.com/ru-ru/pricing/free-trial/
  [Центр разработчиков PHP — учебные курсы]: https://www.windowsazure.com/ru-ru/develop/php/tutorials/
  [Настройка веб-сайтов]: https://www.windowsazure.com/ru-ru/manage/services/web-sites/how-to-configure-websites/
  [Что такое веб-сайт Azure?]: #WhatIs
  [Практическое руководство. Изменение конфигурации PHP по умолчанию]: #ChangeBuiltInPHP
  [Практическое руководство. Включение расширений во встроенной среде выполнения PHP]: #EnableExtDefaultPHP
  [Практическое руководство. Использование пользовательской среды PHP]: #UseCustomPHP
  [Дальнейшие действия]: #NextSteps
  [phpinfo()]: http://php.net/manual/en/function.phpinfo.php
  [Вкладка "Настройка" на панели мониторинга веб-сайта]: ./media/web-sites-php-configure/configure.png
  [Выберите версию PHP]: ./media/web-sites-php-configure/select-php-version.png
  [Сохранение параметров конфигурации]: ./media/web-sites-php-configure/save-button.png
  [Список директив php.ini]: http://www.php.net/manual/en/ini.list.php
  [.user.ini]: http://www.php.net/manual/en/configuration.file.per-user.php
  [ini\_set()]: http://www.php.net/manual/en/function.ini-set.php
  [Включение расширения в параметрах приложения]: ./media/web-sites-php-configure/app-settings.png
  []: http://windows.php.net/download/
  [1]: http://windows.php.net/downloads/releases/archives/
  [Укажите обработчик в сопоставлении обработчика]: ./media/web-sites-php-configure/handler-mappings.png
  [Настройка, мониторинг и масштабирование веб-сайтов в Azure]: http://www.windowsazure.com/ru-ru/manage/services/web-sites/
  [Загрузка пакета Azure SDK для PHP]: http://www.windowsazure.com/ru-ru/develop/php/common-tasks/download-php-sdk/
