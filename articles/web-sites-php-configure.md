<properties 
	pageTitle="Как настроить PHP на веб-сайтах Microsoft Azure" 
	description="Узнайте, как настроить установку PHP по умолчанию или добавить пользовательскую установку PHP на веб-сайтах Azure." 
	services="" 
	documentationCenter="php" 
	authors="tfitzmac" 
	manager="wpickett" 
	editor=""/>

<tags 
	ms.service="web-sites" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="PHP" 
	ms.topic="article" 
	ms.date="11/18/2014" 
	ms.author="tomfitz"/>

#Настройка PHP на веб-сайтах Windows Azure

В этом руководстве показано, как настроить встроенную среду выполнения PHP на веб-сайтах Azure, создать настраиваемую среду выполнения PHP и включить расширения на веб-сайтах Azure. Чтобы использовать веб-сайты Azure, подпишитесь на [бесплатное пробное использование]. Для максимально эффективного использования данного руководства необходимо сначала создать сайт PHP в Azure (см. статью [Центр разработчиков PHP - учебные курсы]). Общую информацию о настройке сайтов в Azure см. в разделе [Настройка веб-сайтов].

##Оглавление

* [Что такое веб-сайт Azure?](#WhatIs)
* [Практическое руководство. Изменение конфигурации PHP по умолчанию](#ChangeBuiltInPHP)
* [Практическое руководство. Включение расширений во встроенной среде выполнения PHP](#EnableExtDefaultPHP)
* [Практическое руководство. Использование пользовательской среды PHP](#UseCustomPHP)
* [Дальнейшие действия](#NextSteps)

<h2><a name="WhatIs"></a>Что такое веб-сайты Azure?</h2>
Веб-сайты Azure позволяют создавать высокомасштабируемые веб-сайты в Azure. Быстро и легко развертывайте сайты в облачной среде с высокой масштабируемостью, которая позволяет начать с небольшого сайта и масштабировать его по мере роста трафика. Веб-сайты Azure используют языки и приложения с открытым исходным кодом по вашему выбору, а также поддерживают развертывание с помощью Git, FTP и TFS. Можно легко интегрировать другие службы, например базу данных MySQL, SQL, кэш, CDN и хранилище.

<h2><a name="ChangeBuiltInPHP"></a>Практическое руководство. Изменение встроенной конфигурации PHP</h2>
По умолчанию при создании веб-сайта Windows Azure устанавливается среда PHP 5.4, которая будет сразу готова для использования. Оптимальный способ увидеть доступные версии, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию[phpinfo()].

PHP 5.5 также доступна по умолчанию, но не включена. Для ее включения выполните следующие действия:

1. На портале Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

	![Configure tab on Web Sites dashboard][configure]

1. Щелкните PHP 5.5.

	![Select PHP version][select-php-version]

1. В нижней части страницы щелкните **Сохранить**.

	![Save configuration settings][save-button]

Для любой из встроенных сред выполнения PHP можно изменить параметры конфигурации, не являющиеся директивами только на уровне системы, выполнив следующие действия. (Дополнительную информацию о директивах только на уровне системы см. в разделе [Список директив php.ini].)

1. Добавьте файл [.user.ini] в корневой каталог.
1. Добавьте параметры конфигурации в файл `.user.ini`, используя тот же синтаксис, что и для файла `php.ini`. Например, если вы хотите включить параметр `display_errors` и установить для параметра `upload_max_filesize` значение 10М, в файле `.user.ini` будет указан следующий текст:

		; Example Settings
		display_errors=On
		upload_max_filesize=10M

1. Разверните приложение.
1. Перезапустите веб-сайт. (Перезагрузка необходима, так как частота считывания PHP файлов `.user.ini` регулируется параметром `user_ini.cache_ttl`, который является параметром уровня системы; по умолчанию значение этого параметра составляет 300 секунд (5 минут). Перезапуск сайта принудительно заставляет PHP считать новые параметры в файле `.user.ini`.)

В качестве альтернативы использованию файла `.user.ini`, можно использовать функцию [ini_set()] в сценарии для установки параметров конфигурации, не являющихся директивами системного уровня.

<h2><a name="EnableExtDefaultPHP"></a>Практическое руководство. Включение расширений в среде выполнения PHP по умолчанию</h2>
Как было отмечено в предыдущем разделе, оптимальный способ увидеть версию PHP по умолчанию, конфигурацию по умолчанию и поддерживаемые расширения заключается в развертывании сценария, который вызывает функцию [phpinfo()]. Чтобы включить дополнительные расширения, выполните следующие действия.

1. Добавьте каталог `bin` в корневой каталог.
1. Поместите файлы с расширением `.dll` в каталог `bin` (например, `php_mongo.dll`). Убедитесь, что расширения совместимы с версией PHP по умолчанию (на момент написания этого учебника в качестве версии по умолчанию используется PHP 5.4), а также совместимы с VC9 и непотокобезопасной технологией (nts).
1. Разверните приложение.
1. На портале Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

	![Configure tab on Web Sites dashboard][configure]

1. В разделе **настройки приложения** создайте ключ **PHP_EXTENSIONS** и значение **bin\your-ext-file**. Чтобы включить несколько расширений, используйте разделенный запятыми список файлов `.dll`.

	![Enable extension in app settings][app-settings]

1. В нижней части страницы щелкните **Сохранить**.

	![Save configuration settings][save-button]

<h2><a name="UseCustomPHP"></a>Практическое руководство. Использование пользовательской среды PHP</h2>
Вместо среды выполнения PHP по умолчанию веб-сайты Azure могут использовать среду выполнения PHP, предоставляемую для выполнения скриптов PHP. Предоставляемую среду выполнения можно настроить с помощью файла `php.ini`, также предоставляемого пользователем. Чтобы использовать настраиваемые среды выполнения PHP для веб-сайтов Azure, выполните следующие действия.

1. Получите версию PHP для Windows, совместимую с VC9 и непотокобезопасной технологией (nts). Последние версии PHP для Windows можно найти здесь: [http://windows.php.net/download/]. Более старые версии можно найти в архиве по адресу [http://windows.php.net/downloads/releases/archives/].
1. Измените файл `php.ini` для среды выполнения. Обратите внимание, что все параметры конфигурации, являющиеся директивами только системного уровня, будут игнорироваться веб-сайтами Azure. (Дополнительную информацию о директивах только на уровне системы см. в разделе [Список директив php.ini].)
1. При необходимости добавьте расширения для вашей среды выполнения PHP и включите их в файл `php.ini`.
1. Добавьте каталог `bin` в корневой каталог и поместите в него каталог, в котором содержится ваша среда выполнения PHP (например, `bin\php`).
1. Разверните приложение.
1. На портале Azure выберите панель мониторинга веб-сайта и щелкните **Настроить**.

	![Configure tab on Web Sites dashboard][configure]

1. В разделе **сопоставления обработчика** добавьте к `*.php` и добавьте путь к исполняемому файлу `php-cgi.exe`. Если вы поместите свою среду PHP в каталог `bin` в корне вашего приложения, путь будет таков: `D:\home\site\wwwroot\bin\php\php-cgi.exe`.

	![Specify handler in hander mappings][handler-mappings]

1. В нижней части страницы щелкните **Сохранить**.

	![Save configuration settings][save-button]

<h2><a name="NextSteps"></a>Дальнейшие действия</h2>
Вы изучили основные сведения о настройке PHP на веб-сайтах Azure. Дополнительные сведения можно найти по следующим ссылкам:

- [Настройка, мониторинг и масштабирование веб-сайтов в Azure]
- [Закачка пакета SDK для Azure для PHP]


[бесплатное пробное использование]: https://www.windowsazure.com/ru-ru/pricing/free-trial/
[Центр разработчиков PHP - учебные курсы]: https://www.windowsazure.com/ru-ru/develop/php/tutorials/
[Настройка веб-сайтов]: https://www.windowsazure.com/ru-ru/manage/services/web-sites/how-to-configure-websites/
[phpinfo()]: http://php.net/manual/en/function.phpinfo.php
[select-php-version]: ./media/web-sites-php-configure/select-php-version.png
[Список директив php.ini]: http://www.php.net/manual/en/ini.list.php
[.user.ini]: http://www.php.net/manual/en/configuration.file.per-user.php
[ini_set()]: http://www.php.net/manual/en/function.ini-set.php
[configure]: ./media/web-sites-php-configure/configure.png
[app-settings]: ./media/web-sites-php-configure/app-settings.png
[save-button]: ./media/web-sites-php-configure/save-button.png
[http://windows.php.net/download/]: http://windows.php.net/download/
[http://windows.php.net/downloads/releases/archives/]: http://windows.php.net/downloads/releases/archives/
[handler-mappings]: ./media/web-sites-php-configure/handler-mappings.png
[Настройка, мониторинг и масштабирование веб-сайтов в Azure]: http://azure.microsoft.com/manage/services/web-sites/
[Закачка пакета SDK для Azure для PHP]: http://azure.microsoft.com/develop/php/common-tasks/download-php-sdk/


<!--HONumber=42-->
