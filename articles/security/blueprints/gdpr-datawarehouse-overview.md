---
title: Схема безопасности и соответствия требованиям Azure. Хранилище данных для GDPR
description: Схема безопасности и соответствия требованиям Azure. Хранилище данных для GDPR
services: security
author: jomolesk
ms.assetid: 7a33fb3b-cfb6-49dd-ab4d-c53cf0d5da41
ms.service: security
ms.topic: article
ms.date: 05/14/2018
ms.author: jomolesk
ms.openlocfilehash: a091f4c941b1f4a338ad23956dbba3a7b89b87e8
ms.sourcegitcommit: e14229bb94d61172046335972cfb1a708c8a97a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2018
ms.locfileid: "34161867"
---
# <a name="azure-security-and-compliance-blueprint-data-warehouse-for-gdpr"></a>Схема безопасности и соответствия требованиям Azure. Хранилище данных для GDPR

## <a name="overview"></a>Обзор
Общий регламент по защите данных (GDPR) содержит множество требований, касающихся сбора, хранения и использования персональных сведений, в том числе способов идентификации и защиты персональных данных в организациях, адаптации требований прозрачности, обнаружения нарушений безопасности персональных данных и создания отчетов об этом, а также обучения персонала, работа которого связана с вопросами конфиденциальности, и других сотрудников. GDPR предоставляет пользователям дополнительный контроль над их персональными данными и налагает ряд новых обязательств на организации, занимающиеся сбором, обработкой и анализом персональных данных. GDPR устанавливает новые правила для организаций, которые предлагают товары и услуги жителям стран Европейского Союза (ЕС) или собирают и анализируют связанные с ними данные. GDPR применяется независимо от местонахождения организации.

Корпорация Майкрософт разработала платформу Azure с ведущими в отрасли мерами безопасности и политиками конфиденциальности для защиты данных в облаке, в том числе для категорий персональных данных, определяемых согласно GDPR. В соответствии с [условиями соглашений](http://aka.ms/Online-Services-Terms) корпорация Майкрософт обязуется соблюдать требования обрабатывающих органов.

Эта схема безопасности и соответствия требованиям Azure содержит руководство по развертыванию архитектуры хранилища данных в Azure, которое поможет вам выполнить требования GDPR. В этом решении демонстрируются способы, с помощью которых клиенты могут выполнять конкретные требования безопасности и соответствия. Кроме того, оно служит основой, позволяющей клиентам создавать и настраивать собственные решения для хранилищ данных в Azure. Клиенты могут задействовать эту эталонную архитектуру и следовать разработанному корпорацией Майкрософт [четырехэтапному процессу](https://aka.ms/gdprebook) для выполнения требований GDPR:
1. Обнаружение. Определите, какие персональные данные существуют и где они расположены.
2. Управление. Регулируйте способы использования персональных данных и доступа к ним.
3. Защита. Внедрите средства безопасности для предотвращения и выявления уязвимостей и нарушений безопасности данных, а также реагирования на них.
4. Отчетность. Ведите необходимую документацию и управляйте запросами данных и уведомлениями о нарушениях.

Эта эталонная архитектура, связанное руководство по реализации и модель рисков призваны служить основой, которую клиенты должны адаптировать для собственных потребностей, а не использовать "как есть" в рабочей среде. Обратите внимание на следующее:
- Эта архитектура является ориентиром, который помогает клиентам развертывать рабочие нагрузки Azure в соответствии с требованиями GDPR.
- Клиенты несут ответственность за выполнение надлежащей оценки безопасности и соответствия любого решения, созданного с использованием этой архитектуры, так как требования могут варьироваться в зависимости от специфики реализации каждого клиента.

## <a name="architecture-diagram-and-components"></a>Схема и компоненты архитектуры
Это решение предоставляет эталонную архитектуру, необходимую для реализации высокопроизводительного и безопасного облачного хранилища данных. В этой архитектуре есть два отдельных уровня данных: на одном из них осуществляется импорт, хранение и промежуточное хранение данных в кластеризованной среде SQL, другой предназначен для хранилища данных SQL Azure, куда данные загружаются с помощью средства извлечения, преобразования и загрузки (например, запросов T-SQL [PolyBase](https://docs.microsoft.com/azure/sql-data-warehouse/load-data-from-azure-blob-storage-using-polybase)) для обработки. После сохранения данных в хранилище данных SQL Azure можно выполнять аналитику в большом масштабе.

Azure предоставляет клиентам множество различных служб отчетности и аналитики. Это решение включает службы SQL Server Reporting Services (SSRS) для быстрого создания отчетов в хранилище данных SQL Azure. Весь трафик SQL шифруется с помощью SSL путем включения самозаверяющих сертификатов. Azure рекомендует использовать доверенный центр сертификации для повышенной безопасности.

Данные в хранилище данных SQL Azure хранятся в реляционных таблицах с использованием хранения по столбцам — формата, который значительно уменьшает затраты на хранение данных и улучшает производительность запросов.  В зависимости от требований потребления вычислительные ресурсы хранилища данных SQL Azure можно масштабировать или полностью отключать при отсутствии активных процессов, для которых они требуются.

Подсистема балансировки нагрузки SQL управляет трафиком SQL, обеспечивая высокую производительность. Все виртуальные машины в этой эталонной архитектуре развертываются в группе доступности с помощью экземпляров SQL Server, настроенных в группе доступности AlwaysOn для обеспечения высокого уровня доступности и аварийного восстановления.

Эта эталонная архитектура хранилища данных также включает уровень Active Directory (AD), предназначенный для управления ресурсами в рамках архитектуры. Подсеть Active Directory обеспечивает простое внедрение в структуру крупного леса AD, что гарантирует непрерывную работу в среде, даже если доступ к крупному лесу отсутствует. Все виртуальные машины присоединены к домену на уровне Active Directory и используют групповые политики Active Directory для применения конфигураций безопасности и соответствия на уровне операционной системы.

Виртуальная машина, которая служит управляющим узлом-бастионом, предоставляет безопасное соединение для администраторов, позволяющее получить доступ к развернутым ресурсам. Данные загружаются в промежуточную область через этот управляющий узел-бастион. **Azure рекомендует настроить подключение VPN или Azure ExpressRoute для управления и импорта данных в подсеть эталонной архитектуры.**

![Схема эталонной архитектуры хранилища данных для GDPR](images/gdpr-datawarehouse-architecture.png?raw=true "Data Warehouse for GDPR reference architecture diagram")

Это решение использует следующие службы Azure. Подробные сведения об архитектуре развертывания см. в [этом разделе](#deployment-architecture).

-   Виртуальные машины Azure
    - (1) узел-бастион;
    -   (2) контроллер домена Active Directory;
    -   (2) узел кластера SQL Server;
    -   (1) следящий сервер SQL Server.
-   Группы доступности
    - контроллеры домена Active Directory;
    - узлы и следящий сервер кластера SQL.
-   Виртуальная сеть
    - (4) подсети;
    -   (4) группы безопасности сети.
- Хранилище данных SQL
- Службы отчетов SQL Server
- Подсистема балансировки нагрузки SQL Azure.
- Azure Active Directory
- Хранилище служб восстановления
- Хранилище ключей Azure
- Operations Management Suite (OMS)
- Каталог данных Azure
- Центр безопасности Azure

## <a name="deployment-architecture"></a>Архитектура развертывания
В следующем разделе подробно описываются компоненты развертывания и реализации.

**Хранилище данных SQL**. [Хранилище данных SQL](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-overview-what-is) — это корпоративное хранилище данных (EDW), использующее массовую параллельную обработку (MPP) для быстрого выполнения сложных запросов на несколько петабайт данных, позволяя пользователям эффективно идентифицировать персональные данные. Пользователи могут применять простые запросы T-SQL PolyBase для импорта больших данных в хранилище данных SQL и задействовать возможности MPP для выполнения высокопроизводительной аналитики.

**SQL Server Reporting Services (SSRS)**. [Службы SQL Server Reporting Services](https://docs.microsoft.com/en-us/sql/reporting-services/report-data/sql-azure-connection-type-ssrs) обеспечивают быстрое создание отчетов с таблицами, диаграммами, картами, датчиками, матрицами и т. д. для хранилища данных SQL Azure.

**Каталог данных**. Благодаря [каталогу данных](https://docs.microsoft.com/azure/data-catalog/data-catalog-what-is-data-catalog) источники данных легко обнаруживаются и являются понятными для пользователей, которые управляют данными. Общие источники данных можно регистрировать, снабжать тегами и использовать для поиска персональных данных. Эти данные остаются в существующем расположении, однако копия этих метаданных добавляется в каталог данных вместе со ссылкой на расположение источника данных. Кроме того, чтобы облегчить обнаружение каждого источника данных с помощью функции поиска и сделать их доступными для пользователей, метаданные индексируются.

**Узел-бастион**. Узел-бастион является единой точкой входа, которая позволяет пользователям получать доступ к ресурсам, развернутым в этой среде. Узел-бастион предоставляет безопасное подключение к развернутым ресурсам, разрешая только удаленный трафик с общедоступных IP-адресов из надежного списка. Для разрешения трафика по протоколу RDP (протокол удаленного рабочего стола) источник трафика должен быть определен в группе безопасности сети (NSG).

Это решение создает виртуальную машину в виде присоединенного к домену узла-бастиона со следующими настройками:
-   [расширение защиты от вредоносных программ](https://docs.microsoft.com/azure/security/azure-security-antimalware);
-   [расширение OMS](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-extensions-oms);
-   [Расширение системы диагностики Azure](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-extensions-diagnostics-template)
-   [шифрование дисков Azure](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) с помощью хранилища ключей Azure Key Vault;
-   [политика автоматического завершения работы](https://azure.microsoft.com/blog/announcing-auto-shutdown-for-vms-using-azure-resource-manager/) для уменьшения степени использования ресурсов виртуальной машины во время простоя.
-   функция [Credential Guard в Защитнике Windows](https://docs.microsoft.com/windows/access-protection/credential-guard/credential-guard) должна быть включена, чтобы учетные данные и другие секретные сведения обрабатывались в защищенной среде, изолированной от работающей операционной системы.

### <a name="virtual-network"></a>Виртуальная сеть
Эта эталонная архитектура определяет частную виртуальную сеть с пространством адресов 10.0.0.0/16.

**Группы безопасности сети**. Группы [NSG](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) содержат списки управления доступом, которые разрешают или запрещают трафик в виртуальной сети. Группы безопасности сети можно использовать для защиты трафика на уровне отдельных виртуальных машин или подсети. Существуют следующие группы безопасности сети:
  - группа безопасности сети на уровне данных (кластеры SQL Server, следящий сервер SQL Server и подсистема балансировки нагрузки SQL);
  - группа безопасности сети для управляющего узла-бастиона;
  - группа безопасности сети для Active Directory;
  - группа безопасности сети для SQL Server Reporting Services.

В каждой группе безопасности сети (NSG) открыты определенные порты и протоколы, чтобы решение могло работать безопасно и правильно. Кроме того, для каждой NSG настроены следующие конфигурации:
  - включены [журналы диагностики и события](https://docs.microsoft.com/azure/virtual-network/virtual-network-nsg-manage-log), которые хранятся в учетной записи хранения;
  - служба OMS Log Analytics подключена к [диагностике NSG](https://github.com/krnese/AzureDeploy/blob/master/AzureMgmt/AzureMonitor/nsgWithDiagnostics.json).

**Подсети**. Каждая подсеть связана с соответствующей группой NSG.

### <a name="data-at-rest"></a>Неактивные данные
Архитектура защищает неактивные данные с помощью ряда мер, включая шифрование и аудит баз данных.

**Служба хранилища Azure**. Для выполнения требований к шифрованию неактивных данных во всей [службе хранилища Azure](https://azure.microsoft.com/services/storage/) используется [шифрование службы хранилища](https://docs.microsoft.com/azure/storage/storage-service-encryption). Это помогает защищать и охранять персональные данные в рамках обязательств по безопасности организаций и соответствия требованиям, определенным в GDPR.

**Шифрование дисков Azure**. Служба [шифрования дисков Azure](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) использует компонент BitLocker в Windows, чтобы обеспечить шифрование томов для дисков ОС и дисков данных. Решение интегрируется с Azure Key Vault, помогая контролировать ключи шифрования дисков и управлять ими.

**База данных SQL Azure**. В экземпляре базы данных SQL Azure используются следующие меры безопасности базы данных:
-   [Аутентификация и авторизация AD](https://docs.microsoft.com/azure/sql-database/sql-database-aad-authentication) обеспечивает централизованное управление удостоверениями для пользователей баз данных и других служб Майкрософт.
-   [Аудит базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-auditing-get-started) позволяет отслеживать события базы данных и записывать их в журнал аудита в учетной записи хранения Azure.
-   В базе данных SQL настроено [прозрачное шифрование данных (TDE)](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql), которое обеспечивает шифрование и расшифровку базы данных, связанных резервных копий и файлов журналов транзакций в реальном времени для защиты неактивных данных. TDE позволяет защитить сохраненные персональные данные от несанкционированного доступа.
-   [Правила брандмауэра](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure) предотвращают любой доступ к серверам баз данных при отсутствии соответствующих разрешений. Брандмауэр предоставляет доступ к базам данным на основе исходного IP-адреса каждого запроса.
-   [Обнаружение угроз SQL](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection-get-started) обеспечивает мгновенное обнаружение потенциальных угроз и реагирование на них, предоставляя оповещения системы безопасности о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных шаблонах доступа к базам данных.
-   [Столбцы Always Encrypted](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) гарантируют, что конфиденциальные персональные данные никогда не отобразятся как открытый текст внутри системы баз данных. После включения шифрования данных получить доступ к данным в виде открытого текста смогут только клиентские приложения и серверы приложений, у которых есть доступ к ключам.
- Функция [Расширенные свойства](https://docs.microsoft.com/sql/relational-databases/system-stored-procedures/sp-addextendedproperty-transact-sql) может применяться для прекращения обработки субъектов данных, так как позволяет пользователям добавлять настраиваемые свойства к объектам баз данных и помечать данные как "Неподдерживаемые" для поддержки логики приложений, предотвращающей обработку связанных персональных данных.
- [Безопасность на уровне строк](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) позволяет пользователям определять политики для ограничения доступа к данным, чтобы прекращать их обработку.
- [Динамическое маскирование данных базы данных SQL (DDM)](https://docs.microsoft.com/azure/sql-database/sql-database-dynamic-data-masking-get-started) ограничивает возможность раскрытия конфиденциальных данных, маскируя их для непривилегированных пользователей или приложений. DDM может автоматически обнаруживать потенциально конфиденциальные данные и предлагать применение соответствующих масок. Это помогает идентифицировать персональные данные, подлежащие защите согласно GDPR, и ограничивать доступ к ним таким образом, чтобы данные не покидали пределы базы данных в результате несанкционированного доступа. **Примечание. Клиентам потребуется настроить параметры DDM в соответствии со своей схемой базы данных.**

### <a name="identity-management"></a>Управление удостоверениями
Следующие технологии обеспечивают возможности управления доступом к персональным данным в среде Azure.
-   [Azure Active Directory (AAD)](https://azure.microsoft.com/services/active-directory/) — это мультитенантный облачный каталог и служба управления удостоверениями корпорации Майкрософт. Все пользователи для этого решения создаются в AAD, включая пользователей, обращающихся к базе данных SQL.
-   Аутентификация в приложении выполняется с помощью AAD. Дополнительные сведения см. в статье [Интеграция приложений с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications). Кроме того, при шифровании столбцов базы данных AAD используется для аутентификации приложения в Базе данных SQL Azure. Дополнительные сведения см. в статье о [защите конфиденциальных данных в базе данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault).
-   [Управление доступом на основе ролей Azure (RBAC)](https://docs.microsoft.com/azure/active-directory/role-based-access-control-configure) позволяет администраторам определять детальные разрешения доступа, предоставляя его ровно в той мере, которая необходима пользователям для выполнения работы. Вместо предоставления каждому пользователю неограниченных разрешений на ресурсы Azure администраторы могут разрешить только определенные действия для доступа к персональным данным. Доступ к подписке есть только у администратора подписки.
- [AAD Privileged Identity Management (PIM)](https://docs.microsoft.com/azure/active-directory/active-directory-privileged-identity-management-getting-started) позволяет клиентам свести к минимуму число пользователей, имеющих доступ к определенной информации, такой как персональные данные.  Администраторы могут использовать AAD Privileged Identity Management для обнаружения, ограничения и отслеживания привилегированных удостоверений, а также их доступа к ресурсам. Эту функцию можно также задействовать для получения административного JIT-доступа по требованию, когда это необходимо.
- [Защита идентификации AAD](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection) выявляет потенциальные уязвимости, влияющие на удостоверения организации, настраивает автоматическое реагирование на обнаруженные подозрительные действия, связанные с удостоверениями организации, и расследует подозрительные инциденты для принятия соответствующих мер по их устранению.

### <a name="security"></a>Безопасность
**Управление секретами**. Для управления ключами и секретами в решении используется [Azure Key Vault](https://azure.microsoft.com/services/key-vault/). Хранилище ключей Azure помогает защитить криптографические ключи и секреты, используемые облачными приложениями и службами. Следующие возможности Azure Key Vault помогают клиентам защитить персональные данные и доступ к ним:
- Политики расширенного доступа настраиваются по мере необходимости.
- Политики доступа к Key Vault определены с минимальными необходимыми разрешениями на использование ключей и секретов.
- Все ключи и секреты в Key Vault имеют срок действия.
- Все ключи в Key Vault защищены специализированными аппаратными модулями безопасности (HSM). Тип ключа — 2048-разрядный ключ RSA, защищенный с помощью HSM.
- Всем пользователям и удостоверениям предоставляются минимальные необходимые разрешения с помощью RBAC.
- Для журналов диагностики хранилища ключей включен срок хранения не менее 365 дней.
- Допустимые операции шифрования для ключей доступны только тем пользователям, которым они нужны.

**Управление исправлениями**. Виртуальные машины Windows, развернутые как часть этой эталонной архитектуры, настраиваются по умолчанию для получения автоматических обновлений из службы Центра обновления Windows. Это решение также включает службу [автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-intro) для OMS, с помощью которой можно создавать обновленные развертывания для исправления виртуальных машин при необходимости.

**Защита от вредоносных программ**. [Модуль защиты от вредоносных программ (Майкрософт)](https://docs.microsoft.com/azure/security/azure-security-antimalware) для виртуальных машин предоставляет возможности защиты в реальном времени для обнаружения и удаления вирусов, шпионских и других вредоносных программ. Вы можете настроить оповещения о попытках установки или запуска известных вредоносных или нежелательных программ на защищенных виртуальных машинах.

**Оповещения системы безопасности**. [Центр безопасности Azure](https://docs.microsoft.com/en-us/azure/security-center/security-center-intro) позволяет клиентам отслеживать трафик, собирать журналы и анализировать источники данных на предмет угроз. Кроме того, центр безопасности Azure обращается к существующей конфигурации служб Azure и предоставляет конфигурацию и рекомендации по службам для повышения уровня безопасности и защиты персональных данных. В центре безопасности Azure хранится [отчет об исследовании угроз](https://docs.microsoft.com/en-us/azure/security-center/security-center-threat-report) для каждой обнаруженной угрозы. Это позволяет командам реагирования на инциденты расследовать и устранять угрозы.

### <a name="business-continuity"></a>Непрерывность бизнес-процессов
**Высокий уровень доступности**. Рабочие нагрузки сервера объединяются в [группы доступности](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-manage-availability?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) для обеспечения высокого уровня доступности виртуальных машин в Azure. Во время планового или внепланового технического обслуживания доступна как минимум одна виртуальная машина, что соответствует соглашению об уровне обслуживания Azure, гарантирующему доступность в течение 99,95 % времени.

**Хранилище служб восстановления**. [Хранилище служб восстановления](https://docs.microsoft.com/azure/backup/backup-azure-recovery-services-vault-overview) содержит резервные копии данных и защищает все конфигурации виртуальных машин Azure в этой архитектуре. С помощью хранилища служб восстановления клиенты могут восстановить файлы и папки виртуальной машины IaaS, не восстанавливая всю виртуальную машину, что позволяет сократить время восстановления.

### <a name="logging-and-auditing"></a>Ведение журналов и аудит
[Operations Management Suite (OMS)](https://docs.microsoft.com/en-us/azure/operations-management-suite/operations-management-suite-overview) обеспечивает ведение журнала с подробными сведениями о действиях системы и пользователей, а также работоспособности системы. Решение OMS [Log Analytics](https://azure.microsoft.com/services/log-analytics/) собирает и анализирует данные, создаваемые ресурсами в Azure и локальных средах.
- **Журналы действий.** [Журналы действий](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs) содержат информацию об операциях, которые выполнялись с ресурсами в подписке. Журналы действий помогают определить инициатора операции, время события и состояние.
- **Журналы диагностики.** [Журналы диагностики](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs) включают в себя все журналы, создаваемые каждым ресурсом. Эти журналы включают в себя системные журналы событий Windows, хранилища BLOB-объектов, таблиц и очередей.
- **Архивация журналов**. Все журналы диагностики записывают данные в централизованную и зашифрованную учетную запись Azure для архивирования. В соответствии с требованиями конкретной организации пользователь может настроить срок хранения до 730 дней. Эти журналы подключаются к Azure Log Analytics для обработки и хранения данных, а также создания отчетов на панелях мониторинга.

Кроме того, в состав этой архитектуры входят следующие решения OMS:
-   [Оценка AD](https://docs.microsoft.com/azure/log-analytics/log-analytics-ad-assessment). Решение "Проверка работоспособности Active Directory" оценивает риски и работоспособность серверных сред через регулярные интервалы и предоставляет приоритизированный список рекомендаций, относящихся к развернутой серверной инфраструктуре.
-   [Оценка защиты от вредоносных программ](https://docs.microsoft.com/azure/log-analytics/log-analytics-malware). Решение для защиты от вредоносных программ сообщает о вредоносных программах, угрозах и состоянии защиты.
-   [Служба автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-hybrid-runbook-worker). Это решение обеспечивает хранение и выполнение модулей Runbook, а также управление ими.
-   [Безопасность и аудит](https://docs.microsoft.com/azure/operations-management-suite/oms-security-getting-started). Панель мониторинга "Безопасность и аудит" дает общее представление о состоянии безопасности ресурсов, предоставляя метрики по доменам безопасности, важным проблемам, обнаружениям, исследованию угроз и распространенным запросам безопасности.
-   [Оценка SQL](https://docs.microsoft.com/azure/log-analytics/log-analytics-sql-assessment). Решение "Проверка работоспособности SQL" оценивает риски и работоспособность серверных сред через регулярные интервалы и предоставляет клиентам приоритизированный список рекомендаций, относящихся к развернутой серверной инфраструктуре.
-   [Управление обновлениями](https://docs.microsoft.com/azure/operations-management-suite/oms-solution-update-management). Решение "Управление обновлениями" позволяет клиенту управлять обновлениями безопасности операционной системы, включая состояние доступных обновлений, а также процесс установки необходимых обновлений.
-   [Работоспособность агентов](https://docs.microsoft.com/azure/operations-management-suite/oms-solution-agenthealth). Решение "Работоспособность агентов" сообщает о количестве развернутых агентов, их географическом распределении, а также количестве агентов, которые перестают отвечать на запросы, и количестве агентов, которые отправляют операционные данные.
-   [Журналы действий Azure](https://docs.microsoft.com/azure/log-analytics/log-analytics-activity). Решение "Аналитика журнала действий" помогает при анализе журналов действий Azure во всех подписках Azure для клиента.
-   [Отслеживание изменений](https://docs.microsoft.com/azure/log-analytics/log-analytics-activity). Решение "Отслеживание изменений" позволяет клиентам легко определять изменения в среде.

## <a name="threat-model"></a>Модель рисков

Схему потока данных для этой эталонной архитектуры можно [скачать](https://aka.ms/gdprDWdfd) или просмотреть ниже. Используя эту модель, клиенты могут найти зоны потенциального риска в инфраструктуре системы при внесении изменений.

![Модель рисков хранилища данных для GDPR](images/gdpr-datawarehouse-threat-model.png?raw=true "Data Warehouse for GDPR threat model")

## <a name="compliance-documentation"></a>Документация по соответствию
В документе [Azure Security and Compliance Blueprint — GDPR Customer Responsibility Matrix](https://aka.ms/gdprCRM) (Схема безопасности и соответствия требованиям Azure. Таблица ответственности клиентов согласно GDPR) перечисляются обязанности контроллеров и обработчиков по всем статьям GDPR. Обратите внимание на то, что в контексте служб Azure клиент обычно выступает в роли контроллера, а Майкрософт — в роли обработчика.

В документе [Azure Security and Compliance Blueprint — GDPR Data Warehouse Implementation Matrix](https://aka.ms/gdprDW) (Схема безопасности и соответствия требованиям Azure. Таблица реализации хранилища данных для GDPR) содержатся сведения о том, какие статьи GDPR отражены в архитектуре хранилища данных, включая подробные описания того, как реализация соответствует требованиям каждой затронутой статьи.

## <a name="guidance-and-recommendations"></a>Руководство и рекомендации
### <a name="vpn-and-expressroute"></a>VPN и ExpressRoute
Чтобы установить защищенное подключение к ресурсам, которые развертываются в рамках этой эталонной архитектуры хранилища данных, необходимо настроить защищенный VPN-туннель или [ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-introduction). Правильно настроив VPN-подключение или ExpressRoute, клиенты могут добавить уровень защиты передаваемых данных.

При реализации защищенного VPN-туннеля с помощью Azure можно создать виртуальное частное подключение между локальной сетью и виртуальной сетью Azure. Это подключение осуществляется через Интернет и позволяет клиентам безопасно передавать данные по "туннелю" внутри зашифрованного канала между сетью клиента и Azure. VPN типа "сеть — сеть" представляет собой безопасную проверенную технологию, которая десятилетиями применяется на предприятиях всех размеров. [Режим туннеля IPsec](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc786385(v=ws.10)) используется в этом решении как механизм шифрования.

Так как трафик в VPN-туннеле проходит через Интернет по VPN-подключению типа "сеть — сеть", Майкрософт предлагает другой, еще более безопасный вариант подключения. Azure ExpressRoute — это выделенный канал связи в глобальной сети между Azure и локальной средой или поставщиком услуг размещения Exchange. Подключения ExpressRoute не проходят через Интернет, а значит обеспечивают повышенный уровень безопасности, надежности и быстродействия, а также меньшую задержку по сравнению с типичными подключениями через Интернет. Более того, так как это прямое подключение поставщика телекоммуникационных услуг клиента, данные не передаются через Интернет и поэтому недоступны в нем.

См. [рекомендации](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid) по реализации защищенной гибридной сети, расширяющей локальную сеть в Azure.

### <a name="extract-transform-load-etl-process"></a>Процесс извлечения, преобразования и загрузки (ETL)
[PolyBase](https://docs.microsoft.com/sql/relational-databases/polybase/polybase-guide) может отправлять данные в хранилище данных SQL Azure без использования отдельного средства для ETL или импорта. PolyBase поддерживает доступ к данным с помощью запросов T-SQL. С PolyBase можно использовать бизнес-аналитику и стек аналитики Майкрософт, а также сторонние средства, совместимые с SQL Server.

### <a name="azure-active-directory-setup"></a>Настройка Azure Active Directory
Служба [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-whatis) играет важную роль в управлении развертыванием и подготовкой доступа для персонала, взаимодействующего со средой. Windows Server Active Directory можно интегрировать с AAD [с помощью четырех простых действий](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-express). Клиенты также могут привязать развернутую инфраструктуру Active Directory (контроллеры домена) к существующей службе AAD, сделав развернутую инфраструктуру Active Directory дочерним доменом леса AAD.

### <a name="optional-services"></a>Дополнительные службы
Azure предлагает широкий набор служб для помощи в хранении и промежуточной обработке форматированных и неформатированных данных. В зависимости от требований клиента в эталонную архитектуру можно добавить следующие службы:
-   [Фабрика данных Azure](https://docs.microsoft.com/azure/data-factory/introduction) — это управляемая облачная служба, созданная для сложных гибридных проектов извлечения, преобразования и загрузки (или извлечения, загрузки и преобразования) и интеграции данных. Фабрика данных Azure обладает возможностями, помогающими отслеживать и находить персональные данные, и содержит средства визуализации и мониторинга для определения времени поступления данных и их источника. С помощью фабрики данных Azure клиенты могут создавать и планировать управляемые данными рабочие процессы (конвейеры), которые принимают данные из разнородных хранилищ данных. Эти конвейеры позволяют клиентам принимать данные как из внутренних, так и из внешних источников. Затем клиенты могут обрабатывать данные и преобразовывать их для вывода в хранилища данных, такие как хранилище данных SQL Azure.
- На промежуточном этапе клиенты могут направлять неструктурированные данные в [Azure Data Lake Store](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-overview), где можно централизованно сохранять данные любого размера, любого типа и с любой скоростью приема для эксплуатационной и исследовательской аналитики.  Azure Data Lake обладает возможностями, обеспечивающими извлечение и преобразование данных. Служба Azure Data Lake Store совместима с большинством компонентов с открытым кодом в экосистеме Hadoop и хорошо интегрируется с другими службами Azure, такими как хранилище данных SQL Azure.

## <a name="disclaimer"></a>Отказ от ответственности

 - Этот документ является исключительно информационным. МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ЯВНЫХ, КОСВЕННЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОМ, В ОТНОШЕНИИ ИНФОРМАЦИИ В ЭТОМ ДОКУМЕНТЕ. Данный документ предоставляется "как есть". Сведения и мнения, представленные в данном документе, включая URL-адреса и ссылки на другие веб-сайты, могут быть изменены без предварительного уведомления. Клиенты, читающие этот документ, берут ответственность за его использование на себя.
 - Настоящий документ не предоставляет клиентам юридических прав на интеллектуальную собственность в отношении продуктов или решений корпорации Майкрософт.
 - Клиенты могут скопировать и использовать данный документ для внутренних справочных целей.
 - Выполнение некоторых рекомендаций в этом документе может привести к более интенсивному использованию данных, а также сетевых и вычислительных ресурсов в Azure, а значит и к дополнительным затратам на лицензии или подписки Azure.
 - Эта архитектура призвана служить основой, которую клиенты должны адаптировать для конкретных требований, и не должна использоваться "как есть" в рабочей среде.
 - Этот документ разработан в качестве справочного материала и не определяет все способы, с помощью которых клиент может отвечать нормам и стандартам соответствия. Клиентам следует обратиться в юридический отдел своей организации, чтобы получить одобренные варианты пользовательских реализаций.
