---
title: Сетевая архитектура Azure
description: Эта статья содержит общее описание сетевой инфраструктуры Microsoft Azure.
services: security
documentationcenter: na
author: TerryLanfear
manager: MBaldwin
editor: TomSh
ms.assetid: 61e95a87-39c5-48f5-aee6-6f90ddcd336e
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/28/2018
ms.author: terrylan
ms.openlocfilehash: 67781f196b445c9330e0dcb1fc7d8b0a1a53cbc0
ms.sourcegitcommit: d7725f1f20c534c102021aa4feaea7fc0d257609
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2018
ms.locfileid: "37101689"
---
# <a name="azure-network-architecture"></a>Сетевая архитектура Azure
Сетевая архитектура Azure соответствует модифицированной версии стандартной модели Core/Distribution/Access (базовый уровень/уровень распостранения/уровень доступа) с отдельными аппаратными слоями. Слои включают:

- Core (базовый уровень) (маршрутизаторы центра обработки данных).
- Distribution (уровень распространения) (маршрутизаторы доступа и агрегирование L2). Уровень распространения отделяет маршрутизацию L3 от коммутации L2.
- Access (уровень доступа) (коммутаторы узла L2).

Сетевая архитектура имеет два уровня коммутаторов второго слоя. Чтобы внедрить избыточность, один уровень агрегирует трафик от другого уровня, а на втором выполняется зацикливание. Это обеспечивает преимущества, такие как более гибкий объем виртуальной локальной сети и улучшение масштабирования порта. Архитектура сохраняет уникальные значения L2 и L3, которые позволяет использовать оборудование на каждом из отдельных слоев в сети и минимизирует влияние сбоев одного слоя на другие. При использовании магистрали обеспечивается предоставление общего доступа к ресурсам, например подключение к инфраструктуре L3.

## <a name="network-configuration"></a>Конфигурация сети
Сетевая архитектура кластера Microsoft Azure в центре обработки данных состоит из следующих устройств:

- Маршрутизаторы (центр обработки данных, маршрутизатор доступа и маршрутизаторы конечных объектов).
- Коммутаторы (агрегированные и стоечные коммутаторы).
- Цифровые CM.
- Блоки распределения питания (так называемые "нуклоны").

На следующем рисунке представлен общий обзор сетевой архитектуры Azure в кластере. Azure имеет две отдельные архитектуры. Некоторые существующие клиенты и общие службы Azure находятся в архитектуре локальной сети по умолчанию (DLA), тогда как к новым регионам и виртуальным пользователям будет осуществляться доступ через архитектуру Quantum 10 (Q10). Архитектура DLA —это традиционная древовидная архитектура с активированными пассивными маршрутизаторами доступа и ACL безопасности, которая применяется к маршрутизаторам доступа. Архитектура Quantum 10 представляет собой закрытую сетчатую структуру маршрутизаторов, где списки управления доступом (ACL) не применяются на маршрутизаторах. Они применяются ниже маршрутизации через балансировку нагрузки программного обеспечения (SLB) или программно определяемые виртуальные локальные сети.

![Сеть Azure][1]

### <a name="quantum-10-devices"></a>Устройства Quantum 10
Конструкция Quantum 10 проводит распределение коммутации 3 слоя на несколько устройств в закрытой сетчатой структуре. Преимущества конструкции Q10: более широкие способности и возможности масштабирования имеющейся сетевой инфраструктуры. В ней используются маршрутизаторы конечных объектов, основные и стоечные коммутаторы для передачи трафика в кластеры по нескольким маршрутам, что обеспечивает устойчивость к сбоям. Службы безопасности, такие как преобразование сетевых адресов, обрабатываются за счет балансировки нагрузки программного обеспечения, а не оборудования.

### <a name="access-routers"></a>Маршрутизаторы доступа
Маршрутизаторы распространения или доступа L3 выполняют основные функциональные возможности маршрутизации для уровней распространения и доступа. Эти устройства развертываются в виде пары, а также имеют шлюз для подсети по умолчанию. Каждая пара маршрутизаторов доступа может поддерживать несколько пар агрегированных коммутаторов L2, в зависимости от емкости. Максимальное количество зависит от емкости устройства, а также от доменов сбоя. Обычно для пары маршрутизаторов доступа используют три агрегированных коммутатора L2.

### <a name="l2-aggregation-switches"></a>Агрегированные коммутаторы L2  
Эти устройства служат точкой агрегирования для трафика L2. Они и есть слоем распространения в структуре L2 и могут обрабатывать большие объемы трафика. Так как эти устройства выполняют статистическое вычисление трафика, то функционал 802.1q является обязательным. Кроме того, используются технологии с высокой пропускной способностью, такие как агрегация портов и 10GE.

### <a name="l2-host-switches"></a>Коммутаторы узла L2
Узлы подключатся непосредственно к этим коммутаторам. Они могут быть установлены в стойку коммутаторов или в развертывание корпуса. Стандарт 802.1q позволяет обозначить одну виртуальную локальную сеть, как встроенную. При этом она будет рассматриваться как обычный (без тегов) компонент Ethernet. В обычных условиях компоненты в собственной виртуальной локальной сети передаются и принимаются без тегов на магистральном порту 802.1q. Эта функция была разработана для миграции на 802.1q и совместима с устройствами, не поддерживающими 802.1q. В этой архитектуре только сетевая инфраструктура использует собственную виртуальную ЛС.

Эта архитектура определяет стандарт для выбора собственной виртуальной ЛС, который гарантирует, что устройства распространения имеют уникальную собственную виртуальную ЛС для каждой магистрали, а также магистрали L2Aggregation — L2Aggregation (где это возможно). Магистрали L2Aggregation — L2Host Switch имеют встроенную виртуальную ЛС не по умолчанию.

### <a name="link-aggregation-8023ad"></a>Объединение каналов связи (802.3ad)
Объединение каналов связи (LAG) позволяет объединить несколько отдельных каналов связи в пакет и обрабатывать их как единую логическую связь. Номер, используемый для обозначения интерфейсов канала порта, должен быть стандартизован, чтобы упростить оперативную отладку, а остальная часть сети будет использовать этот номер на обоих концах канала порта. Для этого требуется стандарт, чтобы определить, какой из конечных элементов связи "канал — порт" используется для определения следующего доступного номера.

Номера, указанные для коммутатора L2Agg к L2Host, являются номерами канала порта, используемыми на стороне L2Agg. Так как диапазон номеров сильнее ограничен на стороне L2Host, то стандартным является использование номеров 1 и 2 на стороне L2Host, чтобы указать на передачу в паре "канал — порт" со стороны a и b соответственно.

### <a name="vlans"></a>Виртуальные локальные сети
Сетевая архитектура использует виртуальные локальные сети для объединения серверов в одном широковещательном домене. Номера виртуальной локальной сети соответствуют стандартам 802.1q, которые поддерживают виртуальную локальную сеть с номером 1–4094.

### <a name="customer-vlans"></a>Виртуальные локальные сети клиента
Клиенты имеют различные варианты реализации виртуальной локальной сети, которые они могут развертывать на портале Azure, в соответствии с разделением и требованиями к архитектуре решений. Эти решения развертываются с помощью виртуальных машин. Примеры архитектуры см. в статье [Эталонная архитектура Azure](https://docs.microsoft.com/azure/architecture/reference-architectures/).

### <a name="edge-architecture"></a>Архитектура Edge
Центры обработки данных Azure построен на базе высокоизбыточных и хорошо подготовленных сетевых инфраструктур. Сети в центрах обработки данных Azure реализуются с помощью архитектур избыточности "требуемое количество+1" (N + 1) или более оптимальных. Полные функции отработки отказа внутри и между центрами обработки данных помогают обеспечить доступность сети и службы. Внешне центры обработки данных обслуживаются выделенными сетевыми схемами с высокой пропускной способностью, которые избыточно соединяют свойства с более чем 1200 поставщиками интернет-услуг по всему миру в нескольких точках пиринга, обеспечивая пограничную пропускную способность по сети более 2000 Гбит/с.

Фильтрация маршрутизаторов на пограничном уровне и уровне доступа сети Microsoft Azure обеспечивает надежную защиту на уровне пакетов, чтобы предотвратить несанкционированные попытки подключения к Azure. Они гарантируют, что фактическое содержимое пакетов — это данные в ожидаемом формате, и что оно соответствует ожидаемой схеме связи между клиентом и сервером. Azure реализует многоуровневую архитектуру, состоящую из следующих компонентов сегрегации сети и контроля доступа:

- Пограничные маршрутизаторы. Они используются, чтобы отделить среду приложений от Интернета. Пограничные маршрутизаторы предназначены для обеспечения защиты от спуфинга и ограничения доступа с помощью списков управления доступом (ACL).
- Маршрутизаторы распространения (доступа). Маршрутизаторы доступа разрешают только одобренные корпорацией Майкрософт IP-адреса, обеспечивают защиту от спуфинга и устанавливают TCP-подключения путем использования списков ACL.

### <a name="a10-ddos-mitigation-architecture"></a>Архитектура устранение рисков A10 DDOS
Атаки типа "отказ в обслуживании" продолжают представлять потенциальную угрозу надежности веб-служб Майкрософт. Так как атаки становятся более целенаправленными, более сложными, а распространение служб Майкрософт расширяется на глобальной уровне, возможность предоставлять эффективные механизмы для идентификации и минимизации воздействия этих атак является первоочередной задачей.

Ниже приведены сведения о реализации системы устранения рисков A10 DDOS с точки зрения архитектуры сети.  
Microsoft Azure использует сетевые устройства A10 в DCR (маршрутизатор центра обработки данных), которые обеспечивают автоматическое обнаружение и устранение рисков. Решение A10 использует сетевой монитор Azure для выборки потока пакетов Net и обнаружения атаки. Как только атака обнаружена, устройства A10 используются в качестве средства очистки для устранения рисков. После устранения рисков дальнейший чистый трафик доставляется в базу данных Azure непосредственно из DCR. Решение A10 используется для защиты сетевой инфраструктуры Azure.

Решение A10 для защиты от атак типа "отказ в обслуживании" включает:

- защиту от переполнения UDP IPv4 и IPv6;
- защиту от переполнения ICMP IPv4 и IPv6;
- защиту от переполнения TCP IPv4 и IPv6;
- защиту от атак TCP SYN для IPv4 и IPv6;
- фрагментарные атаки.

> [!NOTE]
> Защита от атак типа "отказ в обслуживании" предоставляется по умолчанию для всех клиентов Azure.
>
>

## <a name="network-connection-rules"></a>Правила сетевого подключения
Azure развертывает пограничные маршрутизаторы в сети, которая обеспечивает безопасность на уровне пакетов, чтобы предотвратить несанкционированные попытки подключения к Microsoft Azure. Они гарантируют, что фактическое содержимое пакетов — это данные в ожидаемом формате, и что оно соответствует ожидаемой схеме связи между клиентом и сервером.

Пограничные маршрутизаторы используются, чтобы отделить среду приложений от Интернета. Пограничные маршрутизаторы предназначены для обеспечения защиты от спуфинга и ограничения доступа с помощью списков управления доступом (ACL). Эти пограничные маршрутизаторы настроены с помощью подхода с использованием многоуровневого ACL для ограничения сетевых протоколов, которым разрешено передавать данные пограничным маршрутизаторам и маршрутизаторам доступа.

Сетевые устройства размещаются в местах доступа и в пограничных расположениях и выступают в качестве граничных точек, в которых применяются фильтры входящего и исходящего трафика.

## <a name="next-steps"></a>Дополнительная информация
Дополнительные сведения о действиях корпорации Майкрософт в сфере защиты инфраструктуры Azure приведены в следующих статьях:

- [Объекты, локальная среда и физическая безопасность в Azure](azure-physical-security.md)
- [Доступность инфраструктуры Azure](azure-infrastructure-availability.md)
- [Компоненты и границы информационной системы Azure](azure-infrastructure-components.md)
- [Рабочая сеть Azure](azure-production-network.md)
- [Средства безопасности Базы данных SQL Microsoft Azure](azure-infrastructure-sql.md)
- [Операции и управление в рабочей среде Azure](azure-infrastructure-operations.md)
- [Мониторинг инфраструктуры Azure](azure-infrastructure-monitoring.md)
- [Целостность инфраструктуры Azure](azure-infrastructure-integrity.md)
- [Защита клиентских данных в Azure](azure-protection-of-customer-data.md)

<!--Image references-->
[1]: ./media/azure-infrastructure-network/network-arch.png
