---
title: Сетевая архитектура Azure
description: Эта статья содержит общее описание сетевой инфраструктуры Microsoft Azure.
services: security
documentationcenter: na
author: TerryLanfear
manager: MBaldwin
editor: TomSh
ms.assetid: 61e95a87-39c5-48f5-aee6-6f90ddcd336e
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/28/2018
ms.author: terrylan
ms.openlocfilehash: a6800b18d1bb588c747d4e9ef7049ac4cbb82f60
ms.sourcegitcommit: 248c2a76b0ab8c3b883326422e33c61bd2735c6c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2018
ms.locfileid: "39213478"
---
# <a name="azure-network-architecture"></a>Сетевая архитектура Azure
Сетевая архитектура Azure соответствует модифицированной версии стандартной модели Core/Distribution/Access (базовый уровень/уровень распостранения/уровень доступа) с отдельными аппаратными слоями. Слои включают:

- Core (базовый слой) (маршрутизаторы центра обработки данных).
- Distribution (слой распространения) (маршрутизаторы доступа и агрегирование L2). Этот уровень отделяет маршрутизацию L3 от коммутации L2.
- Access (слой доступа) (коммутаторы узла L2).

Сетевая архитектура имеет два уровня коммутаторов слоя 2. Один слой выполняет статическое вычисление трафика из другого слоя. На втором слое выполняется зацикливание для обеспечения избыточности. Это обеспечивает гибкий объем виртуальной локальной сети и улучшение масштабирования порта. Архитектура сохраняет уникальные значения L2 и L3, которые позволяет использовать оборудование на каждом из отдельных слоев в сети и минимизирует влияние сбоев одного слоя на другие. При использовании магистрали обеспечивается предоставление общего доступа к ресурсам, например подключение к инфраструктуре L3.

## <a name="network-configuration"></a>Конфигурация сети
Сетевая архитектура кластера Azure в центре обработки данных состоит из следующих устройств:

- маршрутизаторы (центр обработки данных, маршрутизатор доступа и маршрутизаторы конечных объектов);
- коммутаторы (агрегированные и стоечные коммутаторы);
- Цифровые CM.
- блоки распределения питания.

Azure имеет две отдельные архитектуры. Некоторые существующие клиенты и общие службы Azure находятся в архитектуре локальной сети по умолчанию (DLA), тогда как для новых регионов и виртуальных пользователей будет использоваться архитектура Quantum 10 (Q10). Архитектура DLA — это традиционная древовидная архитектура с активными или пассивными маршрутизаторами доступа и списками управления доступом безопасности (ACL), которые применяются к маршрутизаторам доступа. Архитектура Quantum 10 представляет собой закрытую сетчатую структуру маршрутизаторов, на которых не применяются ACL. Они применяются ниже маршрутизации за счет балансировки нагрузки программного обеспечения (SLB) или программно определяемых виртуальных локальных сетей.

На следующей схеме показана общая сетевая архитектура в кластере Azure:

![Схема сети Azure][1]

### <a name="quantum-10-devices"></a>Устройства Quantum 10
Конструкция Quantum 10 проводит распределение коммутации 3 слоя на несколько устройств в закрытой сетчатой структуре. Преимущества конструкции Q10: более широкие способности и возможности масштабирования имеющейся сетевой инфраструктуры. В ней используются маршрутизаторы конечных объектов, основные и стоечные коммутаторы для передачи трафика в кластеры по нескольким маршрутам, что обеспечивает устойчивость к сбоям. Службы безопасности, такие как преобразование сетевых адресов, обрабатываются за счет балансировки нагрузки программного обеспечения, а не оборудования.

### <a name="access-routers"></a>Маршрутизаторы доступа
Маршрутизаторы распространения или доступа L3 выполняют основные функциональные возможности маршрутизации для уровней распространения и доступа. Эти устройства развертываются в виде пары, а также имеют шлюз для подсети по умолчанию. Каждая пара маршрутизаторов доступа может поддерживать несколько пар агрегированных коммутаторов L2, в зависимости от емкости. Максимальное количество зависит от емкости устройства, а также от доменов сбоя. Обычно для пары маршрутизаторов доступа используют три агрегированных коммутатора L2.

### <a name="l2-aggregation-switches"></a>Агрегированные коммутаторы L2  
Эти устройства служат точкой агрегирования для трафика L2. Они и есть слоем распространения в структуре L2 и могут обрабатывать большие объемы трафика. Так как эти устройства выполняют статистическое вычисление трафика, то функционал 802.1q является обязательным. Кроме того, используются технологии с высокой пропускной способностью, такие как агрегация портов и 10GE.

### <a name="l2-host-switches"></a>Коммутаторы узла L2
Узлы подключатся непосредственно к этим коммутаторам. Они могут быть установлены в стойку коммутаторов или в развертывание корпуса. Стандарт 802.1q позволяет обозначить одну виртуальную локальную сеть, как встроенную. При этом она будет рассматриваться как обычный (без тегов) компонент Ethernet. В обычных условиях компоненты в собственной виртуальной локальной сети передаются и принимаются без тегов на магистральном порту 802.1q. Эта функция была разработана для миграции на 802.1q и совместима с устройствами, не поддерживающими 802.1q. В этой архитектуре только сетевая инфраструктура использует собственную виртуальную локальную сеть.

Эта архитектура определяет стандарт для выбора собственной виртуальной локальной сети. Этот стандарт гарантирует, что устройства распространения имеют уникальную собственную виртуальную ЛС для каждой магистрали, а также магистрали L2Aggregation — L2Aggregation (где это возможно). Магистрали L2Aggregation — L2Host Switch имеют встроенную виртуальную ЛС не по умолчанию.

### <a name="link-aggregation-8023ad"></a>Объединение каналов связи (802.3ad)
Объединение каналов связи позволяет объединить несколько отдельных каналов связи в пакет и обрабатывать их как единую логическую связь. Чтобы упростить оперативную отладку, необходимо стандартизировать номер, используемый для обозначения интерфейсов канала порта. Остальная часть сети будет использовать этот номер на обоих концах канала порта.

Номера, указанные для коммутатора L2Agg к L2Host, являются номерами канала порта, используемыми на стороне L2Agg. Так как диапазон номеров сильнее ограничен на стороне L2Host, то стандартным является использование номеров 1 и 2 на стороне L2Host, чтобы указать на передачу в паре "канал — порт" со стороны a и b соответственно.

### <a name="vlans"></a>Виртуальные локальные сети
Сетевая архитектура использует виртуальные локальные сети для объединения серверов в одном широковещательном домене. Номера виртуальной локальной сети соответствуют стандартам 802.1q, которые поддерживают виртуальную локальную сеть с номером 1–4094.

### <a name="customer-vlans"></a>Виртуальные локальные сети клиента
Существуют различные варианты реализации виртуальной локальной сети, которые можно развертывать на портале Azure, в соответствии с требованиями к разделению и архитектуре решений. Эти решения развертываются с помощью виртуальных машин. Примеры архитектуры см. в статье [Эталонная архитектура Azure](https://docs.microsoft.com/azure/architecture/reference-architectures/).

### <a name="edge-architecture"></a>Архитектура Edge
Центры обработки данных Azure построен на базе высокоизбыточных и хорошо подготовленных сетевых инфраструктур. Корпорация Майкрософт реализует сети в центрах обработки данных Azure с помощью архитектур избыточности "требуемое количество+1" (N + 1) или более оптимальных. Полные функции отработки отказа внутри и между центрами обработки данных помогают обеспечить доступность сети и службы. Извне центры обработки данных обслуживаются выделенными сетевыми каналами с высокой пропускной способностью. Эти схемы избыточно соединяют свойства с более чем 1200 поставщиками услуг Интернета по всему миру в нескольких точках пиринга. Это обеспечивает пограничную пропускную способность по сети более 2000 Гбит/с.

Фильтрация маршрутизаторов на пограничном уровне и уровне доступа сети Azure обеспечивает надежную защиту на уровне пакетов. Это помогает предотвратить несанкционированные попытки подключения к Azure. Маршрутизаторы помогают убедиться, что фактическое содержимое пакетов — это данные в ожидаемом формате, и что оно соответствует ожидаемой схеме связи между клиентом и сервером. Azure реализует многоуровневую архитектуру, состоящую из следующих компонентов сегрегации сети и контроля доступа:

- **Пограничные маршрутизаторы**. Они используются, чтобы отделить среду приложений от Интернета. Пограничные маршрутизаторы предназначены для обеспечения защиты от спуфинга и ограничения доступа с помощью списков управления доступом (ACL).
- **Маршрутизаторы распространения (доступа).** Они разрешают только одобренные корпорацией Майкрософт IP-адреса, обеспечивают защиту от спуфинга и устанавливают подключения путем использования списка ACL.

### <a name="a10-ddos-mitigation-architecture"></a>Архитектура устранения рисков A10 DDOS
Атаки типа "отказ в обслуживании" продолжают представлять потенциальную угрозу надежности веб-служб. Так как атаки становятся более целенаправленными и сложными, а распространение служб Майкрософт расширяется на глобальном уровне, возможность идентификации и минимизации воздействия этих атак является первоочередной задачей. Ниже приведены сведения о реализации системы устранения рисков A10 DDOS с точки зрения архитектуры сети.

Azure использует сетевые устройства A10 в маршрутизаторе центра обработки данных, которые обеспечивают автоматическое обнаружение и устранение рисков. Решение A10 использует сетевой монитор Azure для выборки потока пакетов и обнаружения атаки. Как только атака обнаружена, устройства A10 используются для устранения рисков. Только после этого чистый трафик доставляется в базу данных Azure непосредственно из DCR. Корпорация Майкрософт использует решение A10 для защиты сетевой инфраструктуры Azure.

Решение A10 для защиты от атак типа "отказ в обслуживании" включает:

- защиту от переполнения UDP IPv4 и IPv6;
- защиту от переполнения ICMP IPv4 и IPv6;
- защиту от переполнения TCP IPv4 и IPv6;
- защиту от атак TCP SYN для IPv4 и IPv6;
- фрагментарные атаки.

> [!NOTE]
> Корпорация Майкрософт предоставляет защиту от атак типа "отказ в обслуживании" по умолчанию для всех клиентов Azure.
>
>

## <a name="network-connection-rules"></a>Правила сетевого подключения
В этой сети Azure развертывает пограничные маршрутизаторы, которые обеспечивают безопасность на уровне пакетов, чтобы предотвратить несанкционированные попытки подключения к Azure. Они гарантируют, что фактическое содержимое пакетов — это данные в ожидаемом формате, и что оно соответствует ожидаемой схеме связи между клиентом и сервером.

Пограничные маршрутизаторы используются, чтобы отделить среду приложений от Интернета. Эти маршрутизаторы предназначены для обеспечения защиты от спуфинга и ограничения доступа с помощью списков управления доступом (ACL). Корпорация Майкрософт настраивает пограничные маршрутизаторы с помощью подхода с использованием многоуровневого ACL для ограничения сетевых протоколов, которым разрешено передавать данные пограничным маршрутизаторам и маршрутизаторам доступа.

Корпорация Майкрософт размещает сетевые устройства в местах доступа и в пограничных расположениях. Они выступают в качестве граничных точек, в которых применяются фильтры входящего и исходящего трафика.

## <a name="next-steps"></a>Дополнительная информация
Дополнительные сведения о действиях корпорации Майкрософт для защиты инфраструктуры Azure приведены в следующих статьях:

- [Объекты, локальная среда и физическая безопасность в Azure](azure-physical-security.md)
- [Доступность инфраструктуры Azure](azure-infrastructure-availability.md)
- [Компоненты и границы информационной системы Azure](azure-infrastructure-components.md)
- [Рабочая сеть Azure](azure-production-network.md)
- [Возможности безопасности Базы данных SQL Azure](azure-infrastructure-sql.md)
- [Операции и управление в рабочей среде Azure](azure-infrastructure-operations.md)
- [Мониторинг инфраструктуры Azure](azure-infrastructure-monitoring.md)
- [Целостность инфраструктуры Azure](azure-infrastructure-integrity.md)
- [Защита данных клиентов в Azure](azure-protection-of-customer-data.md)

<!--Image references-->
[1]: ./media/azure-infrastructure-network/network-arch.png
