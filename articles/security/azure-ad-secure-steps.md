---
title: Пять шагов по защите инфраструктуры удостоверений в Azure Active Directory
description: В этом документе приводится список важных действий, которые должны выполнить администраторы, чтобы обеспечить безопасность организации с помощью возможностей Azure AD.
services: active-directory
author: martincoetzer
manager: manmeetb
tags: azuread
ms.service: active-directory
ms.topic: conceptual
ms.workload: identity
ms.date: 06/18/2018
ms.author: martincoetzer
ms.openlocfilehash: 2a6c94d902c639a2529e501347876d63a3f56d7e
ms.sourcegitcommit: 9222063a6a44d4414720560a1265ee935c73f49e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2018
ms.locfileid: "39505615"
---
# <a name="five-steps-to-securing-your-identity-infrastructure"></a>Пять шагов по защите инфраструктуры удостоверений

Если вы читаете этот документ, значит вы понимаете значимость безопасности. Скорее всего, вы уже несете ответственность за обеспечение безопасности вашей организации. Если вам нужно убедить других пользователей в важности защиты, посоветуйте им прочитать последний [отчет Microsoft Security Intelligence](https://www.microsoft.com/security/intelligence-report).

Этот документ поможет вам достичь более высокого уровня безопасности с помощью возможностей Azure Active Directory и контрольного списка из пяти шагов, предназначенных для защиты организации от кибератак.

Этот контрольный список поможет вам быстро выполнить важные рекомендуемые действия для защиты вашей организации, так как в нем объясняется, как реализовать следующие задачи.

* Укрепление учетных данных
* Уменьшение контактной зоны
* Автоматизация реагирования на угрозы
* Повышение уровня осведомленности об аудите и мониторинге
* Обеспечение более предсказуемой и полной безопасности конечных пользователей с возможностью самостоятельного решения вопросов

> [!NOTE]
> Многие рекомендации, приведенные в этом документе, применяются только к приложениям, которые настроены для использования Azure Active Directory в качестве поставщика удостоверений. Настроив приложения для единого входа, вы получите преимущества политик учетных данных, обнаружения угроз, аудита, ведения журналов, а также другие возможности, добавляемые в приложения. Основой всех приведенных рекомендаций является [единый вход через Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-enterprise-apps-manage-sso).

## <a name="before-you-begin-protect-privileged-accounts-with-mfa"></a>Перед началом работы: защита привилегированных учетных записей с помощью многофакторной идентификации

Перед выполнением задач в этом контрольном списке убедитесь, что во время чтения этого списка ваша безопасность не пострадает. Сначала необходимо защитить привилегированные учетные записи.

Злоумышленники, получившие доступ к привилегированным учетным записям, могут причинить значительный ущерб, поэтому очень важно в первую очередь защитить именно эти учетные записи. Включите и требуйте [многофакторную идентификацию Azure](https://docs.microsoft.com/azure/multi-factor-authentication/multi-factor-authentication) (MFA) для всех администраторов в организации, использующих [базовую защиту](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-baseline-protection). Если вы еще не реализовали многофакторную идентификацию, сделайте это сейчас! Это очень важно.

Все сделано? Начнем работу по контрольному списку.

## <a name="step-1---strengthen-your-credentials"></a>Шаг 1. Укрепление учетных данных 

Причиной большинства нарушений системы безопасности организации является несанкционированный доступ к учетным записям с помощью одного из множества методов, таких как распыление паролей, воспроизведение угрозы или фишинг. Дополнительные сведения об этих атаках см. в этом видео:
> [!VIDEO https://channel9.msdn.com/events/Ignite/Microsoft-Ignite-Orlando-2017/BRK3016/player]

Если пользователи в вашей системе удостоверений используют ненадежные пароли и не усиливают их с помощью многофакторной идентификации, вопрос не в вероятности или времени нарушения безопасности, а в ее частоте.

### <a name="make-sure-your-organization-use-strong-authentication"></a>В организации должна действовать строгая проверка подлинности.

Принимая во внимание частоту подбора, фишинга, кражи паролей вредоносными программами или повторное использование паролей, крайне важно защитить пароли с помощью надежных учетных данных определенного вида — [узнайте больше о многофакторной идентификации Azure](https://docs.microsoft.com/azure/multi-factor-authentication/multi-factor-authentication).

### <a name="turn-off-traditional-complexity-expiration-rules-and-start-banning-commonly-attacked-passwords-instead"></a>Отказ от традиционных требований к сложности, отключение правил истечения срока действия и применение запрета к часто атакуемым паролям

Во многих организациях используются традиционные требования к сложности (например, использование специальных символов) и правила истечения срока действия пароля. Исследование корпорации Майкрософт показало, что эти политики опасны тем, что вынуждают пользователей выбирать легко подбираемые пароли.

Далее приводятся три подлежащие реализации рекомендации корпорации Майкрософт, соответствующие [руководству NIST](https://pages.nist.gov/800-63-3/sp800-63b.html).

1. Длина паролей должна быть не менее 8 символов. Больше не значит лучше, так как в противном случае пользователи будут выбирать прогнозируемые пароли, сохранять пароли в файлах или записывать их.
2. Следует отключить правила истечения срока действия, на основе которых пользователи могут создавать легко угадываемые пароли, такие как **Summer2018!**.
3. Следует отключить требования к составным символам и запретить пользователям выбирать часто атакуемые пароли, так как возникает вероятность прогнозируемых замен символов в паролях.

При создании удостоверений непосредственно в Azure AD воспользуйтесь [PowerShell для предотвращения истечения срока действия паролей](https://docs.microsoft.com/azure/active-directory/authentication/concept-sspr-policy). Организации, применяющие локальные службы AD с Azure AD Connect для синхронизации удостоверений с Azure AD (также называемые гибридным развертыванием), должны внедрить локальные [интеллектуальные политики паролей](https://aka.ms/passwordguidance) с помощью [параметров групповой политики домена](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/hh994572(v%3dws.10)) или [Windows PowerShell](https://docs.microsoft.com/powershell/module/addsadministration/set-addefaultdomainpasswordpolicy).

Функция [динамического запрещенного пароля](https://docs.microsoft.com/azure/active-directory/active-directory-secure-passwords) в Azure Active Directory использует текущее поведение злоумышленника, чтобы запретить пользователям задавать легко угадываемые пароли. Эта возможность всегда включена, поэтому организации с гибридным развертыванием могут воспользоваться преимуществами этой функции, включив [обратную запись паролей](https://docs.microsoft.com/azure/active-directory/authentication/howto-sspr-writeback), или же они могут развернуть [защиту паролем в Azure AD для Windows Server Active Directory](https://docs.microsoft.com/azure/active-directory/authentication/concept-password-ban-bad-on-premises). Защита паролем Azure AD не позволяет выбирать простые пароли в целом и пользовательские пароли, которые можно настроить.

### <a name="protect-against-leaked-credentials-and-add-resilience-against-outages"></a>Защита от утечки учетных данных и добавление устойчивости к сбоям

Если организация использует гибридное решение для удостоверений, необходимо включить синхронизацию хэшей паролей по следующим двум причинам.

* Отчет [Пользователи с украденными учетными данными](https://docs.microsoft.com/azure/active-directory/active-directory-reporting-risk-events) в службе управления Azure AD предупреждает о парах "имя пользователя-пароль", которые были раскрыты в так называемом "темном Интернете". Невероятное количество паролей пропадает в результате фишинга, применения вредоносного ПО и повторного использования паролей на сайтах сторонних производителей, которые через какое-то время подвергаются угрозам. Корпорация Майкрософт находит многие из украденных учетных данных и сообщает о них в этом отчете, если обнаруженные сведения совпадают с учетными данными в вашей организации, но только если вы [включите синхронизацию хэшей паролей](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnectsync-implement-password-hash-synchronization)!
* В случае сбоя в локальной среде (например, при атаке программы-шантажиста) вы сможете перейти на [проверку подлинности в облаке, выполнив синхронизацию хэшей паролей](https://docs.microsoft.com/azure/security/azure-ad-choose-authn). Этот резервный метод проверки подлинности позволит продолжать обращаться к приложениям (включая Office 365), настроенным для проверки подлинности в Azure Active Directory.

Узнайте больше о том, [как работает синхронизация хэшей паролей](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnectsync-implement-password-hash-synchronization).

### <a name="implement-ad-fs-extranet-lockout"></a>Реализация блокировки экстрасети служб федерации Active Directory

Организации, настраивающие приложения для проверки подлинности непосредственно в Azure AD, пользуются [интеллектуальной блокировкой Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-secure-passwords). Если вы используете AD FS в Windows Server 2012 R2, реализуйте [защиту блокировки экстрасетей](https://docs.microsoft.com/windows-server/identity/ad-fs/operations/configure-ad-fs-extranet-soft-lockout-protection) в AD FS. Если же AD FS используется в Windows Server 2016, реализуйте [смарт-блокировку экстрасетей](https://support.microsoft.com/en-us/help/4096478/extranet-smart-lockout-feature-in-windows-server-2016). Смарт-блокировка экстрасетей для AD FS обеспечивает защиту от атак методом подбора, направленных на AD FS, и в то же время не позволяет блокировать пользователей в Active Directory.

### <a name="take-advantage-of-intrinsically-secure-easier-to-use-credentials"></a>Использование преимуществ безопасных по сути и простых в применении учетных данных

С помощью [Windows Hello](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-identity-verification) можно заменить пароли на строгую двухфакторную проверку подлинности на мобильных устройствах и компьютерах. Эта проверка состоит из нового типа учетных данных пользователя, которые привязываются к устройству, и использует биометрические данные или ПИН-код.

## <a name="step-2---reduce-your-attack-surface"></a>Шаг 2. Уменьшение контактной зоны

Учитывая широкое распространение компрометации паролей, решающее значение имеет минимизация контактной зоны для атаки. Это можно сделать путем отказа от использования устаревших и менее безопасных протоколов, ограничения доступа к точкам входа и более серьезного управления административным доступом к ресурсам.

### <a name="block-legacy-authentication"></a>Блокировка устаревших методов проверки подлинности

Еще одним фактором риска для организаций являются приложения, использующие собственные устаревшие методы для проверки подлинности в Azure AD и доступа к корпоративным данным. В их число входят клиенты SMTP, POP3 и IMAP4. Устаревшие приложения проверки подлинности выполняют проверку от имени пользователя и блокируют Azure AD от проведения дополнительной оценки безопасности. Альтернативные современные варианты позволяют снизить риск угрозы безопасности, так как они поддерживают многофакторную идентификацию и условный доступ. Мы рекомендуем следующие три действия:

1. Блокировка [устаревшей проверки подлинности (если используются службы AD FS)](https://docs.microsoft.com/windows-server/identity/ad-fs/operations/access-control-policies-w2k12).
2. Настройка [SharePoint Online и Exchange Online для использования современных способов проверки подлинности](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-no-modern-authentication).
3. Использование [политик условного доступа для блокировки устаревших видов проверки подлинности](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-conditions#legacy-authentication).

### <a name="block-invalid-authentication-entry-points"></a>Блокировка недопустимых точек входа для проверки подлинности

Используя концепцию предполагаемого нарушения, вы должны уменьшить влияние скомпрометированных учетных данных, когда таковые появятся. Для каждого приложения в вашей среде рассмотрите применимые варианты использования: какие группы, сети, устройства и другие элементы следует авторизовать, а затем заблокируйте остальные. Будьте внимательны при ограничении использования [высоко привилегированных учетных данных или учетных данных служб](https://docs.microsoft.com/azure/active-directory/admin-roles-best-practices). С помощью [условного доступа Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-azure-portal) вы можете контролировать доступ авторизованных пользователей к приложениям и ресурсам на основе конкретных определенных вами условий.

Обратите особое внимание на учетные записи служб (учетные записи, используемые для выполнения задач в автоматическом режиме). С помощью условного доступа эти учетные записи можно настроить так, чтобы они использовали службу, получая доступ только с соответствующих IP-адресов и только в указанное время дня.

### <a name="implement-azure-ad-privileged-identity-management"></a>Реализация Azure AD Privileged Identity Management

Другое влияние "предполагаемого нарушения" заключается в сведении к минимуму вероятности того, что скомпрометированная учетная запись может работать с привилегированной ролью. 

[Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/azure/active-directory/active-directory-privileged-identity-management-configure) помогает минимизировать привилегии учетной записи за счет следующих действий:

* идентификация пользователей с назначенными административными ролями и управление ими;
* определение ролей с неиспользуемыми или избыточными привилегиями, которые следует удалить;
* установка правил для защиты привилегированных ролей с помощью многофакторной идентификации;
* установка правил, предусматривающих действие привилегированных ролей в течение периода выполнения привилегированной задачи.

Включите Azure AD PIM, просмотрите пользователей, которым назначены административные роли, и удалите ненужные учетные записи в этих ролях. Остальных привилегированных пользователей переместите из категории имеющих постоянные привилегии в категорию с возможностью получения привилегий. Наконец, установите соответствующие политики, согласно которым при возникновении необходимости доступ к привилегированным ролям осуществляется в безопасном режиме.

В ходе развертывания привилегированной учетной записи следуйте [рекомендации по созданию как минимум двух экстренных учетных записей](https://docs.microsoft.com/azure/active-directory/admin-roles-best-practices), чтобы сохранить права доступа к Azure AD в случае самоблокировки.

## <a name="step-3---automate-threat-response"></a>Шаг 3. Автоматизация реагирования на угрозы

В состав Azure Active Directory входит целый ряд возможностей, которые автоматически перехватывают атаки, чтобы исключить задержку между обнаружением и реагированием. Сократив время внедрения злоумышленников в среду, можно уменьшить расходы и риски. Ниже приведены рекомендуемые к выполнению конкретные действия.

### <a name="implement-user-risk-security-policy-using-azure-ad-identity-protection"></a>Реализация политики безопасности для риска пользователя с помощью защиты идентификации Azure AD

Риск пользователя означает вероятность компрометации удостоверения пользователя и вычисляется на основе [событий риска пользователя](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection), которые связаны с удостоверением пользователя. Политика риска пользователя — это политика условного доступа, которая оценивает уровень риска для конкретного пользователя или группы. На основании низкого, среднего и высокого уровней риска можно настроить политику для блокировки доступа или требования изменить надежный пароль с помощью многофакторной идентификации. Корпорация Майкрософт рекомендует требовать изменения надежного пароля для пользователей с высоким уровнем риска.

![Пользователи, помеченные для события риска](media/azure-ad/azure-ad-sec-steps1.png)

### <a name="implement-sign-in-risk-policy-using-azure-ad-identity-protection"></a>Реализация политики риска при входе с помощью защиты идентификации Azure AD

Риск при входе представляет собой вероятность попытки входа с использованием удостоверения, предпринимаемой кем-то другим, но не владельцем учетной записи. [Политика риска при входе в систему](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection) — это политика условного доступа, которая оценивает уровень риска для конкретного пользователя или группы. На основе уровня риска (высокий, средний, низкий) можно настроить политику для блокировки доступа или принудительного выполнения многофакторной идентификации. Многофакторную идентификацию необходимо применять при входах с уровнем риска "Средний" или выше.

![Вход с анонимных IP-адресов](media/azure-ad/azure-ad-sec-steps2.png)

## <a name="step-4---increase-your-awareness"></a>Шаг 4. Повышение уровня осведомленности

Аудит и ведение журнала событий безопасности и связанные с ними оповещения являются важными составляющими эффективной стратегии защиты. Отчеты и журналы безопасности обеспечивают электронную запись подозрительных действий и помогают выявлять закономерности, которые могут свидетельствовать об успешной или неудачной попытке проникнуть в сеть извне, а также о внутренних атаках. Аудит можно использовать для отслеживания действий пользователей, соблюдения требований нормативных документов, выполнения экспертизы и многого другого. Оповещения содержат уведомления о событиях безопасности.

### <a name="monitor-azure-ad"></a>Мониторинг Azure AD

Службы и компоненты Microsoft Azure дают возможность настраивать параметры аудита и ведения журнала безопасности. Это поможет выявить недочеты в политиках и механизмах безопасности и устранить эти недочеты для предотвращения нарушений. Можно использовать функции [аудита и ведения журналов Azure](https://docs.microsoft.com/azure/security/azure-log-audit) и [отчеты о действиях аудита на портале Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-reporting-activity-audit-logs).

### <a name="monitor-azure-ad-connect-health-in-hybrid-environments"></a>Мониторинг Azure AD Connect Health в гибридных средах

[Мониторинг ADFS с помощью Azure AD Connect Health](https://docs.microsoft.com/azure/active-directory/connect-health/active-directory-aadconnect-health-adfs) дает более полное представление о потенциальных проблемах и обнаружении атак в существующей инфраструктуре ADFS. Служба Azure AD Connect Health выводит оповещения с подробными сведениями, шагами по устранению проблем и ссылками на соответствующую документацию, предоставляет аналитику использования для ряда показателей, связанных с трафиком проверки подлинности аутентификации, обеспечивает мониторинг производительности и формирование отчетов.

![Azure AD Connect Health,](media/azure-ad/azure-ad-sec-steps4.png)

### <a name="monitor-azure-ad-identity-protection-events"></a>Мониторинг событий защиты идентификации Azure AD

[Защита идентификации Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection) — это средство уведомления, мониторинга и отчетности, которое можно использовать для обнаружения потенциальных уязвимостей, влияющих на удостоверения вашей организации. Оно обнаруживает события риска, такие как потерянные учетные данные, невозможное перемещение, попытки входа с зараженных устройств, анонимных IP-адресов, IP-адресов, связанных с подозрительной активностью, и из неизвестных расположений. Включите оповещения с уведомлениями для получения сообщений от пользователей, подверженных риску, и (или) сообщение электронной почты еженедельного дайджеста.

![Пользователи, помеченные для события риска](media/azure-ad/azure-ad-sec-steps3.png)

## <a name="step-5---enable-end-user-self-help"></a>Шаг 5. Включение возможности самостоятельного решения вопросов для конечных пользователей

Вы захотите максимально сбалансировать безопасность с производительностью. Придерживаясь мысли о формировании основы для безопасности в долгосрочной перспективе, вы можете устранить разногласия в своей организации, предоставив пользователям широкие возможности работы с одновременным сохранением бдительности. 

### <a name="implement-self-service-password-reset"></a>Реализация самостоятельного сброса пароля

С помощью системы [самостоятельного сброса пароля (SSPR)](https://docs.microsoft.com/azure/active-directory/active-directory-passwords-getting-started) Azure ИТ-администраторы могут разрешить пользователям самостоятельно сбрасывать или разблокировывать пароли и учетные записи. Эта система предоставляет подробные отчеты, которые позволяют отслеживать доступ к ней, а также создает уведомления в случае несанкционированного использования или применения не по назначению. 

### <a name="implement-self-service-group-management"></a>Реализация самостоятельного управления группами

Azure AD предоставляет возможность управлять доступом к ресурсам с помощью групп безопасности и групп Office 365. Вместо ИТ-администраторов управлять этими группами могут владельцы групп. Эта функция, известная как [самостоятельное управление группами](https://docs.microsoft.com/azure/active-directory/active-directory-accessmanagement-self-service-group-management), позволяет владельцам групп, которым не назначена роль администратора, создавать группы и управлять ими без обращения к администраторам для обработки запросов.

### <a name="implement-azure-ad-access-reviews"></a>Реализация проверок доступа Azure AD

С помощью [проверок доступа Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-azure-ad-controls-access-reviews-overview) можно управлять членством в группах, доступом к корпоративным приложениям и назначениями привилегированных ролей, чтобы поддерживать стандарт безопасности, согласно которому пользователи не получают прав доступа в течение длительных периодов, когда доступ им не нужен.

## <a name="summary"></a>Сводка

Существует множество аспектов, касающихся обеспечения безопасности инфраструктуры удостоверений, но приведенные в этом контрольном списке пять шагов помогут вам быстро сформировать более защищенную и надежную инфраструктуру.

* Укрепление учетных данных
* Уменьшение контактной зоны
* Автоматизация реагирования на угрозы
* Повышение уровня осведомленности об аудите и мониторинге
* Обеспечение более предсказуемой и полной безопасности конечных пользователей с возможностью самостоятельного решения вопросов

Мы ценим то, насколько серьезно вы относитесь к вопросам безопасности удостоверений, и надеемся, что этот документ будет полезен при разработке стратегии для защиты вашей организации.

## <a name="next-steps"></a>Дополнительная информация
Если вам нужна помощь по планированию и развертыванию рекомендаций, см. [планы развертывания проектов Azure AD](http://aka.ms/deploymentplans).
