---
title: "Рекомендации по обеспечению безопасности виртуальных машин Azure | Документация Майкрософт"
description: "В этой статье представлены рекомендации по обеспечению безопасности виртуальных машин, размещенных в Azure."
services: security
documentationcenter: na
author: YuriDio
manager: mbaldwin
editor: 
ms.assetid: 5e757abe-16f6-41d5-b1be-e647100036d8
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/02/2017
ms.author: yurid
translationtype: Human Translation
ms.sourcegitcommit: cea53acc33347b9e6178645f225770936788f807
ms.openlocfilehash: d6c5ea3e44b6121377d7d51f2bb9c878f9f933c5
ms.lasthandoff: 03/03/2017


---
# <a name="azure-virtual-machine-security-best-practices"></a>Рекомендации по обеспечению безопасности виртуальных машин Azure

В большинстве сценариев IaaS (инфраструктура как услуга) [виртуальные машины](https://docs.microsoft.com/en-us/azure/virtual-machines/) являются основной рабочей нагрузкой для организаций, использующих облачные вычисления. Такая ситуация преобладает в [гибридных сценариях](https://social.technet.microsoft.com/wiki/contents/articles/18120.hybrid-cloud-infrastructure-design-considerations.aspx), где организациям требуется медленно перенести рабочие нагрузки в облако. Необходимо следовать [общим рекомендациям по обеспечению безопасности для сценария IaaS](https://social.technet.microsoft.com/wiki/contents/articles/3808.security-considerations-for-infrastructure-as-a-service-iaas.aspx), а также обеспечить применение соответствующих рекомендаций в отношении всех виртуальным машин, размещенных в Azure.

В этой статье мы рассмотрим набор рекомендаций по обеспечению безопасности виртуальных машин Azure. Эти рекомендации основаны на нашем опыте, полученном в процессе использования виртуальных машин Azure, и на отзывах других пользователей. 

Для каждой рекомендации будет предоставлено объяснение следующих аспектов:

- суть рекомендации;
- почему необходимо применять эту рекомендацию;
- что может случиться, если не применить эту рекомендацию;
- возможные альтернативы рекомендации;
- как научиться применять эту рекомендацию.

В этой статье изложено общепринятое мнение по рассматриваемому вопросу, а также представлены возможности и компоненты платформы Azure, доступные на момент ее написания. Со временем мнения и технологии меняются. Поэтому эта статья будет постоянно обновляться, чтобы отражать эти изменения.

Здесь рассматриваются следующие рекомендации по обеспечению безопасности виртуальных машин Azure:

- аутентификация и управление доступом к виртуальным машинам;
- доступность виртуальных машин и их доступ к сети;
- защита неактивных данных, хранящихся на виртуальных машинах Azure, с применением шифрования;
- управление обновлениями виртуальных машин;
- управление состоянием безопасности виртуальных машин;
- мониторинг производительности виртуальных машин.

## <a name="virtual-machine-authentication-and-access-control"></a>Аутентификация и управление доступом к виртуальным машинам

Для защиты виртуальной машины в первую очередь необходимо обеспечить, чтобы возможность подготовки новых виртуальных машин была только у авторизованных пользователей. Для настройки определенных соглашений для ресурсов в организации можно использовать [политики Resource Manager](../azure-resource-manager/resource-manager-policy.md) или создавать настраиваемые политики и применять их к ресурсам, например к [группе ресурсов](../azure-resource-manager/resource-group-overview.md). Виртуальные машины, принадлежащие к такой группе ресурсов, унаследуют эти политики. Это рекомендуемый подход для управления ресурсами (включая виртуальные машины), которые имеют различные потребности и находятся в разных группах ресурсов. Но вы также можете управлять индивидуальным доступом к виртуальным машинам, используя [управление доступом на основе ролей (RBAC)](../active-directory/role-based-access-control-configure.md).

Применение политик Azure Resource Manager и RBAC для управления доступом к виртуальной машине, повышает общую безопасность виртуальной машины. Такой подход рекомендован для тесно связанных виртуальных машин с одинаковым жизненным циклом в одной группе ресурсов. Группы ресурсов позволяют развертывать и отслеживать несколько ресурсов как единое целое, а также консолидировать счета по группам ресурсов. Используйте принцип [предоставления минимальных прав](https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models), разрешая пользователям доступ к подготовке виртуальных машин, а при назначении пользователям привилегий создайте план использования следующих встроенных ролей в Azure:

- [Участник виртуальных машин](../active-directory/role-based-access-built-in-roles.md#virtual-machine-contributor) — может управлять виртуальными машинами, но не виртуальными сетями и учетными записями хранения, к которым они подключены.
- [Участник классических виртуальных машин](../active-directory/role-based-access-built-in-roles.md#classic-virtual-machine-contributor) — может управлять классическими виртуальными машинами, но не виртуальными сетями и учетными записями хранения, к которым они подключены.
- [Диспетчер безопасности](../active-directory/role-based-access-built-in-roles.md#security-manager) — может управлять компонентами безопасности, политиками безопасности и виртуальными машинами.
- [Пользователь DevTest Labs](../active-directory/role-based-access-built-in-roles.md#devtest-labs-user) — может просматривать все, а также подключать, запускать, перезагружать виртуальные машины и завершать их работу.

Не предоставляйте администраторам одни и те же учетные записи и пароли, не используйте пароли повторно для нескольких учетных записей или служб, особенно тех записей, которые служат для доступа к социальным сетям или выполнения других действий, не связанных c администрированием. В идеале для безопасной подготовки виртуальных машин следует использовать шаблоны [Azure Resource Manager](../azure-resource-manager/resource-group-authoring-templates.md). С помощью такого подхода можно ограничить выбор вариантов развертывания и принудительно применить к развертыванию параметры безопасности.

Если организация не применяет для управления доступом к данным такие возможности, как RBAC, то пользователям будет предоставлено больше полномочий, чем необходимо для выполнения назначенных им задач. Это может привести к компрометации данных, так как пользователи смогут получить доступ к такому уровню данных, который не должен быть им доступен.
 

## <a name="virtual-machine-availability-and-network-access"></a>Доступность виртуальных машин и их доступ к сети

Если на виртуальной машине выполняются критически важные приложения, которым требуется высокий уровень доступности, то настоятельно рекомендуется использовать несколько виртуальных машин.  Для повышения уровня доступности создайте в [группе доступности](../virtual-machines/virtual-machines-windows-infrastructure-availability-sets-guidelines.md) не менее двух виртуальных машин. Для [подсистемы балансировки нагрузки](../load-balancer/load-balancer-overview.md) Azure также требуется, чтобы виртуальные машины с балансировкой нагрузки входили в одну группу доступности. Если к этим виртуальным машинам требуется доступ из Интернета, то необходимо настроить [подсистему балансировки нагрузки для Интернета](../load-balancer/load-balancer-internet-overview.md).

Когда виртуальные машины доступны через Интернет, важно, чтобы [поток сетевого трафика контролировался с помощью групп безопасности сети](../virtual-network/virtual-networks-nsg.md).  Так как группы NSG могут применяться к подсетям, можно свести к минимуму количество групп NSG. Для этого ресурсы следует сгруппировать по подсетям и применить к подсетям группы NSG. Цель состоит в том, чтобы создать уровень сетевой изоляции, а в Azure это достигается за счет правильной настройки соответствующих функций [безопасности сети](../best-practices-network-security.md).  

Вы также можете использовать функцию своевременного доступа к виртуальной машине из центра безопасности Azure, чтобы управлять тем, кто и на какой срок будет иметь удаленный доступ к определенной виртуальной машине. Просмотрите следующий видеоролик, чтобы узнать больше об использовании этой функции:


<iframe src="https://channel9.msdn.com/Blogs/Azure-Security-Videos/Azure-Security-Center-Just-in-Time-VM-Access/player" width="960" height="540" allowFullScreen frameBorder="0"></iframe>

Организации, которые не применяют ограничения доступа к сети для виртуальных машин, доступных через Интернет, подвержены рискам для системы безопасности, таким как атака методом подбора с применением протокола удаленного рабочего стола. 

## <a name="protect-data-at-rest-in-azure-vms-by-enforcing-encryption"></a>Защита неактивных данных, хранящихся на виртуальных машинах Azure, с применением шифрования

В настоящее время [шифрование неактивных данных](https://blogs.microsoft.com/cybertrust/2015/09/10/cloud-security-controls-series-encrypting-data-at-rest/) является обязательным шагом для защиты данных, соблюдения стандартов и обеспечения конфиденциальности данных. [Шифрование дисков Azure](../security/azure-security-disk-encryption.md) позволяет ИТ-администраторам шифровать диски виртуальных машин IaaS под управлением Windows и Linux. Для этого в Azure используются стандартные для отрасли функции (BitLocker для Windows и DM-Crypt для Linux), которые обеспечивают шифрование томов системных дисков и дисков данных.

Шифрование диска Azure можно использовать для защиты данных в соответствии с применяемыми требованиями к безопасности и стандартами. Также с помощью шифрования организации могут снизить риски, связанные с неавторизованным доступом к данным. Мы рекомендуем зашифровывать диски, прежде чем записывать на них конфиденциальные данные. 

Обязательно зашифруйте тома данных виртуальных машин, чтобы защитить неактивные тома данных в учетной записи хранения Azure. Защитите ключи шифрования и секреты с помощью [Azure Key Vault](https://azure.microsoft.com/en-us/documentation/articles/key-vault-whatis/). 

Если организация не применяет шифрование данных, повышается уязвимость к утрате целостности данных, например к краже информации злоумышленниками или недобросовестными пользователями, а также к получению доступа к незашифрованным данным неуполномоченными лицами с использованием скомпрометированных учетных записей. Помимо снижения этих рисков шифрование позволяет компаниям соблюдать отраслевые стандарты, используя надлежащие средства защиты данных.

Дополнительные сведения о шифровании дисков Azure см. в статье [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](azure-security-disk-encryption.md).


## <a name="manage-virtual-machine-updates"></a>Управление обновлениями виртуальных машин

Azure не передает обновления Windows на виртуальные машины Azure под управлением Windows, так как предполагается, что управление этими машинами осуществляется пользователем. Такой же подход применяется к любому локальному компьютеру. При этом пользователям рекомендуется оставить включенной функцию автоматического обновления в Центре обновления Windows. Другой вариант — развернуть на другой виртуальной машине Azure или локально сервер [служб Windows Server Update Services (WSUS)](https://technet.microsoft.com/windowsserver/bb332157.aspx) или другой подходящий продукт для управления обновлениями. Как WSUS, так и Центр обновления Windows обеспечивают актуальность виртуальных машин. Также рекомендуется использовать продукт, выполняющий сканирование и следящий за актуальностью всех виртуальных машин IaaS.

Готовые образы, предоставляемые Azure, регулярно обновляются и включают в себя все последние обновления Windows. Однако нет никакой гарантии, что на момент развертывания образы будут актуальны. Возможна небольшая задержка (не более чем несколько недель) с момента выхода общедоступных выпусков. Проверка наличия и установка всех обновлений Windows должна быть первым шагом при каждом развертывании. Это особенно важно помнить, если вы развертываете собственные образы или образы из своей библиотеки. В образах, предоставляемых в составе коллекции Microsoft Azure, функция автоматического обновления Windows всегда включена по умолчанию.

Организации, которые не применяют политики обновления программного обеспечения, больше подвержены угрозам, связанным с использованием известных уязвимостей (которые уже были устранены). Помимо снижения этих рисков, шифрование позволяет компаниям соблюдать отраслевые стандарты, используя надлежащие средства защиты рабочих нагрузок, размещенных в облаке.
Важно отметить, что рекомендации по обновлениям программного обеспечения в традиционных центрах обработки данных и Azure IaaS во многом сходны, поэтому советуем оценить текущие политики обновления программного обеспечения и добавить в них виртуальные машины Azure.

## <a name="manage-virtual-machine-secure-posture"></a>Управление состоянием безопасности виртуальных машин

Киберугрозы эволюционируют, и для защиты виртуальных машин требуются более широкие возможности мониторинга, способные быстро выявить угрозы, активировать оповещения и сократить число ложных срабатываний. Состояние безопасности для этого типа рабочей нагрузки включает в себя все аспекты безопасности виртуальной машины — от управления обновлениями до безопасного доступа к сети, при этом активно отслеживаются угрозы, пытающиеся получить несанкционированный доступ к ресурсам.

Для мониторинга состояния безопасности виртуальных машин [Windows](../security-center/security-center-virtual-machine.md) и [Linux](../security-center/security-center-linux-virtual-machine.md) можно использовать [центр безопасности Azure](../security-center/security-center-intro.md). Для мониторинга виртуальных машин используйте следующие возможности центра безопасности Azure:

- Соответствие параметров безопасности операционной системы (ОС) рекомендуемым правилам конфигурации.
- Своевременная установка отсутствующих обновлений системы безопасности и критических обновлений.
- Рекомендации по защите конечных точек (защита от вредоносных программ).
- Проверка шифрования диска.
- Оценка уязвимостей и их устранение.
- Обнаружение угроз

Центр безопасности может активно отслеживать угрозы, и эти угрозы будут отображаться в разделе "Оповещения системы безопасности". Коррелированные угрозы будут собраны в одном представлении, которое называется *Инцидент безопасности*. Просмотрите следующее видео, в котором показано, как с помощью центра безопасности выявлять потенциальные угрозы на виртуальных машинах, размещенных в Azure.

<iframe src="https://channel9.msdn.com/Blogs/Azure-Security-Videos/Azure-Security-Center-in-Incident-Response/player" width="960" height="540" allowFullScreen frameBorder="0"></iframe>

Организации, которые не применяют на своих виртуальных машинах управление состоянием безопасности, не знают о возможных попытках обойти установленные средства управления безопасностью.

## <a name="monitoring-virtual-machine-performance"></a>Мониторинг производительности виртуальных машин

Другой проблемой может быть применение ресурсов не по назначению. Например, когда на виртуальной машине выполняются процессы, которые потребляют больше ресурсов, чем положено. Проблемы с производительностью виртуальной машины могут привести к нарушению работы служб, что нарушает один из основных принципов безопасности — доступность. Поэтому крайне важно отслеживать доступ к виртуальным машинам не только в случае возникновения проблем, но и в периоды штатного функционирования.

[Журналы диагностики Azure](https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/) помогают отслеживать ресурсы виртуальной машины и выявлять потенциальные проблемы, негативно влияющие на ее производительность и доступность. Расширение системы диагностики Azure позволяет использовать возможности мониторинга и диагностики в виртуальной машине Azure под управлением Windows. Чтобы использовать эти возможности на виртуальной машине, необходимо включить расширение в [шаблон](../virtual-machines/virtual-machines-windows-extensions-diagnostics-template.md) Azure Resource Manager. Для получения сведений о работоспособности ресурса можно также использовать [Azure Monitor](../monitoring-and-diagnostics/monitoring-overview-metrics.md).

Организации, не выполняющие мониторинг производительности своих виртуальных машин, не смогут определить, являются ли изменения показателей производительности частью их обычного использования или выполняется какая-то аномальная операция, которая потребляет больше ресурсов, чем положено. Аномалия может свидетельствовать о потенциальной атаке, совершаемой с внешнего ресурса, или о скомпрометированном процессе, выполняемом на этой виртуальной машине. 
