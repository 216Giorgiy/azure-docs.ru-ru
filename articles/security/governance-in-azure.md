---
title: Система управления в Azure | Документы Майкрософт
description: Сведения об облачных вычислительных службах, которые можно масштабировать вверх или вниз в соответствии с потребностями вашего приложения или вашей организации.
services: security
documentationcenter: na
author: UnifyCloud
manager: mbaldwin
editor: TomSh
ms.assetid: ''
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/01/2017
ms.author: TomSh
ms.openlocfilehash: 579e900ee6616af8fd197e501364acd8e18d3e37
ms.sourcegitcommit: f606248b31182cc559b21e79778c9397127e54df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2018
ms.locfileid: "38970529"
---
# <a name="governance-in-azure"></a>Система управления в Azure

Azure предоставляет множество решений для обеспечения безопасности, а также возможность управления ими. Это позволяет удовлетворить уникальные требования к развертываниям в вашей организации.

Облачная система управления Azure обращается к процессам принятия решений, условиям и политикам, задействованным в планировании, архитектуре, приобретении, развертывании, функционировании и управлении облачными вычислениями. Облачная система управления Azure предоставляет концепцию интегрированного аудита и консультирования, которая позволяет оценивать использование платформы Azure организациями и давать рекомендации по использованию. 

Чтобы создать план для облачной системы управления Azure, необходимо тщательно изучить пользователей, процессы и технологии, применяемые в вашей организации. Затем можно создать платформы, с помощью которых ИТ-специалисты смогут обеспечить постоянную поддержку бизнес-потребностей и предоставить конечным пользователям возможность гибкого использования функций Azure.

## <a name="implementation-of-policies-processes-and-standards"></a>Реализация политик, процессов и стандартов 

Руководство организации устанавливает роли и обязанности для надзора за реализацией политик информационной безопасности и непрерывности работы в Azure. Управление Azure отвечает за соблюдение методов обеспечения безопасности и непрерывности работы в соответствующих командах (включая третьи стороны). Оно также позволяет обеспечить соответствие политикам, процессам и стандартам безопасности.

### <a name="account-provisioning"></a>"Подготовка учетных записей";

Определение иерархии учетных записей является важнейшим шагом для использования и структурирования служб Azure в организации. Это базовая структура системы управления. Клиенты, у которых есть Соглашение Enterprise, могут дополнительно разделить среду на отделы, учетные записи и подписки.

!["Подготовка учетных записей";](./media/governance-in-azure/security-governance-in-azure-fig1.png)

Если соглашение Enterprise отсутствует, используйте [теги Azure](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-using-tags) на уровне подписки для определения иерархии. Подписка Azure представляет собой базовую единицу, в которой содержатся все ресурсы. Она также определяет некоторые ограничения Azure, в том числе количество ядер и ресурсов. Подписки могут содержать [группы ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview), которые, в свою очередь, могут содержать ресурсы. На этих трех уровнях применяются принципы [управления доступом на основе ролей (RBAC)](https://docs.microsoft.com/azure/role-based-access-control/overview).

Все организации отличаются друг от друга. Для некорпоративных организаций иерархия тегов Azure позволяет обеспечить гибкость в организации ресурсов Azure. Перед развертыванием ресурсов в Azure необходимо создать модель иерархии и понять, как она повлияет на выставление счетов, доступ к ресурсам и сложность.

### <a name="subscription-controls"></a>Элементы управления подписок

Подписка определяет то, как учитывается использование ресурсов и выставляются счета. Вы можете настроить отдельное выставление счетов и оплату в подписках. Одна учетная запись Azure может содержать несколько подписок. Подписки можно использовать для определения использования ресурсов Azure несколькими отделами компании.

Предположим, что в организации есть ИТ-отдел, отдел кадров и отдел маркетинга, в которых выполняются разные проекты. Организация может выставлять счета на основе использования ресурсов Azure, например виртуальных машин в каждом отделе. Так организация сможет управлять финансами каждого отдела.

Подписки Azure устанавливают три параметра:

- Уникальный идентификатор подписчика

- Место выставления счетов

- набор доступных ресурсов.

Для каждого пользователя к этим параметрам относятся один идентификатор учетной записи Майкрософт, номер кредитной карты и полный набор служб Azure. Корпорация Майкрософт применяет ограничения на использование в зависимости от типа подписки.

Иерархии регистрации Azure определяют структуру служб в рамках соглашения Enterprise. Портал Соглашения Enterprise позволяет клиентам разделять доступ к ресурсам Azure, связанным с Cоглашением Enterprise, на основе гибких иерархий, настраиваемых в соответствии с уникальными потребностями организации. Шаблон иерархии должен соответствовать управленческой и географической структуре организации, чтобы обеспечить соответствующее выставление счетов и доступ к ресурсам.

Три шаблона иерархии высокого уровня — функциональный шаблон, бизнес-подразделение и географический шаблон. Отдел представляет собой административную единицу для группировки учетных записей. В каждом отделе учетным записям могут назначаться подписки, которые создают приемники команд для выставления счетов и некоторых ключевых ограничений в Azure (например, количества виртуальных машин и учетных записей хранения).

![Элементы управления подписок](./media/governance-in-azure/security-governance-in-azure-fig2.png)


Для организаций, имеющих соглашение Enterprise, подписки Azure имеют четырехуровневую иерархию:

1. Корпоративный администратор регистрации

2. Администратор отдела

3. Владелец учетной записи

4. Администратор службы

Эта иерархия определяет следующее.

- Отношения выставления счетов.

- Администрирование учетной записи.

- Доступ к ресурсам с помощью RBAC.

- Границы:

  - Потребление и выставление счетов (тарифная карта на основе номеров предложения)

  - Ограничения

  - Виртуальная сеть

- Подключение к Azure Active Directory (Azure AD). Один экземпляр Azure AD может быть связан с несколькими подписками.

- Подключение к учетной записи регистрации Соглашения Enterprise.

### <a name="role-based-access-control"></a>Контроль доступа на основе ролей

[RBAC](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles) обеспечивает детальное управление доступом к ресурсам Azure. С помощью RBAC можно предоставлять пользователям доступ, необходимый только для выполнения поставленных перед ними задач. Организациям следует сосредоточиться на предоставлении сотрудникам именно тех разрешений, которые им необходимы. Слишком большое число разрешений делает учетную запись уязвимой для злоумышленников. Недостаточное число разрешений мешает эффективной работе сотрудников. 

Вместо того, чтобы предоставить всем неограниченные разрешения для подписки Azure или ресурсов, можно разрешить только определенные действия. Например, с помощью RBAC можно разрешить одному сотруднику управлять виртуальными машинами в подписке, а другому — управлять базами данных SQL в той же подписке.

Чтобы предоставить доступ, можно назначить роли пользователям, группам или приложениям в определенной области. Областью назначения роли может быть подписка, группа ресурсов или отдельный ресурс. Роли, назначенной в родительской области, предоставляется доступ также к содержащимся в ней дочерним элементам. Например, пользователь с доступом к группе ресурсов может управлять всеми ресурсами, которые содержит эта группа, включая веб-сайты, виртуальные машины и подсети. В рамках каждой подписки можно назначить до 2000 ролей.

Роль — это совокупность разрешений, и в RBAC есть несколько встроенных ролей. Следующие встроенные роли применяются ко всем типам ресурсов:

- **Владелец** — имеет полный доступ ко всем ресурсам, включая право делегировать доступ другим пользователям.

- **Участник** может создавать все типы ресурсов Azure и управлять ими, но не может предоставлять доступ другим.

- **Читатель** — может просматривать все ресурсы Azure.

Остальные встроенные роли в Azure позволяют управлять определенными ресурсами Azure. Например, роль "Участник виртуальных машин" позволяет пользователю создавать виртуальные машины и управлять ими. Список всех встроенных ролей и операций для этих ролей см. в разделе [Встроенные роли RBAC](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles).

RBAC поддерживает операции управления ресурсами Azure на портале Azure и в API-интерфейсах Azure Resource Manager. В большинстве случаев с помощью RBAC невозможно разрешить доступ к операциям на уровне данных для ресурсов Azure. Сведения о том, как расширить RBAC на операции с данными, см. в разделе [Сведения об определениях ролей](https://docs.microsoft.com/azure/role-based-access-control/role-definitions).

Если встроенные роли не отвечают вашим требованиям к доступу, вы можете создать [пользовательскую роль](https://docs.microsoft.com/azure/role-based-access-control/custom-roles). Пользовательские роли, так же как и встроенные, могут назначаться пользователям, группам и приложениям в рамках подписки, группы ресурсов или области ресурсов. Пользовательские роли можно создавать с помощью [Azure PowerShell](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-powershell), [Azure CLI](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-cli) и [REST API](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-rest).

### <a name="resource-management"></a>Управление ресурсами

Сейчас в Azure доступны два режима развертывания: [классический](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-deployment-model) и Resource Manager.

В классической модели ресурсы существуют независимо друг от друга. В этой модели вы не можете группировать связанные ресурсы. Вам необходимо вручную отслеживать ресурсы, которые используются для создания решения или приложения, и координированно управлять ими. Базовой единицей управления является подписка. Разбить ресурсы в рамках одной подписки на группы трудно, что приводит к созданию большого числа подписок.

В модели развертывания Resource Manager используется понятие [группы ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview). Группа ресурсов — это контейнер для ресурсов с общим жизненным циклом. Она может включать все ресурсы приложения или только те ресурсы, которыми необходимо управлять в качестве группы. Кроме того, пользователи могут выбрать оптимальный для своей организации способ распределения ресурсов в группах ресурсов.

Модель развертывания диспетчера ресурсов предоставляет несколько преимуществ.

- Вы можете осуществлять развертывание, управление и мониторинг всех служб вашего решения как единой группы вместо того, чтобы работать с ними по отдельности.

- Вы можете повторно развертывать решение на протяжении всего его жизненного цикла и быть уверенными в том, что ресурсы развертываются в согласованном состоянии.

- Вы можете применять управление доступом ко всем ресурсам в группе ресурсов. Эти политики применяются автоматически при добавлении новых ресурсов в группу ресурсов.

- Для логического упорядочивания всех ресурсов в вашей подписке к ним можно применять теги.

- Для определения инфраструктуры решения можно использовать нотацию объектов JavaScript (JSON). Файл JSON представляет собой шаблон Resource Manager.

- Вы можете определять зависимости между ресурсами, чтобы ресурсы развертывались в правильном порядке.

![Диспетчер ресурсов](./media/governance-in-azure/security-governance-in-azure-fig4.png)

Дополнительные рекомендации по шаблонам см. в статье [Рекомендации по созданию шаблонов Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices).

Azure Resource Manager анализирует зависимости, чтобы обеспечить правильный порядок создания ресурсов. Если один ресурс зависит от параметра другого ресурса (например, виртуальная машина, для которой требуется учетная запись хранения диска), можно [задать зависимость](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-define-dependencies) в шаблоне.

Кроме того, шаблон можно использовать для внесения обновлений в инфраструктуру. Например, можно добавить новый ресурс в решение и правила конфигурации для уже развернутых ресурсов. Если в шаблоне указано создание ресурса, но этот ресурс уже существует, то Resource Manager обновляет этот ресурс, а не создает новый. Resource Manager обновляет существующий ресурс до того же состояния, в котором находился бы новый ресурс.

Resource Manager предоставляет расширения для тех случаев, когда необходимы дополнительные действия, например, установка программного обеспечения, не включенного в программу установки.

### <a name="resource-tracking"></a>Отслеживание ресурсов

По мере того как пользователи в вашей организации добавляют ресурсы в подписку, становится все более важным связать эти ресурсы с соответствующим отделом, клиентом и средой. Вы можете вложить метаданные в ресурсы с помощью [тегов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-using-tags). Теги используются для предоставления сведений о ресурсе или владельце. Теги позволяют не только объединять и группировать ресурсы различными способами, но и использовать эти метаданные для взимания средств за использование.

Используйте теги в том случае, когда у вас есть сложная коллекция ресурсов и групп ресурсов и требуется визуализировать эти ресурсы оптимальным образом. Например, можно пометить тегами ресурсы, которые выполняют в организации одну и ту же роль или относятся к одному отделу.

Без тегов пользователи в организации могут создать несколько ресурсов, которые впоследствии будет трудно идентифицировать. То же касается и управления такими ресурсами. Предположим, что вам требуется удалить все ресурсы для проекта. Если к этим ресурсам не добавлены проектные теги, ресурсы придется искать вручную. Добавление тегов может позволить сократить затраты при работе с подпиской.

Ресурсы с одинаковыми тегами необязательно должны находиться в разных группах ресурсов. Вы можете создать собственную классификацию тегов, чтобы все пользователи в организации использовали одинаковые теги и никто из них не мог случайно указать похожий тег (например, "отдел" вместо "отделение").

Политики ресурсов позволяют создавать стандартные правила для организации. Вы можете создать политики, обеспечивающие добавление к ресурсам тегов с соответствующими значениями.

Ресурсы с тегами можно также просмотреть на портале Azure. В [отчете об использовании](https://docs.microsoft.com/azure/billing/billing-understand-your-bill) вашей подписки содержатся имена тегов и их значения, которые позволяют разделить затраты по тегам.

Дополнительные сведения о тегах см. в статье [Инициатива политики тегов для выставления счетов](../azure-policy/scripts/billing-tags-policy-init.md).

Действительны следующие ограничения для тегов.

- Каждая группа ресурсов может иметь не более 15 пар "ключ — значение" для тегов. Это ограничение применяется только к тегам, которые непосредственно связаны с группой ресурсов или ресурсами. Группа ресурсов может включать разные ресурсы, каждый из которых содержит 15 пар "ключ — значение" для тегов.

- Имя тега ограничено 512 символами.

- Значение тега ограничено 256 символами.

- Теги, примененные к группе ресурсов, не наследуются ресурсами в этой группе.

При наличии более 15 значений, которые нужно связать с ресурсом, используйте строку JSON для значения тега. Строка JSON может содержать много значений, применяемых к одному ключу тега.

#### <a name="tags-for-billing"></a>Теги для выставления счетов

Теги позволяют сгруппировать данные о выставлении счетов. Например, если вы используете несколько виртуальных машин для различных организаций, то с помощью тегов сможете сгруппировать сведения об использовании по месту возникновения затрат. Кроме того, теги можно использовать для классификации затрат по среде выполнения (например, сведения о выставленных счетах за виртуальные машины, запущенные в рабочей среде).

Сведения о тегах можно получить с помощью [интерфейсов API использования ресурсов Azure и RateCard](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview) или файла сведений об использовании с разделителями-запятыми (CSV-файла). Этот файл можно скачать на [портале учетных записей Azure](https://account.windowsazure.com/) или на [портале Соглашения Enterprise](https://ea.azure.com/).

Дополнительные сведения о программном доступе к данным для выставления счетов см. в статье [Получение ценных сведений о потреблении ресурсов Microsoft Azure](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview). Подробнее об операциях REST API см. в [справочнике по REST API для выставления счетов Azure](https://msdn.microsoft.com/library/azure/1ea5b323-54bb-423d-916f-190de96c6a3c).

В скачанном CSV-файле со сведениями об использовании служб, поддерживающих теги выставления счетов, эти теги отображаются в столбце Tags.

### <a name="critical-resource-controls"></a>Управление критическими ресурсами

По мере того как организация добавляет основные службы в подписку, становится все более важным обеспечить доступность этих служб, чтобы избежать простоев в работе. [Блокировки ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-lock-resources) позволяют ограничить операции с ценными ресурсами, изменение или удаление которых оказало бы значительное влияние на приложения или облачную инфраструктуру. Блокировки можно применить к подписке, группе ресурсов или ресурсу. Как правило, блокировки применяются к таким основополагающим ресурсам, как виртуальные сети, шлюзы и учетные записи хранения.

Сейчас блокировки ресурсов поддерживают два значения: **CanNotDelete** и **ReadOnly**. Блокировка **CanNotDelete** означает, что пользователи (с соответствующими правами) могут прочитать или изменить ресурс, но не могут его удалить. Блокировка **ReadOnly** означает, что авторизованные пользователи не могут удалить или изменить ресурс.

Блокировки ресурсов применяются только к операциям, выполняемым в плоскости управления, которая включает в себя операции, передаваемые на <https://management.azure.com>. Эти блокировки не мешают ресурсам осуществлять свои собственные операции. Ограничиваются изменения ресурсов, но не операции с ними. Например, блокировка **ReadOnly** в базе данных SQL не позволит вам удалить или изменить базу данных, но она не мешает создавать, обновлять и удалять данные в базе данных.

Применение уровня блокировки **ReadOnly** (только чтение) может привести к непредвиденным результатам, так как некоторые операции, кажущиеся операциями чтения, требуют дополнительных действий. Например, установка уровня блокировки **ReadOnly** для учетной записи хранения не позволит всем пользователям получить список ключей. Операция получения списка ключей обрабатывается с помощью запроса POST, поскольку возвращаемые ключи могут быть доступны для операций записи.

![Управление критическими ресурсами](./media/governance-in-azure/security-governance-in-azure-fig5.png)

Еще один пример: установка уровня блокировки **ReadOnly** для ресурса службы приложений Azure не позволит обозревателю сервера Visual Studio отображать файлы для ресурса, так как для такого взаимодействия требуется доступ на запись.

В отличие от управления доступом на основе ролей блокировки управления используются для применения ограничения для всех пользователей и ролей. Дополнительные сведения о настройке разрешений см. в разделе [Управление доступом с помощью RBAC и портала Azure](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-portal).

При применении блокировки к родительской области все ресурсы в этой области наследуют ту же блокировку. Даже ресурсы, добавляемые позже, наследуют блокировку от родительского ресурса. Приоритет имеет наиболее строгая блокировка.

Для создания или удаления блокировок управления необходимо иметь доступ к действиям Microsoft.Authorization/ или Microsoft.Authorization/locks/. Из встроенных ролей эти действия предоставляются только владельцу и администратору доступа пользователей.

### <a name="api-access-to-billing-information"></a>Доступ через API к данным для выставления счетов

Используйте API выставления счетов Azure для извлечения данных об использовании и ресурсах в предпочитаемые средства анализа данных. API использования ресурсов и RateCard в Azure позволяют точно прогнозировать расходы и управлять ими. Интерфейсы API реализованы в виде поставщика ресурсов и относятся к семейству API, предоставляемых Azure Resource Manager.

#### <a name="resource-usage-api-preview"></a>API использования ресурсов (предварительная версия)

Применяйте [API использования ресурсов](https://msdn.microsoft.com/library/azure/mt219003) Azure для получения оценочных данных об уровне потребления Azure. API включает в себя следующие функции:

- **Управление доступом на основе ролей**: настройте политики доступа на [портале Azure](https://portal.azure.com/) или с помощью [командлетов Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview), чтобы указать, какие пользователи или приложения могут получить доступ к данным об использовании в рамках подписки. Вызывающие объекты должны использовать стандартные маркеры Azure Active Directory для проверки подлинности. Добавьте вызывающий объект в роль читателя счетов, читателя, владельца или участника, чтобы получить доступ к данным об использовании для конкретной подписки Azure.

- **Агрегирование по часам или по дням**: вызывающие объекты могут указать, требуется ли получать данные об использовании Azure в виде приращений за каждый час или каждый день. По умолчанию используется получение сегментов за каждый день.

- **Метаданные экземпляров, включая теги ресурсов**: сведения уровня экземпляра, например полный URI ресурса (/subscriptions/{идентификатор подписки}/...), информация о группе ресурсов и теги ресурсов. Эти метаданные помогут вам однозначно и программно распределять использование по тегам для таких вариантов использования, как перекрестное выставление счетов.

- **Метаданные ресурсов**: сведения о ресурсах, такие как имя индикатора, категория индикатора, подкатегория индикатора, единица измерения и регион, позволяющие клиентам получить более полное представление о потребленных ресурсах. Мы также работаем над согласованием терминологии метаданных ресурсов между порталом Azure, CSV-файлами со сведениями об использовании Azure, CSV-файлами со сведениями о выставлении счетов для Соглашения Enterprise и другими общедоступными механизмами, чтобы вы могли соотносить данные из различных областей.

- **Использование для всех видов предложений**: данные об использовании доступны для всех видов предложений, таких как оплата по мере использования, MSDN, денежные обязательства, денежный кредит и Соглашение Enterprise.

#### <a name="resource-ratecard-api"></a>API RateCard по ресурсам

Используйте API RateCard по ресурсам Azure для получения списка доступных ресурсов Azure, а также примерной стоимости каждого из них. API включает в себя следующие функции:

- **Управление доступом на основе ролей**: настройте политики доступа на портале Azure или с помощью командлетов Azure PowerShell, чтобы указать, какие пользователи или приложения могут получить доступ к данным RateCard. Вызывающие объекты должны использовать стандартные маркеры Azure Active Directory для проверки подлинности. Добавьте вызывающий объект в роль читателя, владельца или участника, чтобы получить доступ к данным об использовании для конкретной подписки Azure.

- **Поддержка оплаты по мере использования, MSDN, денежных обязательств и денежного кредита (Соглашение Enterprise не поддерживается)**: этот API предоставляет сведения о тарифах Azure на уровне предложений. Вызывающий объект этого API должен передать сведения о предложении, чтобы получить информацию о ресурсах и тарифы. Соглашение Enterprise сейчас не поддерживается, так как для предложений Соглашения Enterprise действуют специальные тарифы для каждой регистрации. 

#### <a name="scenarios"></a>Сценарии

Сочетание API использования и RateCard позволяет выполнить следующие сценарии:

- **Затраты на Azure в течение месяца**: используйте сочетание API использования и RateCard, чтобы получить более ценные сведения о расходах на облако в течение месяца. Вы можете анализировать данные оценки использования и затрат за каждый час или за каждый день.

- **Настройка оповещений**: API использования и RateCard можно использовать для получения оценочных показателей потребления облака и издержек, а также настройки оповещений на основе ресурсов или денежных средств.

- **Прогнозирование счета**: получите оценочные показатели потребления и расходов на облако и примените алгоритмы машинного обучения, чтобы спрогнозировать сумму счета в конце цикла выставления счетов.

- **Анализ затрат до потребления**: используйте API RateCard, чтобы спрогнозировать размер счета для ожидаемого использования в случае переноса рабочих нагрузок в Azure. При наличии имеющихся рабочих нагрузок в других облаках и частных облаках можно также сопоставить использование с тарифами Azure, чтобы точнее определить расходы Azure. Данная оценка позволяет получать сводку по предложению, а также сравнивать разные типы предложений, выходящие за рамки оплаты по мере использования, такие как денежные обязательства и денежный кредит.

- **Анализ "что, если"**: вы можете определить, выгоднее ли выполнять рабочие нагрузки в другом регионе или с другой конфигурацией ресурсов Azure. Стоимость ресурсов Azure может отличаться в зависимости от используемого региона Azure. Вы также можете определить, предоставляет ли другое предложение Azure более выгодный тариф на ресурс Azure.

### <a name="networking-controls"></a>Элементы управления сетями

Доступ к ресурсам может быть внутренним (внутри корпоративной сети) или внешним (через Интернет). Пользователи в вашей организации могут случайно помещать ресурсы в расположения, не предназначенные для этих ресурсов, подвергая их опасности вредоносного доступа. Как и в случае локальных устройств, предприятия должны добавить соответствующие элементы управления, чтобы гарантировать, что пользователи Azure принимают правильные решения.

![Элементы управления сетями](./media/governance-in-azure/security-governance-in-azure-fig6.png)

Для управления доступом к подпискам используются следующие основные ресурсы, обеспечивающие базовое управление доступом.

#### <a name="network-connectivity"></a>Сетевое подключение

[Виртуальные сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) представляют собой объекты контейнеров для подсетей. Виртуальные сети часто используют для подключения приложений к внутренним корпоративным ресурсам. В то же время это не является обязательным. Служба "Виртуальная сеть Azure" позволяет безопасно соединять ресурсы Azure между собой с помощью виртуальных сетей.

Виртуальная сеть — это представление вашей сети в облаке. Это логическая изоляция облака Azure, выделенного для вашей подписки. Виртуальные сети можно также подключать к локальной сети.

Ниже перечислены возможности виртуальных сетей Azure:

- **Изоляция**: виртуальные сети полностью изолированы друг от друга. Это позволяет создавать отдельные виртуальные сети для разработки, тестирования и эксплуатации, использующие одинаковые блоки адресов CIDR. И наоборот, можно создать несколько виртуальных сетей, использующих различные блоки адресов CIDR, и соединить их. Виртуальную сеть можно разделить на несколько подсетей. Azure предоставляет возможность внутреннего разрешения имен для экземпляров ролей виртуальных машин и облачных служб Azure, подключенных к виртуальной сети. При необходимости можно настроить виртуальную сеть для использования собственных DNS-серверов вместо внутреннего разрешения имен Azure.

- **Подключение к Интернету**: по умолчанию все экземпляры ролей виртуальных машин и облачных служб Azure, подключенных к виртуальной сети, имеют доступ к Интернету. При необходимости можно также включить входящий доступ к определенным ресурсам.

- **Подключение ресурсов Azure**: ресурсы Azure, такие как облачные службы и виртуальные машины, можно подключить к одной виртуальной сети. Ресурсы могут подключаться друг к другу по частному IP-адресу, даже если они находятся в разных подсетях. В Azure предусмотрена маршрутизация по умолчанию между подсетями, подключенными виртуальными сетями и локальными сетями, поэтому вам не нужно настраивать маршруты и управлять ими.

- **Подключение виртуальных сетей**: виртуальные сети можно подключить друг к другу. Ресурсы, подключенные к любой виртуальной сети, могут обмениваться данными с любыми ресурсами в других виртуальных сетях.

- **Локальное подключение**: виртуальные сети можно подключить к локальным сетям через частные сетевые каналы между вашей сетью и Azure или через VPN-подключение типа "сеть-сеть" в Интернете.

- **Фильтрация трафика**: входящий и исходящий сетевой трафик виртуальных машин и облачных служб можно фильтровать по исходному и конечному IP-адресу и порту, а также по протоколу.

- **Маршрутизация**: при необходимости можно переопределить маршрутизацию Azure по умолчанию, настроив собственные маршруты или используя маршруты BGP через сетевой шлюз.

#### <a name="network-access-controls"></a>Средства контроля сетевого доступа

[Группы безопасности сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) действуют по принципу брандмауэра и задают правила взаимодействия с ресурсом по сети. Они обеспечивают контроль над тем, как и при каких условиях подсеть (или виртуальная машина) может подключаться к Интернету или другим подсетям в той же виртуальной сети.

Группы безопасности сети содержат перечень правил безопасности, которые разрешают или запрещают передачу сетевого трафика к ресурсам, подключенным к виртуальным сетям Azure. Группы безопасности сети можно связать с подсетями, отдельными виртуальными машинами (классическими) или отдельными сетевыми интерфейсами (сетевыми картами), подключенными к виртуальным машинам (Resource Manager).

Если группа безопасности сети связана с подсетью, эти правила применяются ко всем ресурсам в подсети. Можно дополнительно ограничить трафик, связав группу безопасности сети с отдельной виртуальной машиной или сетевой картой.

## <a name="security-and-compliance-with-organizational-standards"></a>Безопасность и соблюдение стандартов организации

У каждого предприятия есть собственные требования к безопасности, и каждое предприятие может получить явные преимущества при использовании облачных решений. Тем не менее клиенты всех видов задают одни и те же основные вопросы о перемещении в облако. Клиенты предъявляют к поставщикам облачных служб следующие требования.

- **Защита данных**: руководители ИТ-отделов подтверждают, что с помощью облачных служб можно обеспечить безопасность данных и административный контроль. Однако они по-прежнему считают, что переход на облачные службы сделает их более уязвимыми для злоумышленников по сравнению с имеющимися внутренними решениями.

- **Сохранение конфиденциальности данных**: облачные службы создают уникальные вызовы в отношении конфиденциальности данных. Компании задумываются о переходе в облако в целях экономии расходов на инфраструктуру и повышения их гибкости, но при этом они опасаются потерять контроль над тем, где хранятся данные, кто к ним обращается и как они используются.

- **Сохранение контроля**: даже используя преимущества облака для развертывания более инновационных решений, организации обеспокоены потерей контроля над своими данными. Недавние события с раскрытием правительственных агентств, получающих доступ к данным клиентов с помощью как законных, так и незаконных способов, заставляют ИТ-директоров опасаться хранить свои данные в облаке.

- **Повышение прозрачности**: руководители организаций понимают значение безопасности, конфиденциальности и контроля. Но они также хотят иметь возможность самостоятельно проверять, как их данные хранятся, защищаются и как осуществляется доступ к их данным.

- **Поддержка соответствия требованиям**: по мере расширения использования компаниями облачных технологий сложность и масштаб стандартов и правил продолжают увеличиваться. Организации должны знать, что их стандарты соответствия будут соблюдаться.

## <a name="security-configuration-for-monitoring-logging-and-auditing"></a>Настройка безопасности для мониторинга, ведения журнала и аудита

Подписчики Azure могут управлять своими облачными средами с нескольких устройств. Эти устройства могут включать рабочие станции управления, компьютеры для разработки и даже устройства привилегированных пользователей, имеющих разрешения для конкретных задач. 

В некоторых случаях функции администрирования можно выполнять с помощью веб-консолей, таких как портал Azure. Кроме того, пользователи могут устанавливать прямое подключение к Azure из локальных систем, используя виртуальные частные сети (VPN), службы терминалов, протоколы клиентских приложений или API управления службами Azure (программным путем). Они также могут использовать присоединенные к домену или изолированные и неуправляемые конечные точки клиентов, например планшеты или смартфоны.

Это многообразие создает серьезную угрозу для облачного развертывания. Оно может привести к сложностям с управлением, администрированием и аудитом. Многообразие вариантов также может создавать угрозу безопасности, так как доступ к конечным точкам клиентов, используемым для управления облачными службами, не регулируется. При использовании общедоступных или личных рабочих станций для разработки инфраструктуры и управления ею открываются новые направления непрогнозируемых угроз, например при просмотре веб-страниц (атаки на предприятие) или использовании электронной почты (социотехника и фишинг).

Мониторинг, ведение журнала и аудит создают основу для отслеживания и анализа административных действий. Аудит всех действий с полной детализацией может быть невозможным из-за объема создаваемых данных. Лучшее решение — вести аудит эффективности политик управления.

Используйте систему управления безопасностью из объектов групповой политики доменных служб Azure Active Directory, чтобы контролировать все интерфейсы администраторов Windows, например предоставление общего доступа к файлам. Включите рабочие станции управления в процессы аудита, мониторинга и ведения журналов. Отслеживайте все действия доступа и использования, которые выполняют администраторы и разработчики.

### <a name="azure-security-center"></a>Центр безопасности Azure

[Центр безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro) представляет собой централизованный ресурс для просмотра состояния безопасности всех ресурсов в подписках. Он предоставляет рекомендации, которые помогут избежать компрометации ресурсов. С его помощью можно включить более детализированные политики (например, применить для определенных групп ресурсов политики, которые позволяют организации адаптировать свою позицию по отношению к рискам, регулируемым этими политиками).

![Центр безопасности Azure](./media/governance-in-azure/security-governance-in-azure-fig7.png)

Центр безопасности предоставляет встроенные функции мониторинга безопасности и управления политиками для подписок Azure, помогает выявлять угрозы, которые в противном случае могли бы оказаться незамеченными, и взаимодействует с широким комплексом решений по обеспечению безопасности. Когда вы включаете [политики безопасности](https://docs.microsoft.com/azure/security-center/security-center-policies) для ресурсов в рамках подписки, центр безопасности проверяет защиту ресурсов, чтобы определить потенциальные уязвимости. Хотя сведения о конфигурации сети становятся доступными сразу же,

Центр безопасности Azure представляет синтез анализа рекомендаций по безопасности и управления политиками безопасности для всех ресурсов в рамках подписки Azure. Он позволяет группам безопасности и специалистам по рискам предотвращать, обнаруживать угрозы безопасности и реагировать на них, поскольку автоматически собирает и анализирует данные безопасности для ваших ресурсов Azure, сети и партнерских решений, таких как антивирусные программы и брандмауэры.

Кроме того, центр безопасности Azure применяет расширенную аналитику, включая машинное обучение и анализ поведения. Он использует глобальную аналитику угроз из продуктов и служб Майкрософт, Подразделения цифровых преступлений Майкрософт (DCU), Центра кибербезопасности Майкрософт (MSRC), а также из внешних каналов. Вы можете широко использовать [систему управления безопасностью](https://www.credera.com/blog/credera-site/azure-governance-part-4-other-tools-in-the-toolbox/) на уровне подписки. Вы также можете сузить ее до конкретных требований и применить их к отдельным ресурсам с помощью определения политики.

Наконец, центр безопасности Azure анализирует состояние безопасности ресурсов на основе этих политик и использует эти сведения для предоставления информативных панелей мониторинга и оповещений о событиях, таких как обнаружение вредоносных программ или попытки подключения с подозрительных IP-адресов. Дополнительные сведения о том, как применить рекомендации, см. в разделе [Внедрение рекомендаций по безопасности в центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-recommendations).

Центр безопасности Azure отслеживает следующие ресурсы Azure:

- виртуальные машины (в том числе облачные службы);

- виртуальные сети;

- базы данных SQL;

- решения партнеров, интегрированные в подписку Azure, например брандмауэр веб-приложений на виртуальных машинах и в [среде службы приложений](https://docs.microsoft.com/azure/app-service/app-service-app-service-environments-readme).

Когда вы впервые обращаетесь к Центру безопасности, сбор данных включается на всех виртуальных машинах в рамках подписки. Рекомендуется оставить сбор данных включенным, что вы можете [отключить его](https://docs.microsoft.com/azure/security-center/security-center-faq) в политике центра безопасности.

### <a name="log-analytics"></a>Log Analytics

[Программа управления](https://github.com/Microsoft/azure-docs/blob/master/articles/log-analytics/log-analytics-security.md) и информационной безопасности команды по разработке и обслуживанию программного обеспечения Azure Log Analytics поддерживает бизнес-требования этого программного обеспечения. Эта программа придерживается законодательных и нормативных требований, описанных в разделах [Центр управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/) и [Соответствие требованиям для центра управления безопасностью Майкрософт](https://www.microsoft.com/TrustCenter/Compliance/default.aspx). В этих разделах также описано, как Log Analytics устанавливает требования безопасности, определяет средства управления безопасностью, управляет рисками и отслеживает их. Команда ежегодно пересматривает политики, стандарты, процедуры и рекомендации.

Каждый участник команды разработки Log Analytics проходит официальное обучение по безопасности приложений. Система управления версиями помогает защитить все разрабатываемые проекты программного обеспечения.

В корпорации Майкрософт работает команда по обеспечению безопасности и соответствия требованиям, которая контролирует и оценивает все службы Майкрософт. В эту команду входят специалисты по информационной безопасности, которые не связаны с отделами проектирования, разрабатывающими Log Analytics. Специалисты по безопасности имеют собственную цепочку подчиненности. Они проводят независимые оценки продуктов и служб для обеспечения безопасности и соответствия требованиям.

Основные функциональные возможности Log Analytics предоставляются с помощью набора служб, выполняющихся в Azure. Каждая служба предоставляет определенную функцию управления, благодаря чему можно комбинировать службы для получения различных сценариев управления.

![Службы Azure для управления](./media/governance-in-azure/security-governance-in-azure-fig9.JPG)

Эти службы управления изначально расположены в облаке. Они полностью находятся в Azure, поэтому они не включают развертывание локальных ресурсов и управление ими. Начать работу можно буквально за несколько минут и с минимальными настройками.

Разместите агент на любом компьютере с Windows или Linux в центре обработки данных, и он будет отправлять данные в Log Analytics. Там их можно проанализировать вместе с другими данными, полученными из облака или от локальных служб. Используйте службы Azure Backup и Azure Site Recovery, чтобы обеспечить эффективное резервное копирование и высокий уровень доступности локальных ресурсов за счет использования облака.

![Службы управления на панели мониторинга Azure](./media/governance-in-azure/security-governance-in-azure-fig8.png)

Модули Runbook в облаке обычно не могут получать доступ к ресурсам в локальной среде. Тем не менее можно установить агент на одном или нескольких компьютерах в центре обработки данных, на которых будут размещаться модули Runbook. При запуске модуля Runbook необходимо указать, где он должен выполняться: в облаке или в локальной рабочей роли.

Вы можете добавить в подписку Azure различные решения корпорации Майкрософт или ее партнеров, которые позволяют более эффективно использовать Log Analytics. Например, Azure предоставляет [решения по управлению](https://docs.microsoft.com/azure/operations-management-suite/operations-management-suite-solutions) — предварительно упакованные наборы логики, реализующие сценарий управления с использованием одной или нескольких служб управления.

![Коллекция решений по управлению в Azure](./media/governance-in-azure/security-governance-in-azure-fig10.png)

Как партнер вы можете создавать собственные решения для поддержки приложений и служб и предоставлять их пользователям через Azure Marketplace или c помощью шаблонов быстрого запуска.

## <a name="performance-alerting-and-monitoring"></a>Мониторинг производительности и оповещения

### <a name="alerting"></a>Оповещение

Оповещения позволяют выполнять мониторинг метрик ресурсов, событий или журналов Azure. Они уведомляют вас о возникновении указанного вами условия.

Оповещения доступны в различных службах, включая следующие:

- **Application Insights**: позволяет использовать оповещения для веб-тестов и метрик. Дополнительные сведения см. в разделах [Настройка оповещений в Application Insights](https://docs.microsoft.com/azure/application-insights/app-insights-alerts) и [Наблюдение за доступностью и скоростью реагирования веб-сайта](https://docs.microsoft.com/azure/application-insights/app-insights-monitor-web-app-availability).

- **Log Analytics**: включает маршрутизацию журналов диагностики и действий в Log Analytics. Он позволяет использовать метрики, журналы и другие типы оповещений. Дополнительные сведения см. в разделе [Оповещения в Log Analytics](https://docs.microsoft.com/azure/log-analytics/log-analytics-alerts).

- **Azure Monitor**: позволяет использовать оповещения на основе как значений метрик, так и событий журнала действий. Вы можете управлять оповещениями с помощью [REST API Azure Monitor](https://msdn.microsoft.com/library/dn931943.aspx). Ознакомьтесь со статьей [Создание оповещений для служб Azure с помощью портала Azure](https://docs.microsoft.com/azure/monitoring-and-diagnostics/insights-alerts-portal).

### <a name="monitoring"></a>Мониторинг

Проблемы с производительностью в облачном приложении могут повлиять на работу вашей организации. Несколько взаимосвязанных компонентов и частые выпуски могут в любое время привести к снижению производительности. В разработанном приложении пользователи, как правило, находят проблемы, которые не были обнаружены во время тестирования. Вы должны немедленно получать сведения о таких проблемах и применять средства для их диагностики и устранения.

Существует широкий спектр средств для мониторинга приложений и служб Azure. Некоторые их функции перекрываются. Это в определенной степени обусловлено расхождением между разработкой и эксплуатацией приложения.

Ниже приведены основные средства.

- **Azure Monitor** — это основное средство для отслеживания служб, выполняемых в Azure. Оно предоставляет данные уровня инфраструктуры о пропускной способности службы и окружающей среды. Если вы управляете всеми своими приложениями в Azure и хотите определить, следует ли увеличить или уменьшить масштаб ресурсов, Azure Monitor поможет это сделать.

- **Application Insights** можно использовать для разработки и в качестве решения для мониторинга рабочей среды. Установите пакет в приложение, чтобы запустить это средство и получить внутреннее представление о его работе. Это средство формирует такие данные, как время отклика зависимостей, трассировки исключений, моментальные снимки отладки и профили выполнения. Оно предоставляет средства для анализа всех данных телеметрии, чтобы помочь с отладкой приложения и анализом действий пользователей в этом приложении. Вы можете определить, вызвано ли увеличение времени отклика проблемой с приложением или проблемой с внешними ресурсами. Если используется Visual Studio и приложение находится в неисправном состоянии, вы можете сразу перейти к неправильной строке кода, чтобы устранить проблему.

- **Служба Log Analytics** предназначена для пользователей, которым необходимо настроить производительность и запланировать обслуживание приложений, выполняющихся в рабочей среде. Эта служба собирает данные из множества источников и выполняет их агрегирование (с задержкой 10–15 минут). Она предоставляет целостное решение для управления ИТ-средой в Azure, а также в локальной среде и сторонней облачной инфраструктуре (например, Amazon Web Services). Эта служба предоставляет инструменты для анализа данных из разных источников, позволяет использовать сложные запросы во всех журналах и может отправлять упреждающие оповещения при выполнении указанных условий. Вы даже можете собирать пользовательские данные в центральном репозитории, чтобы впоследствии отправлять запросы к этим данным и визуализировать эти данные.

- **System Center Operations Manager** предназначен для отслеживания крупных облачных установок и управления ими. Возможно, вы уже использовали эту службу в качестве средства управления для локальных облачных сред на основе Windows Sever и Hyper-V, однако с ее помощью также можно интегрировать приложения Azure и управлять ими. Помимо прочего, она позволяет установить Application Insights в имеющихся интерактивных приложениях. Если приложение выйдет из строя, Operations Manager сразу же сообщит вам об этом.


## <a name="next-steps"></a>Дополнительная информация

- [Рекомендации по созданию шаблонов Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices).

- [Примеры реализации управления подписками Azure](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-subscription-examples)

- [Microsoft Azure для государственных организаций](https://docs.microsoft.com/azure/azure-government/)
