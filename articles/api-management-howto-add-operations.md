<properties pageTitle="How to add operations to an API in Azure API Management" metaKeywords="" description="Learn how to add operations to an API in Azure API Management." metaCanonical="" services="" documentationCenter="API Management" title="How to add operations to an API in Azure API Management" authors="sdanie" solutions="" manager="" editor="" />

<tags ms.service="api-management" ms.workload="mobile" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="sdanie" />

# Добавление операций в API в Azure API Management

Прежде чем API может быть использован в API Management (предварительная версия), должны быть добавлены операции. Это руководство описывает добавление и настройку операций различного типа в интерфейсе API в API Management.

## Содержание раздела

-   [Добавление операции][Добавление операции]
-   [Кэширование операций][Кэширование операций]
-   [Параметры запроса][Параметры запроса]
-   [Тело запроса][Тело запроса]
-   [Ответы][Ответы]
-   [Дальнейшие действия][Дальнейшие действия]

## <a name="add-operation"> </a>Добавление операции

Операции добавляются и настраиваются для API на консоли управления. Для доступа к консоли управления щелкните **Консоль управления** на портале Azure для службы API Management.

> Если экземпляр службы API Management еще не создан, см. раздел [Создание экземпляра службы API Management][Создание экземпляра службы API Management] в руководстве [Начинаем работу с API Management][Начинаем работу с API Management].

![Консоль API Management][Консоль API Management]

Выберите требуемый API на портале API Management, а затем перейдите на вкладку **Операции**.

![Операции][Операции]

Щелкните **Добавить операцию**, чтобы добавить новую операцию. Появится окно **Новая операция**, вкладка **Сигнатура** будет выбрана по умолчанию.

![Добавление операции][1]

Выберите **команду HTTP** в раскрывающемся списке.

![Метод HTTP][Метод HTTP]

Определите шаблон URL-адреса путем ввода фрагмента URL-адреса, который содержит один или несколько сегментов пути URL, а также несколько параметров строки запроса (либо вообще без параметров). Шаблон URL-адреса, добавляемый к основному URL-адресу API, идентифицирует одиночную HTTP-операцию. Он может содержать один или несколько частей переменной с именем, которые идентифицируются изогнутыми фигурными скобками. Эти части переменной называются параметрами шаблона и представляют собой динамически назначаемые значения, извлекаемые из URL-адреса запроса, когда запрос обрабатывается платформой API Management.

![Шаблон URL-адреса][Шаблон URL-адреса]

При необходимости укажите **Шаблон URL-адреса перезаписи**. Это позволяет использовать стандартный шаблон URL-адреса для обработки входящих запросов на интерфейсной части при вызове серверной части с помощью преобразованного URL-адреса в соответствии с шаблоном перезаписи. В шаблоне перезаписи должны использоваться параметры шаблона из шаблона URL-адреса. В следующем пример показано, как тип контента, закодированный как сегмент пути в веб-службе из предыдущего примера, может быть введен в качестве параметра запроса в API, опубликованном на платформе API Management с помощью шаблонов URL-адреса.

![Перезапись шаблона URL-адреса][Перезапись шаблона URL-адреса]

Вызывающие объекты операции будут использовать формат `/customers?customerid=ALFKI`, который будет сопоставляться с форматом `/Customers('ALFKI')` при вызове серверной службы.

Текстовые поля **Отображаемое имя** и **Описание** обеспечивают описание операции и используются для предоставления документации разработчикам, которые используют этот API на портале разработчика.

![Описание][Описание]

Описание операции может быть введено в виде обычного текста или в формате HTML в текстовом поле **Описание**.

## <a name="operation-caching"> </a>Кэширование операций

Кэширование ответов уменьшает задержку для потребителей API, снижает потребляемую пропускную способность и сокращает нагрузку на веб-службу HTTP, которая реализует интерфейс API.

Для легкого и быстрого включения кэширования для операции перейдите на вкладку **Кэширование** и установите флажок **Включить**.

![Caching][Caching]

**Длительность** указывает период времени, в течение которого ответ операции остается в кэше. Значение по умолчанию составляет 3600 секунд или 1 час.

Ключи кэша используются, чтобы отличать ответы друг от друга таким образом, чтобы ответ, соответствующий каждому отличному ключу кэша, получал свое собственное отдельное кэшированное значение. Или же можно ввести специальные параметры строки запроса и/или HTTP-заголовки, которые должны будут использоваться при вычислении значений ключей кэша, соответственно в текстовых полях **В зависимости от параметров строки запроса** и **В зависимости от заголовков**. Если они не заданы, при создании ключей кэша используются полный URL-адрес запроса и следующие значения HTTP-заголовка: **Accept** и **Accept-Charset**.

> Дополнительные сведения о кэшировании и политиках кэширования см. в разделе [Кэширование результатов операции в Azure API Management][Кэширование результатов операции в Azure API Management].

## <a name="request-parameters"> </a>Параметры запроса

Параметрами операции можно управлять на вкладке «Параметры». Параметры, заданные в поле **Шаблон URL-адреса** на вкладке **Сигнатура**, добавляются автоматически и могут быть изменены только путем редактирования шаблона URL-адреса. Дополнительные параметры можно вводить вручную.

Для добавления нового параметра запроса щелкните **Добавить параметр запроса** и введите следующие сведения.

-   **Имя** - имя параметра.
-   **Описание** - краткое описание параметра (необязательно).
-   **Тип** - тип параметра, выбранный в раскрывающемся списке.
-   **Значения** - значения, которые могут быть назначены этому параметру. Одно из значений может быть отмечено как значение по умолчанию (необязательно).
-   **Обязательный** - установите флажок, если этот параметр должен быть обязательным.

![Параметры запроса][2]

## <a name="request-body"> </a>Тело запроса

Если операция допускает (например, PUT, POST) и требует наличия тела, то можно ввести пример такого тела во всех поддерживаемых форматах представления (например, json, XML).

> Тело запроса используется только в документационных целях и не проверяется.

Для ввода тела запроса перейдите на вкладку **Тело**.

Щелкните **Добавить представление**, начните вводить требуемое название типа контента (например, приложение/json), выберите его в раскрывающемся списке и вставьте требуемый пример тела запроса в выбранном формате в текстовое поле.

![Тело запроса][3]

В дополнение к представлениям необязательное текстовое описание также можно ввести в текстовом поле **Описание**.

## <a name="responses"> </a>Ответы

Рекомендуется создавать примеры ответов для всех кодов состояния, которые может выдать операция. Каждый код состояния может содержать более одного примера содержимого ответа, по одному для каждого поддерживаемого типа содержимого.

Для добавления ответа щелкните **Добавить** и начните вводить требуемый код состояния. В этом примере код состояния — **200 OK**. Как только код появится в раскрывающемся списке, выберите его. Будет создан код ответа, который будет добавлен в вашу операцию.

![Код ответа][Код ответа]

Щелкните **Добавить представление**, начните вводить требуемое название типа контента (например, приложение/json), а затем выберите его в раскрывающемся списке.

![Тип контента тела][Тип контента тела]

Вставьте пример тела ответа в выбранном формате в текстовое поле.

![Тело ответа][Тело ответа]

При необходимости добавьте необязательное описание в текстовое поле **Описание**.

После настройки операции щелкните **Сохранить**.

## <a name="next-steps"> </a>Дальнейшие действия

Как только операции будут добавлены в API, следующим шагом будет сопоставление интерфейса API с продуктом и его публикация, чтобы разработчики могли вызывать его операции.

-   [Как создать и опубликовать продукт][Как создать и опубликовать продукт]

  [Добавление операции]: #add-operation
  [Кэширование операций]: #operation-caching
  [Параметры запроса]: #request-parameters
  [Тело запроса]: #request-body
  [Ответы]: #responses
  [Дальнейшие действия]: #next-steps
  [Создание экземпляра службы API Management]: ../api-management-get-started/#create-service-instance
  [Начинаем работу с API Management]: ../api-management-get-started
  [Консоль API Management]: ./media/api-management-howto-add-operations/api-management-management-console.png
  [Операции]: ./media/api-management-howto-add-operations/api-management-operations.png
  [1]: ./media/api-management-howto-add-operations/api-management-add-operation.png
  [Метод HTTP]: ./media/api-management-howto-add-operations/api-management-http-method.png
  [Шаблон URL-адреса]: ./media/api-management-howto-add-operations/api-management-url-template.png
  [Перезапись шаблона URL-адреса]: ./media/api-management-howto-add-operations/api-management-url-template-rewrite.png
  [Описание]: ./media/api-management-howto-add-operations/api-management-description.png
  [Caching]: ./media/api-management-howto-add-operations/api-management-caching-tab.png
  [Кэширование результатов операции в Azure API Management]: ../api-management-howto-cache
  [2]: ./media/api-management-howto-add-operations/api-management-request-parameters.png
  [3]: ./media/api-management-howto-add-operations/api-management-request-body.png
  [Код ответа]: ./media/api-management-howto-add-operations/api-management-response-code.png
  [Тип контента тела]: ./media/api-management-howto-add-operations/api-management-response-body-content-type.png
  [Тело ответа]: ./media/api-management-howto-add-operations/api-management-response-body.png
  [Как создать и опубликовать продукт]: ../api-management-howto-add-products
