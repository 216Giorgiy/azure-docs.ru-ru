<properties 
	pageTitle="Служба поиска: рабочий процесс для разработчиков" 
	description="Служба поиска: рабочий процесс для разработчиков" 
	services="search" 
	documentationCenter="" 
	authors="HeidiSteen" 
	manager="mblythe" 
	editor=""/>

<tags 
	ms.service="search" 
	ms.devlang="rest-api" 
	ms.workload="search" 
	ms.topic="article" 
	ms.tgt_pltfrm="na" 
	ms.date="01/16/2015" 
	ms.author="heidist"/>
# Поиск Azure: поток процесса разработки

[WACOM.INCLUDE [This article uses the Azure Preview portal](../includes/preview-portal-note.md)]

В этой статье приведен перечень шагов и некоторые советы и рекомендации по созданию и обслуживанию службы поиска и ее индексов. 

Мы предполагаем, что служба уже подготовлена вами. Если вы еще не сделали этого, см. инструкции в разделе [Начало работы со службой Поиска Azure ](search-get-started.md).

+ [Шаг 1. Создание индекса](#sub-1)
+ [Шаг 2. Добавление документов](#sub-2)
+ [Шаг 3. Запрос индекса](#sub-3)
+ [Шаг 4. Обновление или удаление индексов и документов](#sub-4)
+ [Вопросы проектирования хранилища](#sub-5)


<h2 id="sub-1">Шаг 1. Создание индекса</h2>

Запросы направлены на создание индекса поиска, который содержит данные поиска и атрибуты. Таким образом, первым шагом после подготовки службы является определение схемы индекса в формате JSON и выполнение запроса HTTPS PUT для создания индекса в службе. 

Индексы создаются кодом приложения. Отсутствуют встроенные средства или редакторы, помогающие определить индекс в пользовательском интерфейсе. Примеры, демонстрирующие различные способы создания индекса, включают [Создание первого поиска решения с помощью поиска Azure](search-create-first-solution.md), где схема задается в файле Program.cs и разделе [Начало работы с оценки профилей в поиске Azure](search-get-started-scoring-profiles.md), задающим индекс в отдельном файле схемы JSON. Дополнительные сведения о создании индекса см. в разделе [Создание индекса (API Поиска Azure)](http://msdn.microsoft.com/library/dn798941.aspx) в MSDN.

<h2 id="sub-2">Шаг 2. Добавление документов</h2>

После создания поискового индекса можно добавлять документы в индекс путем запроса POST в формате JSON. Каждый документ должен иметь уникальный ключ и набор полей, содержащих данные, по которым можно осуществлять поиск и прочие данные. Данные документа представлены в виде набора пар "ключ-значение" для каждого поля.

Мы рекомендуем добавлять документы партиями в целях улучшения пропускной способности. Можно одновременно группировать до 1000 документов при условии, что средний размер документа составляет 1-2 Кбайт.

Для запроса POST возвращается общий код состояния. Коды состояния могут быть либо HTTP 200 (успех), либо HTTP 207 (многостатусный), если есть успешно обработанные документы и документы с ошибками. Дополнительно к коду состояния запроса POST поиск Azure поддерживает поле состояния для каждого документа. При групповой загрузке вам необходимо получить статус каждого документа, который отображает успешное добавление или ошибку при добавлении каждого документа. Поле состояния обеспечивает такую информацию. В поле устанавливается статус false при ошибке загрузки документа.

При высокой нагрузке ошибки загрузки могут встречаться часто. При возникновении ошибки общий код состояния равен 207, что говорит о частично успешной загрузке. У документов, при индексировании которых произошла ошибка, свойство "статус" будет иметь значение false.

> [WACOM.NOTE] Полученные службой документы индексируются по очереди и не сразу появляются в результатах поиска. В случае отсутствия высокой нагрузки документы, как правило, индексируются за несколько секунд.


<h2 id="sub-3">Шаг 3. Запрос индекса</h2>

После того как документы будут проиндексированы, можно выполнять поисковые запросы. За один раз можно запрашивать только один индекс с использованием OData или простого запроса:

+	[Синтаксис выражения OData для Поиска Azure](http://msdn.microsoft.com/library/dn798921.aspx)
+	[Синтаксис простого запроса в Поиске Azure](http://msdn.microsoft.com/library/dn798920.aspx)

<h2 id="sub-4">Шаг 4. Обновление или удаление индексов и документов</h2>

Дополнительно можно вносить изменения схемы в поисковый индекс, обновлять или удалять документы в индексе и удалять индексы.

При обновлении индекса вы можете сочетать в одной группе несколько действий (вставка, слияние, удаление), что устраняет необходимость в нескольких запросах. В настоящий момент Поиск Azure не поддерживает частичные обновления (HTTP PATCH), поэтому, если вам необходимо обновить индекс, необходимо повторно отправить его определение.

<h2 id="sub-5">Вопросы проектирования хранилища</h2>

Поиск Azure использует внутреннее хранилище для индексов и документы, которые используются в операциях поиска. Текстовый анализ зависит от того, есть ли поля, по которым может вестись поиск, и доступны ли при этом связанные атрибуты.

Не все поля в документе доступны для поиска. Например, если ваше приложение представляет собой онлайн-каталог музыки или видео, мы рекомендуем хранить двоичные файлы в Azure BLOB-объектах или в другом хранилище. Поиск по двоичным файлам не производится, поэтому нет смысла в их нахождении в хранилище Поиска Azure. Несмотря на то что следует хранить изображения, видео и звуковые файлы в других службах или в другом расположении, следует включить поле, которое ссылается на URL-адрес к файлу. Таким образом, можно вернуть внешние данные как часть результатов поиска. 

Дополнительные сведения о создании индексов или документов см. в разделе [Rest API поиска Azure](http://msdn.microsoft.com/library/dn798935.aspx).


<!--Anchors-->
[Шаг 1. Создание индекса]: #sub-1
[Шаг 2. Добавление документов]: #sub-2
[Шаг 3. Запрос индекса]: #sub-3
[Шаг 4. Обновление или удаление индексов и документов]: #sub-4
[Выбор хранилища документов]: #sub-5


<!--Image references-->

<!--Link references-->
[Начало работы со службой поиска Azure]: ../search-get-started/
[Управление службой Поиска в Microsoft Azure]: ../search-manage/
[Создайте свое первое решение с использованием Поиска Azure]: ../search-create-first-solution/


<!--HONumber=46--> 
