<properties
	pageTitle="Вход в Azure из CLI | Microsoft Azure"
	description="Подключение к подписке Azure из интерфейса командной строки Azure (Azure CLI) на компьютерах Mac, Linux и Windows"
	editor="tysonn"
	manager="timlt"
	documentationCenter=""
	authors="dlepow"
	services=""
	tags="azure-resource-manager,azure-service-management"/>

<tags
	ms.service="multiple"
	ms.workload="multiple"
	ms.tgt_pltfrm="command-line-interface"
	ms.devlang="na"
	ms.topic="article"
	ms.date="09/18/2015"
	ms.author="danlep"/>

# Подключение к среде Azure с использованием интерфейса командной строки Azure (Azure CLI)

Azure CLI представляет собой набор межплатформенных команд с открытым кодом для работы с платформой Azure. В этой статье описывается, как подключиться к подписке Azure из Azure CLI, чтобы использовать все команды этого интерфейса. Если вы еще не установили Azure CLI, см. раздел [Установка интерфейса командной строки Azure](xplat-cli-install.md).


[AZURE.INCLUDE [learn-about-deployment-models](../includes/learn-about-deployment-models-both-include.md)]


Существует два способа подключения к подписке из Azure CLI:

* **Вход в Azure по учетной записи компании или учебного заведения**. В этом случае для проверки подлинности учетных данных используется система Azure Active Directory. Начиная с версии 0.9.9, CLI поддерживает учетные записи организации с поддержкой многофакторной проверки подлинности. После входа в систему можно использовать как диспетчер ресурсов, так и классические команды (Service Management).

* **Загрузка и использование файла параметров публикации**. При этом устанавливается сертификат, который позволяет выполнять различные задачи управления в течение всего срока действия подписки и сертификата. Этот метод позволяет использовать только классические команды (Service Management).

Дополнительные сведения о проверке подлинности и управлении подписками см. в разделе [Различия между способами проверки подлинности на основе учетной записи и сертификата][authandsub].

Если у вас нет учетной записи Azure, вы можете создать бесплатную пробную учетную запись всего за несколько минут. Дополнительные сведения см. в разделе [Бесплатная пробная версия Azure][free-trial].


## Использование метода входа

Метод входа работает только с рабочей или школьной учетной записи, которая также называется *учетной записью организации*. Это учетная запись, которая управляется организацией и определена в ее каталоге Azure Active Directory. Если такой учетной записи у вас нет, [создайте ее](#create-an-organizational-account).


* Чтобы **войти** из Azure CLI с использованием рабочей учетной записи, выполните следующую команду:

	```
	azure login -u <username>
	```

	В ответ на запрос введите свой пароль.

	Если учетные данные используются для входа в систему впервые, вам предложат указать, нужно ли кэшировать маркер проверки подлинности. Аналогичный запрос появляется также в том случае, если ранее вы использовали команду `azure logout`, которая описывается ниже. Чтобы пропустить этот запрос в сценариях автоматизации, добавьте к команде `azure login` параметр `-q`.

* Чтобы **выйти** из системы, введите следующую команду:

	```
	azure logout -u <username>
	```

	Если для проверки подлинности подписок, связанных с учетной записью, использовался только Active Directory, при выходе из системы данные о подписке удаляются из локального профиля. Однако если вы также импортировали файл параметров публикации для подписок, то при выходе из системы из локального профиля удаляются только данные, относящиеся к Active Directory.

### Многофакторная проверка подлинности
Начиная с Azure CLI версии 0.9.9 вход в систему можно выполнять по учетной записи организации, в которой используется многофакторная проверка подлинности (проверка подлинности с помощью пароля и одного или нескольких дополнительных способов верификации, таких как доверенное устройство или предоставление иных личных данных).

После запуска `azure login` с использованием имени пользователя и пароля учетной записи, CLI сообщает адрес веб-страницы, которую нужно открыть. Введите код на этой странице, чтобы продолжить проверку подлинности. Как только политика проверки подлинности будет выполнена, Azure CLI завершит процедуру входа в систему.


### Создание учетной записи организации

Если вы используете для входа в подписку Azure личную учетную запись, вы можете создать учетную запись организации, выполнив описанные ниже действия.

1. Войдите на [портал Azure][portal] и щелкните **Active Directory**.

2. Если каталог не существует, выберите **Создание каталога** и укажите нужные данные.

3. Выберите каталог и добавьте нового пользователя. Этот пользователь будет соответствовать вашей рабочей учетной записи.

	При создании пользователя вам будут предоставлены электронной адрес и временный пароль. Сохраните эти сведения.

4. На портале Azure выберите **Параметры**, а затем **Администраторы**. Щелкните **Добавить**, чтобы добавить нового пользователя в качестве соадминистратора. Это позволит использовать вашу рабочую учетную запись для управления подпиской Azure.

5. Выйдите из портала Azure, а затем войдите снова с использованием рабочей учетной записи. При первом входе в учетную запись появится запрос на изменение пароля.

	При входе в систему с новой учетной записью должны отображаться подписки.

Дополнительные сведения о рабочих учетных записях см. в статье [Подпишитесь на Azure как организация][signuporg].

## Использование файла параметров публикации

Если вам нужно использовать только классические команды CLI (Service Management), можете подключиться с использованием файла параметров публикации.

* **Чтобы загрузить файл параметров публикации** для вашей учетной записи, воспользуйтесь следующей командой:

	```
	azure account download
	```

	После этого откроется браузер по умолчанию и появится запрос на вход в [портал Azure][portal]. После входа в систему загрузится файл `.publishsettings`. Запишите место сохранения этого файла.

	> [AZURE.NOTE]Если ваша учетная запись связана с несколькими клиентами Azure Active Directory, может появиться запрос на выбор службы Active Directory, для которой следует загрузить файл параметров публикации.
	>
	> После выбора на странице скачивания или на портале Azure соответствующая служба Active Directory становится службой каталогов по умолчанию, которая будет использоваться на портале и странице скачивания. После определения службы каталогов по умолчанию в верхней части страницы загрузки появится текст "__щелкните здесь, чтобы вернуться на страницу выбора__". Используйте предоставленную ссылку, чтобы вернуться на страницу выбора.

* Чтобы **импортировать файл параметров публикации**, выполните следующую команду:

	```
	azure account import <path to your .publishsettings file>
	```

	После импорта параметров публикации удалите файл `.publishsettings`, так как он больше не используется интерфейсом Azure CLI и представляет угрозу безопасности, поскольку может быть использован для получения доступа к подписке.


## Несколько подписок

Если у вас есть несколько подписок Azure, при подключении вы получаете доступ ко всем подпискам, связанным с вашими учетными данными. При этом одна подписка выбирается по умолчанию и используется для выполнения операций в Azure CLI. Вы можете просмотреть подписки, а также узнать, какая из них используется по умолчанию, с помощью команды `azure account list`. Эта команда возвращает сведения следующего вида:

	info:    Executing command account list
	data:    Name              Id                                    Current
	data:    ----------------  ------------------------------------  -------
	data:    Azure-sub-1       ####################################  true
	data:    Azure-sub-2       ####################################  false

В приведенном выше списке **Current** означает текущую подписку по умолчанию Azure-sub-1. Для изменения подписки по умолчанию используйте команду `azure account set`, указав соответствующую подписку. Например:

	azure account set Azure-sub-2

Это приведет к изменению подписки по умолчанию на Azure-sub-2.

> [AZURE.NOTE]Изменение подписки по умолчанию вступает в силу сразу же и является глобальным. Новые команды Azure CLI (запускаемые как из того же, так и из другого экземпляра командной строки) будут использовать новую подписку по умолчанию.

Если вы хотите при работе с Azure CLI использовать подписку, которая не выбрана по умолчанию, но не хотите менять текущие настройки, вы можете использовать параметр `--subscription`, указав имя подписки, которую следует использовать для данной операции.

Подключившись к подписке Azure, можно приступать к использованию команд Azure CLI. Дополнительные сведения см. в статье [Использование Azure CLI](xplat-cli-install.md).

## Хранение параметров CLI

Если для входа в систему используется рабочая или учебная учетная запись или импорт параметров публикации, профиль CLI и журналы сохраняются в каталог `.azure`, который находится в каталоге `user`. Каталог `user` защищен операционной системой, однако рекомендуется принять дополнительные меры для его шифрования. Это можно сделать одним из следующих способов:

* В ОС Windows измените свойства каталога или используйте BitLocker.
* В ОС Mac включите FileVault для этого каталога.
* В ОС Ubuntu используйте функцию каталога Encrypted Home. Другие дистрибутивы Linux включают аналогичные функции.

## Дополнительные ресурсы

* [Использование Azure CLI с классическими командами (Service Management)][cliasm]

* [Использование Azure CLI с командами диспетчера ресурсов][cliarm]

* Для получения дополнительных сведений об интерфейсе Azure CLI, загрузки исходного кода, сообщения о проблеме или участия в проекте посетите [репозиторий GitHub для Azure CLI](https://github.com/azure/azure-xplat-cli).

* Если у вас возникли проблемы с использованием Azure CLI или Azure, посетите [форумы Azure](http://social.msdn.microsoft.com/Forums/windowsazure/home).





[authandsub]: http://msdn.microsoft.com/library/windowsazure/hh531793.aspx#BKMK_AccountVCert
[free-trial]: http://azure.microsoft.com/pricing/free-trial/
[portal]: https://manage.windowsazure.com
[signuporg]: http://azure.microsoft.com/documentation/articles/sign-up-organization/
[cliasm]: virtual-machines/virtual-machines-command-line-tools.md
[cliarm]: virtual-machines/xplat-cli-azure-resource-manager.md

<!---HONumber=Oct15_HO3-->