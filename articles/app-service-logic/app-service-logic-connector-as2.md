<properties 
   pageTitle="Использование соединителя AS2 в службе приложений Microsoft Azure" 
   description="Использование соединителя AS2" 
   services="app-service\logic" 
   documentationCenter=".net,nodejs,java" 
   authors="rajeshramabathiran" 
   manager="dwrede" 
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration" 
   ms.date="06/29/2015"
   ms.author="rajram"/>

# Соединитель Microsoft AS2
Соединитель Microsoft Azure AS2 позволяет получать и отправлять сообщения по транспортному протоколу AS2 (Applicability Statement 2) во взаимодействиях между компаниями. Данные безопасно и надежно транспортируются через Интернет. Безопасность обеспечивается с помощью цифровых сертификатов и шифрования.

## Триггеры и действия
Триггер запускает новый экземпляр на основе определенного события, например при поступлении сообщения AS2 от партнера. Действие — это результат, например, после получения сообщения AS2 — отправка этого сообщения с помощью AS2.

Соединитель AS2 в приложении логики можно использовать как триггер или действие, он поддерживает данные в форматах JSON и XML. Соединитель AS2 предоставляет следующие триггеры и действия.

триггеры; | Действия
--- | ---
Получение и декодирование | Кодирование и отправка

## Требования для начала работы
Перед использованием соединителем AS2 необходимо создать следующие элементы:

Требование | Описание
--- | ---
Приложение TPM API | Перед созданием соединителя AS2 необходимо создать [соединитель BizTalk Trading Partner Management][1]. <br/><br/>**Примечание.** Необходимо знать имя приложения TPM API. 
База данных SQL Azure | Хранит элементы B2B, в том числе партнеров, схемы, сертификаты и соглашения. Каждому приложению API B2B требуется своя собственная база данных SQL Azure. <br/><br/>**Примечание.** Скопируйте строку подключения к этой базе данных.<br/><br/>[Создание базы данных SQL Azure](../sql-database-create-configure.md)
Контейнер хранилища BLOB-объектов Azure | Хранит свойства сообщений, если включена архивация AS2. Если архивация сообщений AS2 не требуется, то контейнер хранилища не нужен. <br/><br/>**Примечание.** Если вы включаете архивирование, скопируйте строку подключения к этому хранилищу больших двоичных объектов.<br/><br/>[Об учетных записях хранения Azure](../storage-create-storage-account.md)

## Создание соединителя AS2

Соединитель можно создать в приложении логики или непосредственно в Azure Marketplace. Создание соединителя в Marketplace

1. На начальной панели Azure выберите **Marketplace**.
2. Выберите **Приложения API** и найдите «Соединитель AS2».
3. Введите имя, план службы приложений и другие свойства.
4. Введите следующие параметры пакета:

	Свойство | Описание
--- | --- 
Строка подключения к базе данных | Введите строку подключения ADO.NET к созданной базе данных SQL Azure. При копировании строки подключения пароль в эту строку подключения не добавляется. Перед вставкой не забудьте указать пароль в строке подключения.
Включить архивацию для входящих сообщений | необязательный параметр. Включите это свойство, чтобы сохранять свойства входящего сообщения AS2, полученного от партнера. 
Строка подключения к хранилищу BLOB-объектов Azure | Введите строку подключения к созданному контейнеру хранилища BLOB-объектов Azure. Если архивация включена, закодированные и декодированные сообщения хранятся в этом контейнере хранилища.
Имя экземпляра TPM | Введите имя приложения API **управления торговыми партнерами BizTalk**, созданного ранее. При создании соединителя AS2 этот соединитель выполняет соглашения AS2 только в этом конкретном экземпляре TPM.

5. Нажмите кнопку **Создать**.

Торговые партнеры — это сущности, участвующие во взаимодействиях между компаниями. Когда два партнера устанавливают связь, это называется соглашением. Определенное соглашение строится на основе взаимодействия, которого желают достичь эти два партнера, и зависит от конкретного протокола или транспорта.

Описание действий по созданию соглашения торговых партнеров см. [здесь][2].

## Использование соединителя в качестве триггера

1. При создании или изменении логики приложения выберите соединитель AS2, созданный на панели справа: <br/> ![Настройки триггера][3]

2. Щелкните стрелку вправо →: <br/> ![Параметры триггера][4]

3. Соединитель AS2 предоставляет один триггер. Выберите *Получение и декодирование*: <br/> ![Получение и декодирование входных данных][5]

4. Этот триггер не имеет входных данных. Щелкните стрелку вправо →: <br/> ![Получение и декодирование настроены][6]

В рамках вывода соединитель возвращает полезные данные AS2 и характерные для AS2 метаданные.

## Использование соединителя в качестве действия
1. После триггера (или выбора параметра «Запустить эту логику вручную») добавьте соединитель AS2, созданный в области справа: <br/> ![Настройки действия][7]

2. Щелкните стрелку вправо →: <br/> ![Список действий][8]

3. Соединитель AS2 поддерживает только одно действие. Выберите *Кодирование и отправка*: <br/> ![Кодирование и отправка входных данных][9]

4. Введите входные данные для действия и настройте его: <br/> ![Кодирование и отправка настроены][10]

Параметры:

Параметр | Тип | Описание
--- | --- | ---
Полезные данные | object| Содержимое полезных данных для кодирования и публикации в настроенной конечной точке. Полезные данные необходимо предоставить в виде объекта JSON.
AS2 из | string | Удостоверение AS2 отправителя сообщения AS2. Этот параметр используется для поиска соответствующего соглашения для отправки сообщения.
AS2 в | string | Удостоверение AS2 получателя сообщения AS2. Этот параметр используется для поиска соответствующего соглашения для отправки сообщения.
URL-адрес партнера | string | Конечная точка участника, которому требуется отправить сообщение.
Включить архивирование | Логическое | Определяет, следует ли архивировать исходящее сообщение.

Это действие возвращает код ответа HTTP 200 при успешном завершении.

## Дополнительные возможности соединителя
Дополнительные сведения о приложениях логики см. в статье [Что такое приложения логики?](app-service-logic-what-are-logic-apps.md).

Создание приложений API с помощью интерфейсов REST API. См. [Справочные материалы по соединителям и приложениям API](http://go.microsoft.com/fwlink/p/?LinkId=529766).

Можно также просматривать статистику производительности и управлять безопасностью соединителя. См. статью [Управление встроенными приложениями API и соединителями, а также их мониторинг](app-service-logic-monitor-your-connectors.md).

<!--References -->
[1]: app-service-logic-connector-tpm.md
[2]: app-service-logic-create-a-trading-partner-agreement.md
[3]: ./media/app-service-logic-connector-as2/TriggerSettings.PNG
[4]: ./media/app-service-logic-connector-as2/TriggerOptions.PNG
[5]: ./media/app-service-logic-connector-as2/ReceiveAndDecodeInput.PNG
[6]: ./media/app-service-logic-connector-as2/ReceiveAndDecodeConfigured.PNG
[7]: ./media/app-service-logic-connector-as2/ActionSettings.PNG
[8]: ./media/app-service-logic-connector-as2/ListOfActions.PNG
[9]: ./media/app-service-logic-connector-as2/EncodeAndSendInput.PNG
[10]: ./media/app-service-logic-connector-as2/EncodeAndSendConfigured.PNG

<!---HONumber=July15_HO3-->