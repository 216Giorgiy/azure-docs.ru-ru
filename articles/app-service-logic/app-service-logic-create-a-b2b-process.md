<properties 
   pageTitle="Создание процесса B2B в службе приложений Azure | Microsoft Azure" 
   description="Общие сведения по созданию процесса ";бизнес-бизнес";" 
   services="logic-apps" 
   documentationCenter=".net,nodejs,java" 
   authors="rajram" 
   manager="erikre" 
   editor=""/>

<tags
   ms.service="logic-apps"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration" 
   ms.date="04/20/2016"
   ms.author="rajram"/>

# Создание процесса B2B

[AZURE.INCLUDE [app-service-logic-version-message](../../includes/app-service-logic-version-message.md)]


## Бизнес-сценарий 
Компании Contoso и Northwind являются деловыми партнерами. Компания Contoso (розничный магазин) отправляет заказы на покупку компании Northwind (поставщику) посредством транспортировки уровня транспорта, например AS2. Northwind сохраняет все входящие заказы в своем облачном хранилище. Заказы на покупку представляют собой XML-сообщения между этими двумя партнерами. После того как сообщение сохраняется в облачном хранилище Northwind, заказ обрабатывают внутренние процессы Northwind.
 
Цель данного руководства состоит в том, чтобы показать, как компания Northwind может установить бизнес-процесс, с помощью которого она может получать сообщения (заказы на покупку в формате XML) от партнера Contoso через AS2 и затем сохранять их в своем облачном хранилище.


## Демонстрируемые возможности 
Этот учебник помогает продемонстрировать следующие возможности.

- **Транспортировка сообщений**. Розничный магазин и поставщик могут быть на разных платформах, но они по-прежнему могут наладить взаимодействие. В этом учебнике они взаимодействуют через AS2 (постановление о пределах применения 2). AS2 — это популярный способ передачи данных между торговыми партнерами при взаимодействиях «бизнес — бизнес».
- **Сохранение данных**. После получения сообщения через AS2 компания Northwind хочет сохранить его, прежде чем продолжить обработку. Она может использовать соединитель для сохранения сообщений в своем облачном хранилище. В этом учебнике в качестве облачного хранилища для Northwind используются BLOB-объекты Azure.
- **Создание бизнес-процесса**. В потоке могут соединяться вместе несколько приложений API, чтобы добиться того результата, который демонстрируется здесь.


## Перед началом работы
В этом учебнике предполагается, что вы имеете базовые знания в области служб приложений Azure, знаете, как создавать приложения API и как скомпоновать поток.


## Действия по обеспечению бизнес-сценария
**Создание и настройка необходимых приложений API**

1. Создайте экземпляр **соединителя больших двоичных объектов хранилища Azure**. Для этого необходимы учетные данные для учетной записи хранения Azure. Убедитесь, что они имеются, прежде чем приступить к созданию.
2. Создайте экземпляр **управления торговыми партнерами BizTalk**. Для этого требуется функционирующая пустая база данных SQL. Перед созданием убедитесь, что она готова.
3. Создайте экземпляр **соединителя AS2**. Для этого также требуется функционирующая пустая база данных SQL. Перед созданием убедитесь, что она готова. Кроме того, если вы хотите архивировать сообщения в рамках обработки AS2, вы можете предоставить учетные данные в BLOB-объект Azure во время его создания.
4. Настройте созданную службу TPM (управления торговыми партнерами).
	1. Найдите экземпляр службы TPM, созданный на одном из шагов выше.
	2. Используйте параметр **Партнеры** в разделе *Компоненты*, чтобы **добавить** нового партнера с именем **Contoso**, и в его профиле добавьте необходимое удостоверение AS2.
	3. Используйте параметр **Партнеры** в разделе *Компоненты*, чтобы **добавить** нового партнера с именем **Northwind**, и в его профиле добавьте необходимое удостоверение AS2.
	4. Используйте параметр **Соглашения** в разделе *Компоненты*, чтобы **добавить** новое соглашение AS2 между Northwind и Contoso. Здесь Northwind будет размещенным партнером, а Contoso — гостевым партнером. Настройте соответствующим образом подписывание, шифрование, сжатие и подтверждения в процессе создания этого соглашения. В случае когда необходимо использовать сертификаты, их можно загрузить с помощью параметра **Сертификаты** при просмотре созданной службы TPM.


## Создание потока и бизнес-процесса
1. Создайте новый поток, первым шагом в котором является AS2. Перетащите **соединитель AS2** и выберите уже созданный экземпляр. Выберите триггер как функциональную возможность: ![][1].
2. Перетащите **соединитель больших двоичных объектов хранилища Azure** и выберите уже созданный экземпляр. Выберите действие в качестве функциональной возможности и **Отправка BLOB-объекта** в качестве нужной функции. Настройте соответствующим образом.
3. Теперь создайте и разверните поток.


## Обработка сообщений и устранение неполадок
1. Теперь следует протестировать поток, который необходимо развернуть. Отправьте сообщения XML, заключенные в AS2 (по соглашению AS2, созданному выше), в конечную точку AS2, обработанную созданным экземпляром соединителя AS2. Может потребоваться настроить проверку подлинности для этой конечной точки, чтобы она была общедоступной.
2. Сведения о выполнении потока можно получить, перейдя к потоку и войдя в выполнявшийся экземпляр потока.
3. Для получения сведений об обработке AS2 перейдите в задействованный экземпляр соединителя AS2, а затем войдите в раздел отслеживания. Вы можете использовать фильтры, чтобы отображать в представлении только нужные сведения.

![][2]

<!--Image references-->
[1]: ./media/app-service-logic-create-a-b2b-process/Flow.png
[2]: ./media/app-service-logic-create-a-b2b-process/Tracking.png
 

<!---HONumber=AcomDC_0803_2016-->