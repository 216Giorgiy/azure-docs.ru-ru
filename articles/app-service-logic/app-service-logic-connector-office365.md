<properties
   pageTitle="Использование соединителя Office 365 в приложениях логики | Служба приложений Microsoft Azure"
   description="Как создать и настроить соединитель Office 365 или приложение API и использовать его в приложении логики в службе приложений Azure"
   services="app-service\logic"
   documentationCenter=".net,nodejs,java"
   authors="anuragdalmia"
   manager="dwrede"
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration"
   ms.date="11/30/2015"
   ms.author="sameerch"/>


# Приступая к работе с соединителем Office 365: добавление в приложение логики
Подключитесь к учетной записи Office 365, чтобы отправлять и получать электронные сообщения, а также управлять календарем и контактами. Вы можете выполнять различные действия, такие как отправка, получение и извлечение сообщений электронной почты, создание и удаление событий в календаре и создание, обновление, получение и удаление контактов.

Приложения логики могут запускаться на основе разных источников данных и предлагать соединители для получения и обработки данных в рамках потока. Соединитель Office 365 можно добавить в рабочий процесс компании и обрабатывать данные в рамках этого процесса приложения логики.

**Базовые действия**

- Новое сообщение (триггер)
- Отправить сообщение
- Ответить на сообщение
- Отправить событие
- Добавить контакт

## Создание приложения API соединителя Office 365
Соединитель можно создать в приложении логики или непосредственно в Azure Marketplace. Создание соединителя в Marketplace

1. На начальной панели Azure выберите **Marketplace**.
2. Выполните поиск по запросу «Соединитель Office 365», выберите его, а затем нажмите кнопку **Создать**.
3.	Настройте соединитель Office365, предоставив сведения для плана размещения и группу ресурсов, а также выбрав имя приложения API. ![][21]


## Создание приложения логики
Давайте создадим простое приложение логики, которое инициируется при получении сообщения электронной почты (на адрес запросов на продажу — например, sales@contoso.com)). Это приложение логики создает событие, добавляет контакт со сведениями отправителя, отправляет электронное письмо в вашу личную учетную запись и в финале отправляет ответ с подтверждением.

1.	Войдите на портал Azure и последовательно выберите «Создать» > «Мобильные и веб-приложения» > «Приложение логики». ![][1]

2.	На странице «Создание приложения логики» предоставьте необходимые сведения, такие как имя, план обслуживания приложения и расположение. ![][2]

3.	Щелкните «Триггеры и действия», после чего откроется экран редактора приложения логики. ![][3]

4.	Выберите триггер Office 365 в разделе «Приложения API в этой группе ресурсов» в коллекции, чтобы добавить его в поток. ![][4]

6.	Для подключения к Office 365 требуется авторизация приложения логики, чтобы оно имело доступ к вашей учетной записи. Нажмите кнопку «Авторизовать», чтобы предоставить учетные данные для входа в Office 365. ![][5]

7.	Вы будете перенаправлены на страницу входа в Office 365, где можете пройти аутентификацию с помощью учетных данных своей учетной записи Office 365. ![][6] ![][7]

8.	После выполнения авторизации отображаются триггеры Office 365. ![][8]

9.	Выберите триггер «Новое сообщение электронной почты», и появятся входные параметры.


10.	Измените частоту триггера на «Минуты» и щелкните ✓. ![][9]

11. Триггер «Новое сообщение» Office 365 теперь настроен, и вы можете видеть, что отображаются также и выходные параметры. ![][10]

12.	В разделе «Последние использовавшиеся» коллекции выберите «Соединитель Office 365», и будет добавлено новое действие «Office 365».

13.	Выберите «Отправить событие» в списке действий. Появятся входные параметры действия «Отправить событие». ![][11]

14.	Укажите сведения о событии и щелкните ✓. ![][12]

15.	В разделе «Последние использовавшиеся» коллекции выберите «Соединитель Office 365», и будет добавлено новое действие «Office 365».

16.	Выберите «Добавить контакт» в списке действий, и появятся входные параметры действия «Добавить контакт». ![][13]

17.	Щелкните «+» рядом с полем «Адрес электронной почты» и выберите значение выходного поля «От» из триггера. ![][14]

18. Щелкните ✓. После этого настройка действия будет завершена. ![][15]

19.	В разделе «Последние использовавшиеся» коллекции выберите «Соединитель Office 365», и будет добавлено новое действие «Office 365».


20.	Выберите «Отправить сообщение электронной почты» в списке действий. Появятся входные параметры действия «Отправить сообщение электронной почты». ![][19]

21.	Предоставьте сведения, необходимые для отправки сообщения электронной почты. Вы можете создать сообщение, введя примерно следующее. Настроив действие «Отправить сообщение», нажмите ✓.

		Body - @concat('You got a new sales enquiry from',triggers().output.body.From)

	![][20]
22.	В разделе «Последние использовавшиеся» коллекции выберите «Соединитель Office 365», и будет добавлено новое действие «Office 365».


23.	Выберите «Ответить» в списке действий. Появятся входные параметры действия «Ответить». ![][16]

24.	Щелкните «+» рядом с полем «От», выберите значение из идентификатора входного сообщения в триггере и щелкните ✓. ![][17]

25. Нажмите кнопку «ОК» на экране редактора приложения логики, а затем нажмите кнопку «Создать». Создание займет приблизительно 30 секунд.

26. Отправьте сообщение электронной почты в учетную запись, которую вы настроили в триггере, и вы должны увидеть сообщение электронной почты в своей личной учетной записи, событие календаря и контакт в вашей почтовой учетной записи Office. Кроме того, вы должны получить ответ с подтверждением, что на ваш запрос на продажу будет вскоре отвечено.

## Дополнительные возможности соединителя
После создания соединителя его можно добавить в рабочий бизнес-процесс с помощью приложения логики. См. раздел [Что такое приложения логики?](app-service-logic-what-are-logic-apps.md).

> [AZURE.NOTE]Если вы хотите начать работу с приложениями логики Azure до создания учетной записи Azure, перейдите на веб-сайт [пробного использования приложений логики](https://tryappservice.azure.com/?appservice=logic). На этом сайте вы сможете быстро создать кратковременное приложение логики начального уровня в службе приложений. Никаких кредитных карт и обязательств.

Справочные материалы по REST API Swagger см. в статье [Справочные материалы по соединителям и приложениям API](http://go.microsoft.com/fwlink/p/?LinkId=529766).

Можно также просматривать статистику производительности и управлять безопасностью соединителя. См. статью [Управление встроенными приложениями API и соединителями, а также их мониторинг](app-service-logic-monitor-your-connectors.md).

<!--Image references-->
[1]: ./media/app-service-logic-connector-office365/1_New_Logic_App.png
[2]: ./media/app-service-logic-connector-office365/2_Logic_App_Settings.png
[3]: ./media/app-service-logic-connector-office365/3_Logic_App_Editor.png
[4]: ./media/app-service-logic-connector-office365/4_Select_Office365_Gallery.png
[5]: ./media/app-service-logic-connector-office365/5_Office365_Authorize.png
[6]: ./media/app-service-logic-connector-office365/6_Office365_Login.png
[7]: ./media/app-service-logic-connector-office365/7_Office365_User_Consent.png
[8]: ./media/app-service-logic-connector-office365/8_Office365_Trigger.png
[9]: ./media/app-service-logic-connector-office365/9_Office365_Trigger_Settings.png
[10]: ./media/app-service-logic-connector-office365/10_Office365_Trigger_Configured.png
[11]: ./media/app-service-logic-connector-office365/11_Office365_Actions_List.png
[12]: ./media/app-service-logic-connector-office365/12_Office365_Create_Event_Inputs.png
[13]: ./media/app-service-logic-connector-office365/13_Office365_Add_Contact_Inputs.png
[14]: ./media/app-service-logic-connector-office365/14_Office365_Add_Contact_Email_FromTrigger.png
[15]: ./media/app-service-logic-connector-office365/15_Office365_Add_Contacts_Configured.png
[16]: ./media/app-service-logic-connector-office365/16_Office365_Reply_To_Inputs.png
[17]: ./media/app-service-logic-connector-office365/17_Office365_Reply_To_MessageId.png
[18]: ./media/app-service-logic-connector-office365/18_Office365_Reply_To_Configured.png
[19]: ./media/app-service-logic-connector-office365/19_Office365_Send_Inputs.png
[20]: ./media/app-service-logic-connector-office365/20_Office365_Send_Configured.png
[21]: ./media/app-service-logic-connector-office365/21-create-new-o365-api-app.png

<!---HONumber=AcomDC_1203_2015-->