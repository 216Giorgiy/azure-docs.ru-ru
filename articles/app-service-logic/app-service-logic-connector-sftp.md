<properties 
	pageTitle="Соединитель SFTP"
	description="Начало работы с соединителем SFTP"
	authors="anuragdalmia" 
	manager="dwrede" 
	editor="" 
	services="app-service\logic" 
	documentationCenter=""/>

<tags
	ms.service="app-service-logic"
	ms.workload="integration"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="03/31/2015"
	ms.author="adgoda"/>

# Использование соединителя SFTP в приложении логики #

Приложения логики могут запускаться на основе разных источников данных и предлагать соединители для получения и обработки данных в рамках потока. 

Соединитель SFTP позволяет перемещать данные с SFTP-сервера и на него. Он позволяет загружать файлы с SFTP-сервера либо передавать/перечислять файлы с SFTP-сервера и на него.

## Создание соединителя SFTP для приложения логики ##
Чтобы использовать соединитель SFTP, сначала нужно создать экземпляр приложения API соединителя SFTP. Это можно сделать следующим образом.

1.	Откройте Azure Marketplace, нажав кнопку "+ СОЗДАТЬ" в нижнем левом углу портала Azure.
2.	Перейдите в раздел "Мобильные и веб-приложения &gt; Приложения API" и выполните поиск элемента "Соединитель SFTP".
3.	Настройте соединитель SFTP следующим образом.
 
	![][1] 
	- **Расположение** - - выберите географическое расположение, где планируется развернуть соединитель.
	- **Подписка** - выберите подписку, в которой нужно создать соединитель.
	- **Группа ресурсов** - выберите или создайте группу ресурсов, в которой следует разместить соединитель.
	- **План веб-хостинга** - выберите или создайте план веб-хостинга.
	- **Ценовая категория** - выберите ценовую категорию для соединителя.
	- **Имя** - назначьте имя этому соединителю SFTP.
	- **Параметры пакета**
		- **Адрес сервера** - укажите имя или IP-адрес SFTP-сервера.
		- **Принять любой HostKey сервера SSH** - определяет, должны ли приниматься все отпечатки открытого хост-ключа SSH с сервера. Если задано значение false, хост-ключ будет сопоставлен с ключом, указанным в свойстве "Отпечаток хост-ключа сервера SSH".
		- **Хост-ключ сервера SSH** - укажите отпечаток открытого хост-ключа для сервера SSH.
		- **Корневая папка** - укажите путь к корневой папке.
		- **Шифр шифрования** - укажите шифр шифрования.
		- **Порт сервера** - укажите номер порта SFTP-сервера.
4. Нажмите кнопку "Создать". Будет создан новый соединитель SFTP.

5. Перейдите в только что созданное приложение API, последовательно выбрав "Обзор -> Приложения API -> <Имя только что созданного приложения API>". Вы увидите, что компонент "Безопасность" не настроен. 

	![][2]
6. Щелкните компонент "Безопасность" для настройки безопасности (имя пользователя, пароль, закрытый ключ, пароль файла PPK) для соединителя SFTP. 
Перейдите на вкладку авторизации "Пароль", "Закрытый ключ" или "Многофакторная проверка" в разделе "Безопасность" и укажите необходимые свойства.

	![][3]
	![][4]
	![][5]
6. После сохранения конфигурации безопасности можно создать логику приложения в той же группе ресурсов для использования соединителя SFTP. 

## Использование соединителя SFTP в приложении логики ##
После создания приложения API можно использовать соединитель SFTP как триггер или действие для приложения логики. Для этого необходимо выполнить следующие действия.

1.	Создайте новое приложение логики и выберите ту же группу ресурсов, которую имеет соединитель SFTP.
 	
	![][6]
2.	Откройте раздел "Триггеры и действия", чтобы открыть конструктор логических приложений и настроить поток. 
 	
	![][7]
3.	Соединитель SFTP отображается в разделе "Приложения API в этой группе ресурсов" в коллекции с правой стороны.
 
	![][8]
4.	Приложение API соединителя SFTP можно удалить в редакторе, щелкнув "Соединитель SFTP".
 
	
6.	Теперь можно использовать соединитель SFTP в потоке. Можно использовать файл, извлеченный из триггера SFTP (TriggerOnFileAvailable), для других действий в потоке. 

	**Примечание.** Триггер SFTP TriggerOnFileAvailable приведет к удалению извлеченного файла после обработки файла.

8.	Настройте входные свойства для триггера SFTP следующим образом.

	- **Путь к папке** - укажите путь к папке, из которой нужно извлечь файлы.
	- **Тип файла: текстовый или двоичный** - выберите тип файла.
	- **Маска файла** - укажите маску файла, которая будет применяться для извлечения файлов. '*' извлекает все файлы в указанной папке.
	- **Маска исключения файлов** - укажите маску файла, которая будет применяться для исключения файлов. Если также задано свойство "Маска файла", сначала будет применено свойство "Маска исключения файлов".

 
	![][9] 
	![][10]

7.	Аналогичным образом вы можете использовать действия SFTP в потоке. Можно использовать действие "Передать файл" для передачи файла на SFTP-сервер. Настройте входные свойства для действия "Передать файл" следующим образом.

	- **Содержимое** - задает содержимое файла для отправки.
	- **Кодировка передачи содержимого** - укажите "нет" или "base64".
	- **Путь к файлу** - задайте путь к файлу для передачи.
	- **Перезаписать** - укажите true, чтобы перезаписать файл, если он уже существует.
	- **Добавить, если существует** - указать true или false. При установке значения true данные добавляются в этот файл, если он существует. При установке значения false существующий файл будет перезаписан.
	- **Временная папка** - если значение указано, то адаптер отправит файл в 'Путь ко временной папке', а после завершения отправки этот файл будет перемещен в 'Путь к папке'. 'Путь к временной папке' должен находиться на одном физическом диске с 'Путь к папке' для обеспечения элементарной операции перемещения. Временная папка может использоваться, только если свойство 'Добавить, если существует' отключено.

	![][11]
	![][12]





<!-- Image reference -->
[1]: ./media/app-service-logic-connector-sftp/img1.PNG
[2]: ./media/app-service-logic-connector-sftp/img2.PNG
[3]: ./media/app-service-logic-connector-sftp/img3.PNG
[4]: ./media/app-service-logic-connector-sftp/img4.PNG
[5]: ./media/app-service-logic-connector-sftp/img5.PNG
[6]: ./media/app-service-logic-connector-sftp/img6.PNG
[7]: ./media/app-service-logic-connector-sftp/img7.png
[8]: ./media/app-service-logic-connector-sftp/img8.png
[9]: ./media/app-service-logic-connector-sftp/img9.PNG
[10]: ./media/app-service-logic-connector-sftp/img10.PNG
[11]: ./media/app-service-logic-connector-sftp/img11.PNG
[12]: ./media/app-service-logic-connector-sftp/img12.PNG


<!--HONumber=52--> 