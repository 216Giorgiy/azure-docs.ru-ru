<properties
	pageTitle="Интеграция с локальным сервером SAP в службе приложений Microsoft Azure"
	description="Узнайте, как выполнить интеграцию с локальным сервером SAP."
	authors="rajeshramabathiran"
	manager="dwrede"
	editor=""
	services="app-service\logic"
	documentationCenter=""/>

<tags
	ms.service="app-service-logic"
	ms.workload="integration"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/02/2015"
	ms.author="sameerch"/>


# Интеграция с локальным сервером SAP
С помощью соединителя SAP вы можете подключать веб-приложения, мобильные приложения и приложения логики службы приложений Azure к вашему существующему серверу SAP. Вы можете вызывать RFC, BAPI, tRFC, а также отправлять IDOC на сервер SAP.

Сервер SAP может даже находиться за вашим брандмауэром в локальной среде. В случае локального сервера подключение устанавливается посредством гибридного прослушивателя, как показано на рисунке.

![Поток гибридного подключения][1]

Соединитель SAP в облаке не может напрямую подключаться к серверу SAP за брандмауэром. Гибридный прослушиватель ликвидирует этот пробел, размещая конечную точку ретрансляции, которая позволяет соединителю безопасно устанавливать подключение к серверу SAP.


## Различные способы интеграции с SAP
Поддерживаются следующие действия:

- вызов RFC;
- вызов TRFC;
- вызов BAPI;
- отправка IDoc.

## Предварительные требования
На клиентском компьютере, где установлен и работает гибридный прослушиватель, требуются определенные клиентские библиотеки SAP. Подробные сведения приводятся [здесь][9] в разделе **Для адаптера SAP**.


## Создание нового адаптера SAP
1. Войдите на портал управления Azure.
2. Нажмите кнопку **Создать**.
3. В колонке создания выберите **Вычисления** > **Azure Marketplace**.
4. В колонке Marketplace выберите **Приложения API** и в поле поиска задайте поиск по ключевому слову SAP:

	![Приложение API соединителя SAP][2]
5. Выберите **соединитель SAP**, опубликованный Майкрософт.
6. В колонке соединителя SAP нажмите кнопку **Создать**.
7. В новой открывшейся колонке введите следующее.
	1. **Расположение** — выберите географическое расположение, где планируется развертывание соединителя.
	2. **Подписка** — выберите подписку, в которой нужно создать соединитель.
	3. **Группа ресурсов** — выберите или создайте группу ресурсов, в которой следует разместить соединитель.
	4. **План размещения веб-сайтов** — выберите или создайте план размещения веб-сайтов.
	5. **Ценовая категория** — выберите ценовую категорию для соединителя.
	6. **Имя** — введите имя соединителя SAP.
	7. **Параметры пакета**
		- **Имя сервера** — введите имя сервера SAP. Пример: SAPserver или SAPserver.mydomain.com.
		- **Имя пользователя** — введите допустимое имя пользователя для подключения к серверу SAP.
		- **Пароль** — введите действительный пароль для подключения к серверу SAP.
		- **Номер системы** — введите номер системы сервера приложений SAP.
		- **Язык** — введите язык входа в систему, например EN. Если значение не задано, используется значение EN.
		- **Локальный** — укажите, является ваш сервер SAP локальным сервером за брандмауэром или нет. Если установлено значение TRUE, необходимо установить агент прослушивателя на сервере, который может получать доступ к серверу SAP. Вы можете перейти на страницу сводных данных по приложению API и выбрать «Гибридное подключение» для установки агента.
		- **Строка подключения к служебной шине** — введите этот параметр, если ваш сервер SAP локальный. Это должна быть допустимая строка подключения к пространству имен служебной шины.
		- **RFC** — введите RFC в SAP, которые разрешено вызывать этому соединителю.
		- **TRFC** — введите TRFC в SAP, которые разрешено вызывать этому соединителю.
		- **BAPI** — введите BAPI в SAP, которые разрешено вызывать этому соединителю.
		- **IDOC** — введите IDOC в SAP, которые могут отправляться этим соединителем.
	8. Нажмите «Выбрать». В течение нескольких минут будет создан соединитель SAP.


## Установка гибридного прослушивателя
Найдите созданный соединитель SAP, нажав **Обзор** > **Приложения API** > *имя вашего соединителя*.

В колонке соединителя обратите внимание, что гибридное подключение находится в состоянии ожидания. Выберите гибридное подключение. Откроется колонка гибридного подключения.

![Колонка гибридного подключения][3]

Скопируйте строку конфигурации основного шлюза. Она будет использоваться позднее в процессе настройки установки гибридного прослушивателя.

Нажмите ссылку **Загрузить и настроить** и запустите установщик ClickOnce:

![Установщик ClickOnce гибридного подключения][4]

Нажмите кнопку **Установить**, а затем введите строку конфигурации шлюза, скопированную ранее:

![Строка подключения прослушивания ретрансляции][5]

Нажмите кнопку **Установить**, чтобы выполнить установку диспетчера гибридного подключения:

![Выполняется установка диспетчера гибридного подключения.][6]

![Установка диспетчера гибридного подключения завершена.][7]

## Проверка гибридного подключения
Найдите созданный соединитель SAP, нажав **Обзор** > **Приложения API** > *имя вашего соединителя*.

В колонке соединителя обратите внимание, что гибридное подключение находится в состоянии *Подключено*.

![Состояние гибридного подключения — подключено.][8]


## Использование соединителя SAP в приложениях логики
После создания соединителя SAP его можно использовать в рабочем процессе приложения логики.

Создайте новое приложение логики, последовательно выбрав **Создать** > **Приложения логики** > **Создать**. Введите метаданные для приложения логики, включая группу ресурсов.

Щелкните **Триггеры и действия**. Откроется конструктор рабочих процессов приложения логики.

Выберите соединитель SAP на правой панели и выберите действие на вкладке «действия».

> [AZURE.NOTE]Отображается список действий на основе конфигурации, введенной при создании соединителя SAP.

Для выбранного действия вы видите входные и выходные параметры. Вы можете ввести в качестве входных данных для действия и использовать результат выполнения текущего действия в других приложениях API, возможно, для дальнейшего принятия решений в рабочем процессе.

<!--Image references-->
[1]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnectivityFlow.PNG
[2]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/SAPConnector.APIApp.PNG
[3]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnection.PNG
[4]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnection.ClickOnceInstaller.PNG
[5]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnection.ClickOnceInstaller.RelayInformation.PNG
[6]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnectionManager.Install.InProgress.PNG
[7]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/HybridConnectionManager.Install.Completed.PNG
[8]: ./media/app-service-logic-integrate-with-an-on-premise-SAP-server/SAPConnector.HybridConnection.Connected.PNG
[9]: http://download.microsoft.com/download/2/D/7/2D7CE8DF-A6C5-45F0-8319-14C3F1F9A0C7/InstallationGuide.htm

<!---HONumber=July15_HO3-->