
<properties 
    pageTitle="Данные профиля пользователя в Azure RemoteApp | Microsoft Azure"
	description="Узнайте, как обеспечивается хранение данных пользователя и доступ к ним в Azure RemoteApp"
	services="remoteapp"
	documentationCenter="" 
	authors="lizap" 
	manager="mbaldwin" />

<tags 
    ms.service="remoteapp" 
    ms.workload="compute" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/28/2015" 
    ms.author="elizapo" />



# Как Azure RemoteApp сохраняет данные и параметры пользователя?

Azure RemoteApp сохраняет удостоверения и настройки пользователя для различных устройств и сеансов. Такие данные пользователей хранятся на диске для каждой коллекции и для каждого пользователя, который называется диском профиля пользователя (UPD). Диск привязан к пользователю и гарантирует, что данный пользователь имеет согласованный интерфейс, независимо от того, где выполняется вход в систему.

Диски профилей пользователей полностью прозрачны для пользователя — пользователи сохраняют документы в своей папке Документы (на локальном диске) и изменяют свои параметры приложения обычным образом. В то же время, при подключении к Azure RemoteApp с любого устройства все личные настройки сохраняются. Пользователь только видит, что его данные находятся в том же месте.

Каждый UPD имеет 50 ГБ памяти для постоянного хранения и содержит как данные пользователя, так и параметры приложения.

Чтение конкретных сведений в данных профиля пользователя.

## Как администратор может получить доступ к данным?

Если вам требуется доступ к данным одного из своих пользователей (для аварийного восстановления или если пользователь покидает компанию), обратитесь в [Azure RemoteApp](mailto:remoteappforum@microsoft.com) и предоставьте сведения о подписке для коллекции и идентификации пользователя. Команда Azure RemoteApp предоставит вам URL-адрес для загрузки VHD. Загрузите VHD по ссылке и извлеките документы и файлы, которые вам потребуются. Обратите внимание, что VHD имеет размер 50 ГБ, поэтому для его загрузки потребуется некоторое время.


## Выполняется ли резервное копирование данных?

Да, мы сохраняем резервную копию данных пользователя для каждого географического расположения. Данные доступны только для чтения. Обращаться к ним можно точно так же, как к обычным данным (обратитесь к Azure RemoteApp, чтобы получить сведения о процедуре доступа), если основной ЦОД не работает. Данные копируются в режиме реального времени в папку резервного копирования. Мы не храним копии различных версий. Таким образом, при повреждении данных мы не сможем восстановить предыдущую известную рабочую версию, однако если основной ЦОД не будет работать, вы сможете получить данные пользователя из другого расположения.

## Каким образом пользователи видят UPD на стороне сервера?

Каждый пользователь будет иметь свой собственный каталог на сервере, который соответствует его имени пользователя — UPD: c:\\Users\\имя\_пользователя.

## Как лучше всего использовать Outlook и UPD?

Azure RemoteApp сохраняет состояние Outlook (почтовые ящики, PST-файлы) между сеансами. Для этого нужно сохранить PST-файл в данных профиля пользователя (c:\\users < имя\_пользователя >). Это расположение по умолчанию для данных. Следовательно, если это расположение не изменяется, данные будут сохраняться между сеансами.

Также рекомендуем использовать «кэшированный» режим в Outlook, а также режим server/online для поиска.

## Можно ли использовать решения с общими данными?
Да, Azure RemoteApp позволяет использовать решения с общими данными, в частности OneDrive для бизнеса и Dropbox. Однако следует отметить, что OneDrive Consumer (персональная версия) и Box не поддерживаются.

## Поддерживается ли перенаправление?
Azure RemoteApp можно настроить так, чтобы пользователи имели возможность доступа к локальным устройствам путем настройки [перенаправления](remoteapp-redirection.md). В результате локальные устройства будут иметь доступ к данным на UPD.

## Можно ли использовать мой диск UPD в качестве общей сетевой папки?
Нет. Диски UPD не могут использоваться в качестве общей сетевой папки. Диск UPD доступен пользователю, только если пользователь постоянно подключен к Azure RemoteApp.

## Если удалить пользователя из коллекции, удаляется ли также и его диск UPD?

Нет, при удалении пользователя мы не удаляем UPD автоматически. Вместо этого мы храним данные до тех пор, пока не будет удалена коллекция. Через 90 дней после удаления коллекции мы удалим все диски UPD.

Если вам необходимо удалить диск UPD из коллекции, обратитесь в службу Azure RemoteApp — мы сможем сами удалить нужный диск UPD.

## Можно ли получить доступ к дискам UPD моих пользователей (текущих или удаленных пользователей)?

Да, при обращении в службу [Azure RemoteApp](mailto:remoteappforum@microsoft.com) мы сможем настроить для вас соответствующий URL-адрес для доступа к данным. Вы получите около 10 часов на загрузку любых данных или файлов с диска UPD, а затем доступ окажется невозможен.

## Доступны ли диски UPD в автономном режиме (вне сети)?

Сейчас мы не предоставляем автономный доступ к дискам UPD вне 10-часового окна доступа, описанного выше. Это означает, что в настоящее время мы не можем предоставить вам более длительный доступ для выполнения более сложных задач, например для запуска антивирусных программ на дисках UPD или доступа к данным для проведения аудита.

## Сохраняются ли параметры раздела реестра?
Да, все записи в HKEY\_Current\_User является частью UPD.

## Можно ли отключить диски UPD для коллекции?

Да, вы можете попросить службу Azure RemoteApp отключить диски UPD для подписки, но не сможете выполнить отключение самостоятельно. Это означает, что диски UPD будут отключены для всех коллекций в подписке.

## Можно ли запретить пользователям сохранять данные на системном диске?

Да, но вам потребуется настроить эту функцию в образе шаблона перед созданием коллекции. Чтобы заблокировать доступ к системному диску, выполните следующие действия.

1. Запустите **gpedit.msc** в образе шаблона.
2. Выберите **Конфигурация пользователя > Административные шаблоны > Компоненты Windows > Проводник**.
3. Выберите следующие параметры.
	- **Скрыть выбранные диски на моем компьютере**
	- **Запретить доступ к дискам с моего компьютера**

## Могу ли я загружать данные на диски UPD? Я хочу загрузить некоторые данные на диск UPD, который будет доступен при первом входе пользователя в систему.

Да, при создании образа шаблона вы можете добавить сведения в профиль по умолчанию. Затем эти сведения добавляются на UPD.

## Можно ли изменять размер диска UPD в зависимости от объема данных, которые нужно сохранять?

Нет, все диски UPD имеют емкость 50 ГБ. Если вы хотите хранить различные объемы данных, попробуйте следующий вариант.

1. Отключите диски UPD для коллекции.
2. Настройте доступ к общей папке для пользователей.
3. Загрузите общую папку с помощью сценария запуска. Дополнительные сведения о сценариях запуска в Azure RemoteApp см. ниже.
4. Предложите пользователям сохранять все данные в общей папке.

Также можно использовать приложения синхронизации данных, например OneDrive для бизнеса.

## Как выполнить сценарий запуска в Azure RemoteApp?

Если необходимо выполнить сценарий запуска, начните с создания запланированной задачи в образе шаблона, который будет использоваться для коллекции. (Сделайте это *до* запуска sysprep.)

![Создание системной задачи](./media/remoteapp-upd/upd1.png)

![Создайте системную задачу, которая запускается при входе пользователя в систему](./media/remoteapp-upd/upd2.png)

Запланированная задача выполнит сценарий запуска с помощью учетных данных пользователя. Запланируйте выполнение задачи при каждом входе пользователя в систему.

![Установите триггер для задачи со значением «При входе в систему»](./media/remoteapp-upd/upd3.png)

Можно также использовать [Сценарии запуска на основе групповой политики](https://technet.microsoft.com/library/cc779329%28v=ws.10%29.aspx).

## Что будет, если поместить сценарий запуска в меню «Пуск»? Это будет работать?

Другими словами, можно ли создать BAT-файл, который будет запускать сценарий окна настройки, и сохранить его в папке c:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp? Будет ли этот сценарий выполняться при каждом запуске пользователем сеанса RemoteApp?

Нет, Azure RemoteApp такую возможность не поддерживает, так как использует RDSH. Возможность выполнения сценариев запуска в меню «Пуск» также не поддерживается.

## Можно ли использовать mstsc.exe (программу удаленного рабочего стола) для настройки сценариев входа в систему?

Нет, это не поддерживается в Azure RemoteApp.

<!---HONumber=Nov15_HO1-->