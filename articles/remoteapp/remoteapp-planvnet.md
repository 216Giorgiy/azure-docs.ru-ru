<properties
    pageTitle="Планирование виртуальной сети для коллекции Azure RemoteApp | Microsoft Azure"
    description="Узнайте, как спланировать виртуальную сеть для коллекции Azure RemoteApp | Microsoft Azure"
    services="remoteapp"
    documentationCenter="" 
    authors="mghosh1616"
    manager="mbaldwin" />

<tags
    ms.service="remoteapp"
    ms.workload="compute"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="02/02/2016"
    ms.author="elizapo" />

# Планирование виртуальной сети для Azure RemoteApp

В этом документе описывается настройка виртуальной сети (VNET) и подсети Azure для Azure RemoteApp. Виртуальные сети Azure позволяют виртуализовать сетевую инфраструктуру в облаке и создавать гибридные решения, используя Azure и локальные ресурсы. Подробнее об этом можно прочитать [здесь](../virtual-network/virtual-networks-overview.md).

Если вы хотите определить политики безопасности для трафика (как входящего, так и исходящего) в виртуальной сети, в которой выполняется развертывание Azure RemoteApp, настоятельно рекомендуем создать для Azure RemoteApp отдельную подсеть. Дополнительные сведения об определении политик безопасности для подсети виртуальной сети Azure см. в статье [Группа безопасности сети](../virtual-network/virtual-networks-nsg.md).

## Типы коллекций Azure RemoteApp с виртуальными сетями Azure

На следующем рисунке показаны два типа коллекций, которые можно использовать для виртуальной сети.

### Облачная коллекция Azure RemoteApp с виртуальной сетью

 ![Azure RemoteApp — облачная коллекция с виртуальной сетью](./media/remoteapp-planvpn/ra-cloudvpn.png)

Это коллекция Azure RemoteApp, где все ресурсы, к которым требуется доступ хостам сеансов RemoteApp, развертываются в Azure. Они могут находиться в виртуальной сети RemoteApp VNET или другой виртуальной сети в Azure.

### Гибридная коллекция Azure RemoteApp с виртуальной сетью

![Azure RemoteApp — гибридная коллекция с виртуальной сетью](./media/remoteapp-planvpn/ra-hybridvpn.png)

Это коллекция Azure RemoteApp, где некоторые ресурсы, к которым требуется доступ хостам сеансов RemoteApp, развертываются локально. Виртуальная сеть RemoteApp связывается с локальной сетью с помощью гибридных технологий Azure, таких как VPN типа «сеть-сеть» или ExpressRoute.


## Принципы работы системы

Azure RemoteApp развертывает виртуальные машины Azure (с загруженного образа) в подсети виртуальной сети, выбранной во время подготовки. Если вы выбрали гибридную коллекцию, выполняется попытка разрешить полное доменное имя контроллера домена, введенного в рамках подготовки, на DNS-сервере в виртуальной сети. Если вы подключаетесь к существующей виртуальной сети, убедитесь, что в группах безопасности сети открыты необходимые порты для доступа к подсети Azure RemoteApp.

Для Azure RemoteApp рекомендуется использовать [достаточно большую подсеть](remoteapp-vnetsizing.md). Наибольшая поддерживаемая Azure виртуальная сеть — /8 (согласно классификации CIDR). Ваша подсеть должна быть способна вместить все виртуальные машины Azure RemoteApp при масштабировании, когда количество пользователей, обращающихся к приложениям, увеличивается.

В подсети виртуальной сети необходимо выполнить следующие действия.

2.	Следует разрешить исходящий трафик от подсети на портах 10101–10175, чтобы обеспечить взаимодействие с одной из внутренних служб Azure RemoteApp.
3.	Следует разрешить исходящий трафик от подсети для подключения к хранилищу Azure на порту 443.
4.	При использовании Active Directory в Azure убедитесь, что все виртуальные машины в подсети Azure RemoteApp могут соединяться с контроллером домена. DNS-сервер в виртуальной сети должен быть способен разрешить полное доменное имя этого контроллера домена.


## Виртуальная сеть с принудительным туннелированием

[Принудительное туннелирование](../vpn-gateway/vpn-gateway-about-forced-tunneling.md) теперь поддерживается во всех новых коллекциях Azure RemoteApp. Миграция существующих коллекций на поддерживающие принудительное туннелирование в настоящее время не предусмотрена. Чтобы получить коллекцию с поддержкой принудительного туннелирования, необходимо удалить все существующие коллекции, использующие виртуальную сеть, привязанную к Azure RemoteApp, а затем создать новую коллекцию.

<!---HONumber=AcomDC_0211_2016-->