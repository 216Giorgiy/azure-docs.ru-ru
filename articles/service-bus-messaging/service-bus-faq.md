<properties 
    pageTitle="Часто задаваемые вопросы о служебной шине | Microsoft Azure"
    description="Ответы на некоторые часто задаваемые вопросы о служебной шине Azure."
    services="service-bus"
    documentationCenter="na"
    authors="sethmanheim"
    manager="timlt"
    editor="" />
<tags 
    ms.service="service-bus"
    ms.devlang="na"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="na"
    ms.date="10/04/2016"
    ms.author="sethm;juconway" />


# <a name="service-bus-faq"></a>Часто задаваемые вопросы о служебной шине

В этой статье содержатся ответы на некоторые часто задаваемые вопросы о служебной шине Microsoft Azure. Вы также можете посетить страницу [Часто задаваемые вопросы о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083) , где содержатся общие сведения о расценках и поддержке Azure. В этой статье содержатся следующие разделы:

- [Общие вопросы об обмене сообщениями через служебную шину Azure](#general-questions-about-azure-service-bus-messaging)
- [Рекомендации по работе со служебной шиной](#service-bus-best-practices)
- [Служебная шина: цены](#service-bus-pricing)
- [Квоты на служебную шину](#service-bus-quotas)
- [Управление подпиской и пространством имен](#subscription-and-namespace-management)
- [Устранение неполадок](#service-bus-troubleshooting)

## <a name="general-questions-about-azure-service-bus-messaging"></a>Общие вопросы об обмене сообщениями через служебную шину Azure

### <a name="what-is-azure-service-bus-messaging?"></a>Что такое обмен сообщениями через служебную шину Azure?

[Обмен сообщениями через служебную шину Azure](service-bus-messaging-overview.md) — это облачный механизм платформы асинхронного обмена сообщениями, который позволяет отправлять данные между несвязанными системами. Майкрософт предоставляет этот механизм в качестве службы. Это значит, что для его использования не потребуется устанавливать собственное оборудование.

### <a name="what-is-a-service-bus-namespace?"></a>Что такое пространство имен служебной шины?

[Пространство имен](service-bus-create-namespace-portal.md) предоставляет контейнер для адресации ресурсов служебной шины в вашем приложении. Необходимо создать пространство имен, чтобы использовать служебную шину. Это будет одним из первых шагов.

### <a name="what-is-an-azure-service-bus-queue?"></a>Что такое очередь служебной шины Azure?

[Очередь служебной шины](service-bus-queues-topics-subscriptions.md) — это сущность, в которой сохраняются сообщения. Их целесообразно использовать при наличии нескольких приложений или нескольких частей распределенного приложения, которые должны взаимодействовать друг с другом. Очередь подобна центру распределения, куда поступают несколько продуктов (сообщений), которые затем отправляются из этого расположения.

### <a name="what-are-azure-service-bus-topics-and-subscriptions?"></a>Что такое разделы и подписки служебной шины Azure?

Раздел можно представить в виде очереди. При использовании нескольких подписок он становится расширенной моделью обмена сообщениями. По сути, это инструмент связи по принципу "один ко многим". В рамках этой модели публикации и подписки (*pub/sub*) сообщение может быть отправлено из приложения в раздел с несколькими подписками, а затем получено несколькими приложениями.

### <a name="what-is-the-azure-service-bus-relay-service?"></a>Что такое служба ретранслятора служебной шины Azure?

[Служба ретранслятора](../service-bus-relay/service-bus-relay-overview.md) предоставляет возможность прозрачно разместить службы WCF и получить к ним доступ из любого расположения. Другими словами, служба ретранслятора позволяет создавать гибридные приложения, которые можно запускать как в центре обработки данных Azure, так и в локальной корпоративной среде.

### <a name="what-is-a-partitioned-entity?"></a>Что такое секционированная сущность?

Обычная очередь или раздел обрабатываются одним брокером сообщений и сохраняются в одном хранилище сообщений. [Секционированная очередь или раздел](service-bus-partitioning.md) обрабатывается несколькими брокерами сообщений и хранится в нескольких хранилищах сообщений. Это означает, что общая пропускная способность секционированной очереди или раздела больше не ограничивается производительностью одного брокера сообщений или хранилища сообщений. Кроме того, при возникновении временного сбоя хранилища сообщений секционированная очередь или раздел останутся доступными.

Имейте в виду, что при использовании секционирования сущностей их упорядоченность не гарантируется. Если раздел недоступен, вы по-прежнему можете отправлять и получать сообщения из других секций.

## <a name="service-bus-best-practices"></a>Рекомендации по работе со служебной шиной

### <a name="what-are-some-azure-service-bus-best-practices?"></a>Рекомендации по работе со служебной шиной Azure

-   [Рекомендации по повышению производительности с помощью обмена сообщениями через брокер в служебной шине][]. В этой статье описывается, как оптимизировать производительность во время обмена сообщениями через брокер.

-   [Рекомендации по изолированию приложений от простоев и аварий служебной шины][]. В этой статье описываются оптимальные способы защиты очередей, разделов и конечных точек ретрансляции, а также использование активной и пассивной репликации для защиты центра обработки данных от простоев.

### <a name="what-should-i-know-before-creating-messaging-entities?"></a>Что необходимо знать перед созданием сущностей обмена сообщениями?   

Приведенные ниже свойства очереди и раздела являются неизменяемыми. Учитывайте это при подготовке сущностей, так как эти свойства можно изменить, только создав сущность для замены.

-   Размер

-   Секционирование

-   Сеансы:

-   Обнаружение дубликатов

-   экспресс-сущность.

## <a name="service-bus-pricing"></a>Сведения о ценах на служебную шину

В этом разделе содержатся ответы на некоторые часто задаваемые вопросы о ценах на использование служебной шины. Также можно посетить страницу [часто задаваемых вопросов о поддержке Azure](http://go.microsoft.com/fwlink/?LinkID=185083), где содержатся общие сведения о структуре ценообразования Microsoft Azure. Дополнительные сведения о ценах на использование служебной шины см. на странице [цен на служебную шину](https://azure.microsoft.com/pricing/details/service-bus/).

### <a name="how-do-you-charge-for-service-bus?"></a>Как выставляется цена на служебную шину?

Подробные сведения о ценах на использование служебной шины см. разделе [Сведения о ценах на использование служебной шины] [Обзор цен]. Помимо указанной платы, также взимается плата за связанные операции передачи данных, исходящих из центра обработки данных, в котором подготавливается ваше приложение.

### <a name="what-usage-of-service-bus-is-subject-to-data-transfer?-what-is-not?"></a>Какое использование служебной шины считается передачей данных? А какое не считается?

Любая передача данных в пределах заданного региона Azure выполняется бесплатно. Любая передача исходящих данных за пределы региона оплачивается по тарифу 0,15 доллара США за 1 ГБ исходящих данных из Северной Америки и Европы и 0,20 доллара США за 1 ГБ для данных из Азиатско-Тихоокеанского региона. Передача входящих данных осуществляется бесплатно.

### <a name="how-is-the-relay-hours-meter-calculated?"></a>Как вычисляется количество часов ретрансляции?

Плата за ретрансляцию взимается на основе совокупного количества часов в рамках заданного периода выставления счетов, на протяжении которых каждый ретранслятор служебной шины остается открытым. Ретранслятор неявно создается и открывается для адреса данной служебной шины (URL-адреса пространства имен службы) каждый раз, когда служба WCF с поддержкой ретрансляции (прослушиватель ретрансляции) подключается к этому адресу. Ретранслятор закрывается только тогда, когда последний прослушиватель отключается от его адреса. Таким образом, при выставлении счетов ретранслятор считается открытым с момента подключения первого прослушивателя ретрансляции к адресу служебной шины, участвующей в данной ретрансляции, и до момента отключения последнего прослушивателя от этого адреса. Иначе говоря, ретранслятор считается открытым каждый раз, когда один или несколько прослушивателей ретрансляции остаются подключенными к адресу соответствующей служебной шины.

### <a name="what-if-i-have-more-than-one-listener-connected-to-a-given-relay?"></a>Что делать, если к определенному ретранслятору подключено несколько прослушивателей?

В некоторых случаях к одному ретранслятору служебной шины могут подключаться несколько прослушивателей. Это может произойти при работе со службами балансировки нагрузки, использующими привязки WCF netTCPRelay или HttpRelay, или же широковещательными прослушивателями событий, использующими привязку WCF netEventRelay. Ретранслятор служебной шины считается открытым, если к нему подключен хотя бы один прослушиватель. Добавление дополнительных прослушивателей к открытому ретранслятору не влияет на его статус при выставлении счетов. Количество отправителей ретрансляции (клиентов, вызывающих или отправляющих сообщения ретрансляторам), подключенных к ретранслятору, также не влияет на подсчет часов ретрансляции.

### <a name="how-is-the-messages-meter-calculated-for-relays?"></a>Как вычисляется количество сообщений ретрансляторам?

В целом количество оплачиваемых сообщений для ретрансляторов вычисляется так же, как и для сущностей, использующих брокер, — очередей, разделов и подписок (см. выше). Тем не менее существует несколько важных отличий.

Отправка сообщения ретранслятору служебной шины рассматривается как полностью осуществленная отправка прослушивателю ретрансляции, который получает сообщение, а не отправка сообщения ретранслятору служебной шины с последующей его доставкой прослушивателю ретрансляции. Следовательно, при вызове службы типа "запрос — ответ" (размером до 64 КБ) на уровне прослушивателя ретрансляции будут зафиксированы следующие сообщения: одно оплачиваемое сообщение для запроса и одно оплачиваемое сообщение для ответа (при условии, что размер ответа также не превышает\< 64 КБ). Это отличается от механизма использования очереди в качестве посредника между клиентом и службой. В последнем случае в рамках одного и того же алгоритма типа «запрос-ответ» предусмотрена отправка запроса в очередь с последующим изъятием из очереди и доставкой в службы, отправкой ответа в другую очередь, а также изъятием из очереди и доставкой клиенту. При размере вызова, не превышающем \<64 КБ, использование схемы с посредником в виде очереди приведет к выставлению счета за четыре оплачиваемых сообщения. Это в два раза превышает плату за использование аналогичной схемы с ретранслятором. Конечно, использование такой схемы связано с определенными преимуществами, включая надежность и выравнивание нагрузки. Эти преимущества могут оправдать дополнительные расходы.

Ретрансляторы, открытые с помощью привязки WCF netTCPRelay, обрабатывают сообщения не по отдельности, а как поток данных, передаваемых через систему. Другими словами, сведения о формировании отдельных сообщений, отправленных и полученных с помощью этой привязки, доступны только отправителю и прослушивателю. Таким образом, для ретрансляторов, использующих привязку netTCPRelay, все данные обрабатываются как поток при вычислении количества оплачиваемых сообщений. В этом случае служебная шина вычислит общий объем данных, отправленных или полученных в ходе отдельной ретрансляции с 5-минутными интервалами. Затем полученное значение будет поделено на 64 КБ. Это позволит определить количество оплачиваемых сообщений ретранслятору, обработанных за заданный период.

### <a name="does-service-bus-charge-for-storage?"></a>Взимает ли служебная шина плату за использование хранилища?

Нет, служебная шина не взимает плату за использование хранилища. Тем не менее существует квота, ограничивающая максимальный объем данных, которые могут быть сохранены в каждой очереди или разделе. См. следующий раздел часто задаваемых вопросов.

## <a name="service-bus-quotas"></a>Квоты на служебную шину

Список ограничений и квот на служебную шину см. в этом [обзоре][].

### <a name="does-service-bus-have-any-usage-quotas?"></a>Есть ли у служебной шины квоты использования?

По умолчанию для любой облачной службы Майкрософт устанавливается квота совокупного месячного использования в рамках всех подписок клиента. Мы понимаем, что вам может потребоваться больше, чем разрешено этими ограничениями. В таком случае вы можете в любое время обратиться в службу поддержки пользователей, чтобы мы изменили эти ограничения на основе ваших потребностей. Для служебной шины установлены следующие квоты общего использования:

- 5 миллиардов сообщений;
- 2 миллиона часов ретрансляции.

Хотя мы оставляем за собой право отключить учетную запись клиента, превысившего свои месячные квоты использования, перед выполнением каких-либо действий мы отправим уведомления по электронной почте, а также предпримем несколько попыток, чтобы связаться с клиентом. Клиентам, превысившим свои квоты, будут выставлены соответствующие счета.

Как и в случае с другими службами в Azure, служебная шина использует набор особых квот для обеспечения справедливого использования ресурсов. Ниже приведены квоты использования, применяемые службой.

#### <a name="queue/topic-size"></a>Размер очереди или раздела

Вы задаете максимальный размер очереди или раздела при их создании. Эта квота может иметь значение 1, 2, 3, 4 или 5 ГБ. При достижении максимального значения квоты последующие входящие сообщения отклоняются, а вызывающий код получает исключение.

#### <a name="naming-restrictions"></a>Ограничения для имен

Имя пространства имен служебной шины должно иметь длину от 6 до 50 символов. Имя очереди, раздела или подписки должно иметь длину от 1 до 50 символов.

#### <a name="number-of-concurrent-connections"></a>Количество одновременных подключений

Очереди, разделы и подписки. Максимально допустимое количество параллельных TCP-подключений в очереди, разделе или подписке равно 100. После достижения квоты запросы на дополнительные соединения отклоняются, а вызывающий код получает исключение. Для каждой фабрики обмена сообщениями служебная шина поддерживает одно TCP-подключение, если у любого из клиентов, созданного такой фабрикой обмена сообщениями, есть активная операция в состоянии ожидания или операция, завершенная менее 60 секунд назад. Операции REST не считаются параллельными TCP-подключениями.

#### <a name="number-of-concurrent-listeners-on-a-relay"></a>Количество параллельных прослушивателей ретранслятора

Максимально допустимое количество параллельных прослушивателей **netTcpRelay** и n**etHttpRelay** на один ретранслятор равно 25 (для ретранслятора **NetOneway** — 1).

#### <a name="number-of-concurrent-relay-listeners-per-namespace"></a>Количество параллельных прослушивателей ретрансляции на одно пространство имен

Служебная шина применяет ограничение в 2000 параллельных прослушивателей ретрансляции на каждое пространство имен службы. После достижения квоты последующие запросы на открытие дополнительных прослушивателей ретрансляции отклоняются, а вызывающий код получает исключение.

#### <a name="number-of-topics/queues-per-service-namespace"></a>Количество разделов или очередей на одно пространство имен службы

Максимально допустимое количество разделов или очередей (сущностей долгосрочного резервного хранения) на одно пространство имен службы равно 10 000. После достижения этой квоты последующие запросы на создание нового раздела или очереди в пространстве имен службы будут отклонены. В таком случае на классическом портале Azure появится сообщение об ошибке или вызывающий код клиента получит исключение (в зависимости от того, выполнялась ли попытка создания с использованием портала или кода клиента).

### <a name="message-size-quotas"></a>Квоты на размер сообщения

#### <a name="queue/topic/subscription"></a>Очередь, раздел и подписка

**Размер сообщения**. Каждое сообщение ограничено суммарным размером 256 КБ, включая заголовки сообщения.

**Размер заголовка сообщения**. Каждый заголовок сообщения ограничен 64 КБ.

**Ретрансляторы NetOneway и NetEvent**. Каждое сообщение ограничено суммарным размером 64 КБ, включая заголовки.

**Ретрансляторы http и NetTcp**. В служебной шине отсутствует максимальное значение размера этих сообщений.

Сообщения, размер которых превышает эти значения, будут отклонены, а вызывающий код получит исключение.

**Количество подписок на раздел**. Максимально допустимое количество подписок на один раздел равно 2000. После достижения этой квоты последующие запросы на создание дополнительных подписок для раздела будут отклонены. В таком случае на классическом портале Azure появится сообщение об ошибке или вызывающий код клиента получит исключение (в зависимости от того, выполнялась ли попытка создания с использованием портала или кода клиента).

**Количество фильтров SQL на раздел**. Максимально допустимое количество фильтров SQL на один раздел равно 2000. После достижения квоты последующие запросы на создание дополнительных фильтров для раздела отклоняются, а вызывающий код получает исключение.

**Количество фильтров корреляции на раздел**. Максимально допустимое количество фильтров корреляции на один раздел равно 100 000. После достижения квоты последующие запросы на создание дополнительных фильтров для раздела отклоняются, а вызывающий код получает исключение.

## <a name="subscription-and-namespace-management"></a>Управление подпиской и пространством имен

### <a name="how-do-i-migrate-a-namespace-to-another-azure-subscription?"></a>Как перенести пространство имен в другую подписку Azure?

Чтобы переместить пространство имен из одной подписки Azure в другую, можно использовать команды PowerShell (приведенные [здесь][]). При перемещении пространство имен уже должно быть активно. Кроме того, пользователь, который выполняет команды, должен обладать правами администратора как в исходной, так и в целевой подписках.

## <a name="service-bus-troubleshooting"></a>Устранение неполадок, связанных со служебной шиной

[Общие сведения об исключениях][]

### <a name="what-are-some-of-the-exceptions-generated-by-azure-service-bus-messaging-apis-and-their-suggested-actions?"></a>Какие исключения создаются API обмена сообщениями через служебную шину Azure? Какие действия можно предпринять?

Исключения, создаваемые API обмена сообщениями, делятся на следующие категории:

-   ошибка кода пользователя;

-   ошибка установки и конфигурации;

-   временные исключения;

-   другие исключения.

В статье [Исключения обмена сообщениями служебной шины] [Общие сведения об исключениях] описываются некоторые исключения и рассматриваются действия по их устранению.

### <a name="what-is-a-shared-access-signature-and-which-languages-support-generating-a-signature?"></a>Что такое подписанный URL-адрес? На каких языках можно создавать подписи?

Подписанные URL-адреса представляют собой механизм аутентификации на базе алгоритма безопасного хэширования SHA-256 или URI. Дополнительные сведения о том, как создавать собственные подписи с использованием Node, PHP, Java и C\#, см. в статье о [Подписи коллективного доступа][].

## <a name="next-steps"></a>Дальнейшие действия

Дополнительную информацию об обмене сообщениями через служебную шину см. в следующих разделах.

- [Общие сведения об обмене сообщениями через служебную шину Azure уровня Premium (запись в блоге)](http://azure.microsoft.com/blog/introducing-azure-service-bus-premium-messaging/)
- [Общие сведения об обмене сообщениями через служебную шину Azure уровня Premium (Channel9)](https://channel9.msdn.com/Blogs/Subscribe/Introducing-Azure-Service-Bus-Premium-Messaging)
- [Основные сведения об обмене сообщениями через служебную шину](service-bus-messaging-overview.md)
- [Обзор архитектуры служебной шины Azure](service-bus-fundamentals-hybrid-solutions.md)
- [Начало работы с очередями служебной шины](service-bus-dotnet-get-started-with-queues.md)

[Рекомендации по повышению производительности с помощью обмена сообщениями через брокер в служебной шине]: service-bus-performance-improvements.md
[Рекомендации по изолированию приложений от простоев и аварий служебной шины]: service-bus-outages-disasters.md
[Общие сведения о ценах]: https://azure.microsoft.com/pricing/details/service-bus/
[Общие сведения о квотах]: service-bus-quotas.md
[здесь]: service-bus-powershell-how-to-provision.md#migrate-a-namespace-to-another-azure-subscription
[Общие сведения об исключениях]: service-bus-messaging-exceptions.md
[Подписи коллективного доступа]: service-bus-sas-overview.md



<!--HONumber=Oct16_HO2-->


