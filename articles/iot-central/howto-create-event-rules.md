---
title: Создание правил события и управление ими в приложении Azure IoT Central | Документация Майкрософт
description: Правила события Azure IoT Central позволяют отслеживать устройства практически в реальном времени и автоматически вызывать действия (например, отправлять сообщение электронной почты) при срабатывании правила.
services: iot-central
author: ankitgupta
ms.author: ankitgup
ms.date: 04/29/2018
ms.topic: article
ms.prod: microsoft-iot-central
manager: timlt
ms.openlocfilehash: ede7748b1471136cf792c2b30b7c90e12b0b274a
ms.sourcegitcommit: e0a678acb0dc928e5c5edde3ca04e6854eb05ea6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/13/2018
ms.locfileid: "39006854"
---
# <a name="create-an-event-rule-and-set-up-an-action-in-your-azure-iot-central-application"></a>Создание правила события и настройка действия в приложении Azure IoT Central

Вы можете использовать Microsoft Azure IoT Central для удаленного мониторинга подключенных устройств. Правила Azure IoT Central позволяют отслеживать устройства практически в реальном времени и автоматически вызывать действия (например, отправлять сообщение электронной почты или активировать рабочий процесс в Microsoft Flow при выполнении условий правила). Всего в несколько щелчков вы можете определить условие для отслеживания данных устройства и настроить вызываемое действие. В этой статье подробно описываются правила мониторинга событий.

Приложение Azure IoT Central использует [измерения событий](howto-set-up-template.md) для сбора данных устройства. Каждый тип измерения имеет ключевые атрибуты, определяющие измерение. Вы можете создавать правила для отслеживания каждого типа измерения устройства и генерировать оповещения при срабатывании правила. Правило события активируется, когда с устройства передается выбранное событие

## <a name="create-an-event-rule"></a>Создание правила события

В этом разделе показано, как создать правило события. В этом примере используется устройство охлаждаемого торгового автомата, сообщающее о событии сбоя в работе мотора вентилятора. Правило отслеживает передаваемые устройством данные события и отправляет сообщение при каждой передаче события.

1. Откройте страницу подробных сведений об устройстве, к которому добавляется правило.

1. Если вы еще не создали правило, появится следующий экран:

    ![Правила отсутствуют](media/howto-create-event-rules/image1.png)

1. На вкладке **Правила** выберите **+ New Rule** (+ Новое правило), чтобы просмотреть доступные для создания типы правил.

    ![Типы правил](media/howto-create-event-rules/image2.png)

1. Щелкните **Событие**, чтобы открыть форму для создания правила.

    ![Правило события](media/howto-create-event-rules/image3.png)

1. Выберите имя, определяющее правило в этом шаблоне устройства.

1. Чтобы немедленно включить правило для всех устройств, созданных на основе этого шаблона, переведите переключатель **Включить правило** в положение "Вкл.".

### <a name="configure-the-rule-condition"></a>Настройка условия правила

В этом разделе показано, как добавить условие для мониторинга измерения события возникновения ошибки в работе мотора вентилятора.

1. Выберите **+** рядом с разделом **Условие**.

1. Из раскрывающегося списка выберите измерение события, которое требуется отслеживать. В этом примере выбрано событие **Fan Motor Error** (Ошибка мотора вентилятора).

1. Можно также указать значение, если необходимо отслеживать конкретное значение события, передаваемого устройством. Например, если устройство передает одно событие с разными кодами ошибки. Вы можете указать код ошибки в качестве значения в условии правила, и тогда правило будет срабатывать только, когда устройство отправляет это конкретное значение в качестве полезных данных события. Если не указать это значение, правило будет срабатывать при каждом отправлении события, независимо от его значения.

    ![Добавление условия события](media/howto-create-event-rules/image4.png)

    > [!NOTE]
    > При определении условия правила события необходимо выбрать минимум одно измерение события.

1. Нажмите кнопку **Сохранить**, чтобы сохранить правило. Правило станет активным в течение нескольких минут и начнет выполнять мониторинг событий, отправляемых в приложение.

### <a name="add-an-action"></a>Добавление действия

В этом разделе показано, как добавить в правило действие. Здесь рассматривается добавление действия электронной почты, но вы также можете [добавить в правило действие Microsoft Flow](howto-add-microsoft-flow.md), чтобы при активации правила запускался рабочий процесс в Microsoft Flow.

> [!NOTE]
> Сейчас с одним правилом можно связать только одно действие.

1. Выберите **+** рядом с разделом **Действия**. Здесь отобразится список доступных действий.

    ![Добавление действия](media/howto-create-event-rules/image5.png)

1. Выберите действие **Электронное письмо**, введите допустимый адрес электронной почты в поле **Кому** и укажите примечание, отображаемое в тексте сообщения при срабатывании правила.

    > [!NOTE]
    > Письма отправляются только пользователям, которые были добавлены в приложение и входили в систему минимум один раз. Узнайте больше об [управлении пользователями](howto-administer.md) в Azure IoT Central.

   ![Настройка действия](media/howto-create-event-rules/image6.png)

1. Выберите команду **Сохранить**. Правило станет активным в течение нескольких минут и начнет выполнять мониторинг событий, отправляемых в приложение. Если условие, указанное в правиле, соответствует требованиям, правило активирует настроенное действие отправки сообщения электронной почты.

## <a name="parameterize-the-rule"></a>Параметризация правила

Действия также можно настроить, используя **свойство устройства** в качестве параметра. Если адрес электронной почты хранится в виде свойства устройства, его можно использовать при определении адреса **Кому**.

## <a name="delete-a-rule"></a>Удаление правила

Если вам больше не нужно правило, удалите его. Для этого откройте правило и щелкните **Удалить**. Удаление правила приводит к его удалению из шаблона устройства и всех связанных устройств.

## <a name="enable-or-disable-a-rule-for-a-device-template"></a>Включение или отключение правила для шаблона устройства

Перейдите к устройству и выберите правило, которое требуется включить или отключить. Переведение переключателя **Enable rule for all devices of this template** (Включить правило для всех устройств в шаблоне) в правиле позволяет включать или отключать правило для всех устройств, связанных с определенным шаблоном.

## <a name="enable-or-disable-a-rule-for-a-device"></a>Включение или отключение правила для устройства

Перейдите к устройству и выберите правило, которое требуется включить или отключить. Переведите переключатель **Enable rule for this device** (Включить правило для этого устройства), чтобы включить или отключить правило для этого устройства.

## <a name="next-steps"></a>Дополнительная информация

Вы узнали, как создавать правила в приложении Azure IoT Central, а значит вы готовы к следующему шагу.

> [!div class="nextstepaction"]
> [Добавление в правило действия Microsoft Flow](howto-add-microsoft-flow.md)
> [Управление устройствами](howto-manage-devices.md)
