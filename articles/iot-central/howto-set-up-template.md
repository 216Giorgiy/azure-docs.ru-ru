---
title: Настройка шаблона устройства в приложении Azure IoT Central | Документация Майкрософт
description: Подробные сведения о настройке измерений, параметров, свойств, правил и панели мониторинга в шаблоне устройства.
author: viv-liu
ms.author: viviali
ms.date: 10/26/2018
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: fc18262326a8474cac417b67a37df35d91d75439
ms.sourcegitcommit: de32e8825542b91f02da9e5d899d29bcc2c37f28
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2019
ms.locfileid: "55657745"
---
# <a name="set-up-a-device-template"></a>Настройка шаблона устройства

Шаблон устройства — это схема, которая определяет характеристики и поведение типа устройства, которое подключается к приложению Azure IoT Central.

Например, конструктор может создать шаблон устройства для подключенного к Интернету вещей вентилятора, который имеет:

- измерение телеметрии температуры;

- измерение событий ошибки двигателя вентилятора;

- измерение состояния работы вентилятора;

- параметр скорости вентилятора;

- свойство расположения;

- правила отправки оповещений;

- панель мониторинга, которая обеспечивает общее представление устройства.

На основе этого шаблона устройства можно создавать и подключать реальные вентиляторы с такими именами, как **fan-1** и **fan-2**. Все эти вентиляторы имеют измерения, параметры, свойства, правила и панель мониторинга, которые пользователи приложения могут отслеживать и контролировать.

> [!NOTE]
> Только администраторы и конструкторы могут создавать, изменять и удалять шаблоны устройств. Любой пользователь может создавать устройства на странице **Device Explorer** из имеющихся шаблонов устройств.

[!INCLUDE [iot-central-experimental-note](../../includes/iot-central-experimental-note.md)]

## <a name="create-a-device-template"></a>Создание шаблона устройства

1. Перейдите на страницу **конструктора приложений**.

2. Чтобы создать пустой шаблон, выберите **Create Device Template** (Создать шаблон устройства), а затем выберите **Custom** (Пользовательский).

3. Введите имя (например, Refrigerator-1) нового шаблона устройства и щелкните **Создать**.

   ![Страница сведений устройства с именем шаблона "Охлаждающее устройство"](./media/howto-set-up-template/devicedetailspage.png)

4. Теперь вы находитесь на странице **сведений об устройстве** нового имитированного устройства. Имитированное устройство автоматически создается при создании шаблона устройства. Оно передает данные и может контролироваться как реальное устройство.

Теперь рассмотрим каждую вкладку страницы **сведений об устройстве**.

## <a name="measurements"></a>Измерения

Измерения — это данные, поступающие с устройства. Можно добавить несколько измерений в шаблон устройства в зависимости от его возможностей.

- Измерения **телеметрии** — это точка числовых данных, которые устройство собирает с течением времени. Они представлены в виде непрерывного потока. Например, температура.
- Измерения **событий** представляют собой данные определенной точки во времени, которые представляют что-то значимое, связанное с устройством. Уровень серьезности указывает на важность события. Например, ошибка мотора вентилятора.
- **Измерения состояния** представляют состояние устройства или его компонентов в течение определенного периода времени. К примеру, режим вентилятора, который может быть определен как **работающий** и **остановленный**.

### <a name="create-a-telemetry-measurement"></a>Создание измерения телеметрии
Чтобы добавить измерение телеметрии, выберите **Изменить шаблон**, а затем нажмите кнопку **+ New Measurement** (+ Новое измерение). В качестве типа измерения выберите **Телеметрия** и введите сведения в форму **Create Telemetry** (Создание телеметрии).

> [!NOTE]
> Имена полей в шаблоне устройства должны совпадать с именами в соответствующем коде устройства. Это нужно для отображения в приложении данных телеметрии при подключении реального устройства. Того же принципа следует придерживаться при настройке параметров, свойств устройства и команд. Вы сможете определить шаблон устройства в последующих разделах.

Например, можно добавить новое измерение телеметрии температуры:
| Отображаемое имя        | Имя поля    |  Units    | Min   |Max|
| --------------------| ------------- |-----------|-------|---|
| температура;         | temp          |  градус Цельсия     |  0    |100|

![Форма создания телеметрии с подробными сведениями об измерении температуры](./media/howto-set-up-template/measurementsform.png)

Если щелкнуть **Готово**, в списке измерений отобразятся данные измерения **температуры**. Вскоре отобразится визуализация данных температуры, которые сгенерированы имитированным устройством. При создании шаблона создается имитированное устройство, которое позволяет проверить поведение приложения перед подключением физического реального устройства.


> [!NOTE]
  Данные телеметрии передаются в формате чисел с плавающей запятой.

### <a name="create-an-event-measurement"></a>Создание измерения события
Чтобы добавить измерение события, выберите **Изменить шаблон**, а затем нажмите кнопку **+ New Measurement** (+ Новое измерение). В качестве типа измерения выберите **Событие** и введите сведения в форму **Create Event** (Создание события).

Укажите сведения об **отображаемом имени**, **имени поля** и **серьезности** события. Доступно три уровня серьезности: **Ошибка**, **Внимание** и **Сведения**.  

Например, можно добавить новое событие **Ошибка мотора вентилятора**.

| Отображаемое имя        | Имя поля    |  Серьезность по умолчанию | 
| --------------------| ------------- |-----------|
| Ошибка вентилятора     | fanmotorerror |  Ошибка    | 

![Форма создания события с подробными сведениями о событии мотора вентилятора](./media/howto-set-up-template/eventmeasurementsform.png)

Если щелкнуть **Готово**, в списке измерений отобразятся данные измерения **ошибки мотора вентилятора**. Оператор может просматривать визуализации данных события, отправляемые с устройства.

![Диаграмма измерения события](./media/howto-set-up-template/eventmeasurementschart.png)

Чтобы просмотреть дополнительные сведения о событии, щелкните значок события на диаграмме.

![Подробные сведения о событии "Ошибка мотора вентилятора"](./media/howto-set-up-template/eventmeasurementsdetail.png)

> [!NOTE]
  Для измерения событий используется строковый тип данных.

### <a name="create-a-state-measurement"></a>Создание измерения состояния
Чтобы добавить измерение состояния, выберите **Изменить шаблон**, а затем нажмите кнопку **+ New Measurement** (+ Новое измерение). В качестве типа измерения выберите **Состояние** и введите сведения в форму **Create State** (Создание состояния).

Укажите сведения об **отображаемом имени**, **имени поля** и **значениях** состояния. Каждое значение также может иметь отображаемое имя, которое будет использоваться при отображении значения в диаграммах и таблицах.

Например, вы можете добавить новое состояние **Режим вентилятора**, которое имеет два возможных значения, отправляемых устройством: **Работает** и **Остановлено**.


| Отображаемое имя | Имя поля    |  Значение 1   | Отображаемое имя | Значение 2    |Отображаемое имя  | 
| -------------| ------------- |----------- | -------------| -----------| -------------|
| Режим вентилятора     | fanmode       |  1         | Operating (Работает)    |     0      | Остановлено      |

![Форма изменения состояния с подробными сведениями о режиме вентилятора](./media/howto-set-up-template/statemeasurementsform.png)

Если щелкнуть **Готово**, в списке измерений отобразится состояние измерения **мотора вентилятора**. Оператор может просматривать визуализации данных состояний, отправляемые с устройства.

![Диаграмма измерения состояний](./media/howto-set-up-template/statemeasurementschart.png)

Если в течение небольшого периода времени количество отправленных устройством точек данных слишком велико, измерение состояния отображается с другими визуальными элементами, как показано на следующем снимке экрана. Если вы щелкнете диаграмму, то все точки данных за этот период времени будут отображаться в хронологическом порядке. Вы также можете сузить диапазон времени, чтобы увидеть измерения, нанесенные на график.

> [!NOTE]
  Для измерения состояния используется строковый тип данных.

## <a name="settings"></a>Параметры

Параметры предназначены для управления устройством. Они позволяют операторам вашего приложения предоставлять входные данные для устройства. Вы можете добавить несколько параметров в шаблон устройства, которые отображаются в виде плиток на вкладке **Параметры** для использования операторами. Вы можете добавить несколько типов параметров: номер, текст, дата, переключатель, список выбора и метка раздела. 

Параметры могут быть в одном из трех состояний. Устройство сообщает об этих состояниях.

- **Синхронизировано**. Устройство изменилось с учетом значения параметра.

- **Pending**. Сейчас устройство меняется в соответствии со значением параметра.

- **Ошибка**: Устройство вернуло ошибку.

Например, можно добавить новый параметр скорости вращения вентилятора. Для этого выберите **Изменить шаблон** и введите новое значение параметра **Число**:

| Отображаемое имя  | Имя поля    |  Units  | Десятичные знаки |Initial|
| --------------| ------------- |---------| ---------|---- |
| Скорость вращения вентилятора     | fanSpeed      | Об/мин     | 2        | 0   |

![Форма настройки числа со сведениями о параметрах скорости](./media/howto-set-up-template/settingsform.png)

Если щелкнуть **Сохранить**, параметр **Fan speed** (Скорость вентилятора) появляется в виде плитки. Его можно использовать для изменения скорости вращения вентилятора устройства.

Затем щелкните **Готово** в верхней части экрана справа. При подключении реального устройства значение параметра изменится на "Синхронизация".

![Вкладка "Параметры" с параметром "Режим конструктора" для плитки](./media/howto-set-up-template/settingstile.png)

## <a name="properties"></a>properties

Свойства являются метаданными устройства, связанными с этим устройством (например, расположение устройства и серийный номер): Вы можете добавить несколько свойств в свой шаблон устройства, которые отображаются как плитки на вкладке **Свойства**. Вы можете добавить несколько типов свойств: номер, текст, дата, переключатель, свойство устройства, метка и расположение. Оператор может указывать значения свойств при создании устройства, а также может редактировать эти значения в любое время. При этом свойства устройства доступны только для чтения и отправляются с устройства в приложение. Оператор не может их изменять. При подключении реального устройства в приложении обновится плитка свойств. 

Существует две категории свойств:

- Свойства **устройства**, которые устройство передает в приложение IoT Central. Они содержат атрибут "только для чтения" и обновляются при подключении реального устройства. 
- Свойства **приложения**, которые хранятся в приложении. Оператор может их изменить. Устройство не распознает свойства приложения.

Например, можно добавить расположение устройства в качестве нового свойства **Текст** (свойство приложения). Для этого нужно выбрать **Изменить шаблон** и указать новое свойство:

| Отображаемое имя  | Имя поля | Удалить начальные пробелы  | Удалить конечные пробелы  | Чувствительность к регистру| Минимальная длина | Максимальная длина |
| --------------| -----------|---------| ---------|---- |----|----|
| Расположение      | loc        | Отключить     |  Отключить     | смешанная  | 0 | 100|

![Форма настройки текста на вкладке "Свойства"](./media/howto-set-up-template/propertiesform.png)

Если щелкнуть **Сохранить**, расположение устройства отображается в виде плитки:

![Плитка "Расположение"](./media/howto-set-up-template/propertiestile.png)

После создания плитки можно изменить значение свойства приложения. Сначала щелкните **Готово** в верхней правой части экрана.

### <a name="create-a-location-property-through-azure-maps"></a>Создание свойства расположения с помощью Azure Maps
Вы можете указать географический контекст для своих данных о расположении в Azure IoT Central и сопоставить координаты широты и долготы адреса улицы. Вы также можете просто сопоставить координаты широты и долготы. Azure Maps позволяет использовать эту возможность в IoT Central.

Вы можете добавить два типа свойств расположения:
- **Расположение как свойство приложения**, которое хранится только в приложении. Устройство не распознает свойства приложения.
- **Расположение как свойство устройства.** Эти данные устройство передает в приложение.

#### <a name="add-location-as-an-application-property"></a>Добавление расположения в качестве свойства приложения 
Вы можете создать свойство расположения как свойство приложения, используя службы Azure Maps в своем приложении IoT Central. Например, вы можете добавить адрес установки устройства. 

1. На вкладке **Свойства** выберите **Изменить шаблон**.

   ![Вкладка "Свойства" с включенным режимом конструктора](./media/howto-set-up-template/locationcloudproperty1.png)

2. В библиотеке выберите **Расположение**.
3. Укажите для расположения **отображаемое имя**, **имя поля** и **начальное значение**. 

    | Отображаемое имя  | Имя поля | Начальное значение |
    | --------------| -----------|---------| 
    | Адрес установки | insta_address | Microsoft, 1 Microsoft Way, Redmond, WA 98052   |

   ![Форма настройки расположения с подробными сведениями о расположении](./media/howto-set-up-template/locationcloudproperty2.png)

   Для добавления расположения существует два поддерживаемых формата:
   - **расположение в виде адреса**;
   - **расположение в виде координат**. 

4. Выберите **Сохранить** и **Готово**. Теперь оператор может обновить значение расположения в форме поля расположения. 

#### <a name="add-location-as-a-device-property"></a>Добавление расположения в качестве свойства устройства 

Вы можете создать свойство расположения в качестве свойства устройства, которое сообщается устройством. Например, если нужно отслеживать расположение устройства:

1. На вкладке **Свойства** выберите **Изменить шаблон**.

   ![Вкладка "Свойства" с включенным режимом конструктора](./media/howto-set-up-template/locationdeviceproperty1.png)

2. Выберите **Device Property** (Свойство устройства) в библиотеке.
3. Укажите отображаемое имя и имя поля, а затем выберите **Расположение** в качестве типа данных. 

    | Отображаемое имя  | Имя поля | Тип данных |
    | --------------| -----------|-----------| 
    | Расположение устройства | deviceLoc| location  |

   > [!NOTE]
   > Имена полей должны совпадать с именами свойств в соответствующем коде устройства.

   ![Форма настройки свойств устройства с подробными сведениями о расположении](./media/howto-set-up-template/locationdeviceproperty2.png)

При подключении реального устройства расположение, которое вы добавили как свойство устройства, будет заменено значением, которое отправит устройство. Адрес установки (расположение, которое вы добавили как свойство приложения) является редактируемой плиткой. Настроив свойство расположения, вы можете [добавить карту, чтобы визуализировать местоположение на панели мониторинга устройства](#add-an-azure-maps-location-in-the-dashboard).

## <a name="commands"></a>Команды

Команды используются для удаленного управления устройством. Они позволяют операторам вашего приложения мгновенно выполнять команды на устройстве. Вы можете добавить несколько команд в шаблон устройства, которые отображаются в виде плиток на вкладке **Команды** для использования операторами. Как создатель устройства, вы можете определить команды в соответствии с требованиями.

Чем команда отличается от параметра? 

* **Параметр.** Представляет собой конфигурацию, которую необходимо применить к устройству таким образом, чтобы оно сохраняло эту конфигурацию, пока вы не измените ее. Например, вам нужно задать температуру охлаждающего устройства, которая не должна изменяться даже после его перезагрузки. 

* **Команда.** Позволяет мгновенно удаленно выполнять команду на устройстве из IoT Central. Если устройство не подключено, время ожидания команды истекает и ее выполнение завершается сбоем. Например, вам требуется перезагрузить устройство.  


Например, можно добавить новую команду **Echo** (Вывод на экран). Для этого выберите **Изменить шаблон**, а затем щелкните **+ New Command** (+ Новая команда) и введите новую команду:

| Отображаемое имя  | Имя поля | Default Timeout (Время ожидания по умолчанию) | Тип данных |
| --------------| -----------|---------------- | --------- | 
| Команда вывода на экран  | echo (вывод на экран)       |  30             | текст      |

![Форма настройки команды с подробными сведениями о выводе на экран](./media/howto-set-up-template/commandsecho.png)

Если выбрать **Сохранить** и **Готово**, команда **вывода на экран** будет отображаться в виде плитки. При подключении реального устройства ее можно использовать для вывода на экран сведений об устройстве. Имена полей команды должны совпадать с именами в соответствующем коде устройства. Так команды будут выполняться успешно.


## <a name="rules"></a>Правила

Правила позволяют операторам наблюдать за устройствами почти в реальном времени. При срабатывании правила автоматически вызывают действия, такие как отправка сообщения электронной почты. На сегодня существует один тип правил:

- **Правило телеметрии**, срабатывающее, когда данные телеметрии выбранного устройства превышают указанное пороговое значение. [Узнайте больше о правилах телеметрии](howto-create-telemetry-rules.md).

## <a name="dashboard"></a>панель мониторинга

На панели мониторинга оператор может просмотреть сведения об устройстве. Как создатель вы можете добавить на эту страницу плитки, которые помогают операторам понять, как работает устройство. В шаблон устройства можно добавить несколько плиток панели мониторинга. Вы можете добавить несколько типов плиток для панели мониторинга: изображения, графики, гистограммы, ключевые показатели эффективности, параметры, свойства и метки.

Например, можно добавить плитку **Settings and Properties** (Параметры и свойства), чтобы отображать текущие значения параметров и свойств из некоторого набора, выбрав **Изменить шаблон** и плитку из библиотеки:

![Форма настройки сведений об устройстве со сведениями о параметрах и свойствах](./media/howto-set-up-template/dashboardsettingsandpropertiesform.png)

Теперь, когда оператор просматривает панель управления, он может видеть плитку, на которой отображаются свойства и параметры устройства:

![Вкладка "Панель мониторинга", на которой отображаются параметры и свойства плитки](./media/howto-set-up-template/dashboardtile.png)

### <a name="add-an-azure-maps-location-in-the-dashboard"></a>Добавление расположения Azure Maps на панель мониторинга

Если вы настроили свойство расположения ранее в разделе, посвященном [созданию свойства расположения с помощью Azure Maps](#create-a-location-property-through-azure-maps), вы можете визуализировать расположение с помощью карты на панели мониторинга устройства.

1. На вкладке **Панель мониторинга** выберите **Изменить шаблон**.

   ![Вкладка "Панель мониторинга" с включенным режимом конструктора](./media/howto-set-up-template/locationcloudproperty4map.png)

2. На панели мониторинга устройства выберите **карту** из библиотеки. 
3. Укажите название. В приведенном ниже примере указан заголовок "Расположение установки". На вкладке "Свойства" выберите свойство расположения, которое вы настроили ранее. В примере ниже выбрано свойство **Адрес установки**.

   ![Форма настройки карты со сведениями о заголовке и свойствах](./media/howto-set-up-template/locationcloudproperty5map.png)

4. Щелкните **Сохранить**. Теперь на фрагменте карты отображается выбранное расположение. 

   ![Фрагмент карты с выбранным расположением](./media/howto-set-up-template/locationcloudproperty6map.png) 

Вы можете изменить размер карты до нужного. Теперь, когда операторы просматривают панель мониторинга, для них доступны все плитки, которые вы настроили, включая карту расположения.

## <a name="next-steps"></a>Дополнительная информация

Вы узнали, как настраивать шаблон устройства в приложении Azure IoT Central, а значит вы готовы к следующему шагу:

> [!div class="nextstepaction"]
> [Создание версии шаблона нового устройства](howto-version-devicetemplate.md)
