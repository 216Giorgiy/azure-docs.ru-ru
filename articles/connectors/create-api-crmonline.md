<properties
pageTitle="Добавление API Dynamic CRM Online в службу PowerApps Enterprise и приложения логики | Microsoft Azure"
description="Обзор API CRM Online с параметрами интерфейса API REST"
services=""	
documentationCenter="" 	
authors="msftman"	
manager="erikre"	
editor="" tags="connectors" />

<tags
ms.service="multiple"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="integration"
ms.date="02/23/2016"
ms.author="deonhe"/>

# Начало работы с API CRM
Подключение к Dynamics CRM Online позволяет создавать записи, обновлять элементы и выполнять многие другие действия.

API CRM Online можно использовать из PowerApps Enterprise и приложений логики.

С помощью CRM Online можно:

- формировать бизнес-процессы на основе данных, получаемых из CRM Online; 
- использовать действия, которые удаляют запись, получают сущности и т. д. Эти действия получают ответ и делают выходные данные доступными для использования другими действиями. Например, при обновлении элемента в CRM можно отправлять сообщение электронной почты с помощью Office 365.


Сведения о добавлении API в PowerApps Enterprise см. в статье [Регистрация API в PowerApps](../power-apps/powerapps-register-from-available-apis.md).

Сведения о добавлении операции в приложения логики см. в статье [Создание приложения логики](../app-service-logic/app-service-logic-create-a-logic-app.md).

## Триггеры и действия
API CRM Online позволяет выполнять следующие действия. Триггеры отсутствуют.

| триггеры; | Действия|
| --- | --- |
|Отсутствует.| <ul><li>Создать запись</li><li>Получает записи</li><li>Удалить запись</li><li>Получает запись</li><li>Получает сущности</li><li>Обновить элемент</li></ul>

Все API-интерфейсы поддерживают данные в форматах JSON и XML.

## Создание подключения к CRM Online

### Добавление дополнительных настроек в PowerApps
Добавляя CRM Online в PowerApps Enterprise, введите **идентификатор клиента** и **ключ приложения**, соответствующие вашему приложению Dynamics CRM Online в Azure Active Directory (AAD). В приложении CRM Online также используется **URL-адрес перенаправления**. Если у вас нет приложения CRM Online, создайте его, выполнив приведенные ниже действия.

1. На [портале Azure](https://portal.azure.com) откройте **Active Directory** и выберите имя клиента вашей организации.
2. На вкладке "Приложения" выберите **Добавить**. На экране **Добавление приложения**:  

	1. Введите **Имя** для приложения.  
	2. Оставьте тип приложения **Веб**.  
	3. Щелкните **Далее**.

	![Добавление приложения AAD: сведения о приложении][9]

3. На экране **Свойства приложения**:

	1. Введите **URL-адрес входа** для своего приложения. Поскольку для PowerApps будет использоваться проверка подлинности AAD, в качестве URL-адреса входа укажите \__https://login.windows.net_.
2. Введите допустимый **универсальный код ресурса URI кода приложения** для своего приложения.  
	3. Нажмите кнопку **ОК**.  

	![Добавление приложения AAD: свойства приложения][10]

4. В новом приложении выберите **Настроить**.
5. В разделе _OAuth 2_ в качестве **URL-адреса перенаправления** введите значение, которое отображалось при добавлении API CRM Online на портале Azure. ![Настройка приложения AAD Contoso][12]

Теперь скопируйте и вставьте **идентификатор клиента** и **ключ приложения** в конфигурацию CRM Online на портале Azure.

### Добавление дополнительных настроек в приложения логики
При добавлении этого API в приложения логики необходимо войти в Dynamic CRM Online.

После создания подключения укажите свойства CRM Online, например таблицу или набор данных. Эти свойства описаны далее в **справочнике по REST API**.

>[AZURE.TIP] Это подключение можно использовать в других приложениях логики.

## Справочник по REST API Swagger
#### Эта документация предназначена для версии 1.0

### Создание записи 
Создает запись в сущности. ```POST: /datasets/{dataset}/tables/{table}/items```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|строка|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|
|таблица|строка|Да|path|Нет|Имя сущности|
|item| |Да|body|Нет|Создаваемая запись|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|


### Получение записей 
 Получает записи для сущности. ```GET: /datasets/{dataset}/tables/{table}/items```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|
|таблица|строка|Да|path|Нет|Имя сущности|
|$skip|целое число|Нет|запрос|Нет|Количество пропускаемых записей. Значение по умолчанию — 0.|
|$top|целое число|Нет|запрос|Нет|Максимальное количество извлекаемых записей. Количество по умолчанию — 100.|
|$filter|string|Нет|запрос|Нет|Запрос фильтра ODATA для ограничения количества записей.|
|$orderby|string|Нет|запрос|Нет|Запрос orderBy ODATA для указания порядка записей.|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|




### Возвращение наборов данных 
 Возвращает наборы данных. ```GET: /datasets```

Для этого вызова параметры отсутствуют.

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|



### Добавление элемента таблицы 
Используется для получения конкретной записи для сущности CRM. ```GET: /datasets/{dataset}/tables/{table}/items/{id}```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|строка|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|
|таблица|строка|Да|path|Нет|Имя сущности|
|id|строка|Да|path|Нет|Идентификатор записи|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|

### Удаление элемента из списка 
Удаляет элемент из списка. ```DELETE: /datasets/{dataset}/tables/{table}/items/{id}```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|строка|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|
|таблица|строка|Да|path|Нет|Имя сущности|
|id|string|Да|path|Нет|Идентификатор записи|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|



### Исправление существующего элемента таблицы 
Используется для частичного обновления существующей записи в сущности CRM. ```PATCH: /datasets/{dataset}/tables/{table}/items/{id}```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|строка|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|
|таблица|string|Да|path|Нет|Имя сущности|
|id|строка|Да|path|Нет|Идентификатор записи|
|item| |Да|body|Нет|Обновляемая запись|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|

### Получение сущностей 
Используется для получения списка сущностей, присутствующих в экземпляре CRM. ```GET: /datasets/{dataset}/tables```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|Уникальное имя для организации CRM contoso.crm|

#### Ответ
|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|


## Определения объектов

#### DataSetsMetadata

|Имя свойства | Тип данных | Обязательно|
|---|---|---|
|tabular|не определено|Нет|
|blob-объект|не определено|Нет|

#### TabularDataSetsMetadata

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|источник|string|Нет|
|displayName|строка|Нет|
|urlEncoding|string|Нет|
|tableDisplayName|строка|Нет|
|tablePluralName|string|Нет|

#### BlobDataSetsMetadata

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|источник|строка|Нет|
|displayName|строка|Нет|
|urlEncoding|string|Нет|


#### TableMetadata

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|name|строка|Нет|
|title|string|Нет|
|x-ms-permission|string|Нет|
|schema|не определено|Нет|

#### DataSetsList

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|value|array|Нет|

#### DataSet

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|Имя|строка|Нет|
|DisplayName|string|Нет|


#### Таблица

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|Имя|строка|Нет|
|DisplayName|строка|Нет|

#### Элемент

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|ItemInternalId|string|Нет|

#### ItemsList

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|value|array|Нет|


#### TablesList

|Имя свойства | Тип данных |Обязательно|
|---|---|---|
|value|array|Нет|


## Дальнейшие действия
После добавления API CRM Online в PowerApps Enterprise [предоставьте пользователям разрешения](../power-apps/powerapps-manage-api-connection-user-access.md) на использование API в своих приложениях.

[Создайте приложение логики](../app-service-logic/app-service-logic-create-a-logic-app.md)


[9]: ./media/create-api-crmonline/aad-tenant-applications-add-appinfo.png
[10]: ./media/create-api-crmonline/aad-tenant-applications-add-app-properties.png
[12]: ./media/create-api-crmonline/contoso-aad-app-configure.png

<!---HONumber=AcomDC_0224_2016-->