<properties
pageTitle="Использование API SharePoint Online в приложениях логики или приложениях PowerApps | Microsoft Azure"
description="Начните использовать API SharePoint Online для службы приложений Azure в приложениях логики и приложениях PowerApps."
services=""	
documentationCenter="" 	
authors="msftman"	
manager="erikre"	
editor=""
tags="connectors"/>

<tags
ms.service="multiple"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="na"
ms.date="03/16/2016"
ms.author="deonhe"/>

# Приступая к работе с API SharePoint Online

Поставщик подключения SharePoint предоставляет API-интерфейс для работы со списками в SharePoint.

>[AZURE.NOTE] Эта версия статьи предназначена для приложений логики со схемой версии 2015-08-01-preview. Чтобы получить версию схемы 2014-12-01-preview, щелкните [SharePoint](../app-service-logic/app-service-logic-connector-SharePoint.md).

С помощью SharePoint вы можете:

* создавать приложения логики.
* создавать приложения PowerApps.  

Сведения о добавлении операции в приложения логики см. в статье [Создание приложения логики](../app-service-logic/app-service-logic-create-a-logic-app.md).

## Поговорим о триггерах и действиях

API SharePoint можно использовать в качестве действия. Кроме того, он имеет триггеры. Все API-интерфейсы поддерживают данные в форматах JSON и XML.

API SharePoint предоставляет следующие триггеры и действия:

### Действия SharePoint
Вы можете выполнять перечисленные ниже действия:

|Действие|Описание|
|--- | ---|
|GetFileMetadata|Используется для получения метаданных файла в библиотеке документов|
|UpdateFile|Используется для обновления файла в библиотеке документов|
|DeleteFile|Используется для удаления файла в библиотеке документов|
|GetFileMetadataByPath|Используется для получения метаданных файла в библиотеке документов|
|GetFileContentByPath|Используется для получения файла в библиотеке документов|
|GetFileContent|Используется для получения файла в библиотеке документов|
|CreateFile|Используется для отправки файла в библиотеке документов|
|CopyFile|Используется для копирования файла в библиотеке документов|
|ExtractFolderV2|Используется для извлечения папки в библиотеке документов|
|PostItem|Создает элемент в списке SharePoint|
|GetItem|Извлекает один элемент из списка SharePoint|
|DeleteItem|Удаляет элемент из списка SharePoint|
|PatchItem|Обновляет элемент в списке SharePoint|
### Триггеры SharePoint
Можно прослушивать указанные ниже события:

|Триггер | Описание|
|--- | ---|
|OnNewFile|Запускает поток при создании файла в папке SharePoint|
|OnUpdatedFile|Запускает поток при изменении файла в папке SharePoint|
|GetOnNewItems|При создании элемента в списке SharePoint|
|GetOnUpdatedItems|При изменении существующего элемента в списке SharePoint|


## Создание подключения к SharePoint
Чтобы использовать API SharePoint, сначала нужно создать **подключение**, а затем указать сведения для приведенных ниже свойств.

|Свойство| Обязательно|Описание|
| ---|---|---|
|токен|Да|Указание учетных данных SharePoint|

Для подключения к **SharePoint Online** необходимо предоставить свое удостоверение (имя пользователя и пароль, учетные данные смарт-карты и т. п.). После прохождения аутентификации вы сможете использовать API SharePoint Online в приложении логики.

В конструкторе приложения логики выполните следующие действия, чтобы войти в SharePoint для создания подключения **connection**, которое будет использоваться в приложении логики.

1. В поле поиска введите "SharePoint" и дождитесь возвращения всех записей с "SharePoint" в имени. ![Настройка SharePoint][1]  
2. Выберите **SharePoint Online — при создании файла**.   
3. Выберите **Вход в SharePoint Online**. ![Настройка SharePoint][2]    
4. Укажите учетные данные SharePoint, чтобы войти и пройти аутентификацию в SharePoint. ![Настройка SharePoint][3]     
5. После успешной аутентификации вы перейдете к своему приложению логики, чтобы завершить его, настроив параметры в диалоговом окне **При создании файла** SharePoint. ![Настройка SharePoint][4]  
6. Затем можно будет добавить другие триггеры и действия, необходимые для завершения приложения логики.   
7. Сохраните результаты работы, выбрав **Сохранить** в строке меню вверху.  

>[AZURE.TIP] Это подключение можно использовать в других приложениях логики и приложениях PowerApps.

## Справочник по API REST SharePoint
#### Эта документация предназначена для версии 1.0


### Используется для получения метаданных файла в библиотеке документов
**```GET: /datasets/{dataset}/files/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|id|строка|Да|path|Нет|Уникальный идентификатор файла|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для обновления файла в библиотеке документов
**```PUT: /datasets/{dataset}/files/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|id|строка|Да|path|Нет|Уникальный идентификатор файла|
|текст| |Да|текст|Нет|Содержимое файла|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для удаления файла в библиотеке документов
**```DELETE: /datasets/{dataset}/files/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|id|строка|Да|path|Нет|Уникальный идентификатор файла|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для получения метаданных файла в библиотеке документов
**```GET: /datasets/{dataset}/GetFileByPath```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|path|строка|Да|запрос|Нет|Путь к файлу|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для получения файла в библиотеке документов
**```GET: /datasets/{dataset}/GetFileContentByPath```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|path|строка|Да|запрос|Нет|Путь к файлу|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для получения файла в библиотеке документов
**```GET: /datasets/{dataset}/files/{id}/content```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|id|строка|Да|path|Нет|Уникальный идентификатор файла|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для отправки файла в библиотеке документов
**```POST: /datasets/{dataset}/files```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|folderPath|строка|Да|запрос|Нет|Путь к папке|
|name|строка|Да|запрос|Нет|Имя файла|
|текст| |Да|текст|Нет|Содержимое файла|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для копирования файла в библиотеке документов
**```POST: /datasets/{dataset}/copyFile```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|источник|string|Да|запрос|Нет|Путь к исходному файлу|
|ресурс destination|строка|Да|запрос|Нет|Путь к конечному файлу|
|overwrite|Логическое|Нет|запрос|нет|Следует ли перезаписывать существующий файл|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Запускает поток при создании файла в папке SharePoint
**```GET: /datasets/{dataset}/triggers/onnewfile```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint|
|folderId|string|Да|запрос|Нет|Уникальный идентификатор папки в SharePoint|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Запускает поток при изменении файла в папке SharePoint
**```GET: /datasets/{dataset}/triggers/onupdatedfile```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint|
|folderId|string|Да|запрос|Нет|Уникальный идентификатор папки в SharePoint|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Используется для извлечения папки в библиотеке документов
**```POST: /datasets/{dataset}/extractFolderV2```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint. Например: http://contoso.sharepoint.com/sites/mysite|.
|источник|string|Да|запрос|Нет|Путь к исходному файлу|
|ресурс destination|строка|Да|запрос|Нет|Путь к конечной папке|
|перезаписать|Логическое|Нет|запрос|нет|Следует ли перезаписывать существующий файл|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### При создании элемента в списке SharePoint
**```GET: /datasets/{dataset}/tables/{table}/onnewitems```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|$skip|целое число|Нет|запрос|Нет|Количество пропускаемых записей (значение по умолчанию — 0)|
|$top|целое число|Нет|запрос|Нет|Максимальное количество извлекаемых записей (значение по умолчанию — 256)|
|$filter|string|Нет|запрос|Нет|Запрос фильтра ODATA для ограничения количества записей|
|$orderby|строка|Нет|запрос|Нет|Запрос orderBy ODATA для указания порядка записей|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### При изменении существующего элемента в списке SharePoint
**```GET: /datasets/{dataset}/tables/{table}/onupdateditems```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|$skip|целое число|Нет|запрос|Нет|Количество пропускаемых записей (значение по умолчанию — 0)|
|$top|целое число|Нет|запрос|Нет|Максимальное количество извлекаемых записей (значение по умолчанию — 256)|
|$filter|string|Нет|запрос|Нет|Запрос фильтра ODATA для ограничения количества записей|
|$orderby|строка|Нет|запрос|Нет|Запрос orderBy ODATA для указания порядка записей|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Создает элемент в списке SharePoint
**```POST: /datasets/{dataset}/tables/{table}/items```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|item| |Да|текст|Нет|Создаваемый элемент|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Извлекает один элемент из списка SharePoint
**```GET: /datasets/{dataset}/tables/{table}/items/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|id|целое число|Да|path|Нет|Уникальный идентификатор извлекаемого элемента|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Удаляет элемент из списка SharePoint
**```DELETE: /datasets/{dataset}/tables/{table}/items/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|id|целое число|Да|path|Нет|Уникальный идентификатор удаляемого элемента|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



### Обновляет элемент в списке SharePoint
**```PATCH: /datasets/{dataset}/tables/{table}/items/{id}```**



| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|dataset|string|Да|path|Нет|URL-адрес сайта SharePoint (например, http://contoso.sharepoint.com/sites/mysite)|).
|таблица|строка|Да|path|Нет|Имя списка SharePoint|
|id|целое число|Да|path|Нет|Уникальный идентификатор обновляемого элемента|
|item| |Да|текст|Нет|Элемент с измененными свойствами|


### Ниже перечислены возможные ответы:

|Имя|Описание|
|---|---|
|200|ОК|
|по умолчанию|Операция завершилась ошибкой.|
------



## Определения объектов: 

 **DataSetsMetadata**:

Обязательные свойства для DataSetsMetadata:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|tabular|не определено|
|blob-объект|не определено|



 **TabularDataSetsMetadata**:

Обязательные свойства для TabularDataSetsMetadata:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|источник|string|
|displayName|строка|
|urlEncoding|string|
|tableDisplayName|строка|
|tablePluralName|строка|



 **BlobDataSetsMetadata**:

Обязательные свойства для BlobDataSetsMetadata:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|источник|string|
|displayName|строка|
|urlEncoding|string|



 **BlobMetadata**:

Обязательные свойства для BlobMetadata:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|Идентификатор|строка|
|Имя|строка|
|DisplayName|строка|
|Путь|строка|
|LastModified|строка|
|Размер|целое число|
|MediaType|строка|
|IsFolder|Логическое|
|ETag|string|
|FileLocator|строка|



 **Object**:

Обязательные свойства для Object:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|



 **TableMetadata**:

Обязательные свойства для TableMetadata:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|name|string|
|title|строка|
|x-ms-permission|строка|
|schema|не определено|



 **DataSetsList**:

Обязательные свойства для DataSetsList:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|value|array|



 **DataSet**:

Обязательные свойства для DataSet:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|Имя|строка|
|DisplayName|строка|



 **Таблица**.

Обязательные свойства для Table:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|Имя|строка|
|DisplayName|строка|



 **Item**:

Обязательные свойства для Item:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|ItemInternalId|строка|



 **ItemsList**:

Обязательные свойства для ItemsList:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|value|array|



 **TablesList**:

Обязательные свойства для TablesList:


обязательные свойства отсутствуют.


**Все свойства**:


| Имя | Тип данных |
|---|---|
|value|array|


## Дальнейшие действия
[Создание приложения логики](../app-service-logic/app-service-logic-create-a-logic-app.md) [Создание приложения PowerApps](../power-apps/powerapps-get-started-azure-portal.md)

[1]: ./media/connectors-create-api-sharepointonline/connectionconfig1.png
[2]: ./media/connectors-create-api-sharepointonline/connectionconfig2.png
[3]: ./media/connectors-create-api-sharepointonline/connectionconfig3.png
[4]: ./media/connectors-create-api-sharepointonline/connectionconfig4.png
[5]: ./media/connectors-create-api-sharepointonline/connectionconfig5.png

<!---HONumber=AcomDC_0323_2016-->