<properties
	pageTitle="Добавление API Office 365 Пользователи в приложения логики | Microsoft Azure"
	description="Обзор API Office 365 Пользователи с параметрами интерфейса API REST"
	services=""	
	documentationCenter="" 	
	authors="msftman"	
	manager="erikre"	
	editor="" 
	tags="connectors" />

<tags
ms.service="multiple"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="integration"
ms.date="02/25/2016"
ms.author="deonhe"/>

# Начало работы с API-интерфейсом Office 365 Пользователи

Подключившись к Office 365 Пользователи, вы сможете получать профили, искать пользователей и выполнять многие другие действия. API Office 365 Пользователи можно использовать в:

- PowerApps; 
- приложениях логики. 

>[AZURE.NOTE] Эта версия статьи предназначена для приложений логики со схемой версии 2015-08-01-preview. Чтобы получить версию схемы 2014-12-01-preview, щелкните [API Office 365](../app-service-logic/app-service-logic-connector-office365.md).


С помощью Office 365 Пользователи вы можете:

- формировать бизнес-процессы на основе данных, получаемых из Office 365 Пользователи; 
- использовать действия для получения непосредственных подчиненных, профиля пользователя для менеджера и т. д. Эти действия получают ответ и делают выходные данные доступными для использования другими действиями. Например, можно получить список непосредственных подчиненных того или иного лица и внести соответствующие изменения в базу данных SQL Azure. 
- Добавьте API Office 365 Пользователи в службу PowerApps Enterprise. После этого пользователи смогут использовать этот API в своих приложениях. 

Сведения о добавлении API в PowerApps Enterprise см. в статье [Регистрация API в PowerApps](../power-apps/powerapps-register-from-available-apis.md).

Сведения о добавлении операции в приложения логики см. в статье [Создание приложения логики](../app-service-logic/app-service-logic-create-a-logic-app.md).

## Триггеры и действия

API Office 365 Пользователи предоставляет описанные ниже действия. Триггеры отсутствуют.

| триггеры; | Действия|
| --- | --- |
|None | <ul><li>Получение диспетчера</li><li>Получение моего профиля</li><li>Получение непосредственных подчиненных</li><li>Получение профиля пользователя</li><li>Поиск пользователей</li></ul>|

Все API поддерживают данные в форматах JSON и XML.


## Создание подключения к Office 365 Пользователи

### Добавление дополнительных настроек в PowerApps
При добавлении этого API в PowerApps Enterprise нужно ввести значения **идентификатора клиента** и **секрета клиента** для приложения Office 365 Azure Active Directory (AAD). В приложении Office 365 также используется **URL-адрес перенаправления**. Если у вас нет приложения Office 365, создайте его, выполнив приведенные ниже действия.

1. На [портале Azure][5] откройте **Active Directory** и выберите имя клиента вашей организации.
2. Перейдите на вкладку **Приложения** и выберите **Добавить**:  
![Клиентские приложения AAD][7]

3. На экране **Добавление приложения**:  

	1. Введите **Имя** для приложения.  
	2. Оставьте тип приложения **Веб**.  
	3. Щелкните **Далее**.  

	![Добавление приложения AAD: сведения о приложении][8]

4. На экране **Свойства приложения**:  

	1. Введите **URL-адрес входа** для своего приложения. Поскольку для PowerApps будет использоваться проверка подлинности AAD, в качестве URL-адреса входа укажите \__https://login.windows.net_.  
	2. Введите допустимый **универсальный код ресурса URI кода приложения** для своего приложения.  
	3. Нажмите кнопку **ОК**.  

	![Добавление приложения AAD: свойства приложения][9]

5. По завершении открывается новое приложение AAD. Перейдите на вкладку **Настройка**:  
![Приложение AAD Contoso][10]

6. В разделе **OAuth 2** укажите в поле **URL-адрес ответа** URL-адрес, полученный при добавлении нового API Office 365 Пользователи на портале Azure. Выберите **Добавить приложение**:  
![Настройка приложения AAD Contoso][11]

7. В окне **Разрешения для других приложений** выберите **Office 365 Unified API (предварительная версия)** и нажмите **ОК**.

	Обратите внимание, что на странице настройки _Office 365 Unified API (предварительная версия)_ добавляется в список _Разрешений для других приложений_.

8. На странице **Office 365 Exchange Online** выберите **Делегированные разрешения** и установите разрешение **Чтение базовых профилей всех пользователей**.

Будет создано новое приложение Azure Active Directory. Скопируйте и вставьте значения **идентификатора клиента** и **секрета клиента** в конфигурацию API Office 365 Пользователи на портале Azure.

Полезные сведения о приложениях AAD см. в статье [Как и почему приложения добавляются в Azure AD](../active-directory/active-directory-how-applications-are-added.md).


### Добавление дополнительных настроек в приложения логики
При добавлении этого API в приложения логики необходимо войти в учетную запись Office 365 Пользователи и разрешить приложениям логики подключаться к вашей учетной записи.

1. Войдите в свою учетную запись Office 365 Пользователи.
2. Разрешите приложениям логики подключаться к учетной записи Office 365 и использовать ее. 

После создания подключения укажите свойства Office 365 Пользователи, такие как идентификатор пользователя. Эти свойства описаны далее в **справочнике по REST API**.

>[AZURE.TIP] Подключение к Office 365 Пользователи можно также использовать в других приложениях логики.


## Справочник по API REST Office 365 Пользователи
Относится к версии 1.0.

### Получение моего профиля 
Извлекает профиль для текущего пользователя.  
```GET: /users/me```

Для этого вызова параметры отсутствуют.

#### Ответ

|Имя|Описание|
|---|---|
|200|Операция выполнена успешно|
|202|Операция выполнена успешно|
|400|BadRequest|
|401|Не авторизовано|
|403|Запрещено|
|500|Внутренняя ошибка сервера|
|по умолчанию|Операция завершилась ошибкой.|


### Получение профиля пользователя 
Извлекает профиль конкретного пользователя.  
```GET: /users/{userId}```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|userId|строка|Да|path|Нет|Имя участника-пользователя или идентификатор электронной почты|

#### Ответ

|Имя|Описание|
|---|---|
|200|Операция выполнена успешно|
|202|Операция выполнена успешно|
|400|BadRequest|
|401|Не авторизовано|
|403|Запрещено|
|500|Внутренняя ошибка сервера|
|по умолчанию|Операция завершилась ошибкой.|


### Получение руководителя 
Извлекает профиль руководителя указанного пользователя.  
```GET: /users/{userId}/manager```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|userId|строка|Да|path|Нет|Имя участника-пользователя или идентификатор электронной почты|

#### Ответ

|Имя|Описание|
|---|---|
|200|Операция выполнена успешно|
|202|Операция выполнена успешно|
|400|BadRequest|
|401|Не авторизовано|
|403|Запрещено|
|500|Внутренняя ошибка сервера|
|по умолчанию|Операция завершилась ошибкой.|



### Получение непосредственных подчиненных 
Получает непосредственных подчиненных.  
```GET: /users/{userId}/directReports```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|userId|строка|Да|path|Нет|Имя участника-пользователя или идентификатор электронной почты|

#### Ответ

|Имя|Описание|
|---|---|
|200|Операция выполнена успешно|
|202|Операция выполнена успешно|
|400|BadRequest|
|401|Не авторизовано|
|403|Запрещено|
|500|Внутренняя ошибка сервера|
|по умолчанию|Операция завершилась ошибкой.|



### Поиск пользователей 
Извлекает результаты поиска профилей пользователей.  
```GET: /users```

| Имя| Тип данных|Обязательно|Местонахождение|Значение по умолчанию|Описание|
| ---|---|---|---|---|---|
|searchTerm|string|Нет|запрос|Нет|Строка поиска (применяется к отображаемому имени, имени, фамилии, почте, псевдониму почты и имени участника-пользователя)|

#### Ответ

|Имя|Описание|
|---|---|
|200|Операция выполнена успешно|
|202|Операция выполнена успешно|
|400|BadRequest|
|401|Не авторизовано|
|403|Запрещено|
|500|Внутренняя ошибка сервера|
|по умолчанию|Операция завершилась ошибкой.|



## Определения объектов

#### User: класс модели пользователя

| Имя | Тип данных |Обязательно
|---|---|---|
|DisplayName|строка|Нет|
|GivenName|строка|Нет|
|Surname|строка|Нет|
|Mail|string|Нет|
|MailNickname|string|Нет|
|TelephoneNumber|string|Нет|
|AccountEnabled|Логическое|Нет|
|Идентификатор|string|Да
|UserPrincipalName|string|Нет|
|Department|string|Нет|
|JobTitle|string|Нет|
|mobilePhone|string|Нет|


## Дальнейшие действия
После добавления API Office 365 в PowerApps Enterprise [предоставьте пользователям разрешения](../power-apps/powerapps-manage-api-connection-user-access.md) на использование API в своих приложениях.

[Создайте приложение логики](../app-service-logic/app-service-logic-create-a-logic-app.md).

<!--References-->
[5]: https://portal.azure.com
[7]: ./media/create-api-office365-users/aad-tenant-applications.PNG
[8]: ./media/create-api-office365-users/aad-tenant-applications-add-appinfo.PNG
[9]: ./media/create-api-office365-users/aad-tenant-applications-add-app-properties.PNG
[10]: ./media/create-api-office365-users/contoso-aad-app.PNG
[11]: ./media/create-api-office365-users/contoso-aad-app-configure.PNG

<!---HONumber=AcomDC_0302_2016-->


