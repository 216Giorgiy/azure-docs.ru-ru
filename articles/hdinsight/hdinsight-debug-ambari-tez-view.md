<properties
pageTitle="Использование представления Ambari Tez в HDInsight | Azure"
description="Узнайте, как использовать представление Ambari Tez для отладки заданий Tez в HDInsight."
services="hdinsight"
documentationCenter=""
authors="Blackmist"
manager="paulettm"
editor="cgronlun"/>

<tags
ms.service="hdinsight"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="big-data"
ms.date="02/16/2016"
ms.author="larryfr"/>

# Отладка заданий Tez в HDInsight с помощью представлений Ambari

Пользовательский веб-интерфейс Ambari для HDInsight содержит представление Tez, которое можно использовать для получения общих сведений о заданиях и отладки заданий, применяющих Tez в качестве подсистемы выполнения. Представление Tez позволяет визуализировать задание в виде схемы связанных элементов, выполнять детализацию каждого элемента и получать статистические данные и данные журнала.

> [AZURE.NOTE] Информация, приведенная в этом документе, относится только к кластерам HDInsight на платформе Linux. Сведения об отладке заданий Tez с помощью HDInsight на платформе Windows см. в статье [Отладка заданий Tez в HDInsight на платформе Windows с помощью пользовательского интерфейса Tez](hdinsight-debug-tez-ui.md).

##Предварительные требования

* Кластер HDInsight под управлением Linux. Инструкции по созданию кластера см. в статье [Приступая к работе с HDInsight на платформе Linux](hdinsight-hadoop-linux-tutorial-get-started.md).

* Современный веб-браузер, который поддерживает HTML5.

##Общие сведения о Tez

Tez — это расширяемая платформа для обработки данных в Hadoop, которая характеризуется более высокими скоростями по сравнению с традиционной обработкой MapReduce. Она является подсистемой по умолчанию для Hive для кластеров HDInsight под управлением Linux.

При отправке работы в Tez подсистема создает направленный ациклический граф (DAG), описывающий порядок выполнения действий, необходимых для задания. Отдельные действия называются вершинами и выполняют часть всего задания. Фактическое выполнение работы, описываемое вершиной, называется задачей и может быть распределено среди нескольких узлов кластера.

###Общие сведения о представлении Tez

В представлении Tez содержатся сведения о процессах, которые выполняются или выполнялись ранее с использованием Tez. Здесь можно просмотреть созданный Tez граф DAG, его распределение по кластерам, а также увидеть счетчики, например с данными о памяти, используемой задачами и вершинами, и сведения об ошибках. Отображаемые сведения могут быть полезными в следующих сценариях.

* Мониторинг длительных процессов, просмотр хода выполнения задач map и reduce.

* Анализ исторических данных успешных или неудачных процессов для получения сведений о причинах сбоев и возможностях улучшения обработки.

##Создание DAG

Представление Tez будет содержать данные только в том случае, если задание, которое использует подсистему Tez, выполняется в данный момент или было выполнено ранее. Простые запросы Hive обычно можно разрешить без использования Tez, однако эта подсистема потребуется для работы с более сложными запросами, которые выполняют фильтрацию, группировку, упорядочение, соединения и т. д.

Приведенные ниже действия предназначены для запуска запроса Hive, выполняемого с помощью Tez.

1. Откройте веб-браузер и перейдите по адресу https://CLUSTERNAME.azurehdinsight.net, где __CLUSTERNAME__ — это имя вашего кластера HDInsight.

2. В меню в верхней части страницы щелкните значок __Представления__. Он выглядит как набор квадратов. В появившемся раскрывающемся списке выберите __Представление Hive__.

    ![Выбор представления Hive](./media/hdinsight-debug-ambari-tez-view/selecthive.png)

3. После загрузки представления Hive вставьте следующую строку в редактор запросов и нажмите кнопку __Выполнить__.

        select market, state, country from hivesampletable where deviceplatform='Android' group by market, country, state;
    
    После завершения задания выходные данные должны отображаться в разделе __Результаты обработки запроса__. Результаты должны иметь следующий вид:
    
        market  state       country
        en-GB   Hessen      Germany
        en-GB   Kingston    Jamaica
        
4. Откройте вкладку __Журнал__. Будут отображены сведения, подобные следующим:
    
        INFO : Session is already open
        INFO :

        INFO : Status: Running (Executing on YARN cluster with App id application_1454546500517_0063)

    Сохраните значение __идентификатора приложения__, так как оно будет использоваться в следующем разделе.

##Использование представления Tez

1. В меню в верхней части страницы щелкните значок __Представления__. В появившемся раскрывающемся списке выберите __Представление Tez__.

    ![Выбор представления Tez](./media/hdinsight-debug-ambari-tez-view/selecttez.png)

2. После загрузки представления Tez вы увидите список DAG, которые работают в данный момент или работали в кластере. В представлении по умолчанию находятся такие столбцы, как "Имя Dag", "ИД", "Отправитель", "Состояние", "Время начала", "Время окончания", "Продолжительность", "ИД приложения" и "Очередь". Чтобы добавить дополнительные столбцы, воспользуйтесь значком шестеренки в правом углу страницы.

    ![Все DAG](./media/hdinsight-debug-ambari-tez-view/alldags.png)

3. Если у вас имеется только одна запись, она будет использоваться для запроса, выполненного в предыдущем разделе. Если имеется несколько записей, можно выполнить поиск, указав идентификатор приложения в поле __ИД приложения__ и нажав клавишу ВВОД.

4. Выберите __Имя Dag__. Появятся сведения о DAG, а также возможность скачивания ZIP-архива JSON-файлов, содержащих информацию о DAG.

    ![Сведения о DAG](./media/hdinsight-debug-ambari-tez-view/dagdetails.png)

5. Над разделом __Сведения о DAG__ находится несколько ссылок для отображения сведений о DAG.

    * __Счетчики DAG__ — отображение сведений о счетчиках для этого DAG.
    
    * __Графическое представление__ — отображение графического представления этого DAG.
    
    * __Все вершины__ — отображение списка вершин в этом DAG.
    
    * __Все задачи__ — отображение списка задач для всех вершин в этом DAG.
    
    * __Все попытки выполнения задач__ — отображение сведений о попытках выполнения задач для этого DAG.
    
    > [AZURE.NOTE] При просмотре столбцов "Вершины", "Задачи" и "Попытки выполнения задач" обратите внимание на ссылки для просмотра __счетчиков__ и __просмотра или загрузки журналов__ для каждой строки.

    Если при выполнении задания произошел сбой, в столбце "Сведения о DAG" будет отображаться состояние FAILED (Ошибка), а также ссылки на сведения о неудачной задаче. Под сведениями о DAG будут отображаться диагностические данные.
    
    ![Экран сведений о DAG с подробными сведениями о сбое](./media/hdinsight-debug-ambari-tez-view/faileddag.png)

7. Выберите __Графическое представление__. Появится графическое представление DAG. Помещайте указатель мыши над каждой вершиной в представлении, чтобы получить о ней сведения.

    ![Графическое представление](./media/hdinsight-debug-ambari-tez-view/dagdiagram.png)

8. Если щелкнуть вершину, загрузятся __сведения о вершине__ для этого элемента. Щелкните вершину __Map 1__, чтобы вывести подробные сведения для этого элемента.

    ![Сведения о вершинах](./media/hdinsight-debug-ambari-tez-view/vertexdetails.png)

9. Обратите внимание, что в верхней части страницы находятся ссылки, связанные с вершинами и задачами.

    > [AZURE.NOTE] Эту страницу также можно открыть другим способом: вернитесь к столбцу __Сведения о DAG__, выберите __Сведения о вершине__, а затем вершину __Map 1__.

    * __Счетчики вершины__ — отображение сведений о счетчиках для этой вершины.
    
    * __Задачи__ — отображение задач для этой вершины.
    
    * __Попытки выполнения задач__ — отображение сведений о попытках выполнения задач для этой вершины.
    
    * __Источники и приемники__ — отображение источников и приемников данных для этой вершины.

    > [AZURE.NOTE] Как и в предыдущем меню, можно прокрутить отображение столбцов "Задачи", "Попытки выполнения задач" и "Источники и приемники" для отображения ссылок на дополнительные сведения для каждого элемента.

10. Выберите __Задачи__, а затем элемент с именем __00\_000000__. Откроется окно __Сведения о задаче__ для этой задачи. В этом окне можно просмотреть __счетчики задачи__ и __попытки выполнения задачи__.

    ![Сведения о задаче](./media/hdinsight-debug-ambari-tez-view/taskdetails.png)

##Дальнейшие действия

Теперь, когда вы поняли, как работать с представлением Tez, узнайте больше об [использовании Hive в HDInsight](hdinsight-use-hive.md).

Более подробные технические сведения о Tez см. на [странице Tez на сайте Hortonworks](http://hortonworks.com/hadoop/tez/).

Дополнительные сведения об использовании Ambari в HDInsight см. в статье [Управление кластерами HDInsight с помощью пользовательского веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md).

<!---HONumber=AcomDC_0218_2016-->