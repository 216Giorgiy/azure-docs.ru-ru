---
title: Использование представления Apache Ambari Tez в HDInsight в Azure
description: Узнайте, как использовать представление Apache Ambari Tez для отладки заданий Tez в HDInsight.
services: hdinsight
author: hrasheed-msft
ms.reviewer: jasonh
ms.service: hdinsight
ms.custom: hdinsightactive
ms.topic: conceptual
ms.date: 02/27/2018
ms.author: hrasheed
ms.openlocfilehash: 312b476f8809d1d6375cc20035901d8d11c32173
ms.sourcegitcommit: 698ba3e88adc357b8bd6178a7b2b1121cb8da797
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2018
ms.locfileid: "53012357"
---
# <a name="use-apache-ambari-views-to-debug-apache-tez-jobs-on-hdinsight"></a>Отладка заданий Apache Tez в HDInsight с помощью представлений Apache Ambari

Пользовательский веб-интерфейс [Apache Ambari](https://ambari.apache.org/) для HDInsight содержит представление [Apache Tez](https://tez.apache.org/), которое можно использовать для получения общих сведений о заданиях и отладки заданий, применяющих Tez. Представление Tez позволяет визуализировать задание в виде схемы связанных элементов, выполнять детализацию каждого элемента и получать статистические данные и данные журнала.

> [!IMPORTANT]
> Для выполнения действий, описанных в этом документе, необходим кластер HDInsight под управлением Linux. Linux — это единственная операционная система, используемая для работы с HDInsight 3.4 или более поздних версий. Дополнительные сведения см. в разделе [Что представляют собой различные компоненты и версии Hadoop, доступные в HDInsight?](hdinsight-component-versioning.md#hdinsight-windows-retirement)

## <a name="prerequisites"></a>Предварительные требования

* Кластер HDInsight под управлением Linux. Инструкции по созданию кластера см. в статье [Руководство по Hadoop. Начало работы с Hadoop в HDInsight на платформе Linux](hadoop/apache-hadoop-linux-tutorial-get-started.md).
* Современный веб-браузер, который поддерживает HTML5.

## <a name="understanding-apache-tez"></a>Основные сведения об Apache Tez

Tez — это расширяемая платформа для обработки данных в Apache Hadoop, которая характеризуется более высокими скоростями по сравнению с традиционной обработкой MapReduce. Она является подсистемой по умолчанию для Hive для кластеров HDInsight под управлением Linux.

Tez создает направленный ациклический граф (DAG), описывающий порядок действий, необходимых для заданий. Отдельные действия называются вершинами и выполняют часть всего задания. Фактическое выполнение работы, описываемое вершиной, называется задачей и может быть распределено среди нескольких узлов кластера.

### <a name="understanding-the-tez-view"></a>Общие сведения о представлении Tez 

В представлении Tez содержатся накопленные сведения и данные о процессах, которые выполняются. Здесь можно просмотреть, как задание распределяется по кластерам. А также здесь отображаются счетчики, используемые задачами и вершинами, и сведения об ошибках, относящихся к заданию. Отображаемые сведения могут быть полезными в следующих сценариях.

* Мониторинг длительных процессов, просмотр хода выполнения задач map и reduce.
* Анализ исторических данных успешных или неудачных процессов для получения сведений о причинах сбоев и возможностях улучшения обработки.

## <a name="generate-a-dag"></a>Создание DAG

Представление Tez содержит данные только в том случае, если задание, которое использует подсистему Tez, выполняется в данный момент или было выполнено ранее. Простые запросы Hive можно разрешить без использования Tez. Подсистема Tez требуется для работы с более сложными запросами, которые выполняют фильтрацию, группировку, упорядочение, соединения и т. д.

Приведенные ниже действия предназначены для запуска запроса Hive, использующего Tez.

1. В веб-браузере перейдите на страницу с адресом https://CLUSTERNAME.azurehdinsight.net, где **CLUSTERNAME** — имя кластера HDInsight.

2. В меню в верхней части страницы щелкните значок **Представления**. Он выглядит как набор квадратов. В появившемся раскрывающемся списке выберите **Представление Hive**.

    ![Выбор представления Hive](./media/hdinsight-debug-ambari-tez-view/selecthive.png)

3. После загрузки представления Hive вставьте следующий запрос в редактор запросов и нажмите кнопку **Выполнить**.

        select market, state, country from hivesampletable where deviceplatform='Android' group by market, country, state;

    После завершения задания выходные данные должны отображаться в разделе **Query Process Results** (Результаты обработки запроса). Результаты должны иметь следующий вид:

        market  state       country
        en-GB   Hessen      Germany
        en-GB   Kingston    Jamaica

4. Откройте вкладку **Журнал**. Отобразятся сведения, подобные следующим:

        INFO : Session is already open
        INFO :

        INFO : Status: Running (Executing on YARN cluster with App id application_1454546500517_0063)

    Сохраните значение поля **ИД приложения**, так как оно будет использоваться в следующем разделе.

## <a name="use-the-tez-view"></a>Использование представления Tez

1. В меню в верхней части страницы щелкните значок **Представления**. В появившемся раскрывающемся списке выберите **Tez view** (Представление Tez).

    ![Выбор представления Tez](./media/hdinsight-debug-ambari-tez-view/selecttez.png)

2. После загрузки представления Tez вы увидите список запросов Hive, которые выполняются в настоящее время или выполнялись в кластере.

    ![Все DAG](./media/hdinsight-debug-ambari-tez-view/tez-view-home.png)

3. Если у вас имеется только одна запись, то она используется для запроса, выполненного в предыдущем разделе. Если у вас несколько записей, можно выполнить поиск, используя поля в верхней части страницы.

4. Выберите **идентификатор запроса** Hive. Появятся сведения о запросе.

    ![Сведения о DAG](./media/hdinsight-debug-ambari-tez-view/query-details.png)

5. С помощью вкладок на этой странице можно просмотреть указанные ниже сведения.

    * **Сведения о запросе**: подробные сведения о запросе Hive.
    * **Временная шкала**: сведения о том, сколько времени занял каждый этап обработки.
    * **Конфигурации**: конфигурация, используемая для этого запроса.

    В разделе __Сведения о запросе__ можно перейти по ссылкам, чтобы получить сведения о __приложении__ или __направленном ациклическом графе__ запроса.
    
    * По ссылке __Приложение__ можно получить сведения о приложении YARN для этого запроса. Здесь также можно открыть журналы приложения YARN.
    * По ссылке __DAG__ открываются сведения о направленном ациклическом графе запроса (DAG). Здесь также можно просмотреть графическое представление DAG и найти сведения о вершинах DAG.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы поняли, как работать с представлением Apache Tez, узнайте больше об [использовании Apache Hive в HDInsight](hadoop/hdinsight-use-hive.md).

Более подробные технические сведения об Apache Tez см. на [странице Apache Tez на сайте Hortonworks](https://hortonworks.com/hadoop/tez/).

Дополнительные сведения об использовании Apache Ambari в HDInsight см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md).
