---
title: "Использование представления Ambari Tez в HDInsight | Документация Майкрософт"
description: "Узнайте, как использовать представление Ambari Tez для отладки заданий Tez в HDInsight."
services: hdinsight
documentationcenter: 
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: 9c39ea56-670b-4699-aba0-0f64c261e411
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 04/14/2017
ms.author: larryfr
ms.translationtype: Human Translation
ms.sourcegitcommit: 8f987d079b8658d591994ce678f4a09239270181
ms.openlocfilehash: 4dcccb313c517982680266656c36b9f23dee44c4
ms.contentlocale: ru-ru
ms.lasthandoff: 05/18/2017


---
# <a name="use-ambari-views-to-debug-tez-jobs-on-hdinsight"></a>Отладка заданий Tez в HDInsight с помощью представлений Ambari 

Пользовательский веб-интерфейс Ambari для HDInsight содержит представление Tez, которое можно использовать для получения общих сведений о заданиях и отладки заданий, применяющих Tez. Представление Tez позволяет визуализировать задание в виде схемы связанных элементов, выполнять детализацию каждого элемента и получать статистические данные и данные журнала.

> [!IMPORTANT]
> Для выполнения действий, описанных в этом документе, необходим кластер HDInsight под управлением Linux. Linux — это единственная операционная система, используемая для работы с HDInsight 3.4 или более поздних версий. Дополнительные сведения см. в разделе [Что представляют собой различные компоненты и версии Hadoop, доступные в HDInsight?](hdinsight-component-versioning.md#hdi-version-33-nearing-retirement-date)

## <a name="prerequisites"></a>Предварительные требования

* Кластер HDInsight под управлением Linux. Инструкции по созданию кластера см. в статье [Руководство по Hadoop. Начало работы с Hadoop в HDInsight на платформе Linux](hdinsight-hadoop-linux-tutorial-get-started.md).
* Современный веб-браузер, который поддерживает HTML5.

## <a name="understanding-tez"></a>Общие сведения о Tez

Tez — это расширяемая платформа для обработки данных в Hadoop, которая характеризуется более высокими скоростями по сравнению с традиционной обработкой MapReduce. Она является подсистемой по умолчанию для Hive для кластеров HDInsight под управлением Linux.

Tez создает направленный ациклический граф (DAG), описывающий порядок действий, необходимых для заданий. Отдельные действия называются вершинами и выполняют часть всего задания. Фактическое выполнение работы, описываемое вершиной, называется задачей и может быть распределено среди нескольких узлов кластера.

### <a name="understanding-the-tez-view"></a>Общие сведения о представлении Tez 

В представлении Tez содержатся накопленные сведения и данные о процессах, которые выполняются. Здесь можно просмотреть, как задание распределяется по кластерам. А также здесь отображаются счетчики, используемые задачами и вершинами, и сведения об ошибках, относящихся к заданию. Отображаемые сведения могут быть полезными в следующих сценариях.

* Мониторинг длительных процессов, просмотр хода выполнения задач map и reduce.
* Анализ исторических данных успешных или неудачных процессов для получения сведений о причинах сбоев и возможностях улучшения обработки.

## <a name="generate-a-dag"></a>Создание DAG

Представление Tez содержит данные только в том случае, если задание, которое использует подсистему Tez, выполняется в данный момент или было выполнено ранее. Простые запросы Hive можно разрешить без использования Tez. Подсистема Tez требуется для работы с более сложными запросами, которые выполняют фильтрацию, группировку, упорядочение, соединения и т. д.

Приведенные ниже действия предназначены для запуска запроса Hive, использующего Tez.

1. В веб-браузере перейдите на страницу с адресом https://CLUSTERNAME.azurehdinsight.net, где **CLUSTERNAME** — имя кластера HDInsight.

2. В меню в верхней части страницы щелкните значок **Представления**. Он выглядит как набор квадратов. В появившемся раскрывающемся списке выберите **Представление Hive**.

    ![Выбор представления Hive](./media/hdinsight-debug-ambari-tez-view/selecthive.png)

3. После загрузки представления Hive вставьте следующий запрос в редактор запросов и нажмите кнопку **Выполнить**.

        select market, state, country from hivesampletable where deviceplatform='Android' group by market, country, state;

    После завершения задания выходные данные должны отображаться в разделе **Query Process Results** (Результаты обработки запроса). Результаты должны иметь следующий вид:

        market  state       country
        en-GB   Hessen      Germany
        en-GB   Kingston    Jamaica

4. Откройте вкладку **Журнал**. Отобразятся сведения, подобные следующим:

        INFO : Session is already open
        INFO :

        INFO : Status: Running (Executing on YARN cluster with App id application_1454546500517_0063)

    Сохраните значение поля **ИД приложения**, так как оно будет использоваться в следующем разделе.

## <a name="use-the-tez-view"></a>Использование представления Tez

1. В меню в верхней части страницы щелкните значок **Представления**. В появившемся раскрывающемся списке выберите **Tez view** (Представление Tez).

    ![Выбор представления Tez](./media/hdinsight-debug-ambari-tez-view/selecttez.png)

2. После загрузки представления Tez вы увидите список DAG, которые работают в данный момент или работали в кластере.

    ![Все DAG](./media/hdinsight-debug-ambari-tez-view/alldags.png)

3. Если у вас имеется только одна запись, то она используется для запроса, выполненного в предыдущем разделе. Если есть несколько записей, можно выполнить поиск, указав идентификатор приложения в поле **ИД приложения** и нажав клавишу ВВОД.

4. Выберите **Dag Name** (Имя Dag). Отобразятся сведения о DAG. Эти сведения также можно скачать в виде ZIP-архива с JSON-файлами.

    ![Сведения о DAG](./media/hdinsight-debug-ambari-tez-view/dagdetails.png)

5. Над разделом **DAG Details** (Сведения о DAG) находится несколько ссылок для отображения сведений о DAG.

   * **Счетчики DAG** — отображение сведений о счетчиках для этого DAG.
   * **Графическое представление** — отображение графического представления этого DAG.
   * **Все вершины** — отображение списка вершин в этом DAG.
   * **Все задачи** — отображение списка задач для всех вершин в этом DAG.
   * **Все попытки выполнения задач** — отображение сведений о попытках выполнения задач для этого DAG.

     > [!NOTE]
     > При просмотре столбцов "Вершины", "Задачи" и TaskAttempts (Попытки выполнения задач) обратите внимание на ссылки для просмотра **счетчиков** и **просмотра или загрузки журналов** для каждой строки.

     Если при выполнении задания произошел сбой, то в столбце "DAG Details" (Сведения о DAG) отображается состояние "FAILED" (Ошибка), а также ссылки на сведения о неудачной задаче. Под сведениями о DAG отображаются диагностические данные.

     ![Экран сведений о DAG с подробными сведениями о сбое](./media/hdinsight-debug-ambari-tez-view/faileddag.png)

6. Выберите **Графическое представление** в соответствующем поле. Появится графическое представление DAG. Помещайте указатель мыши над каждой вершиной в представлении, чтобы получить о ней сведения.

    ![Графическое представление](./media/hdinsight-debug-ambari-tez-view/dagdiagram.png)

7. Выберите вершину, чтобы загрузить **сведения о вершине** для этого элемента. Выберите вершину **Map 1**, чтобы вывести подробные сведения для этого элемента.

    ![сведения о вершине](./media/hdinsight-debug-ambari-tez-view/vertexdetails.png)

8. В верхней части страницы находятся ссылки, связанные с вершинами и задачами.

   > [!NOTE]
   > Эту страницу также можно открыть другим способом: вернитесь к столбцу **DAG Details** (Сведения о DAG), выберите **Vertex Details** (Сведения о вершине), а затем вершину **Map 1**.

   * **Счетчики вершины** — отображение сведений о счетчиках для этой вершины.
   * **Задачи** — отображение задач для этой вершины.
   * **Попытки выполнения задач** — отображение сведений о попытках выполнения задач для этой вершины.
   * **Источники и приемники** — отображение источников и приемников данных для этой вершины.

     > [!NOTE]
     > Как и в предыдущем меню, можно прокрутить отображение столбцов "Задачи", "Попытки выполнения задач" и "Источники и приемники" для отображения ссылок на дополнительные сведения для каждого элемента.

9. Выберите **Задачи**, а затем элемент с именем **00_000000**. Отобразится окно **Сведения о задаче** для этой задачи. В этом окне можно просмотреть значения полей **Task Counters** (Счетчики задачи) и **Task Attempts** (Попытки выполнения задачи).

   ![Сведения о задаче](./media/hdinsight-debug-ambari-tez-view/taskdetails.png)

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы поняли, как работать с представлением Tez, узнайте больше об [использовании Hive в HDInsight](hdinsight-use-hive.md).

Более подробные технические сведения о Tez см. на [странице Tez на сайте Hortonworks](http://hortonworks.com/hadoop/tez/).

Дополнительные сведения об использовании Ambari в HDInsight см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md).

