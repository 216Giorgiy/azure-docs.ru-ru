<properties
   pageTitle="Создание кластеров Hadoop под управлением Windows в HDInsight | Microsoft Azure"
   	description="Сведения о создании кластеров для Azure HDInsight."
   services="hdinsight"
   documentationCenter=""
   tags="azure-portal"
   authors="mumian"
   manager="paulettm"
   editor="cgronlun"/>

<tags
   ms.service="hdinsight"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="big-data"
   ms.date="01/06/2016"
   ms.author="jgao"/>

# Создание кластеров Hadoop под управлением Windows в HDInsight

[AZURE.INCLUDE [selector](../../includes/hdinsight-create-windows-cluster-selector.md)]

Узнайте, как спланировать создание кластеров HDInsight.

###Предварительные требования:

Прежде чем следовать указаниям в этой статье, необходимо подготовить следующее:

- Подписка Azure. См. [Бесплатная пробная версия Azure](http://azure.microsoft.com/documentation/videos/get-azure-free-trial-for-testing-hadoop-in-hdinsight/).


## Базовые параметры конфигурации

Ниже приведены базовые параметры конфигурации для создания кластера HDInsight.

- **Имя кластера**

	Имя кластера используется для его идентификации. Оно должно соответствовать следующим требованиям:

	- поле должно представлять собой строку длиной от 3 до 63 символов;
	- поле может содержать только буквы, цифры и дефисы.

- **Название подписки**

	Кластер HDInsight привязывается к одной подписке Azure.

- **Имя группы ресурсов**

	Диспетчер ресурсов Azure (ARM) позволяет работать с ресурсами в приложении в виде группы, которая называется группой ресурсов Azure. Вы можете развертывать, обновлять, отслеживать или удалять все ресурсы для приложения в рамках одной скоординированной операции. Дополнительную информацию см. в статье [Общие сведения о Диспетчере ресурсов Azure](resource-group-overview.md).
	
- **Операционная система**

	Вы можете создать кластеры HDInsight в одной из следующих операционных систем:
	- **Windows (Windows Server 2012 R2 Datacenter)**;
	- **Linux (Ubuntu 12.04 LTS для Linux)**. HDInsight позволяет настраивать кластеры Linux в Azure. Настройте кластер Linux, если вы знакомы с Linux или Unix, выполняете миграцию из существующего решения Hadoop на платформе Linux или хотите с легкостью выполнить интеграцию с компонентами экосистемы Hadoop, созданными для Linux. Дополнительную информацию см. в разделе [Приступая к работе с Hadoop в Linux на платформе HDInsight](hdinsight-hadoop-linux-get-started.md).

- **Тип кластера** и **размер кластера (узлы данных)**

	HDInsight позволяет клиентам развертывать различные типы кластеров для рабочих нагрузок анализа различных данных. На сегодняшний день доступны следующие типы кластеров:

	- кластеры Hadoop — для запросов и анализа;
	- кластеры HBase — для NoSQL;
	- кластеры Storm — для обработки событий в реальном времени;
	- кластеры Spark (предварительная версия) — для обработки в оперативной памяти, интерактивных запросов, потоков и машинного обучения.

	![Кластеры HDInsight](./media/hdinsight-provision-clusters/hdinsight.clusters.png)

	> [AZURE.NOTE]*Кластер Azure HDInsight* также называется *кластером Hadoop в HDInsight* или *кластером HDInsight*. Иногда также используется термин *кластер Hadoop*. Все они обозначают кластеры Hadoop, размещенные в среде Microsoft Azure.

	Разные узлы кластера каждого типа могут выполнять разные роли. Клиенты могут настраивать размеры узлов в соответствии с нагрузкой в рамках определенной роли. Например, рабочие узлы кластера Hadoop можно создать с большим объемом памяти, если они активно используются для выполнения аналитических задач.

	![Роли кластера HDInsight Hadoop](./media/hdinsight-provision-clusters/HDInsight.Hadoop.roles.png)

	Кластеры Hadoop для HDInsight развертываются с двумя ролями:

	- головной узел (два узла);
	- узел данных (по крайней мере один узел).

	![Роли кластера HDInsight Hadoop](./media/hdinsight-provision-clusters/HDInsight.HBase.roles.png)

	Кластеры HBase для HDInsight развертываются с тремя ролями: головные серверы (два узла), региональные серверы (по крайней мере один узел) и узлы Master/Zookeeper (три узла).

	![Роли кластера HDInsight Hadoop](./media/hdinsight-provision-clusters/HDInsight.Storm.roles.png)

	Кластеры Storm для HDInsight развертываются с тремя ролями: узлы Nimbus (два узла), наблюдающие серверы (по крайней мере один узел) и узлы Zookeeper (три узла).


	![Роли кластера HDInsight Hadoop](./media/hdinsight-provision-clusters/HDInsight.Spark.roles.png)

	Кластеры Spark для HDInsight развертываются с тремя ролями: головной узел (два узла), рабочий узел (по крайней мере один узел) и узлы Zookeeper (три узла; уровень A1 — бесплатно).

	Клиенты оплачивают использование этих узлов на протяжении всего срока существования кластера. Начисление начинается сразу после создания кластера и завершается при его удалении (нельзя высвободить память, выделенную для кластеров, или приостановить их работу). На размер оплаты влияет размер кластера. Для учебных целей рекомендуется использовать один узел данных. Дополнительные сведения о ценах на HDInsight см. в статье [Цены на HDInsight](https://go.microsoft.com/fwLink/?LinkID=282635&clcid=0x409).


	>[AZURE.NOTE]Максимальный размер кластера зависит от подписки Azure. Чтобы увеличить лимит, обратитесь в службу поддержки по вопросам выставления счетов.

- **Версия HDInsight**

	Этот параметр используется для определения версии HDInsight для кластера. Дополнительные сведения см. в разделе [Версии HDInsight и компоненты Hadoop](https://go.microsoft.com/fwLink/?LinkID=320896&clcid=0x409).


- **Расположение (регион)**

	Кластер HDInsight должен находиться в том же расположении Azure, что и его учетная запись хранения, используемая по умолчанию.
	
	![Регионы Azure](./media/hdinsight-provision-clusters/Azure.regions.png)

	Просмотреть поддерживаемые регионы можно в раскрывающемся списке **Регион** на странице [Цены на HDInsight](https://go.microsoft.com/fwLink/?LinkID=282635&clcid=0x409).

- **Размер узла**

	![размеры узла виртуальной машины hdinsight](./media/hdinsight-provision-clusters/hdinsight.node.sizes.png)

	Выберите размеры виртуальной машины для узлов. Дополнительные сведения см. в статье [Размеры для облачных служб](cloud-services-sizes-specs.md).

	Цены зависят от размера выбранных виртуальных машин. HDInsight поддерживает для узлов кластера все виртуальные машины стандартного уровня. Дополнительную информацию о том, как размер виртуальной машины влияет на цены, см. в разделе <a href="http://azure.microsoft.com/pricing/details/hdinsight/" target="_blank">HDInsight Цены</a>.


- **Пользователи HDInsight**

	Кластеры HDInsight позволяют во время подготовки настроить две учетные записи пользователей.

	- Пользователь HTTP. По умолчанию используется имя admin и базовая конфигурация на портале Azure.
	- Пользователь RDP (кластеры Windows). Она используется для подключения к кластеру через RDP. При создании учетной записи необходимо задать дату окончания срока действия не позднее 90 дней с текущей даты.
	- Пользователь SSH (кластеры Linux). Она используется для подключения к кластеру через SSH. Дополнительные учетные записи пользователей SSH можно создать после создания кластера, следуя инструкциям в статье [Использование SSH с Hadoop в HDInsight на платформе Linux в Linux, Unix или OS X (предварительная версия)](hdinsight-hadoop-linux-use-ssh-unix.md).



- **Учетная запись хранения Azure.**

	HDFS использует для хранения данных несколько локальных дисков в кластере, а HDInsight — хранилище BLOB-объектов Azure. Хранилище BLOB-объектов Azure — это надежное, универсальное решение, которое полностью интегрируется с HDInsight. С помощью интерфейса распределенной файловой системы Hadoop (HDFS) все компоненты HDInsight могут напрямую взаимодействовать со структурированными или неструктурированными данными в хранилище больших двоичных объектов. Хранение данных в хранилище BLOB-объектов позволяет безопасно и без потери пользовательских данных удалять используемые для расчетов кластеры HDInsight.

	В процессе настройки необходимо задать учетную запись хранения Azure и контейнер для хранения BLOB-объектов. В некоторых сценариях создания учетную запись и контейнер потребуется создать заранее. Кластер будет использовать этот контейнер в качестве хранилища по умолчанию. Вы также можете указать дополнительные учетные записи хранения Azure (связанные хранилища), к которым кластер получит доступ. Кластер также сможет получать доступ к любым контейнерам BLOB-объектов, настроенным с полным общим доступом для чтения или общим доступом для чтения только на уровне BLOB-объектов. Дополнительные сведения об ограничениях доступа см. в разделе [Управление доступом к ресурсам хранилища Azure](storage-manage-access-to-resources.md).

	![Хранилище HDInsight](./media/hdinsight-provision-clusters/HDInsight.storage.png)

	>[AZURE.NOTE]BLOB-объекты группируются в контейнерах следующим образом.

	![Хранилище blob-объектов Azure](./media/hdinsight-provision-clusters/Azure.blob.storage.jpg)


	>[AZURE.WARNING]Не используйте один контейнер хранилища больших двоичных объектов для нескольких кластеров. Это не поддерживается.

	Дополнительную информацию об использовании дополнительных хранилищ больших двоичных объектов см. в разделе [Использование хранилища больших двоичных объектов Azure с HDInsight](hdinsight-use-blob-storage.md).

- **Метахранилище Hive/Oozie**

	Метахранилище содержит метаданные Hive и Oozie, такие как таблицы, секции, схемы и столбцы Hive. Использование метахранилища помогает сохранять метаданные Hive и Oozie, чтобы не создавать повторно таблицы Hive или задания Oozie при создании нового кластера. Для хранения подобной информации Hive по умолчанию использует встроенную базу данных SQL Azure. Встроенная база данных не сохраняет метаданные при удалении кластера. Предположим, вы создали кластер с метахранилищем Hive. и создали некоторые таблицы Hive. Если после удаления кластера вы повторно создадите его с использованием того же метахранилища Hive, то таблицы Hive, созданные в исходном кластере, будут доступны.
    
    > [AZURE.NOTE]Возможность настройки метахранилища не поддерживается для кластеров типа HBase.

## Настройка кластеров HDInsight (служба начальной загрузки)

В некоторых случаях требуется изменить файлы конфигурации.

- core-site.xml
- hdfs-site.xml
- mapred-site.xml
- yarn-site.xml
- hive-site.xml
- oozie-site.xml

При повторном развертывании образа изменения в кластере не сохраняются. Дополнительные сведения см. в разделе [Перезапуск экземпляра роли из-за обновлений ОС](http://blogs.msdn.com/b/kwill/archive/2012/09/19/role-instance-restarts-due-to-os-upgrades.aspx). Чтобы они сохранялись в течение всего времени существования кластера, можно в процессе создания изменить файлы конфигурации кластера HDInsight. Это рекомендуемый способ изменения конфигураций кластера и сохранения состояния между событиями перезапуска, перезагрузки и пересоздания образа Azure. Эти изменения конфигурации применяются до запуска службы, поэтому перезапуск службы не требуется.

Дополнительный пример см. в статье [Настройка кластеров HDInsight с помощью службы начальной загрузки](hdinsight-hadoop-customize-cluster-bootstrap.md).

## Настройка кластеров с помощью действия сценария

Можно установить дополнительные компоненты или настроить конфигурацию кластера с помощью сценариев во время создания. Такие сценарии вызываются с помощью **действия сценария**, которое является параметром конфигурации и может использоваться посредством портала, командлетов HDInsight PowerShell или пакета SDK для HDInsight .NET. Дополнительную информацию см. в статье [Настройка кластера HDInsight с помощью действия сценария](hdinsight-hadoop-customize-cluster.md).


## Использование виртуальных сетей Azure

[Azure Virtual Network](http://azure.microsoft.com/documentation/services/virtual-network/) позволяет создать безопасную, стабильную сеть, в которой будут находиться все ресурсы, необходимые для успешного функционирования вашего решения. Виртуальная сеть позволит вам:

* Соединить облачные ресурсы с частной сетью (только для облачных решений).

	![Диаграмма конфигурации только для облачных решений](./media/hdinsight-provision-clusters/hdinsight-vnet-cloud-only.png)

* Соединить ваши облачные ресурсы с сетью локального центра обработки данных (типа "сеть-сеть" или "точка-сеть") при помощи виртуальной частной сети (VPN).

	Конфигурация "сервер-сервер" позволяет соединять несколько ресурсов вашего центра обработки данных с виртуальной сетью Azure при помощи программного обеспечения VPN или маршрутизации и службы удаленного доступа.

	![Диаграмма конфигурации соединения "сервер-сервер"](./media/hdinsight-provision-clusters/hdinsight-vnet-site-to-site.png)

	Конфигурация "точка-сеть" позволит соединить конкретный ресурс с виртуальной сетью Azure при помощи программного обеспечения VPN.

	![Диаграмма конфигурации соединения "клиент-сервер"](./media/hdinsight-provision-clusters/hdinsight-vnet-point-to-site.png)

Сведения об использовании HDInsight в виртуальной сети, включая требования к конфигурации виртуальной сети, см. в разделе [Расширение возможностей HDInsight с помощью виртуальной сети Azure](hdinsight-extend-hadoop-virtual-network.md).

## Способы создания кластера

В этой статье мы рассмотрели основные сведения о создании кластера HDInsight под управлением Windows. Приведенная ниже таблица поможет вам получить дополнительные сведения о создании кластера с помощью метода, который наилучшим образом соответствует вашим потребностям.

| Используется для создания кластера… | С помощью веб-браузера | С помощью командной строки | С помощью REST API | С помощью пакета SDK | В ОС Linux, Mac OS X и Unix | В ОС Windows |
| ------------------------------- |:----------------------:|:--------------------:|:------------------:|:------------:|:-----------------------------:|:------------:|
| [Портал Azure](hdinsight-hadoop-create-windows-clusters-portal.md) | ✔ | &nbsp; | &nbsp; | &nbsp; | ✔ | ✔ |
| [Интерфейс командной строки Azure](hdinsight-hadoop-create-windows-clusters-cli.md) | &nbsp; | ✔ | &nbsp; | &nbsp; | ✔ | ✔ |
| [Azure PowerShell](hdinsight-hadoop-create-windows-clusters-powershell.md) | &nbsp; | ✔ | &nbsp; | &nbsp; | &nbsp; | ✔ |
| [cURL](hdinsight-hadoop-create-linux-clusters-curl-rest.md) | &nbsp; | ✔ | ✔ | &nbsp; | ✔ | ✔ |
| [Пакет SDK для .NET](hdinsight-hadoop-create-windows-clusters-dotnet-sdk.md) | &nbsp; | &nbsp; | &nbsp; | ✔ | ✔ | ✔ |
| [Шаблоны ARM](hdinsight-hadoop-create-windows-clusters-arm-templates.md) | &nbsp; | ✔ | &nbsp; | &nbsp; | ✔ | ✔ |

<!---HONumber=AcomDC_0114_2016-->