<properties
   pageTitle="Развертывание топологий Apache Storm в HDInsight и управление ими |Microsoft Azure"
   description="Узнайте, как развертывать и отслеживать топологии Apache Storm, а также управлять ими с помощью панели мониторинга Storm в HDInsight. Использование инструментов Hadoop для Visual Studio."
   services="hdinsight"
   documentationCenter=""
   authors="Blackmist"
   manager="paulettm"
   editor="cgronlun"/>

<tags
   ms.service="hdinsight"
   ms.devlang="java"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="big-data"
   ms.date="07/06/2015"
   ms.author="larryfr"/>

#Развертывание топологий Apache Storm в HDInsight и управление ими

Панель мониторинга Storm позволяет легко развернуть и запустить топологии Apache Storm в кластере HDInsight с помощью браузера. С помощью панели мониторинга можно также следить за топологиями и управлять их работой. Если используется Visual Studio, средства HDInsight для Visual Studio предоставляют аналогичные функциональные возможности в Visual Studio.

Панель мониторинга и компоненты Storm в средствах HDInsight используют интерфейс REST API для Storm, с помощью которого можно создавать собственные решения для мониторинга и управления.

##Предварительные требования

* **Apache Storm в HDInsight** — инструкции по созданию кластера см. в статье <a href="../hdinsight-storm-getting-started/" target="_blank">Начало работы с Apache Storm в HDInsight</a>.

* Для **панели мониторинга Storm** — современный браузер, который поддерживает HTML5.

* Для **Visual Studio** — пакет SDK для Azure 2.5.1 или более поздней версии и средства HDInsight для Visual Studio. Инструкции по установке и настройке средств HDInsight для Visual Studio см. в статье <a href="../hdinsight-hadoop-visual-studio-tools-get-started/" target="_blank">Начало работы со средствами HDInsight для Visual Studio</a>.

	Одна из следующих версий Visual Studio:

	* Visual Studio 2012 с <a href="http://www.microsoft.com/download/details.aspx?id=39305" target="_blank">обновлением 4</a>

	* Visual Studio 2013 с <a href="http://www.microsoft.com/download/details.aspx?id=44921" target="_blank">обновлением 4</a> или <a href="http://go.microsoft.com/fwlink/?LinkId=517284" target="_blank">Visual Studio 2013 Community</a>

	* <a href="http://visualstudio.com/downloads/visual-studio-2015-ctp-vs" target="_blank">Visual Studio 2015, CTP-версия 6</a>

	> [AZURE.NOTE]В настоящее время инструменты HDInsight для Visual Studio поддерживают только Storm в кластере HDInsight версии 3.2.

##Панель мониторинга Storm

Панель мониторинга Storm доступна в кластере Storm по URL-адресу **https://&lt;clustername>.azurehdinsight.net/**, где **clustername** — это имя Storm в кластере HDInsight. Панель мониторинга можно также открыть с помощью ссылки **Панель мониторинга Storm** на панели мониторинга кластера на портале Azure.

![портал с выделенной панелью мониторинга Storm][hdinsight-dashboard]

В верхней части панели мониторинга Storm выберите **Submit Topology** (Отправка топологии). Следуйте инструкциям на странице, чтобы запустить пример топологии или передать и запустить созданную вами топологию.

![страница отправки топологии][storm-dashboard-submit]

###Пользовательский интерфейс Storm

На панели мониторинга Storm выберите ссылку **Storm UI** (Пользовательский интерфейс Storm). Отобразится информация о кластере, а также всех запущенных топологиях.

![пользовательский интерфейс storm][storm-dashboard-ui]

> [AZURE.NOTE]В некоторых версиях Internet Explorer может возникать ситуация, когда пользовательский интерфейс Storm не обновляется после первого открытия. Например, он может не отображать новые отправленные топологии или отображать топологию как активную, хотя она была выключена. Корпорация Майкрософт знает о наличии этой проблемы и работает над ее решением.

####Главная страница

На главной странице пользовательского интерфейса Storm отображается следующая информация.

* **Cluster summary** (Сводка по кластерам) — основная информация о кластере Storm.

* **Topology summary** (Сводка по топологиям) — список запущенных топологий. С помощью ссылок в этом разделе можно просмотреть дополнительную информацию о конкретных топологиях.

* **Supervisor summary** (Сводка по контролеру) — информация о контролере Storm.

* **Nimbus configuration** (Конфигурация Nimbus) — конфигурация Nimbus для кластера.

####Сводка по топологии

При выборе ссылки в разделе **Topology summary** (Сводка по топологиям) отображается следующая информация о топологии.

* **Topology summary** (Сводка по топологии) — основная информация о топологии.

* **Topology actions** (Действия с топологией) — действия управления, которые можно выполнять с топологией.

	* **Activate** (Включить) — возобновление обработки отключенной топологии.

	* **Deactivate** (Отключить) — приостановка выполняемой топологии.

	* **Rebalance** (Повторная балансировка) — корректировка параллелизма топологии. После изменения числа узлов в кластере необходимо выполнить повторную балансировку топологий. Это позволяет топологии скорректировать параллелизм для компенсации увеличения или уменьшения количества узлов в кластере.

		Дополнительные сведения см. в статье <a href="http://storm.apache.org/documentation/Understanding-the-parallelism-of-a-Storm-topology.html" target="_blank">Understanding the parallelism of a Storm topology</a> (Общие сведения о параллелизме топологии Storm).

	* **Kill** (Удалить) — останавливает выполнение топологии Storm по истечении заданного времени ожидания.

* **Topology stats** (Статистика топологии) — статистика по топологии. С помощью ссылок в столбце **Window** (Окно) можно установить временные рамки для оставшихся записей на странице.

* **Spouts** (Воронки) — используемые в топологии источники данных, которые называются воронками. С помощью ссылок в этом разделе можно получить дополнительную информацию о конкретных воронках.

* **Bolts** (Сита — используемые в топологии обработчики данных, которые называются ситами. С помощью ссылок в этом разделе можно получить дополнительную информацию о конкретных ситах.

* **Topology configuration** (Конфигурация топологии) — конфигурация выбранной топологии.

####Сводка по воронкам и ситам

При выборе воронки в разделе **Spouts** (Воронки) или **Bolts** (Сита) отображается следующая информация о выбранном элементе.

* **Component summary** (Сводка по компоненту) — основная информация о воронке или сите.

* **Spout/Bolt stats** (Статистика по воронке или ситу) — статистика по воронке или ситу. С помощью ссылок в столбце **Window** (Окно) можно установить временные рамки для оставшихся записей на странице.

* **Input stats** (Статистика по входным данным, только сита) — информация о входных потоках, проходящих через сито.

* **Output stats** (Статистика по выходным данным) — информация о потоках, создаваемых этой воронкой или ситом.

* **Executors** (Исполнители) — информация об экземплярах воронки или сита. Выберите запись **Port** (Порт) для конкретного исполнителя, чтобы просмотреть журнал диагностической информации, созданный для этого экземпляра.

* **Errors** (Ошибки) — информация об ошибках для данной воронки или сита.

##Средства HDInsight для Visual Studio

Средства HDInsight можно использовать для отправки топологии C# или гибридной топологии в кластер Storm. Далее используется пример приложения. Информацию о создании собственных топологий, с помощью средств HDInsight см. в разделе [Разработка топологий на C# с помощью средств HDInsight для Visual Studio](hdinsight-storm-develop-csharp-visual-studio-topology.md).

Чтобы развернуть пример в Storm в кластере HDInsight, а затем просмотреть топологию и управлять ею, сделайте следующее.

1. Если вы еще не установили последнюю версию средств HDInsight для Visual Studio, см. статью <a href="../hdinsight-hadoop-visual-studio-tools-get-started/" target="_blank">Начало работы со средствами HDInsight для Visual Studio</a>.

2. Откройте Visual Studio, выберите последовательно **Файл** > **Создать** > **Проект**.

3. В диалоговом окне **Новый проект** разверните **Установленные** > **Шаблоны** и выберите **HDInsight**. В списке шаблонов выберите **Пример Storm**. В нижней части диалогового окна введите имя приложения.

	![изображение](./media/hdinsight-storm-deploy-monitor-topology/sample.png)

1. В **обозревателе решений** щелкните правой кнопкой мыши проект и выберите **Отправить в Storm в HDInsight**.

	> [AZURE.NOTE]При появлении запроса введите учетные данные входа для своей подписки Azure. Если у вас несколько подписок, воспользуйтесь той, что содержит Storm в кластере HDInsight.

2. Выберите Storm в кластере HDInsight из раскрывающегося списка **Кластер Storm** и выберите **Отправить**. Вы можете отслеживать выполнение отправки в окне **Выходные данные**.

3. После успешной отправки топологии должны появиться **топологии Storm** для кластера. Выберите топологию в списке, чтобы просмотреть информацию о выполняемой топологии.

	![мониторинг Visual Studio](./media/hdinsight-storm-deploy-monitor-topology/vsmonitor.png)

	> [AZURE.NOTE]Можно также просмотреть **топологии Storm** из **обозревателя серверов**. Для этого разверните **Azure** > **HDInsight**, затем щелкните правой кнопкой мыши кластер Storm в HDInsight и выберите пункт **Просмотреть топологии Storm**.

	Используйте ссылки на компоненты spout или bolt, чтобы просмотреть информацию о них. Для каждого выбранного элемента открывается новое окно.

4. В представлении **Topology Summary** (Сводка по топологиям) выберите **Kill** (Удалить), чтобы остановить топологию.

	> [AZURE.NOTE]Топологии Storm выполняются, пока не будут удалены или пока не будет удален кластер.

##Интерфейс REST API

Пользовательский интерфейс Storm построен на базе REST API, поэтому функциональность отслеживания и управления можно реализовать аналогичным образом с помощью API. С помощью REST API можно создать пользовательские средства для отслеживания топологий Storm и управления ими.

Дополнительные сведения см. в разделе <a href="https://github.com/apache/storm/blob/master/STORM-UI-REST-API.md" target="_base">API-интерфейс REST пользовательского интерфейса Storm</a>. Следующая информация касается использования REST API с Apache Storm в HDInsight.

###Базовый универсальный код ресурса

Базовый универсальный код ресурса для интерфейса REST API в кластерах HDInsight — **https://&lt;clustername>.azurehdinsight.net/stormui/api/v1/**, где **clustername** — это имя Storm в кластере HDInsight.

###Проверка подлинности

Для запросов REST API необходимо использовать **обычную проверку подлинности** с помощью имени и пароля администратора кластера HDInsight.

> [AZURE.NOTE]Так как при обычной проверке подлинности данные отправляются открытым текстом, следует **всегда** использовать HTTPS для защиты связи с кластером.

###Возвращаемые значения

Информацию, возвращаемую REST API, можно использовать только в пределах кластера или виртуальной машины в одной виртуальной сети Azure, выполняющей функцию кластера. Например, полное доменное имя (FQDN), возвращаемое для серверов Zookeeper, не будет доступно из Интернета.

##Дальнейшие действия

Теперь, когда вы знаете принципы развертывания и мониторинга топологии с помощью панели мониторинга Storm, вы можете ознакомиться с другими сведениями.

* [Развертывание топологий C# с помощью средств HDInsight для Visual Studio](hdinsight-storm-develop-csharp-visual-studio-topology.md)

* [Разработка топологий на платформе Java с помощью Maven](hdinsight-storm-develop-java-topology.md)

Другие примеры топологий Storm см. в разделе [Примеры топологий для Storm в HDInsight](hdinsight-storm-example-topology.md).

[hdinsight-dashboard]: ./media/hdinsight-storm-deploy-monitor-topology/dashboard-link.png
[storm-dashboard-submit]: ./media/hdinsight-storm-deploy-monitor-topology/submit.png
[storm-dashboard-ui]: ./media/hdinsight-storm-deploy-monitor-topology/storm-ui-summary.png

<!---HONumber=July15_HO2-->