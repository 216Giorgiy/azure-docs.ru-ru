.<properties
   pageTitle="Мониторинг и управление кластерами HDInsight с помощью веб-интерфейса Apache Ambari | Microsoft Azure"
   description="Узнайте, как использовать Ambari для наблюдения за кластерами HDInsight на платформе Linux и управления их функционированием. В этом документе рассказывается об использовании веб-интерфейса Ambari, предоставляемого с кластерами HDInsight."
   services="hdinsight"
   documentationCenter=""
   authors="Blackmist"
   manager="paulettm"
   editor="cgronlun"
	tags="azure-portal"/>

.<tags
   ms.service="hdinsight"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="big-data"
   ms.date="07/12/2016"
   ms.author="larryfr"/>

#Управление кластерами HDInsight с помощью веб-интерфейса Ambari

[AZURE.INCLUDE [ambari-selector](../../includes/hdinsight-ambari-selector.md)]

Apache Ambari упрощает управление кластером Hadoop и его мониторинг за счет удобного пользовательского веб-интерфейса и интерфейса REST API. Ambari предоставляется с кластерами HDInsight под управлением Linux и используется для мониторинга кластера и внесения изменений в его конфигурацию.

В этом документе рассказывается об использовании веб-интерфейса Ambari с кластером HDInsight.

##<a id="whatis"></a>Что такое Ambari

<a href="http://ambari.apache.org" target="_blank">Apache Ambari</a> упрощает управление Hadoop, предоставляя простой в использовании веб-интерфейс, который можно использовать для подготовки и мониторинга кластеров Hadoop, а также управления их функционированием. Разработчики могут интегрировать эти возможности в своих приложениях с помощью <a href="https://github.com/apache/ambari/blob/trunk/ambari-server/docs/api/v1/index.md" target="_blank">интерфейсов API REST Ambari</a>.

Веб-интерфейс Ambari предоставляется по умолчанию с кластерами HDInsight на платформе Linux.

##Соединение

Веб-интерфейс Ambari доступен по адресу HTTPS://CLUSTERNAME.azurehdidnsight.net, где __CLUSTERNAME__ — это имя вашего кластера.

> [AZURE.IMPORTANT] Подключение к Ambari в HDInsight выполняется по протоколу HTTPS. Также необходимо выполнить вход в Ambari с помощью имени учетной записи администратора (по умолчанию используется __admin__) и пароля, указанных при создании кластера.

##Прокси-сервер SSH

> [AZURE.NOTE] Хотя Ambari для кластера можно использовать непосредственно в Интернете, некоторые ссылки из веб-интерфейса Ambari (например, для JobTracker) не доступны в Интернете. Поэтому при попытке доступа к этим функциям может отображаться ошибка «сервер не найден», если вы не используете на головном узле кластера туннель Secure Shell (SSH) для проксирования веб-трафика.

Сведения о создании SSH-туннеля для работы с Ambari см. в статье [Использование SSH-туннелирования для доступа к веб-интерфейсу Ambari, ResourceManager, JobHistory, NameNode, Oozie и другим веб-интерфейсам](hdinsight-linux-ambari-ssh-tunnel.md).

##Веб-интерфейс Ambari

При подключении к веб-интерфейсу Ambari вам будет предложено ввести учетные данные для доступа к странице. Укажите имя администратора кластера (по умолчанию это Admin) и пароль, которые были указаны при создании кластера.

При открытии страницы обратите внимание на панель вверху. Она содержит следующую информацию и элементы управления:

.![ambari-nav](./media/hdinsight-hadoop-manage-ambari/ambari-nav.png)

* **Логотип Ambari** — позволяет открыть панель мониторинга, которую можно использовать для мониторинга кластера.

* **Имя кластера, за которым следует поле «К-во операций»** — число текущих операций Ambari. Если выбрать имя кластера или **К-во операций**, отобразится список фоновых операций.

* **К-во оповещений** — число предупреждений или критических оповещений для кластера, если таковые имеются. При выборе этого элемента отобразится список оповещений.

* **Панель мониторинга** — позволяет отобразить панель мониторинга.

* **Службы** — информация и параметры конфигурации служб в кластере.

* **Узлы** — информация и параметры конфигурации узлов в кластере.

* **Оповещения** — журнал с информацией, предупреждениями и критическими оповещениями.

* **Администратор** — стек программного обеспечения и службы, которые установлены в кластере, информация об учетной записи службы и данные о безопасности Kerberos.

* **Кнопка «Администратор»** — управление Ambari, параметры пользователя и выход.

##Мониторинг

###Оповещения

Ambari предоставляет множество предупреждений, которые могут находиться в одном из следующих состояний.

* **ОК;**

* **Предупреждение;**

* **КРИТИЧЕСКИЙ;**

* **НЕИЗВЕСТНО.**

При любых оповещениях, кроме **ОК**, в поле **К-во оповещений** в верхней части страницы будет отображаться их общее количество. Выберите эту запись, чтобы отобразить предупреждения и их состояние.

Оповещения разбиты на несколько групп по умолчанию, которые можно просмотреть на странице **Оповещения**.

.![страница «Оповещения»](./media/hdinsight-hadoop-manage-ambari/alerts.png)

Группами можно управлять с помощью меню **Действия**, а также выбрав **Управление группами оповещений**. Это позволит изменить существующие группы или создать новые.

.![диалоговое окно «Управление группами оповещений»](./media/hdinsight-hadoop-manage-ambari/manage-alerts.png)

С помощью меню **Действия** можно также настроить уведомления об оповещениях. Это позволит создавать триггеры, отправляющие уведомления по **ЭЛЕКТРОННОЙ ПОЧТЕ** или протоколу **SNMP** при появлении определенного оповещения заданной серьезности. Например, оповещение может отправляться, если для какого-либо оповещения в группе **YARN по умолчанию** установлено значение **Критическое**.

.![диалоговое окно создания оповещения](./media/hdinsight-hadoop-manage-ambari/create-alert-notification.png)

###HDInsight

На вкладке **Метрики** панели мониторинга содержится ряд мини-приложений, которые позволяют легко определить состояние кластера с первого взгляда. Если щелкнуть некоторые мини-приложения, например **Загрузка ЦП**, отобразится дополнительная информация.

.![панель мониторинга с метриками](./media/hdinsight-hadoop-manage-ambari/metrics.png)

На вкладке **Тепловые карты** метрики отображаются в виде цветных тепловых карт с переходом от зеленого к красному.

.![панель мониторинга с тепловыми картами](./media/hdinsight-hadoop-manage-ambari/heatmap.png)

Чтобы узнать больше об узлах кластера, выберите **Узлы**, а затем — определенный узел, который вас интересует.

.![информация об узле](./media/hdinsight-hadoop-manage-ambari/host-details.png)

###Службы

Боковая панель **Службы** на панели мониторинга позволяет получить общее представление о состоянии служб, работающих в кластере. Для обозначения состояния или мер, которые необходимо предпринять, используются различные значки, например желтый значок циклического повторения, если нужно перезапустить службу.

.![боковая панель «Службы»](./media/hdinsight-hadoop-manage-ambari/service-bar.png)

При выборе службы для нее отобразится более подробная информация.

![сводные данные о службе](./media/hdinsight-hadoop-manage-ambari/service-details.png)

####Быстрые ссылки

Для некоторых служб в верхней части страницы отображается ссылка **Быстрые ссылки**. Их можно использовать для доступа к определенным веб-интерфейсам службы, например:

* **Журнал заданий** — журнал заданий MapReduce;

* **Диспетчер ресурсов** — пользовательский интерфейс диспетчера ресурсов YARN;

* **NameNode** — пользовательский интерфейс NameNode распределенной файловой системы Hadoop (HDFS).

* **Веб-интерфейс Oozie** — пользовательский интерфейс Oozie.

При выборе любой из этих ссылок в браузере откроется новая вкладка с выбранной страницей.

> [AZURE.NOTE] Если не используется SSL-туннель для проксирования веб-трафика, поступающего в кластер, выбор ссылки **Быстрые ссылки** для любой службы приведет к ошибке «сервер не найден». Это связано с тем, что веб-приложения, используемые для отображения этих сведений, не доступны в Интернете.
>
> Сведения об использовании SSH-туннеля с HDInsight см. в статье [Использование SSH-туннелирования для доступа к веб-интерфейсу Ambari, ResourceManager, JobHistory, NameNode, Oozie и другим веб-интерфейсам](hdinsight-linux-ambari-ssh-tunnel.md).

##управления

###Пользователи, группы и разрешения Ambari

В кластерах HDInsight не следует использовать управление пользователями, группами и разрешениями.

###Узлы

На странице **Узлы** перечислены все узлы в кластере. Для управления узлами, сделайте следующее.

.![страница «Узлы»](./media/hdinsight-hadoop-manage-ambari/hosts.png)

> [AZURE.NOTE] В кластерах HDInsight не следует использовать добавление, списание или восстановление списанного узла.

1. Выберите узлы, которыми вы хотите управлять.

2. С помощью меню **Действия** выберите действие, которое необходимо выполнить.

	* **Запустить все компоненты** — запуск всех компонентов на узле.

	* **Остановить все компоненты** — остановка всех компонентов на узле.

	* **Перезапустить все компоненты** — остановка и запуск всех компонентов на узле.

	* **Включить режим обслуживания** — подавление оповещений для узла. Этот параметр должен быть включен при выполнении действий, которые будут создавать оповещения, например перезапуск службы, которую используют запущенные службы.

	* **Отключить режим обслуживания** — возврат узла к обычному режиму оповещений.

	* **Остановить** — остановка DataNode или NodeManagers на узле.

	* **Запуск** — запуск DataNode или NodeManagers на узле.

	* **Перезапустить** — остановка и запуск DataNode или NodeManagers на узле.

	* **Списать** — удаление узла из кластера.

		> [AZURE.NOTE] Не используйте это действие в кластерах HDInsight.

	* **Восстановить списанные** — добавление списанных ранее узлов в кластер.

		> [AZURE.NOTE] Не используйте это действие в кластерах HDInsight.

###<a id="service"></a>Службы

На странице **Панель мониторинга** или **Службы** с помощью кнопки **Действия** в нижней части списка служб можно остановить и снова запустить все службы.

![действия в службе](./media/hdinsight-hadoop-manage-ambari/service-actions.png)

> [AZURE.WARNING] Несмотря на то что в этом меню есть пункт __Добавить службу__, не следует использовать его для добавления служб в кластер HDInsight. Для добавления новых служб следует использовать действие сценария во время подготовки кластера. Дополнительные сведения об использовании действий сценария см. в статье [Настройка кластеров HDInsight с помощью действий сценария](hdinsight-hadoop-customize-cluster-linux.md).


Хотя с помощью кнопки **Действия** можно перезапустить все службы, зачастую требуется запустить, остановить или перезапустить только одну из них. Чтобы выполнить действия для отдельной службы, сделайте следующее.

1. На странице **Панель мониторинга** или **Службы** выберите службу.

2. В верхней части вкладки **Сводка** используйте кнопку **Действия со службой** и выберите действие, которое необходимо выполнить. Это приведет к перезапуску службы на всех узлах.

	.![действие в службе](./media/hdinsight-hadoop-manage-ambari/individual-service-actions.png)

	> [AZURE.NOTE] Перезапуск некоторых служб во время работы кластера может привести к формированию предупреждений. Чтобы избежать этого, можно использовать кнопку **Действия со службой**, чтобы включить **режим обслуживания** для службы перед выполнением перезагрузки.

3. После выбора действия значение в поле **К-во операций** в верхней части страницы увеличится, что будет свидетельствовать о выполнении фоновой операции. Если настроено отображение списка фоновых операций, этот список появится на экране.

	> [AZURE.NOTE] Если для службы включен **режим обслуживания**, не забудьте отключить его с помощью кнопки **Действия со службой** после завершения операции.

Чтобы настроить службу, сделайте следующее:

1. На странице **Панель мониторинга** или **Службы** выберите службу.

2. Выберите вкладку **Конфигурации**. Отобразится текущая конфигурация. Отобразится также список предыдущих конфигураций.

	![конфигурации](./media/hdinsight-hadoop-manage-ambari/service-configs.png)

3. Используйте отображаемые поля для изменения конфигурации, а затем выберите **Сохранить**. Можно также выбрать предыдущую конфигурацию, а затем выбрать **Сделать текущей**, чтобы выполнить откат к предыдущим настройкам.

##Представления Ambari

Представления Ambari позволяют разработчикам подключать элементы пользовательского интерфейса к веб-интерфейсу Ambari, используя [Ambari Views Framework](https://cwiki.apache.org/confluence/display/AMBARI/Views). HDInsight предлагает следующие представления с типами кластеров Hadoop:

* Диспетчер очередей Yarn. Диспетчер очередей предоставляет простой пользовательский интерфейс для просмотра и изменения очередей Yarn.
* Представление Hive. Представление Hive позволяет выполнять запросы Hive прямо из браузера. Можно сохранять запросы, просматривать результаты, сохранять их в хранилище кластера или загружать результаты в локальную систему. Дополнительные сведения об использовании представлений Hive см. в разделе [Использование представлений Hive с HDInsight](hdinsight-hadoop-use-hive-ambari-view.md).
* Представление Tez. Представление Tez позволяет лучше понимать и оптимизировать задания, просматривая сведения о том, какие задания выполняются и какие ресурсы для этого используются.

<!---HONumber=AcomDC_0817_2016-->