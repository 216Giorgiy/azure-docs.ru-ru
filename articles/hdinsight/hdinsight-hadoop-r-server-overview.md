---
title: "Что такое R в HDInsight? Основные сведения об R Server в HDInsight | Документация Майкрософт"
description: "Общие сведения о R Server в кластере HDInsight (предварительная версия) и использовании R Server для создания приложений для анализа больших данных."
services: hdinsight
documentationcenter: 
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 6dc21bf5-4429-435f-a0fb-eea856e0ea96
ms.service: hdinsight
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 11/15/2016
ms.author: jeffstok
translationtype: Human Translation
ms.sourcegitcommit: b6e985d839939767df7a0aa67bf534d0cf7b2cff
ms.openlocfilehash: 87003598a2fcdc3b7caece4d0b5702324c663761


---
# <a name="overview-of-r-server-on-hdinsight"></a>Общие сведения об R Server в HDInsight
Благодаря Microsoft Azure HDInsight можно создавать кластеры HDInsight в Azure с использованием Microsoft R Server. Это новшество позволяет специалистам по обработке и анализу данных, статистикам и программистам на R получать доступ к масштабируемым, распределенным методам аналитики в HDInsight по требованию.

Кластеры можно масштабировать в соответствии с размерами существующих проектов и задач, а также удалять, когда они больше не требуются. Поскольку такие кластеры входят в Azure HDInsight, они поставляются с круглосуточной поддержкой корпоративного уровня, гарантией бесперебойной работы в течение 99,9 % времени и возможностью гибкой интеграции с другими компонентами экосистемы Azure.

R Server в HDInsight предоставляет новейшие возможности для анализа больших наборов данных, загруженных в хранилище BLOB-объектов Azure, на базе языка R. Так как R Server использует открытый код на языке R, создавая приложения на базе языка R, вы можете использовать более 8000 открытых пакетов R, а также процедуры из ScaleR — пакета аналитики больших данных от Майкрософт, который входит в состав R Server.

Для подключения к кластеру и выполнения скриптов на языке R удобно использовать граничный узел кластеров. На граничном узле вы можете выполнять распараллеленные распределенные функции на ядрах сервера граничного узла. Также вы можете выполнять эти функции на узлах кластера с помощью контекста вычислений Hadoop MapReduce ScaleR или Spark.

Модели или прогнозы, которые получаются в результате анализа, можно загрузить для локального использования. Их также можно использовать в любой службе Azure, например в [веб-службе](../machine-learning/machine-learning-publish-a-machine-learning-web-service.md) [Студия машинного обучения Azure](http://studio.azureml.net).

## <a name="get-started-with-r-on-hdinsight"></a>Начало работы с R Server в HDInsight
Чтобы добавить R Server в кластере HDInsight, необходимо создать на портале Azure кластер Hadoop или Spark. Оба типа кластеров используют одну и ту же конфигурацию, включающую R Server на узлах данных кластера и граничный узел как платформу для выполнения аналитики на базе R Server. Подробные инструкции по созданию кластера см. в статье [Приступая к работе с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-get-started.md).

## <a name="learn-about-data-storage-options"></a>Варианты хранилищ данных
По умолчанию для кластеров HDInsight используется хранилище BLOB-объектов с файловой системой HDFS, сопоставленной с контейнером BLOB-объектов. Это гарантирует сохранение данных независимо от того, какие данные передаются или записываются в хранилище кластеров в ходе анализа. Вы можете использовать служебную программу [AzCopy](../storage/storage-use-azcopy.md) , чтобы копировать данные из большого двоичного объекта.

Помимо хранилища BLOB-объектов вы можете использовать с кластером [хранилище озера данных Azure](https://azure.microsoft.com/services/data-lake-store/) . Используя озеро данных, вы можете использовать как хранилище BLOB-объектов, так и озеро данных для хранилища HDFS.

На граничном узле для хранения данных можно также использовать [файлы Azure](../storage/storage-how-to-use-files-linux.md). Они позволяют подключить общую папку, созданную в службе хранения Azure, к файловой системе Linux. Дополнительные сведения о вариантах хранения данных для R Server в кластере HDInsight см. в статье [Параметры службы хранилища Azure для R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-storage.md).

## <a name="access-r-server-on-the-cluster"></a>Доступ к R Server в кластере
После создания кластера с R Server вы можете подключиться к консоли R на граничном узле кластера через SSH или PuTTY. Если вы решили установить на граничном узле необязательную интегрированную среду разработки RStudio Server, вы также можете подключиться через браузер. Дополнительные сведения об установке сервера RStudio Server см. в статье [Установка RStudio с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-install-r-studio.md).   

## <a name="develop-and-run-r-scripts"></a>Разработка и выполнение сценариев R
Для создания и выполнения сценариев R можно использовать не только распараллеленные, распределенные процедуры из библиотеки ScaleR, но и более 8000 пакетов R с открытым исходным кодом. Как правило, сценарий, выполняемый на R Server на граничном узле, выполняется в интерпретаторе R на этом узле. Исключением являются действия, которые вызывают функцию ScaleR с контекстом вычислений Hadoop Map Reduce (RxHadoopMR) или Spark (RxSpark).

В этих случаях функция выполняется в распределенном режиме на всех узлах данных (задач) кластера, связанных с соответствующими данными. Дополнительные сведения о различных параметрах контекста вычислений см. в статье [Параметры контекста вычислений для R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-compute-contexts.md).

## <a name="operationalize-a-model"></a>Ввод модели в эксплуатацию
После того как моделирование данных будет завершено, вы сможете запустить модель в эксплуатацию для составления прогнозов на основе новых данных в Azure или в локальной среде. Этот процесс называется оценкой. Рассмотрим несколько примеров.

### <a name="score-in-hdinsight"></a>Оценка в HDInsight
Для оценки в HDInsight напишите функцию R, которая вызывает модель для создания прогнозов для нового файла данных, загруженного в учетную запись хранения. Сохраните прогнозы в учетной записи хранения. Эту процедуру можно выполнять на граничном узле кластера по требованию или по расписанию.  

### <a name="score-in-azure-machine-learning"></a>Оценка в машинном обучении Azure
Для оценки с помощью веб-службы машинного обучения Azure используйте пакет R с открытым кодом для машинного обучения Azure, известный как [AzureML](https://cran.r-project.org/web/packages/AzureML/vignettes/getting_started.html), чтобы опубликовать модель как веб-службу Azure. Для удобства этот пакет предварительно установлен на граничном узле. Используйте средства машинного обучения, чтобы создать пользовательский интерфейс для веб-службы. Затем вызовите веб-службу, чтобы выполнить оценку.

При выборе этого варианта объекты модели ScaleR необходимо конвертировать в эквивалентные объекты модели с открытым кодом для использования с веб-службой. Для этого можно использовать функции приведения ScaleR (такие как `as.randomForest()` ) для моделей на основе ансамблей.

### <a name="score-on-premises"></a>Оценка в локальной среде
Для оценки в локальной среде созданную модель можно сериализовать в R, загрузить на локальный компьютер, десериализовать, а затем использовать для оценки новых данных. Вы можете оценить новые данные, используя подход, описанный ранее в статье [Общие сведения об R Server в HDInsight (предварительная версия)](#scoring-in-hdinsight), или с помощью [DeployR](https://deployr.revolutionanalytics.com/).

## <a name="maintain-the-cluster"></a>Обслуживание кластера
### <a name="install-and-maintain-r-packages"></a>Установка и обслуживание пакетов R
Большинство используемых вами пакетов R должны будут находиться на граничном узле, так как именно там выполняется основная часть ваших сценариев R. Для установки дополнительных пакетов R на граничном узле можно использовать обычный для R метод `install.packages()` .

Если вы пользуетесь только процедурами из библиотеки ScaleR для выполнения сценариев во всем кластере, устанавливать дополнительные пакеты R на узлы данных вам, скорее всего, не придется. Дополнительные пакеты могут потребоваться для выполнения метода **rxExec** или **RxDataStep** на узлах данных.

В таких случаях после создания кластера необходимо указать дополнительные пакеты с помощью действия скрипта. Дополнительные сведения см. в статье [Приступая к работе с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-get-started.md).   

### <a name="change-hadoop-map-reduce-memory-settings"></a>Изменение параметров памяти Hadoop MapReduce
Изменив кластер, можно скорректировать объем памяти, который будет доступен R Server при выполнении задания MapReduce. Чтобы изменить кластер, используйте пользовательский интерфейс Ambari, который вы найдете в колонке своего кластера на портале Azure. Инструкции по получению доступа к пользовательскому интерфейсу Ambari для кластера см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md).

Вы также можете изменить объем памяти, доступной для R Server, с помощью параметров Hadoop в вызове метода **RxHadoopMR** , как показано ниже.

    hadoopSwitches = "-libjars /etc/hadoop/conf -Dmapred.job.map.memory.mb=6656"  

### <a name="scale-your-cluster"></a>Масштабирование кластера
Существующий кластер можно увеличить или уменьшить на портале. Благодаря масштабированию вы получаете дополнительную мощность, которая может потребоваться для более ресурсоемких задач. Также масштабирование позволяет свернуть кластер во время простоя. Инструкции по масштабированию кластера см. в статье [Управление кластерами Hadoop в HDInsight с помощью портала Azure](hdinsight-administer-use-portal-linux.md).

### <a name="maintain-the-system"></a>Поддержка системы
Обслуживание проводится на основных виртуальных машинах Linux в кластере HDInsight в нерабочее время и включает установку исправлений ОС и т. д. Как правило, обслуживание проводится каждый понедельник и четверг в 3:30 (по местному времени для виртуальной машины). Обновления выполняются таким образом, чтобы они не влияли более чем на четверть кластера одновременно.  

Так как головные узлы избыточны, а затрагиваются не все узлы данных, выполнение заданий в это время может занимать больше времени. Но они все равно будут выполняться до завершения. Обслуживание не затрагивает установленное пользовательское программное обеспечение или локальные данные, если только в системе не возникнет неустранимая ошибка, требующая повторной сборки кластера.

## <a name="learn-about-ide-options-for-r-server-on-an-hdinsight-cluster"></a>Параметры IDE для R Server в кластере HDInsight
Граничный узел Linux в кластере HDInsight используется в качестве платформы для анализа на основе R. Установив подключение к кластеру, вы можете запустить интерфейс консоли для R Server. Для этого наберите **R** в командной строке Linux. Работать с консолью будет гораздо удобнее, если вы откроете текстовый редактор с R-скриптом в другом окне и будете вырезать и вставлять необходимые фрагменты скрипта в R-консоль.

Более сложный инструмент для разработки скриптов R — среда IDE на основе R для использования на рабочем столе, например недавно анонсированная корпорацией Майкрософт среда разработки [R Tools for Visual Studio](https://www.visualstudio.com/en-us/features/rtvs-vs.aspx) (RTVS). Это семейство настольных и серверных инструментов [RStudio](https://www.rstudio.com/products/rstudio-server/). Вы также можете использовать [StatET](http://www.walware.de/goto/statet) Walware на основе Eclipse.

Другой вариант — это установка IDE на самом граничном узле Linux.  Также часто используется [RStudio Server](https://www.rstudio.com/products/rstudio-server/)— IDE на основе браузера, предназначенная для удаленных клиентов. Установка RStudio Server на граничном узле кластера HDInsight предоставляет доступ ко всем функциональным возможностям IDE для разработки и выполнения скриптов R с использованием R Server в кластере. Это может значительно повысить производительность по сравнению с применением R-консоли.  Если вы хотите использовать RStudio Server, ознакомьтесь со статьей [Установка RStudio с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-install-r-studio.md).

## <a name="learn-about-pricing"></a>Информация о ценах
Кластер HDInsight с R Server оплачивается по такой же схеме, что и стандартные кластеры HDInsight. Стоимость кластера зависит от размера основной виртуальной машины на разных узлах имен, узлах данных и граничных узлах, а также от наценки за ядро-час в кластере. Дополнительные сведения о ценах на кластеры HDInsight и доступности 30-дневной бесплатной пробной версии см. на странице [цен на HDInsight](https://azure.microsoft.com/pricing/details/hdinsight/).

## <a name="next-steps"></a>Дальнейшие действия
По следующим ссылкам вы найдете инструкции по использованию R Server для работы с кластерами HDInsight.

* [Приступая к работе с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-get-started.md)
* [Установка RStudio с R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-install-r-studio.md)
* [Варианты контекста вычислений для R Server в HDInsight](hdinsight-hadoop-r-server-compute-contexts.md)
* [Параметры службы хранилища Azure для R Server в HDInsight (предварительная версия)](hdinsight-hadoop-r-server-storage.md)




<!--HONumber=Nov16_HO3-->


