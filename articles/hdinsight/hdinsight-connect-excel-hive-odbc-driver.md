.<properties
   pageTitle="Подключение Excel к Hadoop с помощью драйвера Hive ODBC | Microsoft Azure"
   description="Узнайте, как установить и использовать драйвер Microsoft Hive ODBC для Excel, чтобы запрашивать данные из кластера HDInsight."
   services="hdinsight"
   documentationCenter=""
   authors="mumian"
   manager="paulettm"
   tags="azure-portal"
   editor="cgronlun"/>

.<tags
   ms.service="hdinsight"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="big-data"
   ms.date="07/25/2016"
   ms.author="jgao"/>

#Подключение Excel к Hadoop с помощью драйвера Microsoft Hive ODBC

[AZURE.INCLUDE [ODBC-JDBC-selector](../../includes/hdinsight-selector-odbc-jdbc.md)]

Решение Майкрософт для работы с данными большого размера интегрирует компоненты бизнес-аналитики Майкрософт с кластерами Apache Hadoop, которые были развернуты с помощью Azure HDInsight. Примером такой интеграции является возможность подключения Excel к хранилищу данных Hive на кластере Hadoop в HDInsight с помощью драйвера Microsoft Hive ODBC.

Можно также подключить данные, связанные с кластером HDInsight, и другими источниками данных, включая другие кластеры Hadoop (не HDInsight) из Excel с использованием надстройки Microsoft Power Query для Excel. Сведения об установке и использовании Power Query см. в разделе [Подключение Excel к HDInsight с использованием Power Query][hdinsight-power-query]

> [AZURE.NOTE] Хотя действия, описанные в этой статье, применимы к кластеру HDInsight под управлением Windows или Linux, Windows является обязательным для клиентской рабочей станции.

**Предварительные требования**:

Перед началом работы с этой статьей необходимо иметь следующее:

- **Кластер HDInsight**. Для создания кластера ознакомьтесь с разделом [Приступая к работе с Azure HDInsight][hdinsight-get-started].
- **Рабочая станция** с Office 2013 профессиональный плюс, Office 365 профессиональный плюс, Excel 2013 автономный или Office 2010 профессиональный плюс.


##Установка драйвера Microsoft Hive ODBC

Загрузите и установите драйвер Microsoft Hive ODBC из [Центра загрузок][hive-odbc-driver-download].

Этот драйвер может быть установлен на 32-разрядной или 64-разрядной версии Windows 7, Windows 8, Windows 10, Windows Server 2008 R2 и Windows Server 2012. Он обеспечит подключение к Azure HDInsight (версии 1.6 и выше) и эмулятору Azure HDInsight (версии 1.0.0.0 и выше). Необходимо установить версию, которая соответствует версии приложения, где будет использоваться драйвер ODBC. В этом учебнике драйвер будет использоваться в Office Excel.

##Создание источника данных Hive ODBC

Ниже показано, как создать источник данных Hive ODBC.

1. В Windows 8 или Windows 10 нажмите клавишу Windows, чтобы открыть начальный экран, затем введите **источники данных**.
2. Нажмите кнопку **Настройка источников данных ODBC (32-разр.)** или **Настройка источников данных ODBC (64-разр.)** в зависимости от версии Office. Если вы используете Windows 7, выберите **Источники данных ODBC (32-разр.)** или **Источники данных ODBC (64-разр.)** в разделе **Администрирование**. Это приведет к запуску диалогового окна **Администратор источника данных ODBC**.

	![Администратор источника данных ODBC][img-hdi-simbahiveodbc-datasource-admin]

3. Из DNS пользователя щелкните **Добавить**, чтобы открыть мастер **Создать новый источник данных**.
4. Выберите **Драйвер Microsoft Hive ODBC** и щелкните **Готово**. Это приведет к открытию диалогового окна **Настройка DNS драйвера Microsoft Hive ODBC**.

5. Введите или выберите следующие значения:

    Свойство|Description (Описание)
    ---|---
    Имя источника данных|Присвойте имя источнику данных
    Узел|Введите &lt;имя\_кластера\_HDInsight>.azurehdinsight.net. Например, myHDICluster.azurehdinsight.net
    Порт|Используйте <strong>443</strong>. (Этот порт был изменен с 563 на 443.)
    База данных|Используйте <strong>значение по умолчанию</strong>.
    Тип сервера Hive|Выберите <strong>Hive Server 2</strong>.
    Механизм|Выберите <strong>Служба Azure HDInsight</strong>.
    Путь HTTP|Оставьте пустым.
    Имя пользователя|Введите имя пользователя кластера HDInsight. Это имя пользователя, созданное во время подготовки кластера. При использовании параметра «Быстрое создание» именем пользователя по умолчанию является <strong>admin</strong>.
    Пароль|Введите пароль пользователя кластера HDInsight.
    </table>

    Существует несколько важных параметров, о которых следует помнить при выборе пункта **Расширенные параметры**.

    Параметр|Описание
    ---|---
    Использовать исходный запрос|При выборе этого параметра драйвер ODBC НЕ будет пытаться преобразовать TSQL в HiveQL. Следует использовать только при 100% уверенности в отправке действительных инструкций HiveQL. При подключении к серверу SQL Server или базе данных Azure SQL необходимо снять этот флажок.
    Строки, загружаемые для каждого блока|При получении большого объема записей включение этого параметра может обеспечить оптимальную производительность.
    Длина столбца строки по умолчанию, длина столбца двоичного кода, масштаб столбца десятичных значений|Длина и точность типа данных может повлиять на способ выведения данных. Это приведет к возврату недопустимой информации вследствие потери точности и (или) усечения.


	![Дополнительные параметры][img-HiveOdbc-DataSource-AdvancedOptions]

6. Нажмите **Тест** для проверки источника данных. При правильной настройке источника данных здесь отображается *ТЕСТЫ УСПЕШНО ЗАВЕРШЕНЫ!*
7. Нажмите **OK**, чтобы закрыть диалоговое окно Тест. Новый источник данных не должен быть указан в **администраторе источника данных ODBC**.
8. Нажмите **OK**, чтобы завершить работу мастера.

##Импорт данных в Excel из службы HDInsight

Ниже описан способ импорта данных из таблицы hive в рабочую книгу Excel с помощью источника данных ODBC, созданного ранее.

1. Откройте новую или существующую рабочую книгу в Excel.
2. На вкладке **Данные** щелкните **Из других источников данных**, а затем выберите **Из мастера подключения к данным**, чтобы запустить **мастер подключения к данным**.

	![Мастер подключения к данным][img-hdi-simbahiveodbc.excel.dataconnection]

3. Выберите **ODBC DSN** в качестве источника данных и затем щелкните **Далее**.
4. В источниках данных ODBC выберите имя источника данных, которое было создано на предыдущем шаге, затем нажмите **Далее**.
5. Повторно введите в мастере пароль для кластера, затем щелкните **Тест** для проверки конфигурации, если требуется.
6. Нажмите **OK**, чтобы закрыть диалоговое окно Тест.
7. Нажмите кнопку **ОК**. Подождите открытие диалогового окна **Выбор базы данных и таблицы**. Это может занять несколько секунд.
8. Выберите таблицу, которую следует импортировать, и нажмите кнопку **Далее**. *hivesampletable* является примером таблицы hive, которая содержится в кластерах HDInsight. Можно выбрать ее, если такая таблица еще не была создана. Дополнительные сведения о выполнении запросов Hive и создании таблиц Hive см. в разделе [Использование Hive вместе с HDInsight][hdinsight-use-hive].
8. Нажмите кнопку **Готово**
9. В диалоговом окне **Импорт данных** можно изменить или указать запрос. Для этого щелкните **Свойства**. Это может занять несколько секунд.
10. Щелкните вкладку **Определение**, затем добавьте **LIMIT 200** к инструкции Hive select в текстовом поле **Текст команды**. Это изменение приведет к ограничению возвращаемого набора записей 200 шт.

	![Свойства подключения][img-hdi-simbahiveodbc-excel-connectionproperties]

11. Нажмите **OK**, чтобы закрыть диалоговое окно "Свойства подключения".
12. Нажмите кнопку **OK**, чтобы закрыть диалоговое окно **Импорт данных**.
13. Повторно введите пароль, затем нажмите кнопку **OK**. Пройдет несколько секунд, прежде чем данные будут импортированы в Excel.

##Дальнейшие действия

В этой статье было рассмотрено, как использовать драйвер Microsoft Hive ODBC для получения данных из службы HDInsight в Excel. Аналогичным образом можно получать данные из службы HDInsight в базу данных SQL. Можно также передавать данные в службу HDInsight. Дополнительные сведения см. на следующих ресурсах:

- [Анализ данных о задержке рейсов с помощью HDInsight][hdinsight-analyze-flight-data]
- [Отправка данных в HDInsight][hdinsight-upload-data]
- [Использование Sqoop с HDInsight][hdinsight-use-sqoop]


[hdinsight-use-sqoop]: hdinsight-use-sqoop.md
[hdinsight-analyze-flight-data]: hdinsight-analyze-flight-delay-data.md
[hdinsight-use-hive]: hdinsight-use-hive.md
[hdinsight-upload-data]: hdinsight-upload-data.md
[hdinsight-power-query]: hdinsight-connect-excel-power-query.md
[hdinsight-get-started]: hdinsight-hadoop-tutorial-get-started-windows.md

[hive-odbc-driver-download]: http://go.microsoft.com/fwlink/?LinkID=286698

[img-hdi-simbahiveodbc-datasource-admin]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveOdbc.DataSourceAdmin1.png
[img-HiveOdbc-DataSource-AdvancedOptions]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.HiveOdbc.DataSource.AdvancedOptions1.png
[img-hdi-simbahiveodbc-excel-connectionproperties]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveODBC.Excel.ConnectionProperties1.png
[img-hdi-simbahiveodbc.excel.dataconnection]: ./media/hdinsight-connect-excel-hive-ODBC-driver/HDI.SimbaHiveOdbc.Excel.DataConnection1.png

<!---HONumber=AcomDC_0817_2016-->