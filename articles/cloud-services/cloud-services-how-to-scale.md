<properties
	pageTitle="Автомасштабирование облачной службы на портале | Microsoft Azure"
	description="Узнайте, как с помощью портала настроить правила автомасштабирования для веб-роли или рабочей роли облачной службы в Azure."
	services="cloud-services"
	documentationCenter=""
	authors="Thraka"
	manager="timlt"
	editor=""/>

<tags
	ms.service="cloud-services"
	ms.workload="tbd"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="04/06/2016"
	ms.author="adegeo"/>


# Автомасштабирование облачной службы

На странице "Масштабирование" классического портала Azure можно масштабировать веб-роль или рабочую роль вручную, а также включить автоматическое масштабирование в зависимости от нагрузки на ЦП или очереди сообщений.

>[AZURE.NOTE] Эта статья посвящена веб-ролям и рабочим ролям облачной службы. Виртуальные машины, создаваемые напрямую, размещаются в облачной службе. Некоторые из представленных здесь сведений относятся к таким типам виртуальных машин. Масштабирование группы доступности виртуальных машин представляет собой включение и отключение этих машин в соответствии с заданными правилами. Дополнительную информацию о виртуальных машинах и группах доступности см. в разделе [Управление доступностью виртуальных машин](../virtual-machines/virtual-machines-windows-classic-configure-availability.md).

При настройке масштабирования приложения следует учитывать следующие сведения.

- Масштабирование зависит от использования ядер. Более крупные экземпляры ролей задействуют больше ядер. Масштабировать приложение можно только в пределах количества ядер по используемой подписке. Например, если подписка ограничена двадцатью ядрами и выполняется приложение с двумя средними по размерам облачными службами \(всего четыре ядра\), можно увеличить масштаб других развернутых в рамках подписки облачных служб на шестнадцать ядер. Дополнительные сведения о размерах см. в статье [Размеры для облачных служб](cloud-services-sizes-specs.md).

- Прежде чем приступить к масштабированию приложения на основе порогового значения сообщений, необходимо создать очередь и связать ее с ролью. Дополнительную информацию см. в разделе [How to use the Queue Storage Service](../storage/storage-dotnet-how-to-use-queues.md) \(Как использовать службу хранения очередей\).

- Можно масштабировать ресурсы, привязанные к используемой облачной службе. Дополнительные сведения о связанных ресурсах см. в разделе [Практическое руководство. Связывание ресурса с облачной службой](cloud-services-how-to-manage.md#how-to-link-a-resource-to-a-cloud-service).

- В целях обеспечения высокой доступности приложения необходимо убедиться, что приложение развернуто с двумя и более экземплярами ролей. Дополнительные сведения см. в разделе [Соглашения об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/).



## Планирование масштабирования

По умолчанию все роли следуют установленному расписанию. Это значит, что изменения в параметрах действуют все время в течение года. При желании вы можете настроить ручное или автоматическое масштабирование для следующих параметров:

- дни недели;
- выходные дни;
- ночное время будних дней;
- утреннее время будних дней;
- определенные даты;
- определенные диапазоны дат.

Эти параметры настраиваются на [классическом портале Azure](https://manage.windowsazure.com/), страница **Облачные службы** \> **\[Ваша облачная служба\]** \> **Масштабирование** \> **\[Рабочая или Промежуточная среда\]**.

Нажмите кнопку **Настройка расписания** для каждой роли, которую необходимо изменить.

![Автомасштабирование облачной службы по расписанию][scale_schedules]



## Ручное масштабирование

На странице **Масштабирование** можно вручную увеличить или уменьшить количество работающих в облачной службе экземпляров. Эти параметры настраиваются для каждого создаваемого расписания, а если расписания нет, действуют постоянно.

1. На [классическом портале Azure](https://manage.windowsazure.com/) щелкните **Облачные службы**, затем щелкните имя облачной службы, чтобы открыть панель мониторинга.

    > [AZURE.TIP] Если вы не видите облачную службу, измените **рабочую среду** на **промежуточную** или наоборот.

2. Щелкните пункт **Масштаб**.

3. Выберите расписание, для которого нужно изменить параметры масштабирования. Если расписание не определено, используется значение по умолчанию *Не задано время по расписанию*.

4. Найдите раздел **Масштабирование по метрике** и выберите параметр **НЕТ**. Это — значение по умолчанию для всех ролей.

5. Каждая роль в облачной службе имеет ползунок для изменения количества используемых экземпляров.

    ![Ручное масштабирование роли облачной службы][manual_scale]

    Если вам нужно несколько экземпляров, измените [размер виртуальной машины облачной службы](cloud-services-sizes-specs.md).

6. Щелкните **Сохранить**. Экземпляры роли добавляются и удаляются в зависимости от пользовательского выбора.

>[AZURE.TIP] Увидев значок ![][tip_icon], наведите на него указатель мыши, и вы получите справку о том, что именно делает соответствующий параметр.


## Автоматическое масштабирование: ЦП

Действует, если средний процент использования ЦП превышает определенные пороговые значения или опускается ниже этих значений; выполняется создание или удаление экземпляров роли.

1. На [классическом портале Azure](https://manage.windowsazure.com/) щелкните **Облачные службы**, затем щелкните имя облачной службы, чтобы открыть панель мониторинга.

    > [AZURE.TIP] Если вы не видите облачную службу, измените **рабочую среду** на **промежуточную** или наоборот.

2. Щелкните пункт **Масштаб**.

3. Выберите расписание, для которого нужно изменить параметры масштабирования. Если расписание не определено, используется значение по умолчанию *Не задано время по расписанию*.

4. Найдите раздел **Масштабирование по метрике** и выберите параметр **ЦП**.

5. Теперь можно настраивать минимальный и максимальный диапазон экземпляров ролей, целевой процент использования ЦП \(для увеличения масштаба в случае необходимости\) и число экземпляров, на которое следует увеличивать или уменьшать масштаб.

![Масштабирование роли облачной службы в зависимости от нагрузки на ЦП][cpu_scale]

>[AZURE.TIP] Увидев значок ![][tip_icon], наведите на него указатель мыши, и вы получите справку о том, что именно делает соответствующий параметр.





## Автоматическое масштабирование: очередь

Автомасштабирование выполняется, если число сообщений в очереди поднимается выше или опускается ниже указанного предела; выполняется создание или удаление экземпляров роли.

1. На [классическом портале Azure](https://manage.windowsazure.com/) щелкните **Облачные службы**, затем щелкните имя облачной службы, чтобы открыть панель мониторинга.

    > [AZURE.TIP] Если вы не видите облачную службу, измените **рабочую среду** на **промежуточную** или наоборот.

2. Щелкните пункт **Масштаб**.

3. Найдите раздел **Масштабирование по метрике** и выберите параметр **ЦП**.

4. Теперь можно настраивать минимальный и максимальный диапазон экземпляров ролей, очередь и число сообщений в очереди на обработку для каждого экземпляра, а также число экземпляров, на которое следует увеличивать или уменьшать масштаб.

![Масштабирование роли облачной службы в зависимости от очереди сообщений][queue_scale]

>[AZURE.TIP] Увидев значок ![][tip_icon], наведите на него указатель мыши, и вы получите справку о том, что именно делает соответствующий параметр.


## Масштабирование связанных ресурсов

Часто при масштабировании роли выгодно масштабировать также и базу данных, используемую приложением. Связав базу данных с облачной службой, вы сможете получить доступ к параметрам масштабирования для соответствующего ресурса, щелкнув соответствующую ссылку.

1. На [классическом портале Azure](https://manage.windowsazure.com/) щелкните **Облачные службы**, затем щелкните имя облачной службы, чтобы открыть панель мониторинга.

    > [AZURE.TIP] Если вы не видите облачную службу, измените **рабочую среду** на **промежуточную** или наоборот.

2. Щелкните пункт **Масштаб**.

3. Найдите раздел **Связанные ресурсы** и щелкните **Управление масштабированием для этой базы данных**.

    > [AZURE.NOTE] Если вы не видите раздел **Связанные ресурсы**, возможно, что таких ресурсов у вас нет.

![][linked_resource]


[manual_scale]: ./media/cloud-services-how-to-scale/manual-scale.png
[queue_scale]: ./media/cloud-services-how-to-scale/queue-scale.png
[cpu_scale]: ./media/cloud-services-how-to-scale/cpu-scale.png
[tip_icon]: ./media/cloud-services-how-to-scale/tip.png
[scale_schedules]: ./media/cloud-services-how-to-scale/schedules.png
[scale_popup]: ./media/cloud-services-how-to-scale/schedules-dialog.png
[linked_resource]: ./media/cloud-services-how-to-scale/linked-resources.png

<!---HONumber=AcomDC_0413_2016-->