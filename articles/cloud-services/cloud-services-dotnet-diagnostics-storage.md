<properties
  pageTitle="Хранение и просмотр диагностических данных в службе хранилища Azure | Microsoft Azure"
  description="Получение и просмотр диагностических данных Azure в хранилище Azure"
  services="cloud-services"
  documentationCenter=".net"
  authors="rboucher"
  manager="jwhit"
  editor="tysonn" />
<tags
  ms.service="cloud-services"
  ms.devlang="na"
  ms.topic="article"
  ms.tgt_pltfrm="na"
  ms.workload="na"
  ms.date="10/21/2015"
  ms.author="robb" />

# Хранение и просмотр диагностических данных в хранилище Azure

Диагностические данные не хранятся долго. Для длительного хранения их необходимо переместить в эмулятор хранения Microsoft Azure или в хранилище Azure. Поместив данные в хранилище, вы можете просматривать их с помощью одного из нескольких доступных средств.

## Определение учетной записи хранения

Укажите учетную запись хранения, которая будет использоваться, в файле ServiceConfiguration.cscfg. Сведения об учетной записи определяются в виде строки подключения в параметре конфигурации. В следующем примере приведена строка подключения по умолчанию, созданная для нового проекта облачной службы в Visual Studio.


```
	<ConfigurationSettings>
	   <Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" value="UseDevelopmentStorage=true" />
	</ConfigurationSettings>
```

Эту строку подключения можно изменить, чтобы указать сведения об учетной записи для учетной записи хранения Azure.

В зависимости от типа собираемых диагностических данных система диагностики Azure использует службу BLOB-объектов или службу таблиц. В следующей таблице приведены сохраняемые источники данных и их формат.

|Источник данных|Формат хранения|
|---|---|
|Журналы Azure|Таблица|
|Журналы IIS 7.0|BLOB-объект|
|Журналы инфраструктуры системы диагностики Azure|Таблица|
|Журналы трассировки невыполненных запросов|BLOB-объект|
|Журналы событий Windows|Таблица|
|Счетчики производительности|Таблица|
|Аварийные дампы|BLOB-объект|
|Пользовательские журналы ошибок|BLOB-объект|

## Передача диагностических данных

При использовании пакета SDK 2.5 и более поздних версий запрос на передачу диагностических данных можно создавать с помощью файла конфигурации. Диагностические данные могут передаваться через запланированные промежутки времени, заданные в конфигурации.

При использовании пакета SDK 2.4 и предыдущих версий запрос на передачу диагностических данных можно выполнить с помощью файла конфигурации или программным образом. Программный подход позволяет передавать данные по требованию.


>[AZURE.IMPORTANT]При передаче диагностических данных в учетную запись хранения Azure с вас взимается плата за используемые этими данными ресурсы хранилища.

## Хранение диагностических данных

Данные журнала хранятся в хранилище BLOB-объектов или в табличном хранилище со следующими именами.

**Таблицы**

- **WadLogsTable**: включенные в код журналы с данными прослушивателя трассировки.

- **WADDiagnosticInfrastructureLogsTable**: сведения об изменениях конфигурации и монитора диагностики.

- **WADDirectoriesTable**: сведения о каталогах, которые отслеживает монитор диагностики. Сюда входят журналы IIS, журналы неудачно завершенных запросов IIS и пользовательские папки. Расположение файла журнала BLOB-объекта указано в поле Container, а имя большого двоичного объекта — в поле RelativePath. В поле AbsolutePath указано расположение и имя файла на виртуальной машине Azure.

- **WADPerformanceCountersTable**: данные счетчиков производительности.

- **WADWindowsEventLogsTable**: журналы событий Windows.

**BLOB-объекты**

- **wad-control-container**: содержит XML-файлы конфигурации, управляющие диагностикой Azure (только для пакета SDK 2.4 и предыдущих версий).

- **wad-iis-failedreqlogfiles**: содержит сведения журналов неудачно завершенных запросов IIS.

- **wad-iis-logfiles**: содержит сведения о журналах IIS.

- **custom**: пользовательский контейнер на основе каталогов конфигурации, которые отслеживаются монитором диагностики. Имя этого контейнера BLOB-объектов указывается в элементе WADDirectoriesTable.

## Средства для просмотра диагностических данных
Данные после их передачи в хранилище можно просмотреть с помощью нескольких средств. Например:

- **Обозреватель сервера в Visual Studio**. Если установлены средства Azure для Microsoft Visual Studio, можно использовать узел хранилища Azure в обозревателе сервера для просмотра BLOB-объектов, доступных только для чтения, и табличных данных из учетных записей хранения Azure. Вы можете отображать данные из своей локальной учетной записи эмулятора хранения, а также из учетных записей хранения, созданных для Azure. Дополнительные сведения см. в статье [Обзор ресурсов хранилища с помощью обозревателя сервера](https://msdn.microsoft.com/library/ff683677.aspx).

- **Обозреватель хранилищ Azure (Neudesic)**. [Обозреватель хранилищ Azure](http://azurestorageexplorer.codeplex.com/) — это полезное средство с графическим пользовательским интерфейсом для проверки и изменения данных в проектах хранилища Azure, включая журналы приложений Azure. Подробнее о загрузке этого средства см. в статье [Обозреватель хранилищ Azure](http://azurestorageexplorer.codeplex.com/).

- Диспетчер диагностики Azure Manager (Cerebrata). [Диспетчер диагностики Azure](http://www.cerebrata.com/Products/AzureDiagnosticsManager/Default.aspx) — это клиент на основе Windows (WPF) для управления системой диагностики Azure. Это средство позволяет просматривать диагностические данные, собранные приложениями, работающими в Azure. Кроме этого, данные можно загружать и управлять ими. Диспетчер диагностики Azure можно загрузить [здесь](http://www.cerebrata.com/Products/AzureDiagnosticsManager/Default.aspx).

## Дальнейшие действия

[Трассировка потока в приложении облачных служб с помощью системы диагностики Azure](cloud-services-dotnet-diagnostics-trace-flow.md)

<!---HONumber=Nov15_HO2-->