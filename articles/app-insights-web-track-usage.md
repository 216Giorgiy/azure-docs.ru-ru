<properties title="Track usage in web applications with Application Insights" pageTitle="Отслеживание использования в веб-приложениях" description="Ведение журнала действий пользователя." metaKeywords="analytics monitoring application insights" authors="awills" manager="kamrani" />

<tags ms.service="application-insights" ms.workload="tbd" ms.tgt_pltfrm="ibiza" ms.devlang="na" ms.topic="article" ms.date="2014-09-24" ms.author="awills" />
 
# Отслеживание использования в веб-приложениях

Узнайте, как используется ваше веб-приложение. Настройте аналитику использования, и вы узнаете, какие страницы ищут пользователи, сколько пользователей возвращается на ваш веб-сайт и часто ли они посещают его. Добавьте несколько [настраиваемых событий и метрик][track], и вы получите возможность подробно проанализировать наиболее популярные функции и частые ошибки, чтобы оптимально настроить свое приложение для работы пользователей.

Данные телеметрии собираются от клиента и от сервера. Клиентские данные могут быть собраны из всех современных браузеров, а данные сервера могут быть собраны даже в том случае, если вы используете платформу ASP.NET (она не должна выполняться в Azure). 

* [Настройка аналитики использования веб-сайта](#webclient)
* [Аналитика использования](#usage)
* [Настраиваемые счетчики страниц для одностраничных приложений](#spa)
* [Проверка отдельных событий страниц](#inspect)
* [Подробное отслеживание использования с помощью настраиваемых событий и метрик](#custom)
* [Видео](#video)

## <a name="webclient"></a>Настройка аналитики веб-клиента

#### Получение ресурса Application Insights в Azure

**Если вы разрабатываете приложение ASP.NET** и еще не сделали этого, [добавьте Application Insights в свой проект][start]. 

**Если в качестве платформы веб-сайта используется не ASP.NET:**зарегистрируйтесь в [Microsoft Azure](http://azure.com), перейдите на [портал предварительной версии](https://portal.azure.com) и создайте новый ресурс Application Insights.

![](./media/appinsights/appinsights-11newApp.png)

(Вы можете вернуться к этому позже, нажав кнопку "Обзор".)



#### Добавление нашего скрипта на ваши веб-страницы

Получите скрипт для веб-страниц в разделе "Быстрый запуск".

![](./media/appinsights/appinsights-06webcode.png)

Вставьте скрипт непосредственно перед </head>тегом каждой страницы, которую вы хотите отслеживать. Если на вашем веб-сайте есть главная страница, можно разместить скрипт на ней. Например, в проекте ASP.NET MVC скрипт следует разместить на странице View\Shared\_Layout.cshtml

## <a name="usage"></a>Аналитика использования

Запустите веб-сайт, поработайте с ним немного для формирования телеметрии и подождите 1-2 минуты. Можно запустить его на компьютере разработчика с помощью клавиши F5 или развернуть его на сервере.

В колонке общих сведений о приложении вы увидите следующие плитки с аналитикой использования:

![](./media/appinsights/appinsights-47usage.png)

*Данные отсутствуют? В верхней части страницы щелкните **Обновить**.*

* **Sessions per browser (Число сеансов на браузер)**

    *Сеанс* - это период, который начинается, когда пользователь открывает любую страницу веб-сайта, и заканчивается, если пользователь не отправлял веб-запросов в течение 30 минут. 

    Щелкните диаграмму для ее увеличения.

* **Top page views (Наиболее популярные страницы)**

    Показывает общее число просмотров за последние 24 часа.

    Чтобы просмотреть более подробный журнал, щелкните плитку с числом просмотров страницы.

![](./media/appinsights/appinsights-49usage.png)

Чтобы просмотреть более длительную историю за период до семи дней, щелкните временной диапазон.

Чтобы просмотреть другие доступные метрики, щелкните график.

![](./media/appinsights/appinsights-63usermetrics.png)

> [AZURE.NOTE] Для включения *всех* метрик снимите все флажки. Метрики могут отображаться только в определенных сочетаниях. При выборе какой-либо метрики все несовместимые метрики будут отключены.



## <a name="spa"></a> Настраиваемые счетчики страниц для одностраничных приложений

По умолчанию счетчик страницы увеличивается на единицу каждый раз, когда страница загружается в клиентском браузере.  Однако вам может потребоваться подсчитать дополнительные просмотры страницы. Например, если содержимое страницы разбито на вкладки, возможно, вы захотите, чтобы счетчик увеличивался на единицу при каждом переключении между ними. Код JavaScript на странице также может загружать новое содержимое без изменения URL-адреса в браузере. 

Вставьте в соответствующем месте клиентского кода вызов JavaScript наподобие следующего:

    appInsights.trackPageView(myPageName);

Имя страницы может содержать те же символы, что и URL-адрес, но все символы после "#" или "?" игнорируются.


## <a name="inspect"></a> Изучение отдельных событий просмотра страницы

Обычно телеметрия просмотра страниц анализируется службой Application Insights, и вы видите только сводные отчеты со средними значениями для всех пользователей. Однако в целях отладки можно также изучать отдельные события просмотра страниц.

В колонке Diagnostic Search (Поиск данных диагностики) в разделе Filter (Фильтр) установите флажок Page View (Просмотр страниц).

![](./media/appinsights/appinsights-51searchpageviews.png)

Выберите любое событие, чтобы просмотреть подробные сведения.

> [AZURE.NOTE] При использовании [поиска][по журналам диагностики] следует помнить, что будут отображены только совпадения слов целиком: запросы "Информаци" и "нформация" не соответствуют слову "Информация", а запрос "Информаци*" соответствует. Поисковый запрос нельзя начинать с подстановочного знака. Например, по запросу "*нформаци" не будет найдено слово "Информация". 

> [Подробнее о поиске по данным диагностики][diagnostic]

## <a name="custom"></a> Подробное отслеживание с помощью настраиваемых событий и метрик

Хотите узнать, что пользователи делают в вашем приложении? Вставив вызовы в коде клиента и сервера, вы можете отправить свою телеметрию в Application Insights. Например, вы можете выяснить, сколько пользователей создали заказы, но не завершили их, какие ошибки проверки возникают наиболее часто или среднее количество очков, набранных пользователями в игре.

[Подробнее об API отслеживания настраиваемых событий и метрик][track].

## <a name="video"></a>Видео "Отслеживание использования"

> [AZURE.VIDEO tracking-usage-with-application-insights]

## <a name="next"></a>Дальнейшие действия

[Отслеживание использования с помощью пользовательских событий и метрик][track]




[AZURE.INCLUDE [app-insights-learn-more](../includes/app-insights-learn-more.md)]



