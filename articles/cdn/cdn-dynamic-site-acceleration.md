---
title: "Динамическое ускорение сайтов с помощью Azure CDN"
description: "Подробный обзор динамического ускорения сайтов"
services: cdn
documentationcenter: 
author: smcevoy
manager: erikre
editor: 
ms.assetid: 
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/29/2017
ms.author: v-semcev
ms.translationtype: HT
ms.sourcegitcommit: f76de4efe3d4328a37f86f986287092c808ea537
ms.openlocfilehash: e886296fd0a0d49975a36fb86347dec8ad30b176
ms.contentlocale: ru-ru
ms.lasthandoff: 07/11/2017

---
# <a name="dynamic-site-acceleration-via-azure-cdn"></a>Динамическое ускорение сайтов с помощью Azure CDN

В связи со стремительным развитием социальных сетей, электронной коммерции и невероятной персонализацией Интернета все большая часть предоставляемого пользователям содержимого создается в режиме реального времени. Пользователям необходимы быстрые, надежные и настраиваемые решения, которые не зависят от браузера, расположения, устройства или сети. Однако сами же инновации, при всей привлекательности новых возможностей, замедляют загрузку страниц и создают неудобства в работе пользователя. 

Стандартная поддержка CDN позволяет кэшировать файлы ближе к пользователям, что ускоряет доставку статических файлов. Тем не менее, с развитием динамических веб-приложений кэширование содержимого в граничных расположениях невозможно, так как сервер создает содержимое в ответ на действия пользователей. Ускорить доставку такого содержимого сложнее, чем в традиционном пограничном кэшировании. Для этого требуется комплексное решение, которое точно настроит каждый элемент на протяжении всего пути данных — с момента их создания до доставки. Динамическое ускорение сайтов (DSA) в сети доставки содержимого (CDN) Azure значительно улучшает производительность веб-страниц с динамическим содержимым.

Azure CDN от Akamai позволяет выбрать функцию оптимизации DSA в меню **Оптимизировано для** во время создания конечной точки. Эта функция пока недоступна для профилей Verizon, но будет реализована в ближайшем будущем. 

## <a name="configuring-cdn-endpoint-to-accelerate-delivery-of-dynamic-files"></a>Настройка конечной точки CDN для ускорения доставки динамических файлов

Вы можете настроить конечную точку CDN, чтобы оптимизировать доставку динамических файлов через портал Azure, выбрав параметр **Динамическое ускорение сайтов** в свойствах **Оптимизировано для** во время создания конечной точки. Для этого можно также использовать наши интерфейсы REST API или любые клиентские пакеты SDK. 

### <a name="probe-path"></a>Путь пробы
Путь пробы — это функция динамического ускорения сайтов. Для создания необходим допустимый путь. DSA использует небольшой файл *пути пробы*, размещенный на сервере-источнике, чтобы оптимизировать конфигурации сетевой маршрутизации для CDN. Вы можете скачать и передать на свой сайт наш пример файла или использовать в качестве пути пробы существующий ресурс (если он существует) на своем сервере-источнике, который имеет размер около 10 КБ.

> [!Note]
> За использование DSA будет взиматься дополнительная плата. Дополнительные сведения см. на соответствующей странице с расценками.

На следующих снимках экрана показано, как это сделать с помощью портала Azure.
 
![Добавление новой конечной точки CDN](./media/cdn-dynamic-site-acceleration/01_Endpoint_Profile.png) 

*Рис. 1. Добавление новой конечной точки CDN из профиля CDN*
 
![Создание конечной точки CDN с поддержкой DSA](./media/cdn-dynamic-site-acceleration/02_Optimized_DSA.png)  

*Рис. 2. Создание конечной точки CDN с выбранным параметром оптимизации "Динамическое ускорение сайтов"*

После создания конечной точки CDN оптимизация DSA будет применена для всех файлов, соответствующих определенным условиям. В следующем разделе это описано подробно.

## <a name="dsa-optimization-using-azure-cdn-from-akamai"></a>Оптимизация DSA с помощью Azure CDN от Akamai

Динамическое ускорение сайтов в Azure CDN от Akamai ускоряет доставку динамических ресурсов с помощью следующих приемов:

-   оптимизация маршрутов;
-   оптимизация TCP;
-   предварительная выборка объектов.

### <a name="route-optimization"></a>Оптимизация маршрутов

Оптимизации маршрутов важна, так как Интернет — это очень динамичная среда, в которой топология сети постоянно меняется под действием трафика и временных простоев. Протокол пограничного шлюза (BGP) — это Интернет-протокол маршрутизации, но при использовании промежуточных серверов Akamai возможны более быстрые маршруты. 

Оптимизация маршрутов выбирает самый оптимальный путь к серверу-источнику, чтобы сайт был постоянно доступен, а динамическое содержимое доставлялось пользователям по наиболее быстрому и надежному маршруту. Сеть Akamai использует методы сбора данных в режиме реального времени и сравнения различных путей с помощью разных узлов на сервере Akamai. Она также использует маршрут BGP по умолчанию в открытом Интернете для определения самого быстрого маршрута между сервером-источником и пограничным сервером CDN. Это позволяет избегать чрезмерно длинные маршруты и точки перегрузки в Интернете. 
 
В результате полностью динамическое и транзакционное содержимое доставляется пользователям быстрее и надежнее, даже когда оно не кэшируется. 

### <a name="tcp-optimizations"></a>Оптимизация TCP

Протокол TCP — это стандартный протокол из набора Интернет-протоколов, который используется для обмена данными между приложениями и сетью IP.  По умолчанию для установки TCP-подключения необходимо выполнить несколько входящих и исходящих запросов. Также существуют ограничения, которые позволяют избежать перегрузок в сети, снижающих эффективность масштабирования. В Azure CDN от Akamai это решается за счет оптимизации следующих 3 зон: 

 - устранение медленного запуска;
 - использование постоянных подключений;
 - настройка параметров TCP-пакетов.

#### <a name="eliminating-slow-start"></a>Устранение медленного запуска

*Медленный запуск* — это часть протокола TCP, которая предотвращает перегрузки в сети за счет ограничения объема данных, передаваемых по сети. При запуске между отправителем и получателем используются окна небольшого размера, чтобы избежать перегрузок. Постепенно размер увеличивается, пока не достигается максимум или не обнаруживается потеря пакетов.

Azure CDN от Akamai устраняет медленный запуск в 3 этапа:
1.  Распределенная сеть пограничных серверов регулярно сообщает системам мониторинга сети Akamai об использовании, состоянии подключения, пропускной способности и других параметрах этих серверов. 
2.  Всем пограничным серверам на платформе предоставляется общий доступ к консолидированным отчетам. Это позволяет пограничным серверам получать сведения о работоспособности соседних пограничных серверов. 
3.  Теперь пограничные серверы CDN могут сделать выводы о некоторых параметрах передачи. Например, какой размер окна будет оптимальным при взаимодействии с соседними пограничными серверами CDN. Это означает, что начальный размер окна перегрузки можно увеличить, если состояние подключения между пограничными серверами CDN способно передать больше пакетных данных. 

#### <a name="leveraging-persistent-connections"></a>Использование постоянных подключений

При использовании CDN к серверу-источнику напрямую подключается меньше уникальных компьютеров, чем когда к нему напрямую подключаются пользователи. Azure CDN от Akamai также объединяет запросы пользователей в пулы, чтобы реже подключаться к серверу-источнику.

Как упоминалось ранее, при подтверждении TCP-подключений необходимо выполнить несколько входящих и исходящих запросов, чтобы установить новое подключение. Постоянные подключения, также известные как проверяемые на активность подключения HTTP (Keep-Alive), повторно используют существующие TCP-подключения для нескольких HTTP-запросов, чтобы сократить время кругового пути и ускорить доставку. 

#### <a name="tuning-tcp-packet-parameters"></a>Настройка параметров TCP-пакетов
Azure CDN от Akamai также позволяет настроить параметры, которые управляют подключениями между серверами, и сократить дальность круговых путей, используемых для получения встроенного в сайт содержимого. Для этого необходимо выполнить следующие действия:
1.  Увеличить начальное окно перегрузки, чтобы больше пакетов проходило, не ожидая подтверждения.
2.  Уменьшить начальное время ожидания повторной передачи, чтобы обнаруживалась потеря и повторная передача выполнялась быстрее.
3.  Уменьшить минимальное и максимальное время ожидания повторной передачи, чтобы быстрее предположить, что пакеты были потеряны при передаче.

### <a name="object-prefetch"></a>Предварительная выборка объектов
Большинство веб-сайтов состоит из HTML-страницы, которая ссылается на другие ресурсы, такие как изображения и сценарии. Как правило, когда клиент запрашивает веб-страницу, браузер сначала скачивает и анализирует HTML-объект, а затем выполняет дополнительные запросы к связанным ресурсам, необходимым для полной загрузки страницы. 

*Предварительная выборка* — это метод извлечения изображений и сценариев, встроенных в HTML-страницу, когда HTML-код передается в браузер. Извлечение происходит еще до того, как браузер запрашивает эти объекты. 

Если функция **предварительной выборки** включена, когда CDN передает базовую HTML-страницу в браузер клиента, то CDN проанализирует HTML-файл и выполнит дополнительные запросы на получение связанных ресурсов, а также сохранит их в своем кэше. Когда клиент запросит связанные ресурсы, на пограничном сервере CDN уже будут запрашиваемые объекты, и он сможет передать их немедленно, не отправляясь по круговому пути к серверу-источнику. Такая оптимизация полезна как для кэшируемого, так и для некэшируемого содержимого.

## <a name="adaptive-image-compression"></a>Адаптивное сжатие изображений

На некоторых устройствах, особенно мобильных, периодически наблюдается снижение скорости сети. В таких сценариях пользователю выгоднее быстро просмотреть веб-страницу с небольшими изображениями, чем долго дожидаться загрузки изображений в полном разрешении.

Эта функция автоматически отслеживает качество сети и задействует стандартные методы сжатия JPEG, чтобы ускорить доставку, когда скорость сети снижается.

Адаптивное сжатие изображений | Расширения файлов  
--- | ---  
Сжатие JPEG | .jpg, .jpeg, .jpe, .jig, .jgig, .jgi





