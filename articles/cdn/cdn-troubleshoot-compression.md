<properties
	pageTitle="Устранение неполадок со сжатием файлов CDN"
	description="Узнайте, как устранить неполадки со сжатием файлов CDN."
	services="cdn"
	documentationCenter=".NET"
	authors="camsoper"
	manager="erikre"
	editor=""/>

<tags
	ms.service="cdn"
	ms.workload="tbd"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="04/28/2016" 
	ms.author="casoper"/>
    
# Устранение неполадок со сжатием файлов CDN

Эта статья поможет вам устранить неполадки со [сжатием файлов CDN](cdn-improve-performance.md).

Если вам потребуется дополнительная помощь по любому из вопросов, рассматриваемых в статье, вы можете обратиться к экспертам по Azure на [форумах MSDN Azure и Stack Overflow](https://azure.microsoft.com/support/forums/). Кроме того, можно зарегистрировать обращение в службу поддержки Azure. Перейдите на [сайт службы поддержки Azure](https://azure.microsoft.com/support/options/) и щелкните **Поддержка**.

## Симптом

Сжатие для конечной точки включено, но файлы возвращаются без сжатия.

## Причина:

Возможно несколько причин, включая указанные ниже.

- Запрошенное содержимое не подходит для сжатия.
- Сжатие не включено для запрошенного типа файла.
- В запросе HTTP не было заголовка, запрашивающего допустимый тип сжатия.

## Действия по устранению неполадок

> [AZURE.TIP] Как и при развертывании новых конечных точек, требуется некоторое время для распространения изменений конфигурации CDN по сети. В большинстве случаев изменения вступают в силу в течение 90 минут. Если сжатие для конечной точки CDN задается впервые, следует подождать один-два часа, чтобы настройки сжатия гарантированно распространились на серверы POP.

### Проверка запроса

Сначала следует быстро проверить запрос. Чтобы просмотреть выполняемый запрос, можно использовать [средства разработчика](https://developer.microsoft.com/microsoft-edge/platform/documentation/f12-devtools-guide/) в браузере.

- Убедитесь в том, что запрос отправляется по URL-адресу конечной точки (`<endpointname>.azureedge.net`), а не в источник.
- Убедитесь в том, что запрос содержит заголовок **Accept-Encoding**, а значение этого заголовка содержит **gzip**, **deflate** или **bzip2**.

![Заголовки запроса CDN](./media/cdn-troubleshoot-compression/cdn-request-headers.png)

### Проверка параметров сжатия (стандартный профиль CDN)

> [AZURE.NOTE] Это действие применимо только в том случае, если ваш профиль CDN относится к ценовой категории **Стандартный**.

Перейдите к конечной точке на [портале Azure](https://portal.azure.com) и нажмите кнопку **Настроить**.

- Проверьте, включено ли сжатие.
- Убедитесь в том, что тип MIME для сжимаемого содержимого включен в список сжимаемых форматов.

![Параметры сжатия CDN](./media/cdn-troubleshoot-compression/cdn-compression-settings.png)

### Проверка параметров сжатия (профиль CDN уровня "Премиум")

> [AZURE.NOTE] Это действие применимо только в том случае, если ваш профиль CDN относится к ценовой категории **Премиум**.

Перейдите к конечной точке на [портале Azure](https://portal.azure.com) и нажмите кнопку **Управление**. Откроется дополнительный портал. Наведите указатель мыши на вкладку **HTTP Large** (Большая платформа HTTP), а затем наведите указатель мыши на всплывающий элемент **Параметры кэша**. Щелкните **Сжатие**.

- Проверьте, включено ли сжатие.
- Убедитесь в том, что в списке **Типы файлов** содержится разделенный запятыми список типов MIME (без пробелов).
- Убедитесь в том, что тип MIME для сжимаемого содержимого включен в список сжимаемых форматов.

![Параметры сжатия CDN уровня "Премиум"](./media/cdn-troubleshoot-compression/cdn-compression-settings-premium.png)

### Проверка кэширования содержимого

С помощью средств разработчика в браузере проверьте заголовки ответов, чтобы убедиться в том, что файл кэширован в регионе, где он запрашивается.

- Проверьте заголовок ответа **Server**. Он должен иметь формат **Платформа (POP/идентификатор сервера)**, как показано в примере ниже.
- Проверьте заголовок ответа **X-Cache**. Он должен иметь значение **HIT**.  

![Заголовки ответа CDN](./media/cdn-troubleshoot-compression/cdn-response-headers.png)

### Проверка соответствия файла требованиям к размеру

Чтобы сжатие файла было возможным, его размер должен удовлетворять следующим требованиям:

- более 128 байт;
- менее 1 МБ.

<!---HONumber=AcomDC_0504_2016-->