<properties
	pageTitle="CDN — увеличьте производительность путем сжатия файлов"
	description="Вы можете увеличить скорость передачи файлов и увеличить производительность загрузки страницы с помощью сжатия файлов."
	services="cdn"
	documentationCenter=".NET"
	authors="camsoper"
	manager="erikre"
	editor=""/>

<tags
	ms.service="cdn"
	ms.workload="tbd"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/06/2016"
	ms.author="casoper"/>

# Увеличьте производительность путем сжатия файлов

Сжатие файлов — это простой и эффективный способ, который позволяет повысить скорость передачи файлов и увеличить производительность загрузки страницы за счет уменьшения размера файлов перед их отправкой с сервера. Этот позволяет снизить потребление пропускной способности и обеспечивает более высокую скорость работы для пользователей.

Сжатие файлов можно активировать двумя способами.

- Можно включить сжатие на исходном сервере — в таком случае CDN будет обрабатывать сжатые файлы и доставлять их соответствующим клиентам.
- Можно включить сжатие непосредственно на пограничных серверах CDN — в таком случае CDN будет сжимать файлы и доставлять их пользователям, даже если эти файлы не были сжаты на сервере-источнике.

> [AZURE.IMPORTANT] Для распространения изменений конфигурации CDN по сети требуется некоторое время. Для профилей <b>Azure CDN от Akamai</b> распространение обычно завершается в течение одной минуты. Для профилей <b>Azure CDN от Verizon</b> изменения вступают в силу в течение 90 минут. Если сжатие для конечной точки CDN задается впервые, перед устранением неполадок следует подождать 1–2 часа, чтобы настройки сжатия гарантированно распространились на серверы POP.

## Включение сжатия

> [AZURE.NOTE] Уровни CDN «Стандартный» и «Премиум» предоставляют одинаковые возможности сжатия, но разные пользовательские интерфейсы. Подробнее о различиях между уровнями CDN «Стандартный» и «Премиум» см. в разделе [Обзор Azure CDN](cdn-overview.md).

### Уровень Standard

> [AZURE.NOTE] Сведения в этом разделе относятся к профилям **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Стандартный" от Akamai**.

1. В колонке профиля CDN щелкните конечную точку CDN, которой хотите управлять.

	![Конечные точки в колонке профиля CDN](./media/cdn-file-compression/cdn-endpoints.png)

	Откроется колонка конечной точки CDN.

2. Нажмите кнопку **Настроить**.

	![Кнопка управления в колонке профиля CDN](./media/cdn-file-compression/cdn-config-btn.png)

	Откроется колонка настройки CDN.

3. Включите параметр **Сжатие**.

	![Параметры сжатия CDN](./media/cdn-file-compression/cdn-compress-standard.png)

4. Используйте типы по умолчанию либо измените список, удалив или добавив типы файлов.
	
	> [AZURE.TIP] Хотя это и возможно, тем не менее не рекомендуется применять сжатие для сжатых форматов, таких как ZIP, MP3, MP4, JPG и т. д.
	
5. Внеся необходимые изменения, нажмите кнопку **Сохранить**.

### Уровень Premium

> [AZURE.NOTE] Сведения в этом разделе относятся к профилям **Azure CDN уровня "Премиум" от Verizon**.

1. В колонке профиля сети CDN нажмите кнопку **Управление**.

	![Кнопка управления в колонке профиля CDN](./media/cdn-file-compression/cdn-manage-btn.png)

	Откроется портал управления CDN.

2. Наведите указатель мыши на вкладку **HTTP Large** (Большая платформа HTTP), а затем наведите указатель мыши на всплывающий элемент **Параметры кэша**. Щелкните **Сжатие**.

	Отобразятся параметры сжатия.

	![Сжатие файлов](./media/cdn-file-compression/cdn-compress-files.png)

3. Включите сжатие, установив переключатель **Использовать сжатие**. Введите типы MIME для сжатия в виде списка с разделителями-запятыми (без пробелов) в текстовом поле **Типы файлов**.
		
	> [AZURE.TIP] Хотя это и возможно, тем не менее не рекомендуется применять сжатие для сжатых форматов, таких как ZIP, MP3, MP4, JPG и т. д.

4. Внеся необходимые изменения, нажмите кнопку **Обновить**.


## Правила сжатия

В приведенных ниже таблицах описан принцип работы сжатия CDN Azure для всех сценариев.

> [AZURE.IMPORTANT] Для **Azure CDN от Verizon** (уровня "Стандартный" и "Премиум") будут сжаты только подходящие файлы. Сжатие допускается для следующих файлов:
>
> - более 128 байт;
> - менее 1 МБ;
> 
> Для **Azure CDN от Akamai** сжатие допускается для всех файлов.
>
> Во всех продуктах Azure CDN используется файл типа MIME, для которого [в настройках разрешено сжатие](#enabling-compression).
>
> Профили **Azure CDN от Verizon** (уровня "Стандартный" и "Премиум") поддерживают кодировку **GZIP**, **Deflate** или **BZIP2**. Профили **Azure CDN от Akamai** поддерживают только кодировку **GZIP**.
>
> Конечные точки **Azure CDN от Akamai** всегда запрашивают из сервера-источника файлы в кодировке **GZIP** независимо от запроса клиента.

### Сжатие отключено или для файла сжатие недопустимо

|Запрошенный клиентом формат (через заголовок Accept-Encoding)|Кэшированный формат файла|Ответ CDN клиенту|Примечания|
|----------------|-----------|------------|-----|
|сжатые;|сжатые;|сжатые;| |
|сжатые;|Без сжатия|Без сжатия| |	
|сжатые;|Не кэширован|Сжатый или несжатый|Зависит от ответа источника|
|Без сжатия|сжатые;|Без сжатия| |
|Без сжатия|Без сжатия|Без сжатия| |	
|Без сжатия|Не кэширован|Без сжатия| |

### Сжатие включено и для файла допускается сжатие

|Запрошенный клиентом формат (через заголовок Accept-Encoding)|Кэшированный формат файла|Ответ CDN клиенту|Примечания|
|----------------|-----------|------------|-----|
|сжатые;|сжатые;|сжатые;|CDN перекодирует из одного поддерживаемого формата в другой|
|сжатые;|Без сжатия|сжатые;|CDN выполняет сжатие|
|сжатые;|Не кэширован|сжатые;|CDN выполняет сжатие, если источник возвращает несжатый файл. **Azure CDN от Verizon** передаст несжатый файла при первом запросе и затем сожмет файл и поместит его в кэш для последующих запросов. Файлы с заголовком `Cache-Control: no-cache` никогда не сжимаются. 
|Без сжатия|сжатые;|Без сжатия|CDN проводит распаковку|
|Без сжатия|Без сжатия|Без сжатия| |	
|Без сжатия|Не кэширован|Без сжатия| |

## Сжатие CDN для служб мультимедиа

Для конечных точек потоковой передачи служб мультимедиа с CDN сжатие включено по умолчанию для следующих типов содержимого: application/vnd.ms-sstr+xml, application/dash+xml, application/vnd.apple.mpegurl, application/f4m+xml. Вы не может включить или отключить сжатие для упомянутых выше типов с помощью портала Azure.

## См. также
- [Устранение неполадок со сжатием файлов CDN](cdn-troubleshoot-compression.md)

<!---HONumber=AcomDC_0713_2016-->