---
title: Ограничение доступности содержимого Azure CDN по странам | Документация Майкрософт
description: Узнайте, как ограничить доступ к содержимому Azure CDN, используя геофильтрацию.
services: cdn
documentationcenter: ''
author: dksimpson
manager: cfowler
editor: ''
ms.assetid: 12c17cc5-28ee-4b0b-ba22-2266be2e786a
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/11/2018
ms.author: v-deasim
ms.openlocfilehash: 93321c4c8a7f8d79835d702ca07132eed94f6493
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35260758"
---
# <a name="restrict-azure-cdn-content-by-country"></a>Ограничение доступности содержимого Azure CDN по странам

## <a name="overview"></a>Обзор
При запросе содержимого по умолчанию оно возвращается пользователю независимо от того, откуда был сделан запрос. В некоторых случаях может потребоваться ограничить доступ к содержимому по стране. В этой статье объясняется, как настроить функцию *геофильтрации* для разрешения или запрета доступа в зависимости от страны.

> [!IMPORTANT]
> Все продукты Azure CDN обеспечивают аналогичные возможности геофильтрации, но поддерживаемые ими коды стран немного отличаются. Дополнительные сведения см. в статье о [кодах стран Azure CDN](https://msdn.microsoft.com/library/mt761717.aspx).


Советы по настройке этого типа ограничения см. в разделе [Рекомендации](cdn-restrict-access-by-country.md#considerations).  

![фильтрации по стране](./media/cdn-filtering/cdn-country-filtering-akamai.png)

## <a name="step-1-define-the-directory-path"></a>Шаг 1. Определение пути к каталогу
> [!IMPORTANT]
> Профили **Azure CDN уровня "Стандартный" от Майкрософт** не поддерживают геофильтрацию на основе пути.
>


Выберите конечную точку на портале и найдите вкладку "Фильтрация по странам" на панели навигации слева, чтобы найти эту функцию.

При настройке фильтра страны необходимо указать относительный путь к каталогу, доступ к которому будет разрешен или запрещен. Геофильтрацию можно применить ко всем файлам в корневом каталоге с помощью косой черты (/) или к выбранным каталогам, указав к ним пути, например */pictures/*. Эту функцию также можно применить к одному файлу, указав файл и не ставя косую черту в конце, например */pictures/city.png*.

Пример фильтра по каталогу:

    /                                 
    /Photos/
    /Photos/Strasbourg/
      /Photos/Strasbourg/city.png

## <a name="step-2-define-the-action-block-or-allow"></a>Шаг 2. Определение действия: запрет или разрешение
**Запрет** : пользователям из указанных стран будет запрещен доступ к ресурсам, запрашиваемым по указанному рекурсивному пути. Если для этого пути не было настроено другой фильтрации по стране, то доступ для всех остальных пользователей будет разрешен.

**Разрешение** : доступ к ресурсам, запрашиваемым по указанному рекурсивному пути, будет разрешен только пользователям из указанных стран.

## <a name="step-3-define-the-countries"></a>Шаг 3. Определение стран
Выберите страны, доступ из которых для выбранного пути нужно разрешить или запретить. 

Правило запрета доступа /Photos/Strasbourg/ отфильтрует файлы, включая следующие:

    http://<endpoint>.azureedge.net/Photos/Strasbourg/1000.jpg
    http://<endpoint>.azureedge.net/Photos/Strasbourg/Cathedral/1000.jpg


### <a name="country-codes"></a>Коды стран
Функция геофильтрации использует коды стран, чтобы определить, из каких стран запрос к защищаемому каталогу будет разрешаться, а из каких — блокироваться. Все продукты Azure CDN обеспечивают аналогичные возможности геофильтрации, но поддерживаемые ими коды стран немного отличаются. Дополнительные сведения см. в статье о [кодах стран Azure CDN](https://msdn.microsoft.com/library/mt761717.aspx). 

## <a name="considerations"></a>Рекомендации
* Изменения в конфигурации фильтрации для страны не вступают в силу немедленно:
   * Для профилей **Azure CDN категории "Стандартный" от Майкрософт** распространение обычно выполняется в течение 10 минут. 
   * Для профилей **Azure CDN уровня "Стандартный" от Akamai** распространение обычно завершается в течение одной минуты. 
   * Для профилей **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Премиум" от Verizon** распространение обычно выполняется в течение 10 минут. 
 
* Эта функция не поддерживает символы-шаблоны (например, *).

* Настройки геофильтрации, связанные с относительным путем, будут применяться рекурсивно к этому пути.

* Только одно правило может применяться к тому же относительному пути. Поэтому нельзя создать несколько фильтров стран, которые указывают на тот же относительный путь. Однако в папке может быть несколько фильтров стран из-за их рекурсивных особенностей. Другими словами, подкаталогу ранее настроенного каталога можно назначить другой фильтр страны.

