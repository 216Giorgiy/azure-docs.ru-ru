---
title: Краткое руководство по созданию общедоступной подсистемы балансировки нагрузки уровня "Базовый" с помощью портала Azure | Документация Майкрософт
description: В рамках этого краткого руководства вы узнаете, как создать общедоступную подсистему балансировки нагрузки уровня "Базовый" с помощью портала Azure.
services: load-balancer
documentationcenter: na
author: KumudD
manager: jeconnoc
editor: ''
tags: azure-resource-manager
Customer intent: I want to create a Basic Load balancer so that I can load balance internet traffic to VMs.
ms.assetid: aa9d26ca-3d8a-4a99-83b7-c410dd20b9d0
ms.service: load-balancer
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/22/2018
ms.author: kumud
ms.custom: mvc
ms.openlocfilehash: 49fa4cf9b24c432b0956f930a1429e1cdf827f1b
ms.sourcegitcommit: 688a394c4901590bbcf5351f9afdf9e8f0c89505
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/18/2018
ms.locfileid: "34304884"
---
# <a name="quickstart-create-a-public-basic-load-balancer-by-using-the-azure-portal"></a>Краткое руководство по созданию общедоступной подсистемы балансировки нагрузки уровня "Базовый" с помощью портала Azure

Балансировка нагрузки обеспечивает более высокий уровень доступности и масштабирования за счет распределения входящих запросов между несколькими виртуальными машинами. Вы можете использовать портал Azure для создания подсистемы балансировки нагрузки, чтобы распределять нагрузку виртуальных машин. В этом кратком руководстве показано, как создать сетевые ресурсы, внутренние серверы и подсистему балансировки нагрузки уровня "Базовый".

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу. 

## <a name="sign-in-to-the-azure-portal"></a>Выполните вход на портал Azure.

Для выполнения всех задач в этом кратком руководстве войдите на [портал Azure](http://portal.azure.com).

## <a name="create-a-basic-load-balancer"></a>Создание подсистемы балансировки нагрузки уровня "Базовый"

В этом разделе создается общедоступная подсистема балансировки нагрузки уровня "Базовый" с помощью портала. Общедоступный IP-адрес автоматически настраивается в качестве внешнего интерфейса подсистемы балансировки нагрузки при создании общедоступного IP-адреса и ресурса подсистемы балансировки нагрузки с помощью портала. Имя внешнего интерфейса — **LoadBalancerFrontend**.

1. На портале вверху слева последовательно выберите **Создать ресурс** > **Сети** > **Load Balancer**.
2. На панели **Создание подсистемы балансировки нагрузки** введите следующие значения:
   - **myLoadBalancer** — для имени подсистемы балансировки нагрузки.
   - **Public** — для типа подсистемы балансировки нагрузки. 
   - **myPublicIP** — для общедоступного IP-адреса, который необходимо создать с **номером SKU** уровня **Базовый** и значением **Динамический** для параметра **Назначение**.
   - **myResourceGroupLB** — для имени новой группы ресурсов.
3. Нажмите кнопку **Создать**.
   
![Создание балансировщика нагрузки](./media/load-balancer-get-started-internet-portal/1-load-balancer.png)


## <a name="create-back-end-servers"></a>Создание внутренних серверов

В рамках этого раздела вы создадите виртуальную сеть и две виртуальные машины для внутреннего пула подсистемы балансировки нагрузки уровня "Базовый". Затем вы установите Internet Information Services (IIS) на виртуальных машинах для тестирования подсистемы балансировки нагрузки.

### <a name="create-a-virtual-network"></a>Создать виртуальную сеть
1. В верхней левой части портала выберите **Создать** > **Сети** > **Виртуальная сеть**.
2. В области **Создание виртуальной сети** введите приведенные ниже значения и щелкните **Создать**.
   - **myVNet** — для имени виртуальной сети.
   - **myResourceGroupSLB** — для имени имеющейся группы ресурсов.
   - **myBackendSubnet** — для имени подсети.

   ![Создать виртуальную сеть](./media/load-balancer-get-started-internet-portal/2-load-balancer-virtual-network.png)

### <a name="create-virtual-machines"></a>Создание виртуальных машин

1. В верхней левой части портала выберите **Создать** > **Вычисление** > **Windows Server 2016 Datacenter**. 
2. Введите эти значения для виртуальной машины, а затем нажмите кнопку **ОК**:
   - **myVM1** — для имени виртуальной машины.        
   - **azureuser** — для имени пользователя учетной записи администратора.    
   - **myResourceGroupLB** — для группы ресурсов. (В разделе **Группа ресурсов** выберите **Использовать существующий**, а затем щелкните **myResourceGroupLB**.)   
3. Выберите значение **DS1_V2** в качестве размера виртуальной машины и нажмите кнопку **Выбрать**.
4. Введите следующие значения для параметров виртуальной машины.
   - **myAvailabilitySet** — для имени создаваемой группы доступности.
   - **myVnet** — для имени виртуальной сети. (Убедитесь, что выбрано.)
   - **myBackendSubnet** — для имени подсети. (Убедитесь, что выбрано.)
   - **myVM1-ip** — для общедоступного IP-адреса.
   - **myNetworkSecurityGroup** — для имени новой группы безопасности сети (NSG, типа брандмауэра), которую необходимо создать.
5. Выберите **Отключено**, чтобы отключить диагностику загрузки.
6. Нажмите кнопку **ОК**, просмотрите параметры на странице сводки и щелкните **Создать**.
7. Используя шаги с 1 по 6, создайте вторую виртуальную машину с именем **VM2**, указав:
   - **myAvailabilityset** в качестве группы доступности.
   - **myVnet** в качестве виртуальной сети.
   - **myBackendSubnet** в качестве подсети.
   - **myNetworkSecurityGroup** в качестве группы безопасности сети. 

### <a name="create-nsg-rules"></a>Создание правил NSG

В этом разделе вы создаете правила группы безопасности сети (NSG), чтобы разрешить входящие подключения по протоколу HTTP и протоколу удаленного рабочего стола (RDP).

1. Выберите **Все ресурсы** в меню слева. В списке ресурсов выберите **myNetworkSecurityGroup** в группе ресурсов **myResourceGroupLB**.
2. В разделе **Параметры** выберите **Правила безопасности для входящего трафика**, а затем щелкните **Добавить**.
3. Введите следующие значения для правила безопасности для входящего трафика с именем **myHTTPRule**, чтобы разрешить входящие подключения HTTP через порт 80. Нажмите кнопку **ОК**.
   - **Service Tag** — для **источника**.
   - **Internet** — для **тега службы источника**.
   - **80** — для **диапазонов портов назначения**.
   - **TCP** — для **протокола**.
   - **Разрешить** — для **действия**.
   - **100** — для значения **приоритета**;
   - **myHTTPRule** — для **имени**;
   - **Разрешить HTTP** — для **описания**.
 
   ![Создание правила NSG](./media/load-balancer-get-started-internet-portal/8-load-balancer-nsg-rules.png)
4. Еще раз выполните шаги 2 и 3, чтобы создать другое правило с именем **myRDPRule**, разрешающее входящее подключение по RDP через порт 3389. Используйте следующие значения:
   - **Service Tag** — для **источника**.
   - **Internet** — для **тега службы источника**.
   - **3389** — для **диапазонов портов назначения**.
   - **TCP** — для **протокола**.
   - **Разрешить** — для **действия**.
   - **200** — для значения **приоритета**;
   - **myRDPRule** — для **имени**.
   - **Разрешить RDP** — для **описания**.

   

### <a name="install-iis"></a>Установка служб IIS

1. Выберите **Все ресурсы** в меню слева. В списке ресурсов выберите **myVM1** в группе ресурсов **myResourceGroupLB**.
2. На странице **обзора** щелкните **Подключить**, чтобы подключиться по протоколу RDP к виртуальной машине.
3. Войдите в виртуальную машину, используя имя пользователя **azureuser** и пароль **Azure123456!**
4. На рабочем столе сервера перейдите к **Средства администрирования Windows** > **Диспетчер сервера**.
5. В диспетчере сервера выберите **Управление**, а затем — **Добавить роли и компоненты**.
   ![Добавление роли диспетчера сервера](./media/load-balancer-get-started-internet-portal/servermanager.png)
6. В мастере добавления ролей и компонентов введите следующие значения:
   - На странице **Выбор типа установки** выберите **Установка ролей или компонентов**.
   - На странице **Выбор целевого сервера** выберите **myVM1**.
   - На странице **Выберите роль сервера** щелкните **Веб-сервер (IIS)**.
   - Следуйте инструкциям, чтобы выполнить оставшиеся шаги мастера. 
7. Выполните шаги 1–6 для виртуальной машины **myVM2**.

## <a name="create-resources-for-the-basic-load-balancer"></a>Создание ресурсов подсистемы балансировки нагрузки уровня "Базовый"

В этом разделе вы настраиваете параметры подсистемы балансировки нагрузки для внутреннего пула адресов и зонда работоспособности. Можно также указать правила подсистемы балансировки нагрузки и NAT.


### <a name="create-a-back-end-address-pool"></a>Создание серверного пула адресов

Для распределения трафика между виртуальными машинами внутренний пул адресов содержит IP-адреса виртуальных сетевых карт, подключенных к системе балансировки нагрузки. Создайте внутренний пул адресов **myBackendPool**, куда будут входить виртуальные машины **VM1** и **VM2**.

1. Щелкните **Все ресурсы** в меню слева, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Серверные пулы**, а затем щелкните **Добавить**.
3. На странице **Add a backend pool** (Добавление серверного пула) сделайте следующее и нажмите кнопку **ОК**:
   - В поле **Имя** введите **myBackEndPool**.
   - Для **Сопоставлено с** в раскрывающемся меню щелкните **Группа доступности**.
   - Для параметра **Группа доступности** выберите значение **myAvailabilitySet**.
   - Щелкните **Add a target network IP configuration** (Добавить целевую IP-конфигурацию сети), чтобы добавить все созданные для серверного пула виртуальные машины (**myVM1** и **myVM2**).

   ![Добавление в серверный пул адресов](./media/load-balancer-get-started-internet-portal/3-load-balancer-backend-02.png)

3. Убедитесь, что в настройках серверного пула подсистемы балансировки нагрузки отображаются обе виртуальные машины (**VM1** и **VM2**).

### <a name="create-a-health-probe"></a>Создание пробы работоспособности

Чтобы подсистема балансировки нагрузки уровня "Базовый" могла следить за состоянием приложения, необходимо настроить зонд работоспособности. Проба работоспособности динамически добавляет или удаляет виртуальные машины из балансировщика нагрузки на основе их ответа на проверки работоспособности. Создайте зонд работоспособности с именем **myHealthProbe**, чтобы отслеживать работоспособность виртуальных машин.

1. Щелкните **Все ресурсы** в меню слева, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Зонды работоспособности**, а затем щелкните **Добавить**.
3. Используйте следующие значения, а затем нажмите кнопку **ОК**:
   - **myHealthProbe** — для имени зонда работоспособности.
   - **HTTP** — для типа протокола.
   - **80** — для номера порта.
   - **15** — для поля **Интервал** (количество попыток выполнения зонда (в секундах)).
   - **2** — для поля **Порог состояния неработоспособности** (количество последовательных сбоев зонда, которые должны произойти, прежде чем виртуальная машина будет считаться неработоспособной).

   ![Добавление пробы](./media/load-balancer-get-started-internet-portal/4-load-balancer-probes.png)

### <a name="create-a-load-balancer-rule"></a>Создание правила балансировщика нагрузки

Правило подсистемы балансировки нагрузки используется для определения распределения трафика между виртуальными машинами. Вы определяете конфигурацию внешнего IP-адреса для входящего трафика и пул внутренних IP-адресов для приема трафика, а также требуемый порт источника и назначения. 

Создайте правило подсистемы балансировки нагрузки с именем **myLoadBalancerRuleWeb** для прослушивания порта 80 во внешнем интерфейсе **LoadBalancerFrontEnd**. Это правило также предназначено для отправки трафика с балансировкой нагрузки во внутренний пул адресов **myBackEndPool** с использованием порта 80. 

1. Щелкните **Все ресурсы** в меню слева, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Правила балансировки нагрузки**, а затем щелкните **Добавить**.
3. Используйте следующие значения, а затем нажмите кнопку **ОК**:
   - **myHTTPRule** — для имени правила подсистемы балансировки нагрузки.
   - **TCP** — для типа протокола.
   - **80** — для номера порта.
   - **80** — для внутреннего порта.
   - **myBackendPool** — для имени внутреннего пула.
   - **myHealthProbe** — для имени зонда работоспособности.
    
   ![Добавление правила подсистемы балансировки нагрузки](./media/load-balancer-get-started-internet-portal/5-load-balancing-rules.png)

## <a name="test-the-load-balancer"></a>Тестирование подсистемы балансировки нагрузки
1. Найдите общедоступный IP-адрес для подсистемы балансировки нагрузки на экране **обзора**. Выберите **Все ресурсы**, а затем щелкните **myPublicIP**.

2. Скопируйте общедоступный IP-адрес и вставьте его в адресную строку браузера. В браузере отобразится страница по умолчанию веб-сервера IIS.

   ![Веб-сервер IIS](./media/load-balancer-get-started-internet-portal/9-load-balancer-test.png)

## <a name="clean-up-resources"></a>Очистка ресурсов

Ставшие ненужными группу ресурсов, подсистему балансировки нагрузки и все связанные ресурсы можно удалить. Выберите группу ресурсов, содержащую подсистему балансировки нагрузки, и щелкните **Удалить**.

## <a name="next-steps"></a>Дополнительная информация

В этом кратком руководстве вы создали группу ресурсов, сетевые ресурсы и внутренние серверы. Затем с помощью этих ресурсов вы создали подсистему балансировки нагрузки категории "Базовый". Чтобы узнать больше об Azure Load Balancer, ознакомьтесь с другими руководствами по этой службе.

> [!div class="nextstepaction"]
> [Руководства по Azure Load Balancer](tutorial-load-balancer-basic-internal-portal.md)
