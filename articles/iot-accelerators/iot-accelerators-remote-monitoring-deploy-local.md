---
title: Локальное развертывание решения для удаленного мониторинга в Azure | Документация Майкрософт
description: В этом руководстве показано, как развернуть акселератор решений для удаленного мониторинга на локальном компьютере в целях тестирования и разработки.
author: asdonald
manager: timlt
ms.author: asdonald
ms.service: iot-accelerators
services: iot-accelerators
ms.date: 09/26/2018
ms.topic: conceptual
ms.openlocfilehash: 7007b1406dbcfab3af4700418ac2ce07b9e521c0
ms.sourcegitcommit: b7e5bbbabc21df9fe93b4c18cc825920a0ab6fab
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2018
ms.locfileid: "47407439"
---
# <a name="deploy-the-remote-monitoring-solution-accelerator-locally"></a>Локальное развертывание акселератора решений для удаленного мониторинга

В этой статье показано, как развернуть акселератор решений для удаленного мониторинга на локальном компьютере в целях тестирования и разработки. С помощью подхода, описанного в этой статье, выполняется развертывание микрослужб в локальном контейнере Docker и используются Центр Интернета вещей, Cosmos DB и службы аналитики временных рядов Azure в облаке. Сведения о том, как запустить акселератор решений для удаленного Мониторинга в IDE на локальном компьютере, см. в статье о [запуске микрослужб в локальной среде](https://github.com/Azure/remote-monitoring-services-java/blob/master/docs/LOCAL_DEPLOYMENT.md) на сайте GitHub.

## <a name="prerequisites"></a>Предварительные требования

Для развертывания служб Azure, используемых акселератором решений для удаленного мониторинга, требуется активная подписка Azure.

Если ее нет, можно создать бесплатную пробную учетную запись всего за несколько минут. Дополнительные сведения см. в разделе [Бесплатная пробная версия Azure](http://azure.microsoft.com/pricing/free-trial/).

Для завершения локального развертывания необходимо установить следующие средства на локальный компьютер разработчика:

* [Git](https://git-scm.com/)
* [Docker](https://www.docker.com)
* [Docker Compose](https://docs.docker.com/compose/install/);
* [Node.js версии 8](https://nodejs.org/). Это программное обеспечение является необходимым компонентом для интерфейса командной строки PCS, который используется в сценариях для создания ресурсов Azure. Не используйте Node.js версии 10.

> [!NOTE]
> Эти средства доступны на многих платформах, включая Windows, Linux и iOS.

### <a name="download-the-source-code"></a>Скачивание исходного кода

Репозиторий исходного кода для удаленного мониторинга GitHub включает в себя файлы конфигурации Docker, необходимые для скачивания, настройки и запуска образов Docker, содержащих микрослужбы. Чтобы клонировать и создать локальную версию репозитория, используйте среду командной строки и перейдите в подходящую папку на локальном компьютере, а затем выполните одну из следующих команд:

Чтобы загрузить последнюю версию реализаций микрослужбы Java, выполните:

```cmd/sh
git clone https://github.com/Azure/remote-monitoring-services-java.git
```

Чтобы загрузить последнюю версию реализаций микрослужбы .NET, выполните:

```cmd\sh
git clone https://github.com/Azure/remote-monitoring-services-dotnet.git
```

> [!NOTE]
> Эти команды загружают исходный код для всех микрослужб в дополнение к сценариям, которые используются для локального запуска микрослужб. Хотя для запуска микрослужб в Docker не требуется исходный код, он полезен на случай, если в дальнейшем планируется изменить акселератор решений и протестировать изменения локально.

## <a name="deploy-the-azure-services"></a>Развертывание служб Azure

Несмотря на то что в этой статье показано, как запускать микрослужбы локально, они зависят от служб Azure, выполняемых в облаке. Эти службы Azure можно [развернуть вручную на портале Azure](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet/wiki/Manual-steps-to-create-azure-resources-for-local-setup) или с помощью предоставленного сценария. В следующих примерах сценария предполагается, что вы используете репозиторий .NET на компьютере Windows. Если вы работаете в другой среде, измените пути, расширения файлов и разделители путей соответствующим образом. Ниже приведены варианты использования предоставленных сценариев.

### <a name="create-new-azure-resources"></a>Создание ресурсов Azure

Если вы еще не создали необходимые ресурсы Azure, выполните следующие действия:

1. В среде командной строки перейдите в папку **remote-monitoring-services-dotnet\scripts\local\launch** в копии репозитория.

2. Запустите сценарий **start.cmd** и следуйте инструкциям на экране. Появится запрос на вход в учетную запись Azure и перезапуск сценария. Во время выполнения сценария будут запрошены следующие сведения:
    * имя решения;
    * Подписка Azure, которую нужно использовать.
    * расположение центра обработки данных Azure, который будет использоваться.

    Сценарий создает в Azure группу ресурсов с именем решения. Эта группа содержит ресурсы Azure, которые использует акселератор решений.

3. Когда выполнение сценария будет завершено, появится список переменных сред. Следуйте инструкциям в выходных данных команды, чтобы сохранить эти переменные в файл **remote-monitoring-services-dotnet\\scripts\\local\\.env**.

### <a name="use-existing-azure-resources"></a>Использование существующих ресурсов Azure

Если вы уже создали необходимые ресурсы Azure, замените определения переменных среды в файле **remote-monitoring-services-dotnet\\scripts\\local\\.env** необходимыми значениями. Файл **ENV** содержит подробную информацию о том, где найти необходимые значения.

## <a name="run-the-microservices-in-docker"></a>Запуск микрослужб в Docker

Микрослужбам, работающим в локальных контейнерах Docker, необходим доступ к службам, запущенным в Azure. Вы можете протестировать подключение среды Docker к Интернету, используя следующую команду, которая запускает небольшой контейнер и пытается выполнить проверку адреса в Интернете:

```cmd/sh
docker run --rm -ti library/alpine ping google.com
```

Чтобы запустить акселератор решений, перейдите в папку **remote-monitoring-services-dotnet\\scripts\\local** в среде командной строки и выполните следующую команду:

```cmd\sh
docker-compose up
```

При первом выполнении этой команды Docker скачивает образы микрослужб из центра Docker для локальной сборки контейнеров. При последующих выполнениях Docker запускает контейнеры немедленно.

С помощью отдельной оболочки можно просмотреть журналы из контейнера. Для этого сначала найдите идентификатор контейнера с помощью команды `docker ps -a`. Затем с помощью `docker logs {container-id} --tail 1000` просмотрите последние 1000 записей журнала для указанного контейнера.

Для доступа к панели мониторинга решения для удаленного мониторинга перейдите по адресу [http://localhost:8080](http://localhost:8080) в браузере.

## <a name="clean-up"></a>Очистка

Чтобы избежать ненужных расходов, после завершения тестирования удалите облачные службы из подписки Azure. Самый простой способ удалить службы — перейти на [портал Azure](https://ms.portal.azure.com) и удалить группу ресурсов, созданную при запуске сценария **start.cmd**.

Воспользуйтесь командой `docker-compose down --rmi all`, чтобы удалить образы Docker и освободить место на локальном компьютере. Также можно удалить локальную копию репозитория удаленного мониторинга, созданную при клонировании исходного кода из GitHub.

## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

> [!div class="checklist"]
> * настройка локальной среды разработки;
> * настройка акселератора решений;
> * развертывание акселератора решений;
> * вход в акселератор решений.

Теперь, когда вы развернули решение для удаленного мониторинга, [изучите возможности панели мониторинга решения](quickstart-remote-monitoring-deploy.md).

<!-- Next tutorials in the sequence -->
