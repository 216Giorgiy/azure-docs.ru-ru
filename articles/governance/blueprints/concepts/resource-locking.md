---
title: Концепция блокировки ресурсов
description: Узнайте о возможности блокировки для защиты ресурсов при назначении схемы.
services: blueprints
author: DCtheGeek
ms.author: dacoulte
ms.date: 10/25/2018
ms.topic: conceptual
ms.service: blueprints
manager: carmonm
ms.custom: seodec18
ms.openlocfilehash: 0e272f7137967b545269a408b6e83552de532682
ms.sourcegitcommit: eb9dd01614b8e95ebc06139c72fa563b25dc6d13
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2018
ms.locfileid: "53309439"
---
# <a name="understand-resource-locking-in-azure-blueprints"></a>Общие сведения о блокировке ресурсов в Azure Blueprint

Создавать крупные согласованные среды имеет смысл только при наличии механизма, поддерживающего эту согласованность. В этой статье рассказывается, как работает блокировка ресурсов в Azure Blueprint.

## <a name="locking-modes-and-states"></a>Режимы и состояния блокировки

Режим блокировки применяется для назначения схемы и имеет только два варианта: **Нет** или **Все ресурсы**. Режим блокировки настраивается во время назначения схемы. Его нельзя изменить после успешного применения назначения к подписке.

Ресурсы, созданные определениями артефактов в составе назначения схемы, имеют три состояния: **Не заблокировано**, **Только чтение** и **Невозможно изменить/удалить**. Каждый артефакт может находиться в состоянии **Не заблокировано**. Состояние **Только чтение** используется только для артефактов нересурсной группы, а состояние **Невозможно редактировать/удалить** — только для группы ресурсов. Это важное различие в управлении этими ресурсами.

Состояние **Только чтение** в точности соответствует своему определению: ресурс невозможно изменить или удалить каким-либо образом. Режим **Невозможно редактировать/удалить** имеет больше нюансов из-за "контейнерной" природы групп ресурсов. Объект группы ресурсов доступен только для чтения, но вы можете вносить изменения в незаблокированные ресурсы в группе ресурсов.

## <a name="overriding-locking-states"></a>Переопределение состояний блокировки

Обычно сохраняется возможность предоставить права на изменение и (или) удаление любого ресурса владельцу соответствующих прав [управления доступом на основе ролей](../../../role-based-access-control/overview.md) (RBAC) в подписке. Но эта возможность недоступна, если схема применяет блокировку в составе развернутого назначения. Если назначение было задано с параметром **Блокировать**, даже владелец подписки не сможет изменить входящие в ее состав ресурсы.

Эта мера предосторожности защищает согласованность определенной схемы и среды, для создания которой эта схема предназначается, от случайного или программного удаления либо изменения.

## <a name="removing-locking-states"></a>Удаление состояний блокировки

Если необходимо удалить ресурсы, созданные назначением, то сначала придется удалить назначение. После удаления назначения созданные схемами блокировки удаляются. Но при этом сам ресурс сохраняется. Его следует удалить обычными средствами.

## <a name="how-blueprint-locks-work"></a>Как работают блокировки схемы

Роль RBAC`denyAssignments` применяется к ресурсам артефактов во время назначения схемы, если назначение выбрало параметр **Блокировка**. Роль добавляется управляемым удостоверением назначения схемы и может быть удалена из ресурсов артефактов только тем же управляемым удостоверением. Эта мера предосторожности обеспечивает механизм блокировки и предотвращает попытки удалить блокировку схемы за пределами схемы. Удаление этой роли и блокировки возможно только путем удаления назначения схемы, а эту операцию могут выполнить только пользователи с соответствующими полномочиями.

> [!IMPORTANT]
> Azure Resource Manager кэширует сведения о назначении роли на срок до 30 минут. Это означает, что операция `denyAssignments` для ресурсов схемы может не сразу вступать в полную силу. В течение этого периода сохраняется возможность удалить ресурс, который должен быть защищен блокировками схемы.

## <a name="next-steps"></a>Дополнительная информация

- Ознакомьтесь с [жизненным циклом схемы](lifecycle.md).
- Узнайте, как использовать [статические и динамические параметры](parameters.md)
- Научитесь настраивать [последовательность схемы](sequencing-order.md)
- Узнайте, как [обновлять существующие назначения](../how-to/update-existing-assignments.md)
- Устраняйте проблемы, возникающие во время назначения схемы, с помощью [общих инструкций по устранению неполадок](../troubleshoot/general.md)