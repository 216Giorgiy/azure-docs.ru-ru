---
title: "Создание оповещений журнала действий | Документация Майкрософт"
description: "Уведомление посредством SMS, webhook и электронной почты при возникновении определенных событий в журнале действий."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: johnkem
ms.translationtype: HT
ms.sourcegitcommit: 8b857b4a629618d84f66da28d46f79c2b74171df
ms.openlocfilehash: c44ecc0ee61c58ab7590e9a21a5fe002068c6b83
ms.contentlocale: ru-ru
ms.lasthandoff: 08/04/2017

---
# <a name="create-activity-log-alerts"></a>Создание оповещений журнала действий

## <a name="overview"></a>Обзор
Оповещения журнала действий создаются в тех случаях, когда происходит новое событие, записываемое в журнал действий, которое соответствует определенным условиям для оповещения. Они являются ресурсами Azure, поэтому они могут быть созданы с помощью шаблона Resource Manager, а также их можно создавать, обновлять и удалять на портале Azure. В этой статье представлены основные понятия, связанные с оповещениями журнала действий, и показано, как использовать портал Azure для настройки оповещения о событиях журнала действий.

Оповещения журнала действий обычно создаются с одной из двух целей:
1. Чтобы получать уведомления при внесении определенных изменений в ресурсы в вашей подписке Azure. Как правило, это конкретные группы ресурсов или ресурсы. Например, можно получать уведомления при удалении любой виртуальной машины в группе ресурсов myProductionResourceGroup. Или может потребоваться получать уведомления при назначение каких-либо новых ролей пользователю в вашей подписке.
2. Чтобы получать уведомление, когда происходит событие работоспособности службы. События работоспособности службы включают в себя уведомления об инцидентах и событиях обслуживания, относящихся к ресурсам в подписке.

В любом случае оповещения журнала активности позволяют отслеживать только для события в подписке, в которой создается оповещение.

Вы можете настроить оповещение журнала действий на основе любого свойства верхнего уровня в объекте JSON для события журнала действий, тем не менее на портале показаны наиболее распространенные параметры.
- **Категория**. Возможные значения: "Административный", "Работоспособность службы", "Автомасштабирование" или "Рекомендация". [Прочитайте эту статью о категориях журнала действий](./monitoring-overview-activity-logs.md#categories-in-the-activity-log) и [узнайте больше о событиях работоспособности службы](./monitoring-activity-log-alerts-on-service-notifications.md).
- **Группа ресурсов**
- **Ресурс**
- **Тип ресурса**
- **Имя операции**. Имя операции RBAC Resource Manager.
- **Уровень**. Уровень серьезности события ("Подробный", "Информационное", "Предупреждение", "Ошибка", "Критическое").
- **Состояние**. Состояние события, обычно "Запущено", "Сбой" или "Успешно".
- **Кем инициировано событие**. Это условие также называется "вызывающей стороной". Адрес электронной почты или идентификатор Active Directory пользователя, выполнившего операцию.

>[!NOTE]
>В оповещении нужно указать по крайней мере два из указанных выше условий, одним из которых должна быть категория. Вы не можете создать оповещение, которое активируется каждый раз при создании события в журнале действий.
>
>

При активации оповещения журнала действий используется группа действий для создания действий или уведомлений. Группа действий — это многократно используемый набор приемников уведомлений (адресов электронной почты, URL-адресов веб-перехватчиков или номеров телефонов для отправки SMS), которые можно указывать в нескольких уведомлениях, чтобы централизовать и группировать каналы уведомлений. В оповещении журнала действий можно использовать существующую группу действий или создать новую при его определении. Дополнительные сведения о группах действий см. [здесь](monitoring-action-groups.md).

Подробнее изучить использование оповещений журнала действий для уведомлений о работоспособности служб можно [здесь](monitoring-activity-log-alerts-on-service-notifications.md).

## <a name="create-an-alert-on-an-activity-log-event-with-a-new-action-group-with-the-azure-portal"></a>Создание оповещения для событий журнала действий с новой группой действий с помощью портала Azure
1.  На [портале](https://portal.azure.com) перейдите в колонку **Монитор**.

    ![Монитор](./media/monitoring-activity-log-alerts/home-monitor.png)
2.  Щелкните **Мониторинг**, чтобы открыть колонку "Мониторинг". Сначала откроется колонка **Журнал действий**.

3.  Теперь щелкните колонку **Оповещения**.

    ![Оповещения](./media/monitoring-activity-log-alerts/alerts-blades.png)
4.  Выберите команду **Добавить оповещение журнала действий** и заполните поля.

5.  Укажите **Имя** оповещения журнала действий и выберите **Описание**.

    ![Add-Alert](./media/monitoring-activity-log-alerts/add-activity-log-alert.png)

6.  Оповещение журнала действий будет сохранено в подписке, выбранной в поле **Подписка**. В этом поле автоматически указывается текущая подписка. Это подписка, в которой будет развернут ресурс оповещения и будут отслеживаться события журнала действий.

    ![Add-Alert-New-Action-Group](./media/monitoring-activity-log-alerts/activity-log-alert-new-action-group.png)

7.  Выберите **группу ресурсов**, в которой будет создан этот ресурс оповещения. Обратите внимание, что это не группа ресурсов, которая будет *отслеживаться* оповещением. Это группа ресурсов, в которой *будет развернут ресурс этого оповещения*.

8.  Дополнительно можно выбрать **категорию событий**, которая меняет отображаемый набор дополнительных фильтров. Для событий администрирования доступны фильтры о значениям **Группа ресурсов**, **Ресурс**, **Тип ресурса**, **Имя операции**, **Уровень**, **Состояние** и **Кем инициировано событие**, позволяющие определить, какие события будет отслеживать это оповещение.

>[!NOTE]
>В оповещении необходимо указать хотя бы одно из описанных выше условий. Вы не можете создать оповещение, которое активируется каждый раз при создании события в журнале действий.
>
>

9.  Создайте **новую** группу действий, указав ее **имя** и **короткое имя**; короткое имя отображается в уведомлениях, отправляемых при активации данного оповещения.

10. Затем определите список действий, указав для каждого из них следующие данные:

    а. **Имя**. Имя, псевдоним или идентификатор действия.

    b. **Тип действия.** Допустимые варианты: SMS, электронное письмо, веб-перехватчик.

    c. **Подробные сведения**. В зависимости от выбранного типа действия, укажите номер телефона, адрес электронной почты или универсальный код ресурса (URI) веб-перехватчика.

11. Завершив настройку, нажмите кнопку **ОК** , чтобы создать оповещение.

Полное распространение оповещения займет несколько минут, после чего оно станет активным и будет активироваться, когда новые события будут удовлетворять условиям оповещения.

Дополнительные сведения о схеме веб-перехватчиков для оповещений журнала действий см. в этом [документе](monitoring-activity-log-alerts-webhook.md).

>[!NOTE]
>Группу действий, определенную на этих этапах, можно будет многократно использовать как существующую группу действий для всех будущих определений оповещений.
>
>

## <a name="create-an-alert-on-an-activity-log-event-for-an-existing-action-group-with-the-azure-portal"></a>Создание оповещения для событий журнала действий для существующей группы действий с помощью портала Azure
1.  На [портале](https://portal.azure.com) перейдите в колонку **Монитор**.

    ![Монитор](./media/monitoring-activity-log-alerts/home-monitor.png)
2.  Щелкните **Мониторинг**, чтобы открыть колонку "Мониторинг". Сначала открывается раздел **Журнал действий** .

3.  Теперь щелкните раздел **Оповещения**.

    ![Оповещения](./media/monitoring-activity-log-alerts/alerts-blades.png)
4.  Выберите команду **Добавить оповещение журнала действий** и заполните поля.

5.  Укажите **имя** оповещения журнала действий и выберите ее **описание**. Они будут отображаться в уведомлениях, отправляемых при активации данного оповещения.

    ![Add-Alert](./media/monitoring-activity-log-alerts/add-activity-log-alert.png)
6.  Оповещение журнала действий будет сохранено в подписке, выбранной в поле **Подписка**. В этом поле автоматически указывается текущая подписка. Это подписка, в которой будет развернут ресурс оповещения и будут отслеживаться события журнала действий.

    ![Add-Alert-Existing-Action-Group](./media/monitoring-activity-log-alerts/activity-log-alert-existing-action-group.png)
7.  Выберите **группу ресурсов**, в которой будет создан этот ресурс оповещения. Обратите внимание, что это не группа ресурсов, которая будет *отслеживаться* оповещением. Это группа ресурсов, в которой *будет развернут ресурс этого оповещения*.

8.  Дополнительно можно выбрать **категорию событий**, которая меняет отображаемый набор дополнительных фильтров. Для событий администрирования доступны фильтры о значениям **Группа ресурсов**, **Ресурс**, **Тип ресурса**, **Имя операции**, **Уровень**, **Состояние** и **Кем инициировано событие**, позволяющие определить, какие события будет отслеживать это оповещение.

9.  Выберите для параметра **Notify Via** (Уведомлять через) значение **Existing action group** (Существующая группа действий). Выберите существующую группу действий из списка.

10. Завершив настройку, нажмите кнопку **ОК** , чтобы создать оповещение.

Полное распространение оповещения займет несколько минут, после чего оно станет активным и будет активироваться, когда новые события будут удовлетворять условиям оповещения.

## <a name="managing-your-alerts"></a>Управление оповещениями

После создания оповещение отображается в разделе "Оповещения" в колонке "Монитор". Выберите оповещение, которым нужно управлять, чтобы получить возможность:
* **изменить** его;
* **удалить** его;
* **отключить** или **включить** его, если нужно временно остановить или возобновить получение уведомлений для этого оповещения.

## <a name="next-steps"></a>Дальнейшие действия
- [Обзор оповещений](monitoring-overview-alerts.md)
- См. дополнительные сведения об [ограничениях частоты отправки уведомлений](monitoring-alerts-rate-limiting.md).
- Просмотрите [схему webhook оповещений журнала действий](monitoring-activity-log-alerts-webhook.md).
- Узнайте больше о [группах действий](monitoring-action-groups.md).  
- Дополнительные сведения об [уведомлениях о работоспособности службы](monitoring-service-notifications.md).
- [Создайте оповещение журнала действий, чтобы отслеживать все операции системы автомасштабирования в своей подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert).
- [Создайте оповещение журнала действий, чтобы отслеживать все ошибки автомасштабирования в своей подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).

