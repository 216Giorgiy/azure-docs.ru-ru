<properties 
	pageTitle="Эластичное масштабирование баз данных SQL Azure" 
	description="Легкое масштабирование ресурсов базы данных в облаке с помощью функции эластичного масштабирования базы данных SQL Azure." 
	services="sql-database" 
	documentationCenter="" 
	manager="stuartozer" 
	authors="Joseidz" 
	editor=""/>

<tags 
	ms.service="sql-database" 
	ms.workload="sql-database" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/16/2015" 
	ms.author="Joseidz@microsoft.com"/>

# Обзор эластичного масштабирования базы данных SQL Azure 
Добро пожаловать в общедоступную предварительную версию технологии эластичного масштабирования базы данных SQL Azure! 

## Перспективы и трудности
Эластичное масштабирование базы данных SQL Azure осуществляется средствами облачных вычислений и обеспечивает практически неограниченную производительность и гибкость решений на платформе базы данных SQL Azure. До настоящего времени поставщики облачных служб предоставляли большинство всевозможных услуг с неограниченной производительностью вычислений и емкостью хранилищ BLOB-объектов. Эластичность решения, тем не менее, по-прежнему остается проблемой, когда дело доходит до обработки в облаке данных с отслеживанием состояния (stateful data processing), особенно при управлении реляционной базой данных. Мы выяснили, что эти проблемы наиболее ярко проявляются в двух следующих случаях. 

* Увеличение и уменьшение производительности реляционной базы данных как части рабочей нагрузки решения.
* Управление использованием хот-спотов для рабочих нагрузок к базам данным с отслеживанием состояния, и содержащихся в них информации.

Обычно эти сценарии решаются путем приобретения дополнительного оборудования, на котором размещается уровень данных приложения. Тем не менее реализация этого варианта ограничена облаком, в котором вся обработка выполняется на предустановленном стандартном оборудовании. С точки зрения затрат и гибкости сегментирование - распределение данных и обработка на нескольких единицах масштабирования - является убедительной альтернативой традиционным подходам к масштабированию в контексте повышения производительности. За несколько лет мы выяснили, что для удачной реализации стратегии сегментирования клиентам необходимо применять собственные методы масштабирования баз данных SQL Azure. В некоторых случаях это означает управление сотнями и тысячами баз данных SQL Azure. Это подразумевает наличие на уровне данных большого объема кода для непростой реализации процесса сегментирования, а не выполнения бизнес-логики самого приложения. 

Работая в течение многих лет напрямую с клиентами, мы увидели несколько шаблонов реализации сегментирования, повторяющихся в подобных проектах. Эластичное масштабирование баз данных SQL Azure предоставляет клиентские библиотеки и службы, построенные на основе этих шаблонов. Эластичное масштабирование для приложений Azure упрощает разработку, масштабирование и управление уровнем данных с отслеживанием состояния.

Вследствие этого разработчики могут сосредоточиться на бизнес-логике приложения, а не на создании инфраструктуры для поддержки сегментирования.
## Горизонтальное или вертикальное масштабирование
На следующем рисунке показано различие между горизонтальным и вертикальным масштабированием. Это два способа масштабирования сегментированного решения. 
![Horizontal versus Vertical Scaleout][4]

Горизонтальное масштабирование позволяет увеличить емкость. Например, по мере приближения срока оплаты налогов вы можете увеличить пространство для хранения входящих документов.

Вертикальное масштабирование используется для увеличения производительности сегмента. Такая возможность может понадобиться при обработке большого объема данных, при которой сегмент становится самой используемой зоной в системе. Например, вы можете создать новый сегмент для обработки большого притока данных в конце месяца. При поступлении новых данных сегмент масштабируется в сторону увеличения, а затем в сторону уменьшения при уменьшении притока данных.

Дополнительную информацию о сценариях масштабирования см. в разделе [Разбиение и объединение с технологией эластичного масштабирования](sql-database-elastic-scale-overview-split-and-merge.md).


## Возможности 

Разработка, масштабирование и управление масштабируемыми приложениями с использованием сегментирования представляет собой непростую задачу как для разработчика, так и для администратора. Эластичное масштабирование баз данных SQL Azure делает их жизнь проще. Числа на графике описывают основные возможности, представленные в этой общедоступной предварительной версии. 
В нижней части показан уровень данных приложения и распределение его данных по нескольким БД, которые называются сегментами. Предположим, что несколько баз данных хранят информацию для нескольких сегментов. 

Определения используемых терминов см. в [Глоссарии по эластичному масштабированию](sql-database-elastic-scale-glossary.md).

## Эластичное масштабирование с сегментированием 
**Эластичность сегментов** - это возможность, которая позволяет администраторам автоматизировать вертикальное (набор вверх и вниз вариантов одного сегмента) и горизонтальное (добавление и удаление сегментов из сопоставления сегментов) масштабирование сегментированной среды с помощью сценариев PowerShell и службы автоматизации Azure. Дополнительную информацию см. в разделе [Эластичность сегментов](sql-database-elastic-scale-elasticity.md).

На рисунке ниже показаны разработчик и администратор (слева и справа). Клиенты могут получить полную функциональности T-SQL при отправке операций в пределах одного сегмента в отличие от операций между сегментами, для которых применяется собственная семантика. 
Выпуск общедоступной предварительной версии гибкого масштабирования баз данных SQL Azure делает разработку приложений сегментированных баз данных SQL Azure более простой за счет следующих особых возможностей. 

![Elastic Scale Capabilities][1]

1.  **Управление сопоставлениями сегментов**: Управление сопоставлениями сегментов - это возможность приложения управлять различными метаданными о своих сегментах. Управление сопоставлениями сегментов - это функция клиентской библиотеки эластичного масштабирования (Elastic Scale). Разработчики могут использовать этот функционал для регистрации сегментов, описания сопоставлений отдельных ключей сегментирования или их диапазонов с фактическими сегментами. Функции библиотеки задействуются и для обновления метаданных по мере развития схемы сегментов в уровне данных для отражения вносимых в систему баз данных изменений. Управление сопоставлениями сегментов заменяет большую часть того типового кода, который приходилось писать клиентам в своих приложениях при самостоятельной реализации сегментирования. Подробности см. в статье [Управление сопоставлениями сегментов](sql-database-elastic-scale-shard-map-management.md)
 
* **Маршрутизация, зависящая от данных**. Допустим, приложению приходит запрос. На основании значения ключа сегментирования из запроса приложение должно определить соответствующий сегмент, содержащий данные для этого ключа сегментирования, а затем открыть соединение для этого сегмента и выполнить запрос. Маршрутизация на основе данных позволяет открыть соединение, сделав один простой вызов в диспетчер сопоставлений сегментов приложения. Маршрутизация на основе данных - еще один уровень кода для поддержки инфраструктуры сегментирования, который теперь решается за счет клиентской библиотеки эластичного масштабирования. Подробности см. в статье [Маршрутизация на основе данных](sql-database-elastic-scale-data-dependent-routing.md)

* **Многосегментное формирование запросов (MSQ)**. Многосегментное формирование запросов применяется в том случае, когда запрос относится к некоторым (или всем) сегментам. Многосегментный запрос выполняет одинаковый код T-SQL во всех сегментах или наборе сегментов. Результаты из задействованных сегментов объединяются в общий набор результатов с помощью семантики UNION ALL. Предоставляемая клиентской библиотекой функциональная возможность решает множество задач, в том числе: управление подключениями, управление потоками, обработка сбоев и обработка промежуточных результатов. MSQ может посылать запросы к сотням сегментов. Подробнее см. в разделе [Многосегментное формирование запросов](sql-database-elastic-scale-multishard-querying.md).


* **Служба разбиения и объединения**. Когда производительность должна меняться согласно динамике бизнеса, приложениям нужно гибко распределять информацию на несколько баз данных. Технология эластичного масштабирования предоставляет службы, размещаемые на стороне клиента, для увеличения и уменьшения производительности уровня данных и управления хот-спотами сегментированных приложений в случаях, в которых также требуется перемещение данных. Она основана на базовой возможности перемещения по запросу данных сегментов (шардлетов) между разными сегментами и интегрировано в управление сопоставлениями сегментов, что обеспечивает поддержку согласованных сопоставлений и установку правильных соединений при маршрутизации на основе данных. Подробности см. в статье [Разбиение и объединение с технологией эластичного масштабирования](sql-database-elastic-scale-overview-split-and-merge.md)

## Распространенные шаблоны сегментирования

**Сегментирование** - это технология распределения больших объемов данных с одинаковой структурой по множеству независимых баз данных. Она пользуется особенной популярностью среди разработчиков облачных технологий при создании для конечных пользователей и предприятий SAAS-решений. Эти конечные пользователи часто именуются "клиентами". Сегментирование может потребоваться по ряду причин: 

* общий объем данных слишком велик для размещения в пределах одной базы данных; 
* пропускная способность транзакций общей рабочей нагрузки превышает возможности одной базы данных; 
* клиентам может потребоваться физическая изоляция друг от друга, для чего требуются отдельные базы данных для каждого клиента; 
* разные части базы данных могут размещаться в разных регионах по соображениям соответствия требованиям законодательства, производительности или по геополитическим причинам. 

В других сценариях, например в приеме данных из распределенных устройств, сегментирование может использоваться для заполнения набора баз данных по временному признаку. Например, отдельная база данных может выделяться под каждый день или неделю. В этом случае ключом сегментирования может быть целое число, представляющее дату (присутствующую во всех строках сегментированных таблиц), а запросы получения информации о диапазоне дат должны передаваться приложением в подмножество баз данных, которые покрывают рассматриваемый диапазон.
 
Сегментирование лучше всего работает, когда каждая транзакция в приложении может ограничиваться одним значением ключа сегментирования. Это гарантирует, что все транзакции будут осуществляться в пределах отдельной базы данных. 

Некоторые приложения используют простой способ создания отдельной базы данных для каждого клиента. Это **шаблон сегментирования для одного клиента**, который предоставляет возможность изолирования, резервного копирования и восстановления, а также масштабирования ресурсов согласно детализации клиента. Благодаря сегментированию для одного клиента каждая база данных привязывается к отдельному идентификатору клиента (или значению ключа клиента), но этот ключ не должен постоянно присутствовать в самих данных. За направление каждого запроса к соответствующей базе данных отвечает само приложение. 

![Single tenant versus multi-tenant][3]

Другие сценарии объединяют несколько клиентов вместе в базах данных вместо изолирования их в отдельных базах данных. Это типовой **шаблон сегментирования на нескольких клиентов**; он может использоваться из соображений стоимости, эффективности или при обработке приложением большого числа очень маленьких клиентов. При сегментировании на несколько клиентов строки таблиц базы данных спроектированы для хранения ключа, идентифицирующего пользователя, или ключа сегментирования. Кроме того, уровень приложения отвечает за направление запроса клиента к соответствующей базе данных. 

[AZURE.INCLUDE [elastic-scale-include](../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-intro/overview.png
[2]:./media/sql-database-elastic-scale-intro/tenancy.png
[3]:./media/sql-database-elastic-scale-intro/single_v_multi_tenant.png
[4]:./media/sql-database-elastic-scale-intro/h_versus_vert.png

<!--HONumber=47-->
