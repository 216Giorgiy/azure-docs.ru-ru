<properties 
   pageTitle="Использование соединителя SharePoint в приложении логики" 
   description="Использование соединителя SharePoint в приложении логики" 
   services="app-service\logic" 
   documentationCenter=".net,nodejs,java" 
   authors="anuragdalmia" 
   manager="dwrede" 
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration" 
   ms.date="03/20/2015"
   ms.author="vagarw"/>

# Использование соединителя SharePoint в приложении логики

Приложения логики могут запускаться на основе различных источников данных и предлагают соединители для получения и обработки данных в рамках потока. Соединитель Microsoft SharePoint позволяет подключаться к Microsoft SharePoint Server или SharePoint Online, чтобы управлять документами и элементами списка. Вы можете выполнять различные действия, такие как создание, обновление, получение и удаление документов и элементов списка. При использовании локального сервера SharePoint вы можете предоставить строку подключения к служебной шине как часть конфигурации соединителя и установить агент локального прослушивателя для подключения к серверу.

Приложение из коллекции соединителей SharePoint Online и соединителей SharePoint Server предоставляет вам триггер и действия в качестве механизмов взаимодействия с SharePoint.

## Создание соединителя SharePoint Online для приложения логики

Чтобы использовать соединитель SharePoint Online, необходимо сначала создать экземпляр приложения API соединителя SharePoint Online. Это можно сделать следующим образом.

1. Откройте Azure Marketplace с помощью кнопки «+ СОЗДАТЬ» в нижнем правом углу портала Azure.

2. Перейдите в раздел «Мобильные и веб-приложения > Приложения API» и найдите элемент «Соединитель SharePoint Online».

3. Настройте соединитель SharePoint Online и нажмите кнопку «Создать». Ниже перечислены параметры, которые необходимо предоставить для создания соединителя.

	<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>URL-адрес сайта</td>
    <td>Да</td>
    <td>Укажите полный URL-адрес веб-сайта SharePoint. Например: https://microsoft.sharepoint.com/teams/wabstest </td>
  </tr>
  <tr>
    <td>Относительные URL-адреса библиотек документов/списков</td>
    <td>Да</td>
    <td>Укажите URL-адреса библиотек документов и списков, связанных с URL-адресом сайта SharePoint, которые могут изменяться соединителем. Например: «Списки/задача», «Общие документы».</td>
  </tr>
</table>![][1]


4. После этого можно создать приложение логики в той же группе ресурсов для использования соединителя SharePoint Online.

## Создание соединителя SharePoint Server для приложения логики

Чтобы использовать соединитель SharePoint Server, необходимо сначала создать экземпляр приложения API соединителя SharePoint Server. Это можно сделать следующим образом.

1. Откройте Azure Marketplace с помощью кнопки «+ СОЗДАТЬ» в нижнем правом углу портала Azure.

2. Перейдите в раздел «Мобильные и веб-приложения > Приложения API» и найдите элемент «Соединитель SharePoint Server».

3. Настройте соединитель SharePoint Server и нажмите кнопку «Создать». Ниже перечислены параметры, которые необходимо предоставить для создания соединителя.

	<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>URL-адрес сайта</td>
    <td>Да</td>
    <td>Укажите полный URL-адрес веб-сайта SharePoint. Например: https://microsoft.sharepoint.com/teams/wabstest </td>
  </tr>
  <tr>
    <td>Режим проверки подлинности</td>
    <td>Да</td>
    <td>Укажите режим проверки подлинности для подключения к сайту SharePoint. Допустимые значения:<br><br>
		По умолчанию<br>			
		WindowsAuthentication<br>
		FormBasedAuthentication.<br><br>

Если выбраны учетные данные по умолчанию, то используются учетные данные по умолчанию, под которыми работает SharePoint Microservice, и имя пользователя и пароль не требуются. Для других типов проверки подлинности поля «Имя пользователя» и «Пароль» обязательны. <br><br>Примечание: анонимный доступ не поддерживается.</td>
  </tr>
  <tr>
    <td>Имя пользователя</td>
    <td>Нет</td>
    <td>Укажите допустимое имя пользователя для подключения к веб-сайту SharePoint, если не используется режим проверки подлинности Default.</td>
  </tr>
  <tr>
    <td>Пароль</td>
    <td>Нет</td>
    <td>Укажите допустимый пароль для подключения к веб-сайту SharePoint, если не используется режим проверки подлинности Default.</td>
  </tr>
  <tr>
    <td>Относительные URL-адреса библиотек документов/списков</td>
    <td>Да</td>
    <td>Укажите URL-адреса библиотек документов и списков, связанных с URL-адресом сайта SharePoint, которые могут изменяться соединителем. Например: «Списки/задача», «Общие документы».</td>
  </tr>
  <tr>
    <td>Строка подключения к служебной шине</td>
    <td>Нет</td>
    <td>Это должна быть допустимая строка подключения к пространству имен служебной шины.<br><br>

Вам потребуется установить агент прослушивателя на сервере, который имеет доступ к вашему серверу SharePoint. <br>Вы можете перейти на страницу сводных данных по приложению API и выбрать команду «Гибридное подключение» для установки агента.</td>
  </tr>
</table>![][2]

4. После этого можно приступить к созданию приложения логики в той же группе ресурсов для использования соединителя SharePoint Server.
5. Вам потребуется установить агент прослушивателя на сервере, который имеет доступ к вашему серверу SharePoint. Вы можете перейти на страницу сводных данных по приложению API и выбрать команду «Гибридное подключение» для установки агента.

## Использование соединителя SharePoint в приложении логики

После создания приложения API можно использовать соединитель SharePoint как триггер или действие для приложения логики. Для этого необходимо выполнить следующие действия.

1. Создайте новое приложение логики и выберите ту же группу ресурсов, которую имеет соединитель SharePoint.

2. Откройте раздел «Триггеры и действия», чтобы открыть конструктор приложений логики и настроить поток. Соединитель SharePoint будет отображаться в разделе «Последние использовавшиеся» в коллекции с правой стороны. Выберите его.

3. Если соединитель SharePoint выбирается в начале приложения логики, он действует как триггер действий, которые могут выполняться в учетной записи SharePoint с помощью этого соединителя.

4. Необходимо произвести проверку подлинности и авторизацию приложений логики для выполнения операций от имени пользователя, если используется соединитель SharePoint Online. Чтобы запустить авторизацию, нажмите кнопку «Авторизовать» в соединителе SharePoint.

	![][3]

5. После нажатия кнопки «Авторизовать» открывается диалоговое окно проверки подлинности SharePoint. Предоставьте сведения для входа учетной записи SharePoint, в которой вы хотите выполнять операции.

	![][4]
6. Предоставьте приложениям логики доступ к своей учетной записи для выполнения операций от вашего имени. 

	![][5]

7. Если соединитель SharePoint настроен как триггер, то показываются триггеры, а также отображается список действий, и вы можете выбрать соответствующую операцию, которую требуется выполнить.

	![][6]

	<b>Относительный URL-адрес, настроенный для библиотеки документов</b><br><br>

	![][7]

	<b>Относительный URL-адрес, настроенный для списка документов</b>

	<b>Примечание.</b> Для приведенных далее триггеров предполагается, что пользователь указал «Общие документы, Списки/задача» в параметрах пакета соединителя, где «Общие документы» — это библиотека документов, а «Списки/задача» — список.

##  Триггеры
Используйте триггеры, если вы хотите инициировать приложение логики.

**Примечание**. Триггеры будут удалять файлы после их чтения. Чтобы сохранить эти файлы, укажите значение для расположения архива.

### 1. Новый документ в общих документах (JSON)
Этот триггер срабатывает, когда в библиотеке «Общие документы» появляется доступный новый документ.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Имя представления</td>
    <td>Нет</td>
    <td>Укажите допустимое представление, используемое для фильтрации документов для выбора. Пример: «Утвержденные заказы». Чтобы обрабатывать все существующие документы, оставьте это поле пустым. </td>
  </tr>
  <tr>
    <td>Расположение архива</td>
    <td>Нет</td>
    <td>Укажите допустимый URL-адрес папки относительно сайта SharePoint, где архивируются обработанные документы. </td>
  </tr>
  <tr>
    <td>Перезаписать в архиве</td>
    <td>Нет</td>
    <td>Установите этот флажок для перезаписи файла в архиве, если он уже существует. </td>
  </tr>
  <tr>
    <td>Запрос CAML</td>
    <td>Нет, дополнительно</td>
    <td>Укажите допустимый запрос CAML для фильтрации документов. Пример: <Where><Geq><FieldRef Name='ID'/><Value Type='Number'>10</Value></Geq></Where>.</td>
  </tr>
</table>

**Выходные параметры:** <table> <tr> <td><b>Имя</b></td> <td><b>Описание</b></td> </tr> <tr> <td>Имя </td> <td>Имя документа.</td> </tr> <tr> <td>Содержимое</td> <td>Содержимое документа.</td> </tr> <tr> <td>ContentTransferEncoding</td> <td>Кодирование передачи содержимого сообщения. ("none"|”base64”)</ </tr> </table>


Примечание. Все столбцы элемента документа отображаются в свойствах выходных данных «Дополнительно».


###2. Новый элемент в задачах (JSON)
Этот триггер срабатывает, когда в список «Задачи» добавляется новый элемент.

**Входные параметры:** <table> <tr> <td><b>Имя</b></td> <td><b>Обязательно</b></td> <td><b>Описание</b></td> </tr> <tr> <td>Имя представления</td> <td>Нет</td> <td>Укажите допустимое представление, используемое для фильтрации элементов в списке. Пример: «Утвержденные заказы». Чтобы обрабатывать все новые элементы, оставьте это поле пустым. </td> </tr> <tr> <td>Расположение архива</td> <td>Нет</td> <td>Укажите допустимый URL-адрес папки относительно веб-сайта SharePoint, где архивируются обработанные элементы списка. </td> </tr> <tr> <td>Запрос CAML</td> <td>Нет, дополнительно</td> <td>Укажите допустимый запрос CAML для фильтрации элементов списка. Пример: <Where><Geq><FieldRef Name='ID'/><Value Type='Number'>10</Value></Geq></Where></td> </tr> </table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Столбцы в списке заполняются динамически и отображаются в выходных параметрах.</td>
    <td>&#160;</td>
  </tr>

</table>


###3. Новый документ в общих документах (XML)

Этот триггер срабатывает, когда в библиотеке «Общие документы» появляется доступный новый документ. Этот новый документ возвращается как XML-сообщение.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Имя представления</td>
    <td>Нет</td>
    <td>Укажите допустимое представление, используемое для фильтрации документов для выбора. Пример: «Утвержденные заказы». Чтобы обрабатывать все существующие документы, оставьте это поле пустым. </td>
  </tr>
  <tr>
    <td>Расположение архива</td>
    <td>Нет</td>
    <td>Укажите допустимый URL-адрес папки относительно сайта SharePoint, где архивируются обработанные документы. </td>
  </tr>
  <tr>
    <td>Перезаписать в архиве</td>
    <td>Нет</td>
    <td>Установите этот флажок для перезаписи файла в архиве, если он уже существует. </td>
  </tr>
  <tr>
    <td>Запрос CAML</td>
    <td>Нет, дополнительно</td>
    <td>Укажите допустимый запрос CAML для фильтрации документов. Пример: <Where><Geq><FieldRef Name='ID'/><Value Type='Number'>10</Value></Geq></Where>.</td>
  </tr>
</table>

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Содержимое</td>
    <td>Контент документа.</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
</table>


###4. Новый элемент в задачах (XML)

Этот триггер срабатывает, когда в список «Задачи» добавляется новый элемент. Этот новый элемент списка возвращается в виде XML-сообщения.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Имя представления</td>
    <td>Нет</td>
    <td>Укажите допустимое представление, используемое для фильтрации элементов в списке. Пример: «Утвержденные заказы». Чтобы обрабатывать все новые элементы, оставьте это поле пустым. </td>
  </tr>
  <tr>
    <td>Расположение архива</td>
    <td>Нет</td>
    <td>Укажите допустимый URL-адрес папки относительно сайта SharePoint, где архивируются обработанные элементы списка. </td>
  </tr>
  <tr>
    <td>Запрос CAML</td>
    <td>Нет, дополнительно</td>
    <td>Укажите допустимый запрос CAML для фильтрации элементов списка. Пример: <Where><Geq><FieldRef Name='ID'/><Value Type='Number'>10</Value></Geq></Where>.</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Содержимое</td>
    <td>Контент документа.</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
</table>


##  Действия
Для приведенных далее действий предполагается, что пользователь указал «Общие документы, Списки/задача» в параметрах пакета соединителя, где «Общие документы» — это библиотека документов, а «Списки/задача» — список.

###1. Отправить в общие документы (JSON)

Это действие отправляет новый документ в библиотеку «Общие документы». Входные данные — строго типизированный объект JSON со всеми полями столбцов библиотеки документов.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
 </tr>
  <tr>
    <td>Имя</td>
    <td>Да</td>
    <td>Имя документа.</td>
  </tr>
  <tr>
    <td>Содержимое</td>
    <td>Да</td>
    <td>Контент документа.</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Да</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
  <tr>
    <td>Обязательная перезапись</td>
    <td>Да</td>
    <td>Если указано значение TRUE и документ с заданным именем уже существует, он будет перезаписан.</td>
  </tr>
  <tr>
    <td>ReqParam1*</td>
    <td>Да</td>
    <td>Это один из обязательных параметров для добавления документа в библиотеку документов.</td>
  </tr>
  <tr>
    <td>ReqParam2*</td>
    <td>Да</td>
    <td>Это один из обязательных параметров для добавления документа в библиотеку документов.</td>
  </tr>
  <tr>
    <td>OptionalParam1*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из необязательных параметров для добавления документа в библиотеку документов.</td>
  </tr>
  <tr>
    <td>OptionalParam2*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из необязательных параметров для добавления документа в библиотеку документов.</td>
  </tr>
</table>

<b>Примечание.</b> Все параметры библиотеки документов заполняются динамически. Обязательные параметры видимы, а необязательные параметры находятся в дополнительном разделе.


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Идентификатор элемента документа, добавленного в библиотеку документов.</td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешной отправке документа возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


 

###2. Получить из общих документов (JSON)
Это действие получает документ из библиотеки документов, исходя из относительного URL-адреса (структуры папок) документа.


**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Относительный URI документа</td>
    <td>Нет</td>
    <td>Укажите URL-адрес документа относительно библиотеки «Общие документы». Пример: myspec1,myfolder/orders</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Содержимое</td>
    <td>Контент документа</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешном выполнении действия возвращается код состояния 200 (ОК).</td>
  </tr>
  <tr>
    <td>Param1*</td>
    <td>Это один из параметров документа в библиотеке документов.</td>
  </tr>
  <tr>
    <td>Param2*</td>
    <td>Это один из параметров документа в библиотеке документов.</td>
  </tr>
</table>

<b>Примечание.</b> Все параметры библиотеки документов заполняются динамически. И они находятся в дополнительном разделе.

 

###3. Удалить из общих документов

Это действие удаляет документ из библиотеки документов, исходя из относительного URL-адреса (структуры папок) документа.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Относительный URI документа</td>
    <td>Нет</td>
    <td>Укажите URL-адрес документа относительно библиотеки «Общие документы». Пример: myspec1,myfolder/orders</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешном выполнении действия возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###4. Вставить в задачи (JSON)

Это действие добавляет элемент в список элементов.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ReqParam1*</td>
    <td>Да</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>ReqParam2*</td>
    <td>Да</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>OptionalParam1*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>OptionalParam2*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
</table>


<b>Примечание.</b> Все параметры списка заполняются динамически. Обязательные параметры видимы, а необязательные параметры находятся в дополнительном разделе.

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Идентификатор добавленного элемента списка.</td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешной вставке элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###5. Обновить задачи (JSON)

Это действие обновляет элемент в списке элементов.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Да</td>
    <td>Идентификатор элемента списка.</td>
  </tr>
  <tr>
    <td>ReqParam1*</td>
    <td>Нет</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>ReqParam2*</td>
    <td>Нет</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>OptionalParam1*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
  <tr>
    <td>OptionalParam2*</td>
    <td>Нет. Дополнительно</td>
    <td>Это один из обязательных параметров для добавления элемента в список.</td>
  </tr>
</table>

<b>Примечание.</b> Все параметры списка заполняются динамически. Обязательные параметры видимы, а необязательные параметры находятся в дополнительном разделе.


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешном обновлении элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###6. Получить элемент из задач (JSON)

Это действие возвращает элемент из списка элементов.


**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Да</td>
    <td>Идентификатор элемента списка.</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Column1*</td>
    <td>Это один из параметров в списке.</td>
  </tr>
  <tr>
    <td>Column2*</td>
    <td>Это один из параметров в списке.</td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешном выполнении действия возвращается код состояния 200 (ОК).</td>
  </tr>
</table>

<b>Примечание.</b> Столбцы в списке заполняются динамически и отображаются в выходных параметрах.


###7. Удалить элемент из задач

Это действие удаляет элемент из списка элементов.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Да</td>
    <td>Идентификатор элемента списка.</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешном удалении элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###8. Список общих документов (JSON)

Это действие возвращает список всех документов в библиотеке документов. Для фильтрации документов можно использовать представление или запрос CAML.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Имя представления</td>
    <td>Нет</td>
    <td>Укажите допустимое представление, используемое для фильтрации документов для выбора. Пример: «Утвержденные заказы». Чтобы обрабатывать все существующие документы, оставьте это поле пустым. </td>
  </tr>
  <tr>
    <td>Запрос CAML</td>
    <td>Нет</td>
    <td>Укажите допустимый запрос CAML для фильтрации документов. Пример: <Where><Geq><FieldRef Name='ID'/><Value Type='Number'>10</Value></Geq></Where>.</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Документы</td>
    <td>Массив из всех документов. Каждый документ имеет следующие поля. <br><br>
	Документы []<br>
	Имя<br>
	Идентификатор элемента<br>
	Полный URL-адрес элемента<br>
	Расширенная<br>
	URL-адрес редактирования элемента<br>
	Имя списка<br>
	Полный URL-адрес списка<br>
	</td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешной вставке элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###9. Отправить в общие документы (XML)

Это действие отправляет новый документ в библиотеку «Общие документы». Входной документ должен представлять собой полезные XML-данные. Результатом этого действия будут полезные XML-данные.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Имя</td>
    <td>Да</td>
    <td>Имя документа.</td>
  </tr>
  <tr>
    <td>Содержимое</td>
    <td>Да</td>
    <td>Контент документа.</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Да</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
  <tr>
    <td>Обязательная перезапись</td>
    <td>Да</td>
    <td>Если указано значение TRUE и документ с заданным именем уже существует, он будет перезаписан.</td>
  </tr>
</table>
 

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Выходные XML-данные</td>
    <td>Результат действия отправки в формате XML.</td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешной отправке документа возвращается код состояния 200 (ОК).</td>
  </tr>
</table>

###10. Получить из общих документов (XML)

Это действие получает документ из библиотеки документов, исходя из относительного URL-адреса (структуры папок) документа.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Относительный URI документа</td>
    <td>Нет</td>
    <td>Укажите URL-адрес документа относительно библиотеки «Общие документы». Пример: myspec1,myfolder/orders</td>
  </tr>
  <tr>
    <td>Тип файла</td>
    <td>Да</td>
    <td>Укажите, является ли этот файл двоичным или текстовым.</td>
  </tr>
</table>


**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Выходные XML-данные</td>
    <td>Контент документа</td>
  </tr>
  <tr>
    <td>ContentTransferEncoding</td>
    <td>Кодирование передачи содержимого сообщения ("none"|”base64”).</td>
  </tr>
  <tr>
    <td>Состояние</td>
    <td>При успешном выполнении действия возвращается код состояния 200 (ОК).</td>
  </tr>
</table>

###11. Вставить в задачи (XML)

Это действие добавляет элемент в список элементов. Входные данные должны быть полезными XML-данными.

**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Входные XML-данные</td>
    <td>Да</td>
    <td>XML-сообщение, которое содержит значения полей элемента списка для вставки. Создать XML-сообщение можно с помощью приложения API преобразования.</td>
  </tr>
</table>
<b>Примечание.</b> Все параметры списка заполняются динамически. Обязательные параметры видимы, а необязательные параметры находятся в дополнительном разделе.

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Идентификатор добавленного элемента списка.</td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешной вставке элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###12. Обновить задачи (XML)

Это действие обновляет элемент в списке элементов. Входные данные должны быть полезными XML-данными.


**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Да</td>
    <td>Идентификатор элемента списка.</td>
  </tr>
  <tr>
    <td>Входные XML-данные</td>
    <td>Да</td>
    <td>XML-сообщение, которое содержит значения полей элемента списка для вставки. Создать XML-сообщение можно с помощью приложения API преобразования.</td>
  </tr>
</table>

<b>Примечание.</b> Все параметры списка заполняются динамически. Обязательные параметры видимы, а необязательные параметры находятся в дополнительном разделе.

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешном обновлении элемента списка возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


###13. Получить элемент из задач (XML)

Это действие возвращает элемент из списка элементов.


**Входные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Обязательный</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>ItemId</td>
    <td>Да</td>
    <td>Идентификатор элемента списка.</td>
  </tr>
</table>

**Выходные параметры:**

<table>
  <tr>
    <td><b>Имя</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr>
    <td>Выходные XML-данные</td>
    <td>XML-сообщение, которое содержит значения полей выбранного элемента списка. </td>
  </tr>
  <tr>
    <td>Состояние  </td>
    <td>При успешном выполнении действия возвращается код состояния 200 (ОК).</td>
  </tr>
</table>


<!--Image references-->
[1]: ./media/app-service-logic-connector-sharepoint/image_0.png
[2]: ./media/app-service-logic-connector-sharepoint/image_1.png
[3]: ./media/app-service-logic-connector-sharepoint/image_2.png
[4]: ./media/app-service-logic-connector-sharepoint/image_3.png
[5]: ./media/app-service-logic-connector-sharepoint/image_4.jpg
[6]: ./media/app-service-logic-connector-sharepoint/image_5.png
[7]: ./media/app-service-logic-connector-sharepoint/image_6.png

<!--HONumber=54-->