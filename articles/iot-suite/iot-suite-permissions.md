---
title: "Azure IoT Suite и Azure Active Directory | Документация Майкрософт"
description: "В этой статье описывается, как набор Azure IoT Suite использует Azure Active Directory для управления разрешениями."
services: 
suite: iot-suite
documentationcenter: 
author: dominicbetts
manager: timlt
editor: 
ms.assetid: 246228ba-954a-4d96-b6d6-e53e4590cb4f
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 02/08/2017
ms.author: corywink
translationtype: Human Translation
ms.sourcegitcommit: 14e2fcea9a6afbac640d665d5e44a700f855db4b
ms.openlocfilehash: c6db7f36acf93d319fcbc93244867460a2270979
ms.lasthandoff: 02/09/2017


---
# <a name="permissions-on-the-azureiotsuitecom-site"></a>Разрешения на сайте azureiotsuite.com
## <a name="what-happens-when-you-sign-in"></a>Что происходит при входе
При первом входе сайт [azureiotsuite.com][lnk-azureiotsuite] определяет ваши уровни разрешений в зависимости от выбранного клиента Azure Active Directory (AAD) и подписки Azure.

1. Сначала сайт получает из Azure сведения о ваших клиентах AAD, чтобы заполнить список клиентов, который отображается рядом с вашим именем пользователя после входа. В настоящее время сайт может одновременно получать маркеры пользователя только для одного клиента. Поэтому, если вы переключитесь между клиентами в раскрывающемся списке в правом верхнем углу сайта, вам придется выполнить вход с указанием этого клиента, чтобы получить для него маркеры.
2. После этого сайт получает из Azure сведения о подписках, связанных с выбранным клиентом. Доступные подписки можно просмотреть при создании нового предварительно настроенного решения.
3. Наконец, сайт получает сведения о всех ресурсах в подписках и группах ресурсов, помеченных как предварительно настроенные решения, и заполняет элементы на домашней странице.

В следующих разделах описываются роли, которые позволяют управлять доступом к предварительно настроенным решениям.

## <a name="aad-roles"></a>Роли AAD
Роли AAD определяют возможность подготавливать предварительно настроенные решения и управлять пользователями в предварительно настроенных решениях.

Дополнительные сведения о ролях администратора в AAD см. в статье [Назначение ролей администратора в Azure AD][lnk-aad-admin]. В этой статье основное внимание уделяется ролям **глобального администратора**, а также **пользователя и члена домена**, которые используются в предварительно настроенных решениях.

**Глобальный администратор.** В одном клиенте AAD может быть несколько глобальных администраторов. Создавая клиент AAD, вы по умолчанию становитесь его глобальным администратором. Глобальный администратор может подготовить предварительно настроенное решение. В таком случае ему назначается роль **администратора** приложения в клиенте AAD. Однако если другой пользователь создаст приложение в том же клиенте AAD, глобальному администратору будет присвоена роль по умолчанию **Только чтение (неявно)**. Глобальные администраторы могут назначать роли приложений, используя [классический портал Azure][lnk-classic-portal].

**Пользователь или член домена.** На каждый клиент AAD может приходиться много пользователей или членов домена. Пользователь домена может подготовить предварительно настроенное решение на сайте [azureiotsuite.com][lnk-azureiotsuite]. Пользователю, который подготавливает приложение, назначается роль **администратора**этого приложения. Пользователь может создать приложение с помощью сценария build.cmd в репозитории [azure-iot-remote-monitoring][lnk-rm-github-repo] или [azure-iot-predictive-maintenance][lnk-pm-github-repo]. Но ему по умолчанию присваивается роль **Только чтение (неявно)**, так как он не имеет права назначать роли. Если другой пользователь в клиенте AAD создаст приложение, ему по умолчанию будет присвоена роль **Только чтение (неявно)** для этого приложения. Он не может назначать роли приложений (ни добавлять пользователей к ролям, ни присваивать пользователям роли приложения), даже если он подготовил это приложение.

**Гость или пользователь-гость.** В одном клиенте AAD может быть много гостей или пользователей-гостей. Пользователи-гости обладают ограниченным набором прав в клиенте AAD. Поэтому они не могут подготавливать предварительно настроенные решения в клиенте AAD.

Для получения дополнительных сведений см. следующие ресурсы:

* [Добавление новых пользователей или пользователей с учетными записями Майкрософт в Azure Active Directory][lnk-create-edit-users]
* [Основные сведения о манифесте приложения Azure Active Directory][lnk-assign-app-roles]

## <a name="azure-subscription-administrator-roles"></a>Роли администратора подписки Azure
Роли администратора Azure определяют возможность сопоставлять подписку Azure с клиентом AD.

Дополнительные сведения о ролях соадминистратора, администратора службы и администратора учетной записи в Azure см. в статье [How to add or change Azure Co-Administrator, Service Administrator and Account Administrator][lnk-admin-roles] (Добавление или изменение соадминистратора Azure, администратора службы и администратора учетной записи).

## <a name="application-roles"></a>Роли приложений
Роли приложения позволяют контролировать доступ к устройствам в рамках предварительно настроенного решения.

В приложении, которое создается при подготовке предварительно настроенного решения, существует две определенные и одна неявная роль.

* **Администратор.** Полный доступ для добавления, контроля и удаления устройств.
* **Только чтение.** Возможность просматривать устройства.
* **Только чтение (неявно).** То же самое, что "Только чтение", но эта роль присваивается всем пользователям клиента AAD. Эта роль была создана для удобства во время разработки. Эту роль можно удалить, изменив исходный файл [RolePermissions.cs][lnk-resource-cs].

### <a name="changing-application-roles-for-a-user"></a>Изменение ролей приложений для пользователя
Чтобы сделать пользователя в Active Directory администратором предварительно настроенного решения, можно выполнить описанную ниже процедуру.

Изменять роли пользователей может только глобальный администратор AAD.

1. Войдите на [классический портал Azure][lnk-classic-portal].
2. Выберите **Active Directory**.
3. Щелкните имя своего клиента Azure Active Directory (каталог, который вы выбрали на сайте azureiotsuite.com при подготовке решения).
4. Щелкните **Приложения**.
5. Щелкните имя приложения, совпадающее с именем предварительно настроенного решения. Если приложение отсутствует в списке, выберите для раскрывающегося списка **Показать** параметр **Приложения, которыми владеет моя компания** и установите флажок.
6. Выберите раздел **Пользователи**.
7. Выберите пользователя, для которого нужно изменить роли.
8. Щелкните **Назначить** и выберите роль (например, **Администратор**), которую нужно назначить пользователю, установив соответствующий флажок.

## <a name="faq"></a>Часто задаваемые вопросы
### <a name="im-a-service-administrator-and-id-like-to-change-the-directory-mapping-between-my-subscription-and-a-specific-aad-tenant-how-do-i-complete-this-task"></a>Я являюсь администратором службы и хочу изменить сопоставление каталогов подписки и конкретного клиента AAD. Как выполнить эту задачу?
1. Войдите на [классический портал Azure][lnk-classic-portal] и выберите пункт **Параметры** в списке служб слева.
2. Выберите подписку, для которой вы хотите изменить сопоставление каталогов.
3. Щелкните **Изменить каталог**.
4. Выберите в раскрывающемся списке **каталог** , который следует использовать. Щелкните стрелку «Далее».
5. Проверьте сопоставление каталога и соответствующих соадминистраторов. Обратите внимание, что при перемещении из другого каталога удаляются все соадминистраторы из исходного каталога.

### <a name="im-a-domain-usermember-on-the-aad-tenant-and-ive-created-a-preconfigured-solution-how-do-i-get-assigned-a-role-for-my-application"></a>Я являюсь пользователем (членом) домена в клиенте AAD и создаю предварительно настроенное решение. Как мне получить роль для своего приложения?
Попросите глобального администратора назначить вас глобальным администратором клиента AAD, чтобы вы могли самостоятельно назначать роли пользователям, или же попросите его назначить вам роль. Если вы хотите сменить клиент AAD, в котором развернуто ваше предварительно настроенное решение, см. следующий вопрос.

### <a name="how-do-i-switch-the-aad-tenant-my-remote-monitoring-preconfigured-solution-and-application-are-assigned-to"></a>Как сменить клиент AAD, которому назначены мое предварительно настроенное решение удаленного мониторинга и приложение?
Можно запустить развернутую облачную службу со страницы <https://github.com/Azure/azure-iot-remote-monitoring> и повторить развертывание в новом клиенте AAD. При создании клиента AAD вы по умолчанию назначаетесь глобальным администратором с разрешениями на добавление пользователей и назначение им ролей.

1. Создайте каталог AAD на [классическом портале Azure][lnk-classic-portal].
2. Перейдите на страницу <https://github.com/Azure/azure-iot-remote-monitoring>.
3. Выполните команду `build.cmd cloud [debug | release] {name of previously deployed remote monitoring solution}` (например, `build.cmd cloud debug myRMSolution`).
4. При появлении запроса задайте параметр **tenantid** для нового клиента вместо предыдущего клиента.

### <a name="i-want-to-change-a-service-administrator-or-co-administrator-when-logged-in-with-an-organisational-account"></a>Я хочу сменить администратора службы и соадминистратора при входе в систему с использованием учетной записи организации
См. справочную статью [Смена администратора службы и соадминистратора при входе в систему с использованием учетной записи организации][lnk-service-admins].

### <a name="why-am-i-seeing-this-error-your-account-does-not-have-the-proper-permissions-to-create-a-solution-please-check-with-your-account-administrator-or-try-with-a-different-account"></a>Почему появляется ошибка «У вашей учетной записи нет необходимых разрешений для создания решения. Обратитесь к администратору учетной записи или попробуйте использовать другую учетную запись»
Руководствуйтесь следующей схемой:

![][img-flowchart]

> [!NOTE]
> Вы выполнили проверку, которая подтверждает ваши права глобального администратора на клиенте AAD и соадминистратора подписки, но ошибка не устранена. В таком случае администратор учетной записи должен удалить этого пользователя и повторно назначить необходимые разрешения в указанном порядке. Сначала добавить пользователя в качестве глобального администратора, а затем — пользователя в качестве соадминистратора подписки Azure. Если проблемы не удается устранить, обратитесь в службу [справки и поддержки][lnk-help-support].
> 
> 

**Почему эта ошибка появляется при наличии подписки Azure?** *Для создания предварительно настроенных решений требуется подписка Azure. Вы можете создать бесплатную пробную учетную запись всего за несколько минут.*

Если точно известно, что у вас есть подписка Azure, проверьте сопоставление клиентов для своей подписки и убедитесь, что в раскрывающемся списке выбран правильный клиент. Если клиент выбран правильно, следуйте приведенной выше схеме и проверьте сопоставление подписки и этого клиента AAD.

## <a name="next-steps"></a>Дальнейшие действия
Чтобы продолжить изучение IoT Suite, см. статью [Настройка предварительно настроенного решения][lnk-customize].

[img-flowchart]: media/iot-suite-permissions/flowchart.png

[lnk-azureiotsuite]: https://www.azureiotsuite.com/
[lnk-rm-github-repo]: https://github.com/Azure/azure-iot-remote-monitoring
[lnk-pm-github-repo]: https://github.com/Azure/azure-iot-predictive-maintenance
[lnk-aad-admin]: https://azure.microsoft.com/documentation/articles/active-directory-assign-admin-roles/
[lnk-classic-portal]: https://manage.windowsazure.com/
[lnk-create-edit-users]: https://azure.microsoft.com/documentation/articles/active-directory-create-users/
[lnk-assign-app-roles]: https://azure.microsoft.com/documentation/articles/active-directory-application-manifest/
[lnk-service-admins]: https://azure.microsoft.com/support/changing-service-admin-and-co-admin/
[lnk-admin-roles]: https://azure.microsoft.com/documentation/articles/billing-add-change-azure-subscription-administrator/
[lnk-resource-cs]: https://github.com/Azure/azure-iot-remote-monitoring/blob/master/DeviceAdministration/Web/Security/RolePermissions.cs
[lnk-help-support]: https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade
[lnk-customize]: iot-suite-guidance-on-customizing-preconfigured-solutions.md

