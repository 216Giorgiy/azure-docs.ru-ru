<properties
  pageTitle="Azure IoT Suite и Azure Active Directory | Microsoft Azure"
  description="В этой статье описывается, как набор Azure IoT Suite использует Azure Active Directory для управления разрешениями."
  services=""
  suite="iot-suite"
  documentationCenter=""
  authors="aguilaaj"
  manager="timlt"
  editor=""/>

<tags
  ms.service="iot-suite"
  ms.devlang="na"
  ms.topic="article"
  ms.tgt_pltfrm="na"
  ms.workload="na"
  ms.date="03/02/2016"
  ms.author="araguila"/>
  
# Разрешения на сайте azureiotsuite.com

## Что происходит при входе

При первом входе сайт [azureiotsuite.com][lnk-azureiotsuite] определяет ваши уровни разрешений в зависимости от выбранного клиента Azure Active Directory (AAD) и подписки Azure.

1.  Сначала сайт получает из Azure сведения о ваших клиентах AAD, чтобы заполнить список клиентов, который отображается рядом с вашим именем пользователя после входа. Сейчас сайт может одновременно получать только маркеры пользователя для одного клиента. Поэтому, если вы выберете другой клиент в раскрывающемся списке в правом верхнем углу сайта, вам придется повторно выполнить вход с указанием этого клиента, чтобы получить для него маркеры.

2.  После этого сайт получает из Azure сведения о подписках, связанных с выбранным клиентом. Доступные подписки можно просмотреть при создании нового предварительно настроенного решения.

3.  Наконец, сайт получает сведения обо всех ресурсах в подписках и группах ресурсов, помеченных как предварительно настроенные решения, и заполняет плитки на домашней странице.

В следующих разделах описываются роли, которые позволяют управлять доступом к предварительно настроенным решениям.

## Роли AAD

Роли AAD определяют возможность подготавливать предварительно настроенные решения и управлять пользователями в предварительно настроенных решениях.

Дополнительные сведения о ролях администратора в AAD можно найти в статье [Назначение ролей администратора в Azure AD][lnk-aad-admin]. В этой статье основное внимание уделяется ролям **глобального администратора**, а также **пользователя и члена домена**, которые используются в заранее настроенных решениях.

**Глобальный администратор.** В одном клиенте AAD может быть несколько глобальных администраторов. Создавая клиент AAD, вы по умолчанию становитесь его глобальным администратором. Глобальный администратор может подготовить предварительно настроенное решение. В таком случае ему назначается роль **администратора** приложения в клиенте AAD. Однако если другой пользователь создаст приложение в том же клиенте AAD, глобальному администратору будет присвоена роль по умолчанию **Только чтение (неявно)**. Глобальные администраторы могут назначать роли приложений, используя [классический портал Azure][lnk-classic-portal].

**Пользователь или член домена.** На каждый клиент AAD может приходиться много пользователей или членов домена. Пользователь домена может подготовить предварительно настроенное решение на сайте [azureiotsuite.com][lnk-azureiotsuite]. Пользователю, который подготавливает приложение, назначается роль **администратора** этого приложения. Пользователь может создать приложение с помощью скрипта build.cmd в репозитории [azure-iot-solution][lnk-github-repo], но при этом ему по умолчанию присваивается роль **Только чтение (неявно)**, так как он не имеет права назначать роли. Если другой пользователь в клиенте AAD создаст приложение, ему по умолчанию будет присвоена роль **Только чтение (неявно)** для этого приложения. Он не может назначать роли приложения (ни добавлять пользователей к ролям, ни присваивать пользователям роли приложения), даже если он подготовил это приложение.

**Гость или пользователь-гость.** В одном клиенте AAD может быть много гостей или пользователей-гостей. Пользователи-гости обладают ограниченным набором прав в клиенте AAD. Поэтому они не могут подготавливать предварительно настроенные решения в клиенте AAD.

Для получения дополнительных сведений см. следующие ресурсы:

- [Создание и изменение пользователей в Azure AD][lnk-create-edit-users]
- [Назначение ролей приложения в AAD][lnk-assign-app-roles]

## Роли администратора подписки Azure

Роли администратора Azure определяют возможность сопоставлять подписку Azure с клиентом AAD.

Дополнительные сведения о ролях соадминистратора, администратора службы и администратора учетной записи в Azure см. в статье [Добавление или изменение соадминистратора Azure, администратора службы и администратора учетной записи][lnk-admin-roles].

## Роли приложений

Роли приложения позволяют контролировать доступ к устройствам в рамках предварительно настроенного решения.

В приложении, которое создается при подготовке предварительно настроенного решения, существует две определенные и одна неявная роль.

-   **Администратор.** Полный доступ для добавления, контроля и удаления устройств.

-   **Только чтение.** Возможность просматривать устройства.

-   **Только чтение (неявно).** То же самое, что «Только чтение», но эта роль присваивается всем пользователям клиента AAD. Это было сделано для удобства во время разработки. Эту роль можно удалить, изменив исходный файл [RolePermissions.cs][lnk-resource-cs].

### Изменение ролей приложений

Изменять роли пользователей может только глобальный администратор AAD.

1. Войдите на [классический портал Azure][lnk-classic-portal].

2. Выберите **Active Directory**.

3. Щелкните имя клиента AAD.

4. Щелкните **Приложения**.

5. Если приложение отсутствует в списке, выберите для списка **Показать** параметр **Приложения, которыми владеет моя компания** и установите флажок.

6. Щелкните имя приложения, совпадающее с именем предварительно настроенного решения.

7. Щелкните **Пользователи**.

8. Выберите пользователя, для которого нужно изменить роли.

9. Нажмите кнопку «Назначить» и выберите роль, которую вы хотите назначить, а затем установите флажок.

## Часто задаваемые вопросы

### Я являюсь администратором службы и хочу изменить сопоставление каталогов подписки и конкретного клиента AAD. Как это сделать?

1. Перейдите на [классический портал Azure][lnk-classic-portal] и выберите пункт **Параметры** в списке служб слева.

2. Выберите подписку, для которой вы хотите изменить сопоставление каталогов.

3. Щелкните **Изменить каталог**.

4. Выберите в раскрывающемся списке **каталог**, который следует использовать. Щелкните стрелку «Далее».

5. Проверьте сопоставление каталога и соответствующих соадминистраторов. Обратите внимание, что при перемещении из другого каталога удаляются все соадминистраторы из исходного каталога.

### Я являюсь пользователем (членом) домена в клиенте AAD и создаю предварительно настроенное решение. Как мне получить роль для своего приложения?

Попросите глобального администратора назначить вас глобальным администратором клиента AAD, чтобы вы могли самостоятельно назначать роли пользователям, или же попросите его назначить вам роль. Если вы хотите сменить клиент AAD, в котором развернуто ваше предварительно настроенное решение, см. следующий вопрос.

### Как сменить клиент AAD, которому назначены мое предварительно настроенное решение удаленного мониторинга и приложение?

Вы можете запустить развернутую облачную службу со страницы <https://github.com/Azure/azure-iot-remote-monitoring> и повторить развертывание в новом клиенте AAD. При создании нового клиента AAD вы по умолчанию назначаетесь глобальным администратором с правом на добавление пользователей и назначение им ролей.

1. Создайте новый каталог AAD на [портале управления Azure][lnk-classic-portal].

2. Перейдите на сайт <https://github.com/Azure/azure-iot-remote-monitoring>. Дополнительные сведения о развернутых облачных службах см. в статье [Развернутая облачная служба][lnk-wiki-clouddeployment].

3. Выполните команду `build.cmd cloud [debug | release] {name of previously deployed remote monitoring solution}` (например, `build.cmd cloud debug myRMSolution`).

4. При появлении запроса задайте параметр **tenantid** для нового клиента вместо предыдущего клиента.


### Я хочу сменить администратора службы и соадминистратора при входе в систему с использованием учетной записи организации

См. справочную статью [Смена администратора службы и соадминистратора при входе в систему с использованием учетной записи организации][lnk-service-admins].

### Почему появляется ошибка «У вашей учетной записи нет необходимых разрешений для создания решения. Обратитесь к администратору учетной записи или попробуйте использовать другую учетную запись»

Просмотрите следующую схему:

![][img-flowchart]

**Почему эта ошибка появляется при наличии подписки Azure?** *Для создания предварительно настроенных решений требуется подписка Azure. Вы можете создать бесплатную пробную учетную запись всего за несколько минут.*

Если точно известно, что у вас есть подписка Azure, проверьте сопоставление клиентов для своей подписки и убедитесь, что в раскрывающемся списке выбран правильный клиент. Если клиент выбран правильно, следуйте приведенной выше схеме и проверьте сопоставление подписки и этого клиента AAD.

[img-flowchart]: media/iot-suite-permissions/flowchart.png

[lnk-azureiotsuite]: https://www.azureiotsuite.com/
[lnk-github-repo]: https://github.com/Azure/azure-iot-solution
[lnk-aad-admin]: https://azure.microsoft.com/documentation/articles/active-directory-assign-admin-roles/
[lnk-classic-portal]: https://manage.windowsazure.com/
[lnk-create-edit-users]: https://azure.microsoft.com/documentation/articles/active-directory-create-users/
[lnk-assign-app-roles]: https://github.com/Azure/azure-iot-remote-monitoring/wiki/Manually-setting-up-roles-and-assigning-permissions-in-Azure-Active-Directory-(AAD)#assigning-users-to-the-roles
[lnk-service-admins]: https://azure.microsoft.com/support/changing-service-admin-and-co-admin/
[lnk-admin-roles]: https://azure.microsoft.com/documentation/articles/billing-add-change-azure-subscription-administrator/
[lnk-resource-cs]: https://github.com/Azure/azure-iot-remote-monitoring/blob/master/DeviceAdministration/Web/Security/RolePermissions.cs
[lnk-wiki-clouddeployment]: https://github.com/Azure/azure-iot-remote-monitoring/wiki/Cloud-deployment

<!---HONumber=AcomDC_0309_2016-->