.<properties
   pageTitle="Служба архивации Azure: резервное копирование виртуальных машин IaaS Azure с помощью зашифрованных дисков | Microsoft Azure"
   description="Узнайте, каким образом служба архивации Azure обрабатывает данные, зашифрованные с помощью BitLocker или dmcrypt, во время резервного копирования виртуальных машин IaaS. В этой статье рассматриваются различия в процессах резервного копирования и восстановления при работе с зашифрованным дисками."
   services="backup"
   documentationCenter=""
   authors="pallavijoshi"
   manager="vijayts"
   editor=""/>
<tags
   ms.service="backup"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="storage-backup-recovery"
   ms.date="08/16/2016"
   ms.author="markgal; jimpark; trinadhk"/>

# Работа с зашифрованными дисками в ходе процесса резервного копирования виртуальных машин

Предприятиям, которым требуется шифровать данные виртуальных машин в Azure, следует обратить внимание на использование [шифрования дисков Azure](../security/azure-security-disk-encryption.md) или Bitlocker на компьютерах с Windows или dmcrypt на компьютерах Linux.

> [AZURE.NOTE]  Служба архивации Azure поддерживает архивацию и восстановление виртуальных машин, зашифрованных с помощью шифрования дисков Azure (ADE). <br>
1. Эта возможность обеспечивается с помощью PowerShell, если виртуальная машина зашифрована с использованием BEK и KEK. <br>
2. Архивация и восстановление не поддерживаются, если виртуальная машина зашифрована только с помощью BEK. <br> Ознакомьтесь с [документацией по PowerShell](backup-azure-vms-automation.md) для службы архивации Azure, чтобы узнать об архивации и восстановлении виртуальных машин, зашифрованные с помощью ADE.

Эта статья посвящена виртуальным машинам Azure, зашифрованным с помощью CloudLink.

## Принцип действия архивации

Общее решение состоит из двух уровней — уровня виртуальной машины и уровня хранилища.

1. Уровень виртуальной машины связан с данными, как можно убедиться на примере гостевой операционной системы и приложений, выполняющихся на виртуальной машине. Это уровень, на котором выполняется программное обеспечение шифрования (Bitlocker или dmcrypt), которое прозрачно шифрует данные на томах перед их записью на диск.
2. Уровень хранения связан со страничными BLOB-объектами и дисками, подключенными к виртуальной машине. Он не имеет отношения к данным, записываемым на диск, а также к их шифрованию. Это тот уровень, на котором поддерживаются функциональные возможности резервного копирования виртуальной машины.

.![Сосуществование шифрования Bitlocker и резервного копирования виртуальных машин Azure](./media/backup-azure-vms-encryption/how-it-works.png)

На уровне виртуальной машины процесс полного шифрования данных происходит легко и прозрачно. Таким образом, данные, записанные в страничные BLOB-объекты, которые, в свою очередь, присоединены к виртуальной машине, являются зашифрованными. Когда [служба архивации Azure делает моментальный снимок дисков виртуальной машины и передает данные](backup-azure-vms-introduction.md#how-does-azure-back-up-virtual-machines), она копирует зашифрованные данные, находящиеся в страничных BLOB-объектах.

## Компоненты решения

Для надлежащей работы решения необходимо правильно настроить и контролировать целый ряд компонентов.

| Функция | Используемое программное обеспечение | Дополнительные замечания |
| -------- | ------------- | ------- |
| Шифрование | BitLocker или dmcrypt | Если проводить сравнение со службой архивации Azure, поскольку шифрование происходит на *другом* уровне, используемое для шифрования программное обеспечение не имеет значения. С другой стороны, этот процесс был проверен только с помощью CloudLink посредством Bitlocker и dmcrypt.<br><br> Для шифрования данных требуется ключ. Чтобы обеспечить авторизованный доступ к данным, ключ должен храниться в безопасном месте. |
| Управление ключами | CloudLink SecureVM | Ключ является важным элементом для шифрования или расшифровки данных. Без соответствующего ключа получить данные будет невозможно. Это становится *особенно* важно в следующих случаях:<br><li>смена ключей<li>долгосрочное хранение<br><br>Например, ключ, который использовался для резервного копирования данных 7 лет назад, может отличаться от ключа, используемого в настоящее время. Без ключа семилетней давности будет невозможно использовать данные, восстанавливаемые с того времени.|
| Резервное копирование данных | Служба архивации Azure | Использование службы архивации Azure для резервного копирования виртуальных машин IaaS Azure с помощью [портала управления Azure](http://manage.windowsazure.com) или PowerShell |
| Восстановление данных | Служба архивации Azure | Использование службы архивации Azure для восстановления дисков или всей виртуальной машины из точки восстановления. В ходе процесса восстановления служба архивации Azure не выполняет расшифровку данных.|
| Расшифровка | BitLocker или dmcrypt | Для чтения данных с диска с восстановительными данными или из восстановленной виртуальной машины программному обеспечению требуется ключ из ПО управления ключами. Без соответствующего ключа расшифровать данные будет невозможно. |

> [AZURE.IMPORTANT]  Управление ключами (включая смену ключей) не входит в процедуру резервного копирования Azure. Этот аспект должен управляться отдельно и имеет очень важное значение в рамках общей операции резервного копирования и восстановления.

### Поддерживаемые сценарии


| &nbsp; | Хранилище архивации | Хранилище служб восстановления |
| :-- | :-- | :-- |
| Виртуальные машины Azure IaaS V1 | Да | Нет |
| Виртуальные машины Azure IaaS V2 | Недоступно | Нет |


## CloudLink SecureVM

[CloudLink SecureVM](http://www.cloudlinktech.com/choose-your-cloud/microsoft-azure/) — это решение шифрования виртуальной машины, которое можно использовать для защиты данных виртуальной машины IaaS Azure. CloudLink SecureVM поддерживается для использования со службой архивации Azure.

### Сведения о поддержке

- CloudLink SecureVM версии 4.0 (сборка 21536.121 или более поздняя)
- Azure PowerShell версии 0.9.8 или более поздней

### Управление ключами

Если необходимо сменить или изменить ключи для виртуальных машин, имеющих существующие резервные копии, необходимо обеспечить доступность ключей, используемых во время операции резервного копирования. Один из способов — создание резервной копии хранилища ключей или всей системы SecureVM.

### Документация и ресурсы

- [Руководство по развертыванию (PDF)](http://www.cloudlinktech.com/Azure/CL_SecureVM_4_0_DG_EMC_Azure_R2.pdf)
- [Развертывание и использование SecureVM (видеоролик)](https://www.youtube.com/watch?v=8AIRe92UDNg)

<!---HONumber=AcomDC_0817_2016-->