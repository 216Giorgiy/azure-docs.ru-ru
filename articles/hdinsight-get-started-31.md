<properties linkid="manage-services-hdinsight-get-started-hdinsight-hadoop-3.0" urlDisplayName="Get Started" pageTitle="Get started using Hadoop in HDInsight | Azure" metaKeywords="" description="Get started using Hadoop in HDInsight, a big data solution. Learn how to provision clusters, run hive jobs, and output data to Excel for analysis." metaCanonical="" services="hdinsight" documentationCenter="" title="Get started using Hadoop in HDInsight" authors="jgao" solutions="" manager="paulettm" editor="cgronlun" />

<tags ms.service="hdinsight" ms.workload="big-data" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="jgao" />

# Приступая к работе с Hadoop 2.4 в HDInsight (предварительная версия)

<div class="dev-center-tutorial-selector sublanding">
<a href="../hdinsight-get-started" title="Начало работы с Hadoop 2.2 в HDInsight">Hadoop 2.2</a>
<a href="../hdinsight-get-started-31" title="Начало работы с Hadoop 2.4 в HDInsight" class="current">Hadoop 2.4</a>
<a href="../hdinsight-get-started-21" title="Приступая к работе с Hadoop 1.2 в HDInsight">Hadoop 1.2</a>
</div>

HDInsight обеспечивает доступность [Apache Hadoop][Apache Hadoop] как службы в облаке. Благодаря этому платформа программного обеспечения MapReduce доступна в более простой, более масштабируемой и экономически эффективной среде Azure. Кроме того, HDInsight предоставляет экономически эффективный подход к управлению данными и их хранению с использованием хранилища BLOB-объектов Azure.

В этом учебнике вы будете заниматься подготовкой кластера Hadoop в HDInsight с помощью портала управления Azure, отправкой задания Hive для запроса простой таблицы Hive с использованием панели мониторинга кластера HDInsight и импортом выходных данных задания Hive в Excel для анализа.

> [WACOM.NOTE] В этом учебнике описывается использование кластеров Hadoop 2.4 в HDInsight (предварительная версия). Для доступа к другим поддерживаемым версиям щелкните средство выбора в верхней части страницы. Для получения информации о версиях см. раздел [Новые возможности версий кластеров, предоставляемых HDInsight.][Новые возможности версий кластеров, предоставляемых HDInsight.]

Демонстрация статьи в режиме реального времени:

<center>
[![HDI.getstarted.video][img-hdi-getstarted-video]][]

</center>
Наряду с выпуском общедоступной версии Azure HDInsight корпорация Майкрософт выпустила также эмулятор HDInsight для Azure, ранее известный как *Microsoft HDInsight Developer Preview*. Этот продукт предназначен для сценариев разработки и поэтому поддерживает только развертывания на одном узле. Сведения об использовании эмулятора HDInsight см. в руководстве [Приступая к работе с эмулятором HDInsight][Приступая к работе с эмулятором HDInsight].

**Предварительные требования:**

Перед началом работы с этим учебником необходимо иметь следующее:

-   Подписка Azure. Дополнительные сведения о получении подписки см. в разделах [Варианты приобретения][Варианты приобретения], [Предложения для участников][Предложения для участников] или [Бесплатное пробное использование][Бесплатное пробное использование].
-   Компьютер с Office 2013 профессиональный плюс, Office 365 профессиональный плюс, Excel 2013 автономный или Office 2010 профессиональный плюс.
-   Заметки о последних выпусках HDInsight см. в разделе [Заметки о выпуске HDInsight][Заметки о выпуске HDInsight].

<b>Предполагаемое время выполнения:</b> 30 минут

## В этом учебнике рассматриваются следующие темы:

-   [Подготовка кластера HDInsight][Подготовка кластера HDInsight]
-   [Запуск задания Hive][Запуск задания Hive]
-   [Подключение к средствам бизнес-аналитики Microsoft][Подключение к средствам бизнес-аналитики Microsoft]
-   [Дальнейшие действия][Дальнейшие действия]

## <a name="provision"></a>Подготовка кластера HDInsight

HDInsight использует для хранения данных хранилище BLOB-объектов Azure. Оно называется *WASB* или *Хранилище Azure — BLOB-объекты*. WASB — это реализация HDFS на базе хранилища BLOB-объектов Azure от корпорации Майкрософт. Дополнительные сведения см. в разделе [Использование хранилища BLOB-объектов Azure с HDInsight][Использование хранилища BLOB-объектов Azure с HDInsight].

В процессе подготовки кластера HDInsight в качестве файловой системы по умолчанию устанавливаются учетная запись хранения Azure и конкретный контейнер хранилища BLOB-объектов из этой учетной записи, так же как и в HDFS. Учетная запись хранения должна находиться в том же центре обработки данных, что и вычислительные ресурсы HDInsight. В настоящее время можно подготовить только кластеры HDInsight в следующих центрах обработки данных:

-   Юго-Восточная Азия
-   Северная Европа
-   Западная Европа
-   Восток США
-   Запад США

Помимо этой учетной записи хранения в процессе подготовки можно добавить дополнительные учетные записи хранения из той же подписки Azure или других подписок Azure. Инструкции по добавлению дополнительных учетных записей хранения см. в разделе [Подготовка кластеров HDInsight][Подготовка кластеров HDInsight].

Чтобы упростить этот учебник, используются только контейнер BLOB-объектов по умолчанию и учетная запись хранения по умолчанию, а все файлы сохраняются в контейнере файловой системы по умолчанию, расположенной в: */tutorials/getstarted/*. На практике файлы данных обыкновенно хранятся в заданной учетной записи хранения.

**Создание учетной записи хранения Azure**

1.  Выполните вход на [портал управления Azure][портал управления Azure].
2.  Щелкните **СОЗДАТЬ** в левом нижнем углу, выберите **СЛУЖБЫ ДАННЫХ**, **ХРАНИЛИЩЕ**, а затем щелкните **БЫСТРО СОЗДАТЬ**.

    ![HDI.StorageAccount.QuickCreate][HDI.StorageAccount.QuickCreate]

3.  Введите сведения в поля **URL-АДРЕС**, **РАСПОЛОЖЕНИЕ** и **РЕПЛИКАЦИЯ**, а затем щелкните **СОЗДАТЬ УЧЕТНУЮ ЗАПИСЬ ХРАНЕНИЯ**. Территориальные группы не поддерживаются. Вы увидите новую учетную запись хранения в списке хранилищ.
4.  Дождитесь, пока **СОСТОЯНИЕ** новой учетной записи хранения не изменится на **В сети**.
5.  Щелкните новую учетную запись хранения в списке, чтобы выбрать ее.
6.  Щелкните **УПРАВЛЕНИЕ КЛЮЧАМИ ДОСТУПА** в нижней части страницы.
7.  Запишите **ИМЯ УЧЕТНОЙ ЗАПИСИ ХРАНЕНИЯ** и **ПЕРВИЧНЫЙ КЛЮЧ ДОСТУПА**(или **ВТОРИЧНЫЙ КЛЮЧ ДОСТУПА**. Будет работать любой из ключей). Они потребуются позже в данном руководстве.

Подробные инструкции см. в разделах
[Как создать учетную запись хранения][Как создать учетную запись хранения] и [Использование хранилища BLOB-объектов Azure с HDInsight][Использование хранилища BLOB-объектов Azure с HDInsight].

**Подготовка кластера HDInsight**

1.  Выполните вход на [портал управления Azure][портал управления Azure].

2.  Щелкните **HDINSIGHT** слева от списка, чтобы просмотреть список кластеров HDInsight в вашей учетной записи. На следующем снимке экрана кластер HDInsight отсутствует.

    ![HDI.ClusterStatus][HDI.ClusterStatus]

3.  Щелкните **СОЗДАТЬ** в левой нижней части, выберите **СЛУЖБЫ ДАННЫХ**, **HDINSIGHT**, а затем щелкните **УПРАВЛЯЕМОЕ СОЗДАНИЕ**.

    ![HDI.CustomCreateCluster][HDI.CustomCreateCluster]

4.  На вкладке "Сведения о кластере" введите или выберите следующие значения:

    | Имя                  | Значение                                                                                                                                                                                                                                                                                              |
    |----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **Имя кластера,**    | Имя кластера.                                                                                                                                                                                                                                                                                         |
    | **Узлы данных**      | Число узлов данных, которые требуется развернуть. В рамках тестирования создайте кластер с одним узлом.                                                                                                                                                                                               
                            Максимальный размер кластера зависит от подписки Azure. Обратитесь в службу поддержки Azure по вопросам выставления счетов для увеличения лимита.                                                                                                                                                      |
    | **Версия HDInsight** | Выберите **3.1**, чтобы создать кластер Hadoop 2.4 в HDInsight.                                                                                                                                                                                                                                       |
    | **Регион**           | Выберите тот же регион, что и для учетной записи хранения, созданной в предыдущей процедуре. HDInsight требует размещения учетной записи хранения в том же регионе. При последующей настройке можно выбрать только учетную запись хранения, которая находится в том же регионе, который указан здесь. |

5.  Щелкните стрелку вправо в нижнем правом углу, чтобы настроить пользователя кластера.
6.  На вкладке настройки пользователя кластера введите **Имя пользователя** и **Пароль** для учетной записи пользователя кластера HDInsight. В дополнение к этой учетной записи можно создать учетную запись пользователя RDP после подготовки кластера, чтобы к нему можно было подключиться с помощью удаленного рабочего стола. Указания см. в разделе [Администрирование HDInsight с использованием портала управления][hdinsight-admin-portal]
7.  Щелкните стрелку вправо в нижнем правом углу, чтобы настроить учетную запись хранения.
8.  На вкладке "Учетная запись хранения" введите или выберите следующие значения:

    | Имя                                    | Значение                                                                                                                                                                          |
    |----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | УЧЕТНАЯ ЗАПИСЬ ХРАНЕНИЯ                | Выберите **Использовать существующее хранилище**. Также имеется возможность для создания новой учетной записи хранения из портала управления, если вы еще не создали ее.          |
    | ИМЯ УЧЕТНОЙ ЗАПИСИ                     | Укажите учетную запись хранения, созданную в последней процедуре данного учебника. Обратите внимание, что в списке отображаются только учетные записи хранения из одного региона. |
    | КОНТЕЙНЕР ПО УМОЛЧАНИЮ                 | Выберите **Создать контейнер по умолчанию**. При выборе этого параметра имя контейнера по умолчанию совпадает с именем кластера.                                                  |
    | ДОПОЛНИТЕЛЬНЫЕ УЧЕТНЫЕ ЗАПИСИ ХРАНЕНИЯ | Используйте **0**. Имеется возможность подключения кластера к 7 дополнительным учетным записям хранения.                                                                          |

9.  Щелкните значок галочки в правом нижнем углу, чтобы создать кластер. После завершения процесса подготовки в столбце состояния будет отображаться **Выполняется**.

## <a name="sample"></a>Запуск задания Hive

Теперь у вас есть подготовленный кластер HDInsight. На следующем шаге выполняется задание Hive для запроса примера таблицы Hive, которая поставляется вместе с кластерами HDInsight. Имя таблицы: *hivesampletable*.

**Чтобы открыть панель мониторинга кластера HDInsight**

1.  Выполните вход на [портал управления Azure][портал управления Azure].
2.  На левой панели щелкните **HDINSIGHT**. Вы увидите список созданных кластеров, включая только что созданный в последнем разделе.
3.  Щелкните имя кластера, в котором вы хотите запустить задание Hive.
4.  Щелкните **УПРАВЛЕНИЕ КЛАСТЕРОМ** внизу страницы, чтобы открыть панель мониторинга кластера HDInsight. В новой вкладке браузера откроется веб-страница.
5.  Введите имя пользователя и пароль учетной записи Hadoop. По умолчанию имя пользователя **admin**, пароль вы вводили в процессе подготовки. Панель мониторинга имеет следующий вид:

    ![hdi.dashboard][hdi.dashboard]

    В верхней части имеются несколько вкладок. Вкладка по умолчанию *Редактор Hive*, в число других вкладок входят Задания и Файлы. С помощью панели мониторинга можно отправлять запросы Hive, проверять журналы заданий Hadoop и просматривать файлы WASB.

> [wacom.note] обратите внимание на URL-адрес: *\<ClusterName\>.azurehdinsight.net*. Таким образом, вместо открывания панели мониторинга с портала управления, можно открыть ее из веб-браузера, используя этот URL-адрес.

**Чтобы выполнить запрос Hive**

1.  В верхней части панели мониторинга кластера HDInsight щелкните **Редактор Hive**.
2.  В поле **Имя запроса** введите **HTC20**. Имя запроса представляет собой название задания.
3.  В панели запросов введите следующий запрос:

        SELECT * FROM hivesampletable
            WHERE devicemake LIKE "HTC%"
            LIMIT 20;

    ![hdi.dashboard.query.select][hdi.dashboard.query.select]

4.  Нажмите кнопку **Submit** (Отправить). На получение результатов уходит несколько минут. Экран обновляется каждые 30 секунд. Чтобы обновить экран, можно также нажать кнопку **Обновить**.

    После завершения экран будет выглядеть следующим образом:

    ![hdi.dashboard.query.select.result][hdi.dashboard.query.select.result]

    Отметьте **Время запуска задания (формат UTC)**. Оно понадобится вам позднее.

    Прокрутите вниз еще немного и вы увидите **Журнал заданий**. Выход задания — stdout, журнал заданий — stderr.

5.  При необходимости снова открыть файл журнала, можно щелкнуть **Задания** в верхней части экрана, а затем щелкнуть название задания (имя запроса). Например, **HTC20** в данном случае.

**Для просмотра файла с результатами**

1.  В верхней части панели мониторинга кластера HDInsight щелкните **Файлы**.
2.  Щелкните **Templeton-Job-Status**.
3.  Щелкните номер GUID, у которого указано самое последнее время изменения, чуть больше времени запуска задания, которые вы записали ранее. Запишите этот GUID. Он понадобится в следующем разделе.
4.  В файле **stdout** содержатся данные, которые потребуются в следующем разделе. Вы можете щелкнуть **stdout** для загрузки копии данных, если хотите.

## <a name="powerquery"></a>Подключение к средствам бизнес-аналитики Microsoft

С помощью надстройки Power Query для Excel можно экспортировать выходные данные из HDInsight в Excel, где для их дальнейшей обработки и графического представления результатов могут использоваться средства бизнес-аналитики Microsoft (Business Intelligence — BI).

Для выполнения действий из этой части учебника требуется Excel 2010 или Excel 2013.

**Загрузка Microsoft Power Query для Excel**

-   Загрузите Microsoft Power Query для Excel из [Центра загрузки Майкрософт][Центра загрузки Майкрософт] и установите.

**Чтобы импортировать данные HDInsight, выполните следующие действия:**

1.  Откройте Excel и создайте новую пустую книгу.
2.  Щелкните меню **Power Query**, выберите **Из других источников**, а затем щелкните **Из Windows Azure HDInsight**.

    ![HDI.GettingStarted.PowerQuery.ImportData][HDI.GettingStarted.PowerQuery.ImportData]

3.  Введите **Имя учетной записи** учетной записи хранилища BLOB-объектов Azure, связанной с вашим кластером, и нажмите кнопку **ОК**. Это учетная запись хранения, созданная вами ранее в этом учебнике.
4.  Введите **Ключ учетной записи** для учетной записи хранилища BLOB-объектов Azure, а затем нажмите кнопку **Сохранить**.
5.  В области навигатора в правой части окна дважды щелкните имя контейнера хранилища BLOB-объектов. По умолчанию имя контейнера совпадает с именем кластера.

6.  Найдите **stdout** в столбце **Имя** (путь — *.../Templeton-Job-Status/<guid>*), а затем щелкните **Двоичный** слева от **stdout**. <guid> должен соответствовать тому, который вы записали в последнем разделе.

    ![HDI.GettingStarted.PowerQuery.ImportData2][HDI.GettingStarted.PowerQuery.ImportData2]

7.  Щелкните **Применить и закрыть** в левом верхнем углу. Этот запрос импортирует выход таблицы Hive в Excel.

## <a name="nextsteps"></a>Дальнейшие действия

Из этого учебника вы узнали, как подготовить кластер с помощью HDInsight, запустить на нем задание MapReduce и импортировать результаты в Excel для дальнейшей обработки и отображения с использованием средств бизнес-аналитики. Для получения дополнительных сведений ознакомьтесь со следующими статьями:

-   [Приступая к работе с эмулятором HDInsight][Приступая к работе с эмулятором HDInsight]
-   [Использование хранилища BLOB-объектов Azure с HDInsight][Использование хранилища BLOB-объектов Azure с HDInsight]
-   [Администрирование HDInsight с использованием PowerShell][Администрирование HDInsight с использованием PowerShell]
-   [Отправка данных в HDInsight][Отправка данных в HDInsight]
-   [Использование MapReduce с HDInsight][Использование MapReduce с HDInsight]
-   [Использование Hive с HDInsight][Использование Hive с HDInsight]
-   [Использование Pig с HDInsight][Использование Pig с HDInsight]
-   [Использование Oozie с HDInsight][Использование Oozie с HDInsight]
-   [Разработка программ потоковой передачи Hadoop на C# для HDInsight][Разработка программ потоковой передачи Hadoop на C# для HDInsight]
-   [Разработка программ MapReduce на Java для HDInsight][Разработка программ MapReduce на Java для HDInsight]

  [Apache Hadoop]: http://hadoop.apache.org/
  [Новые возможности версий кластеров, предоставляемых HDInsight.]: ../hdinsight-component-versioning/
  [![HDI.getstarted.video][img-hdi-getstarted-video]]: https://www.youtube.com/watch?v=Y4aNjnoeaHA&list=PLDrz-Fkcb9WWdY-Yp6D4fTC1ll_3lU-QS
  [Приступая к работе с эмулятором HDInsight]: ../hdinsight-get-started-emulator/
  [Варианты приобретения]: http://azure.microsoft.com/ru-ru/pricing/purchase-options/
  [Предложения для участников]: http://azure.microsoft.com/ru-ru/pricing/member-offers/
  [Бесплатное пробное использование]: http://azure.microsoft.com/ru-ru/pricing/free-trial/
  [Заметки о выпуске HDInsight]: http://azure.microsoft.com/ru-ru/documentation/articles/hdinsight-release-notes/
  [Подготовка кластера HDInsight]: #provision
  [Запуск задания Hive]: #sample
  [Подключение к средствам бизнес-аналитики Microsoft]: #powerquery
  [Дальнейшие действия]: #nextsteps
  [Использование хранилища BLOB-объектов Azure с HDInsight]: ../hdinsight-use-blob-storage/
  [Подготовка кластеров HDInsight]: ../hdinsight-provision-clusters/
  [портал управления Azure]: https://manage.windowsazure.com/
  [HDI.StorageAccount.QuickCreate]: ./media/hdinsight-get-started/HDI.StorageAccount.QuickCreate.png
  [Как создать учетную запись хранения]: ../storage-create-storage-account/
  [HDI.ClusterStatus]: ./media/hdinsight-get-started/HDI.ClusterStatus.png
  [HDI.CustomCreateCluster]: ./media/hdinsight-get-started/HDI.CustomCreateCluster.png
  [hdi.dashboard]: ./media/hdinsight-get-started/HDI.dashboard.png
  [hdi.dashboard.query.select]: ./media/hdinsight-get-started/HDI.dashboard.query.select.png
  [hdi.dashboard.query.select.result]: ./media/hdinsight-get-started/HDI.dashboard.query.select.result.png
  [Центра загрузки Майкрософт]: http://www.microsoft.com/ru-ru/download/details.aspx?id=39379
  [HDI.GettingStarted.PowerQuery.ImportData]: ./media/hdinsight-get-started/HDI.GettingStarted.PowerQuery.ImportData.png
  [HDI.GettingStarted.PowerQuery.ImportData2]: ./media/hdinsight-get-started/HDI.GettingStarted.PowerQuery.ImportData2.png
  [Администрирование HDInsight с использованием PowerShell]: ../hdinsight-administer-use-powershell/
  [Отправка данных в HDInsight]: ../hdinsight-upload-data/
  [Использование MapReduce с HDInsight]: ../hdinsight-use-mapreduce
  [Использование Hive с HDInsight]: ../hdinsight-use-hive/
  [Использование Pig с HDInsight]: ../hdinsight-use-pig/
  [Использование Oozie с HDInsight]: ../hdinsight-use-oozie/
  [Разработка программ потоковой передачи Hadoop на C# для HDInsight]: ../hdinsight-hadoop-develop-deploy-streaming-jobs/
  [Разработка программ MapReduce на Java для HDInsight]: ../hdinsight-develop-deploy-java-mapreduce/
