---
title: Получение доступа и аутентификация без входа в Azure Logic Apps | Документация Майкрософт
description: Создайте управляемое удостоверение, чтобы приложение логики могло выполнить аутентификацию и получить доступ к ресурсам в других клиентах Azure Active Directory (Azure AD) без учетных данных.
author: kevinlam1
ms.author: klam
ms.reviewer: estfan, LADocs
services: logic-apps
ms.service: logic-apps
ms.suite: integration
ms.topic: article
ms.date: 09/24/2018
ms.openlocfilehash: fb1c31e6e7c075e20191a4e51d7b1a9323f3b979
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2018
ms.locfileid: "46973972"
---
# <a name="access-resources-and-authenticate-as-managed-identities-in-azure-logic-apps"></a>Получение доступа к ресурсам и аутентификация с использованием управляемых удостоверений в Azure Logic Apps

Чтобы получить доступ к ресурсам в других клиентах Azure Active Directory (Azure AD) и выполнить аутентификацию идентификатора без входа, можно создать [управляемое удостоверение](../active-directory/managed-identities-azure-resources/overview.md), которое приложение логики будет использовать вместо учетных данных. Azure управляет этим удостоверением за вас и помогает защитить учетные данные, потому что вам не нужно предоставлять или сменять секреты. В этой статье показано, как создать и использовать управляемое удостоверение для приложения логики. Дополнительные сведения см. в статье об [управлении удостоверениями для ресурсов Azure](../app-service/app-service-managed-service-identity.md).

> [!NOTE]
> Управляемые удостоверения для ресурсов Azure — это замена имени службы "Управляемое удостоверение службы" (MSI).

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще ее нет, <a href="https://azure.microsoft.com/free/" target="_blank">зарегистрируйтесь для получения бесплатной учетной записи Azure</a>.

* Приложение логики, в котором необходимо использовать управляемое удостоверение. Если у вас нет приложения логики, ознакомьтесь с кратким руководством [Создание первого автоматизированного рабочего процесса с помощью Azure Logic Apps на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md).

<a name="create-identity"></a>

## <a name="create-managed-identity"></a>Создание управляемого удостоверения

Управляемое удостоверение для приложения логики можно включить или создать с помощью портала Azure, Azure PowerShell или шаблонов Azure Resource Manager. 

### <a name="azure-portal"></a>Портал Azure

Чтобы создать управляемое удостоверение для приложения логики на портале Azure, включите параметр **Зарегистрировать в Azure Active Directory** в параметрах рабочего процесса приложения логики.

1. На [портале Azure](https://portal.azure.com) откройте приложение логики в конструкторе приложений логики.

1. Выполните следующие действия. 

   1. В меню приложения логики в разделе **Параметры** выберите **Параметры рабочего процесса**. 

   1. В разделе **Управляемое удостоверение службы** > 
   **Зарегистрировать в Azure Active Directory** выберите **Вкл.**

   1. Когда все будет готово, щелкните **Сохранить** на панели инструментов.

      ![Включение параметра управляемого удостоверения](./media/create-managed-service-identity/turn-on-managed-service-identity.png)

      Теперь в Azure отображаются эти свойства и значения для управляемого удостоверения приложения логики:

      ![Уникальные идентификаторы GUID для идентификатора субъекта и идентификатора клиента](./media/create-managed-service-identity/principal-tenant-id.png)

      | Свойство | Значение | ОПИСАНИЕ | 
      |----------|-------|-------------| 
      | **Идентификатор субъекта** | <*GUID для идентификатора субъекта*> | Глобальный уникальный идентификатор (GUID), который представляет приложение логики в клиенте Azure AD | 
      | **Идентификатор клиента** | <*GUID для идентификатора клиента Azure AD*> | Глобальный уникальный идентификатор (GUID), представляющий клиент Azure AD, участником которого является приложение логики. В клиенте Azure AD субъект-служба имеет то же имя, что и экземпляр приложения логики. | 
      ||| 

### <a name="deployment-template"></a>Шаблон развертывания

Чтобы автоматизировать создание и развертывание таких ресурсов Azure, как приложения логики, можно настроить шаблоны Azure Resource Manager. Дополнительные сведения см. в статье [Создание и развертывание приложений логики с помощью шаблонов Azure Resource Manager](../logic-apps/logic-apps-create-deploy-azure-resource-manager-templates.md). 

Чтобы создать управляемое удостоверение для приложения логики с помощью шаблона, добавьте элемент **identity** и свойство **type** в определение рабочего процесса приложения логики в шаблоне развертывания. Эти параметры указывают, что Azure создает эти удостоверения приложения логики и управляет ими:

```json
"identity": {
    "type": "SystemAssigned"
}
```

Например, приложение логики для этой версии может выглядеть следующим образом:

```json
{
   "apiVersion": "2016-06-01", 
   "type": "Microsoft.logic/workflows", 
   "name": "[variables('logicappName')]", 
   "location": "[resourceGroup().location]", 
   "identity": { 
      "type": "SystemAssigned" 
   }, 
   "properties": { 
      "definition": { 
         "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#", 
          "actions": {}, 
          "parameters": {}, 
          "triggers": {}, 
          "contentVersion": "1.0.0.0", 
          "outputs": {} 
     }, 
     "parameters": {}, 
     "dependsOn": [] 
}
```

Когда Azure создает приложение логики, определение рабочего процесса приложения логики содержит такие дополнительные свойства:

```json
"identity": {
    "type": "SystemAssigned",
    "principalId": "<principal-ID-GUID>",
    "tenantId": "<Azure-AD-tenant-ID>-GUID"
}
```

| Свойство | Значение | ОПИСАНИЕ | 
|----------|-------|-------------|
| **principalId** | <*GUID для идентификатора субъекта*> | Глобальный уникальный идентификатор (GUID), который представляет приложение логики в клиенте Azure AD | 
| **tenantId** | <*GUID для идентификатора клиента Azure AD*> | Глобальный уникальный идентификатор (GUID), представляющий клиент Azure AD, участником которого является приложение логики. В клиенте Azure AD субъект-служба имеет то же имя, что и экземпляр приложения логики. | 
||| 

<a name="access-other-resources"></a>

## <a name="access-resources-with-managed-identity"></a>Получение доступа к ресурсам с помощью управляемого удостоверения

После создания управляемого удостоверения для приложения логики [удостоверению можно предоставить доступ к другим ресурсам](../active-directory/managed-identities-azure-resources/howto-assign-access-portal.md). Затем управляемое удостоверение можно использовать для аутентификации так же, как и любой другой [субъект-службу](../active-directory/develop/app-objects-and-service-principals.md). 

Предположим, вы уже настроили приложение логики с управляемым удостоверением, которое предоставляет доступ к другому ресурсу. Теперь можно добавить действие HTTP для того, чтобы приложение логики могло отправить HTTP-запрос или вызов к этому ресурсу. 

1. Добавьте действие **HTTP** в приложение логики. 

1. Предоставьте необходимые сведения для этого действия, такие как **метод** запроса и расположение **URI** ресурса, который необходимо вызвать.

1. В действии HTTP выберите **Показать расширенные параметры**. 

1. В списке **Проверка подлинности** выберите **Управляемое удостоверение службы**, после чего отобразится свойство **Аудитория**, которое необходимо задать:

   ![Выбор "Управляемое удостоверение службы"](./media/create-managed-service-identity/select-managed-service-identity.png)

1. Продолжите создание приложения логики нужным образом.

<a name="remove-identity"></a>

## <a name="remove-managed-identity"></a>Удаление управляемого удостоверения

Чтобы отключить управляемое удостоверение приложения логики, выполните шаги как при создании идентификатора с помощью портала Azure, Azure PowerShell или шаблонов развертывания Azure Resource Manager. 

При удалении приложения логики Azure автоматически удаляет присвоенный системой идентификатор приложения логики из Azure AD.

### <a name="azure-portal"></a>Портал Azure

1. Откройте приложение логики в конструкторе Logic App.

1. Выполните следующие действия. 

   1. В меню приложения логики в разделе **Параметры** выберите **Параметры рабочего процесса**. 
   
   1. В разделе **Управляемое удостоверение службы** выберите **Выкл.** для свойства **Зарегистрировать в Azure Active Directory**.

   1. Когда все будет готово, щелкните **Сохранить** на панели инструментов.

      ![Отключение параметра управляемого удостоверения](./media/create-managed-service-identity/turn-off-managed-service-identity.png)

### <a name="deployment-template"></a>Шаблон развертывания

Если вы создали управляемое удостоверение приложения логики с помощью шаблона развертывания Azure Resource Manager, задайте свойству `"type"` элемента `"identity"` значение `"None"`. Это действие также удаляет идентификатор участника из Azure AD. 

```json
"identity": {
    "type": "None"
}
```

## <a name="get-support"></a>Получение поддержки

* Если у вас возникли вопросы, то посетите [форум Azure Logic Apps](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps).
* Отправить идею по поводу возможности или проголосовать за нее вы можете на [сайте отзывов пользователей Logic Apps](http://aka.ms/logicapps-wish).
