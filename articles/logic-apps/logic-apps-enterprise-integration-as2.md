---
title: "Создание соглашения AS2 в Azure Logic Apps | Документация Майкрософт"
description: "Создание соглашения AS2 для Пакета интеграции Enterprise | Azure Logic Apps"
services: logic-apps
documentationcenter: .net,nodejs,java
author: MandiOhlinger
manager: anneta
editor: 
ms.assetid: c9b7e1a9-4791-474c-855f-988bd7bf4b7f
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/27/2017
ms.author: mandia
translationtype: Human Translation
ms.sourcegitcommit: 6a947ea997bbcfe1b6b28c7cbb49911836750e6a
ms.openlocfilehash: a490b89c5420aecdfb3f79289979faab9a4630e9


---
# <a name="enterprise-integration-with-as2"></a>Интеграция Enterprise с AS2
Чтобы использовать корпоративные компоненты в приложениях логики, необходимо сначала создать соглашения.

## <a name="prerequisites"></a>Предварительные требования
* В подписке Azure должна быть определена [учетная запись интеграции](../logic-apps/logic-apps-enterprise-integration-accounts.md).  
* В учетной записи интеграции должны быть определены по крайней мере два [партнера](logic-apps-enterprise-integration-partners.md).  

> [!NOTE]
> При создании соглашения содержимое его файла должно соответствовать типу соглашения.    

После создания учетной записи интеграции и добавления партнеров можно создать соглашение, выполнив процедуры, описанные в приведенных далее разделах.  

## <a name="create-an-agreement"></a>Создание соглашения

1. Войдите на [портал Azure](http://portal.azure.com "Портал Azure").  
2. Щелкните **Больше служб**, введите **Учетные записи интеграции** в поле фильтра поиска и выберите **Учетные записи интеграции** из списка результатов.

 ![Выбор "Учетные записи интеграции" из списка результатов](./media/logic-apps-enterprise-integration-agreements/overview-1.png)    
3. Выберите учетную запись интеграции, в которую необходимо добавить сертификат.

 ![Выбор учетной записи интеграции](./media/logic-apps-enterprise-integration-overview/overview-3.png)  
4. Выберите плитку **Соглашения** . Если элемент не отображается, добавьте его.

 ![Выбор элемента "Соглашения"](./media/logic-apps-enterprise-integration-agreements/agreement-1.png)   
5. В колонке **Соглашения** щелкните **Добавить**.

 ![Выберите "Добавить".](./media/logic-apps-enterprise-integration-agreements/agreement-2.png)  
6. Введите имя соглашения в соответствующем поле, затем в поле **Тип соглашения** выберите **AS2** и заполните поля **Главный партнер**, **Главный идентификатор**, **Гостевой партнер** и **Гостевой идентификатор**.

 ![Ввод имени соглашения](./media/logic-apps-enterprise-integration-agreements/agreement-3.png)  

 В следующей таблице описаны свойства, доступные в диалоговом окне **Добавление**.

    | Свойство | Описание |
    | --- | --- |
    | "Host Partner" (Главный партнер) | Для соглашения нужно указать главного партнера и гостевого партнера. Главный партнер представляет организацию, которая настраивает соглашение. |
    | "Host Identity" (Идентификатор главного партнера) | Идентификатор главного партнера. |
    | "Guest Partner" (Партнер-гость) | Для соглашения нужно указать главного партнера и гостевого партнера. Партнер-гость представляет организацию, которая имеет деловые отношения с главным партнером. |
    | Guest Identity | Идентификатор партнера-гостя. |
    | "Receive Settings" (Параметры получения) | Свойства, которые применяются ко всем сообщениям, получаемым посредством соглашения. |
    | "Send Settings" (Параметры отправки) | Свойства, которые применяются ко всем сообщениям, отправляемым посредством соглашения. |

7. Чтобы настроить обработку сообщений, получаемых посредством данного соглашения, сделайте следующее.

 а. Щелкните **Настройки получения**.

 b. При необходимости можно переопределить свойства входящих сообщений, установив флажок **Переопределить свойства сообщения**.

 c. Установите флажок **Сообщение должно быть подписано**, чтобы требовать наличие подписи во всех входящих сообщениях. Если вы установили этот флажок, также выберите **общий сертификат гостевого партнера** из списка **Сертификат**, который будет использоваться для проверки подписи сообщений.

 г) Установите флажок **Сообщение должно быть зашифровано**, чтобы требовать шифрование всех входящих сообщениях. Если вы установили этот флажок, также выберите **закрытый сертификат главного партнера** из списка **Сертификат**, который будет использоваться для расшифровки входящих сообщений.

 д. Чтобы потребовать сжатия сообщений, установите флажок **Сообщение должно быть сжато**.    

 Е. Чтобы отправлять синхронное уведомление о состоянии сообщения (MDN) для полученных сообщений, установите флажок **Отправить MDN**.

 ж. Установите флажок **Отправить подписанное MDN**, чтобы отправлять подписанные уведомления о состоянии полученных сообщений.

 h. Установите флажок **Отправить асинхронное MDN**, чтобы отправлять асинхронные уведомления о состоянии полученных сообщений.

 ![Задание свойств "Настройки получения"](./media/logic-apps-enterprise-integration-agreements/agreement-4.png)  

 В следующей таблице описаны свойства **Настройки получения**.  

 | Свойство | Описание |
 | --- | --- |
 | Override message properties | Указывает, что свойства в полученных сообщениях могут быть переопределены. |
 | Message should be signed | Указывает, что сообщения должны содержать цифровую подпись в сообщениях. Настройте общий сертификат гостевого партнера для проверки подписи.  |
 | Message should be encrypted | Указывает, что сообщения должны быть зашифрованы. Незашифрованные сообщения будут отклонены. Настройте закрытый сертификат главного партнера для расшифровки сообщений.  |
 | Message should be compressed | Указывает, что сообщения должны быть сжаты. Несжатые сообщения будут отклонены. |
 | "MDN Text" (Текст MDN) | Уведомление о состоянии сообщения (MDN) по умолчанию, отправляемое отправителю сообщения. |
 | "Send MDN" (Отправлять MDN) | Указывает, что должны отправляться уведомления о состоянии сообщения. |
 | "Send signed MDN" (Отправлять MDN с подписью) | Указывает, что уведомления о состоянии сообщения должны быть подписаны. |
 | "MIC Algorithm" (Алгоритм контроля целостности учетных данных) | |
 | "Send asynchronous MDN" (Отправлять асинхронные MDN) | Указывает, что сообщения должны отправляться асинхронно. |
 | URL-адрес | URL-адрес, на который должны отправляться уведомления о состоянии сообщения. |

8. Чтобы настроить обработку сообщений, отправляемых посредством данного соглашения, сделайте следующее.

 а. Щелкните **Настройки отправки**.  

 b. Установите флажок **Включить подпись сообщений**, чтобы отправлять партнеру подписанные сообщения. Если этот флажок установлен, то также необходимо выбрать **алгоритм контроля целостности учетных данных закрытого сертификата главного партнера** из списка **Алгоритм MIC** и **закрытый сертификат главного партнера** из списка **Сертификаты**, чтобы подписывать сообщения.

 c. Установите флажок **Включить шифрование сообщений**, чтобы отправлять партнеру зашифрованные сообщения. Если этот флажок установлен, то также необходимо выбрать **алгоритм контроля целостности учетных данных открытого сертификата гостевого партнера** из списка **Алгоритм MIC** и **открытый сертификат гостевого партнера** из списка **Сертификаты**, чтобы шифровать сообщения.

 d. Чтобы сжимать сообщения, установите флажок **Включить сжатие сообщений**.

 д. Установите флажок **Раскрыть заголовки HTTP**, чтобы разворачивать заголовки HTTP Content-Type в одну строку.

 Е. Чтобы получать синхронные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить MDN**.

 ж. Чтобы получать подписанные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить подписанное MDN**.

 h. Чтобы получать асинхронные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить асинхронное MDN**. Если выбран этот параметр, введите URL-адрес, на который будут отправляться уведомления о состоянии сообщения.  

 i. Установите флажок **Включить NRR**, чтобы включить неотрекаемость от получения.

 j. Нажмите кнопку **ОК**.

 ![Задание свойств "Настройки отправки"](./media/logic-apps-enterprise-integration-agreements/agreement-5.png)  

 В следующей таблице описаны свойства **Настройки отправки**.  

 | Свойство | Описание |
 | --- | --- |
 | "Enable message signing" (Включить подписание сообщений) | Указывает, что все сообщения, отправляемые посредством соглашения, должны быть подписаны. |
 | "MIC Algorithm" (Алгоритм контроля целостности учетных данных) | Алгоритм, используемый для подписывания сообщений. Позволяет настроить алгоритм контроля целостности учетных данных закрытого сертификата главного партнера, используемый для подписывания сообщений. |
 | Сертификат | Сертификат, используемый для подписывания сообщений. Позволяет настроить закрытый сертификат главного партнера, используемый для подписывания сообщений. |
 | "Enable message encryption" (Включить шифрование сообщений) | Указывает, что все сообщения, отправляемые посредством соглашения, должны быть зашифрованы. Позволяет настроить алгоритм открытого сертификата гостевого партнера, используемый для шифрования сообщений. |
 | "Encryption Algorithm" (Алгоритм шифрования) | Алгоритм, используемый для шифрования сообщений. Позволяет настроить открытый сертификат гостевого партнера, используемый для шифрования сообщений. |
 | Сертификат | Сертификат, используемый для шифрования сообщений. Позволяет настроить закрытый сертификат гостевого партнера, используемый для шифрования сообщений. |
 | Включить сжатие сообщений | Указывает, что все сообщения, отправляемые посредством соглашения, должны быть сжаты. |
 | "Unfold HTTP headers" (Развернуть заголовки HTTP) | Позволяет разворачивать заголовки HTTP Content-Type в одну строку. |
 | "Request MDN" (Запрашивать MDN) | Указывает, что для всех сообщений, отправляемые посредством соглашения, требуется уведомление о состоянии сообщения. |
 | "Request signed MDN" (Запрашивать подписанные MDN) | Указывает, что все уведомления о состоянии сообщения, отправляемые для соглашения, должны быть подписаны. |
 | "Request asynchronous MDN" (Запрашивать асинхронные MDN) | Указывает, что для этого соглашения требуются асинхронные уведомления о состоянии сообщения. |
 | URL-адрес | URL-адрес, на который должны отправляться уведомления о состоянии сообщения. |
 | "Enable NRR" (Включить NRR) | Указывает, что требуется использовать неотрекаемость от получения (NRR). Это атрибут связи, который предоставляет свидетельство того, что данные были доставлены куда следует. |

## <a name="view-the-agreements-list"></a>Просмотр списка "Соглашения"
Выберите элемент **Соглашения** в колонке **Учетная запись интеграции**, чтобы увидеть только что добавленное соглашение.

![Просмотр списка "Соглашения"](./media/logic-apps-enterprise-integration-agreements/agreement-6.png)

## <a name="next-steps"></a>Дальнейшие действия
* [Обзор пакета интеграции Enterprise](logic-apps-enterprise-integration-overview.md "Обзор пакета интеграции Enterprise")  



<!--HONumber=Feb17_HO1-->


