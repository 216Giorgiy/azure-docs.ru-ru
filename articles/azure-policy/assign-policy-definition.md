---
title: Создание назначения политики для идентификации ресурсов, не соответствующих требованиям, в среде Azure
description: В этой статье рассматриваются действия, позволяющие создать определение политики для выявления ресурсов, не соответствующих требованиям.
services: azure-policy
author: DCtheGeek
ms.author: dacoulte
ms.date: 05/07/2018
ms.topic: quickstart
ms.service: azure-policy
ms.custom: mvc
manager: carmonm
ms.openlocfilehash: 9b1cfd762d6f050994688d1cd6afd91f0e43bfc3
ms.sourcegitcommit: eb75f177fc59d90b1b667afcfe64ac51936e2638
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/16/2018
ms.locfileid: "34195783"
---
# <a name="create-a-policy-assignment-to-identify-non-compliant-resources-in-your-azure-environment"></a>Создание назначения политики для идентификации ресурсов, не соответствующих требованиям, в среде Azure

Чтобы понять, соответствуют ли ресурсы требованиям в Azure, прежде всего нужно определить их состояние. В этом кратком руководстве описывается поэтапный процесс создания назначения политики для выявления виртуальных машин, которые не используют управляемые диски.

Этот процесс позволит вам определить, какие виртуальные машины не используют управляемые диски. Они *не соответствуют* назначению политики.

Если у вас еще нет подписки Azure, создайте [бесплатную](https://azure.microsoft.com/free/) учетную запись Azure, прежде чем начинать работу.

## <a name="create-a-policy-assignment"></a>Создание назначения политики

С помощью этого краткого руководства вы создадите назначение политики и назначите определение политики *Audit Virtual Machines without Managed Disks*.

1. Запустите службу "Политика Azure" на портале Azure, щелкнув **Все службы**, а затем выполнив поиск и выбрав **Политика**.

   ![Поиск политики](media/assign-policy-definition/search-policy.png)

2. Выберите **Назначения** на странице службы "Политики Azure" слева. Назначение — это политика, которая назначена в рамках определенной области.
3. Выберите **Назначить политику** в верхней части страницы **Policy — Assignments** (Политика — назначения).

   ![Назначение определения политики](media/assign-policy-definition/select-assign-policy.png)

4. На странице **Назначить политику** выберите **Область**, нажав кнопку с многоточием и выбрав подписку (обязательно) и группу ресурсов (необязательно). Она определяет, к каким ресурсам или группе ресурсов принудительно применяется назначение политики.  Теперь щелкните **Выбрать** в нижней части страницы **Область**.

   В этом примере используется **подписка Contoso**. Ваша подписка будет отличаться.

5. Если требуется исключить одну или несколько групп ресурсов (в переделах подписки) или конкретные ресурсы в рамках группы ресурсов (или другой вариант ограничения), можно настроить **исключения** в назначении политики. Пока не указывайте ничего.

6. Выберите многоточие рядом с пунктом **Определение политики**, чтобы открыть список доступных определений. Служба "Политика Azure" поставляется с готовыми встроенными определениями политик, которые можно использовать. Вам доступны многие определения встроенных политик, например такие:

   - принудительно применять тег и его значение;
   - применять тег и его значение;
   - Require SQL Server version 12.0;

    Полный список всех доступных встроенных политик см. в разделе [Шаблоны для службы "Политика Azure"](json-samples.md).

7. Найдите определение политики в списке по строке *Аудит виртуальных машин, которые не используют управляемые диски*. Щелкните эту политику, а затем выберите действие **Выбрать**.

   ![Поиск нужного определения политики](media/assign-policy-definition/select-available-definition.png)

8. **Имя назначения** автоматически заполняется выбранным именем политики, но его можно изменить. Для нашего примера сохраните значение *Аудит виртуальных машин, которые не используют управляемые диски*. При желании вы можете добавить необязательное **описание**. Описание содержит сведения о назначении этой политики.

9. Щелкните **Назначить**.

Теперь все готово к выявлению ресурсов, которые не соответствуют требованиям, что позволит оценить состояние соответствия в среде.

## <a name="identify-non-compliant-resources"></a>Выявление несоответствующих ресурсов

Выберите элемент **Соответствие** в левой части страницы и найдите ранее созданное назначение политики **Аудит виртуальных машин, которые не используют управляемые диски**.

![Соответствие политике](media/assign-policy-definition/policy-compliance.png)

Существующие ресурсы, которые не соответствуют новому назначению, отображаются в разделе **Non-compliant resources** (Несоответствующие ресурсы).

Если условие применяется к существующим ресурсам и оказывается верным, такие ресурсы помечаются как несовместимые с настроенной политикой. В следующей таблице показано, как действуют разные политики в сочетании с оценкой условий для определения итогового состояния соответствия. Хотя логика оценки не отображается на портале Azure, результаты состояния соответствия выводятся. Они могут быть такими: "Соответствует" либо "Не соответствует".

| **Состояние ресурса** | **Эффект** | **Оценка политики** | **Состояние соответствия** |
| --- | --- | --- | --- |
| Exists | Deny, Audit, Append\*, DeployIfNotExist\*, AuditIfNotExist\* | Истина | Не соответствует |
| Exists | Deny, Audit, Append\*, DeployIfNotExist\*, AuditIfNotExist\* | Ложь | Соответствует |
| Создать | Audit, AuditIfNotExist\* | Истина | Не соответствует |
| Создать | Audit, AuditIfNotExist\* | Ложь | Соответствует |

\* Для эффектов Append, DeployIfNotExist и AuditIfNotExist требуется, чтобы оператор IF имел значение TRUE, а условие существования должно иметь значение FALSE, чтобы эффект считался несоответствующим требованиям. Когда установлено значение TRUE, условие IF запускает оценку условия существования для связанных ресурсов.

## <a name="clean-up-resources"></a>Очистка ресурсов

Остальные руководства из этой серии являются продолжением этого документа. Если вы намерены переходить к ним, не удаляйте ресурсы, которые создали при работе с этим руководством. Если вы не планируете продолжать работу, удалите все созданные ресурсы, выполнив на портале Azure следующие действия.

1. Выберите элемент **Соответствие** (или **Назначения**) в левой части страницы службы "Политика Azure" и найдите ранее созданное назначение политики **Аудит виртуальных машин, которые не используют управляемые диски**.

2. Щелкните правой кнопкой мыши назначение политики **Аудит виртуальных машин, которые не используют управляемые диски** и выберите **Удалить назначение**.

   ![Удаление назначения](media/assign-policy-definition/delete-assignment.png)

## <a name="next-steps"></a>Дополнительная информация

С помощью этого краткого руководства вы назначили определение политики для области и изучили отчет о соответствии. Определение политики гарантирует, что все ресурсы в области соответствуют требованиям, и определяет, какие из них не соответствуют.

Следующее руководство серии содержит сведения о назначении политик, обеспечивающих соответствие требованиям для **новых ресурсов**:

> [!div class="nextstepaction"]
> [Создание политик и управление ими](create-manage-policy.md)