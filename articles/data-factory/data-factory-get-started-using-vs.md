<properties 
	pageTitle="Приступая к работе с фабрикой данных Azure" 
	description="В этом учебнике показано, как создать пример конвейера данных, который копирует данные из большого двоичного объекта в экземпляр базы данных SQL Azure." 
	services="data-factory" 
	documentationCenter="" 
	authors="spelluru" 
	manager="jhubbard" 
	editor="monicar"/>

<tags 
	ms.service="data-factory" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="07/17/2015" 
	ms.author="spelluru"/>

# Учебник. Создание и мониторинг фабрики данных с помощью Visual Studio
> [AZURE.SELECTOR]
- [Tutorial Overview](data-factory-get-started.md)
- [Using Data Factory Editor](data-factory-get-started-using-editor.md)
- [Using PowerShell](data-factory-monitor-manage-using-powershell.md)
- [Using Visual Studio](data-factory-get-started-using-vs.md)


##Вот какие темы рассматривает этот учебник:
В этом учебнике мы создадим фабрику данных Azure с именем **ADFTutorialDataFactoryVS** на портале предварительной версии Azure, а затем выполним следующие действия с помощью Visual Studio 2013.

1. Создание двух связанных служб: **AzureStorageLinkedService1** и **AzureSqlinkedService1**. Связанная служба AzureStorageLinkedService1 связывает хранилище Azure, а служба AzureSqlLinkedService1 связывает базу данных SQL Azure с фабрикой данных **ADFTutorialDataFactoryVS**. Входные данные для конвейера размещены в хранилище больших двоичных объектов Azure, а выходные данные будут сохраняться в таблице в базе данных Azure SQL. Таким образом, можно добавить эти два хранилища данных как связанные службы в фабрику данных.
2. Создание двух таблиц фабрики данных, **EmpTableFromBlob** и **EmpSQLTable**, которые являются представлением входных и выходных данных, сохраняемых в этих хранилищах данных. Для EmpTableFromBlob потребуется указать контейнер больших двоичных объектов, содержащий большой двоичный объект с исходными данными для таблицы EmpSQLTable, а также таблицу SQL, в которой будут сохраняться выходные данные. Вы также укажите другие свойства, такие как структура данных, доступность данных и т. п.
3. Создание конвейера с именем **ADFTutorialPipeline** в ADFTutorialDataFactoryVS. Для конвейера будет назначено **действие копирования**, которое будет копировать входные данные большого двоичного объекта Azure в выходную таблицу SQL Azure 


## <a name="CreateDataFactory"></a> Создание фабрики данных Azure
На этом шаге создается фабрика данных с именем **ADFTutorialDataFactoryVS** через портал предварительной версии Azure.

1.	После выполнения входа на [портал предварительной версии Azure](http://portal.azure.com) щелкните **СОЗДАТЬ** в нижнем левом углу, выберите **Анализ данных** в колонке **Создать**, затем щелкните **Фабрика данных** в колонке **Анализ данных**. 

	![Создать -> Фабрика данных](./media/data-factory-get-started-using-vs/NewDataFactoryMenu.png)

6. В колонке **Создать фабрику данных** выполните следующие действия.
	1. Введите **ADFTutorialDataFactoryVS** в поле **Имя**. 
	
  		![Создать колонку "Фабрика данных"](./media/data-factory-get-started-using-vs/getstarted-new-data-factory.png)
	2. Щелкните **ИМЯ ГРУППЫ РЕСУРСОВ** и выполните одно из следующих действий.
		1. Щелкните **Создать новую группу ресурсов**.
		2. В колонке **Создать новую группу ресурсов** введите **ADFTutorialResourceGroup** в поле **имени** группы ресурсов и щелкните **ОК**. 

			![Создать группу ресурсов](./media/data-factory-get-started-using-vs/CreateNewResourceGroup.png)

		Некоторые действия, описанные в этом учебнике, предполагают, что для группы ресурсов используется имя **ADFTutorialResourceGroup**. Сведения о группах ресурсов см. в разделе [Использование групп ресурсов для управления ресурсами Azure](resource-group-overview.md).  
7. В колонке **Создать фабрику данных** убедитесь, что выбран пункт **Добавить в начальную панель**.
8. Нажмите **Создать** в колонке **Создать фабрику данных**.

	Имя фабрики данных Azure должно быть глобально уникальным. При возникновении ошибки **Имя фабрики данных ADFTutorialDataFactoryVS недоступно** измените имя этой фабрики данных (например, на вашеимяADFTutorialDataFactoryVS) и попробуйте создать ее снова. Используйте это имя вместо ADFTutorialFactory при выполнении оставшихся шагов в этом учебнике. Ознакомьтесь с разделом [Фабрика данных — правила именования][data-factory-naming-rules], чтобы узнать о правилах именования артефактов фабрики данных.
	 
	![Имя фабрики данных недоступно](./media/data-factory-get-started-using-vs/getstarted-data-factory-not-available.png)

9. Щелкните концентратор **УВЕДОМЛЕНИЯ** слева и просмотрите уведомления процесса создания. Щелкните **X**, чтобы закрыть колонку **УВЕДОМЛЕНИЯ**, если она открыта.
10. Затем вы увидите колонку **ФАБРИКА ДАННЫХ**, как показано ниже.

    ![Домашняя страница фабрики данных](./media/data-factory-get-started-using-vs/getstarted-data-factory-home-page.png)

## Создание и развертывание сущностей фабрики данных с помощью Visual Studio 

### Предварительные требования
На вашем компьютере должны быть установлены следующие компоненты: Visual Studio 2013. Скачайте пакет SDK Azure для Visual Studio 2013. Перейдите на [страницу скачиваемых файлов Azure](http://azure.microsoft.com/downloads/) и нажмите кнопку **установки VS 2013** в разделе **.NET**.

### Пошаговое руководство

#### Создание проекта Visual Studio 
1. Запустите **Visual Studio 2013**. Щелкните **Файл**, наведите указатель мыши на пункт **Создать** и щелкните **Проект**. Вы увидите диалоговое окно **Новый проект**.  
2. В диалоговом окне **Новый проект** выберите шаблон **DataFactory** и щелкните **Пустой проект фабрики данных**. Если вы не видите шаблон DataFactory, закройте Visual Studio, установите пакет SDK Azure для Visual Studio 2013 и снова откройте Visual Studio.  

	![Диалоговое окно «Новый проект»](./media/data-factory-get-started-using-vs/new-project-dialog.png)

3. Введите **имя** проекта, **расположение** и имя для **решения** и нажмите кнопку **ОК**.

	![Обозреватель решений](./media/data-factory-get-started-using-vs/solution-explorer.png)

#### Создание связанных служб
Связанные службы связывают хранилища данных или службы вычислений с фабрикой данных Azure. Данные могут храниться в хранилище Azure, в базе данных SQL Azure или в локальной базе данных SQL Server.

На этом шаге создаются две связанные службы: **AzureStorageLinkedService1** и **AzureSqlLinkedService1**. Связанная служба AzureStorageLinkedService1 связывает учетную запись хранения Azure, а служба AzureSqlLinkedService связывает базу данных SQL Azure с фабрикой данных **ADFTutorialDataFactory**.

##### Создание связанных служб хранилища Azure

4. Щелкните правой кнопкой мыши **Связанные службы** в обозревателе решений, выберите **Добавить** и щелкните **Новый элемент**.      
5. В диалоговом окне **Добавление нового элемента** выберите **Связанные службы хранилища Azure** из списка и нажмите кнопку **Добавить**. 

	![Новая связанная служба](./media/data-factory-get-started-using-vs/new-linked-service-dialog.png)
 
3. Замените **accountname** и **accountkey** именем вашей учетной записи хранения Azure и ее ключом.

	![Связанная служба хранилища Azure](./media/data-factory-get-started-using-vs/azure-storage-linked-service.png)

4. Сохраните файл **AzureStorageLinkedService1.json**.

#### Создание связанной службы SQL Azure

5. Щелкните правой кнопкой мыши узел **Связанные службы** в **обозревателе решений**, выберите **Добавить** и щелкните **Новый элемент**. 
6. На этот раз выберите **Связанные службы SQL Azure** и нажмите кнопку **Добавить**. 
7. В **файле AzureSqlLinkedService1.json** замените **servername**, **databasename**, **username@servername** и **password** именами сервера, базы данных, учетной записи пользователя и паролем Azure SQL.8.  Сохраните файл **AzureSqlLinkedService1.json**. 


### Создание входных и выходных таблиц
На предыдущем шаге были созданы связанные службы **AzureStorageLinkedService1** и **AzureSqlLinkedService1** для связи учетной записи хранения Azure и базы данных SQL Azure с фабрикой данных **ADFTutorialDataFactory**. На этом шаге будут определены две таблицы фабрики данных, **EmpTableFromBlob** и **EmpSQLTable**, представляющие входные и выходные данные, которые сохраняются в хранилищах данных, на которые ссылаются службы AzureStorageLinkedService1 и AzureSqlLinkedService1 соответственно. Для EmpTableFromBlob потребуется указать контейнер больших двоичных объектов, содержащий большой двоичный объект с исходными данными для таблицы EmpSQLTable, а также таблицу SQL, в которой будут сохраняться выходные данные.

#### Создание входной таблицы

9. Щелкните правой кнопкой мыши **Таблицы** в **обозревателе решений**, выберите **Добавить** и нажмите кнопку **Новый элемент**.
10. В диалоговом окне **Добавление нового элемента** выберите **большой двоичный объект Azure ** и нажмите кнопку **Добавить**.   
10. Замените текст JSON следующим текстом и сохраните файл **AzureBlobLocation1.json**. 

		{
    		"name": "EmpTableFromBlob",
        	"properties":
        	{
            	"structure":  
                [ 
	                { "name": "FirstName", "type": "String"},
	                { "name": "LastName", "type": "String"}
	            ],
	            "location": 
	            {
	                "type": "AzureBlobLocation",
	                "folderPath": "adftutorial/",
	                "format":
	                {
	                    "type": "TextFormat",
	                    "columnDelimiter": ","
	                },
	                "linkedServiceName": "AzureStorageLinkedService1"
	            },
	            "availability": 
	            {
	                "frequency": "Hour",
	                "interval": 1,
	                "waitOnExternal": {}
                }
	        }
		}

#### Создание выходной таблицы

11. Снова щелкните правой кнопкой мыши **Таблицы** в **обозревателе решений**, выберите **Добавить** и нажмите кнопку **Новый элемент**.
12. В диалоговом окне **Добавление нового элемента** выберите **SQL Azure ** и нажмите кнопку **Добавить**. 
13. Замените текст JSON следующим JSON и сохраните файл **AzureSqlTableLocation1.json**.

		{
		    "name": "EmpSQLTable",
		    "properties":
		    {
		        "structure":
		        [
		            { "name": "FirstName", "type": "String"},
		            { "name": "LastName", "type": "String"}
		        ],
		        "location":
		        {
		            "type": "AzureSqlTableLocation",
		            "tableName": "emp",
		            "linkedServiceName": "AzureSqlLinkedService1"
		        },
		        "availability": 
		        {
		            "frequency": "Hour",
		            "interval": 1            
		        }
		    }
		}

#### Создание конвейера 
На данный момент мы создали связанные службы ввода и вывода, а также таблицы. Теперь мы создадим конвейер с **действием копирования** для копирования данных из больших двоичных объектов Azure в базу данных SQL Azure.


1. Щелкните правой кнопкой мыши **Конвейеры** в **обозревателе решений**, выберите **Добавить** и нажмите кнопку **Новый элемент**.  
15. Выберите **Конвейер копирования данных** в диалоговом окне **Добавление нового элемента** и нажмите кнопку **Добавить**. 
16. Замените JSON следующим JSON и сохраните файл **CopyActivity1.json**...
			
		 {
		    "name": "ADFTutorialPipeline",
		    "properties":
		    {   
		        "description" : "Copy data from a blob to Azure SQL table",
		        "activities":   
		        [
		            {
		                "name": "CopyFromBlobToSQL",
		                "description": "Push Regional Effectiveness Campaign data to Azure SQL database",
		                "type": "CopyActivity",
		                "inputs": [ {"name": "EmpTableFromBlob"} ],
		                "outputs": [ {"name": "EmpSQLTable"} ],     
		                "transformation":
		                {
		                    "source":
		                    {                               
		                        "type": "BlobSource"
		                    },
		                    "sink":
		                    {
		                        "type": "SqlSink",
		                        "writeBatchSize": 10000,
		                        "writeBatchTimeout": "60:00:00"
		                    }   
		                },
		                "Policy":
		                {
		                    "concurrency": 1,
		                    "executionPriorityOrder": "NewestFirst",
		                    "style": "StartOfInterval",
		                    "retry": 0,
		                    "timeout": "01:00:00"
		                }       
		            }
		        ],
		
		        "start": "2015-07-12T00:00:00Z",
		        "end": "2015-07-13T00:00:00Z",
		        "isPaused": false
		    }
		} 

#### Публикация и развертывание сущностей фабрики данных
  
18. В области инструментов щелкните правой кнопкой мыши и выберите **Фабрика данных**, чтобы включить инструменты фабрики данных, если они еще не включены. 
19. На панели **инструментов фабрики данных** щелкните **раскрывающийся список** для просмотра всех фабрик данных в подписке Azure. Если вы видите диалоговое окно **Войти в Visual Studio**, сделайте следующее. 
	20. Введите **учетную запись электронной почты**, связанную с подпиской Azure, в которой требуется создать фабрику данных, введите **пароль** и нажмите кнопку **Вход**.
	21. После успешного входа вы увидите все фабрики данных в подписке Azure. В этом учебнике мы создадим новую фабрику данных.       
22. В раскрывающемся списке выберите **ADFTutorialFactoryVS** и нажмите кнопку **Публикация** для развертывания и публикации связанных служб, наборов данных и конвейера.    

	![Кнопка "Опубликовать"](./media/data-factory-get-started-using-vs/publish.png)

23. Вы увидите состояние публикации в окне списка задач фабрики данных, представленном на рисунке выше. Убедитесь, что публикация выполнена успешно.

## Использование обозревателя серверов для просмотра сущностей фабрики данных

1. В **Visual Studio** щелкните **Вид** в меню и нажмите кнопку **Обозреватель серверов**.
2. В окне обозревателя серверов разверните узлы **Azure** и **Фабрика данных**. Если вы видите окно **Вход в Visual Studio**, введите данные **учетной записи**, связанной с подпиской Azure, и нажмите кнопку **Продолжить**. Введите свой **пароль** и щелкните **Войти**. Visual Studio пытается получить сведения обо всех фабриках данных Azure в подписке. Вы увидите состояние данной операции в окне **Список задач фабрики данных**.![Обозреватель серверов](./media/data-factory-get-started-using-vs/server-explorer.png)
3. Щелкните правой кнопкой мыши по фабрике данных и выберите «Экспорт фабрики данных в новый проект», чтобы создать проект Visual Studio в зависимости от существующей фабрики данных.![Экспорт фабрики данных для проекта VS](./media/data-factory-get-started-using-vs/export-data-factory-menu.png)  

## Обновление средств фабрик данных для Visual Studio
Чтобы обновить средства фабрики данных Azure для Visual Studio, выполните следующие действия.

1. Щелкните **Средства** в меню и выберите команду **Расширения и обновления**. 
2. Выберите **Обновления** в левой панели, а затем **Коллекции Visual Studio**.
4. Выберите **Средства фабрики данных Azure для Visual Studio** и нажмите кнопку **Обновить**. Если эта запись отсутствует, у вас уже установлена последняя версия средства. 

Инструкции по использованию портала предварительной версии Azure для мониторинга конвейера и наборов данных, созданных в этом учебнике, см. в разделе [Мониторинг наборов данных и конвейера](data-factory-get-started-using-editor.md/#MonitorDataSetsAndPipeline).

<!---HONumber=July15_HO4-->