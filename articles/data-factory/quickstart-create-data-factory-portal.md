---
title: "Создание фабрики данных Azure с помощью пользовательского интерфейса службы \"Фабрика данных Azure\" | Документация Майкрософт"
description: "Из этого руководства вы узнаете, как создать фабрику данных с конвейером, в котором данные копируются из одной папки в другую в хранилище BLOB-объектов Azure."
services: data-factory
documentationcenter: 
author: linda33wj
manager: jhubbard
editor: spelluru
ms.service: data-factory
ms.workload: data-services
ms.topic: hero-article
ms.date: 01/16/2018
ms.author: jingwang
ms.openlocfilehash: ebce4e0d137d2e56cc914efad357593af7abb255
ms.sourcegitcommit: f1c1789f2f2502d683afaf5a2f46cc548c0dea50
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/18/2018
---
# <a name="create-a-data-factory-using-the-azure-data-factory-ui"></a>Создание фабрики данных с помощью пользовательского интерфейса службы "Фабрика данных Azure"
> [!div class="op_single_selector" title1="Select the version of Data Factory service you are using:"]
> * [Версия 1 — общедоступная](v1/data-factory-copy-data-from-azure-blob-storage-to-sql-database.md)
> * [Версия 2 — предварительная](quickstart-create-data-factory-portal.md)

В этом кратком руководстве описано создание и мониторинг фабрики данных Azure с помощью пользовательского интерфейса службы "Фабрика данных Azure". Конвейер, который вы создадите в этой фабрике данных, **копирует** данные из одной папки в другую в хранилище BLOB-объектов Azure. Инструкции по **преобразованию** данных с помощью фабрики данных Azure см. в [руководстве по преобразованию данных с помощью Spark](tutorial-transform-data-spark-portal.md). 


> [!NOTE]
> Если вы еще не работали со службой "Фабрика данных Azure", ознакомьтесь с [общими сведениями](data-factory-introduction.md) о ней перед изучением этого руководства. 
>
> Эта статья относится к версии 2 фабрики данных, которая в настоящее время доступна в предварительной версии. Если вы используете общедоступную версию 1 службы "Фабрика данных", перейдите к [руководству по версии 1 службы "Фабрика данных"](v1/data-factory-copy-data-from-azure-blob-storage-to-sql-database.md).

[!INCLUDE [data-factory-quickstart-prerequisites](../../includes/data-factory-quickstart-prerequisites.md)] 

### <a name="video"></a>Видео 
Это видео поможет составить представление о пользовательском интерфейсе службы "Фабрика данных": 
>[!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Visually-build-pipelines-for-Azure-Data-Factory-v2/Player]

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. Перейдите на [портал Azure](https://portal.azure.com). 
2. В меню слева щелкните **Создать**, выберите **Данные+аналитика** и щелкните **Фабрика данных**. 
   
   ![Создать -> Фабрика данных](./media/quickstart-create-data-factory-portal/new-azure-data-factory-menu.png)
2. На странице **Новая фабрика данных** введите **ADFTutorialDataFactory** в поле **Имя**. 
      
     ![Страница "Новая фабрика данных"](./media/quickstart-create-data-factory-portal/new-azure-data-factory.png)
 
   Имя фабрики данных Azure должно быть **глобально уникальным**. Если вы увидите следующую ошибку для поля имени, введите другое имя фабрики данных (например, ваше_имя_ADFTutorialBulkCopyDF). Ознакомьтесь со статьей [Фабрика данных Azure — правила именования](naming-rules.md), чтобы узнать правила именования для артефактов службы "Фабрика данных".
  
     ![Ошибка "Имя недоступно"](./media/quickstart-create-data-factory-portal/name-not-available-error.png)
3. Выберите **подписку** Azure, в рамках которой вы хотите создать фабрику данных. 
4. Для **группы ресурсов** выполните одно из следующих действий.
     
      - Выберите **Использовать существующую**и укажите существующую группу ресурсов в раскрывающемся списке. 
      - Выберите **Создать новую**и укажите имя группы ресурсов.   
         
    Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/resource-group-overview.md).  
4. Выберите **V2 (Preview)** (V2 (предварительная версия)) для **версии**.
5. Укажите **расположение** фабрики данных. В этом раскрывающемся списке отображаются только сведения о расположениях, поддерживаемых службой "Фабрика данных". Хранилища данных (служба хранилища Azure, служба "База данных SQL Azure" и т. д.) и вычислительные ресурсы (HDInsight и т. д.), используемые фабрикой данных, могут располагаться в других регионах.
6. Кроме того, установите флажок **Закрепить на панели мониторинга**.     
7. Нажмите кнопку **Создать**.
8. На панели мониторинга вы увидите приведенный ниже элемент с состоянием **Deploying data factory** (Развертывание фабрики данных). 

    ![Элемент Deploying data factory (Развертывание фабрики данных)](media//quickstart-create-data-factory-portal/deploying-data-factory.png)
9. Когда завершится создание, откроется страница **Фабрика данных**, как показано на рисунке ниже.
   
    ![Домашняя страница фабрики данных](./media/quickstart-create-data-factory-portal/data-factory-home-page.png)
10. Щелкните плитку **Создание и мониторинг**, чтобы открыть на отдельной вкладке приложение пользовательского интерфейса службы "Фабрика данных Azure". 
11. На странице начала работы откройте вкладку **Изменить** на панели слева, как показано на следующем рисунке: 

    ![Страница "Начало работы"](./media/quickstart-create-data-factory-portal/get-started-page.png)

## <a name="create-azure-storage-linked-service"></a>Создание связанной службы хранения Azure
На этом этапе вы создадите связанную службу, чтобы связать учетную запись хранения Azure с фабрикой данных. Связанная служба содержит сведения о подключении, используемые фабрикой данных для подключения к ней в среде выполнения.

2. Щелкните **Подключения** и нажмите кнопку **Создать** на панели инструментов. 

    ![Новое подключение](./media/quickstart-create-data-factory-portal/new-connection-button.png)    
3. На странице **New Linked Service** (Новая связанная служба) выберите **Хранилище BLOB-объектов Azure** и щелкните **Продолжить**. 

    ![Выбор службы хранилища Azure](./media/quickstart-create-data-factory-portal/select-azure-storage.png)
4. На странице **New Linked Service** (Новая связанная служба) выполните следующие действия: 

    1. Введите **AzureStorageLinkedService** в поле **Имя**.
    2. Выберите имя учетной записи хранения Azure в списке **имен учетных записей хранения**.
    3. Щелкните **Проверка подключения**, чтобы проверить подключение службы "Фабрика данных" к учетной записи хранения. 
    4. Щелкните **Сохранить**, чтобы сохранить связанную службу. 

        ![Параметры связанной службы хранилища Azure](./media/quickstart-create-data-factory-portal/azure-storage-linked-service.png) 
5. Убедитесь, что **AzureSqlLinkedService** отображается в списке связанных служб. 

    ![Связанная служба хранилища Azure в списке](./media/quickstart-create-data-factory-portal/azure-storage-linked-service-in-list.png)

## <a name="create-datasets"></a>Создание наборов данных
На этом шаге вы создадите два набора данных: **InputDataset** и **OutputDataset**. Эти наборы данных имеют тип **AzureBlob**. Они будут ссылаться на **связанную службу хранилища Azure**, созданную на предыдущем этапе. 

Входной набор данных представляет исходные данные в папке входных данных. В определении входного набора данных укажите контейнер больших двоичных объектов (**adftutorial**), папку (**input**) и файл (**emp.txt**), определяющие расположение исходных данных. 

Выходной набор данных представляет данные, которые копируются в место назначения. В определении выходного набора данных укажите контейнер больших двоичных объектов (**adftutorial**), папку (**output**) и файл, определяющие расположение копируемых данных. С каждым запуском конвейера связан уникальный идентификатор, который можно получить из системной переменной **RunId**. Имя выходного файла вычисляется динамически на основе идентификатора выполнения текущего конвейера.   

В параметрах связанной службы вы указали учетную запись хранения Azure, которая содержит исходные данные. В параметрах исходного набора данных следует указать точное расположение исходных данных (контейнер больших двоичных объектов, папку и файл). В параметрах целевого набора данных следует указать точное расположение для копирования данных (контейнер больших двоичных объектов, папку и файл). 
 
1. Нажмите кнопку **+ (плюс)** и выберите **Набор данных**.

    ![Меню "Новый набор данных"](./media/quickstart-create-data-factory-portal/new-dataset-menu.png)
2. На странице **Новый набор данных** выберите **Хранилище BLOB-объектов Azure** и нажмите кнопку **Готово**. 

    ![Выбор хранилища BLOB-объектов Azure](./media/quickstart-create-data-factory-portal/select-azure-blob-storage.png)
3. В окне **Свойства** для набора данных введите **InputDataset** в поле **Имя**. 

    ![Общие параметры набора данных](./media/quickstart-create-data-factory-portal/dataset-general-page.png)
4. Откройте вкладку **Подключения** и выполните здесь следующие действия: 

    1. Выберите **AzureStorageLinkedService** в качестве имени связанной службы. 
    2. Нажмите кнопку **Обзор** в области **Путь к файлу**. 
        ![Выбор входного файла](./media/quickstart-create-data-factory-portal/file-path-browse-button.png)
    3. В окне **Choose a file or folder** (Выберите файл или папку) перейдите к папке **input** контейнера **adftutorial**, выберите файл **emp.txt** и нажмите кнопку **Готово**.

        ![Выбор входного файла](./media/quickstart-create-data-factory-portal/choose-file-folder.png)
    4. (Необязательно.) Щелкните **Просмотр данных**, чтобы изучить содержимое файла emp.txt.     
5. Повторите эти шаги, чтобы создать выходной набор данных.  

    1. Нажмите кнопку **+ (плюс)** на панели слева и выберите **Набор данных**.
    2. На странице **Новый набор данных** выберите **Хранилище BLOB-объектов Azure** и щелкните **Готово**.
    3. Укажите имя **OutputDataset**.
    4. Введите имя папки **adftutorial/output**. При помощи действия копирования будет создана папка выходных данных, если ее еще нет. 
    5. Введите имя файла `@CONCAT(pipeline().RunId, '.txt')`. При каждом запуске конвейера ему присваивается уникальный идентификатор. При помощи этого выражения создается имя выходного файла. Для этого идентификатор запуска конвейера объединяется с расширением **.txt**. Списки поддерживаемых системных переменных и выражений вы найдете в статьях [Системные переменные, поддерживаемые в фабрике данных Azure](control-flow-system-variables.md) и [Выражения и функции в фабрике данных Azure](control-flow-expression-language-functions.md).

        ![Параметры выходного набора данных](./media/quickstart-create-data-factory-portal/output-dataset-settings.png)

## <a name="create-a-pipeline"></a>Создание конвейера 
На этом этапе вы создадите и проверите конвейер с **действием копирования**, которое использует входной и выходной наборы данных. При помощи действия копирования данные копируются из файла, указанного в параметрах входного набора данных, в файл, указанный в параметрах выходного набора данных. Если входной набор данных определяет только папку (но не имя файла), при помощи действия копирования в место назначения копируются все файлы из исходной папки. 

1. Нажмите кнопку **+ (плюс)** и выберите **Конвейер**. 

    ![Меню создания конвейера](./media/quickstart-create-data-factory-portal/new-pipeline-menu.png)
2. Укажите **CopyPipeline** в поле **имени** в окне **Свойства**. 

    ![Общие параметры конвейера](./media/quickstart-create-data-factory-portal/pipeline-general-settings.png)
3. На панели элементов **Действия** разверните **Поток данных** и перетащите действие **Копирование** с панели элементов **Действия** в область конструктора конвейера. Также на панели элементов **Действия** можно применить поиск. Введите **CopyFromBlobToBlob** в поле **имя**.

    ![Общие параметры действия копирования](./media/quickstart-create-data-factory-portal/copy-activity-general-settings.png)
4. Откройте вкладку **Источник** в параметрах действия копирования и выберите **InputDataset** в списке **исходных наборов данных**.

    ![Настройки источника для действия копирования](./media/quickstart-create-data-factory-portal/copy-activity-source-settings.png)    
5. Откройте вкладку **Приемник** в параметрах действия копирования и выберите **OutputDataset** в списке **целевых наборов данных**.

    ![Настройки приемника для действия копирования](./media/quickstart-create-data-factory-portal/copy-activity-sink-settings.png)    
7. Щелкните **Проверить**, чтобы проверить параметры конвейера. Убедитесь, что проверка конвейера прошла успешно. Чтобы закрыть окно проверки, щелкните **стрелку вправо** (>>). 

    ![Проверка конвейера](./media/quickstart-create-data-factory-portal/pipeline-validate-button.png)

## <a name="test-run-the-pipeline"></a>Тестовое выполнение конвейера
На этом этапе вы выполните тестовый запуск конвейера перед его развертыванием в службе "Фабрика данных". 

1. На панели инструментов для конвейера щелкните **Тестовый запуск**. 
    
    ![Тестовый запуск конвейера](./media/quickstart-create-data-factory-portal/pipeline-test-run.png)
2. Убедитесь, что сведения о состоянии запуска для конвейера отображаются на вкладке **Выходные данные** в параметрах конвейера. 

    ![Выходные данные тестового запуска](./media/quickstart-create-data-factory-portal/test-run-output.png)    
3. Убедитесь, что выходной файл появился в папке **output** конвейера **adftutorial**. Если указанной папки выходных данных нет, она будет автоматически создана в службе "Фабрика данных". 
    
    ![Проверка выходных данных](./media/quickstart-create-data-factory-portal/verify-output.png)


## <a name="trigger-the-pipeline-manually"></a>Aктивация конвейера вручную
На этом шаге вы развернете сущности (связанные службы, наборы данных и конвейеры) в службе "Фабрика данных Azure". После этого вы вручную запустите конвейер. Также можно опубликовать сущности в собственном репозитории GIT VSTS. Этот процесс рассматривается в [другом руководстве](tutorial-copy-data-portal.md?#configure-code-repository).

1. Перед запуском конвейера необходимо опубликовать сущности в службе "Фабрика данных Azure". Для этого щелкните **Опубликовать** в области слева. 

    ![Кнопка "Опубликовать"](./media/quickstart-create-data-factory-portal/publish-button.png)
2. Чтобы вручную запустить конвейер,щелкните **Триггер** на панели инструментов и выберите **Trigger Now** (Запустить сейчас). 
    
    ![Trigger Now (Запустить сейчас)](./media/quickstart-create-data-factory-portal/pipeline-trigger-now.png)

## <a name="monitor-the-pipeline"></a>Мониторинг конвейера

1. Перейдите на вкладку **Мониторинг** слева. Нажмите кнопку **Обновить**, чтобы обновить этот список.

    ![Мониторинг конвейера](./media/quickstart-create-data-factory-portal/monitor-trigger-now-pipeline.png)
2. Щелкните ссылку **View Activity Runs** (Просмотр запусков действий) в списке **Действия**. На этой странице отображаются сведения о состоянии запуска для действия копирования. 

    ![Выполнение действий конвейера](./media/quickstart-create-data-factory-portal/pipeline-activity-runs.png)
3. Чтобы просмотреть сведения об операции копирования, щелкните ссылку **Сведения** (изображение очков) в столбце **Действия**. Дополнительные сведения о свойствах см. в [обзоре действия копирования](copy-activity-overview.md). 

    ![Сведения об операции копирования](./media/quickstart-create-data-factory-portal/copy-operation-details.png)
4. Убедитесь, что в папке **output** появился новый файл. 
5. Чтобы вернуться из режима **Запуски операции** в режим **Pipeline Runs** (Запуски конвейера), щелкните ссылку **Конвейеры**. 

## <a name="trigger-the-pipeline-on-a-schedule"></a>Запуск конвейера по расписанию
Этот шаг руководства не является обязательным. Вы можете создать **триггер планировщика** для периодического запуска конвейера (ежечасно, ежедневно, и т. д.). На этом этапе вы создадите триггер, который будет выполняться каждую минуту, пока не наступит указанная вами дата окончания. 

1. Откройте вкладку **Правка**. 

    ![Открытие вкладки "Правка"](./media/quickstart-create-data-factory-portal/switch-edit-tab.png)
1. Выберите пункт меню **Триггер** и щелкните **Создать/изменить**. 

    ![Меню создания триггера](./media/quickstart-create-data-factory-portal/new-trigger-menu.png)
2. На странице **Add Triggers** (Добавление триггеров) щелкните **Choose trigger...** (Выбор триггера...) и нажмите **Создать**. 

    ![Добавление триггеров — новый триггер](./media/quickstart-create-data-factory-portal/add-trigger-new-button.png)
3. На странице **Новый триггер** в поле **Окончание** выберите **On Date** (Дата) и укажите время окончания (на несколько минут позднее текущего). Затем щелкните **Применить**. Каждый запуск конвейера оплачивается, поэтому не следует выбирать время окончания, наступающее намного позднее времени начала. Убедитесь, что выбран один и тот же день. Но при этом обязательно оставьте достаточно времени, чтобы конвейер успел запуститься между временем публикации и временем окончания. Триггер вступит в силу только после публикации решения в службе "Фабрика данных", а не сразу при сохранении триггера в пользовательском интерфейсе. 

    ![Настройки триггера](./media/quickstart-create-data-factory-portal/trigger-settings.png)
4. Установите флажок **Активировано** на странице **Новый триггер** и нажмите кнопку **Далее**. 

    ![Настройки триггера — кнопка "Далее"](./media/quickstart-create-data-factory-portal/trigger-settings-next.png)
5. На странице **Новый триггер** просмотрите предупреждающее сообщение и щелкните **Готово**.

    ![Настройки триггера — кнопка "Готово"](./media/quickstart-create-data-factory-portal/new-trigger-finish.png)
6. Щелкните **Опубликовать**, чтобы перенести изменения в службу "Фабрика данных". 

    ![Кнопка "Опубликовать"](./media/quickstart-create-data-factory-portal/publish-2.png)
8. Перейдите на вкладку **Мониторинг** слева. Чтобы обновить список, щелкните **Обновить**. Вы увидите, что конвейер запускается каждую минуту в течение всего периода — от времени публикации до времени окончания. Обратите внимание на значения в столбце **Активировано**. Здесь указан запуск вручную, который вы выполняли на предыдущем шаге (**Trigger Now** (Запустить сейчас)). 

    ![Мониторинг запусков по триггеру](./media/quickstart-create-data-factory-portal/monitor-triggered-runs.png)
9. Щелкните стрелку вниз рядом с областью **Pipeline Runs** (Запуски конвейера), чтобы перейти к представлению **Trigger Runs** (Запуски триггеров). 

    ![Мониторинг запусков триггеров](./media/quickstart-create-data-factory-portal/monitor-trigger-runs.png)    
10. Убедитесь, что для каждого запуска конвейера в папке **output** создается **выходной файл** вплоть до указанного времени окончания. 

## <a name="next-steps"></a>Дополнительная информация
В этом примере конвейер копирует данные из одного расположения в другое в хранилище BLOB-объектов Azure. Перейдите к [руководствам](tutorial-copy-data-portal.md), чтобы узнать об использовании фабрики данных в различных сценариях. 