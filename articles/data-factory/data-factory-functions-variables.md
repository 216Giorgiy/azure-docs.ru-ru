<properties 
    pageTitle="Функции и системные переменные фабрики данных | Microsoft Azure" 
    description="Содержит список функций и системных переменных фабрики данных Azure." 
    documentationCenter="" 
    authors="sharonlo101" 
    manager="jhubbard" 
    editor="monicar"
    services="data-factory"
/>

<tags 
    ms.service="data-factory" 
    ms.workload="data-services" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/11/2016" 
    ms.author="shlo"/>


# <a name="azure-data-factory---functions-and-system-variables"></a>Фабрика данных Azure — функции и системные переменные
В этой статье содержатся сведения о функциях и переменных, поддерживаемых фабрикой данных Azure.
  
## <a name="data-factory-system-variables"></a>Системные переменные фабрики данных

Имя переменной | Описание | Область объекта | Область JSON и примеры использования
------------- | ----------- | ------------ | ------------------------
WindowStart | Начало интервала времени для текущего окна запуска действия. | действие | <ol><li>Укажите запросы на выбор данных. Ознакомьтесь со статьями о соединителях, упомянутых в статье [Действия перемещения данных](data-factory-data-movement-activities.md).</li><li>Передайте параметры в сценарий Hive (пример показан выше).</li>
WindowEnd | Конец интервала времени для текущего окна запуска действия. | действие | то же, что и выше
SliceStart | Начало интервала времени для формируемого среза данных. | действие<br/>набор данных | <ol><li>Укажите динамические пути к папкам и имена файлов при работе с [большими двоичными объектами Azure](data-factory-azure-blob-connector.md) и [наборами данных файловой системы](data-factory-onprem-file-system-connector.md).</li><li>Укажите входные зависимости с помощью функций фабрики данных в коллекции входных данных действия.</li></ol>
SliceEnd | Конец интервала времени для текущего формируемого среза данных. | действие<br/>набор данных | то же, что и выше 

> [AZURE.NOTE] В настоящее время для фабрики данных требуется, чтобы расписание, указанное в действии, в точности соответствовало расписанию, указанному в разделе доступности выходного набора данных. Это значит, что WindowStart, WindowEnd, SliceStart и SliceEnd всегда сопоставляются с одним и тем же периодом времени и одиночным выходным срезом.
 
## <a name="data-factory-functions"></a>Функции фабрики данных 

Функции фабрики данных можно использовать вместе с вышеупомянутыми системными переменными для следующих целей.

1.  Указание запросов выбора данных (см. статьи о соединителях, на которые ссылается статья [Действия перемещения данных](data-factory-data-movement-activities.md)).

    Синтаксис, необходимый для вызова функции фабрики данных, — это **$$<function>** (используется для запросов выбора данных и других свойств действий и наборов данных).  
2. Указание входных зависимостей с помощью функций фабрики данных в коллекции входных данных действия (см. пример выше).

    Префикс $$ не требуется при указании выражений входных зависимостей.   

В следующем примере свойству **sqlReaderQuery** в JSON-файле присваивается значение, возвращаемое функцией **Text.Format**. Кроме того, в этом примере используется системная переменная с именем **WindowStart**, которая отображает время начала для окна запуска действия.
    
    {
        "Type": "SqlSource",
        "sqlReaderQuery": "$$Text.Format('SELECT * FROM MyTable WHERE StartTime = \\'{0:yyyyMMdd-HH}\\'', WindowStart)"
    }

### <a name="functions"></a>Функции

В приведенных ниже таблицах перечислены все функции фабрики данных Azure.

Категория | Функция | Параметры | Описание
-------- | -------- | ---------- | ----------- 
Время | AddHours(X,Y) | X: DateTime  <br/><br/>Y: int | Добавляет Y часов к заданному времени X. <br/><br/>Пример: 05.09.2013 12:00:00 + 2 часа = 05.09.2013 14:00:00.
Время | AddMinutes(X,Y) | X: DateTime  <br/><br/>Y: int | Добавляет Y минут к Х.<br/><br/>Пример: 05.09.2013 12:00:00 + 15 минут = 05.09.2013 12:15:00.
Время | StartOfHour(X) | X: DateTime  | Получает то время, когда начинался час, отображаемый компонентом часа в параметре X. <br/><br/>Пример: параметр StartOfHour для 15.09.2013 17:10:23 имеет значение 15.09.2013 17:00:00.
Дата | AddDays(X,Y) | X: DateTime <br/><br/>Y: int | Добавляет Y дней к Х.<br/><br/>Пример: 15.09.2013 12:00:00 + 2 дня = 17.09.2013 12:00:00.
Дата | AddMonths(X,Y) | X: DateTime <br/><br/>Y: int | Добавляет Y месяцев к Х.<br/><br/>Пример: 15.09.2013 12:00:00 + 1 месяц = 17.10.2013 12:00:00. 
Дата | AddQuarters(X,Y) | X: DateTime  <br/><br/>Y: int | Добавляет Y * 3 месяцев к Х.<br/><br/>Пример: 15.09.2013 12:00:00 + 1 квартал = 15.12.2013 12:00:00.
Дата | AddWeeks(X,Y) | X: DateTime <br/><br/>Y: int | Добавляет Y (одна единица которого равна 7 дням) к X<br/><br/>Пример: 15.09.2013 12:00:00 + 1 неделя = 22.09.2013 12:00:00.
Дата | AddYears(X,Y) | X: DateTime <br/><br/>Y: int | Добавляет Y лет к Х.<br/><br/>Пример: 15.09.2013 12:00:00 + 1 год = 15.09.2014 12:00:00.
Дата | Day(X) | X: DateTime  | Возвращает значение дня для X.<br/><br/>Пример: для 15.09.2013 12:00:00 значение Day равно 9. 
Дата | DayOfWeek(X) | X: DateTime  | Возвращает значение дня недели для X.<br/><br/>Пример: для 15.09.2013 12:00:00 DayOfWeek равно Sunday.
Дата | DayOfYear(X) | X: DateTime  | Получает день года, представленный значением года параметра X.<br/><br/>Примеры:<br/>01.12.2015: 335 день 2015 года;<br/>31.12.2015: 365 день 2015 года;<br/>31.12.2016: 366 день 2016 года (високосного).
Дата | DaysInMonth(X) | X: DateTime  | Получает количество дней в месяце, представленном значением месяца параметра X.<br/><br/>Пример: для 15.09.2013 значение DaysInMonth равно 30, так как в сентябре 30 дней.
Дата | EndOfDay(X) | X: DateTime  | Получает значение даты и времени, которое соответствует окончанию суток (значения дня) в параметре X.<br/><br/>Пример: EndOfDay для 15.09.2013 17:10:23 имеет значение 15.09.2013 23:59:59.
Дата | EndOfMonth(X) | X: DateTime  | Получает значение конца месяца, представленного значением месяца параметра X. <br/><br/>Пример: для 15.09.2013 05:10:23 EndOfMonth имеет значение 30.09.2013 23:59:59 (дата и время конца сентября).
Дата | StartOfDay(X) | X: DateTime  | Получает начало суток, представленных значением дня в параметре X.<br/><br/>Пример: StartOfDay для 15.09.2013 17:10:23 имеет значение 15.09.2013 00:00:00.
DateTime | From(X) | X: String | Разбор строки X в значение даты и времени.
DateTime | Ticks(X) | X: DateTime  | Получает свойство тактов времени параметра X. Один такт равен 100 наносекундам. Значение этого свойства соответствует количеству тактов, прошедших с полуночи (24:00:00) 1 января 0001 года. 
текст | Format(X) | X: String (переменная) | Форматирует текст.

#### <a name="text.format-example"></a>Пример функции Text.Format

    "defines": { 
        "Year" : "$$Text.Format('{0:yyyy}',WindowStart)",
        "Month" : "$$Text.Format('{0:MM}',WindowStart)",
        "Day" : "$$Text.Format('{0:dd}',WindowStart)",
        "Hour" : "$$Text.Format('{0:hh}',WindowStart)"
    }

В разделе [Строки настраиваемых форматов даты и времени](https://msdn.microsoft.com/library/8kb3ddd4.aspx) описаны различные варианты форматирования, которые можно использовать (пример: гг и гггг). 

> [AZURE.NOTE] При использовании функции внутри другой функции нет необходимости использовать для внутренней функции префикс **$$** . Например, $$Text.Format('PartitionKey eq \\'my_pkey_filter_value\\' and RowKey ge \\'{0:yyyy-MM-dd HH:mm:ss}\\'', Time.AddHours(SliceStart, -6)). В этом примере обратите внимание, что префикс **$$** не используется для функции **Time.AddHours**. 
  




<!--HONumber=Oct16_HO2-->


