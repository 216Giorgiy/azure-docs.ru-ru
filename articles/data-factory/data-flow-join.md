---
title: Преобразование соединения в потоках данных Фабрики данных Azure
description: Преобразование соединения в потоках данных Фабрики данных Azure
author: kromerm
ms.author: makromer
ms.reviewer: douglasl
ms.service: data-factory
ms.topic: conceptual
ms.date: 02/07/2019
ms.openlocfilehash: 517afe21fbf9241e2b2423525e9caee12a5603f6
ms.sourcegitcommit: f715dcc29873aeae40110a1803294a122dfb4c6a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2019
ms.locfileid: "56271436"
---
# <a name="azure-data-factory-data-flow-join-transformation"></a>Преобразование соединения в потоках данных Фабрики данных Azure

[!INCLUDE [notes](../../includes/data-factory-data-flow-preview.md)]

С помощью преобразования соединения можно объединить данные из двух таблиц в потоке данных. Щелкните преобразование, которое будет левой связью, и добавьте преобразование соединения, выбрав его на панели элементов. Внутри преобразования соединения нужно выбрать другой поток данных из своего потока данных в качестве правой связи.

![Преобразование соединения](media/data-flow/join.png "соединение")

## <a name="join-types"></a>Типы соединений

Для преобразования соединения обязательно нужно выбрать тип соединения.

### <a name="inner-join"></a>Внутреннее соединение

Внутреннее соединение устанавливается только по тем записям, которые соответствуют условиям столбца в обеих таблицах.

### <a name="left-outer"></a>Левое внешнее соединение

Левое внешнее соединение устанавливается по записям левого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="right-outer"></a>Правое внешнее соединение

Правое внешнее соединение устанавливается по записям правого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="full-outer"></a>Полное внешнее соединение

Полное внешнее соединение возвращает все столбцы и записи с обеих сторон со значениями NULL для столбцов, которых нет в другой таблице.

### <a name="cross-join"></a>Перекрестное соединение

Конкретное перекрестное соединение двух потоков с использованием выражения.

## <a name="specify-join-conditions"></a>Указание условий соединения

Условие левого соединения относится к потоку данных, присоединенному слева от соединения. Условие правого соединения — это второй поток данных, присоединенный к соединению снизу, который будет либо прямым соединением с другим потоком, либо ссылкой на другой поток.

Необходимо ввести как минимум условие соединения 1 (1..n). Это могут быть поля, на которые есть прямые ссылки, которые выбраны из раскрывающегося меню или являются выражениями.

## <a name="join-performance-optimizations"></a>Оптимизация производительности соединений

В отличие от таких инструментов, как SQL Server Integration Services, соединение в Потоке данных ADF необязательно является операцией соединения слиянием. Поэтому ключи соединения не нужно изначально сортировать. Операция соединения будет происходить в Spark с использованием Databricks на основе оптимальной операции соединения в Spark: широковещательное соединение или соединение на стороне сопоставления.

![Оптимизация преобразования соединения](media/data-flow/joinoptimize.png "оптимизация соединения")

Если размер набора данных не превышает объем памяти рабочего узла Databricks, мы можем оптимизировать производительность соединения. Вы также можете указать секционирование своих данных в операции соединения, чтобы создавать наборы данных оптимального размера для объема памяти на один рабочий узел.

## <a name="self-join"></a>Самосоединение

Вы можете настроить условия самосоединения в Потоке данных ADF, используя преобразование выбора для добавления псевдонима к существующему потоку. Сначала создайте ветвь из потока, а затем добавьте преобразование выбора для добавления псевдонима ко всему исходному потоку.

![Самосоединение](media/data-flow/selfjoin.png "самосоединение")

В приведенной выше схеме преобразование выбора показано сверху. Оно присваивает исходному потоку псевдоним "OrigSourceBatting". В выделенном ниже преобразовании соединения этот поток с псевдонимом используется в качестве правой ветви соединения, что позволяет ссылаться на один и тот же ключ в левой и правой ветви внутреннего соединения.
