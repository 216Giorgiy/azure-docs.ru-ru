---
title: Создание триггеров на основе событий в Фабрике данных Azure | Документация Майкрософт
description: Узнайте, как создать в Фабрике данных Azure триггер, который запускает конвейер в ответ на событие.
services: data-factory
documentationcenter: ''
author: douglaslMS
manager: craigg
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 06/27/2018
ms.author: douglasl
ms.openlocfilehash: a9c15b239ee0bd0dde0b1f11691565b2676e3d07
ms.sourcegitcommit: f06925d15cfe1b3872c22497577ea745ca9a4881
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2018
ms.locfileid: "37062127"
---
# <a name="create-a-trigger-that-runs-a-pipeline-in-response-to-an-event"></a>Создание триггера, запускающего конвейер в ответ на событие

В этой статье описаны триггеры на основе событий, создаваемые в конвейерах Фабрики данных.

Управляемая событиями архитектура (EDA) — это общий шаблон интеграции данных, включающий в себя производство, обнаружение, потребление и реагирование на события. При выполнении сценариев интеграции данных клиентам Фабрики данных часто требуется запускать конвейеры на основе событий. Фабрика данных теперь интегрируется с [Сеткой событий Azure](https://azure.microsoft.com/services/event-grid/), что позволяет активировать конвейеры на основе событий.

## <a name="data-factory-ui"></a>Пользовательский интерфейс фабрики данных

### <a name="create-a-new-event-trigger"></a>Создание триггера события

Обычное событие — получение или удаление файла в учетной записи службы хранилища Azure. Вы можете создать триггер, реагирующий на это событие, в конвейере Фабрики данных.

> [!NOTE]
> Для этой интеграции поддерживаются только учетные записи хранения версии 2 (общего назначения).

![Создание триггера события](media/how-to-create-event-trigger/event-based-trigger-image1.png)

### <a name="select-the-event-trigger-type"></a>Выбор типа триггера события

Это событие запускает и выполняет конвейер Фабрики данных сразу после получения файла в месте хранения и создания большого двоичного объекта. Вы можете создать триггер, реагирующий на события создания или удаления большого двоичного объекта, а также на оба эти события в конвейерах Фабрики данных.

![Выбор типа триггера в качестве события](media/how-to-create-event-trigger/event-based-trigger-image2.png)

### <a name="configure-the-event-trigger"></a>Настройка триггера события

С помощью свойств **Blob path begins with** (Путь большого двоичного объекта начинается с) и **Blob path ends with** (Путь большого двоичного объекта заканчивается на) можно указать названия контейнеров, папок и больших двоичных объектов, для которых необходимо получать события. Вы можете использовать различные шаблоны для свойств **Blob path begins with** (Путь большого двоичного объекта начинается с) и **Blob path ends with** (Путь большого двоичного объекта заканчивается на), как показано в примерах далее в этой статье. Необходимо указать по крайней мере одно из этих свойств.

![Настройка триггера события](media/how-to-create-event-trigger/event-based-trigger-image3.png)

## <a name="json-schema"></a>Схема JSON

В таблице ниже приводится обзор элементов схемы, относящихся к триггерам на основе событий:

| **Элемент JSON** | **Описание** | **Тип** | **Допустимые значения** | **Обязательный** |
| ---------------- | --------------- | -------- | ------------------ | ------------ |
| **scope** | Идентификатор ресурса Azure Resource Manager учетной записи хранения. | Строка | Идентификатор Azure Resource Manager | Yes |
| **events** | Тип событий, вызывающих срабатывание триггера. | Массив,    | Microsoft.Storage.BlobCreated, Microsoft.Storage.BlobDeleted | Да, вы можете использовать любую комбинацию. |
| **blobPathBeginsWith** | Путь большого двоичного объекта должен начинаться с шаблона, указанного для срабатывания триггера. Например /records/blobs/december/ приведет к срабатыванию только больших двоичных объектов в папке за декабрь в контейнере записей. | Строка   | | Необходимо указать по крайней мере одно из этих свойств: blobPathBeginsWith, blobPathEndsWith. |
| **blobPathEndsWith** | Путь большого двоичного объекта должен заканчиваться на шаблон, указанный для срабатывания триггера. Например, december/boxes.csv приведет к срабатыванию только триггера для больших двоичных объектов с именем boxes в папке за декабрь. | Строка   | | Необходимо указать по крайней мере одно из этих свойств: blobPathBeginsWith, blobPathEndsWith. |

## <a name="examples-of-event-based-triggers"></a>Примеры триггеров на основе событий

В этом разделе приведены примеры параметров триггера на основе событий.

-   **Blob path begins with** (Путь большого двоичного объекта начинается с) ("/имя_контейнера/") — получает события для любого большого двоичного объекта в контейнере.
-   **Blob path begins with** (Путь большого двоичного объекта начинается с) ("/имя_контейнера/BLOB-объекты/имя_папки") — получает события любого BLOB-объекта в контейнере "имя_контейнера" и папке "имя_папки".
-   **Blob path begins with** (Путь большого двоичного объекта начинается с) ("/имя_контейнера/BLOB-объекты/имя_папки/файл.txt") — получает события для BLOB-объекта с именем "файл.txt" в папке "имя_папки" в контейнере "имя_контейнера".
-   **Blob path ends with** (Путь большого двоичного объекта заканчивается на) (файл.txt) — получает события для большого двоичного объекта с именем "файл.txt" во всех путях.
-   **Blob path ends with** (Путь большого двоичного объекта заканчивается на) ("/имя_контейнера/BLOB-объекты/файл.txt") — получает события для BLOB-объекта с именем "файл.txt" в контейнере "имя_контейнера".
-   **Blob path ends with** (Путь большого двоичного объекта заканчивается на) ("имя_папки/файл.txt") — получает события для большого двоичного объекта с именем "файл.txt" в папке "имя_папки" в любом контейнере.

> [!NOTE]
> Каждый раз, когда вы указываете контейнер и папку, контейнер и файл или контейнер, папку и файл, добавляйте сегмент пути `/blobs/`.

## <a name="using-blob-events-trigger-properties"></a>Использование свойств триггера событий BLOB-объектов

Когда срабатывает триггер событий BLOB-объектов, для конвейера становятся доступными две переменные: *folderPath* и *fileName*. Чтобы получить к ним доступ, используйте выражение `@triggerBody().fileName` или `@triggerBody().folderPath`.

Например, рассмотрим триггер, настроенный на срабатывание при создании BLOB-объекта со значением `.csv` для параметра `blobPathEndsWith`. Если CSV-файл попадает в учетную запись хранения, *folderPath* и *fileName* описывают его расположение. Например, *folderPath* имеет значение `/containername/foldername/nestedfoldername`, а *fileName* — значение `filename.csv`.

## <a name="next-steps"></a>Дополнительная информация
Дополнительные сведения см. в руководстве по [выполнению конвейера и использованию триггеров](concepts-pipeline-execution-triggers.md#triggers).
