---
title: Мониторинг конвейеров фабрики данных Azure и управление ими
description: Узнайте, как отслеживать фабрики данных и конвейеры Azure и управлять ими с помощью приложения по мониторингу и управлению.
services: data-factory
documentationcenter: ''
author: spelluru
manager: jhubbard
editor: monicar

ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/06/2016
ms.author: spelluru

---
# Мониторинг конвейеров фабрики данных Azure и управление ими с помощью нового приложения по мониторингу и управлению
> [!div class="op_single_selector"]
> * [Использование портала Azure или Azure PowerShell](data-factory-monitor-manage-pipelines.md)
> * [Использование приложения по мониторингу и управлению](data-factory-monitor-manage-app.md)
> 
> 

В этой статье описываются процедуры мониторинга, управления и отладки конвейеров, а также создания оповещений для получения уведомлений о сбоях с помощью **приложения по мониторингу и управлению**. Посмотрите следующий видеоролик, чтобы узнать, как использовать приложение управления и мониторинга.

> [!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Azure-Data-Factory-Monitoring-and-Managing-Big-Data-Piplines/player]
> 
> 

## Запуск приложения по мониторингу и управлению
Чтобы запустить приложение по мониторингу и управлению, щелкните элемент **Мониторинг и управление** в колонке **ФАБРИКА ДАННЫХ** для фабрики данных.

![Элемент "Мониторинг" на домашней странице фабрики данных](./media/data-factory-monitor-manage-app/MonitoringAppTile.png)

Приложение по мониторингу и управлению будет запущено в отдельном окне или вкладке.

![Приложение по мониторингу и управлению](./media/data-factory-monitor-manage-app/AppLaunched.png)

> [!NOTE]
> Если веб-браузер завис на действии "Авторизация...", отключите параметр или снимите флажок **Block third-party cookies and site data** (Блокировать сторонние файлы cookie и данные сайта). Либо оставьте флажок и создайте исключение для адреса **login.microsoftonline.com**, а затем попробуйте запустить приложение еще раз.
> 
> 

Если окна действий не отображаются в нижней части, на панели инструментов нажмите кнопку **Обновить**, чтобы обновить список. Кроме того, установите правильные значения для фильтров **Время начала** и **Время окончания**.

## Общие сведения о приложении по мониторингу и управлению
В левой части находятся три вкладки (**Обозреватель ресурсов**, **Monitoring Views** (Представления мониторинга) и **Оповещения**). Первая вкладка ("Обозреватель ресурсов") выбрана по умолчанию.

### Обозреватель ресурсов
Отображается следующее:

* **представление в виде дерева** обозревателя ресурсов в левой области;
* **представление схемы** в верхней части страницы;
* список **окон действий** на нижней панели в центре страницы;
* вкладки **Свойства** и **Activity Window Explorer** (Обозреватель окон действий) в правой области.

В обозревателе ресурсов все ресурсы (конвейеры, наборы данных, связанные службы) в фабрике данных отображаются в представлении в виде дерева. При выборе объекта в обозревателе ресурсов вы заметите следующее:

* связанная сущность фабрики данных будет выделена в представлении схемы;
* связанные окна действий (щелкните [здесь](data-factory-scheduling-and-execution.md) для получения сведений о них) будут выделены в списке Activity Windows (Окна действий) в нижней части экрана;
* свойства выбранного объекта будут отображаться в окне "Свойства" в правой области.
* определение JSON выбранного объекта, если это применимо. Например: связанная служба, или набор данных, или конвейер.

![Обозреватель ресурсов](./media/data-factory-monitor-manage-app/ResourceExplorer.png)

Дополнительные сведения об окнах действий см. в статье [Планирование и исполнение с использованием фабрики данных](data-factory-scheduling-and-execution.md).

### Представление схемы
Представление схемы позволяет отслеживать состояние фабрики данных и всех ее ресурсов, а также управлять ими. При выборе сущности фабрики данных (набора данных или конвейера) в представлении схемы вы заметите следующее:

* сущность фабрики данных будет выбрана в представлении в виде дерева;
* связанные окна действий будут выделены в списке "Окна действий";
* свойства выбранного объекта будут отображаться в окне "Свойства".

Если конвейер включен (не находится в приостановленном состоянии), он отображается с зеленой линией.

![Выполняющийся конвейер](./media/data-factory-monitor-manage-app/PipelineRunning.png)

В представлении схемы для конвейера доступны три кнопки. Вторая кнопка используется для приостановки конвейера. Во время приостановки текущие выполняющиеся действия не останавливаются, а завершаются до конца. Третья кнопка используется для приостановки конвейера и завершения текущих выполняющихся действий. Первая кнопка позволяет возобновить работу конвейера. Если конвейер приостановлен, цвет соответствующего элемента меняется, как показано ниже.

![Кнопки приостановки и возобновления на элементе](./media/data-factory-monitor-manage-app/SuspendResumeOnTile.png)

Можно выбрать два конвейера или более (используя клавишу CTRL) и с помощью кнопок панели команд приостанавливать или возобновлять работу нескольких конвейеров одновременно.

![Приостановка или возобновление на панели команд](./media/data-factory-monitor-manage-app/SuspendResumeOnCommandBar.png)

Чтобы просмотреть все действия в конвейере, щелкните элемент конвейера правой кнопкой мыши и выберите команду **Открыть конвейер**.

![Меню открытия конвейера](./media/data-factory-monitor-manage-app/OpenPipelineMenu.png)

В открывшемся представлении конвейера вы увидите все действия в конвейере. В этом примере в конвейере существует только одно действие — действие копирования. Чтобы перейти к предыдущему представлению, щелкните имя фабрики данных в меню навигации вверху.

![Открытый конвейер](./media/data-factory-monitor-manage-app/OpenedPipeline.png)

При щелчке выходного набора данных или наведении на него указателя мыши в представлении конвейера вы увидите всплывающее окно Activity Windows (Окна действий) для этого набора данных.

![Всплывающее окно "Окна действий"](./media/data-factory-monitor-manage-app/ActivityWindowsPopup.png)

Щелкните окно действий, чтобы просмотреть сведения о нем в окне **Свойства** в правой области.

![Свойства окна действия](./media/data-factory-monitor-manage-app/ActivityWindowProperties.png)

Чтобы просмотреть дополнительные сведения, в правой области перейдите на вкладку **Activity Window Explorer** (Обозреватель окон действий).

![Обозреватель окон действий](./media/data-factory-monitor-manage-app/ActivityWindowExplorer.png)

Вы также увидите **разрешенные переменные** для каждой попытки запуска действия в разделе **Попытки**.

![Разрешенные переменные](./media/data-factory-monitor-manage-app/ResolvedVariables.PNG)

Перейдите на вкладку **Скрипт**, чтобы просмотреть определение скриптов JSON для выбранного объекта.

![Вкладка "Скрипт"](./media/data-factory-monitor-manage-app/ScriptTab.png)

Окна действий можно просматривать в трех местах:

* всплывающее окно Activity Windows (Окна действий) в представлении схемы (средняя область);
* обозреватель окон действий в правой области;
* список "Окна действий" в нижней области.

Во всплывающем окне Activity Windows (Окна действий) и в обозревателе окон действий можно перейти к прошлой неделе, используя кнопки со стрелками влево и вправо.

![Кнопки со стрелками вправо и влево в обозревателе окон действий](./media/data-factory-monitor-manage-app/ActivityWindowExplorerLeftRightArrows.png)

В нижней части представления схемы находятся кнопки для увеличения и уменьшения масштаба, выбора 100-процентного масштаба, масштаба по размеру и блокировки структуры схемы. Кнопка блокировки структуры включена по умолчанию. Она позволяет предотвратить случайное перемещение таблиц и конвейеров в представлении схемы. Ее можно отключить и перемещать объекты в рамках схемы. Если кнопка отключена, для автоматического размещения таблиц и конвейеров можно использовать последнюю кнопку. Увеличивать или уменьшать масштаб можно также с помощью колесика мыши.

![Команды изменения масштаба в представлении схемы](./media/data-factory-monitor-manage-app/DiagramViewZoomCommands.png)

### Список "Окна действий"
В списке "Окна действий" в нижней части средней области отображаются все окна действий для набора данных, выбранного в обозревателе ресурсов или представлении схемы. По умолчанию список отсортирован по убыванию. Это значит, что в его верхней части находится самое последнее окно действия.

![Список "Окна действий"](./media/data-factory-monitor-manage-app/ActivityWindowsList.png)

Этот список не обновляется автоматически, поэтому воспользуйтесь кнопкой "Обновить" на панели инструментов, чтобы обновить его вручную.

Окна действий могут находиться в одном из указанных ниже состояний.

<table>
<tr>
    <th align="left">Состояние</th><th align="left">Подсостояние</th><th align="left">Описание</th>
</tr>
<tr>
    <td rowspan="8">Waiting</td><td>ScheduleTime</td><td>Время выполнения окна действия еще не наступило.</td>
</tr>
<tr>
<td>DatasetDependencies</td><td>Восходящие зависимости не готовы.</td>
</tr>
<tr>
<td>ComputeResources</td><td>Вычислительные ресурсы недоступны.</td>
</tr>
<tr>
<td>ConcurrencyLimit</td> <td>Все экземпляры действия заняты выполнением других окон действий.</td>
</tr>
<tr>
<td>ActivityResume</td><td>Действие приостановлено, и до его возобновления выполнять окна действий нельзя.</td>
</tr>
<tr>
<td>Retry</td><td>Действие будет выполнено повторно.</td>
</tr>
<tr>
<td>Проверка</td><td>Проверка еще не начата.</td>
</tr>
<tr>
<td>ValidationRetry</td><td>Ожидание повторения проверки.</td>
</tr>
<tr>
&lt;tr
<td rowspan="2">InProgress</td><td>Validating</td><td>Проверка выполняется.</td>
</tr>
<td></td>
<td>Выполняется обработка окна действия.</td>
</tr>
<tr>
<td rowspan="4">Сбой</td><td>TimedOut</td><td>Выполнение заняло больше времени, чем это разрешено для действия.</td>
</tr>
<tr>
<td>Canceled</td><td>Отменено пользователем.</td>
</tr>
<tr>
<td>Проверка</td><td>Сбой проверки.</td>
</tr>
<tr>
<td></td><td>Не удалось создать и (или) проверить окно действия.</td>
</tr>
<td>Ready</td><td></td><td>Окно действия готово к использованию.</td>
</tr>
<tr>
<td>Skipped</td><td></td><td>Окно действия на обрабатывается.</td>
</tr>
<tr>
<td>None</td><td></td><td>Окно действия, которое ранее существовало с другим состоянием, но было сброшено.</td>
</tr>
</table>


При выборе окна действия в списке вы увидите сведения о нем в **обозревателе окон действий** или в окне **Свойства** в правой части.

![Обозреватель окон действий](./media/data-factory-monitor-manage-app/ActivityWindowExplorer-2.png)

### Обновление окон действий
Данные не обновляются автоматически, поэтому воспользуйтесь кнопкой **Обновить** (вторая по счету) на панели команд, чтобы обновить список окон действий вручную.

### Окно "Свойства"
Окно "Свойства" доступно в правой области приложения по мониторингу и управлению.

![Окно "Свойства"](./media/data-factory-monitor-manage-app/PropertiesWindow.png)

В нем отображаются свойства для элемента, выбранного в обозревателе ресурсов (в представлении в виде дерева), представлении схемы или списке "Окна действий".

### Обозреватель окон действий
Окно **Activity Window Explorer** (Обозреватель окон действий) находится в правой области приложения по мониторингу и управлению. В нем отображаются сведения об окне действия, выбранном во всплывающем окне или списке Activity Windows (Окна действий).

![Обозреватель окон действий](./media/data-factory-monitor-manage-app/ActivityWindowExplorer-3.png)

Вы можете переключиться между окнами действий, щелкнув нужное окно в представлении календаря в верхней части. Чтобы просмотреть окна действий на прошлой или следующей неделе, используйте кнопки **Стрелка влево** и **Стрелка вправо** в верхней части.

Чтобы **повторно выполнить** окно действия или **обновить** сведения, используйте кнопки панели инструментов в нижней области.

### Скрипт
Откройте вкладку **Скрипт**, чтобы просмотреть определение JSON выбранной сущности фабрики данных (связанную службу, набор данных и конвейер).

![Вкладка "Скрипт"](./media/data-factory-monitor-manage-app/ScriptTab.png)

## Использование системных представлений
Приложение по мониторингу и управлению содержит встроенные системные представления (**Recent activity windows** (Последние окна действий), **Failed activity windows** (Ошибки окон действий), **Progress activity windows** (Выполняющиеся окна действий)), позволяющие просматривать последние, завершившиеся ошибкой или выполняющиеся окна действий для фабрики данных.

В левой части откройте вкладку **Monitoring Views** (Представления мониторинга), щелкнув ее.

![Вкладка "Представления мониторинга"](./media/data-factory-monitor-manage-app/MonitoringViewsTab.png)

Сейчас поддерживаются три системных представления. Выберите, что нужно просмотреть в списке "Окна действий" (в нижней части средней области) — последние окна действий, завершившиеся ошибкой окна действий или выполняющиеся окна действий.

При выборе варианта **Recent activity windows** (Последние окна действий) будут отображены все последние окна действий в порядке убывания **времени последней попытки**.

В представлении **Failed activity windows** (Ошибки окон действий) в списке отображаются все завершившиеся ошибкой окна действий. Выберите в списке завершившееся ошибкой окно действия, чтобы просмотреть подробные сведения о нем в окне **Свойства** или в **обозревателе окон действий**. Можно также загрузить журналы для завершившегося ошибкой окна действия.

## Сортировка и фильтрация окон действий
Чтобы отфильтровать окна действий, измените значение параметров **Время начала** и **Время окончания** в командной строке. После изменения времени начала и окончания нажмите кнопку рядом с параметром "Время окончания", чтобы обновить список "Окна действий".

![Время начала и окончания](./media/data-factory-monitor-manage-app/StartAndEndTimes.png)

> [!NOTE]
> Сейчас в приложении по мониторингу и управлению все значения времени указываются в формате UTC.
> 
> 

В **списке окон действий** щелкните имя столбца (например, "Состояние").

![Меню столбца списка "Окна действий"](./media/data-factory-monitor-manage-app/ActivityWindowsListColumnMenu.png)

Можно сделать следующее:

* выполнить сортировку в порядке возрастания;
* выполнить сортировку в порядке убывания;
* выполнить фильтрацию по одному или нескольким значениям ("Готово", "Ожидание" и т. д.).

После указания фильтра в столбце будет активирована кнопка "Фильтр", указывающая, что значения в столбце являются отфильтрованными.

![Фильтр в столбце списка "Окна действий"](./media/data-factory-monitor-manage-app/ActivityWindowsListFilterInColumn.png)

Чтобы очистить фильтры, можно использовать то же самое всплывающее окно. Чтобы очистить все фильтры для списка "Окна действий", нажмите кнопку очистки фильтров на панели команд.

![Очистка всех фильтров в списке "Окна действий"](./media/data-factory-monitor-manage-app/ClearAllFiltersActivityWindowsList.png)

## Выполнение пакетных действий
### Повторное выполнение выбранных окон действий
Выберите окно действия, нажмите кнопку со стрелкой вниз (первая кнопка на панели команд) и выберите **Выполнить снова** или **Rerun with upstream in pipeline** (Повторно выполнить с параметром UpstreamInPipeline). При выборе варианта **Rerun with upstream in pipeline** (Повторно выполнить с параметром UpstreamInPipeline) также будут возвращены все вышестоящие окна действий. ![Повторное выполнение окна действия](./media/data-factory-monitor-manage-app/ReRunSlice.png)

Кроме того, в списке можно выбрать несколько окон действий и повторно выполнить сразу все эти окна. Вы можете отфильтровать окна действий на основе состояния (например, **Ошибка**), а после устранения причины сбоя запустить окна действий повторно. Дополнительные сведения о фильтрации окон действий см. в следующем разделе.

### Приостановка и возобновление нескольких конвейеров
Можно выбрать два конвейера или более (с помощью клавиши CTRL) и воспользоваться кнопками на панели команд (на следующем рисунке выделены красным прямоугольником), чтобы приостановить или возобновить все эти конвейеры одновременно.

![Приостановка или возобновление на панели команд](./media/data-factory-monitor-manage-app/SuspendResumeOnCommandBar.png)

## Создание оповещений
На странице "Оповещения" можно создать оповещение, а также просмотреть, изменить или удалить имеющееся оповещение. Можно также включить или отключить оповещение. Щелкните вкладку "Оповещения", чтобы открыть страницу оповещений.

![Вкладка "Оповещения"](./media/data-factory-monitor-manage-app/AlertsTab.png)

### Создание оповещения
1. Чтобы добавить оповещение, нажмите кнопку **Добавить оповещение**. Появится страница "Сведения".
   
    ![Создание оповещений — страница "Сведения"](./media/data-factory-monitor-manage-app/CreateAlertDetailsPage.png)
2. Укажите **имя** и введите **описание** оповещения, а затем нажмите кнопку **Далее**. Должна открыться страница **Фильтры**.
   
    ![Создание оповещений — страница "Фильтры"](./media/data-factory-monitor-manage-app/CreateAlertFiltersPage.png)
3. Выберите **событие**, **состояние** и **подсостояние** (необязательно), о которых служба фабрики данных должна выводить оповещение, а затем нажмите кнопку **Далее**. Откроется страница **Получатели**.
   
    ![Создание оповещений — страница "Получатели"](./media/data-factory-monitor-manage-app/CreateAlertRecipientsPage.png)
4. Выберите параметр **Email subscription admins** (Администраторы подписки электронной почты) и/или укажите значение параметра **Дополнительный адрес электронной почты администратора**, а затем нажмите кнопку **Готово**. Оповещение должно появиться в списке.
   
    ![Список "Оповещения"](./media/data-factory-monitor-manage-app/AlertsList.png)

В списке "Оповещения" используйте связанные с оповещением кнопки, чтобы изменить, удалить, включить или отключить оповещение.

### Событие, состояние и подсостояние
В приведенной далее таблице содержится список возможных событий и состояний (и подсостояний).

| Имя события | Состояние | Дополнительное состояние |
| --- | --- | --- |
| Выполнение действия начато |Started |Запуск |
| Выполнение действия завершено |Успешно |Успешно |
| Выполнение действия завершено |Сбой |Неудачное выделение ресурсов<br/><br/>Сбой при выполнении<br/><br/>Время ожидания истекло<br/><br/>Неудачная проверка<br/><br/>Прервано |
| Создание кластера HDI по запросу начато |Started |&nbsp; |
| Кластер HDI по запросу успешно создан |Успешно |&nbsp; |
| Кластер HDI по запросу удален |Успешно |&nbsp; |

### Изменение, удаление или отключение оповещения
![Кнопки оповещений](./media/data-factory-monitor-manage-app/AlertButtons.png)

<!---HONumber=AcomDC_0907_2016-->