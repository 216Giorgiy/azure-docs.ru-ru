<properties
    pageTitle="Создание облачной службы Hello World для Azure в Eclipse"
    description="Узнайте, как создать простое приложение Hello World с помощью набора средств Azure для Eclipse."
    services=""
    documentationCenter="java"
    authors="rmcmurray"
    manager="wpickett"
    editor=""/>

<tags
    ms.service="multiple"
    ms.workload="na"
    ms.tgt_pltfrm="multiple"
    ms.devlang="Java"
    ms.topic="article"
    ms.date="08/11/2016" 
    ms.author="robmcm"/>

<!-- Legacy MSDN URL = https://msdn.microsoft.com/library/azure/hh690944.aspx -->

# Создание облачной службы Hello World для Azure в Eclipse #

Приведенные здесь шаги демонстрируют, как создать и развернуть базовое приложение JSP в Azure с помощью набора средств Azure для Eclipse. Пример с JSP приведен для простоты, но при развертывании в Azure можно применять практически идентичные шаги для сервлета Java.

Приложение будет выглядеть следующим образом:

![][ic600360]

## Предварительные требования ##

* Java Developer Kit (JDK), версия 1.7 или более поздняя.
* Интегрированная среда разработки Eclipse для разработчиков Java EE, версия Indigo или более поздняя. Среду также можно загрузить с веб-страницы <http://www.eclipse.org/downloads/>.
* Дистрибутив веб-сервера или сервера приложений на основе Java, например Apache Tomcat, GlassFish, сервер приложений JBoss, Jetty или IBM® WebSphere® Application Server Liberty Core.
* Подписка Azure, которую можно получить на веб-странице <http://azure.microsoft.com/pricing/purchase-options/>.
* Набор средств Azure для Eclipse. Дополнительные сведения см. в статье [Установка набора средств Azure для Eclipse][].

## Создание приложения Hello World ##

Сначала необходимо создать проект Java.

*  Запустите Eclipse и в меню **Файл** щелкните **Создать**, а затем — **Динамический веб-проект**. (Если элемента **Динамический веб-проект** нет в списке доступных проектов после выбора пунктов **Файл**, **Создать**, сделайте следующее: последовательно щелкните **Файл**, **Создать**, **Проект...**, разверните узел **Интернет**, щелкните **Динамический веб-проект** и нажмите кнопку **Далее**.)
*  Для целей данного руководства присвойте проекту имя **MyHelloWorld**. (Обязательно используйте это имя, так как на последующих шагах в руководстве предполагается, что WAR-файл будет называться MyHelloWorld.) Экран будет выглядеть следующим образом:  

	![][ic589576]
* Нажмите кнопку **Готово**
* В окне обозревателя проектов в Eclipse разверните узел **MyHelloWorld**. Щелкните правой кнопкой мыши **WebContent**, выберите **Создать**, затем щелкните **JSP-файл**.
* В диалоговом окне **Новый JSP-файл** укажите для файла имя **index.jsp**. Сохраните родительскую папку с именем **MyHelloWorld/WebContent**, как показано в следующем примере:
	![][ic659262]
* В диалоговом окне **Выбор шаблона JSP** выберите **Новый JSP-файл (HTML)** и нажмите кнопку **Готово**.
* При открытии файла index.jsp в Eclipse добавьте в текст для динамического отображения фразу **Hello World!** в существующий элемент `<body>`. Обновленное содержимое элемента `<body>` должно иметь следующий вид:
```
    <body>
    <b><% out.println("Hello World!"); %></b>
    </body>
```
* Сохраните index.jsp.

## Простой и быстрый способ развернуть приложение в Azure ##

Как только веб-приложение Java готово к тестированию, можно использовать следующий упрощенный подход, чтобы опробовать его непосредственно в облаке Azure.

1. В обозревателе проектов Eclipse щелкните правой кнопкой мыши **MyHelloWorld**.
1. На панели инструментов Eclipse нажмите разворачивающуюся кнопку **Опубликовать**, а затем щелкните **Опубликовать как облачную службу Azure**  
	![][publishDropdownButton]
1. Если это приложение публикуется в Azure впервые, и ранее для него не был создан проект развертывания Azure, он будет создан автоматически. Вы увидите следующий запрос, в котором также указаны пакет JDK и сервер приложений, которые будут автоматически развернуты для запуска приложения.  
	![][ic789598]

    Этот упрощенный подход обеспечивает простой и быстрый способ тестирования приложения в Azure без необходимости настраивать конкретный сервер или JDK, которые отличаются от установленных по умолчанию. Если вас устраивают значения по умолчанию, нажмите кнопку **ОК**, чтобы перейти к следующим шагам. В то же время, если вы хотите изменить JDK или сервер приложений, которые будут использованы для вашего приложения, можно сделать это позже, изменив автоматически созданный проект развертывания Azure, или прямо сейчас нажмите кнопку **Отменить** и прочитайте раздел **О проектах развертывания Azure** этого руководства.
1. В диалоговом окне **Публикация в Azure**:
    1. Если список **Подписки** все еще пуст, выполните следующие действия для импорта сведений о подписке.
        1. Щелкните **Импорт из PUBLISHSETTINGS-файла**.
        1. В диалоговом окне **Import Subscription Information** (Импорт сведений о подписке) щелкните **Download PUBLISH-SETTINGS File** (Скачать PUBLISHSETTINGS-файл). Если вы еще не вошли в учетную запись Azure, вам будет предложено войти. Затем вам будет предложено сохранить файл настроек публикации Azure. Сохраните его на локальном компьютере.
        1. В диалоговом окне **Import Subscription Information** (Импорт сведений о подписке) нажмите кнопку **Обзор**, выберите файл настроек публикации, который был локально сохранен на предыдущем шаге, и нажмите кнопку **Открыть**. Экран должен выглядеть следующим образом: ![][ic644267]
        1. Нажмите кнопку **ОК**.
    1. В поле **Подписка** выберите подписку, которую вы хотите использовать для развертывания.
    1. В поле **Учетная запись хранения** выберите учетную запись хранения, которую требуется использовать, или нажмите кнопку **Создать**, чтобы создать учетную запись хранения.
    1. В поле **Имя службы** выберите облачную службу, которую требуется использовать, или нажмите кнопку **Создать**, чтобы создать облачную службу.
    1. В поле **Целевая ОС** выберите версию операционной системы, которую требуется использовать для развертывания.
    1. В поле **Целевая среда** для целей данного руководства выберите **Промежуточная**. (Когда вы будете готовы выполнить развертывание на рабочем сайте, можно будет изменить это значение на **Рабочая**.)
    1. (Дополнительно.) Если вы хотите, чтобы новое развертывание автоматически заменило собой предыдущее развертывание, следует установить флажок **Перезаписать предыдущее развертывание**. Это позволит вам предотвратить проблемы, связанные с ошибкой «409 Конфликт» при публикации в том же расположении. Обратите внимание, что диалоговое окно **Публикация в Azure** содержит раздел **Удаленный доступ**. По умолчанию удаленный доступ выключен, и мы не будем включать его в этом примере. Чтобы включить удаленный доступ, необходимо ввести имя пользователя и пароль для удаленного входа. Дополнительные сведения об удаленном доступе см. в статье [Включение удаленного доступа для развертываний Azure в Eclipse][]. Диалоговое окно **Публикация в Azure** будет выглядеть следующим образом: ![][ic719488]
1. Для публикации в промежуточной среде нажмите кнопку **Опубликовать**. При появлении запроса на выполнение полной сборки нажмите кнопку **Да**. Первая сборка может занять несколько минут. В разделе представлений с вкладками Eclipse откроется **журнал действий Azure**. ![][ic719489] Этот журнал, а также представление **Консоль** можно использовать, чтобы следить за ходом выполнения развертывания. Альтернативным вариантом является вход на [портал управления Azure][] и использование раздела **Облачные службы**.
1. После успешного развертывания в **журнале действий Azure** отобразится состояние **Опубликовано**. Щелкните **Опубликовано**, как показано на следующем рисунке, и в браузере откроется экземпляр развертывания.
![][ic719490]

Так как это было развертывание в промежуточной среде, DNS-имя будет иметь вид http://&lt;*guid*&gt;.cloudapp.net, а URL-адрес будет содержать DNS-имя и суффикс приложения. Например, http://447564652c20426f6220526f636b7321.cloudapp.net/MyHelloWorld. (В части **MyHelloWorld** учитывается регистр.) При щелчке имени развертывания на портале управления платформой Azure (в разделе «Облачные службы» на портале управления) отобразится DNS-имя.

Несмотря на то, что это пошаговое руководство предназначено для развертывания в промежуточной среде, для развертывания в рабочей среде выполняются точно такие же действия. Только в диалоговом окне **Публикация в Azure** для параметра **Целевая среда** необходимо выбрать **Рабочая** вместо **Промежуточная**. В результате развертывания в рабочей среде URL-адрес будет основан на выбранном вами DNS-имени, а не на GUID, используемом в промежуточной среде.

>[AZURE.WARNING] На этом этапе вы развернули приложение Azure в облаке. Но прежде чем продолжить, учтите, что развернутое приложение продолжает увеличивать оплачиваемое время вашей подписки, даже если оно не запущено. Поэтому крайне важно удалять ненужные развертывания из подписки Azure.

## О проектах развертывания Azure ##

Чтобы развернуть одно или несколько приложений Java в Azure, необходим проект развертывания Azure. Он выполняет роль пакета, в который должны заключаться приложения, чтобы быть опубликованными в Azure.

Помимо сведений о приложениях проект развертывания Azure также содержит информацию о других ключевых компонентах развертывания, главные из которых: контейнер сервера приложений, в котором запускается веб-приложение, и среда выполнения Java. В Azure доступно большое количество сред выполнения Java и серверов приложений Java.

Несмотря на то, что приведенный пример значительно упрощен в целях обучения, проект развертывания Azure также может содержать другие важные сведения о конфигурации, позволяющие создавать довольно сложные масштабируемые, высокодоступные, многоуровневые облачные службы в приложениях. Можно включить **сходство сеансов («прикрепленные сеансы»)**, **быстрое кэширование**, **удаленную отладку**, **разгрузку SSL**, **маршрутизацию брандмауэра и порта**, **удаленный доступ** и ряд других эффективных возможностей.

Если вы выполнили действия в предыдущем разделе этого руководства («Простой и быстрый способ развертывания приложения в Azure»), теперь в обозревателе проектов будет отображаться новый автоматически созданный проект развертывания Azure с именем **MyHelloWorld\_onAzure**.

Можно также начать с самостоятельного создания пустого проекта развертывания Azure, а затем добавить в него приложения. Это более длинный путь, но таким образом вы сможете лучше управлять начальной конфигурацией.

Чтобы создать проект развертывания Azure с нуля, нажмите кнопку ![][ic710876] **Создать проект развертывания Azure**.

Независимо от того, работаете ли вы с уже существующим проектом развертывания Azure или создаете его с нуля, в любой момент можно изменить его параметры конфигурации и компоненты, такие как JDK или сервер приложений.

Чтобы изменить JDK, сервер приложений или список приложений в существующем проекте развертывания Azure сделайте следующее:

1. В обозревателе проектов разверните узел проекта (например, **MyHelloWorld\_onAzure**).
2. Щелкните правой кнопкой мыши **WorkerRole1**.
3. В контекстном меню разверните подменю **Azure**.
4. Щелкните **Конфигурация сервера**.

Вне зависимости от того, перешли ли вы к конфигурации сервера путем внесения изменений в существующий проект развертывания Azure, как показано выше, или путем создания нового проекта с нуля, вы увидите те же диалоговые окна для настройки компонентов JDK, сервера и приложения. Дополнительные сведения об изменении параметров в этих диалоговых окнах, например, изменение JDK, сервера приложений, и о добавлении или удалении приложений в развертывании, см. в статье [Свойства конфигурации сервера][].

## Только для Windows. Развертывание приложения в эмуляторе вычислений ##

>[AZURE.NOTE] Эмулятор Azure доступен только в Windows. Этот раздел можно пропустить, если вы используете другую операционную систему.

Если вы создали проект развертывания Azure, следуя описанным выше действиям, а именно неявно путем публикации приложения в Azure, то JDK и серверы приложения были настроены для облака, а не для локальной эмуляции. Чтобы подготовить проект для тестирования в локальном эмуляторе, сделайте следующее:

1. В обозревателе проектов Eclipse щелкните **MyHelloWorld\_onAzure**.
1. Щелкните правой кнопкой мыши **WorkerRole1**.
1. В контекстном меню разверните подменю **Azure**.
1. Щелкните **Конфигурация сервера**.
1. На вкладке **JDK** проверьте, выполнил ли набор средств предварительную настройку локального JDK. Если нет или если требуется изменить предложенные значения по умолчанию, следует установить флажок **Использовать JDK из этого пути к файлу для локального тестирования**, а также задать желаемый путь установки JDK. Если вы хотите изменить его, нажмите кнопку **Обзор** и с помощью элемента управления «Обзор» выберите расположение каталога JDK, которое требуется использовать.
1. Откройте вкладку **Сервер**.
1. В текстовом поле **Путь к локальному серверу** в нижней части диалогового окна введите путь к локально установленному серверу, который соответствует типу и номеру основной версии сервера, выбранному в верхней части диалогового окна под флажком **Развернуть сервер этого типа**. Если вы хотите использовать другой тип или основную версию сервера приложений, сначала измените выбор в списке под этим флажком.
1. Нажмите кнопку **ОК**.
1. На панели инструментов Eclipse нажмите кнопку ![][ic710879] **Запуск в эмуляторе Azure**. Если кнопка **Запуск в эмуляторе Azure** недоступна, убедитесь, что в обозревателе проектов Eclipse выбрано **MyHelloWorld\_onAzure** и открыто текущее окно. Сначала будет запущена полная сборка проекта, после которой в эмуляторе вычислений запустится веб-приложение Java. (Обратите внимание, что в зависимости от характеристик производительности компьютера первая сборка может занять от нескольких секунд до нескольких минут, но последующие сборки будут запускаться быстрее.) После выполнения первого шага сборки служба контроля учетных записей Windows (UAC) выведет запрос на разрешение этой команды для внесения изменений в компьютер. Щелкните **Да**.

>[AZURE.IMPORTANT] Если запрос UAC не отображается, найдите на панели задач Windows значок UAC и щелкните его. Иногда запрос UAC не отображается поверх всех окон, а виден только как значок на панели задач.

1. Проанализируйте выходные данные в пользовательском интерфейсе эмулятора вычислений, чтобы определить наличие проблем с проектом. В зависимости от содержимого развертывания для полного запуска приложения в эмуляторе вычислений может потребоваться несколько минут.
1. Запустите браузер и используйте URL-адрес `http://localhost:8080/MyHelloWorld` в качестве адреса (в части `MyHelloWorld` URL-адреса учитывается регистр). Приложение MyHelloWorld (выходные данные index.jsp) должно выглядеть следующим образом:  
	![][ic589579]

Когда вы будете готовы остановить выполнение приложения в эмуляторе вычислений, на панели инструментов Eclipse нажмите кнопку ![][ic710880] **Сбросить эмулятор Azure**.

## Удаление развертывания ##

Чтобы удалить развертывание в наборе средств Azure для Eclipse, убедитесь, что в обозревателе проектов Eclipse выбрано **MyHelloWorld\_onAzure** и открыто текущее окно, а затем на панели инструментов Eclipse нажмите кнопку ![][ic710883] **Отменить публикацию**. (Эту же операцию можно выполнить, щелкнув правой кнопкой мыши **MyHelloWorld\_onAzure** в обозревателе проектов Eclipse, выбрав **Azure** и **Отменить развертывание в облаке Azure**.) Откроется диалоговое окно **Отмена публикации проекта Azure**.

![][ic719491]

Выберите подписку и облачную службу, содержащую развертывание, выберите развертывание, которое требуется удалить, и нажмите кнопку **Отменить публикацию**.

Вместо набора средств для удаления развертывания можно воспользоваться разделом **Облачные службы** на портале управления Azure. Перейдите к развертыванию, выберите его и нажмите кнопку **Удалить**. Развертывание будет остановлено, а затем удалено. Если требуется только остановить развертывание, но не удалять его, вместо кнопки **Удалить** нажмите кнопку **Остановить** (но, как было сказано выше, если развертывание не будет удалено, его оплачиваемое время будет увеличиваться, даже если оно не выполняется).

## См. также ##

[Набор средств Azure для Eclipse][]

[Установка набора средств Azure для Eclipse][]

[Новые возможности набора средств Azure для Eclipse][]

Дополнительные сведения об использовании Azure с Java можно найти в [центре разработчиков Java для Azure][].

.<!-- URL List -->

[центре разработчиков Java для Azure]: http://go.microsoft.com/fwlink/?LinkID=699547
[портал управления Azure]: http://go.microsoft.com/fwlink/?LinkID=512959
[Azure Role Properties]: http://go.microsoft.com/fwlink/?LinkID=699525
[Набор средств Azure для Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699529
[Включение удаленного доступа для развертываний Azure в Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699538
[Установка набора средств Azure для Eclipse]: http://go.microsoft.com/fwlink/?LinkId=699546
[Свойства конфигурации сервера]: http://go.microsoft.com/fwlink/?LinkID=699525#server_configuration_properties
[Новые возможности набора средств Azure для Eclipse]: http://go.microsoft.com/fwlink/?LinkID=699552

.<!-- IMG List -->

[ic589576]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic589576.png
[ic589579]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic589579.png
[ic600360]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic600360.png
[ic644267]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic644267.png
[ic659262]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic659262.png
[ic710876]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic710876.png
[ic710879]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic710879.png
[ic710880]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic710880.png
[ic710882]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic710882.png
[ic710883]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic710883.png
[ic719488]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic719488.png
[ic719489]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic719489.png
[ic719490]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic719490.png
[ic719491]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic719491.png
[ic789598]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/ic789598.png
[publishDropdownButton]: ./media/azure-toolkit-for-eclipse-creating-a-hello-world-application/publishDropdownButton.png

<!---HONumber=AcomDC_0817_2016--->