---
title: Что такое шлюз приложений Azure
description: Сведения об использовании шлюза приложений Azure для управления веб-трафиком для вашего приложения.
services: application-gateway
author: vhorne
manager: jpconnock
ms.service: application-gateway
ms.topic: overview
ms.custom: mvc
ms.workload: infrastructure-services
ms.date: 4/9/2018
ms.author: victorh
ms.openlocfilehash: 3824eacb355c323a1850f6863ae2b99970c62cfb
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
ms.locfileid: "32151167"
---
# <a name="what-is-azure-application-gateway"></a>Что такое шлюз приложений Azure?

Шлюз приложений Azure — это подсистема балансировки нагрузки веб-трафика, предназначенная для управления трафиком веб-приложений. 

Традиционные подсистемы балансировки нагрузки работают на транспортном уровне (уровень 4 OSI — протокол TCP и UDP) и маршрутизируют трафик к IP-адресу и порту назначения на основе исходного IP-адреса и порта. Однако с использованием шлюза приложений можно еще больше уточнить запросы. Например, вы можете маршрутизировать трафик на основании входящего URL-адреса. Поэтому если во входящем URL-адресе есть `/images`, вы можете осуществлять маршрутизацию трафика к определенному набору серверов (известных как пул), настроенных для изображений. Если в URL-адресе есть `/video`, то этот трафик направляется к другому пулу, оптимизированному для видео.

![imageURLroute](./media/application-gateway-url-route-overview/figure1-720.png)

Этот тип маршрутизации называется балансировкой нагрузки прикладного уровня (уровень 7 OSI). Шлюз приложений Azure может выполнять маршрутизацию и многое другое на основе URL-адреса. Шлюз приложений Azure включает следующие возможности. 

## <a name="url-based-routing"></a>Маршрутизация на основе URL-адреса

Маршрутизация на основе URL-путей позволяет направлять трафик в пулы тыловых серверов в зависимости от URL-путей поступающих запросов. Один из сценариев — это маршрутизация запросов различных типов содержимого в различные пулы.

Например, запросы для `http://contoso.com/video/*` направляются в VideoServerPool, а `http://contoso.com/images/*` — в ImageServerPool. Если ни один из шаблонов пути не подходит, выбирается пул DefaultServerPool.

## <a name="redirection"></a>Перенаправление

Обычный сценарий для многих веб-приложений — это поддержка автоматического перенаправления с HTTP на HTTPS, чтобы все взаимодействия между приложением и его пользователями осуществлялись по зашифрованному пути. 

В прошлом вы могли использовать такие методы, как создание выделенного пула, единственным назначением которого было перенаправление запросов, получаемых по HTTP, на HTTPS. Шлюз приложения поддерживает возможность перенаправления трафика на шлюз приложений. Это упрощает конфигурацию приложения, оптимизирует использование ресурсов и обеспечивает поддержку новых сценариев перенаправления, включая глобальное перенаправление на основе пути. Поддержка перенаправления для шлюза приложений не ограничена лишь перенаправлением с HTTP на HTTPS. Это универсальный механизм перенаправления, позволяющий перенаправить трафик с любого порта и на любой порт, определяемый с помощью правил. Также поддерживается перенаправление на внешние веб-сайты.

Возможности поддержки перенаправления для шлюза приложений:

- Глобальное перенаправление с одного порта на другой через шлюз. Это позволяет организовать на сайте перенаправление с HTTP на HTTPS.
- Перенаправление на основе пути. Этот тип перенаправления позволяет организовать перенаправление с HTTP на HTTPS только на указанную область сайта, например в область корзины для покупок, которая обозначается как `/cart/*`.
- Перенаправление на внешний сайт

## <a name="multiple-site-hosting"></a>Размещение нескольких сайтов

Размещение нескольких сайтов позволяет настроить в одном экземпляре шлюза приложений несколько веб-сайтов. Эта функция позволяет настроить более эффективную топологию развернутых служб, добавляя до 20 веб-сайтов в один шлюз приложений. Каждый веб-сайт может быть направлен к собственному пулу. Например, шлюз приложений может обслуживать трафик для `contoso.com` и `fabrikam.com` из двух пулов серверов, называемых ContosoServerPool и FabrikamServerPool.

Запросы для `http://contoso.com` маршрутизируются на ContosoServerPool, а запросы на `http://fabrikam.com` маршрутизируются на FabrikamServerPool.

Точно так же в одном развернутом шлюзе приложений можно разместить два поддомена одного родительского домена. К примерам использования поддоменов можно отнести `http://blog.contoso.com` и `http://app.contoso.com`, размещенные в одном развернутом шлюзе приложений.

## <a name="session-affinity"></a>Сходство сеансов

Функция соответствия сеансу на основе файлов cookie удобна, если нужно, чтобы сеанс пользователя выполнялся на одном и том же сервере. Используя управляемые шлюзом файлы cookie, шлюз приложений может направлять последующий трафик из сеанса пользователя на тот же сервер для обработки. Эта функция важна, когда состояние сеанса сохраняется локально на сервере для сеанса пользователя.

## <a name="secure-sockets-layer-ssl-termination"></a>Завершение запросов Secure Sockets Layer (SSL)

Шлюз приложений поддерживает функции моста SSL, после применения которых трафик обычно передается в незашифрованном виде на внутренние серверы. Это позволяет избавить веб-серверы от накладных расходов, связанных с ресурсоемкими операциями шифрования и расшифровки. Тем не менее иногда незашифрованный обмен данными на серверах не является приемлемым вариантом. Причина может быть в требованиях безопасности и соответствия или в том, что приложение может принимать только безопасные подключения. Теперь для таких приложений шлюз приложений поддерживает сквозное шифрование SSL.

## <a name="web-application-firewall"></a>Брандмауэр веб-приложения

Брандмауэр веб-приложения (WAF) — это компонент шлюза приложений, обеспечивающий централизованную защиту веб-приложений от распространенных эксплойтов и уязвимостей. WAF основан на правилах из [основных наборов правил OWASP (открытый проект безопасности веб-приложений)](https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project) версии 3.0 или 2.2.9. 

Веб-приложения все чаще подвергаются вредоносным атакам, использующим общеизвестные уязвимости. Повсеместно используются уязвимости для атак путем внедрения кода SQL и межсайтовых сценариев, и это лишь немногие из них. Предотвращение таких атак в коде приложения может быть сложной задачей и потребовать тщательного обслуживания, исправления и мониторинга на многих уровнях топологии приложения. Централизованный брандмауэр веб-приложения значительно упрощает управление безопасностью и помогает администраторам защищать приложение от угроз вторжения. Решение WAF может быстрее реагировать на угрозы безопасности по сравнению с защитой каждого отдельного веб-приложения благодаря установке исправлений известных уязвимостей в центральном расположении. Существующие шлюзы приложений можно преобразовать в шлюзы приложений с поддержкой брандмауэра веб-приложений.

## <a name="websocket-and-http2-traffic"></a>Трафик WebSocket и HTTP/2

Шлюз приложений обеспечивает встроенную поддержку протоколов WebSocket и HTTP/2. Настраиваемый пользователем параметр для выборочного включения или отключения поддержки WebSocket отсутствует. Поддержку HTTP/2 можно включить с помощью Azure PowerShell.
 
Протоколы WebSocket и HTTP/2 обеспечивают полную дуплексную связь между клиентом и сервером через длительное TCP-подключение. Благодаря этому обеспечивается лучшее интерактивное взаимодействие между веб-сервером и клиентом, которое может быть двунаправленным, без необходимости выполнять опрос, как это требуется в реализациях на основе HTTP. В отличие от HTTP эти протоколы обеспечивают низкие издержки и могут повторно использовать одно и тоже TCP-подключение для нескольких запросов и ответов, благодаря чему ресурсы используются более эффективно. Эти протоколы предназначены для работы через традиционные HTTP-порты 80 и 443.



## <a name="next-steps"></a>Дополнительная информация

В зависимости от требований и среды можно создать тестовый шлюз приложений с помощью портала Azure, Azure PowerShell или Azure CLI:

- [Quickstart: Direct web traffic with Azure Application Gateway — Azure portal](quick-create-portal.md) (Краткое руководство: направление веб-трафика с помощью шлюза приложений Azure (портал Azure)).
- [Quickstart: Direct web traffic with Azure Application Gateway — Azure PowerShell](quick-create-powershell.md) (Краткое руководство: направление веб-трафика с помощью шлюза приложений Azure (Azure PowerShell)).
- [Quickstart: Direct web traffic with Azure Application Gateway — Azure CLI](quick-create-cli.md) (Краткое руководство: направление веб-трафика с помощью шлюза приложений Azure (Azure CLI)).
