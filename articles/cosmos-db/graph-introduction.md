---
title: "Знакомство с API-интерфейсами Graph базы данных Azure Cosmos DB | Документация Майкрософт"
description: "Узнайте, как можно использовать базу данных Azure Cosmos DB, чтобы хранить, запрашивать и передавать массивные графы с минимальной задержкой с помощью языка запросов Gremlin."
services: cosmosdb
author: arramac
documentationcenter: 
ms.assetid: b916644c-4f28-4964-95fe-681faa6d6e08
ms.service: cosmosdb
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 05/10/2017
ms.author: arramac
ms.translationtype: Human Translation
ms.sourcegitcommit: 71fea4a41b2e3a60f2f610609a14372e678b7ec4
ms.openlocfilehash: 963822f0927afea90c8a03b60b7ee93fe36b4070
ms.contentlocale: ru-ru
ms.lasthandoff: 05/10/2017


---
# <a name="introduction-to-azure-cosmos-db-graph-api"></a>Знакомство с базой данных Azure Cosmos DB. API Graph

[Azure Cosmos DB](introduction.md) — это глобально распределенная, многомодельная служба базы данных Майкрософт, необходимая для работы с критически важными приложениями. Эта служба базы данных обеспечивает [готовое к использованию глобальное распределение](../documentdb/documentdb-distribute-data-globally.md), [гибкое масштабирование пропускной способности и хранилища](partition-data.md) по всему миру, задержки менее 10 миллисекунд на уровне 99-го процентиля, [пять четко определенных уровней согласованности](../documentdb/documentdb-consistency-levels.md), а также гарантированную высокую доступность — все это согласно [ведущим в отрасли соглашениям об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/documentdb/v1_1/). База данных Azure Cosmos DB [автоматически индексирует данные](http://www.vldb.org/pvldb/vol8/p1668-shukla.pdf) без необходимости управлять схемой и индексом. Так как эта база данных является многомодельной, она поддерживает модели данных документа, "ключ — значение", графа и столбчатые модели данных. 

![База данных Azure Cosmos DB, граф и Gremlin](./media/graph-introduction/graph-gremlin.png) 

База данных Azure Cosmos DB обеспечивает API-интерфейсы моделирования графов и обходные API-интерфейсы, а также готовое к использованию глобальное распределение, гибкое масштабирование хранилища и пропускной способности, задержки менее 10 миллисекунд для операций чтения, а также менее 15 миллисекунд на уровне 99-го процентиля, автоматическое индексирование и создание запросов, настраиваемые уровни согласованности и подробные соглашения об уровне обслуживания, гарантирующие уровень доступности 99,99 %. Запросить базу данных Azure Cosmos DB можно с помощью [стандартного языка запросов Gremlin](http://tinkerpop.apache.org/docs/current/reference/#graph-traversal-steps). Она также интегрируется с другими системами графа, совместимыми с Gremlin.

В этой статье содержится обзор API Graph базы данных Azure Cosmos DB, а также рекомендации по использованию этой базы данных для хранения массивных графов с миллиардами вершин и ребер. Вы также узнаете о выполнении запросов в пределах миллисекундных задержек и простой разработке структуры графа и схемы. 

## <a name="graph-databases"></a>Базы данных графов
В реальном мире все данные связаны естественным образом. Традиционное моделирование данных ориентировано на сущности. Однако для многих приложений необходимо моделировать множественные взаимосвязи между сущностями. Графы позволяют естественным образом моделировать сущности и взаимосвязи между ними. 

[Граф](http://mathworld.wolfram.com/Graph.html) — это структура, состоящая из [вершин](http://mathworld.wolfram.com/GraphVertex.html) и [ребер](http://mathworld.wolfram.com/GraphEdge.html). Вершины и ребра могут содержать произвольное число свойств. Вершины обозначают дискретные объекты, например пользователя, место или событие. Ребра указывают взаимосвязи между вершинами. Например, один пользователь может знать другого, быть вовлеченным в какое-либо событие или находиться в определенном месте. Свойства выражают сведения о вершинах и ребрах. Примеры свойств вершины — имя и возраст, а ребра — метка времени или вес. Более формально эта модель называется [графом свойства](https://github.com/tinkerpop/blueprints/wiki/Property-Graph-Model). База данных Azure Cosmos DB поддерживает модель графа свойства. 

Например, на схеме ниже представлен пример графа, в котором показаны взаимосвязи между людьми, их интересами, мобильными устройствами и операционными системами. 

![Пример базы данных, в котором показаны люди, их интересы и устройства](./media/graph-introduction/sample-graph.png) 

Графы удобны для понимания множества наборов данных в науке, технологиях и бизнесе. Наборы данных графа позволяют эффективно моделировать и хранить графы естественным образом, благодаря чему их можно применить для различных сценариев. Базы данных графа обычно представляют собой базы данных NoSQL, так как для использования последних часто требуются быстрая итерация и гибкость схемы. 

Графы предлагают новаторскую эффективную технологию моделирования данных. Конечно, эту технологию саму по себе нельзя назвать весомой причиной для использования базы данных графа. Для многих шаблонов и случаев использования, которые включают обходы графа, графы более эффективны (на несколько порядков), чем традиционные базы данных SQL и NoSQL. При передаче более одной связи, такой как связь "друг 1-го друга", эта разница в производительности в дальнейшем усиливается. 

Вы можете объединить быстрые обходы, обеспечиваемые базами данных графа, с такими его алгоритмами, как первый поиск глубины и ширины, алгоритм Дейкстры и т. д., чтобы решить проблемы в различных областях, например социальные сети, геопространственные сценарии, управление содержимым, рекомендации. 

## <a name="planet-scale-graphs-with-azure-cosmos-db"></a>Глобальные графы и база данных Azure Cosmos DB
База данных Azure Cosmos DB является полностью управляемой базой данных графа, которая обеспечивает глобальное распределение, гибкое масштабирование хранилища и пропускной способности, автоматическое индексирование и возможность выполнять запросы, настраиваемые уровни согласованности, а также поддержку стандартной платформы вычисления графа TinkerPop.  

![Архитектура графа базы данных Azure Cosmos DB](./media/graph-introduction/cosmosdb-graph-architecture.png) 

База данных Azure Cosmos DB предлагает следующие отличительные возможности по сравнению с другими базами данных графа, представленными на рынке: 

* **Гибко масштабируемая пропускная способность и хранилище.** В реальном мире для графов должна быть доступна функция масштабирования за пределами емкости одного сервера. С базой данных Azure Cosmos DB вы можете быстро и эффективно масштабировать графы на нескольких серверах. Вы также можете независимо масштабировать пропускную способность графа на основе шаблонов доступа. База данных Azure Cosmos DB поддерживает базы данных графа, которые можно масштабировать, достигая практически неограниченных размеров хранилища и подготовленной пропускной способности. 

* **Репликация между несколькими регионами.** База данных Azure Cosmos DB прозрачно реплицирует данные графа во все регионы, связанные с вашей учетной записью. Это позволяет разрабатывать приложения, которым требуется глобальный доступ к данным, при этом обеспечивая компромиссы между согласованностью, доступностью и производительностью с соответствующими гарантиями. Эта база данных обеспечивает прозрачную отработку отказа между регионами с помощью API-интерфейсов с поддержкой множественной адресации, а также возможность гибко масштабировать пропускную способность и размер хранилища по всему миру.

* **Быстрое выполнение запросов и обходов с помощью знакомого синтаксиса Gremlin.** Храните разные типы вершин и ребер, а также выполняйте запросы этих документов через знакомый синтаксис Gremlin (расширенная архитектура SQL скоро также будет доступна). База данных Azure Cosmos DB использует безблокировочную технологию индексирования с высокой степенью параллелизма и структурированием журналов для автоматического индексирования всего содержимого. Это позволяет формировать многофункциональные запросы и обходы в режиме реального времени без необходимости указывать подсказки для схемы, вторичные индексы или представления. Дополнительные сведения см. в руководстве о [поддержке графа для языка Gremlin в базе данных Cosmos Azure](gremlin-support.md).

* **Полная управляемость.** Устранение необходимости управления базой данных и вычислительными ресурсами. В полностью управляемой службе Microsoft Azure вам не нужно заниматься управлением виртуальными машинами, развертыванием и настройкой программного обеспечения или масштабированием или иметь дело со сложными обновлениями на уровне данных. Каждый граф автоматически сохраняется и защищается от региональных сбоев. Вы можете легко добавлять учетные записи базы данных Azure Cosmos DB и подготавливать необходимую емкость по мере необходимости, что позволяет сосредоточиться на приложении, а не на вопросах эксплуатации и управления базой данных.

* **Автоматическая индексация.** По умолчанию база данных Azure Cosmos DB автоматически индексирует все свойства в узлах и ребрах в графе, не ожидая и не требуя наличия какой-либо схемы или создания дополнительных индексов. 

* **Совместимость с Gremlin.** База данных Azure Cosmos DB изначально поддерживает стандартный язык Gremlin с открытым исходным кодом, а также может интегрироваться с другими системами графа, совместимыми с этим языком. Таким образом, вы можете легко перемещаться из другой базы данных графа, например Titan или Neo4j, или же использовать базу данных Azure Cosmos DB с платформами аналитики графа, такими как Apache Spark GraphX.

* **Настраиваемые уровни согласованности.** Вам доступны на выбор пять четко определенных уровней согласованности для достижения оптимального соотношения между согласованностью и производительностью. Для запросов и операций чтения база данных Azure Cosmos DB предлагает пять отдельных уровней согласованности — сильный, с ограниченным устареванием, сеансовый, с согласованностью префиксов и согласованный в конечном счете. Эти разделенные, четко определенные уровни согласованности позволяют принимать обоснованные компромиссы между показателями согласованности, доступности и задержки. Дополнительные сведения см. в статье [Уровни согласованности в DocumentDB](../documentdb/documentdb-consistency-levels.md).

База данных Azure Cosmos DB также предоставляет возможность использовать несколько моделей, например документа и графа, в тех же контейнерах или базах данных. Вы можете использовать коллекцию документов, чтобы хранить данные графа параллельно с документами, а также использовать запросы SQL для JSON и запросы Gremlin для выполнения тех же запросов, что и для графа. 

## <a name="getting-started"></a>Приступая к работе
Учетные записи базы данных Azure Cosmos DB можно создать с помощью Azure CLI, Azure Powershell или же портала Azure с поддержкой API Graph. После их создания портал Azure предоставляет конечную точку службы, например `https://<youraccount>.graphs.azure.com`, которая обеспечивает внешний интерфейс WebSocket для языка Gremlin. Вы можете настроить средства, совместимые с Gremlin, например [консоль Gremin](http://tinkerpop.apache.org/docs/current/reference/#gremlin-console), чтобы подключиться к этой конечной точке, а также создать приложения на Java, Node.js или любом другом клиентском драйвере Gremlin.

В таблице ниже приведены распространенные драйверы Gremlin, которые вы можете использовать для базы данных Azure Cosmos DB.

| Загрузить | Документация |
| --- | --- |
| [Java](https://mvnrepository.com/artifact/com.tinkerpop.gremlin/gremlin-java) |[Документация по Gremlin для Java](http://tinkerpop.apache.org/javadocs/current/full/) |
| [Node.js](https://www.npmjs.com/package/gremlin) |[Gremlin для JavaScript в Github](https://github.com/jbmusso/gremlin-javascript) |
| [Консоль Gremlin](https://tinkerpop.apache.org/downloads.html) |[Документация по TinkerPop](http://tinkerpop.apache.org/docs/current/reference/#gremlin-console) |

База данных Azure Cosmos DB также предоставляет библиотеку .NET напрямую из источника с помощью методов расширения Gremlin на основе [пакетов SDK базы данных Azure Cosmos DB](../documentdb/documentdb-sdk-dotnet.md) через NuGet. Эта библиотека обеспечивает "внутрипроцессный" сервер Gremlin, который может использоваться для подключения напрямую к секциям данных DocumenDB. 

| Загрузить | Документация |
| --- | --- |
| [.NET](https://www.nuget.org/packages/Microsoft.Azure.Graphs/) |[Microsoft.Azure.Graphs](https://msdn.microsoft.com/library/azure/dn948556.aspx) |

Используя [эмулятор базы данных Azure Cosmos DB](../documentdb/documentdb-nosql-local-emulator.md), вы можете выполнять разработку и тестирование локально с помощью API Graph, не создавая подписку Azure и без каких-либо затрат. Если приложение в эмуляторе работает правильно, вы можете использовать учетную запись базы данных Azure Cosmos DB в облаке.

## <a name="scenarios-for-azure-cosmos-dbs-graph-support"></a>Сценарии для поддержки Graph базы данных Azure Cosmos DB
Ниже приведены некоторые сценарии, в которых может использоваться поддержка графа базы данных Azure Cosmos DB: 

* **Социальные сети.** Объединяя данные о клиентах и их взаимодействиях с другими людьми, вы можете разработать персонализированные средства, предугадать поведение клиента или объединить людей на основе их интересов. Базу данных Azure Cosmos DB можно использовать для управления социальными сетями и отслеживания данных о клиенте и его предпочтениях. 

* **Системы рекомендаций.** Широко используется в сфере розничной торговли. Объединяя сведения о продукции, пользователях и операциях пользователей, например приобретении, поиске и оценке товара, вы можете создать пользовательские рекомендации. База данных Azure Cosmos DB с минимальной задержкой, гибким масштабированием и встроенной поддержкой графа представляет собой идеальный вариант моделирования этих взаимосвязей.

* **Геопространственные сценарии.** Многим приложениям в сферах телекоммуникаций, логистики и туристического планирования требуется поиск интересующего расположения в определенном регионе или же обнаружение самого короткого (оптимального) пути между двумя расположениями. База данных Azure Cosmos DB поможет легко справиться с этими задачами. 

* **Интернет вещей.** С помощью сети и подключений между устройствами Интернета вещей, смоделированных как граф, вы можете лучше разобраться с состоянием и ресурсами, а также узнать, как изменения в одной части сети могут повлиять на другую часть. 

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о поддержке графа в базе данных Azure Cosmos DB см. в следующих ресурсах:

* [Azure Cosmos DB: Build a .NET application using the Graph API](create-graph-dotnet.md) (База данных Azure Cosmos DB. Создание приложения .NET с помощью API Graph)
* [Поддержка графа Gremlin в базе данных Azure Cosmos DB](gremlin-support.md)

