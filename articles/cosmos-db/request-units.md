---
title: Пропускная способность и единицы запросов в Azure Cosmos DB
description: Сведения о том, как задать и оценить количество необходимых единиц запросов в Azure Cosmos DB
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/30/2018
ms.author: rimman
ms.openlocfilehash: dd9fb81b37627518af1375aa9876e6c509b917c9
ms.sourcegitcommit: 8330a262abaddaafd4acb04016b68486fba5835b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/04/2019
ms.locfileid: "54033933"
---
# <a name="request-units-in-azure-cosmos-db"></a>Единицы запроса в базе данных Azure Cosmos DB

При использовании Azure Cosmos DB вы платите на почасовой основе за пропускную способность, которую предоставляете, и за ресурсы хранения, которое вы потребляете. Чтобы удовлетворить или превысить требования Соглашения об уровне обслуживания Azure Cosmos DB, необходимо обеспечить пропускную способность и убедиться, что достаточные системные ресурсы доступны для базы данных Azure Cosmos все время.

Azure Cosmos DB поддерживает различные интерфейсы API (SQL, MongoDB, Cassandra, Gremlin и Таблицы). Каждый API имеет собственный набор операций базы данных, начиная от простого считывания и записи точек и заканчивая сложными запросами. Каждая операция базы данных потребляет системные ресурсы, потребление зависит от сложности операции.  Стоимость всех операций базы данных нормализуется с помощью Azure Cosmos DB и выражается в единицах запроса (ЕЗ). Чтение элемента размером 1 КБ обходится в 1 единицу запроса (1 ЕЗ). Для потребления 1 ГБ хранилища требуется не менее 40 ЕЗ. Цены на остальные операции с базой данных аналогично назначаются с учетом ЕЗ. Независимо от API, который используется для взаимодействия с контейнером Azure Cosmos и операций базы данных (запись, чтение, запрос), стоимость всегда измеряется в ЕЗ.

Вы можете считать ЕЗ/с в качестве пропускной способности. ЕЗ/с — это единица, основанная на тарифе, который абстрагирует системные ресурсы (например, ЦП, операции ввода-вывода в секунду и память), необходимые для выполнения операций базы данных, поддерживаемых Azure Cosmos DB. На следующем рисунке показаны единицы запроса, используемые различными операциями базы данных:

![Операции с базой данных потребляют единицы запроса](./media/request-units/request-units.png)

Чтобы обеспечить планирование пропускной способности и управление ею, Azure Cosmos DB гарантирует, что количество ЕЗ для операции базы данных над определенным набором данных является детерминированным. Изучая заголовок ответа, вы можете отслеживать количество ЕЗ, потребляемых любой операцией базы данных. Зная факторы, которые влияют на стоимость в единицах запроса, и требования приложения к пропускной способности, вы сможете обеспечить экономичность приложения.

Хотя счета выставляются на почасовой основе, количество ЕЗ для приложения подготавливается на основе данных, получаемых в секунду, с шагом в 100 ЕЗ/с. Чтобы увеличить подготовленную пропускную способность для приложения, вы можете в любое время увеличить или уменьшить количество ЕЗ (с пошаговым увеличением или уменьшением по 100 ЕЗ) либо программно, либо с помощью портала Azure.

Вы можете обеспечить пропускную способность с помощью двух различных уровней детализаций: 

* **Контейнеры**. Сведения о том, [как подготовить пропускную способность для контейнера Azure Cosmos](how-to-provision-container-throughput.md).
* **Базы данных**. Сведения о том, [как подготовить пропускную способность для базы данных в Azure Cosmos DB](how-to-provision-database-throughput.md).

## <a name="request-unit-considerations"></a>Рекомендации по оценке необходимого количества единиц запросов

При оценке количества ЕЗ/с для подготовки необходимо учитывать следующие факторы:

* **Размер элемента**. С увеличением размера элемента число единиц запросов, расходуемых на чтение и запись элемента, также увеличивается.

* **Индексация элементов**. По умолчанию каждый элемент индексируется автоматически. Если не индексировать некоторые элементы в контейнере, будет использовано меньше единиц запросов.

* **Число свойств элемента** .Предполагая индексирование по умолчанию для всех свойств количество ЕЗ, потребляемых для записи элемента, увеличивается по мере увеличения количества свойств элемента.

* **Индексированные свойства.** Свойства, которые индексируются по умолчанию, определяются политикой индексирования для каждого контейнера. Вы можете сократить потребление единиц запросов для операций записи, ограничив количество индексируемых свойств.

* **Согласованность данных**. Строгие уровни согласованности потребляют примерно 2 раза больше ЕЗ при выполнении операций чтения по сравнению с другими отложенными уровнями согласованности.

* **Шаблоны запроса**. Сложность запроса влияет на количество единиц запроса, потребляемых операцией. Количество результатов запросов, количество предикатов и их характер, количество определяемых пользователем функций и размер исходных данных, размер результирующего набора, а также проекции — все это влияет на стоимость операций запросов. Azure Cosmos DB гарантирует, что при повторном выполнении один и тот же запрос к тем же данным всегда будет стоить то же количество ЕЗ.

* **Использование скрипта**. Так же как и запросы, хранимые процедуры и триггеры расходуют ЕЗ с учетом сложности выполняемых операций. При разработке приложения проверяйте заголовки со стоимостью запросов, чтобы лучше понять, как ресурсы производительности используются каждой из операций.

## <a name="next-steps"></a>Дополнительная информация

* Дополнительные сведения см. в статье [Подготовка пропускной способности для контейнеров и баз данных Cosmos DB](set-throughput.md).
* Подробнее о [логических разделах](partition-data.md).
* Дополнительные сведения о [глобальном масштабировании подготовленной пропускной способности](scaling-throughput.md).
* Сведения о том, [как подготовить пропускную способность для контейнера Azure Cosmos](how-to-provision-container-throughput.md).
* Сведения о том, [как подготовить пропускную способность для базы данных Azure Cosmos](how-to-provision-database-throughput.md).
