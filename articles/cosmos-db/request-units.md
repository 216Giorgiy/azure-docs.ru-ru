---
title: Пропускная способность и единицы запросов в Azure Cosmos DB
description: Сведения о том, как задать и оценить количество необходимых единиц запросов в Azure Cosmos DB
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/30/2018
ms.author: rimman
ms.openlocfilehash: eabfe503d9b92252ada0014eba4c83390dd6fd97
ms.sourcegitcommit: da3459aca32dcdbf6a63ae9186d2ad2ca2295893
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2018
ms.locfileid: "51236081"
---
# <a name="request-units-in-azure-cosmos-db"></a>Единицы запроса в базе данных Azure Cosmos DB

При использовании Azure Cosmos DB вы платите на почасовой основе за пропускную способность, которую предоставляете, и за ресурсы хранения, которое вы потребляете. Чтобы удовлетворить или превысить требования соглашения об уровне обслуживания Cosmos DB, необходимо обеспечить пропускную способность и убедиться, что достаточные системные ресурсы доступны для базы данных Cosmos все время.

Cosmos DB поддерживает различные интерфейсы API (SQL, MongoDB, Cassandra, Gremlin и Таблицы). Каждый API имеет собственный набор операций базы данных, начиная от простого считывания и записи точек и заканчивая сложными запросами. Каждая операция базы данных потребляет системные ресурсы, потребление зависит от сложности операции.  Стоимость всех операций базы данных нормализуется с помощью Cosmos DB и выражается в единицах запроса (ЕЗ). Чтение элемента размером 1 КБ обходится в 1 единицу запроса (1 ЕЗ). Цены на остальные операции с базой данных аналогично назначаются с учетом ЕЗ. Независимо от API, который используется для взаимодействия с контейнером Cosmos и операций базы данных (запись, чтение, запрос), затраты всегда измеряются в ЕЗ.

Вы можете считать ЕЗ/с в качестве пропускной способности. ЕЗ/с — это валюта, основанная на тарифе, который абстрагирует системные ресурсы, такие как ЦП, операции ввода-вывода в секунду и память, которые необходимы для выполнения операций базы данных, поддерживаемых Cosmos DB. На следующем рисунке показаны единицы запроса, используемые различными операциями базы данных:

![Операции с базой данных потребляют единицы запроса](./media/request-units/request-units.png)

Чтобы управлять и планировать пропускную способность, база данных Cosmos DB гарантирует, что количество ЕЗ для данной операции базы данных в данном наборе данных является детерминированным. Изучая заголовок ответа, вы можете отслеживать количество ЕЗ, потребляемых любой операцией базы данных. Зная факторы, которые влияют на стоимость в единицах запроса, и требования приложения к пропускной способности, вы сможете обеспечить экономичность приложения.

Хотя счета выставляются на почасовой основе, количество ЕЗ для приложения подготавливается на основе данных, получаемых в секунду, с шагом в 100 ЕЗ/с. Чтобы увеличить подготовленную пропускную способность для приложения, вы можете в любое время увеличить или уменьшить количество ЕЗ (с пошаговым увеличением или уменьшением по 100 ЕЗ) либо программно, либо с помощью портала Azure.

Вы можете обеспечить пропускную способность с помощью двух различных уровней детализаций: 

* **Контейнеры**. Сведения о том, [как подготовить пропускную способность для контейнера Cosmos](how-to-provision-container-throughput.md).
* **Базы данных**. Дополнительные сведения см. в статье [Provision throughput for a database in Azure Cosmos DB](how-to-provision-database-throughput.md) (Подготовка пропускной способности для базы данных в Azure Cosmos DB).

## <a name="request-unit-considerations"></a>Рекомендации по оценке необходимого количества единиц запросов

При оценке количества ЕЗ/с для подготовки необходимо учитывать следующие факторы:

* **Размер элемента**. С увеличением размера элемента число единиц запросов, расходуемых на чтение и запись элемента, также увеличивается.

* **Индексация документов**. По умолчанию каждый элемент индексируется автоматически. Если не индексировать некоторые элементы в контейнере, будет использовано меньше единиц запросов.

* **Число свойств элемента** .Предполагая индексирование по умолчанию для всех свойств количество ЕЗ, потребляемых для записи элемента, увеличивается по мере увеличения количества свойств элемента.

* **Индексированные свойства.** Свойства, которые индексируются по умолчанию, определяются политикой индексирования для каждого контейнера. Вы можете сократить потребление единиц запросов для операций записи, ограничив количество индексируемых свойств.

* **Согласованность данных**. Строгие уровни согласованности потребляют примерно 2 раза больше ЕЗ при выполнении операций чтения по сравнению с другими отложенными уровнями согласованности.

* **Шаблоны запроса**. Сложность запроса влияет на количество единиц запроса, потребляемых операцией. Количество результатов запросов, количество предикатов и их характер, количество определяемых пользователем функций и размер исходных данных, размер результирующего набора, а также проекции — все это влияет на стоимость операций запросов. Cosmos DB гарантирует, что при повторном выполнении один и тот же запрос к тем же данным всегда будет стоить то же количество ЕЗ.

* **Использование скрипта**. Так же как и запросы, хранимые процедуры и триггеры расходуют ЕЗ с учетом сложности выполняемых операций. При разработке приложения проверяйте заголовки со стоимостью запросов, чтобы лучше понять, как ресурсы производительности используются каждой из операций.

## <a name="next-steps"></a>Дополнительная информация

* Дополнительные сведения см. в статье [Настройка и получение пропускной способности контейнеров и базы данных Azure Cosmos DB](set-throughput.md)
* Подробнее о [логических разделах](partition-data.md).
* Дополнительные сведения см. в статье [Масштабирование пропускной способности в Azure Cosmos DB](scaling-throughput.md)
* Сведения о том, [как подготовить пропускную способность для контейнера Cosmos](how-to-provision-container-throughput.md).
* Дополнительные сведения см. в статье [Provision throughput for an Azure Cosmos DB container](how-to-provision-database-throughput.md) (Подготовка пропускной способности для базы данных в Azure Cosmos DB)
