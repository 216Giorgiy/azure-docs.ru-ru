<properties title="Get started with SQL database auditing" pageTitle="Get started with SQL database auditing | Azure" description="Get started with SQL database auditing" metaKeywords="" services="sql-database" solutions="data-management" documentationCenter="" authors="jeffreyg" videoId="" scriptId=""  />

<tags ms.service="sql-database" ms.workload="data-management" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="jeffreyg"></tags>

# Приступая к работе с аудитом базы данных SQL

Аудит базы данных Azure отслеживает события базы данных и записывает их в журнал аудита, расположенный в учетной записи хранения Azure. Функция аудита имеется в виде предварительного тестирования для уровней Basic, Standard и Premium. Для того, чтобы воспользоваться функцией аудита, необходимо [подписаться на предварительную версию][подписаться на предварительную версию].

Аудит может помочь вам соблюсти требования нормативов, проанализировать работу с базой данных и получить представление о расхождениях и аномалиях, которые могут указывать на бизнес-проблемы или предполагаемые нарушения безопасности.

Средства аудита позволяют и способствуют соблюдению стандартов, но не гарантируют соответствия им. Дополнительные сведения о программах Azure, поддерживающих проверку соблюдения стандартов, см. [Центр управления безопасностью Azure][Центр управления безопасностью Azure].

-   [Основы аудита баз данных SQL Azure][Основы аудита баз данных SQL Azure]
-   [Настройка аудита базы данных][Настройка аудита базы данных]
-   [Анализ журналов и отчетов аудита][Анализ журналов и отчетов аудита]

## <span id="subheading-1"></span>Основы аудита баз данных SQL Azure</a>

Настройка аудита осуществляется на портале предварительной версии Azure. Значения не имеет, была ли база данных создана на портале Azure или на портале предварительной версии Azure. Аудит баз данных SQL позволяет:

-   **Сохранить** журнал аудита выбранных событий. Определите категории действий баз данных и событий для записи в журнал.
-   **Создавать отчеты** по действиям, производимым с базой данных. Используйте предварительно настроенные отчеты и панель мониторинга для быстрого начала работы с отчетностью по действиям и событиям.
-   **Анализировать** отчеты. Находите подозрительные события, необычную деятельность и тенденции.

Можно организовать аудит следующих действий и событий:

-   **Доступ к данным**
-   **Изменения схемы данных (DDL)**
-   **Изменения данных (DML)**
-   **Учетные записи, роли и разрешения (DSL)**
-   **Исключительные ситуации, связанные с безопасностью**

Для получения более подробной информации о журналируемых действиях и событиях, см. раздел [Справочник по формату журнала аудита (файл в формате doc)][Справочник по формату журнала аудита (файл в формате doc)].

Также можно выбрать учетную запись хранения, в которую будут сохраняться журналы аудита.

### Строка безопасного подключения

В ходе настройки аудита Azure предоставит строку для безопасного подключения к базе данных. В журнал аудита будут записываться действия и события только тех клиентских приложений, которые будут использовать эту строку для подключения, поэтому необходимо обновить существующие клиентские приложения для использования строки подключения в новом формате.

Традиционный формат строки подключения: \<\<*имя\_сервера*\>.database.windows.net

Новая строка для безопасного подключения: \<\<*имя\_сервера*\>.database.**secure**.windows.net

## <span id="subheading-2"></span></a>Настройка аудита базы данных

1.  [Оформите подписку на предварительную версию аудита][подписаться на предварительную версию].
2.  Также [подпишитесь на предварительную версию новых уровней обслуживания][подпишитесь на предварительную версию новых уровней обслуживания] и создайте базу данных с уровнем Basic, Standard или Premium.
3.  Запустите [портал предварительной версии Azure][портал предварительной версии Azure], перейдя по адресу <https://portal.azure.com>.
4.  Щелкните имя базы данных для аудита, затем щелкните **Предварительная версия аудита** чтобы включить предварительную версию аудита и запустить выноску настройки аудита.

    ![][0]

5.  В выноске настройки аудита выберите учетную запись хранения Azure, в которой будут храниться журналы. **Подсказка.**Для того, чтобы в полной мере воспользоваться возможностями шаблонов предварительно настроенных отчетов используйте одну и ту же учетную запись хранения для всех баз данных.

    ![][1]

6.  В **Настройки аудита** щелкните **Все** для отслеживания всех событий или выберите отдельные типы событий.

    ![][2]

7.  Выберите **Сохранить как настройку по умолчанию**, если вы хотите применить эти настройки ко всем создаваемым в последующем на данном сервере базам данных, не имеющем собственных настроек аудита. В дальнейшем эти настройки можно переопределить, выполнив аналогичные действия.

    ![][3]

8.  Щелкните **Показать строки подключения к базе данных** и скопируйте или отметьте соответствующую строку безопасного подключения для своего приложения. Используйте эту строку для всех клиентских приложений, чьи действия необходимо отслеживать.

    ![][4]

9.  Нажмите кнопку **ОК**.

## <span id="subheading-3"></span>Анализ журналов и отчетов аудита</a>

Журналы аудита объединяются в единую таблицу хранилища Azure под названием **AuditLogs** в учетной записи хранения Azure, выбранной на этапе настройки. Просматривать файлы журнала можно с помощью таких средств, как [Обозреватель хранилищ Azure][Обозреватель хранилищ Azure].

Доступен предварительно настроенный шаблон отчета панели мониторинга в виде [таблицы Excel][таблицы Excel], что позволит быстро проанализировать данные журнала. Для того, чтобы использовать шаблон с вашими журналами аудита, вам потребуется Excel 2013 и выше и Power Query, который можно загрузите по [этой ссылке][этой ссылке].

В шаблоне приведен пример вымышленных данных, вы можете настроить Power Query для импорта журнала аудита непосредственно в учетную запись хранения Azure.

Более подробные инструкции по работе с шаблоном отчета приведены в [Практическом руководстве (файл в формате doc)][Практическом руководстве (файл в формате doc)].

![][5]

<!--Anchors--> 
<!--Image references--> 
<!--Link references-->

  [подписаться на предварительную версию]: http://go.microsoft.com/fwlink/?LinkId=404163
  [Центр управления безопасностью Azure]: http://azure.microsoft.com/ru-ru/support/trust-center/compliance/
  [Основы аудита баз данных SQL Azure]: #subheading-1
  [Настройка аудита базы данных]: #subheading-2
  [Анализ журналов и отчетов аудита]: #subheading-3
  [Справочник по формату журнала аудита (файл в формате doc)]: http://go.microsoft.com/fwlink/?LinkId=506733
  [подпишитесь на предварительную версию новых уровней обслуживания]: https://account.windowsazure.com/PreviewFeatures?fid=premiumdb
  [портал предварительной версии Azure]: https://portal.azure.com
  [0]: ./media/sql-database-auditing-get-started/sql-database-get-started-auditingpreview.png
  [1]: ./media/sql-database-auditing-get-started/sql-database-get-started-storageaccount.png
  [2]: ./media/sql-database-auditing-get-started/sql-database-auditing-eventtype.png
  [3]: ./media/sql-database-auditing-get-started/sql-database-get-started-saveconfigasdefault.png
  [4]: ./media/sql-database-auditing-get-started/sql-database-get-started-connectionstring.png
  [Обозреватель хранилищ Azure]: http://azurestorageexplorer.codeplex.com/
  [таблицы Excel]: http://go.microsoft.com/fwlink/?LinkId=403540
  [этой ссылке]: http://www.microsoft.com/ru-ru/download/details.aspx?id=39379
  [Практическом руководстве (файл в формате doc)]: http://go.microsoft.com/fwlink/?LinkId=506731
  [5]: ./media/sql-database-auditing-get-started/sql-database-auditing-dashboard.png
