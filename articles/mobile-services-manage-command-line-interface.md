<properties linkid="develop-mobile-tutorials-command-line-administration" urlDisplayName="Command Line Administration" pageTitle="Administering a Mobile Service at the command line - Azure tutorial" metaKeywords="" description="Learn how to create, deploy, and manage your Azure Mobile Service using command-line tools." metaCanonical="" services="" documentationCenter="Mobile" title="Automate mobile services with command-line tools" authors="glenga" solutions="" manager="" editor="" />

<tags ms.service="mobile-services" ms.workload="mobile" ms.tgt_pltfrm="mobile-multiple" ms.devlang="multiple" ms.topic="article" ms.date="01/01/1900" ms.author="glenga"></tags>

# Автоматизация мобильных служб с помощью средств командной строки

В этом разделе показано, как использовать средства командной строки Azure для автоматизации создания мобильных служб Azure и управления ими. В этом разделе показано, как установить и начать использовать средства командной строки для выполнения следующих задач мобильных служб:

-   [Создание мобильной службы][Создание мобильной службы]
-   [Создать таблицу][Создать таблицу]
-   [Регистрация скрипта для операций с таблицами][Регистрация скрипта для операций с таблицами]
-   [Перечисление таблиц][Перечисление таблиц]
-   [Удаление существующей таблицы][Удаление существующей таблицы]
-   [Перечисление мобильных служб][Перечисление мобильных служб]
-   [Удаление существующей мобильной службы][Удаление существующей мобильной службы]

При объединении в один скрипт или пакетный файл эти отдельные команды автоматизируют процесс создания, проверки и удаления мобильной службы.

Чтобы использовать средства командной строки Azure для управления мобильными службами, требуется учетная запись Azure, для которой включены мобильные службы Azure.

-   Если ее нет, можно создать бесплатную пробную учетную запись всего за несколько минут. Дополнительные сведения см. в разделе [Бесплатная пробная версия Azure][Бесплатная пробная версия Azure].

-   Если у вас есть учетная запись, но вам нужно включить предварительную версию мобильных служб Azure, см. раздел [Включение предварительных версий компонентов Azure][Включение предварительных версий компонентов Azure].

В этом разделе описывается набор общих задач администрирования, поддерживаемых средствами командной строки Azure. Дополнительные сведения см. в [документации средств командной строки Azure][документации средств командной строки Azure].

<!--+  You must download and install the Azure command-line tools to your local machine. To do this, follow the instructions in the first section of this topic.   + (Optional) To be able to execute HTTP requests directly from the command-line, you must use cURL or an equivalent tool. cURL runs on a variety of platforms. Locate and install cURL for your specific platform from the <a href=http://go.microsoft.com/fwlink/p/?LinkId=275676 target="_blank">cURL download  page</a>.-->

## <a name="install"></a><span class="short-header">Установка инструментов</span>Установка программ командной строки Azure

Следующий список содержит сведения по установке программ командной строки в зависимости от операционной системы:

-   **Windows**: скачайте [установщик программ командной строки Azure][установщик программ командной строки Azure]. Откройте загруженный MSI-файл и выполните установку.

-   **Mac**: загрузите [установщик Azure SDK][установщик Azure SDK]. Откройте загруженный файл .pkg и выполните установку.

-   **Linux**: установите последнюю версию [Node.js][Node.js] (см. раздел [Установка Node.js через диспетчер пакетов][Установка Node.js через диспетчер пакетов]), затем выполните следующую команду:

        npm install azure-cli -g

Чтобы проверить правильность установки, введите `azure` в командной строке. Если установка прошла успешно, вы увидите список всех доступных команд `azure`.

## <a name="import-account"></a><span class="short-header">Импорт параметров</span>Как скачать и импортировать параметры публикации

</p>
Чтобы начать работу, необходимо сначала загрузить и импортировать параметры публикации. Это позволит вам использовать средства для создания и управления службами Azure. Чтобы загрузить параметры публикации, используйте команду `account download`:

        azure account download

После этого откроется браузер по умолчанию и появится запрос на вход в портал управления. После входа будет скачан файл `.publishsettings`. Запишите расположение сохраненного файла.

Затем импортируйте файл `.publishsettings`, выполнив следующую команду и заменив параметр `<path-to-settings-file>` на путь к файлу `.publishsettings`:

        azure account import <path-to-settings-file>

Все сведения, сохраненные с помощью команды `import`, можно удалить командой `account clear`:

        azure account clear

Чтобы просмотреть список параметров для команд `account`, используйте параметр `-help`:

        azure account -help

После импорта параметров публикации необходимо удалить файл `.publishsettings` для безопасности. Дополнительные сведения см. в статье [Установка программ командной строки Azure для Mac и Linux][Установка программ командной строки Azure для Mac и Linux]. Теперь вы можете приступить к созданию мобильных служб Azure и начать управлять ими с помощью командной строки или пакетных файлов.

## <a name="create-service"></a><span class="short-header">Создание службы</span>Как создать мобильную службу

Средства командной строки можно использовать для создания нового экземпляра мобильной службы. При создании мобильной службы также создается экземпляр базы данных SQL на новом сервере.

Следующая команда создает новый экземпляр мобильной службы в вашей подписке, где `<service-name>` — имя новой мобильной службы, `<server-admin>` — имя входа нового сервера, а `<server-password>` — пароль для нового имени входа:

        azure mobile create <service-name> <server-admin> <server-password>

Команда `mobile create` завершается ошибкой, если указанная мобильная служба существует. В скриптах автоматизации следует попытаться удалить мобильную служб, прежде чем попытаться создать ее еще раз.

## <a name="list-services"></a><span class="short-header">Вывод списка служб</span>Как вывести список существующих мобильных служб в подписке

Следующая команда возвращает список всех мобильных служб в подписке Azure:

        azure mobile list

Эта команда также показывает текущее состояние и URL-адрес каждой мобильной службы.

## <a name="delete-service"></a><span class="short-header">Удаление службы</span>Как удалить существующую мобильную службу

Средства командной строки можно использовать для удаления существующей мобильной службы вместе со связанной базой данных SQL и сервером. Следующая команда удаляет мобильную службу, где `<service-name>` — имя мобильной службы, которую требуется удалить:

        azure mobile delete <service-name> -a -q

Если добавить параметры `-a` и `-q`, эта команда также удаляет базу данных SQL и сервер, используемые мобильной службой, без отображения запроса.

<div class="dev-callout"><strong>Примечание.</strong> 
   <p>Если не указать параметр <code data-inline="1">-q</code> вместе с параметром <code data-inline="1">-a</code> или <code data-inline="1">-d</code>, выполнение приостанавливается и отображается запрос для выбора параметров удаления базы данных SQL. Используйте только параметр <code data-inline="1">-a</code>, если другие службы не используют базу данных или сервер. В противном случае используйте параметр <code data-inline="1">-d</code>, чтобы удалить только те данные, которые принадлежат удаляемой мобильной службе.</p>
</div>

## <a name="create-table"></a><span class="short-header">Создание таблицы</span>Как создать таблицу в мобильной службе

Следующая команда создает таблицу в указанной мобильной службе, где `<service-name>` — имя мобильной службы, а `<table-name>` — это имя создаваемой таблицы:

        azure mobile table create <service-name> <table-name>

Эта команда создает новую таблицу с установленными по умолчанию разрешениями, `application`, для операций с таблицей: `insert`, `read`, `update` и `delete`.

Следующая команда создает новую таблицу с общедоступным разрешением `read`, но разрешение `delete` предоставляется только администраторам:

        azure mobile table create <service-name> <table-name> -p read=public,delete=admin

В следующей таблице показано значение разрешения скрипта в сравнении ос значением разрешения на [портале управления Azure][портале управления Azure].

| Значение сценария            | Значение портала управления            |
|------------------------------|----------------------------------------|
| `public`                     | Все                                    |
| `application` (по умолчанию) | Все с ключом приложения                |
| `user`                       | Только прошедшие проверку пользователи |
| `admin `                     | Только скрипты и администраторы        |

Команда `mobile table create` завершается ошибкой, если указанная таблица существует. В скриптах автоматизации следует попытаться удалить таблицу, прежде чем попытаться создать ее еще раз.

## <a name="list-tables"></a><span class="short-header">Вывод списка таблиц</span>Как вывести список существующих таблиц в мобильной службе

Следующая команда возвращает список всех таблиц в мобильной службе, где `<service-name>` — имя мобильной службы:

        azure mobile table list <service-name>

Эта команда также показывает число индексов в каждой таблице и число строк данных в таблице на текущий момент.

## <a name="delete-table"></a><span class="short-header">Удаление таблицы</span>Как удалить существующую таблицу из мобильной службы

Следующая команда удаляет таблицу из указанной мобильной службы, где `<service-name>` — имя мобильной службы, а `<table-name>` — это имя удаляемой таблицы:

        azure mobile table delete <service-name> <table-name> -q

В сценариях автоматизации используйте параметр `-q`, чтобы удалить таблицу без отображения запроса подтверждения, который блокирует выполнение.

## <a name="register-script"></a><span class="short-header">Регистрация сценария</span>Как зарегистрировать сценарий для операции с таблицей

Следующая команда передает и регистрирует функцию для операции с таблицей, где `<service-name>` — имя мобильной службы, `<table-name>` — имя таблицы, а `<operation>` — операция с таблицей, которой может быть одна из следующих: `read`, `insert`, `update` или `delete`:

        azure mobile script upload <service-name> table/<table-name>.<operation>.js

Обратите внимание, что эта операция загружает файл JavaScript (JS) с локального компьютера. Имя файла должно состоять из имен таблицы и операции, и файл должен находиться во вложенной папке таблицы `table` относительно расположения, где выполняется команда. Например, следующая операция передает и регистрирует новый сценарий `insert`, который принадлежит таблице `TodoItems`:

        azure mobile script upload todolist table/todoitems.insert.js

Объявление функции в файле скрипта также должно соответствовать зарегистрированной табличной операции. Это значит, что для сценария `insert` переданный сценарий содержит функцию со следующей сигнатурой:

        function insert(item, user, request) {
            ...
        } 

Дополнительные сведения о регистрации скриптов сценариев см. в [справочнике по серверным скриптам мобильных служб][справочнике по серверным скриптам мобильных служб].

<!--<h2><a name="test-service"></a><span class="short-header">Test the service</span>Test the new mobile service</h2>

When you are automating the creation of your mobile service, you can optionally use cURL or another command-line request generator to 

## <a name="nextsteps"> </a>Next Steps
Next steps here....
-->
<!-- Anchors. Images. URLs. -->
  [Создание мобильной службы]: #create-service
  [Создать таблицу]: #create-table
  [Регистрация скрипта для операций с таблицами]: #register-script
  [Перечисление таблиц]: #list-tables
  [Удаление существующей таблицы]: #delete-table
  [Перечисление мобильных служб]: #list-services
  [Удаление существующей мобильной службы]: #delete-service
  [Бесплатная пробная версия Azure]: http://www.windowsazure.com/ru-ru/pricing/free-trial/
  [Включение предварительных версий компонентов Azure]: http://azure.microsoft.com/ru-ru/documentation/articles/php-create-account/#enable
  [документации средств командной строки Azure]: /ru-ru/manage/linux/other-resources/command-line-tools/#Commands_to_manage_mobile_services
  [установщик программ командной строки Azure]: http://go.microsoft.com/fwlink/p?LinkID=275464
  [установщик Azure SDK]: http://go.microsoft.com/fwlink/p?LinkId=252249
  [Node.js]: http://nodejs.org/
  [Установка Node.js через диспетчер пакетов]: https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager
  [Установка программ командной строки Azure для Mac и Linux]: http://go.microsoft.com/fwlink/p/?LinkId=275795
  [портале управления Azure]: https://manage.windowsazure.com/
  [справочнике по серверным скриптам мобильных служб]: http://go.microsoft.com/fwlink/p?LinkId=262293
