<properties 
	pageTitle="Миграция корпоративного веб-приложения в службу приложений Azure" 
	description="В этой статье описано, как использовать Web Apps Migration Assistant для быстрого переноса существующих веб-сайтов IIS в веб-приложения службы приложений Azure" 
	services="app-service\web" 
	documentationCenter="" 
	authors="cephalin" 
	writer="cephalin" 
	manager="wpickett" 
	editor=""/>

<tags 
	ms.service="app-service-web" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="03/24/2015" 
	ms.author="cephalin"/>

# Миграция корпоративного веб-приложения в службу приложений Azure

Вы можете легко перенести в [веб-приложения службы приложений](http://go.microsoft.com/fwlink/?LinkId=529714) существующие веб-сайты, которые работают в службах IIS версии 6 или более поздней версии. [Служба Web Apps Migration Assistant](https://www.movemetothecloud.net/) проанализирует установку IIS-сервера, определит, какие сайты можно перенести в службу приложений, выделит элементы, которые перенести не удастся или которые не поддерживает платформа, а затем перенесет веб-сайты и связанные с ними базы данных на платформу Azure.

>[AZURE.NOTE] Срок поддержки Windows Server 2003 истекает 14 июля 2015 года. Если веб-сайты на IIS-сервере хранятся в Windows Server 2003, можно поддерживать их работу на основе веб-приложений Azure, безопасного, экономичного и эффективного решения, при этом служба Web Apps Migration Assistant поможет автоматизировать процесс переноса необходимых данных. 

## Элементы, проверяемые во время анализа совместимости ##
Служба Migration Assistant создает отчет о готовности, чтобы выявить потенциальные проблемы, которые могут помешать успешной миграции с локального сервера IIS на веб-приложения службы приложений Azure. Ниже указаны некоторые ключевые моменты, которые необходимо учесть.

-	Привязки портов: служба веб-приложений Azure поддерживает только порт 80 для HTTP-трафика и порт 443 для HTTPS-трафика. Конфигурации других портов будут проигнорированы, а трафик будет направлен на порт 80 или 443. 
-	Проверка подлинности: служба веб-приложений Azure поддерживает анонимную проверку подлинности по умолчанию и проверку подлинности на основе форм, указанную в приложении. Проверка подлинности Windows может использоваться только при интеграции в Azure Active Directory и ADFS. Другие формы проверки подлинности, например, обычная проверка подлинности, сейчас не поддерживаются. 
-	Глобальный кэш сборок (GAC) не поддерживается веб-приложениями. Если ваше приложение ссылается на сборки, которые обычно развертываются в глобальном кэше сборок, их необходимо развернуть в папку bin приложения в веб-приложениях. 
-	Режим совместимости с IIS5 не поддерживается в веб-приложениях. 
-	Пулы приложений: каждый сайт и его дочерние приложения в веб-приложениях Azure работают в том же пуле приложений. Если сайт имеет несколько дочерних приложений, которые используют различные пулы приложений, их необходимо объединить в единый пул с общими настройками или перенести каждое приложение в отдельное веб-приложение.
-	Компоненты COM: веб-приложения Azure не разрешают регистрацию COM-компонентов на платформе. Если веб-сайты или приложения используют COM-компоненты, то их необходимо переписать в управляемый код и развернуть вместе с веб-сайтом или приложением.
-	Фильтры ISAPI: веб-приложения поддерживают использование фильтров ISAPI. Сделайте следующее:
	-	разверните библиотеки DLL вместе с веб-приложением; 
	-	зарегистрируйте библиотеки DLL в файле [Web.config](http://www.iis.net/configreference/system.webserver/isapifilters)
	-	разместите файл applicationHost.xdt в корневой каталог сайта с содержимым, указанным ниже:

			<?xml version="1.0"?>
			<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
			<configSections>
			    <sectionGroup name="system.webServer">
			      <section name="isapiFilters" xdt:Transform="SetAttributes(overrideModeDefault)" overrideModeDefault="Allow" />
			    </sectionGroup>
			  </configSections>
			</configuration>

		Другие примеры использования преобразований XML-документа с помощью веб-сайта см. в разделе [Преобразование веб-сайта Microsoft Azure](http://blogs.msdn.com/b/waws/archive/2014/06/17/transform-your-microsoft-azure-web-site.aspx).

-	Другие компоненты, например SharePoint, серверные расширения главных страниц (FPSE), FTP-служба и SSL-сертификаты, перенесены не будут.

## Использование Web Apps Migration Assistant ##
В данном разделе рассмотрен пошаговый пример миграции нескольких веб-сайтов, использующих базу данных SQL Server и работающих на локальном компьютере Windows Server 2003 R2 (IIS 6.0):

1.	На IIS-сервере или на клиентской машине перейдите на веб-сайт [https://www.movemetothecloud.net/](https://www.movemetothecloud.net/) 

	![](./media/web-sites-migration-from-iis-server/migration-tool-homepage.png)

2.	Установите Web Apps Migration Assistant, нажав кнопку **Выделенный сервер IIS**. Дополнительные параметры можно будет настроить на следующих этапах. 
4.	Нажмите кнопку **Средство установки** и установите службу Web Apps Migration Assistant на свой компьютер.

	![](./media/web-sites-migration-from-iis-server/install-page.png)

	>[AZURE.NOTE] Можно также щелкнуть **Скачать для автономной установки**, скачать ZIP-файл и установить службу на серверах без подключения к Интернету. Либо можно выбрать пункт **Загрузить имеющийся отчет о готовности к переносу** - дополнительный параметр для работы с имеющимся отчетом о готовности к переносу, который был создан перед этим (процесс создания будет описан ниже).

5.	В окне **Установка приложения** щелкните **Установить**, чтобы начать установку службы на компьютер. При необходимости будут также установлены связанные компоненты, такие как Web Deploy, DacFX и IIS. 

	![](./media/web-sites-migration-from-iis-server/install-progress.png)

	После установки служба Web Apps Migration Assistant запускается автоматически.
  
6.	Выберите пункт **Перенести сайты и базы данных с удаленного сервера на платформу Azure**. Введите учетные данные администратора удаленного сервера и нажмите кнопку **Продолжить**. 

	![](./media/web-sites-migration-from-iis-server/migrate-from-remote.png)

	Конечно, можно перенести данные и с локального сервера. Вариант удаленного переноса полезен в тех случаях, когда необходимо перенести веб-сайты с рабочего сервера IIS.
 
	На этом этапе средство переноса проверит конфигурацию сервера IIS (сайты, приложения, пулы приложений и компоненты), чтобы определить, какие веб-сайты готовы к миграции. 

8.	Ниже на снимке экрана показаны три веб-сайта: **Default Web Site**, **TimeTracker** и **CommerceNet4**. У всех этих сайтов есть базы данных, которые необходимо перенести. Выберите все сайты, которые необходимо проверить, и нажмите кнопку **Далее**.

	![](./media/web-sites-migration-from-iis-server/select-migration-candidates.png)
 
9.	Нажмите кнопку **Отправить**, чтобы начать передачу отчета о готовности к переносу. Если нажать кнопку **Сохранить файл локально**, то можно запустить средство переноса и отправить сохраненный отчет о готовности к переносу позже.

	![](./media/web-sites-migration-from-iis-server/upload-readiness-report.png)
 
	Когда отчет о готовности будет передан, Azure выполнит анализ готовности и выведет результаты. Прежде чем продолжить, прочтите детали оценки каждого веб-сайта и убедитесь, что все задачи понятны и решены. 
 
	![](./media/web-sites-migration-from-iis-server/readiness-assessment.png)

12.	Нажмите кнопку **Начать миграцию**, чтобы начать перенос данных. Произойдет перенаправление на платформу Azure для входа в учетную запись. Важно войти учетную запись с активной подпиской Azure. Если у вас нет учетной записи Azure, то зарегистрироваться для получения пробной версии можно здесь. 

13.	Выберите учетную запись клиента, подписку Azure и регион для использования веб-приложений и баз данных, перенесенных на Azure, затем нажмите кнопку **Начать миграцию**. Выбрать веб-сайты для переноса можно позже.

	![](./media/web-sites-migration-from-iis-server/choose-tenant-account.png)

14.	В следующем окне можно изменить настройки по умолчанию:

	- использовать существующую базу данных SQL Azure или создать новую базу данных SQL Azure и настроить учетные данные для нее;
	- выбрать веб-сайты для переноса;
	- определить имена для веб-приложений Azure и связанных с ними баз данных SQL;
	- настроить глобальные параметры и параметры на уровне веб-сайта.

	На следующем снимке экрана показаны все выбранные для миграции веб-сайты с параметрами по умолчанию.

	![](./media/web-sites-migration-from-iis-server/migration-settings.png)

	>[AZURE.NOTE] Установите флажок **Включить Azure Active Directory** в пользовательских настройках, чтобы выполнить интеграцию веб-приложения Azure в [Azure Active Directory] (active-directory-whatis.md)(**каталог по умолчанию**). Дополнительную информацию о синхронизации Azure Active Directory с локальным каталогом Active Directory см. в разделе [Интеграция служб каталогов](http://msdn.microsoft.com/library/jj573653).

16.	 После внесения всех необходимых изменений нажмите кнопку **Создать**, чтобы запустить процесс миграции. Средство миграции создаст базу данных SQL Azure и веб-приложение Azure, а затем опубликует содержимое веб-сайта и баз данных. Процесс миграции четко отображается в средстве миграции, а по окончании миграции отобразится окно сводки, в котором будут указаны сведения о перенесенных компонентах сайтов, результатах миграции, а также ссылки на созданные веб-приложения Azure. 

	Если в процессе миграции возникнут ошибки, то в средстве миграции отобразится сбой и будет выполнен откат изменений. Можно также нажать кнопку **Отправить отчет об ошибке**, чтобы отправить команде разработчиков отчет об ошибке вместе со стеком вызовов ошибки и собственным сообщением. 

	![](./media/web-sites-migration-from-iis-server/migration-error-report.png)

	Если миграция завершена успешно, то можно нажать кнопку **Отправить отзыв**, чтобы оставить свой комментарий. 
 
20.	Перейдите по ссылкам на веб-приложения Azure и проверьте результаты миграции.

21. Теперь вы можете управлять перенесенными веб-приложениями в службе приложений Azure. Для этого войдите на [портал Azure](http://go.microsoft.com/fwlink/?LinkId=529715).

22. На портале Azure откройте колонку веб-приложений, чтобы просмотреть перенесенные веб-сайты (отображаются как веб-приложения), а затем щелкните один из них, чтобы начать управлять веб-приложением, например настроить непрерывную публикацию, создать резервные копии, выполнить автоматическое масштабирование и мониторинг использования и производительности.

	![](./media/web-sites-migration-from-iis-server/TimeTrackerMigrated.png)

>[AZURE.NOTE] Если вы хотите начать работу со службой приложений Azure еще до создания учетной записи Azure, перейдите на страницу [ознакомительной версии службы приложений](http://go.microsoft.com/fwlink/?LinkId=523751). Там вы сможете сразу создать свое первое веб-приложение, правда срок его службы будет ограничен. Никаких кредитных карт и обязательств.

## Изменения
* Сведения об изменении веб-сайтов на службу приложений см. в статье [Служба приложений Azure и ее влияние на существующие службы Azure](http://go.microsoft.com/fwlink/?LinkId=529714)
* Сведения о переходе со старого портала на новый см. в статье [Справочная информация о навигации по предварительной версии портала](http://go.microsoft.com/fwlink/?LinkId=529715).

<!--HONumber=49-->