<properties
   pageTitle="Подключение к кластеру службы контейнеров Azure | Microsoft Azure"
   description="Сведения о подключении к кластеру службы контейнеров Azure с использованием туннеля SSH."
   services="container-service"
   documentationCenter=""
   authors="rgardler"
   manager="timlt"
   editor=""
   tags="acs, azure-container-service"
   keywords="Docker, контейнеры, микрослужбы, DC/OS, Azure"/>

<tags
   ms.service="container-service"
   ms.devlang="na"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="09/13/2016"
   ms.author="rogardle"/>


# Подключение к кластеру службы контейнеров Azure

Кластеры DC/OS и Docker Swarm, развернутые с помощью службы контейнеров Azure, предоставляют конечные точки REST. Но эти конечные точки не открыты для внешнего использования. Чтобы управлять этими конечными точками, необходимо создать туннель Secure Shell (SSH). После создания туннеля SSH можно выполнить команды к конечным точкам кластера и просмотреть пользовательский интерфейс кластера через браузер на вашем компьютере. В этом документе приводятся инструкции по созданию туннеля SSH в ОС Linux, OS X и Windows.

>[AZURE.NOTE] Вы можете создать сеанс SSH, используя систему управления кластером, но это не рекомендуется. Работа напрямую в системе управления сопряжена с риском случайного изменения конфигурации.

## Создание туннеля SSH в Linux или OS X

Во-первых, чтобы создать туннель SSH в любой из этих операционных систем, вам нужно узнать общедоступное DNS-имя главного сервера с балансировкой нагрузки. Для этого разверните группу ресурсов, чтобы отображались все ресурсы. Найдите и выберите общедоступный IP-адрес образца. Откроется колонка со сведениями об общедоступном IP-адресе, в которой также будет DNS-имя. Сохраните это имя для последующего использования. <br />


![Общедоступное DNS-имя](media/pubdns.png)

Теперь откройте оболочку и выполните следующую команду, где:

**PORT** — это порт конечной точки, к которой требуется предоставить доступ. Для Swarm это порт 2375, а Для DC/OS используется порт 80. **USERNAME** — имя пользователя, указанное при развертывании кластера. **DNSPREFIX** — префикс DNS, указанный при развертывании кластера. **REGION** — регион, где расположена ваша группа ресурсов. **PATH\_TO\_PRIVATE\_KEY** [необязательно] — это путь к закрытому ключу, который соответствует открытому ключу, указанному во время создания кластера службы контейнеров. Используйте этот параметр с флагом -i.

```bash
ssh -L PORT:localhost:PORT -f -N [USERNAME]@[DNSPREFIX]mgmt.[REGION].cloudapp.azure.com -p 2200
```
> Для SSH-подключения используется порт 2200, а не стандартный порт 22.

## Туннель DC/OS

Чтобы создать туннель к связанным с DC/OS конечным точкам, выполните следующую команду:

```bash
sudo ssh -L 80:localhost:80 -f -N azureuser@acsexamplemgmt.japaneast.cloudapp.azure.com -p 2200
```

Связанные с DC/OS конечные точки теперь доступны по такому адресу:

- DC/OS: `http://localhost/`
- Marathon: `http://localhost/marathon`
- Mesos: `http://localhost/mesos`

Аналогичным образом через этот туннель можно подключаться к интерфейсам REST API каждого приложения.

## Туннель Swarm

Чтобы открыть туннель для конечной точки Swarm, выполните следующую команду:

```bash
ssh -L 2375:localhost:2375 -f -N azureuser@acsexamplemgmt.japaneast.cloudapp.azure.com -p 2200
```

Теперь можно задать переменную среды DOCKER\_HOST, как указано далее. Вы можете продолжить использовать интерфейс командной строки Docker в обычном режиме.

```bash
export DOCKER_HOST=:2375
```

## Создание туннеля SSH в Windows

Создавать туннели SSH в Windows можно несколькими способами. В этом документе описывается вариант с использованием PuTTY.

Скачайте PuTTY в операционную систему Windows и запустите приложение.

Введите имя узла, которое состоит из имени администратора кластера и общедоступного DNS-имени первого главного сервера в кластере. **Имя узла** будет выглядеть так: `adminuser@PublicDNS`. В поле **Порт** введите значение 2200.

![Конфигурация PuTTY 1](media/putty1.png)

Выберите **SSH**, а затем **Проверка подлинности**. Выберите файл закрытого ключа для проверки подлинности.

![Конфигурация PuTTY 2](media/putty2.png)

Выберите **Туннели** и настройте следующие порты для перенаправления:
- **исходный порт** — используйте порт 80 для DC/OS или 2375 для Swarm;
- **конечный порт** — используйте localhost:80 для DC/OS или localhost:2375 для Swarm.

В следующем примере выполняется настройка для DC/OS. Для Docker Swarm эта процедура аналогична.

>[AZURE.NOTE] При создании этого туннеля нужно, чтобы порт 80 больше нигде не использовался.

![Конфигурация PuTTY 3](media/putty3.png)

По завершении сохраните конфигурацию подключения и откройте сеанс подключения PuTTY. После подключения конфигурацию порта можно просмотреть в журнале событий PuTTY.

![Журнал событий PuTTY](media/putty4.png)

После настройки туннеля для DC/OS связанная конечная точка будет доступна по такому адресу:

- DC/OS: `http://localhost/`
- Marathon: `http://localhost/marathon`
- Mesos: `http://localhost/mesos`

После настройки туннеля для Docker Swarm доступ к кластеру Swarm можно получать через интерфейс командной строки Docker. Сначала вам нужно будет настроить переменную среды Windows с именем `DOCKER_HOST` (задайте для нее значение ` :2375`).

## Дальнейшие действия

Развертывание контейнеров и управление ими с помощью DC/OS или Swarm:

- [Работа со службой контейнеров Azure и DC/OS](container-service-mesos-marathon-rest.md)
- [Работа со службой контейнеров Azure и Docker Swarm](container-service-docker-swarm.md)

<!---HONumber=AcomDC_0914_2016-->