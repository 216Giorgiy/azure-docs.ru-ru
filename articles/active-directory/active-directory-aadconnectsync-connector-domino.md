<properties
   pageTitle="Синхронизация Azure AD Connect: соединитель Lotus Domino | Microsoft Azure"
   description="В этой статье описана настройка соединителя Lotus Domino (Майкрософт)."
   services="active-directory"
   documentationCenter=""
   authors="AndKjell"
   manager="stevenpo"
   editor=""/>

<tags
   ms.service="active-directory"
   ms.workload="identity"
   ms.tgt_pltfrm="na"
   ms.devlang="na"
   ms.topic="article"
   ms.date="04/20/2016"
   ms.author="andkjell"/>

# Технический справочник по соединителю Lotus Domino

В этой статье описывается соединитель Lotus Domino. Статья относится к следующим продуктам:

- Microsoft Identity Manager 2016 (MIM2016);
- Forefront Identity Manager 2010 R2 (FIM2010R2).
    -   Необходимо установить исправление 4.1.3671.0 или более позднюю версию ([KB3092178](https://support.microsoft.com/kb/3092178)).

Для MIM2016 и FIM2010R2 соединитель можно загрузить из [центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkId=717495).

## Обзор соединителя Lotus Domino

Соединитель Lotus Domino позволяет интегрировать службу синхронизации с сервером IBM Lotus Domino.

На системном уровне текущий выпуск соединителя поддерживает следующие функции.

| Функция | Поддержка |
| --- | --- |
| Подключенный источник данных | Сервер: <li>Lotus Domino 8.5.x</li><li>Lotus Domino 9.x</li>Client:<li>Lotus Notes 9.x</li> |
| Сценарии | <li>Управление жизненным циклом объекта.</li><li>Управление группами.</li><li>Управление паролями.</li> |
| Операции | <li>Полный и разностный импорт.</li><li>Экспорт.</li><li>Настройка и изменение HTTP-пароля.</li> |
| Схема | <li>Лицо (перемещаемый пользователь, контакт (лицо без сертификата)).</li><li>Группа.</li><li>Ресурс (ресурс, комната, собрание по сети).</li><li>База данных для приема писем.</li><li>Динамическое обнаружение атрибутов для поддерживаемых объектов.</li> |

Соединитель Lotus Domino использует клиент Lotus Notes для связи с сервером Lotus Domino. Поэтому на сервере синхронизации должна быть установлена поддерживаемая версия клиента Lotus Notes. Взаимодействие между клиентом и сервером реализуется через интерфейс взаимодействия .NET Interop Lotus Notes (Interop.domino.dll). Этот интерфейс обеспечивает связь между платформой Microsoft.NET и клиентом Lotus Notes, а также поддерживает доступ к документам и представлениям Lotus Domino. Для импорта изменений можно также использовать собственный интерфейс C++ (в зависимости от выбранного способа импорта).

### Предварительные требования

Прежде чем использовать соединитель, убедитесь, что, помимо всех упомянутых выше исправлений, на сервере синхронизации установлены такие компоненты:

- Microsoft .NET Framework, начиная с версии 4.5.2;
- Клиент Lotus Notes.
- Для соединителя Lotus Domino требуется, чтобы на сервере каталогов Domino присутствовала стандартная база данных Schema Lotus Domino LDAP (schema.nsf). Необходимо проверить ее наличие. Если база данных отсутствует, ее можно установить, запустив или перезапустив на сервере Domino службу LDAP.

### Права на доступ к подключенному источнику данных

Чтобы выполнять задачи, поддерживаемые соединителем Lotus Domino, вы должны быть членом следующих групп:

- администраторы с правами полного доступа;
- Администраторы
- администраторы базы данных.

В следующей таблице перечислены разрешения, необходимые для выполнения каждой операции.

| Операция | Права доступа |
| --- | --- |
| Импорт | <li>Чтение общедоступных документов.</li><li> Администраторы с правами полного доступа (если вы входите в группу администраторов с правами полного доступа, вы автоматически получаете права доступа к входящим спискам ACL).</li> |
| Экспорт и установка пароля | Действующие права доступа: <li>создание документов;</li><li>удаление документов;</li><li>чтение общедоступных документов;</li><li>запись общедоступных документов;</li><li>репликация или копирование документов.</li>Кроме указанных выше прав доступа для операций экспорта должны быть назначены следующие роли: <li>CreateResource;</li><li>GroupCreator;</li><li>GroupModifier;</li><li>UserCreator;</li><li>UserModifier.</li> |

### Прямые операции и AdminP

Операции направляются в каталог Domino напрямую или через процесс AdminP. В следующих таблицах перечислены все поддерживаемые объекты и операции, а также указаны связанные методы реализации (если применимо).

**Основная адресная книга**

| Объект | Создание | Блокировка изменений | Удалить |
| --- | --- | --- | --- |
| Person | AdminP | Напрямую | AdminP |
| Группа | AdminP | Напрямую | AdminP |
| База данных для входящих писем | Напрямую | Напрямую | Напрямую |
| Ресурс | AdminP | Напрямую | AdminP |

**Вторичная адресная книга**

| Объект | Создание | Блокировка изменений | Удалить |
| --- | --- | --- | --- |
| Person | Недоступно | Напрямую | Напрямую |
| Группа | Напрямую | Напрямую | Напрямую |
| База данных для входящих писем | Напрямую | Напрямую | Напрямую |
| Ресурс | Недоступно | Недоступно | Недоступно |

При создании ресурса создается документ Notes. Соответственно, при удалении ресурса этот документ будет также удален.

### Порты и протоколы

Клиент IBM Lotus Notes и серверы Domino взаимодействуют с использованием протокола удаленного вызова процедур Notes (NRPC), реализуемого через TCP/IP. Номер порта по умолчанию — 1352, но администратор Domino может его изменить.

### Не поддерживается

В текущем выпуске соединителя Lotus Domino не поддерживаются следующие операции:

- Перемещение почтовых ящиков между серверами.

## Создание нового соединителя

### Установка и настройка клиентского программного обеспечения

**До** установки соединителя на сервере необходимо установить Lotus Notes.

Выберите вариант **Single User Install** (Установка для одного пользователя). Выбранный по умолчанию вариант **Multi-User Install** (Установка для нескольких пользователей) работать не будет.

![Notes1](./media/active-directory-aadconnectsync-connector-domino/notes1.png)

На странице установки компонентов выберите только необходимые компоненты Lotus Notes и **Client Single Logon** (Единый вход для клиента). Единый вход нужен для того, чтобы соединитель мог получить доступ к серверу Domino.

![Notes2](./media/active-directory-aadconnectsync-connector-domino/notes2.png)

**Примечание.** Следует однократно запустить Lotus Notes от имени пользователя, который находится на том же сервере, что и учетная запись, которая будет использоваться в качестве учетной записи службы соединителя. Не забудьте закрыть клиент Lotus Notes на сервере. Он не может выполняться одновременно с подключением соединителя к серверу Domino.

### Создание соединителя

Чтобы создать соединитель Lotus Domino, в **Synchronization Service** (Служба синхронизации) последовательно выберите элементы **Management Agent** (Агент управления)и **Create** (Создать). Выберите соединитель **Lotus Domino (Microsoft)**.

![Создание соединителя](./media/active-directory-aadconnectsync-connector-domino/createconnector.png)

Если в вашей версии службы синхронизации есть возможность выбора **архитектуры**, убедитесь, что в разделе **Process** (Процесс) для соединителя установлен запуск по умолчанию.

### Соединение

На странице свойств подключения необходимо указать имя сервера Lotus Domino и ввести учетные данные для входа.

![Соединение](./media/active-directory-aadconnectsync-connector-domino/connectivity.png)

Свойство Domino Server (Сервер Domino) поддерживает два формата имени сервера:

- имя\_сервера;
- имя\_сервера/имя\_каталога.

Рекомендуем использовать формат **имя\_сервера/имя\_каталога**, так как он обеспечивает более быстрый ответ при обмене данными между соединителем и сервером Domino.

Предоставленный файл идентификации пользователя хранится в базе данных конфигураций службы синхронизации.

Для параметра **Delta Import** (Разностный импорт) доступны следующие значения:

- **None** (Нет) — соединитель не будет выполнять операции разностного импорта.
- **Add/Update** (Добавление и обновление) — соединитель будет выполнять такие операции разностного импорта, как добавление и обновление. Операции удаления выполняются только при выбранном значении **Full Import** (Полный импорт). Для этой операции используется интерфейс взаимодействия Notes .Net.
- **Add/Update/Delete** (Добавление, обновление и удаление) — соединитель будет выполнять такие операции разностного импорта, как добавление, обновление и удаление. Для этой операции используются собственные интерфейсы Notes C++.

Для параметра **Schema Options** (Параметры схемы) доступны следующие значения:

- **Default-Schema** (Схема по умолчанию) — значение по умолчанию. Соединитель будет определять схему, предоставляемую сервером Domino.
- **DSML-Schema** (Схема DSML) — используется только в том случае, если сервер Domino не предоставляет доступ к схеме. Вместо этого вы можете создать файл DSML со схемой и импортировать его. Дополнительные сведения об использовании DSML см. в документации по [OASIS](https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=dsml).

Когда вы нажмете кнопку Next (Далее), система проверит идентификатор пользователя и пароль, указанные в конфигурации.

### Глобальные параметры

На странице глобальных параметров можно настроить часовой пояс, а также параметры операций импорта и экспорта.

![Глобальные параметры](./media/active-directory-aadconnectsync-connector-domino/globalparameters.png)

Параметр **Domino Server Time Zone** (Часовой пояс сервера Domino) определяет расположение сервера Domino.

Этот параметр конфигурации используется для операций **разностного импорта**, так как он позволяет службе синхронизации определять различия между двумя последними операциями импорта.

#### Параметры и метод выполнения импорта

Для параметра **Perform Full Import By** (Метод выполнения полного импорта) доступны следующие значения.

- Поиск
- View (Просмотр) (рекомендуемое значение).

Метод **Search** (Поиск) выполняется с использованием индексов в Domino; при этом индексы обычно не обновляются в режиме реального времени, поэтому полученные от сервера данные могут быть неточными. Для системы с большим количеством изменений такой вариант не самый лучший, так как он может иногда отображает ложные данные. Тем не менее метод **Search** (Поиск) выполняется быстрее, чем метод **View** (Просмотр).

Рекомендуем использовать метод **View** (Просмотр), так как он отображает правильное состояние данных. Он немного медленнее, чем метод поиска.

#### Создание виртуальных контактных объектов

Для параметра **Enable creation of \_Contact object** (Разрешить создание контактного объекта) доступны следующие значения.

- None
- Non-Reference Values (Значения, не являющиеся ссылками).
- Reference and Non-Reference Values (Значения, являющиеся и не являющиеся ссылками).

В Domino ссылочные атрибуты могут содержать много разных форматов ссылок на другие объекты. Для представления разных вариантов ссылок соединитель использует объекты \_Contact, которые также называются виртуальными контактами. Эти объекты создаются для присоединения к существующим объектам MV в виде новых объектов, благодаря чему они могут сохранять ссылочные атрибуты.

Если этот параметр включен, а содержимое ссылочного атрибута имеет формат, отличный от DN, будет создан объект \_Contact. Например, атрибут членства в группе может содержать SMTP-адреса. Также в ссылочных атрибутах могут содержаться атрибуты shortName и другие атрибуты. В таком случае выберите вариант **Non-Reference Values** (Значения, не являющиеся ссылками). Этот вариант чаще всего используется в реализациях Domino.

Если Lotus Domino настроен на использование отдельных адресных книг, в которых разные имена представляют один и тот же объект, можно также создать объекты \_Contact для всех ссылочных значений такой адресной книги. В этом случае выберите вариант **Reference and Non-Reference Values** (Значения, являющиеся и не являющиеся ссылками).

Если в Domino у атрибута **FullName** есть несколько значений, вам может понадобиться включить создание виртуальных контактов для разрешения ссылок. Этот атрибут может иметь несколько значений после объединения или разъединения. В таком случае установите флажок **Enable... FullName has multiple values** (Разрешить несколько значений для FullName).

При объединении с использованием правильных атрибутов объекты \_Contact будут присоединены к объекту MV.

Для этих объектов к DN будет добавлено VC=\_Contact.

#### Параметры импорта — конфликтующий объект

**Исключение конфликтующего объекта**

В масштабных реализациях Domino возможна ситуация, когда несколько объектов из-за проблем при репликации имеют одинаковые DN. В таких случаях соединитель будет видеть два объекта с разными атрибутами UniversalID, но с одинаковыми DN. Это приведет к созданию временного объекта в пространстве соединителя. Соединитель может пропускать объекты, которые в Domino были указаны как жертвы репликации. Рекомендуется оставить этот флажок установленным.

#### Параметры экспорта

Если параметр **Use AdminP for updating references** (Использовать AdminP для обновления ссылок) не выбран, экспорт ссылочных атрибутов, например атрибутов членства, будет выполняться напрямую без использования процесса AdminP. Такой вариант следует использовать, только если вы не настроили AdminP на поддержание целостности данных.

#### Сведения о маршрутизации

В Domino ссылочные атрибуты иногда содержат сведения о маршрутизации, внедренные в DN как суффикс. Например, атрибут членства в группе может содержать строку **CN=example/organization@ABC**. Суффикс @ABC предоставляет сведения о маршрутизации. Domino использует сведения о маршрутизации, чтобы правильно отправлять сообщения электронной почты в нужную систему Domino, которая может располагаться в другой организации. В поле сведений о маршрутизации можно указать суффиксы маршрутизации, которые используются в организации в контексте соединителя. Если в ссылочном атрибуте в качестве суффикса обнаружено одно из этих значений, сведения о маршрутизации удаляются из ссылки, чтобы она соответствовала DN объекта в пространстве соединителя. Если суффикс маршрутизации в ссылочном атрибуте не совпадает ни с одним из указанных значений, создается объект \_Connector. В DN таких объектов \_Contact будет добавлена строка **RO=@<RoutingSuffix>**. Также для таких объектов \_Contact добавляются атрибуты \_routingName, \_contactName, \_displayName и UniversalID, которые позволяют при необходимости присоединяться к реальным объектам.

#### Дополнительные адресные книги

Если у вас не установлена служба **Directory Assistance**, которая предоставляет имена дополнительных адресных книг, можно ввести эти данные вручную.

#### Многозначные преобразования

Многие атрибуты в Lotus Domino являются многозначными. Соответствующие им атрибуты метавселенной обычно являются однозначными. Если вы настроите параметры операций импорта и экспорта, соединитель поможет вам выполнять перевод соответствующих атрибутов для упрощения конфигурации.

**экспорт.**

Параметр операции экспорта поддерживает два режима:

- Append item (Добавить элемент).
- Replace item (Заменить элемент).

**Replace item** (Заменить элемент) — если выбрать этот вариант, соединитель всегда будет удалять из Domino текущие значения атрибута и заменять их указанными значениями. Можно указывать однозначные или многозначные значения.

Рассмотрим для примера объект Рerson, у которого атрибут Assistant имеет следующие значения:

- CN=Greg Winston/OU= Contoso /O=Americas,NAB=names.nsf
- CN=John Smith/OU= Contoso /O=Americas,NAB=names.nsf

Если к объекту Рerson будет добавлен новый атрибут Assistant с именем **David Alexander**, результат будет следующим:

- CN=David Alexander/OU= Contoso /O=Americas,NAB=names.nsf

**Append Item** (Добавить элемент) — если выбрать этот вариант, соединитель будет сохранять существующие значения для атрибута в Domino, вставляя новые значения в верхнюю часть списка данных.

Рассмотрим для примера объект Рerson, у которого атрибут Assistant имеет следующие значения:

- CN=Greg Winston/OU= Contoso /O=Americas,NAB=names.nsf
- CN=John Smith/OU= Contoso /O=Americas,NAB=names.nsf

Если к объекту Рerson будет добавлен новый атрибут Assistant с именем **David Alexander**, результат будет следующим:

- CN=David Alexander/OU= Contoso /O=Americas,NAB=names.nsf
- CN=Greg Winston/OU= Contoso /O=Americas,NAB=names.nsf
- CN=John Smith/OU= Contoso /O=Americas,NAB=names.nsf

**Импорт**

Параметр операции импорта поддерживает два режима:

- значение по умолчанию
- Multivalued to Single Value (Преобразование многозначных значений в однозначные).

**Default** (По умолчанию) — если выбрать этот вариант, будут импортированы все значения всех атрибутов.

**Multivalued to Single Value** (Преобразование многозначных значений в однозначные) — если выбрать этот вариант, все многозначные атрибуты будут преобразованы в однозначные. Если существует несколько значений, будет использоваться самое верхнее (обычно это самое последнее значение).

Пример:

Рассмотрим объект Person, у которого атрибут Assistant имеет следующие значения:

- CN=David Alexander/OU= Contoso /O=Americas,NAB=names.nsf
- CN=Greg Winston/OU= Contoso /O=Americas,NAB=names.nsf
- CN=John Smith/OU= Contoso /O=Americas,NAB=names.nsf

Самое последнее обновление для этого атрибута — это значение **David Alexander**. Поскольку для параметра операции импорта выбрано преобразование многозначных значений в однозначные, соединитель импортирует в пространство соединителя только значение **David Alexander**.

Логика преобразования многозначных атрибутов в однозначные не применяется к атрибутам членства в группе и к атрибутам полного имени (fullname) объекта Person.

Также в качестве исключений из глобального правила можно настроить правила преобразования многозначных атрибутов при импорте и экспорте для каждого атрибута. Чтобы настроить такой вариант, введите требуемые значения в формате [тип\_объекта].[имя\_атрибута] в текстовые поля **import exclusion attribute list** (список атрибутов-исключений при импорте) и **export exclusion attribute list** (список атрибутов-исключений при экспорте). Например, если вы введете Person.Assistant и установите глобальный флажок для импорта всех значений, для атрибута Assistant будет импортировано только первое значение.

#### Заверители

Здесь перечисляются все организации и подразделения. Чтобы экспортировать объекты Person в основную адресную книгу, требуется заверитель с соответствующим паролем.

Если все заверители имеют одинаковые пароли, можно использовать вариант **Password for all Certifers(s)** (Пароль для всех заверителей). Тогда здесь вы сможете ввести пароль, а затем указать файл заверителя.

Если выполняется только импорт, указывать заверителей не требуется.

### Настройка иерархии подготовки

При настройке соединителя Lotus Domino это диалоговое окно можно пропустить. Это связано с тем, что соединитель Lotus Domino не поддерживает иерархическую подготовку.

![Иерархия подготовки](./media/active-directory-aadconnectsync-connector-domino/provisioninghierarchy.png)

### Настройка разделов и иерархий

При настройке разделов и иерархий необходимо выбрать основную адресную книгу с именем NAB=names.nsf.

Кроме основной адресной книги можно выбрать дополнительные адресные книги, если такие существуют.

![Разделы](./media/active-directory-aadconnectsync-connector-domino/partitions.png)

### Выбор атрибутов

При настройке атрибутов следует выбрать все атрибуты, которые начинаются с префикса **\_MMS\_**. Эти атрибуты обязательны при подготовке новых объектов для Lotus Domino.

![Атрибуты](./media/active-directory-aadconnectsync-connector-domino/attributes.png)

## Управление жизненным циклом объекта

В этом разделе приводится обзор разных объектов в Domino.

### Объекты Person

Объект Person представляет пользователей в организации и подразделениях. Помимо атрибутов по умолчанию администратор Domino может добавлять для объекта Person настраиваемые атрибуты. Объект Person должен содержать все обязательные атрибуты, это базовое требование. Полный список обязательных атрибутов см. в разделе [Свойства Lotus Notes](#lotus-notes-properties). Чтобы зарегистрировать объект Person, должны выполняться следующие условия.

- Должна быть определена адресная книга (names.nsf), которая должна быть основной адресной книгой.
- Нужно иметь идентификатор заверителя O/OU и пароль для регистрации определенного пользователя в организации или подразделении.
- Необходимо определить набор свойств Lotus Notes для объекта Person. Они используются для подготовки объекта Person. Дополнительные сведения см. в разделе [Свойства Lotus Notes](#lotus-notes-properties) ниже в этом документе.
- Начальный пароль для HTTP-входа для объекта Person должен быть атрибутом, настраиваемым во время подготовки.
- Объект Person должен относиться к одному из трех поддерживаемых типов.
    1. Обычный пользователь с почтовым файлом и файлом идентификатора пользователя.
    2. Перемещаемый пользователь (обычный пользователь со всеми файлами перемещаемых баз данных).
    3. Контакт (пользователь без файла идентификатора).

Всех пользователей (кроме контактов) можно дополнительно разделить на пользователей США и международных пользователей, что определяется значением свойства \_MMS\_IDRegType. Пользователи — это люди, которые с помощью клиента Lotus Notes обращаются к серверам Lotus Domino и базе данных, у которых есть идентификатор Notes и документ Person. Для пользователей, которые используют Notes Mail, также создается файл электронной почты. Чтобы стать активным, пользователь должен зарегистрироваться. Дополнительные сведения см. в разделах:

- [Настройка пользователей Notes](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_SETTING_UP_NOTES_USERS.html)
- [Регистрация пользователей](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_REGISTERING_USERS.html)
- [Управление пользователями](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_MANAGING_USERS_5151.html)
- [Переименование пользователей](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_RENAMING_A_USER_AUTOMATICALLY.html)

Все эти операции выполняются в Lotus Domino, а затем импортируются в службу синхронизации.

### Ресурсы и комнаты

Ресурс — это другой тип базы данных в Lotus Domino. Ресурсы могут быть представлены переговорными с таким оборудованием, как проекторы. Соединитель Lotus Domino поддерживает вложенные типы ресурсов. Они определяются на основе атрибута Resource Type следующим образом.

| Тип ресурса | Атрибут типа ресурса |
| --- | --- |
| Комната | 1 |
| Ресурс (другое) | 2 |
| Собрания по сети | 3 |

Для использования объектов Resource должны быть выполнены следующие условия.

- На подключенном сервере Domino должна быть создана база данных резервирования ресурсов.
- Для объекта Resource должен быть определен сайт.

База данных резервирования ресурсов содержит документы трех типов:

- профиль сайта;
- Ресурс
- резервирование.

Дополнительные сведения о настройке базы данных резервирования ресурсов см. в разделе [Настройка базы данных резервирования ресурсов](https://www-01.ibm.com/support/knowledgecenter/SSKTMJ_8.0.1/com.ibm.help.domino.admin.doc/DOC/H_SETTING_UP_THE_RESOURCE_RESERVATIONS_DATABASE.html).

**Создание, обновление и удаление ресурсов**

Соединитель Lotus Domino выполняет в базе данных резервирования ресурсов операции создания, обновления и удаления. В результате этих действий в основной адресной книге (Names.nsf) создаются ресурсы в виде документов. Дополнительные сведения об изменении и удалении ресурсов см. в разделе [Изменение и удаление документов ресурсов](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_EDITING_AND_DELETING_RESOURCE_DOCUMENTS.html).

**Операции импорта и экспорта для ресурсов**

Ресурсы можно импортировать в службу синхронизации и экспортировать из нее, как и объект любого другого типа. Во время настройки следует выбрать тип объекта Resourse. Для успешного экспорта нужно указать тип ресурса, базу данных конференции и имя сайта.

### Базы данных для приема писем

База данных для приема писем предназначена для получения почтовых сообщений. Это почтовый ящик Lotus Domino (база данных Notes на основе шаблона Mail), который не связан с конкретной учетной записью Lotus Domino (т. е. не имеет файла идентификатора и пароля). База данных для приема писем имеет связанный уникальный идентификатор пользователя (short name) и собственный адрес электронной почты.

Каждый пользователь должен иметь только одну учетную запись Lotus Domino. Если нужно создать отдельный почтовый ящик с собственным адресом электронной почты, который будут совместно использовать несколько пользователей (например: group@contoso.com), вместо новой учетной записи Notes следует создать базу данных для приема писем. Контроль доступа к этому почтовому ящику осуществляется с помощью списка управления доступом (ACL). Этот список включает имена пользователей Notes, которым разрешено открывать почтовый ящик, используя свой файл идентификатора и пароль. Чтобы получить доступ к базе данных для приема писем, дополнительные пароли не нужны.

Список обязательных атрибутов приводится в разделе [Обязательные атрибуты](#mandatory-attributes) далее в этой статье.

Если база данных предназначена для получения электронной почты, в Lotus Domino создается документ базы данных для получения почты. Этот документ должен находится в каталоге Domino на каждом сервере, на котором хранится копия базы данных. Процесс создания документов базы данных для приема писем подробно описан в разделе [Создание документа базы данных для приема писем](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_CREATING_A_MAILIN_DATABASE_DOCUMENT_FOR_A_NEW_DATABASE_OVERVIEW.html).

Чтобы создать базу данных для приема писем, сначала нужно создать базу данных на сервере Domino (это делает администратор Lotus).

### Управление группами

Подробные сведения об управлении группами Lotus Domino см. в следующих ресурсах:

- [Использование групп](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_USING_GROUPS_OVER.html)
- [Создание группы](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_CREATING_AND_MODIFYING_GROUPS_STEPS_MIDTOPIC_55038956829238418.html)
- [Создание и изменение групп](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_CREATING_AND_MODIFYING_GROUPS_STEPS.html)
- [Управление группами](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_MANAGING_GROUPS_1804.html)
- [Переименование группы](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_RENAMING_A_GROUP_STEPS.html)

### Управление паролями

Для зарегистрированного пользователя Lotus Domino существует два типа паролей:

1. Пароль пользователя (хранится в файле User.id).
2. Пароль HTTP (для доступа через Интернет).

Соединитель Lotus Domino поддерживает только операции с паролем HTTP.

Управление паролями нужно включить для соединителя в конструкторе агента управления. Чтобы включить управление паролями, установите флажок **Enable password management** (Включить управление паролями) на диалоговой странице **Configure Extensions** (Настройка расширений).

![Настройка расширений](./media/active-directory-aadconnectsync-connector-domino/configureextensions.png)

Соединитель Lotus Domino поддерживает следующие операции для пароля HTTP.

- Настройка пароля — эта операция установит для пользователя в Domino новый пароль для доступа через Интернет и HTTP. По умолчанию учетная запись при этом будет разблокирована. Флажок для разблокировки доступен в интерфейсе WMI модуля синхронизации.
- Изменение пароля — этот сценарий выполняется, когда пользователь хочет изменить пароль или получает запрос на изменение пароля через указанное время. Для выполнения этой операции нужно указать оба пароля (старый и новый). Измененный пароль будет обновлен в Lotus Domino.

Дополнительные сведения см. в следующих статьях:

- [Использование функции блокировки через Интернет](http://www.ibm.com/developerworks/lotus/library/domino8-lockout/)
- [Управление паролями доступа через Интернет](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.help.domino.admin85.doc/H_NOTES_AND_INTERNET_PASSWORD_SYNCHRONIZATION_7570_OVER.html)

## Справочная информация

В этом разделе приведены описания атрибутов, а также требования к атрибутам для соединителя Lotus Domino.

### Свойства Lotus Notes

При подготовке объектов Person для каталога Lotus Domino все объекты должны иметь определенный набор свойств с заполненными значениями. Эти значения необходимы только для операций создания объектов.

В следующей таблице перечислены эти обязательные свойства и приведено их описание.

| Свойство | Описание |
| --- | --- |
| \_MMS\_AltFullName | Альтернативное полное имя пользователя. |
| \_MMS\_AltFullNameLanguage | Язык, на котором будет указано альтернативное полное имя пользователя. |
| \_MMS\_CertDaysToExpire | Количество дней с текущей даты до истечения срока действия сертификата. Если не указано, по умолчанию используется значение, равное двум годам от текущей даты. |
| \_MMS\_Certifier | Это свойство содержит имя организационной иерархии заверителя. Например: OU=OrganizationUnit,O=Org,C=Country. |
| \_MMS\_IDPath | Если свойство не заполнено, на сервере синхронизации не создается локальный файл идентификатора пользователя. Если это свойство содержит имя файла, в папке madata создается файл идентификатора пользователя. Свойство также может содержать полный путь; в таком случае файл идентификатора пользователя создается в этом расположении. |
| \_MMS\_IDRegType | Существует три типа лиц: контакты, пользователи США и международные пользователи. В следующем списке указаны возможные значения.<li>0 — контакт.</li><li>1 — пользователь США. </li><li>2 — международный пользователь.</li> |
| \_MMS\_IDStoreType | Обязательное свойство для пользователей США и международных пользователей. Свойство содержит целочисленное значение, которое определяет, где хранится идентификатор пользователя: как вложение в адресной книге Notes или в файле электронной почты пользователя. Если файл идентификатора пользователя хранится в виде вложения в адресной книге, его можно при желании перенести в файл, расположенный в свойстве \_MMS\_IDPath.<li>Пусто — файл идентификатора хранится в хранилище идентификаторов, или такого файла нет (используется для контактов).</li><li> 1 — вложение в адресной книге Notes. Для файлов идентификатора пользователя, которые хранятся в виде вложений, должно быть задано свойство \_MMS\_Password.</li><li>2 — идентификатор хранится в файле электронной почты пользователя. Свойству \_MMS\_UseAdminP нужно присвоить значение False, чтобы файл электронной почты бы создан во время регистрации пользователя. Для файлов идентификатора пользователя должно быть задано свойство \_MMS\_Password.</li>
| \_MMS\_MailQuotaSizeLimit | Допустимый размер файла базы данных электронной почты, в мегабайтах. |
| \_MMS\_MailQuotaWarningThreshold | Размер файла базы данных электронной почты в мегабайтах, при превышении которого создается предупреждение. |
| \_MMS\_MailTemplateName | Файл шаблона, который используется для создания файла электронной почты пользователя. Если шаблон указан, почтовый файл создается с использованием указанного шаблона. Если шаблон не указан, для создания файла используется шаблон по умолчанию. |
| \_MMS\_OU | Необязательное свойство, которое содержит имя подразделения для заверителя. Это свойство должно быть пустым для контактов. |
| \_MMS\_Password | Обязательное свойство для пользователей. Это свойство содержит пароль для файла идентификатора объекта. |
| \_MMS\_UseAdminP | Свойство должно иметь значение True, если почтовый файл должен быть создан на сервере Domino процессом AdminP (без синхронизации с операцией экспорта). Если свойство имеет значение False, файл электронной почты создается одновременно с пользователем Domino (синхронно с операцией экспорта). |

Для пользователя со связанным файлом электронной почты свойство \_MMS\_Password должно содержать значение. Для доступа к электронной почте через клиент Lotus Notes свойства MailServer и MailFile для пользователя должны содержать значения.

Для доступа к электронной почте через веб-браузер следующие свойства должны содержать значения.

- MailFile — обязательное свойство, указывающее расположение на сервере Lotus Domino, в котором хранится файл электронной почты.
- MailServer — обязательное свойство, которое содержит имя сервера Lotus Domino. Это имя используется при создании файла почты на сервере Lotus Domino.
- HTTPPassword — необязательное свойство, которое содержит пароль для доступа к объекту через веб-браузер.

Для доступа к серверу Domino без поддержки электронной почты свойство HTTPPassword должно содержать значение, а свойства MailFile и MailServer могут быть пустыми.

Если \_MMS\_ IDStoreType = 2 (хранение идентификатора в файле Mail), свойство MailSystem объекта NotesRegistrationclass будет иметь значение REG\_MAILSYSTEM\_INOTES (3).

### Обязательные атрибуты

Соединитель Lotus Domino поддерживает четыре основных типа объектов (типа документов) в службе синхронизации.

- Группа
- База данных для приема писем
- Person
- Контакт (лицо без заверителя)
- Ресурс

В этом разделе перечислены атрибуты, которые являются обязательными для каждого типа поддерживаемых объектов при экспорте на сервер Domino.

| Тип объекта | Обязательные атрибуты |
| --- | --- |
| Группа | <li>ListName</li> |
| База данных для приема почты | <li>FullName</li><li>MailFile</li><li>MailServer</li><li>MailDomain</li> |
| Person | <li>LastName</li><li>MailFile</li><li>ShortName</li><li>\_MMS\_Password</li><li>\_MMS\_IDStoreType</li><li>\_MMS\_Certifier</li><li>\_MMS\_IDRegType</li><li>\_MMS\_UseAdminP</li> |
| Контакт (лицо без заверителя) | <li>\_MMS\_IDRegType</li> |
| Ресурс | <li>FullName</li><li>ResourceType</li><li>ConfDB</li><li>ResourceCapacity</li><li>Site</li><li>DisplayName</li><li>MailFile</li><li>MailServer</li><li>MailDomain</li> |

## Распространенные проблемы и вопросы

### Не работает определение схемы

Чтобы определить схему, требуется наличие файла schema.nsf на сервере Domino. Этот файл будет отображаться, только если на сервере установлена поддержка LDAP. Если схему не удается обнаружить, проверьте выполнение следующих условий.

- Файл schema.nsf присутствует в корневой папке сервера Domino.
- У пользователя есть разрешения на просмотр файла schema.nsf.
- Выполнен принудительный перезапуск сервера LDAP. Откройте консоль Lotus Domino и выполните команду Tell LDAP ReloadSchema, чтобы перезагрузить схему.

### Отображаются не все дополнительные адресные книги.

Соединитель Domino использует службу Directory Assistance для поиска дополнительных адресных книг. Если дополнительные адресные книги отсутствуют, убедитесь, что на сервере Domino включена и настроена служба [Directory Assistance](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_ABOUT_DIRECTORY_ASSISTANCE.html).

### Настраиваемые атрибуты для Domino

Существует несколько способов расширить схему в Domino, чтобы она была представлена пользовательским атрибутом, который поддерживается соединителем.

**Способ 1. Расширение схемы Lotus Domino**

1. Создайте копию шаблона каталога Domino Directory {PUBNAMES.NTF}, выполнив [эти действия](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_CREATING_A_COPY_OF_THE_DEFAULT_PUBIC_ADDRESS_BOOK_TEMPLATE.html) (не следует изменять стандартный шаблон каталога IBM Lotus Domino Directory).
2. С помощью конструктора Domino Directory {CONTOSO.NTF} откройте копию только что созданного шаблона каталога Domino Designer и выполните следующие действия:
    - Щелкните Shared Elements (Общие элементы) и разверните подчиненные формы.
    - Дважды щелкните подчиненную форму ${имя\_объекта}InheritableSchema (где {имя\_объекта} — это имя класса структурного объекта по умолчанию, например Person).
    - Присвойте имя {MyPersonAtrribute} атрибуту, который хотите добавить в схему, и создайте соответствующее поле, выбрав в меню Create (Создать) пункт Field (Поле).
    - Задайте свойства для созданного поля, выбрав его тип, стиль, размер, шрифт и другие параметры в окне свойств поля.
    - Сохраните значение атрибута по умолчанию таким же, как имя этого атрибута (например, если имя атрибута — MyPersonAtrribute, оставьте для него такое же значение по умолчанию).
    - Сохраните подчиненную форму ${имя\_объекта}InheritableSchema с обновленными данными.
3. Замените шаблон каталога Domino {PUBNAMES.NTF} новым настроенным шаблоном {CONTOSO.NTF}, выполнив [эти действия](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_ABOUT_RULES_FOR_CUSTOMIZING_THE_PUBLIC_ADDRESS_BOOK.html).
4. Закройте администратор Domino и откройте консоль Domino, чтобы перезапустить службу LDAP и перезагрузить схему LDAP.
    - В консоли Domino в текстовое поле **Domino Command** (Команда Domino) вставьте команду перезапуска службы LDAP — [Restart Task LDAP](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_STARTING_AND_STOPPING_THE_LDAP_SERVER_OVER.html).
    - Чтобы перезагрузить схему LDAP, используйте команду Tell LDAP ReloadSchema.
5. Откройте администратор Domino и выберите вкладку People & Groups (Люди и группы) и убедитесь, что добавленный атрибут отражается в операции добавления объекта Person Domino.
6. Откройте Schema.nsf на вкладке Files (Файлы) и убедитесь, что добавленный атрибут отражается в классе объекта LDAP dominoPerson.

**Способ 2. Создание auxClass с настраиваемыми атрибутами и его связывание с классом объекта**

1. Создайте копию шаблона каталога Domino {PUBNAMES.NTF}, выполнив [эти действия](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_CREATING_A_COPY_OF_THE_DEFAULT_PUBIC_ADDRESS_BOOK_TEMPLATE.html) (не следует изменять стандартный шаблон каталога IBM Lotus Domino).
2. Откройте с помощью конструктора Domino копию только что созданного шаблона каталога Domino {CONTOSO.NTF}.
3. В области слева выберите Shared Code (Общий код), а затем — Subforms (Подчиненные формы).
4. Щелкните New Subform (Создать подчиненную форму).
5. Выполните следующие действия, чтобы указать свойства новой подчиненной формы.
    - Для открытой подчиненной формы щелкните пункты Design (Макет) и Subform Properties (Свойства подчиненной формы).
    - Рядом со свойством Name введите имя для вспомогательного класса объекта (например, TestSubform).
    - Оставьте установленным флажок свойства Include in Insert Subform... dialog (Включить в диалоговое окно добавления подчиненной формы).
    - Снимите флажок свойства Render pass through HTML in Notes (Обрабатывать сквозной код HTML в Notes).
    - Оставьте остальные свойства без изменений и закройте окно свойств подчиненной формы.
    - Сохраните и закройте новую подчиненную форму.
6. Выполните следующие действия, чтобы добавить поле для описания вспомогательного класса объекта.
    - Откройте только что созданную подчиненную форму.
    - Выберите Create (Создать) и Field (Поле).
    - Рядом с пунктом Name (Имя) на вкладке Basics (Основная информация) диалогового окна Field (Поле) введите любое имя, например {MyPersonTestAttribute}.
    - Задайте свойства для созданного поля, выбрав его тип, стиль, размер, шрифт и другие параметры.
    - Сохраните для атрибута значение по умолчанию таким же, как имя этого атрибута (например, если имя атрибута — MyPersonAtrribute, оставьте для атрибута такое же значение по умолчанию).
    - Сохраните подчиненную форму с обновленными значениями и выполните следующие действия.
        - В области слева выберите Shared Code (Общий код), а затем — Subforms (Подчиненные формы).
        - Щелкните новую подчиненную форму и выберите Design (Макет) и Design Properties (Свойства макета).
        - Щелкните третью слева вкладку и выберите **Propagate this prohibition of design change** (Распространить этот запрет на изменение макета).
7. Откройте подчиненную форму ${имя\_объекта}ExtensibleSchema (где {имя\_объекта} — это имя класса структурного объекта по умолчанию, например Person).
8. Добавьте ресурс и выберите подчиненную форму (которую только что создали, например TestSubform), затем сохраните подчиненную форму ${имя\_объекта}ExtensibleSchema.
9. Замените шаблон каталога Domino {PUBNAMES.NTF} новым настроенным шаблоном {CONTOSO.NTF}, выполнив [эти действия](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_ABOUT_RULES_FOR_CUSTOMIZING_THE_PUBLIC_ADDRESS_BOOK.html).
10. Закройте администратор Domino и откройте консоль Domino, чтобы перезапустить службу LDAP и перезагрузить схему LDAP.
    - В консоли Domino в текстовое поле **Domino Command** (Команда Domino) вставьте команду перезапуска службы LDAP — [Restart Task LDAP](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.help.domino.admin85.doc%2FH_STARTING_AND_STOPPING_THE_LDAP_SERVER_OVER.html).
    - Чтобы перезагрузить схему LDAP, используйте команду Tell LDAP ReloadSchema.
11. Откройте администратор Domino и выберите вкладку People & Groups (Люди и группы) и убедитесь, что добавленный атрибут отражается в операции добавления объекта Person Domino (на вкладке Others (Другие)).
12. Откройте Schema.nsf на вкладке **Files** (Файлы) и убедитесь, что добавленный атрибут отражается в дополнительном классе объекта LDAP TestSubform.

**Способ 3. Добавление пользовательского атрибута в класс ExtensibleObject**

1. Откройте файл {Schema.nsf}, который расположен в корневом каталоге.
2. Выберите классы объектов LDAP в меню слева в разделе **All Schema Documents** (Все документы схемы), а затем нажмите кнопку **Add Object class** (Добавить класс объекта).
3. Укажите имя LDAP в форме {zzzExtensibleSchema} (где zzz — это имя по умолчанию класса структурного объекта, например Person) со ссылкой на объект, для которого вы хотите расширить схему. Например, чтобы расширить схему для класса объекта Person, укажите имя LDAP {PersonExtensibleSchema}.
4. Укажите имя класса главного объекта, для которого вы хотите расширить схему. Например, чтобы расширить схему для класса объекта Person, укажите имя главного объекта {dominoPerson}.
5. Укажите допустимый идентификатор объекта, соответствующий этому классу объекта.
6. Выберите требуемые расширенные и пользовательские атрибуты в полях Mandatory/Optional Attribute Types (Типы обязательных или необязательных атрибутов), которые вам нужны.
7. После добавления атрибутов в класс ExtensibleObjectClass нажмите кнопку **Save & Close** (Сохранить и закрыть).
8. Будет создан класс ExtensibleObjectClass с расширенными атрибутами для соответствующего класса объектов по умолчанию.

## Устранение неполадок

-	Сведения о том, как включить ведение журнала для устранения неполадок соединителя, см. в статье [Включение трассировки событий Windows для соединителей](http://go.microsoft.com/fwlink/?LinkId=335731).

<!---HONumber=AcomDC_0420_2016-->