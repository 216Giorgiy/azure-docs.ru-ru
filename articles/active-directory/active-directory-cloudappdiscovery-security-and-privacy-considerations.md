<properties 
	pageTitle="Вопросы безопасности и конфиденциальности Cloud App Discovery" 
	description="В этой статье рассматриваются вопросы безопасности и конфиденциальности Cloud App Discovery." 
	services="active-directory" 
	documentationCenter="" 
	authors="markusvi" 
	manager="swadhwa" 
	editor="lisatoft"/>

<tags 
	ms.service="active-directory" 
	ms.workload="identity" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="08/04/2015" 
	ms.author="markusvi"/>

# Вопросы безопасности и конфиденциальности Cloud App Discovery

Корпорация Майкрософт заботится о вашей конфиденциальности и безопасности ваших данных, выпуская программное обеспечение и службы, которые помогают вам управлять безопасностью своей организации. <br> Мы понимаем: когда вы доверяете свои данные сторонним организациям, это доверие должно подкрепляться инвестициями в надежные технологии безопасности и соответствующим опытом. Корпорация Майкрософт следует строгим нормативным требованиям и правилам безопасности — от надежных методов разработки программного обеспечения до эксплуатации служб. <br> Безопасность и защита данных — главный приоритет корпорации Майкрософт.

В этой статье описывается сбор, обработка и защита данных в агенте Cloud App Discovery службы Azure Active Directory.




##Обзор

Cloud App Discovery — это компонент Azure AD, размещенный в Microsoft Azure. <br> Агент Cloud App Discovery Endpoint Agent используется для сбора данных об обнаружении приложений от компьютеров, которыми управляет ИТ-подразделение. <br> Собранные данные безопасно отправляются по зашифрованному каналу в службу Cloud App Discovery Azure AD. <br> Затем данные Cloud App Discovery для организации отображаются на портале Azure.


<center>![How Cloud App Discovery Works](./media/active-directory-cloudappdiscovery-security-and-privacy-considerations/cad01.png)</center>


В следующих разделах рассматривается защита потока данных во время его перемещения из вашей организации в службу Cloud App Discovery и в конечном счете на портал Cloud App Discovery.



## Сбор данных из вашей организации

Чтобы использовать компонент Cloud App Discovery службы Azure Active Directory для получения представления о приложениях, используемых сотрудниками в организации, необходимо сначала развернуть агент Cloud App Discovery Endpoint Agent службы Azure AD на компьютерах в организации.

Администраторы клиента Azure Active Directory (или их делегаты) могут загрузить пакет установки агентов с портала Azure. Агент можно установить вручную на каждый компьютер отдельно либо на несколько компьютеров в организации с помощью SCCM или групповой политики.

Дополнительную информацию о параметрах развертывания см. в статье [Руководство по развертыванию групповой политики Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30965.cloud-app-discovery-group-policy-deployment-guide.aspx).


### Данные, собираемые агентом

После подключения к веб-приложению агент собирает данные, приведенные в списке ниже. Собираются только данные тех приложений, обнаружение которых настроено администратором. <br> Можно изменить список облачных приложений, которые агент отслеживает. Для этого на [портале Azure](https://portal.azure.com), в колонке "Cloud App Discovery", перейдите к разделу **Параметры** -> **Сбор данных** -> **Список приложений для сбора данных**.


> [AZURE.NOTE]Дополнительную информацию см. в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).

**Категория данных**: данные о пользователе<br> **Описание**: <br> имя пользователя Windows для процесса, который отправил запрос конечному веб-приложению (например, ДОМЕН\\имя пользователя), и идентификатор безопасности Windows (SID) пользователя.


**Категория данных**: обработка информации <br>**Описание**: <br> имя процесса, который отправил запрос конечному веб-приложению (например, iexplore.exe)

**Категория данных**: сведения о компьютере <br> **Описание**: <br>NetBIOS-имя компьютера, на котором установлен агент.

**Категория данных**: данные о трафике приложения <br> **Описание**: <br>

Следующие сведения о подключении:

- исходный (локальный компьютер) и конечные IP-адреса и номера портов;

- общедоступный IP-адрес организации, с которого отправляется запрос;

- время запроса;

- объем отправленного и полученного трафика;

- версия IP (4 или 6);

- только для TLS-подключений: имя конечного узла из расширения указания имени сервера или сертификата сервера.

Следующие данные HTTP:

- метод (GET, POST и т. п.);

- протокол (HTTP/1.1 и т. п.);

- строка агента пользователя;

- имя узла;

- конечный URI (за исключением строки запроса);

- данные о типе содержимого;

- URL-адрес источника ссылки (за исключением строки запроса).



> [AZURE.NOTE]Указанные выше данные HTTP собираются для всех незашифрованных подключений. Для TLS-подключений эти данные собираются только при включении параметра «Внимательное отслеживание» на портале. По умолчанию этот параметр включен. Дополнительную информацию см. ниже и в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).



### Как работает агент

Установка агента состоит из двух компонентов:

- компонент пользовательского режима;

- компонент драйвера режима ядра (драйвер платформы фильтрации Windows).



При первой установке на компьютер агент сохраняет его доверенный сертификат, который затем используется для безопасного подключения к службе Cloud App Discovery. <br> Через это безопасное подключение агент периодически получает конфигурацию политики из службы Cloud App Discovery. <br> Эта политика содержит сведения об облачных приложениях, которые требуется отслеживать, а также указывает, помимо прочего, должно ли быть включено автоматическое обновление.

По мере отправки и получения веб-трафика из браузера Chrome или Internet Explorer на компьютере агент Cloud App Discovery анализирует трафик и извлекает соответствующие метаданные (см. таблицу выше). <br> Каждую минуту агент отправляет собранные метаданные в службу Cloud App Discovery по зашифрованному каналу.

Компонент драйвера перехватывает зашифрованный трафик и вставляется в зашифрованный поток. Для этого на компьютере создается самозаверяющий корневой сертификат, чтобы клиентское приложение доверяло агенту Cloud App Discovery. Самозаверяющий корневой сертификат помечается как неэкспортируемый, и его списком ACL управляют администраторы. Он никогда не покидает компьютер, на котором был создан.


### Соблюдение конфиденциальности пользователей

Наша цель — предоставить администраторам средства, которые помогут установить баланс между подробным рассмотрением использования приложений и конфиденциальностью пользователей на уровне, требуемом для их организации. Для этого на странице параметров портала имеются следующие средства:

- **Сбор данных**. Администраторы могут указывать приложения или категории приложений, для которых требуется обнаружение данных.

- **Внимательное отслеживание**. Администраторы могут указывать, следует ли агенту собирать HTTP-трафик для SSL- или TLS-подключений ("**внимательное отслеживание"**). Дополнительные сведения об этом см. в следующем разделе.

- **Параметры согласия**. Администраторы могут указать, следует ли уведомлять пользователей о сборе данных агентом, а также следует ли получать от пользователя разрешение перед тем, как агент приступит к сбору пользовательских данных.

Агент Cloud App Discovery Endpoint Agent собирает только сведения, описанные в таблице выше.



> [AZURE.NOTE]Дополнительную информацию см. в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).

### Перехват данных из зашифрованного соединения
Как упоминалось ранее, администраторы могут настроить агент для отслеживания данных из зашифрованного соединения ("внимательное отслеживание"). В настоящее время TLS ([Transport Layer Security](https://msdn.microsoft.com/library/windows/desktop/aa380516%28v=vs.85%29.aspx)) является одним из наиболее распространенных протоколов в Интернете. Благодаря шифрованию обмена данными с помощью TLS клиент может создать защищенный канал конфиденциальной связи с веб-сервером. С помощью протокола TLS можно обеспечить необходимую защиту для передачи учетных данных для проверки подлинности и предотвратить раскрытие конфиденциальной информации.

Поскольку с помощью TLS можно организовать полностью защищенный и зашифрованный канал, обеспечивающий безопасность и конфиденциальность передаваемых данных, этот протокол зачастую используют во вредоносных или злонамеренных целях. Поэтому протокол HTTPS фактически называют "универсальный протокол для обхода брандмауэра". Корнем проблемы является то, что большинство брандмауэров не способны проверять подключения TLS, так как на уровне приложений данные шифруются с помощью протокола SSL. Зная это, злоумышленники часто используют TLS для доставки пользователю вредоносных данных, будучи уверенными, что даже самые интеллектуальные брандмауэры на уровне приложений полностью слепо доверяют TLS и их задача сводится к простой ретрансляции подключения TLS между узлами. Часто конечные пользователи используют TLS для обхода элементов управления, применяемые корпоративными брандмауэрами и прокси-серверами, используя этот протокол для подключения к общедоступным прокси-серверам и для туннелирования протоколов, отличных от TLS, через брандмауэр, которые могут быть заблокированы политикой.

Внимательное отслеживание позволяет агенту Cloud App Discovery выступать в качестве доверенного посредника. При выполнении запроса на доступ к защищенному ресурсу HTTPS агент устанавливает новое соединение с сервером назначения и получает его SSL-сертификат. Затем агент Cloud App Discovery Endpoint Agent копирует данные из сертификата и создает свой собственный сертификат, используя эти сведения, и предоставляет его клиенту. Так как клиент доверяет корневому сертификату агента Cloud App Discovery Endpoint Agent, процесс по большей части прозрачен для конечного пользователя.


### Известные проблемы и недостатки
Существует несколько ситуаций, когда перехват TLS может повлиять на взаимодействие с пользователем: – Сертификаты высокой надежности (EV) окрашивают адресную строку веб-браузера в зеленый цвет, что служит визуальным подтверждения того, что посещаемый веб-сайт является надежным. При отслеживании TLS невозможно создать копию EV в сертификате, выдаваемом клиенту, поэтому веб-сайты, которые используют сертификаты высокой надежности, будут нормально работать, однако адресная строка не будет окрашена в зеленый цвет. – Привязка открытого ключа (привязка сертификата) предназначена для защиты пользователей от атак "злоумышленник в середине" и незаконных центров сертификации. Если корневой сертификат для привязанного сайта не соответствуют ни одному из сертификатов из хорошо известных ЦС, браузер отклоняет подключение и выдает сообщение об ошибке. Поскольку перехват TLS, фактически, является атакой "злоумышленник в середине", установить такие соединения не удастся.

Чтобы уменьшить риск возникновения таких проблем, мы прилагаем все возможные усилия для отслеживания приложений, о которых известно, что в них используется расширенная проверка или привязка открытого ключа, и предотвращения перехвата их зашифрованного соединения. Вы по-прежнему будете получать отчеты об использовании этих приложений и объеме данных, однако поскольку они не перехватываются, дополнительные сведения о том, как они использовались, предоставляться не будут.

Благодаря отслеживанию TLS агент Cloud App Discovery Endpoint Agent может расшифровывать и проверять зашифрованные соединения TLS, упростив тем самым работу для службы и обеспечив предоставление подробных сведений об использовании зашифрованных облачных приложений.


### Предупреждение
Прежде чем включить внимательное отслеживание, настоятельно рекомендуется согласовать свои намерения с юридическим отделом и отделом кадров и получить от них соответствующие разрешения. Проверка закрытого зашифрованное соединения пользователя по объективным причинам может быть конфиденциальной. Перед проведением проверок TLS убедитесь в том, что ваши корпоративные политики обеспечения безопасности и допустимого использования обновлены с учетом сведений о том, что зашифрованные соединения подлежат проверке. При настройке Cloud App Discovery для отслеживания сайтов, которые считаются конфиденциальными (таких как банковские и медицинские сайты), может также потребоваться организовать соответствующее уведомление пользователей и исключить такие сайты из проверок.


## Отправка данных в службу Cloud App Discovery

Собранные агентом метаданные кэшируются на компьютере в течение одной минуты или пока размер кэшированных данных не достигнет 5 МБ. Затем они сжимаются и отправляются через безопасное подключение в службу Cloud App Discovery.

Если по какой-либо причине агенту не удается связаться со службой Cloud App Discovery, собранные метаданные хранятся в локальном кэше файлов, доступ к которому имеют только привилегированные пользователи компьютера (например, группа «Администраторы»). <br> Агент автоматически повторяет попытки отправить кэшированные метаданные, пока они не будут успешно получены службой Cloud App Discovery.



## Получение данных на стороне службы

Агенты проходят проверку подлинности в службе Cloud App Discovery с помощью клиентского сертификата проверки подлинности для определенного компьютера, который упоминался выше, и отправляют данные по зашифрованному каналу. <br> Конвейер аналитики службы Cloud App Discovery обрабатывает метаданные для каждого клиента отдельно, логически разделяя их на всех этапах конвейера аналитики. Проанализированные метаданные используются для создания различных отчетов на портале.

Как необработанные, так и проанализированные метаданные хранятся в течение 180 дней. Кроме того, клиенты могут перенаправлять проанализированные метаданные в учетную запись хранилища BLOB-объектов Azure по своему выбору. Это полезно для последующего автономного анализа метаданных, а также для более длительного хранения данных.

## Доступ к данным через портал Azure

Для безопасности собранных данных только глобальные администраторы клиента имеют по умолчанию доступ к компоненту Cloud App Discovery на портале Azure. <br> Тем не менее администраторы могут делегировать доступ другим пользователям или группам.



> [AZURE.NOTE]Дополнительную информацию см. в статье [Начало работы с Cloud App Discovery](http://social.technet.microsoft.com/wiki/contents/articles/30962.getting-started-with-cloud-app-discovery.aspx).



Для доступа к данным на портале пользователи должны иметь лицензию Azure AD Premium.



**Дополнительные ресурсы**


* [Как обнаруживать несанкционированные облачные приложения, которые используются в моей организации](active-directory-cloudappdiscovery-whatis.md)

<!---HONumber=August15_HO6-->