---
title: Настройка сопоставлений атрибутов в Azure AD | Документация Майкрософт
description: Узнайте, что такое сопоставление атрибутов для приложений SaaS в Azure Active Directory и как настроить его в соответствии с потребностями вашего бизнеса.
services: active-directory
documentationcenter: ''
author: barbkess
manager: daveba
editor: ''
ms.service: active-directory
ms.component: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 09/09/2018
ms.author: barbkess
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: ead99afaf0399c060424d310d8f4011b2a50aad2
ms.sourcegitcommit: cf88cf2cbe94293b0542714a98833be001471c08
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54473730"
---
# <a name="customizing-user-provisioning-attribute-mappings-for-saas-applications-in-azure-active-directory"></a>Настройка сопоставлений атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory
Microsoft Azure AD обеспечивает поддержку для подготовки пользователей для сторонних приложений SaaS, например Salesforce, Google Apps и др. Если включена подготовка пользователей для сторонних приложений SaaS, портал Azure определяет значения их атрибутов в форме сопоставления атрибутов.

Существует предварительно настроенный набор атрибутов и сопоставлений атрибутов между объектами пользователей Azure AD и каждого приложения SaaS. Некоторые приложения управляют другими типами объектов в дополнение к пользователям, такими как группы. <br> 
 Сопоставление атрибутов по умолчанию можно настроить в соответствии с потребностями вашего бизнеса. Это означает, что можно изменить или удалить существующие сопоставления атрибутов или создать новые.
 
## <a name="editing-user-attribute-mappings"></a>Изменение сопоставлений атрибутов пользователя

Чтобы открыть эту функцию на портале Azure AD, щелкните конфигурацию **Сопоставления** в разделе **Подготовка**, который находится в подразделе **Управление** раздела **Корпоративное приложение**.


![Salesforce](./media/customize-application-attributes/21.png) 

Если щелкнуть конфигурацию **Сопоставления**, откроется соответствующий экран **Сопоставление атрибутов**. Существуют сопоставления атрибутов, которые необходимы для правильной работы приложения SaaS. Для требуемых атрибутов функция **Удалить** недоступна.


![Salesforce](./media/customize-application-attributes/22.png)

В приведенном выше примере вы видите, что атрибут **Username** управляемого объекта в Salesforce заполняется значением **userPrincipalName** связанного объекта Azure Active Directory.

Щелкнув сопоставление, вы можете настроить **сопоставления атрибутов**. При этом откроется экран **Изменить атрибут**.

![Salesforce](./media/customize-application-attributes/23.png)


### <a name="understanding-attribute-mapping-types"></a>Основные сведения о типах сопоставления атрибутов
С помощью сопоставлений атрибутов можно управлять заполнением атрибутов в сторонних приложениях SaaS. Поддерживаются четыре типа сопоставлений:

* **Прямое** — целевой атрибут заполняется значением атрибута связанного объекта в Azure AD.
* **Постоянное** — целевой атрибут заполняется определенной строкой, указанной вами.
* **Выражение** — целевой атрибут заполняется на основе результата выражения, похожего на сценарий. 
  Дополнительные сведения см. в статье [Запись выражений для сопоставления атрибутов в Azure Active Directory](functions-for-customizing-application-data.md).
* **Нет** — целевой атрибут остается без изменений. Тем не менее, если целевой атрибут пуст, он заполняется указанным вами значением по умолчанию.

Кроме этих четырех основных типов, в сопоставлениях настраиваемых атрибутов также поддерживается назначение значений **по умолчанию**. Назначение значений по умолчанию гарантирует, что целевой атрибут заполняется значением, если нет значения ни в Azure AD, ни в целевом объекте. В наиболее распространенной конфигурации это поле остается пустым.


### <a name="understanding-attribute-mapping-properties"></a>Основные сведения о свойствах сопоставления атрибутов

В предыдущем разделе мы уже рассмотрели свойство типа для сопоставления атрибутов.
Наряду с этим свойством сопоставления атрибутов также поддерживают следующие атрибуты:

- **Атрибут источника** — атрибут пользователя из исходной системы (например Azure Active Directory).
- **Целевой атрибут** — атрибут пользователя в целевой системе (например ServiceNow).
- **Сопоставление объектов с помощью этого атрибута** — должно ли это сопоставление использоваться для уникальной идентификации пользователей между исходной и целевой системами. Этот параметр обычно задается в атрибуте userPrincipalName или mail в Azure AD, который обычно сопоставляется с полем имени пользователя в целевом приложении.
- **Приоритет сопоставления** — возможность указания нескольких атрибутов сопоставления. При указании нескольких атрибутов сопоставления они вычисляются в порядке, заданном в этом поле. Как только соответствие найдено, дальнейшие атрибуты сопоставления не вычисляются.
- **Применить это сопоставление**
    - **Всегда** — применить это сопоставление как при создании, так и при обновлении пользователей
    - **Только при создании** — применить это сопоставление только при создании пользователей


## <a name="editing-group-attribute-mappings"></a>Изменение сопоставлений атрибутов группы

Определенный ряд приложений, таких как ServiceNow, Google Apps и Box, поддерживает возможность подготовки объектов группы в дополнение к объектам пользователя. Объекты группы могут содержать свойства группы, такие как отображаемые имена и псевдонимы электронной почты (в дополнение к участникам группы).

![ServiceNow](./media/customize-application-attributes/24.png)

При необходимости можно включить или отключить подготовку группы, выбрав сопоставление группы в разделе **Сопоставления** и задав для параметра **Включено** нужное значение на экране **Сопоставление атрибутов**.

Атрибуты, подготовленные как часть объектов группы, можно настроить так же, как объекты пользователя, описанные ранее. 

>[!TIP]
>Подготовка объектов группы (свойства и участники) отличается от [присвоения групп](assign-user-or-group-access-portal.md) приложению. Вы можете назначить группу приложению, однако подготовить можно только те объекты пользователя, которые содержатся в группе. Для использования групп в назначениях подготовка объектов для всей группы не требуется.


## <a name="editing-the-list-of-supported-attributes"></a>Изменение списка поддерживаемых атрибутов

Атрибуты пользователя, поддерживаемые для заданного приложения, настроены предварительно. Большинство API-интерфейсов приложений для управления пользователями не поддерживают обнаружение схемы, поэтому служба подготовки Azure AD не может динамически создавать список поддерживаемых атрибутов, осуществляя вызовы к приложению. 

Однако некоторые приложения поддерживают настраиваемые атрибуты. Чтобы служба подготовки Azure AD могла считывать и записывать настраиваемые атрибуты, их определения необходимо указать на портале Azure, установив флажок **Показать расширенные параметры** в нижней части экрана **Сопоставление атрибутов**.

Ниже приведены приложения и системы, поддерживающие настройку списка атрибутов.

* Salesforce
* ServiceNow
* Workday
* Azure Active Directory (поддерживаются [атрибуты по умолчанию API Graph Azure AD](https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity) и расширения пользовательского каталога)
* Приложения, поддерживающие [SCIM 2.0](https://tools.ietf.org/html/rfc7643), где необходимо добавить атрибуты, определенные в [основной схеме](https://tools.ietf.org/html/rfc7643)

>[!NOTE]
>Изменение списка поддерживаемых атрибутов рекомендуется только для администраторов, которые настроили схему своих приложений и систем и имеют непосредственные знания об определении их атрибутов. Иногда для этого требуются навыки работы с API-интерфейсами и средствами разработчиков, предоставляемыми приложением или системой. 

![Редактор](./media/customize-application-attributes/25.png) 

При изменении списка поддерживаемых атрибутов предоставляются следующие свойства:

* **Имя** — системное имя атрибута, определенное в схеме целевого объекта. 
* **Тип** — тип хранящихся в атрибуте данных, определенный в схеме целевого объекта. Может применяться один из перечисленных ниже типов.
   * *Binary* — атрибут содержит двоичные данные.
   * *Boolean* — атрибут содержит значение True или False.
   * *DateTime* — атрибут содержит строку даты.
   * *Integer* — атрибут содержит целое число.
   * *Reference* — атрибут содержит идентификатор, который ссылается на значение, хранящееся в другой таблице в целевом приложении.
   * *String* — атрибут содержит текстовую строку. 
* **Первичный ключ?** — указывает, определен ли атрибут как поле первичного ключа в схеме целевого объекта.
* **Обязательный?** — указывает, является ли атрибут обязательным для заполнения в целевом приложении или системе.
* **С несколькими значениями?** — указывает, поддерживает ли атрибут несколько значений.
* **С учетом регистра?** — указывает, учитывается ли регистр при оценке значений атрибутов.
* **Выражение API** — не используется, если это иное не указано в документации по конкретному соединителю для подготовки (например, Workday).
* **Атрибут объекта ссылки** — если применяется атрибут ссылочного типа, то в этом меню можно выбрать таблицу и атрибут в целевом приложении, которое содержит значение, связанное с атрибутом. Например, если у вас есть атрибут с именем Department, сохраненное значение которого указывает на объект в отдельной таблице Departments, необходимо выбрать Departments.Name. Обратите внимание, что поля ссылочных таблиц и первичного идентификатора, поддерживаемые для данного приложения, предварительно настроены и не могут быть изменены с помощью портала Azure (на данный момент), но их можно изменить с помощью [API Graph](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/synchronization-configure-with-custom-target-attributes).

Чтобы добавить новый атрибут, перейдите в конец списка поддерживаемых атрибутов, заполните поля выше, использовав предоставленные входные данные, и выберите **Добавить атрибут**. После завершения добавления атрибутов нажмите кнопку **Сохранить**. Затем необходимо перезагрузить вкладку **Подготовка**, чтобы новые атрибуты стали доступными в редакторе сопоставлений атрибутов.

## <a name="restoring-the-default-attributes-and-attribute-mappings"></a>Восстановление атрибутов по умолчанию и сопоставления атрибутов

Если вам нужно начать работу сначала и сбросить имеющиеся сопоставления к состоянию по умолчанию, установите флажок **Восстановить сопоставления по умолчанию** и сохраните конфигурацию. Таким образом все сопоставления задаются, как если бы приложение было только что добавлено к клиенту Azure AD из коллекции приложений. 

Если выбрать этот параметр, это приведет к повторной синхронизации всех пользователей во время работы службы подготовки. 

>[!IMPORTANT]
>Перед вызовом этого параметра настоятельно рекомендуется задать для **Состояние подготовки** значение **Откл.**


## <a name="what-you-should-know"></a>Необходимая информация

* Процесс синхронизации в Microsoft Azure AD реализован очень эффективно. Во время цикла синхронизации в инициализированной среде обрабатываются только объекты, требующие обновления. 

* Обновление сопоставлений атрибутов влияет на производительность цикла синхронизации. Чтобы обновить конфигурацию сопоставления атрибутов, необходимо повторно оценить все управляемые объекты. 

* Рекомендуется сократить количество последовательных изменений сопоставлений атрибутов.


## <a name="next-steps"></a>Дополнительная информация

* [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](user-provisioning.md)
* [Запись выражений для сопоставления атрибутов](functions-for-customizing-application-data.md)
* [Фильтры области для подготовки пользователей](define-conditional-rules-for-provisioning-user-accounts.md)
* [Автоматическая подготовка пользователей и групп из Azure Active Directory в приложениях с использованием SCIM](use-scim-to-provision-users-and-groups.md)
* [Список учебников по интеграции приложений SaaS](../saas-apps/tutorial-list.md)


