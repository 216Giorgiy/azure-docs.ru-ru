<properties
	pageTitle="Модель приложений 2.0 | Microsoft Azure"
	description="Типы приложений и сценарии, поддерживаемые в общедоступной предварительной версии модели приложений Azure AD 2.0."
	services="active-directory"
	documentationCenter=""
	authors="dstrockis"
	manager="mbaldwin"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="08/12/2015"
	ms.author="dastrock"/>

# Предварительная версия модели приложений 2.0: типы приложений
Модель приложений версии 2.0 поддерживает проверку подлинности для различных архитектур современных приложений, которые основаны на стандартных отраслевых протоколах [OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow) и [OpenID Connect](active-directory-v2-protocols.md#openid-connect-sign-in-flow). В этом документе кратко описаны типы приложений, которые можно создавать независимо от используемого языка или платформы. Он поможет вам изучить базовые сценарии, прежде чем [перейти непосредственно к коду](active-directory-appmodel-v2-overview.md#getting-started).

> [AZURE.NOTE]Эти сведения относятся к общедоступной предварительной версии модели приложений 2.0. Инструкции по интеграции с общедоступной службой Azure AD см. в статье [Руководство разработчика Azure Active Directory](active-directory-developers-guide.md).

## Основы
Каждое приложение, использующее модель приложений 2.0, необходимо зарегистрировать на сайте [apps.dev.microsoft.com](https://apps.dev.microsoft.com). В процессе регистрации для приложения будет собрано и назначено несколько значений:

- **Идентификатор приложения**, определяющий конкретное приложение.
- **Универсальный код ресурса (URI) перенаправления**, который можно использовать для направления ответов к приложению.
- Несколько других зависящих от сценария значений. Сведения о том, как можно [зарегистрировать приложение](active-directory-v2-app-registration.md).

После регистрации приложение связывается с Azure AD, отправляя запросы к конечной точке версии 2.0:

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize
https://login.microsoftonline.com/common/oauth2/v2.0/token
```

Каждое взаимодействие приложения с конечной точкой версии 2.0 будет использовать аналогичный высокоуровневый шаблон.

1. Приложение направляет пользователя к конечной точке версии 2.0 для входа в систему.
2. Пользователь проходит проверку подлинности, вводя имя пользователя и пароль, или иным способом.
3. Пользователь разрешает приложению действовать от своего имени, предоставляя разрешения запросам приложения.
4. Приложение получает определенный токен безопасности от конечной точки версии 2.0.
5. Приложение использует токен безопасности для доступа к защищенной информации или ресурсу.
6. Сервер ресурсов проверяет токен безопасности для подтверждения того, что доступ может быть предоставлен.
7. Приложение периодически обновляет токен безопасности.

<!-- TODO: Need a page for libraries to link to -->
Каждый из этих семи шагов будет немного отличаться в зависимости от типа приложения, которое вы создаете. Мы предоставляем библиотеки с открытым исходным кодом, которые освободят вас от необходимости вникать в подробности. Вы можете узнать больше о [разрешениях, согласии и областях](active-directory-v2-scopes.md) или продолжить чтение, чтобы просмотреть примеры.

## Веб-приложения
В случае веб-приложений (.NET, PHP, Java, Ruby, Python, Node и т. д.), доступных через браузер, модель приложений версии 2.0 поддерживает вход пользователей с помощью [OpenID Connect](active-directory-v2-protocols.md#openid-connect-sign-in-flow). В OpenID Connect веб-приложение получает `id_token`, токен безопасности, который проверяет удостоверение пользователя и предоставляет сведения о пользователе в форме утверждений:

```
// Partial raw id_token
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImtyaU1QZG1Cd...

// Partial content of a decoded id_token
{
	"name": "John Smith",
	"email": "john.smith@gmail.com",
	"oid": "d9674823-dffc-4e3f-a6eb-62fe4bd48a58"
	...
}
```

Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам версии 2.0](active-directory-v2-tokens.md).

В приложениях веб-сервера поток проверки подлинности для входа состоит из следующих базовых этапов:

![Изображение веб-приложения Swimlanes](../media/active-directory-v2-flows/convergence_scenarios_webapp.png)

Проверки маркера идентификатора с помощью открытого ключа подписи, полученного от конечной точки версии 2.0, достаточно для проверки удостоверения пользователя, а также задания файла cookie сеанса, который может использоваться для идентификации пользователя в последующих запросах страницы.

Чтобы увидеть этот сценарий в действии, изучите один из примеров кода входа веб-приложения из раздела [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).

Помимо простого входа в систему, приложению веб-сервера может потребоваться доступ к некоторым другим веб-службам, например интерфейсу API REST. В этом случае приложение веб-сервера может быть задействовано в объединенном потоке OpenID Connect и OAuth 2.0 с использованием [потока кода авторизации OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow). Этот сценарий описан далее, в разделах о [веб-API](#web-apis) и [начале работы с веб-API и веб-приложениями](active-directory-v2-devquickstarts-webapp-webapi-dotnet.md).

## Веб-API
Модель приложений версии 2.0 также можно использовать для защиты веб-служб, таких как веб-API с поддержкой REST. Интерфейсы веб-API вместо маркеров идентификатора и файлов cookie сеанса используют маркеры доступа OAuth 2.0 для защиты данных и проверки подлинности входящих запросов. Объект, вызывающий веб-API, добавляет маркер доступа в начале заголовка авторизации HTTP-запроса:

```
GET /api/items HTTP/1.1
Host: www.mywebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6...
Accept: application/json
...
```

Веб-API может использовать маркер доступа для проверки удостоверения объекта, вызывающего API, и получения сведений о нем из утверждений, которые закодированы в маркере доступа. Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам версии 2.0](active-directory-v2-tokens.md).

Веб-API может дать пользователям возможность использовать определенные функции и данные или отказаться от них, предоставляя разрешения, которые также называют [областями](active-directory-v2-scopes.md). Чтобы вызывающее приложение получило разрешение для области, пользователь должен дать согласие на это. Конечная точка версии 2.0 запросит разрешения у пользователя и запишет их во все маркеры доступа, получаемые веб-API. Все, что нужно выполнять веб-API — проверять маркеры доступа, принимаемых при каждом вызове, и выполнять соответствующие проверки авторизации.

Веб-API может получать маркеры доступа от всех типов приложений, включая приложения веб-сервера, классические и мобильные приложения, одностраничные приложения, серверные управляющие программы и даже другие веб-API. В качестве примера рассмотрим полный поток приложения веб-сервера, вызывающего веб-API.

![Изображение веб-API веб-приложения Swimlanes](../media/active-directory-v2-flows/convergence_scenarios_webapp_webapi.png)

Дополнительные сведения о кодах авторизации, маркерах обновления, а также подробные инструкции о получении маркеров доступа см. в описании [протокола OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow).

Чтобы узнать, как защитить веб-API с помощью модели приложений версии 2.0 и маркеров доступа OAuth 2.0, изучите примеры кода веб-API в примерах кода в разделе [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).


## Мобильные и собственные приложения
Приложениям, установленным на устройстве, например мобильным и классическим приложениям, часто требуется доступ к внутренним службам или веб-API, которые хранят данные и выполняют различные функции от имени пользователя. В этих приложениях можно реализовать процесс входа и авторизации в серверных службах с помощью модели версии 2.0 и [потока кода авторизации OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow).

В этом потоке приложение получает код авторизации от конечной точки версии 2.0 при входе пользователя. Такой код представляет собой разрешение приложения на вызов серверных служб от имени выполнившего вход пользователя. Приложение может передать код авторизации в фоновом режиме, чтобы получить маркер доступа OAuth 2.0 и маркер обновления. Приложение может использовать маркер доступа для проверки подлинности в веб-API в HTTP-запросах и использовать маркер обновления, чтобы получить новые маркеры доступа после истечения срока действия старых маркеров.

![Изображение собственного приложения Swimlanes](../media/active-directory-v2-flows/convergence_scenarios_native.png)

## Текущие ограничения предварительной версии
Эти типы приложений в настоящее время не поддерживается предварительной версией модели приложений 2.0, но мы планируем добавить их поддержку после выхода общедоступной версии. Дополнительные ограничения и ограничения для общедоступной предварительной версии модели приложений 2.0 описаны в [этой статье](active-directory-v2-limitations.md).

### Одностраничные приложения (Javascript)
Многие современные приложения применяют одностраничный интерфейсный модуль, написанный в основном на Javascript и часто использующий платформы SPA, такие как AngularJS, Ember.js, Durandal и т. д. Общедоступная служба Azure AD поддерживает такие приложения с помощью [неявного потока OAuth 2.0](active-directory-v2-protocols.md#oauth2-implicit-flow), однако этот поток еще недоступен в модели приложений версии 2.0. В скором будущем его поддержка будет добавлена.

Если вы хотите получить SPA, работающий с моделью приложений версии 2.0, вы можете реализовать проверку подлинности с помощью [потока приложения веб-сервера](#web-apps), описанного выше. Но это не рекомендуемый подход, и документация для этого сценария будет ограничена. Если вы хотите ознакомиться со сценарием SPA, изучите [образец кода общедоступного Azure AD SPA](active-directory-devquickstarts-angular.md).

### Управляющие программы и серверные приложения
Приложениям, содержащим долговременные процессы или работающим без пользователя, также нужна возможность доступа к защищенным ресурсам, таким как веб-API. Такие приложения могут проверять подлинность и получать маркеры, используя удостоверение приложения (а не удостоверение делегированного пользователя) с помощью [потока учетных данных клиента OAuth 2.0](active-directory-v2-protocols.md#oauth2-client-credentials-grant-flow).

Этот поток в настоящее время не поддерживается моделью приложений версии 2.0, то есть приложения могут получить маркеры только после завершения интерактивного процесса входа пользователя. Поток клиентских учетных данных будет добавлен в ближайшем будущем. Если вы хотите увидеть поток клиентских учетных данных в общедоступной службе Azure AD, изучите [пример управляющей программы на GitHub](https://github.com/AzureADSamples/Daemon-DotNet).

### Связанные веб-API
Многие архитектуры включают в себя веб-API, которым требуется вызывать другой подчиненных веб-API. При этом оба интерфейса защищены моделью приложений версии 2.0. Этот сценарий характерен для собственных клиентов с внутренним веб-API, который в свою очередь вызывает службу Microsoft Online, например Office 365 или Graph API.

Сценарий связанных веб-API может поддерживаться с помощью разрешения OAuth 2.0 Jwt Bearer Credential или [потока On-Behalf-Of](active-directory-v2-protocols.md#oauth2-on-behalf-of-flow). Однако поток On-Behalf-Of еще не реализован в предварительной версии модели приложений 2.0. Чтобы увидеть его в общедоступной службе Azure AD, изучите [пример кода On-Behalf-Of на GitHub](https://github.com/AzureADSamples/WebAPI-OnBehalfOf-DotNet).

<!---HONumber=August15_HO7-->