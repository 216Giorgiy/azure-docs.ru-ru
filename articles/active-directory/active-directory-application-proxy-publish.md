<properties
	pageTitle="Публикация приложений с помощью прокси приложения Azure AD | Microsoft Azure"
	description="Описывается публикация локальных приложений с помощью прокси приложения Azure AD."
	services="active-directory"
	documentationCenter=""
	authors="kgremban"
	manager="stevenpo"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="01/06/2016"
	ms.author="kgremban"/>


# Публикация приложений с помощью прокси приложения Azure AD

> [AZURE.NOTE]Прокси приложения — это функция, которая доступна только после обновления до выпуска Premium или Basic службы Azure Active Directory. Дополнительные сведения см. в статье [Выпуски Azure Active Directory](active-directory-editions.md).

Включив прокси приложения Microsoft Azure Active Directory, вы сможете публиковать приложения, т. е. делать их доступными для пользователей за пределами частной сети.

В этой статье описаны действия, которые необходимо выполнить для публикации приложений, которые работают в локальной сети и к которым вы хотите разрешить безопасный удаленный доступ из внешней сети.

> [AZURE.NOTE]Чтобы убедиться, что соединитель работает правильно, первым приложением, которое вы публикуете, должен быть любой веб-сайт, доступный в частной сети. Так вы сможете убедиться, что он доступен пользователям из Интернета, прежде чем действительно опубликовать приложение.


## Публикация приложения с помощью мастера

1. Откройте любой браузер и зайдите на портал Azure.
2. На классическом портале Azure в области слева перейдите на вкладку **Active Directory**.
3. Выберите каталог, в котором включен прокси приложения и для которого требуется опубликовать приложение (например, Wingtip Toys).
4. Откройте вкладку **Приложения**, а затем нажмите кнопку **Добавить**, расположенную в нижней части экрана.

	![Добавление приложения](./media/active-directory-application-proxy-publish/aad_appproxy_selectdirectory.png)

5. В диалоговом окне **Что необходимо сделать?** щелкните **Опубликовать приложение для доступа извне сети**.

	![Новое приложение, которое будет доступно извне вашей сети](./media/active-directory-application-proxy-publish/aad_appproxy_addapp.png)

6. Следуйте указаниям на экране, чтобы предоставить следующие сведения о приложении:

| **Свойство** | **Дополнительные сведения** |
|---|---|
| Внешний URL-адрес | Это URL-адрес облачной службы, используемый для доступа к приложению извне частной сети. URL-адрес создается автоматически на основе указанного имени с суффиксом msappproxy.net. |
| Метод предварительной проверки подлинности | Задайте для приложения тип метода предварительной проверки подлинности: <br><br> а. Azure Active Directory. Когда пользователь пытается получить доступ к приложению, прокси приложения будет перенаправлять пользователя для входа в среду Azure AD, которая аутентифицирует его. Это гарантирует, что у пользователя есть необходимые разрешения для каталогов и приложения. <br><br> б. Транзит — предварительная проверка подлинности не выполняется. |
| Протокол внешнего URL-адреса | По умолчанию приложения публикуются с использованием протокола HTTPS. Служба будет автоматически перенаправлять пользователей, которые вводят URL-адрес с префиксом http. <br><br> Чтобы включить протокол HTTP для внутреннего приложения, сначала нужно отключить предварительную проверку подлинности (установить метод "транзит"). Тогда вы сможете изменить протокол внешнего URL-адреса с HTTPS на HTTP. Обратите внимание, что публикация приложений с помощью протокола HTTP может вызвать проблемы безопасности для приложения и пользователей. <br><br> Можно указать личный домен вместо используемого по умолчанию адреса с суффиксом msappproxy.net. Дополнительную информацию см. в статье [Работа с пользовательскими доменами](active-directory-application-proxy-custom-domains.md). |
| Внутренний URL-адрес | Это внутренний URL-адрес, используемый соединителем прокси приложения для внутреннего доступа к приложению. Это должен быть URL-адрес опубликованного приложения, который используется для доступа к приложению из частной сети. Это допустимый URL-адрес без пробелов и символов. <br><br> Для публикации можно выбрать только конкретный адрес на внутреннем сервере; при этом другие адреса сервера не публикуются. Это позволяет публиковать, например, разные сайты, расположенные на одном сервере SharePoint и имеющие разные имена и правила доступа. <br><br> Путь указывается в поле внутреннего URL-адреса и будет виден во внешнем URL-адресе. Внутренние и внешние пути должны быть одинаковыми. |

  ![Свойства приложения](./media/active-directory-application-proxy-publish/aad_appproxy_appproperties.png)

  Чтобы завершить работу мастера, установите флажок в нижней части экрана. Теперь приложение определено в Azure AD.


## Назначение пользователей и групп для приложения

1. Для приложений с предварительной аутентификацией необходимо назначить пользователей и группы, которые будут иметь доступ к приложению. Приложения, использующие транзитную проверку подлинности, доступны всем пользователям. Тем не менее, чтобы пользователь видел приложение в своем списке приложений, вы должны назначить это приложение пользователю.

2. После завершения работы мастера добавления приложения отображается страница быстрого запуска прокси приложения. Чтобы назначить пользователей, щелкните **Назначить пользователей**.

	![Снимок экрана быстрого запуска прокси приложения: назначение пользователей](./media/active-directory-application-proxy-publish/quickstart.png)

3. Выберите пользователей или группы, которым необходимо назначить это приложение, и щелкните **Назначить**.

> [AZURE.NOTE]Для приложений со встроенной проверкой подлинности Windows можно назначить только пользователей и группы, которые синхронизированы в локальной службе Active Directory. Для приложений, опубликованных с помощью прокси приложения Azure Active Directory, нельзя назначить пользователей, использующих для входа учетную запись Майкрософт, а также гостей. Убедитесь, что назначаемые пользователи входят в систему с помощью своих учетных данных, содержащихся в том же домене, что и публикуемое приложение.


## Расширенная конфигурация

1. На странице "Настройка" можно изменить параметры опубликованных приложений или настроить дополнительные функции, например, единый вход для локальных приложений.

	![Расширенная конфигурация](./media/active-directory-application-proxy-publish/advancedconfig.png)

2. Выберите приложение и щелкните **Настройка**. Доступны следующие параметры:

**Параметр** | **Дополнительные сведения**
---|---
Имя | Введите описательное имя приложения.
Внешний URL-адрес | Это URL-адрес облачной службы, используемый для доступа к приложению извне частной сети. URL-адрес создается автоматически на основе указанного имени с суффиксом msappproxy.net.
Метод предварительной проверки подлинности | Задайте для приложения тип метода предварительной проверки подлинности: <br><br> а. Azure Active Directory. Когда пользователь пытается получить доступ к приложению, прокси приложения будет перенаправлять пользователя для входа в среду Azure AD, которая аутентифицирует его. Это гарантирует, что у пользователя есть необходимые разрешения для каталогов и приложения. <br><br> б. Транзит — предварительная проверка подлинности не выполняется.
Протокол внешнего URL-адреса | По умолчанию приложения публикуются с использованием протокола HTTPS. Служба будет автоматически перенаправлять пользователей, которые вводят URL-адрес с префиксом http. <br><br> Чтобы включить протокол HTTP для внутреннего приложения, сначала нужно отключить предварительную проверку подлинности (установить метод "транзит"). Тогда вы сможете изменить протокол внешнего URL-адреса с HTTPS на HTTP. Обратите внимание, что публикация приложений с помощью протокола HTTP может вызвать проблемы безопасности для приложения и пользователей. <br><br> Можно указать личный домен вместо используемого по умолчанию адреса с суффиксом msappproxy.net. Дополнительную информацию см. в статье [Работа с пользовательскими доменами](active-directory-application-proxy-custom-domains.md).
Внутренний URL-адрес | Это внутренний URL-адрес, используемый соединителем прокси приложения для внутреннего доступа к приложению. Это должен быть URL-адрес опубликованного приложения, который используется для доступа к приложению из частной сети. Это допустимый URL-адрес без пробелов и символов. <br><br> Для публикации можно выбрать только конкретный адрес на внутреннем сервере; при этом другие адреса сервера не публикуются. Это позволяет публиковать, например, разные сайты, расположенные на одном сервере SharePoint и имеющие разные имена и правила доступа. <br><br> Путь указывается в поле внутреннего URL-адреса и будет виден во внешнем URL-адресе. Внутренние и внешние пути должны быть одинаковыми.
Перевод адресов в заголовках | Если приложение (например, некоторые конфигурации SharePoint) требует, чтобы заголовки host в HTTP запросах не преобразовывались, задайте значение **Нет**. Перевод адресов будет отключен и для запросов, и для ответов.
Метод внутренней проверки подлинности | Если вы используете прокси приложения для предварительной аутентификации, можно задать метод внутренней проверки подлинности. Это позволит пользователям использовать единый вход для этого приложения. <br><br>Выберите значение **Встроенная проверка подлинности Windows (IWA)**, если ваше приложение использует этот метод, и настройте ограниченное делегирование Kerberos (KCD), чтобы включить единый вход для этого приложения. Приложения, использующие IWA, следует настроить с использованием ограниченного делегирования Kerberos. В противном случае прокси приложения не сможет опубликовать эти приложения. <br><br> Выберите **Нет**, если ваше приложение не использует IWA. <br><br> Дополнительные сведения см. в статье [Единый вход с помощью прокси приложения](active-directory-application-proxy-sso-using-kcd.md).
Внутреннее имя субъекта-службы приложения | Это имя субъекта-службы (SPN) внутреннего приложения, настроенное в локальном прокси приложения. Имя субъекта-службы используется соединителем прокси приложения для получения токенов Kerberos для приложения, использующего ограниченное делегирование Kerberos (KCD). <br><br> Дополнительные сведения см. в статье [Включение единого входа](active-directory-application-proxy-sso-using-kcd.md).

После публикации приложений с помощью прокси приложения Azure Active Directory они отображаются в списке приложений в Azure AD, и вы можете управлять ими.

Если отключить службы прокси приложения после публикации приложений, приложения не будут удалены, но станут недоступны извне частной сети.

Чтобы просмотреть приложение и убедиться, что оно доступно, дважды щелкните имя приложения. Если служба прокси приложения отключена и приложение недоступно, в верхней части экрана появится предупреждающее сообщение.

Чтобы удалить приложение, выберите его из списка и щелкните **Удалить**.

## См. также
У прокси приложения гораздо больше возможностей:

- [Включение прокси приложения](active-directory-application-proxy-enable.md)
- [Публикация приложений с помощью доменного имени](active-directory-application-proxy-custom-domains.md)
- [Включение единого входа](active-directory-application-proxy-sso-using-kcd.md)
- [Включение условного доступа](active-directory-application-proxy-conditional-access.md)
- [Работа с приложениями, поддерживающими утверждения](active-directory-application-proxy-claims-aware-apps.md)
- [Устранение неполадок с прокси приложения](active-directory-application-proxy-troubleshoot.md)

## Узнайте больше о прокси приложения
- [Просмотрите нашу справку в Интернете](active-directory-application-proxy-enable.md)
- [Ознакомьтесь с блогом о прокси приложения](http://blogs.technet.com/b/applicationproxyblog/)
- [Смотрите наши видео на Channel 9!](http://channel9.msdn.com/events/Ignite/2015/BRK3864)

## Дополнительные ресурсы

* [Об ограниченном делегировании Kerberos](http://technet.microsoft.com/library/cc995228.aspx)

<!---HONumber=AcomDC_0114_2016-->