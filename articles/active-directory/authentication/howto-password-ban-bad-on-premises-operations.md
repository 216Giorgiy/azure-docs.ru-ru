---
title: Операции и отчеты предварительной версии службы защиты паролем Azure AD
description: Операции и отчеты предварительной версии службы защиты паролем Azure AD после развертывания.
services: active-directory
ms.service: active-directory
ms.component: authentication
ms.topic: article
ms.date: 11/02/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: jsimmons
ms.openlocfilehash: c19275f096191a2d55c939cbc9b76e7ffc6e1b8b
ms.sourcegitcommit: 9999fe6e2400cf734f79e2edd6f96a8adf118d92
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2019
ms.locfileid: "54424444"
---
# <a name="preview-azure-ad-password-protection-operational-procedures"></a>Предварительный просмотр: операционные процедуры службы защиты паролем Azure AD

|     |
| --- |
| Защита паролем Azure AD — это общедоступная предварительная версия функции Azure Active Directory. См. дополнительные сведения о [дополнительных условиях использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).|
|     |

После завершения локальной [установки службы защиты паролем Azure AD](howto-password-ban-bad-on-premises-deploy.md) необходимо настроить несколько параметров на портале Azure.

## <a name="configure-the-custom-banned-password-list"></a>Настройка пользовательского списка заблокированных паролей

Следуйте указаниям в статье [Настройка пользовательского списка заблокированных паролей](howto-password-ban-bad-configure.md), чтобы настроить список заблокированных паролей для своей организации.

## <a name="enable-password-protection"></a>Включение защиты паролем

1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к **Azure Active Directory**, **Способы проверки подлинности**, а затем выберите **Защита паролем (предварительная версия)**.
1. Для параметра **Enable password protection on Windows Server Active Directory** (Включить защиту паролем в Windows Server Active Directory) выберите значение **Да**.
1. Как упоминалось в [руководстве по развертыванию](howto-password-ban-bad-on-premises-deploy.md#deployment-strategy), рекомендуется изначально выбрать **режим** **Аудит**.
   * Ознакомившись с возможностями этого компонента, вы сможете переключиться на **режим** **Применено**.
1. Нажмите кнопку **Сохранить**

![Включение компонентов защиты паролем Azure AD на портале Azure](./media/howto-password-ban-bad-on-premises-operations/authentication-methods-password-protection-on-prem.png)

## <a name="audit-mode"></a>Режим аудита

Режим аудита предназначен для запуска программного обеспечения в режиме "что, если". Каждая служба агента контроллера домена оценивает введенный пароль в соответствии с текущей активной политикой. Если в текущей политики настроен режим аудита, "неудачные" пароли приводят к записи сообщений в журнал событий, но принимаются. Это единственное различие между режимами аудита и принудительного применения. Все остальные операции идентичны.

> [!NOTE]
> Корпорация Майкрософт рекомендует всегда включать режим аудита для первоначального развертывания и тестирования. Затем следует отслеживать события в журнале событий, чтобы попытаться предвидеть, нарушит ли включение режима принудительного применения какие-либо существующие рабочие процессы.

## <a name="enforce-mode"></a>Режим принудительного применения

Режим принудительного применения предназначен для завершения настройки. Как и в режиме аудита, описанном выше, каждая служба агента контроллера домена оценивает введенный пароль в соответствии с текущей активной политикой. Если включен режим принудительного применения, пароль, который считается небезопасным в соответствии с политикой, отклоняется.

Когда агент контроллера домена службы защиты паролем Azure AD отклоняет пароль в режиме принудительного применения, пользователь видит такой же результат, как и при отклонении пароля при несоблюдении традиционных локальных требований к сложности пароля. Например, пользователь может увидеть следующее традиционное сообщение об ошибке на экране входа или смены пароля Windows.

`Unable to update the password. The value provided for the new password does not meet the length, complexity, or history requirements of the domain.`

Это сообщение является лишь одним из примеров нескольких возможных результатов. Сообщение об ошибке зависит от программного обеспечения или сценария, в котором предпринимается попытка установить небезопасный пароль.

Пользователям, получившим подобное сообщение, может потребоваться обратиться к персоналу отдела по ИТ, чтобы ознакомиться с новыми требованиями и выбрать более безопасные пароли.

## <a name="enable-mode"></a>Режим включения

Как правило, этот параметр должен оставаться во включенном состоянии по умолчанию (Да). Если отключить этот параметр (то есть выбрать значение "Нет"), то все развернутые агенты контроллера домена защиты паролем Azure AD перейдут в режим бездействия, в котором все пароли принимаются "как есть" и какие-либо действия проверки не выполняются ни при каких обстоятельствах (например, даже не создаются события аудита).

## <a name="usage-reporting"></a>Отчеты об использовании

С помощью командлета `Get-AzureADPasswordProtectionSummaryReport` можно создать сводное представление о действиях. Пример выходных данных этого командлета выглядит следующим образом:

```PowerShell
Get-AzureADPasswordProtectionSummaryReport -DomainController bplrootdc2
DomainController                : bplrootdc2
PasswordChangesValidated        : 6677
PasswordSetsValidated           : 9
PasswordChangesRejected         : 10868
PasswordSetsRejected            : 34
PasswordChangeAuditOnlyFailures : 213
PasswordSetAuditOnlyFailures    : 3
PasswordChangeErrors            : 0
PasswordSetErrors               : 1
```

Область, охватываемую отчетом этого командлета, можно указать с помощью параметра -Forest, -Domain или -DomainController. Если этот параметр не указан, используется параметр -Forest.

> [!NOTE]
> Для выполнения этого командлета на каждом контроллере домена запускается сеанс PowerShell. Для успешного выполнения на каждом контроллере домена необходимо включить поддержку удаленных сеансов PowerShell, а клиент должен иметь достаточные привилегии. Чтобы получить дополнительные сведения о требованиях к удаленным сеансам PowerShell, выполните командлет Get-Help about_Remote_Troubleshooting в окне PowerShell.

> [!NOTE]
> Этот командлет удаленно запрашивает журнал событий администратора для каждого службы агента контроллера домена. Если журналы событий содержат большое количество событий, выполнение командлета может занять много времени. Кроме того, пакетные сетевые запросы для передачи больших наборов данных могут повлиять на производительность контроллера домена. Поэтому данный командлет следует осмотрительно использовать в рабочих средах.

## <a name="dc-agent-discovery"></a>Обнаружение агента контроллера домена

Командлет `Get-AzureADPasswordProtectionDCAgent` может использоваться для отображения базовой информации о различных агентах контроллера домена, работающих в домене или лесу. Эта информация извлекается из объектов serviceConnectionPoint, зарегистрированных запущенными службами агента контроллера домена. Пример выходных данных этого командлета выглядит следующим образом:

```PowerShell
Get-AzureADPasswordProtectionDCAgent
ServerFQDN            : bplChildDC2.bplchild.bplRootDomain.com
Domain                : bplchild.bplRootDomain.com
Forest                : bplRootDomain.com
Heartbeat             : 2/16/2018 8:35:01 AM
```

Различные свойства обновляются каждой службой агента контроллера домена приблизительно каждый час. Данные по-прежнему зависят от задержки репликации Active Directory.

На объем запроса командлета может влиять использование параметров -Forest или -Domain.

## <a name="next-steps"></a>Дополнительная информация

[Устранение неполадок и мониторинг службы защиты паролем Azure AD](howto-password-ban-bad-on-premises-troubleshoot.md)
