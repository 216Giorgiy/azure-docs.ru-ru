---
title: "Перемещение локальных приложений AD FS в Azure. | Документация Майкрософт"
description: "Цель этого документа — предоставить организациям сведения о перемещении локальных приложений в Azure AD, уделив особое внимание федеративным приложениям SaaS."
services: active-directory
author: billmath
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 01/29/2018
ms.author: billmath
ms.openlocfilehash: ec0731534da2543d48bedc575bf882b790fa136b
ms.sourcegitcommit: 9d317dabf4a5cca13308c50a10349af0e72e1b7e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2018
---
# <a name="migrate-ad-fs-on-premises-apps-to-azure"></a>Перемещение локальных приложений AD FS в Azure 

Цель этого документа — предоставить организациям сведения о перемещении локальных приложений в Azure AD,  уделив особое внимание федеративным приложениям SaaS.  В этом документе не приводятся пошаговые инструкции.  Он представляет собой общее руководство по перемещению с описанием преобразования локальных конфигураций в Azure AD, а также охватывает требования наиболее распространенных сценариев.

## <a name="introduction"></a>Введение

Если у вас есть локальный каталог, который содержит учетные записи пользователей, скорее всего, у вас есть по крайней мере одно или два приложения,  получить доступ к которым можно через вход с помощью соответствующих удостоверений пользователей.

Если ваша организация подобна большинству, вероятнее всего, вы рассматриваете использование облачных приложений и удостоверений.  Возможно, вы готовы к работе с Office 365 и Azure AD Connect.  Также возможно, что вы установили облачные приложения SaaS для некоторых основных рабочих нагрузок.  

Многие организации объединили приложения SaaS или настраиваемые бизнес-приложения (LoB) непосредственно с локальными службами входа, например службой федерации Active Directory (AD FS), а также приложениями Office 365 и Azure AD.  В этом руководстве по перемещению описываются причины и способы миграции локальных приложений в Azure AD.

>[!NOTE]
>Оно включает подробные сведения о перемещении и конфигурации приложения SaaS, а также общие сведения о настраиваемых бизнес-приложениях (LoB).  Более подробное описание настраиваемых бизнес-приложений (LoB) планируется в будущем.

Рис. 1. Приложения, подключенные локально ![локальная среда](media/migrate-adfs-apps-to-azure/migrate1.png)

Рис. 2. Приложения, объединенные через Azure AD ![Azure](media/migrate-adfs-apps-to-azure/migrate2.png)

## <a name="why-migrate-apps-to-azure-ad"></a>Зачем переносить приложения в Azure AD?

Для организаций, которые уже используют AD FS, Ping или другой локальный поставщик проверки подлинности, перемещение приложений в Azure AD дает такие преимущества:

**Более безопасный доступ**
- Детально настройте элементы управления доступом каждого приложения, включая многофакторную идентификацию (MFA), с помощью [условного доступа Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-azure-portal).  Политики можно применить к приложениям SaaS и пользовательским приложениям таким же образом, который известен на сегодня для Office 365.
- Для обнаружения угроз и защиты входа на основе машинного обучения и эвристики, идентифицирующих рискованный трафик, ознакомьтесь с [защитой идентификации Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection), чтобы узнать о встроенных и постоянно развивающихся возможностях Azure AD.

**Служба совместной работы Azure AD B2B**
- Если вход в приложения SaaS выполняется на основе Azure AD, можно предоставить партнерам доступ к облачным ресурсам с помощью [службы совместной работы Azure AD B2B](https://docs.microsoft.com/azure/active-directory/active-directory-b2b-what-is-azure-ad-b2b).

**Упрощенная процедура администрирования и дополнительные возможности Azure AD**
- Как поставщик удостоверений для приложений SaaS, Azure AD поддерживает дополнительные возможности, такие как сертификаты для подписи маркера для каждого приложения, [настраиваемые даты истечения срока действия сертификатов](https://docs.microsoft.com/azure/active-directory/active-directory-sso-certs) и [автоматическая подготовка](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning) учетных записей пользователей (в основных приложениях коллекции) на основе удостоверений Azure AD.

**Использование возможностей локального поставщика удостоверений**
- Преимущества Azure AD позволяют использовать локальное решение проверки подлинности, что дает возможность использовать локальные решения многофакторной идентификации (MFA), ведение журналов и аудит. 

**Узнайте о прекращении использования локального поставщика удостоверений**
- Для организаций, которые больше не хотят использовать локальный продукт проверки подлинности, перемещение приложений в Azure AD предоставляет возможность удобного перехода за счет получения некоторых дополнительных сведений. 

## <a name="mapping-types-of-apps-on-premises-to-types-of-apps-in-azure-ad"></a>Сопоставление типов приложений в локальной среде с типами приложений в Azure AD
Большинство приложений подразделяются на несколько категорий в зависимости от используемого типа входа.  Эти категории определяют, каким образом приложение представлено в Azure AD.

Коротко говоря, приложения SAML 2.0 можно интегрировать с Azure AD через коллекцию приложений Azure AD или как приложения, не связанные с коллекцией.  Приложения, использующие OAuth 2.0 или OpenID Connect, можно интегрировать с Azure AD так же, как и при "регистрации приложений".  Чтобы получить дополнительные сведения, читайте дальше.

### <a name="federated-saas-apps-vs-custom-lob-apps"></a>Сравнение федеративных приложений SaaS с настраиваемыми бизнес-приложениями (LoB)
Федеративные приложения включают приложения, которые делятся на категории ниже.

- Приложения SaaS 
    - Если пользователи входят в приложения SaaS, такие как Salesforce, ServiceNow или Workday, и вы выполняете интеграцию с локальным поставщиком удостоверений, таким как AD FS или Ping, значит вы используете федеративную проверку подлинности приложений SaaS.
    - Для федеративного входа приложения обычно используют протокол SAML 2.0.
    - Приложения, которые попадают в эту категорию, можно интегрировать с Azure AD как корпоративные приложения, из коллекции или как приложения, не связанные с коллекцией.
- Настраиваемые бизнес-приложения
    - К этой категории относятся другие приложения, а не SaaS, разработанные внутри организации или доступные как стандартный продукт в пакете, установленный в вашем центре обработки данных.  Сюда входят приложения SharePoint и приложения, созданные на платформе Windows Identity Foundation (WIF).
    - Для федеративного входа приложения могут использовать SAML 2.0, WS-Federation, OAuth или OpenID Connect.
    - В рамках корпоративных приложений пользовательские приложения, использующие Oauth 2.0, OpenID Connect и WS-Federation, можно интегрировать с Azure AD как регистрации приложения, а пользовательские приложения, использующие SAML 2.0 или WS-Federation, можно интегрировать как приложения, не связанные с коллекцией.

### <a name="non-federated-apps"></a>Нефедеративные приложения
Кроме того, приложения, не являющиеся федеративными, можно интегрировать с Azure AD с помощью прокси-сервера приложения Azure AD и связанных функций.  Дополнительные сведения о возможностях см. ниже.
- Приложения, использующие Windows Integrated Auth (WIA) непосредственно в Active Directory.
    - Эти приложения можно интегрировать с Azure AD через [прокси-сервер приложения Azure AD](https://docs.microsoft.com/azure/active-directory/application-proxy-publish-azure-portal).
- Приложения, которые интегрируются с поставщиком единого входа через агент и используют заголовки для авторизации.
    - Локальные приложения, использующие установленный агент для входа и авторизацию на основе заголовка, можно настроить для входа на основе Azure AD с помощью прокси-сервера приложения Azure AD с [доступом Ping Access для AzureAD](https://blogs.technet.microsoft.com/enterprisemobility/2017/06/15/ping-access-for-azure-ad-is-now-generally-available-ga/).

## <a name="translating-on-premises-federated-apps-to-azure-ad"></a>Переход локальных федеративных приложений в Azure AD 
К счастью, службы AD FS и Azure AD работают похожим образом, поэтому понятия настройки отношения доверия, URL-адресов входа и выхода, а также идентификаторов можно применить для двух служб.  Однако есть некоторые небольшие различия, с которыми необходимо ознакомиться в рамках перехода.

Чтобы упростить переход, в таблице ниже мы сопоставили несколько ключевых идей, подходящих для приложений AD FS, Azure AD и SaaS. 

### <a name="representing-the-app-in-azure-ad-or-ad-fs"></a>Описание приложения в Azure AD или AD FS
Перемещение начинается с оценки настройки приложения в локальной среде и сопоставления этой конфигурации с Azure AD.  Ниже приведено сопоставление элементов конфигурации проверяющей стороны AD FS с соответствующими элементами в Azure AD.  
- Условие AD FS: проверяющая сторона или доверие проверяющей стороны.
- Условие Azure AD: корпоративное приложение или регистрация приложения (в зависимости от типа приложения).

|Элемент конфигурации приложения|ОПИСАНИЕ|В рамках конфигурации AD FS|Соответствующее расположение в конфигурации Azure AD|Элемент маркера SAML|
|-----|-----|-----|-----|-----|
|URL-адрес входа приложения|URL-адрес страницы входа этого приложения. Это расположение, куда переходит пользователь для запуска входа в приложение в потоке SAML, запущенном SP.|Недоступно|В Azure AD URL-адрес входа настроен на портале Azure в свойствах единого входа приложения как URL-адрес входа.</br></br>(Чтобы просмотреть URL-адрес входа, щелкните "Показать дополнительные параметры URL-адресов".)||
|URL-адрес ответа приложения|URL-адрес приложения с точки зрения поставщика удостоверений.  Это расположение, откуда отправляются пользователь и маркер после входа пользователя через выдающую точку распространения.</br></br>  Иногда это расположение называют конечной точкой потребителя утверждения SAML.|Элемент можно найти в доверии проверяющей стороны AD FS приложения.  Щелкните правой кнопкой мыши проверяющую сторону и выберите "Свойства", вкладка "Конечные точки".|В Azure AD URL-адрес ответа настроен на портале Azure в свойствах единого входа приложения как URL-адрес ответа.</br></br>(Чтобы просмотреть URL-адрес ответа, щелкните "Показать дополнительные параметры URL-адресов".)|Сопоставляется с элементом назначения в маркере SAML.</br></br>  Пример значения: https://contoso.my.salesforce.com|
|URL-адрес выхода|URL-адрес, на который отправляются запросы "очистки выхода" после выхода пользователя из приложения, чтобы выйти из всех остальных приложений, куда пользователь был направлен через IDP.|Элемент можно найти в управлении AD FS — "Отношения доверия проверяющей стороны".  Щелкните правой кнопкой мыши проверяющую сторону, выберите "Свойства", а затем щелкните вкладку "Конечные точки".|Недоступно. Azure AD не поддерживает единый выход, то есть выход всех приложений.  Выполняется выход пользователя из Azure AD.|Нет данных|
|Идентификатор приложения|Идентификатор приложения с точки зрения поставщика удостоверений. Значение URL-адреса входа часто (но не всегда) используется для идентификатора.</br></br>  Иногда приложение вызывает этот "идентификатор сущности".|В AD FS это идентификатор проверяющей стороны. Щелкните правой кнопкой мыши отношение доверия с проверяющей стороной, выберите "Свойства", а затем щелкните вкладку "Идентификаторы".|В Azure AD идентификатор настроен на портале Azure в свойствах единого входа приложения как идентификатор в разделе доменов и URL-адресов приложения. (Вы можете установить флажок "Показать дополнительные параметры URL-адресов".)|Соответствует элементу аудитории в маркере SAML.|
|Метаданные федерации приложения|Расположение метаданных федерации приложения.  Используется поставщиком удостоверений для автоматического обновления определенных настроек конфигурации, например конечных точек или сертификатов шифрования.|URL-адрес метаданных федерации приложения можно найти в отношении доверия с проверяющей стороной AD FS.  Щелкните правой кнопкой мыши отношение доверия, выберите "Свойства", а затем щелкните вкладку "Мониторинг".|Недоступно. Azure AD не поддерживает прямое использование метаданных федерации приложения.|Нет данных|
|Идентификатор пользователя или идентификатор имени|Атрибут для уникального определения идентификатора пользователя из Azure AD или AD FS при входе в приложение.</br></br>  Обычно представляет собой имя участника-пользователя или адрес электронной почты пользователя.|В AD FS этот элемент указывается как правило утверждения проверяющей стороны.  В большинстве случаев именно это правило выдает утверждение с типом, который оканчивается на "идентификатор_имени".|В Azure AD идентификатор пользователя можно найти на портале Azure в свойствах единого входа приложения в атрибутах пользователя заголовка.</br></br>По умолчанию используется имя участника-пользователя.|Передается из IDP в приложение как элемент идентификатора имени в маркере SAML.|
|Другие утверждения, отправляемые в приложение|Кроме идентификатора или имени пользователя из IDP в приложение обычно отправляются и другие сведения об утверждениях, например имя, фамилия, адрес электронной почты и список групп, участником которых является пользователь.|В AD FS этот элемент может представлять собой другие правила утверждения проверяющей стороны.|В Azure AD другие утверждения можно найти на портале Azure в свойствах единого входа приложения в атрибутах пользователя заголовка. Щелкните "Просмотр" и измените любые другие атрибуты пользователя.|| 

### <a name="representing-azure-ad-as-an-identity-provider-idp-in-a-saas-app"></a>Azure AD как поставщик удостоверений (IdP) в приложении SaaS
В процессе перемещения приложение необходимо настроить для точки в Azure AD (в отличие от локального поставщика удостоверений).  В этом разделе основное внимание уделяется приложениям SaaS, использующим протокол SAML, а не настраиваемым бизнес-приложениям. Тем не менее основные понятия, описанные в этом разделе, также охватывают настраиваемые бизнес-приложения. 

На высоком уровне есть некоторые ключевые элементы, которые стоит учесть при перемещении приложения SaaS в Azure AD.
- Издатель поставщика удостоверений: https://sts.windows.net/{tenant-id}/
- URL-адрес входа поставщика удостоверений: https://login.microsoftonline.com/{tenant-id}/saml2
- URL-адрес выхода поставщика удостоверений: https://login.microsoftonline.com/{tenant-id}/saml2 
- Расположение метаданных федерации: https://login.windows.net/{tenant-id} <tenant-id>/federationmetadata/2007-06/federationmetadata.xml?appid={<application-id}, 

где {tenant-id} заменяется идентификатором клиента, доступным на портале Azure: выберите "Azure Active Directory", в качестве идентификатора каталога выберите свойства; {application-id} заменяется идентификатором приложения, доступным в свойствах приложения как "Код приложения".

В таблице ниже приведены подробные сведения об основных элементах конфигурации поставщика удостоверений для настройки параметров SSO в приложении и их значений или расположений в AD FS и Azure AD.  Структура таблицы подразумевает приложение SaaS, которому необходимо знать, куда отправлять запросы на проверку подлинности, а также способы проверки полученных маркеров.

|Элемент конфигурации|ОПИСАНИЕ|AD FS|Azure AD|
|---|---|---|---|
|URL-адрес </br>входа поставщика удостоверений </br>URL-адрес|URL-адрес входа поставщика удостоверений с точки зрения приложения (расположение, откуда пользователь перенаправляется для входа в систему).|URL-адрес входа AD FS представляет собой имя службы федерации AD FS, за которым следует "/adfs/ls/". Например: https&#58;//fs.contoso.com/adfs/ls/|Соответствующее значение Azure AD отвечает шаблону, где {tenant-id} заменяется соответствующим идентификатором клиента, доступным на портале Azure в Azure Active Directory в свойствах, таких как "Идентификатор каталога".</br></br>Для приложений, использующих протокол SAML-P: https://login.microsoftonline.com</br>/{tenant-id}/saml2 </br></br>Для приложений, использующих протокол WS-Federation: https://login.microsoftonline.com</br>/{tenant-id}/wsfed|
|URL-адрес </br>выхода поставщика удостоверений </br>URL-адрес|URL-адрес выхода поставщика удостоверений с точки зрения приложения (откуда перенаправляются пользователи при выходе из приложения).|Для AD FS URL-адрес выхода сходный с URL-адресом входа или URL-адресом с добавленным элементом "wa=wsignout1.0". Например: https://fs.contoso.com/adfs/ls /?wa=wsignout1.0|Соответствующее значение Azure AD зависит от того, поддерживает ли приложение выход SAML 2.0.</br></br>Если приложение поддерживает выход SAML 2.0, значение отвечает шаблону, где значение для {tenant-id} заменяется соответствующим идентификатором клиента, доступным на портале Azure в Azure Active Directory в свойствах, таких как "Идентификатор каталога". https://login.microsoftonline.com</br>/{tenant-id}/saml2</br></br>Если приложение не поддерживает выход SAML: https://login.microsoftonline.com</br>/common /wsfederation?wa=wsignout1.0|
|по маркеру </br>Сертификат для подписи маркера </br>Сертификат|Сертификат, закрытый ключ которого используется IDP для подписи выданных маркеров.  Он проверяет, поступил ли маркер от того же поставщика, с которым у приложения настроено отношение доверия.|Сертификат для подписи маркера AD FS находится в управлении AD FS в разделе сертификатов.|В Azure AD сертификат для подписи маркера можно найти на портале Azure в свойствах единого входа приложения в заголовке сертификатов для подписи маркера SAML, куда можно загрузить сертификат для передачи приложению.</br></br>  Если приложение включает несколько сертификатов, их все можно найти в XML-файле метаданных федерации.|
|Идентификатор или </br>издатель|Идентификатор поставщика удостоверений с точки зрения приложения (иногда называется издателем или идентификатором издателя).</br></br>В маркере SAML значение отображается как элемент "Издатель".|Идентификатор AD FS обычно представляет собой идентификатор службы федерации в управлении AD FS: "Служба" -> "Изменить свойства службы федерации".  Например: http://fs.contoso.com/adfs/services/trust|Соответствующее значение Azure AD отвечает шаблону, где значение {tenant-id} заменяется соответствующим идентификатором клиента, доступным на портале Azure в Azure Active Directory в свойствах, таких как "Идентификатор каталога".  https://sts.windows.net/{tenant-id}/|
|URL-адрес </br>Федерация </br>Метаданные|Расположение общедоступных метаданных федерации IDP.  (Некоторые приложения используют метаданные федерации как альтернативу отдельной настройке администратора URL-адресов, идентификатору и сертификату для подписи маркера.)|URL-адрес метаданных федерации AD FS находится в службе управления AD FS: "Служба -> Конечные точки -> Метаданные -> Тип: Метаданные федерации". Например: https://fs.contoso.com/ FederationMetadata/2007-06/</br>FederationMetadata.xml|Нужное значение для Azure AD соответствует шаблону https://login.microsoftonline.com</br>/{TenantDomainName}/FederationMetadata/2007-06/</br>В файле FederationMetadata.xml значение {TenantDomainName} заменяется именем вашего клиента в формате "contoso.onmicrosoft.com". </br></br>[Дополнительные сведения](https://docs.microsoft.com/azure/active-directory/develop/active-directory-federation-metadata) о метаданных федерации в Azure AD.

## <a name="migrating-saas-apps"></a>Перемещение приложений SaaS
На сегодняшний день перемещение приложений SaaS из AD FS или другого поставщика удостоверений в Azure AD выполняется вручную. Дополнительные сведения об определенных приложениях см. в статье [Интеграция приложений SaaS с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list).

Сведения в этих руководствах по интеграции относятся к интеграции новых развертываний.  Есть несколько основных понятий, которые относятся к миграции и с которыми необходимо ознакомиться для соответствующего планирования, оценки, настройки и перемещения приложений.  
- В то время как перемещение простых приложений не представляет сложности, приложениям с более комплексными требованиями, например пользовательским утверждениям, может потребоваться дополнительная настройка в Azure AD или Azure AD Connect.
- В большинстве случаев приложению требуются только утверждение NameId и другие распространенные утверждения идентификатора пользователя. Чтобы определить, требуются ли какие-то дополнительные утверждения, проверьте, какие утверждения выдает AD FS или поставщик удостоверений стороннего производителя.
- Выяснив, что требуются дополнительные утверждения, следует проверить их доступность в Azure AD.  Для синхронизации обязательного атрибута (например, samAccountName) с Azure AD необходимо настроить конфигурацию синхронизации Azure AD Connect.
- Как только атрибуты станут доступны в Azure AD, добавьте правила выдачи утверждений в Azure AD, чтобы включить эти атрибуты как утверждения в выданные маркеры.  Настройте все свойства единого входа приложения в Azure AD.

### <a name="assessing-what-can-be-migrated"></a>Что доступно для перемещения
Приложения SAML 2.0 можно интегрировать с Azure AD через коллекцию приложений Azure AD или как приложения, не связанные с коллекцией.  

Есть некоторые конфигурации, которые требуют дополнительных действий по настройке в Azure AD, а некоторые на сегодняшний день не поддерживаются.  Чтобы определить доступные для перемещения объекты, просмотрите текущую конфигурацию всех приложений, уделив особое внимание следующему:
- настроенным правилам утверждений (правила преобразования выдачи);
- формату и атрибуту NameID SAML;
- выданным версиям маркера SAML;
- другим конфигурациям, таким как правила авторизации выдачи, политики управления доступом и правила многофакторной проверки подлинности (дополнительная аутентификация).

#### <a name="what-can-be-migrated-today"></a>Что доступно для перемещения на сегодняшний день
На сегодняшний день можно легко переместить приложения SAML 2.0, использующие стандартный набор элементов и утверждений конфигурации.  Они могут включать:
- Имя участника-пользователя.
- Адрес электронной почты.
- Заданное имя
- Surname
- Альтернативный атрибут, такой как NameID SAML, включая атрибуты электронной почты Azure AD, префикса электронной почты, employeeid и расширения 1–15, или локальный атрибут SamAccountName (дополнительные сведения см. в статье [Customizing claims issued in the SAML token for enterprise applications in Azure Active Directory](./develop/active-directory-saml-claims-customization.md) (Изменение утверждений, выданных в токене SAML для корпоративных приложений Azure Active Directory)).
- Настраиваемые утверждения (дополнительные сведения о поддерживаемых сопоставлениях утверждений см. в статье [Сопоставление утверждений в Azure Active Directory (общедоступная предварительная версия)](active-directory-claims-mapping.md) и этом [руководстве](./develop/active-directory-saml-claims-customization.md)).

Кроме настраиваемых утверждений и элементов nameID, конфигурации, требующие дополнительных действий по настройке в Azure AD при перемещении, включают:
- пользовательскую авторизацию или правила многофакторной проверки подлинности в AD FS (настроенные с помощью функции [условного доступа Azure AD](active-directory-conditional-access-azure-portal.md)).
- Приложения с несколькими конечными точками SAML можно настроить в Azure AD с помощью PowerShell (эта возможность на портале недоступна).
- Приложения WS-Federation, например приложения SharePoint, которым требуются маркеры SAML версии 1.1, нужно настроить вручную с помощью PowerShell.

#### <a name="appsconfigurations-not-supported-in-azure-ad-today"></a>Приложения и конфигурации, неподдерживаемые в Azure AD на сегодняшний день
Миграция приложений, которым требуются возможности ниже, пока недоступна.  Если у вас есть приложения, которым требуются функции ниже, оставьте свой отзыв в разделе комментариев.
- Возможности протокола
    - Поддержка единого выхода SAML (SLO) всех приложений, для которых выполнен вход.
    - Поддержка шаблона WS-Trust ActAs.
    - Разрешение артефактов SAML. 
    - Проверка подписи подписанных запросов SAML (обратите внимание, что подписанные запросы принимаются, но подпись не проверяется).
 - Возможности маркера. 
     - Шифрование маркеров SAML. 
     - Маркеры SAML версии 1.1 в ответах протокола SAML. 
- Утверждения в возможностях маркера
    - Назначение локальных имен группы как утверждений.
    - Утверждения из хранилищ данных, отличных от Azure AD.
    - Комплексные правила преобразования выдачи утверждений (дополнительные сведения см. в этом руководстве, включая сведения о поддерживаемых сопоставлениях утверждений).
    - Назначение расширений каталога как утверждений.
    - Настраиваемая спецификация формата NameID.
    - Выдача атрибутов с несколькими значениями.

>[!NOTE]
>Azure AD непрерывно развивается для включения дополнительных возможностей в этой области. Сведения в этом руководстве постоянно обновляются. 

### <a name="configuring-azure-ad"></a>Настройка Azure AD    
#### <a name="configure-single-sign-on-sso-settings-for-the-saas-app"></a>Настройка параметров единого входа (SSO) для приложения SaaS

В Azure AD настройка входа SAML в рамках требований приложения выполняется в свойствах единого входа приложения в атрибутах пользователя, как показано ниже:

![](media/migrate-adfs-apps-to-azure/migrate3.png)
- Щелкните просмотр и изменение других атрибутов пользователя, чтобы просмотреть атрибуты для отправки в виде утверждений в маркере безопасности.

![](media/migrate-adfs-apps-to-azure/migrate4.png)
- Щелкните определенную строку атрибута, чтобы изменить ее, или щелкните "Добавить атрибут" для добавления нового атрибута. 
![](media/migrate-adfs-apps-to-azure/migrate5.png)

#### <a name="assign-users-to-the-app"></a>Назначение пользователей приложению
Чтобы пользователи в Azure AD могли войти в определенное приложение SaaS, им необходимо предоставить доступ в Azure AD.

Чтобы назначить пользователей на портале Azure AD, перейдите на экран приложения SaaS и щелкните "Пользователи и группы" на боковой панели. Чтобы добавить пользователя или группу, щелкните "Добавить пользователя" в верхней части экрана. 

![](media/migrate-adfs-apps-to-azure/migrate6.png) 

![](media/migrate-adfs-apps-to-azure/migrate7.png) Для проверки доступа пользователь должен увидеть упомянутое приложение SaaS на [панели доступа](https://docs.microsoft.com/azure/active-directory/active-directory-saas-access-panel-introduction) при входе. Его также можно найти здесь: http://myapps.microsoft.com. Например, пользователю успешно предоставлен доступ к Salesforce и ServiceNow.

![](media/migrate-adfs-apps-to-azure/migrate8.png)

### <a name="configuring-the-saas-app"></a>Настройка приложения SaaS
Процесс перехода из локальной федерации в Azure AD зависит от того, поддерживает ли приложение SaaS, с которым вы работаете, несколько поставщиков удостоверений (IdP).  Ниже приведены некоторые распространенные вопросы о поддержке нескольких поставщиков удостоверений.

   **Вопрос. Что значит поддержка приложением нескольких поставщиков удостоверений?**
    
   Ответ. Приложения SaaS, которые поддерживают несколько поставщиков удостоверений, дают возможность вводить все необходимые сведения о новом поставщике (в нашем случае — Azure AD) перед применением изменений возможностей входа.  После завершения конфигурации можно переключить конфигурацию проверки подлинности приложения для точки в Azure AD.

   Вопрос. Почему важна поддержка нескольких поставщиков удостоверений?

   Ответ. При отсутствии поддержки нескольких поставщиков удостоверений администратору необходимо будет зарезервировать некоторое время как время сбоя обслуживания или службы, во время которого он настроит Azure AD в качестве нового поставщика приложения. Во время этого сбоя пользователи получат уведомления о невозможности выполнить вход в учетную запись.

   Если приложение поддерживает несколько поставщиков удостоверений, дополнительный поставщик можно настроить заранее, чтобы администратор мог просто переключить его во время перехода в Azure.

   Кроме того, если приложение поддерживает несколько поставщиков удостоверений и вы выбираете их для одновременной обработки проверки подлинности входа, пользователь может выбрать поставщик для проверки подлинности на странице входа.

#### <a name="example-multiple-idp-support"></a>Пример: поддержка нескольких поставщиков удостоверений
Например, в Salesforce конфигурацию IDP можно найти здесь: "Параметры -> Параметры компании -> My Domain (Мой домен) -> Конфигурация проверки подлинности".

![](media/migrate-adfs-apps-to-azure/migrate9.png)

Так как ранее мы создали конфигурацию в разделе "Удостоверение -> Параметры единого входа", вы можете изменить поставщик удостоверений конфигурации аутентификации с AD FS на Azure AD. 

![](media/migrate-adfs-apps-to-azure/migrate10.png)

### <a name="optional-configure-user-provisioning-in-azure-ad"></a>Необязательно. Настройка подготовки пользователей в Azure AD
Если вы хотите, чтобы в Azure AD напрямую выполнялась обработка подготовки пользователей для указанного приложения SaaS, ознакомьтесь с руководством по управлению подготовкой учетными записями пользователей для корпоративных приложений в Azure AD.

## <a name="next-steps"></a>Дополнительная информация

- [Управление приложениями с помощью Azure Active Directory](active-directory-enable-sso-scenario.md)
- [Управление доступом к приложениям](active-directory-managing-access-to-apps.md)
- [Azure AD Connect Federation](active-directory-aadconnectfed-whatis.md) (Федерация в Azure AD Connect)