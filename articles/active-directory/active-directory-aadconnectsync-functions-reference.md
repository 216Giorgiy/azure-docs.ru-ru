<properties
	pageTitle="Azure AD Connect Sync: справочник по функциям"
	description="Общие сведения о выражениях декларативной подготовки в Azure AD Connect Sync"
	services="active-directory"
	documentationCenter=""
	authors="markusvi"
	manager="swadhwa"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/27/2015"
	ms.author="markusvi"/>


# Azure AD Connect Sync: справочник по функциям


В службе Azure Active Directory Sync функции используются для обработки значения атрибута во время синхронизации. <br>Синтаксис функций выражается в следующем формате:<br>`<output type> FunctionName(<input type> <position name>, ..)`

Если функция перегружена и принимает несколько вариантов синтаксиса, перечисляются все допустимые варианты синтаксиса.<br> Функции являются строго типизированными и контролируют, чтобы переданный тип соответствовал задокументированному типу.<br> Если тип не совпадает, выводится сообщение об ошибке.

Типы выражаются с помощью следующего синтаксиса:

- **bin** – двоичное значение
- **bool** — логическое значение
- **dt** — дата и время в формате UTC
- **enum** — перечисление известных констант
- **exp** — выражение, которое должно преобразовываться в логическое значение
- **mvbin** — двоичное значение с несколькими значениями
- **mvstr** — ссылка с несколькими значениями
- **num** — числовое значение
- **ref** — ссылка с одним значением
- **str** — строка с одним значением
- **var** — вариант (почти) любого другого типа
- **void** — не возвращает значение



## Справочник по функциям

----------
**Преобразование:**

[CBool](#cbool) &nbsp;&nbsp;&nbsp;&nbsp; [CDate](#cdate) &nbsp;&nbsp;&nbsp;&nbsp; [CGuid](#cguid) &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; [ConvertFromBase64](#convertfrombase64) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertToBase64](#converttobase64) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertFromUTF8Hex](#convertfromutf8hex) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertToUTF8Hex](#converttoutf8hex) &nbsp;&nbsp;&nbsp;&nbsp; [CNum](#cnum) &nbsp;&nbsp;&nbsp;&nbsp; [CRef](#cref) &nbsp;&nbsp;&nbsp;&nbsp; [CStr](#cstr) &nbsp;&nbsp;&nbsp;&nbsp; [StringFromGuid](#StringFromGuid) &nbsp;&nbsp;&nbsp;&nbsp; [StringFromSid](#stringfromsid)

**Дата/время:**

[DateAdd](#dateadd) &nbsp;&nbsp;&nbsp;&nbsp; [DateFromNum](#datefromnum) &nbsp;&nbsp;&nbsp;&nbsp; [FormatDateTime](#formatdatetime) &nbsp;&nbsp;&nbsp;&nbsp; [Now](#now) &nbsp;&nbsp;&nbsp;&nbsp; [NumFromDate](#numfromdate)

**Каталог**

[DNComponent](#dncomponent) &nbsp;&nbsp;&nbsp;&nbsp; [DNComponentRev](#dncomponentrev) &nbsp;&nbsp;&nbsp;&nbsp; [EscapeDNComponent](#escapedncomponent)

**Проверка:**

[IsBitSet](#isbitset) &nbsp;&nbsp;&nbsp;&nbsp; [IsDate](#isdate) &nbsp;&nbsp;&nbsp;&nbsp; [IsEmpty](#isempty) &nbsp;&nbsp;&nbsp;&nbsp; [IsGuid](#isguid) &nbsp;&nbsp;&nbsp;&nbsp; [IsNull](#isnull) &nbsp;&nbsp;&nbsp;&nbsp; [IsNullOrEmpty](#isnullorempty) &nbsp;&nbsp;&nbsp;&nbsp; [IsNumeric](#isnumeric) &nbsp;&nbsp;&nbsp;&nbsp; [IsPresent](#ispresent) &nbsp;&nbsp;&nbsp;&nbsp; [IsString](#isstring)

**Математические функции:**

[BitAnd](#bitand) &nbsp;&nbsp;&nbsp;&nbsp; [BitOr](#bitor) &nbsp;&nbsp;&nbsp;&nbsp; [RandomNum](#randomnum)

**Функции с несколькими значениями:**

[Contains](#contains) &nbsp;&nbsp;&nbsp;&nbsp; [Count](#count) &nbsp;&nbsp;&nbsp;&nbsp; [Item](#item) &nbsp;&nbsp;&nbsp;&nbsp; [ItemOrNull](#itemornull) &nbsp;&nbsp;&nbsp;&nbsp; [Join](#join) &nbsp;&nbsp;&nbsp;&nbsp; [RemoveDuplicates](#removeduplicates) &nbsp;&nbsp;&nbsp;&nbsp; [Split](#split)

**Функции программного потока:**

[Error](#error) &nbsp;&nbsp;&nbsp;&nbsp; [IIF](#iif) &nbsp;&nbsp;&nbsp;&nbsp; [Switch](#switch)


**текст**

[GUID](#guid) &nbsp;&nbsp;&nbsp;&nbsp; [InStr](#instr) &nbsp;&nbsp;&nbsp;&nbsp; [InStrRev](#instrrev) &nbsp;&nbsp;&nbsp;&nbsp; [LCase](#lcase) &nbsp;&nbsp;&nbsp;&nbsp; [Left](#left) &nbsp;&nbsp;&nbsp;&nbsp; [Len](#len) &nbsp;&nbsp;&nbsp;&nbsp; [LTrim](#ltrim) &nbsp;&nbsp;&nbsp;&nbsp; [Mid](#mid) &nbsp;&nbsp;&nbsp;&nbsp; [PadLeft](#padleft) &nbsp;&nbsp;&nbsp;&nbsp; [PadRight](#padright) &nbsp;&nbsp;&nbsp;&nbsp; [PCase](#pcase) &nbsp;&nbsp;&nbsp;&nbsp; [Replace](#replace) &nbsp;&nbsp;&nbsp;&nbsp; [ReplaceChars](#replacechars) &nbsp;&nbsp;&nbsp;&nbsp; [Right](#right) &nbsp;&nbsp;&nbsp;&nbsp; [RTrim](rtrim) &nbsp;&nbsp;&nbsp;&nbsp; [Trim](#trim) &nbsp;&nbsp;&nbsp;&nbsp; [UCase](#ucase) &nbsp;&nbsp;&nbsp;&nbsp; [Word](#word)

----------
### BitAnd

**Описание.**<br> Функция BitAnd задает конкретное значение для битов.
 
**Синтаксис:**<br> `num BitAnd(num value1, num value2)`

- value1, value2: числовые значения, которые должны быть соединены оператором AND.
 
**Примечания.**<br> Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита значения:
 
- 0 — если один или оба соответствующих бита в *маске* и *флаге* равны 0;
- 1 — если оба соответствующих бита равны 1. 

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.
 
**Пример:**<br> `BitAnd(&HF, &HF7)`<br> Возвращает 7, поскольку шестнадцатеричные «F» и «F7» преобразовываются в это значение.
 
----------
### BitOr

**Описание.**<br> Функция BitOr задает конкретное значение для битов.

**Синтаксис:** <br> `num BitOr(num value1, num value2)`

- value1, value2: числовые значения, которые должны быть соединены оператором OR. 

**Примечания:**<br> Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита значение 1, если один или оба соответствующих бита в маске и флаге равны 1, и устанавливает значение 0, если оба соответствующих бита равны 0. <br> Другими словами, функция возвращает значение 1 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 0.

----------
### CBool

**Описание.**<br> Функция CBool возвращает логическое значение на основе вычисленного выражения.

**Синтаксис:** <br> `bool CBool(exp Expression)`

**Примечания.**<br> Если выражение преобразуется в ненулевое значение, функция CBool возвращает значение True, в противном случае она возвращает значение False.


**Пример:**<br> `CBool([attrib1] = [attrib2])` <br>

Возвращает значение True, если оба атрибута имеют одинаковое значение.
 
 


----------
### CDate

**Описание.**<br> Функция CDate возвращает из строки значение даты и времени в формате UTC. DateTime не является собственным типом атрибута синхронизации, но используется некоторыми функциями.

**Синтаксис:**<br> `dt CDate(str value)`

- Value: строка с датой, временем и (необязательно) часовым поясом.

**Примечания.**<br> Строка всегда возвращается в формате UTC.

**Пример:**<br> `CDate([employeeStartTime])` <br> Функция возвращает объект DateTime с учетом времени начала работы сотрудника.

`CDate("2013-01-10 4:00 PM -8")` <br> Возвращает объект DateTime, представляющий значение «2013-01-11 12:00 AM».
 



----------
### CGuid

**Описание.**<br> Функция CGuid преобразует строковое представление идентификатора GUID в двоичное представление.
 
**Синтаксис:**<br> `bin CGuid(str GUID)GUID`

- Строка отформатирована по следующему шаблону: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx или {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}
 



----------
### Содержит

**Описание.**<br> Функция Contains находит строку внутри атрибута с несколькими значениями.
 
**Синтаксис:**<br> `num Contains (mvstring attribute, str search)` — с учетом регистра<br> `num Contains (mvstring attribute, str search, enum Casetype)`<br> `num Contains (mvref attribute, str search)` — с учетом регистра

- attribute: атрибут с несколькими значениями для поиска.<br>
- search: строка для поиска в атрибуте.<br>
- Casetype: без учета регистра или с учетом регистра.<br>

Возвращает индекс в атрибут с несколькими значениями, в котором найдена строка. Если строка не найдена, возвращается 0.
 

**Примечания.**<br> Для атрибутов со строкой с несколькими значениями search будет искать подстроки в значениях.<br> Чтобы считаться соответствием в ссылочном атрибуте, искомая строка должна точно соответствовать значению.
 
**Пример:**<br> `IIF(Contains([proxyAddresses],”SMTP:”)>0,[proxyAddresses],Error(“No primary SMTP address found.”))`<br> Если атрибут proxyAddresses имеет основной адрес электронной почты (обозначается буквами в верхнем регистре «SMTP:»), возвращается атрибут proxyAddress, в противном случае возвращается сообщение об ошибке.
 
 


----------
### ConvertFromBase64

**Описание.**<br> Функция ConvertFromBase64 преобразует значение в кодировке Base64 в обычную строку.
 
**Синтаксис:**<br> `str ConvertFromBase64(str source)` — здесь предполагается кодирование Юникод <br> `str ConvertFromBase64(str source, enum Encoding)`

- source: строка в кодировке Base64<br>
- Encoding: Юникод, ASCII, UTF8

**Пример:**<br> `ConvertFromBase64("SABlAGwAbABvACAAdwBvAHIAbABkACEA")`<br> `ConvertFromBase64("SGVsbG8gd29ybGQh", UTF8)`

Оба примера возвращают сообщение "*Hello world!*".
 
 


----------
### ConvertFromUTF8Hex

**Описание**<br> Функция ConvertFromUTF8Hex преобразует значение в шестнадцатеричной кодировке UTF8 в обычную строку.
 
**Синтаксис**<br> `str ConvertFromUTF8Hex(str source)`

- source: строка в двухбайтовой кодировке UTF8.
 
**Примечания**<br> Эта функция отличается от функции ConvertFromBase64(,UTF8) тем, что ее результат является понятным для атрибута различающегося имени.<br> Azure Active Directory использует этот формат в качестве различающегося имени.
 
**Пример**<br> `ConvertFromUTF8Hex("48656C6C6F20776F726C6421")`<br> Возвращает сообщение "*Hello world!*".
 
 


----------
### ConvertToBase64

**Описание** <br> Функция ConvertToBase64 преобразует строку в строку в кодировке base64 Юникода.<br> Преобразует значение массива целых чисел в эквивалентное строковое представление в кодировке знаков base64.

**Синтаксис** <br> `str ConvertToBase64(str source)`
 
**Пример** <br> `ConvertToBase64("Hello world!")` <br> Возвращает "SABlAGwAbABvACAAdwBvAHIAbABkACEA".
 
 


----------
### ConvertToUTF8Hex

**Описание**<br> Функция ConvertToUTF8Hex преобразует значение в значение в шестнадцатеричной кодировке UTF8.
 
**Синтаксис**<br> `str ConvertToUTF8Hex(str source)`
 
**Примечания**<br> Azure Active Directory использует формат вывода этой функции в качестве формата атрибута различающегося имени.
 
**Пример** <br> `ConvertToUTF8Hex("Hello world!")` <br> Возвращает 48656C6C6F20776F726C6421.
 
 


----------
### Count

**Описание**<br> Функция Count возвращает количество элементов в атрибуте с несколькими значениями.
 
**Синтаксис** <br> `num Count(mvstr attribute)`
 



----------
### CNum

**Описание**<br> Функция CNum принимает строку и возвращает числовые данные.
 
**Синтаксис** <br> `num CNum(str value)`
 



----------
### CRef

**Описание** <br> Преобразует строку в ссылочный атрибут.
 
**Синтаксис** <br> `ref CRef(str value)`
 
**Пример** <br> `CRef(“CN=LC Services,CN=Microsoft,CN=lcspool01, CN=Pools,CN=RTC Service,” & %Forest.LDAP%)`
 
 


----------
### CStr

**Описание** <br> Функция CStr преобразует данные в строковый тип данных.
 
**Синтаксис** <br> `str CStr(num value)` <br> `str CStr(ref value)` <br> `str CStr(bool value)` <br>

- value: может быть числовым значением, ссылочным атрибутом или логическим значением. 
 
**Пример** <br> `CStr([dn]) <br>` Может вернуть "cn=Joe,dc=contoso,dc=com".
 
 


----------
### DateAdd

**Описание** <br> Возвращает значение Date, содержащее дату, к которой добавлен указанный временной интервал.
 
**Синтаксис** <br> `dt DateAdd(str interval, num value, dt date)`

- interval: строковое выражение, определяющее интервал времени, который нужно добавить. Строка должна иметь одно из следующих значений:
 - yyyy год
 - q квартал
 - m месяц
 - y день года
 - d день
 - w день недели
 - ww неделя
 - h час
 - n минута
 - s секунда
- value: количество единиц измерения, которое нужно добавить. Это значение может быть положительным (для получения дат в будущем) или отрицательным (для получения дат в прошлом). 
- date: значение DateTime, представляющее собой дату, к которой добавлен интервал.
 
**Пример** <br> `DateAdd("m", 3, CDate("2001-01-01"))` <br> Добавляет 3 месяца и возвращает значение DateTime "2001-04-01".
 
 


----------
### DateFromNum

**Описание** <br> Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.
 
**Синтаксис** <br> `dt DateFromNum(num value)`
 
**Пример** <br> `DateFromNum([lastLogonTimestamp])` <br> `DateFromNum(129699324000000000)` <br> Возвращает значение DateTime, равное "2012-01-01 23:00:00".
 



----------
### DNComponent

**Описание** <br> Функция DNComponent возвращает значение указанного компонента различающегося имени начиная с левого края.
 
**Синтаксис** <br> `str DNComponent(ref dn, num ComponentNumber)`

- dn: ссылочный атрибут для интерпретации.
- ComponentNumber: компонент в различающемся имени для возврата.
 
**Пример** <br> `DNComponent([dn],1)` <br> Если значение dn равно "cn=Joe,ou=…" функция возвращает "Joe".
 



----------
### DNComponentRev

**Описание** <br> Функция DNComponentRev возвращает значение указанного компонента различающегося имени начиная с правого края (с конца).
 
**Синтаксис** <br> `str DNComponentRev(ref dn, num ComponentNumber)` <br> `str DNComponentRev(ref dn, num ComponentNumber, enum Options)`

- dn: ссылочный атрибут для интерпретации.
- ComponentNumber: компонент в различающемся имени для возврата.
- Options: DC — игнорировать все компоненты с «dc=».
 
**Пример** <br> `If dn is “cn=Joe,ou=Atlanta,ou=GA,ou=US, dc=contoso,dc=com” then DNComponentRev([dn],3)` <br> `DNComponentRev([dn],1,”DC”)` <br> Оба возвращают значение "US".
 
 


----------
### Ошибка

**Описание** <br> Функция Error используется для возвращения пользовательских ошибок.
 
**Синтаксис** <br> `void Error(str ErrorMessage)`
 
**Пример** <br> `IIF(IsPresent([accountName]),[accountName],Error(“AccountName is required”))` <br> Если атрибут accountName атрибут отсутствует, в объекте возникает ошибка.
 
 


----------
### EscapeDNComponent

**Описание** <br> Функция EscapeDNComponent принимает один компонент различающегося имени и экранирует его таким образом, чтобы он мог быть представлены в виде LDAP.
 
**Синтаксис** <br> `str EscapeDNComponent(str value)`
 
**Пример** <br> `EscapeDNComponent(“cn=” & [displayName]) & “,” & %ForestLDAP%` <br> Убедитесь, что объект может быть создан в каталоге LDAP, даже если атрибут displayName содержит символы, которые необходимо экранировать в LDAP.
 
 


----------
### FormatDateTime

**Описание** <br> Функция FormatDateTime используется для форматирования значения DateTime в строку в указанном формате.
 
**Синтаксис** <br> `str FormatDateTime(dt value, str format)`

- value: значение в формате DateTime.<br>
- format: строка, представляющая формат для преобразования.
 
**Примечания** <br> Возможные значения для формата представлены здесь: [User-Defined Date/Time Formats (Format Function)](http://msdn2.microsoft.com/library/73ctwf33(VS.90).aspx).
 
**Пример** <br>
 
`FormatDateTime(CDate(“12/25/2007”),”yyyy-mm-dd”)` <br> Результат: «2007-12-25».

`FormatDateTime(DateFromNum([pwdLastSet]),”yyyyMMddHHmmss.0Z”)` <br> Может вернуть результат «20140905081453.0Z».
 
 


----------
### GUID

**Описание** <br> Функция GUID создает новый случайный идентификатор GUID.
 
**Синтаксис** <br> `str GUID()`
 



----------
### IIF

**Описание** <br> Функция IIF возвращает один из наборов возможных значений на основе заданного условия.
 
**Синтаксис** <br> `var IIF(exp condition, var valueIfTrue, var valueIfFalse)`

- condition: любое значение или выражение, которое может принять значение true или false.
- valueIfTrue: значение, возвращаемое, если условие принимает значение true.
- valueIfFalse: значение, возвращаемое, если условие принимает значение false.

**Пример** <br> `IIF([employeeType]=“Intern”,”t-“&[alias],[alias])` <br> Возвращает псевдоним пользователя с префиксом «t-», если пользователь является интерном, иначе возвращает псевдоним пользователя как есть.
 
 


----------
### InStr

**Описание** <br> Функция InStr находит первое вхождение подстроки в строке.
 
**Синтаксис** <br>
 
`num InStr(str stringcheck, str stringmatch)` <br> `num InStr(str stringcheck, str stringmatch, num start)` <br> `num InStr(str stringcheck, str stringmatch, num start , enum compare)`

- stringcheck: строка для поиска. <br>
- stringmatch: строка, которая должна быть найдена. <br>
- start: начальная позиция для поиска подстроки. <br>
- compare: vbTextCompare или vbBinaryCompare.
 
**Примечания** <br> Возвращает позицию, в которой найдена подстрока, или значение «0», если подстрока не найдена.

**Пример** <br> `InStr("The quick brown fox","quick")` <br> Принимает значение «5».

`InStr("repEated","e",3,vbBinaryCompare)` <br> Принимает значение «7».
 
 


----------
### InStrRev

**Описание** <br> Функция InStrRev находит последнее вхождение подстроки в строке.
 
**Синтаксис** <br> `num InstrRev(str stringcheck, str stringmatch)` <br> `num InstrRev(str stringcheck, str stringmatch, num start)` <br> `num InstrRev(str stringcheck, str stringmatch, num start, enum compare)`

- stringcheck: строка для поиска. <br>
- stringmatch: строка, которая должна быть найдена. <br>
- start: начальная позиция для поиска подстроки. <br>
- compare: vbTextCompare или vbBinaryCompare.

**Примечания** <br> Возвращает позицию, в которой найдена подстрока, или значение «0», если подстрока не найдена.

**Пример** <br> `InStrRev("abbcdbbbef","bb")` <br> Возвращает значение «7».
 
 


----------
### IsBitSet

**Описание** <br> Функция IsBitSet проверяет, задан ли бит.
 
**Синтаксис** <br> `bool IsBitSet(num value, num flag)`

- value: числовое значение, которое представляет собой evaluated.flag, т. е. числовое значение, которое имеет бит для вычисления.
 
**Пример** <br> `IsBitSet(&HF,4)` <br> Возвращает значение True, так как для бита «4» задано шестнадцатеричное значение F.
 



----------
### IsDate

**Описание** <br> Функция IsDate возвращает значение True, если выражение может быть числовым значением типа DateTime.
 
**Синтаксис** <br> `bool IsDate(var Expression)`
 
**Примечания** <br> Используется для определения, будет ли функция CDate() выполнена успешно.
 



----------
###IsEmpty

**Описание** <br> Функция IsEmpty возвращает значение True, если атрибут присутствует в CS или MV, но результатом вычисления является пустая строка.
 
**Синтаксис** <br> `bool IsEmpty(var Expression)`
 



----------
###IsGuid

**Описание**<br> Функция IsGuid возвращает значение True, если строку можно преобразовать в идентификатор GUID.
 
**Синтаксис** <br> `bool IsGuid(str GUID)`
 
**Примечания** <br> GUID представляет собой строку, созданную по одному из этих шаблонов: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx или {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}.

Используется для определения, будет ли функция CGuid() выполнена успешно.
 
**Пример** <br> `IIF(IsGuid([strAttribute]),CGuid([strAttribute]),NULL)` <br> Если StrAttribute имеет формат GUID, возвращается двоичное представление идентификатора, если нет — возвращается значение Null.
 
 


----------
###IsNull

**Описание** <br> Функция IsNull возвращает значение True, если выражение принимает значение Null.
 
**Синтаксис** <br> `bool IsNull(var Expression)`
 
**Примечания** <br> Значение Null для атрибута выражается в отсутствии атрибута.
 
**Пример** <br> `IsNull([displayName])` <br> Возвращает значение True, если атрибут не присутствует в CS или MV.
 
 


----------
###IsNullOrEmpty

**Описание** <br> Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение Null или является пустой строкой.
 
**Синтаксис** <br> `bool IsNullOrEmpty(var Expression)`
 
**Примечания** <br> Для атрибута это значение было бы True, если бы атрибут отсутствовал или присутствовал, но являлся пустой строкой.<br> Обратной функцией этой функции является IsPresent.
 
**Пример** <br> `IsNull([displayName])` <br> Возвращает значение True, если атрибут не присутствует или является пустой строкой в CS или MV.
 
 


----------
### IsNumeric

**Описание** <br> Функция IsNumeric возвращает логическое значение, указывающее, можно ли вычислить выражение как числовой тип.
 
**Синтаксис** <br> `bool IsNumeric(var Expression)`
 
**Примечания** <br> Используется для определения, сможет ли функция CNum() успешно проанализировать выражение.




----------
### IsString

**Описание** <br> Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.
 
**Синтаксис** <br> `bool IsString(var expression)`
 
**Примечания** <br> Используется для определения, сможет ли функция CStr() успешно проанализировать выражение.
 



----------
### IsPresent

**Описание** <br> Функция IsPresent возвращает значение True, если выражение принимает значение строки, которая не имеет значение Null и не является пустой.
 
**Синтаксис** <br> `bool IsPresent(var expression)`
 
**Примечания** <br> Обратной функцией этой функции является IsNullOrEmpty.
 
**Пример** <br>
 
`Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])`
  



----------
### Элемент

**Описание** <br> Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.
 
**Синтаксис** <br> `var Item(mvstr attribute, num index)`

- attribute: атрибут с несколькими значениями. <br>
- index: индекс элемента в строке с несколькими значениями.
 
**Примечания** <br> Функция Item используется вместе с функцией Contains, поскольку последняя функция возвращает индекс элементу в атрибуте с несколькими значениями.

Вызывает ошибку, если индекс выходит за допустимые пределы.
 
**Пример** <br> `Mid(Item([proxyAddress],Contains([proxyAddress], ”SMTP:”)),6)` <br> Возвращает основной адрес электронной почты.
 
 


----------
### ItemOrNull

**Описание** <br> Функция ItemOrNull возвращает один элемент из строки или атрибута с несколькими значениями.
 
**Синтаксис** <br> `var ItemOrNull(mvstr attribute, num index)`

- attribute: атрибут с несколькими значениями. <br>
- index: индекс элемента в строке с несколькими значениями.
 
**Примечания** <br> Функция ItemOrNull используется вместе с функцией Contains, поскольку последняя функция возвращает индекс элементу в атрибуте с несколькими значениями.

Возвращает значение Null, если индекс выходит за допустимые пределы.
 



----------
### Join

**Описание** <br> Функция Join принимает строку с несколькими значениями и возвращает строку с одним значением с указанным разделителем между элементами.
 
**Синтаксис** <br> `str Join(mvstr attribute)` <br> `str Join(mvstr attribute, str Delimiter)`

- attribute: атрибут с несколькими значениями, содержащий строки для объединения. <br>
- delimiter: строка, используемая для разделения подстрок в составе возвращаемой строки. Если аргумент опущен, используется знак пробела (« »). Если разделитель является строкой нулевой длины («») или Nothing, все элементы списка объединяются без разделителей.
 
**Примечания** <br> Join и Split выполняют похожие функции. Функция Join принимает массив строк и объединяет их, используя строку-разделитель, чтобы вернуть одну строку. Функция Split принимает строку и разделяет ее по разделителям, чтобы вернуть массив строк. Эти функции различаются тем, что Join может объединять строки с любой строкой-разделителем, а Split может разделять строки с помощью одного символа-разделителя.
 
**Пример** <br> `Join([proxyAddresses],”,”)` <br> Может вернуть: SMTP:john.doe@contoso.com,smtp:jd@contoso.com”.
 
 


----------
### LCase

**Описание** <br> Функция LCase преобразует все символы в строке в нижний регистр.
 
**Синтаксис** <br> `str LCase(str value)`
 
**Пример** <br> `LCase(“TeSt”)` <br> Возвращает значение Test.
 
 


----------
### Left

**Описание** <br> Функция Left возвращает указанное количество символов из левой части строки.
 
**Синтаксис** <br> `str Left(str string, num NumChars)`

- string: строка, из которой возвращаются символы. <br>
- NumChars: число, определяющее количество символов для возврата из начала строки (слева).
 
**Примечания** <br> Строка, содержащая первые numChars символов в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).
 
**Пример** <br> `Left(“John Doe”, 3)` <br> Возвращает значение Joh.
 



----------
### Len

**Описание** <br> Функция Len возвращает количество символов в строке.
 
**Синтаксис** <br> `num Len(str value)`
 
**Пример** <br> `Len(“John Doe”)` <br> Возвращает значение «8».
 



----------
### LTrim

**Описание** <br> Функция LTrim удаляет пробелы в начале строки.
 
**Синтаксис** <br> `str LTrim(str value)`
 
**Пример** <br> `LTrim(“ Test ”)` <br> Возвращает значение Test.
 
 


----------
### Mid

**Описание** <br> Функция Mid возвращает указанное количество символов из указанной позиции строки.
 
**Синтаксис** <br> `str Mid(str string, num start, num NumChars)`

- string: строка, из которой возвращаются символы. <br>
- start: число, определяющее начальную позицию в строке для возврата символов из нее.
- NumChars: число, определяющее количество символов для возврата из позиции строки.
 

**Примечания** <br> Возвращает символы numChars, начиная с позиции start в строке.<br> Строка, содержащая numChars символов начиная с позиции start в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если start > длины строки, возвращается строка ввода;
- если start < = 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если в строке не осталось numChar символов начиная с позиции start, возвращается столько символов, сколько может быть возвращено.
 
**Пример** <br>
 
`Mid(“John Doe”, 3, 5)` <br> Возвращает значение hn Do.

`Mid(“John Doe”, 6, 999)` <br> Возвращает значение Doe.
 
 


----------
### Now

**Описание** <br> Функция Now возвращает значение DateTime, обозначающее текущую дату и время, установленные на компьютере.
 
**Синтаксис** <br> `dt Now()`
 



----------
### NumFromDate

**Описание** <br> Функция NumFromDate возвращает дату в формате даты AD.
 
**Синтаксис** <br> `num NumFromDate(dt value)`
 

**Пример** <br> `NumFromDate(CDate("2012-01-01 23:00:00"))` <br> Возвращает значение «129699324000000000».
 
 


----------
### PadLeft

**Описание** <br> Функция PadLeft функции заполняет строку слева до заданной длины с помощью предоставленного знака заполнения.
 
**Синтаксис** <br> `str PadLeft(str string, num length, str padCharacter)`

- string: строка для заполнения. <br>
- length: целое число, представляющее требуемую длину строки. <br>
- padCharacter: строка, состоящая из одного символа, используемого в качестве символа заполнения.
 


----------
### Примечания 
 
- Если длина строки меньше length, значение padCharacter многократно добавляется в начало (слева) строки, пока длина строки не будет равна length.
- Значение padCharacter может быть символом пробела, но оно не может иметь значение Null.
- Если длина строки равна или больше length, строка возвращается без изменений.
- Если длина строка больше или равна length, строка также возвращается без изменений.
- Если длина строки меньше length, возвращается новая строка требуемой длины, содержащая строку, дополненную padCharacter.
- Если строка имеет значение Null, функция возвращает пустую строку.

**Пример** <br> `PadLeft(“User”, 10, “0”)` <br> Возвращает 000000User.
 
 


----------
### PadRight

**Описание** <br> Функция PadRight заполняет строку справа до заданной длины с помощью предоставленного знака заполнения.
 
**Синтаксис** <br> `str PadRight(str string, num length, str padCharacter)`

- string: строка для заполнения. 
- length: целое число, представляющее требуемую длину строки.
- padCharacter: строка, состоящая из одного символа, используемого в качестве символа заполнения.
 
**Примечания.**
 
- Если длина строки меньше length, значение padCharacter многократно добавляется в конец (справа) строки, пока длина строки не будет равна length.
- Значение padCharacter может быть символом пробела, но оно не может иметь значение Null.
- Если длина строки равна или больше length, строка возвращается без изменений.
- Если длина строка больше или равна length, строка также возвращается без изменений.
- Если длина строки меньше length, возвращается новая строка требуемой длины, содержащая строку, дополненную padCharacter.
- Если строка имеет значение Null, функция возвращает пустую строку.
 

**Пример** <br> `PadRight(“User”, 10, “0”)` <br> Возвращает значение User000000.
 
 


----------
### PCase

**Описание** <br> Функция PCase преобразует в верхний регистр первый символ каждого слова, отделенного пробелами, а все остальные символы преобразуются в нижний регистр.
 
**Синтаксис** <br> `String PCase(string)`
 
**Пример** <br> `PCase(“TEsT”)` <br> Возвращает значение Test.
 
 


----------
### RandomNum

**Описание**<br> Функция RandomNum возвращает случайное число между заданными интервалами времени.
 
**Синтаксис** <br> `num RandomNum(num start, num end)`

- start: число, определяющее нижний предел случайного значения, которое нужно создать. <br>
- end: число, определяющее верхний предел случайного значения для создания.
 
**Пример** <br> `Random(100,999)` <br> Возвращает значение «734».
 
 


----------
### RemoveDuplicates

**Описание**<br> Функция RemoveDuplicates принимает строку с несколькими значениями и контролирует, чтобы каждое значение было уникальным.
 
**Синтаксис** <br> `mvstr RemoveDuplicates(mvstr attribute)`
 
**Пример** <br> `RemoveDuplicates([proxyAddresses])` <br> Возвращает подчищенный атрибут proxyAddress, из которого удалены все повторяющиеся значения.
 
 


----------
### Замените

**Описание** <br> Функция Replace заменяет все вхождения строки в другую строку.
 
**Синтаксис** <br> `str Replace(str string, str OldValue, str NewValue)`

- string: строка, в которой заменяются значения. <br>
- OldValue: строка для поиска и замены. <br>
- NewValue: строка для замены.
 

**Примечания** <br> Функция распознает следующие специальные моникеры:

- \\n — новая строка; 
- \\r — возврат каретки;
- \\t – символ табуляции.
 

**Пример** <br>
 
`Replace([address],”\r\n”,”, “)` <br> Заменяет CRLF запятой и пробелом, может привести к значению One Microsoft Way, Redmond, WA, USA.
 
 


----------
### ReplaceChars

**Описание** <br> Функция ReplaceChars заменяет все вхождения символов, найденных в строке ReplacePattern.

**Синтаксис** <br> `str ReplaceChars(str string, str ReplacePattern)`

- string: строка, в которой заменяются значения.
- ReplacePattern: строка, содержащая словарь с символами для замены. 
 
Формат строки: {source1}: {target1}, {source2}: {target2}, {sourceN}, {targetN}, где source — это символ для поиска, а target — строка для замены.
 

**Примечания:**
 
- Функция принимает каждое вхождение определенных источников и заменяет их целевыми объектами. 
- Источник должен состоять из ровно одного символа (в кодировке Юникод). 
- Источник не может быть пустым или длиннее одного символа (ошибка разбора).
- Целевой объект может иметь несколько символов, например ö:oe, β:ss.
- Целевой объект может быть пустым, это будет означать, что символ должен быть удален. 
- В источнике учитывается регистр, который должен точно совпадать.
- Символы «,» (запятая) и «:» (двоеточие) являются зарезервированными символами и не могут быть заменены с помощью этой функции. 
- Пробелы и другие разделители в строке ReplacePattern игнорируются.
 

**Пример**<br> '%ReplaceString% = ’:,Å:A,Ä:A,Ö:O,å:a,ä:a,ö,o'

`ReplaceChars(”Räksmörgås”,%ReplaceString%)` <br> Возвращает значение Raksmorgas.

`ReplaceChars(“O’Neil”,%ReplaceString%)` <br> Возвращает значение ONeil, апостроф определяется как символ для удаления.
 



----------
### Right

**Описание** <br> Функция Right возвращает указанное количество символов из правой части (в конце) строки.
 
**Синтаксис** <br> `str Right(str string, num NumChars)`

- string: строка, из которой возвращаются символы. 
- NumChars: число, определяющее количество символов для возврата из конца строки (справа).
 
**Примечания**<br> NumChars символов возвращаются из позиции last строки.

Строка, содержащая последние numChars символов в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений.

**Пример** <br> `Right(“John Doe”, 3)` <br> Возвращает значение Doe.
 



----------
### RTrim

**Описание** <br> Функция RTrim удаляет пробелы в конце строки.
 
**Синтаксис** <br> `str RTrim(str value)`

**Пример** <br> `RTrim(“ Test ”)` <br> Возвращает значение Test.




----------
### Разбить

**Описание** <br> Функция Split принимает строку с разделителями и преобразует ее в строку с несколькими значениями.
 

**Синтаксис** <br> `mvstr Split(str value, str delimiter)` <br? `mvstr Split(str value, str delimiter, num limit)`

- value: строка с символом разделителя для разделения.
- delimiter: один символ, используемый в качестве разделителя. 
- limit: максимальное количество значений, которые будут возвращены.
 
**Пример** <br> `Split(“SMTP:john.doe@contoso.com,smtp:jd@contoso.com”,”,”)` <br> Возвращает строку с несколькими значениями с двумя элементами, которые используются для атрибута proxyAddress.
 



----------
### StringFromGuid

**Описание**<br> Функция StringFromGuid принимает двоичный идентификатор GUID и преобразует его в строку.
 
**Синтаксис** <br> `str StringFromGuid(bin GUID)`
 



----------
### StringFromSid

**Описание**<br> Функция StringFromSid преобразует массив байтов или массив байтов с несколькими значениями, содержащий идентификатор безопасности, в строку или строки с несколькими значениями.
 
**Синтаксис** <br> `str StringFromSid(bin ObjectSID)` <br> `mvstr StringFromSid(mvbin ObjectSID)`
 



----------
### Switch

**Описание**<br> Функция Switch используется для возвращения одного значения на основе вычисленных условий.

**Синтаксис** <br> `var Switch(exp expr1, var value1[, exp expr2, var value … [, exp expr, var valueN]])`

- expr: выражение типа Variant, которое нужно вычислить. 
- value: значение, которое должно быть возвращено, если соответствующее выражение имеет значение True.
 
**Примечания**<br> Список аргументов функции Switch состоит из пар выражений и значений. Выражения вычисляются слева направо, и возвращается значение, связанное с первым выражением, которое получает значение True. Если части неправильно распределены по парам, возникает ошибка среды выполнения.

Например, если expr1 имеет значение True, функция Switch возвращает value1. Если expr-1 имеет значение False, а expr-2 — True функция Switch возвращает значение value-2 и т. д.

Функция Switch возвращает Nothing при таких условиях: – ни одно из выражений не имеет значение True; – первое значение True имеет соответствующее значение, равное Null.

Функция Switch вычисляет все выражения, хотя возвращает только одно из них. Поэтому необходимо следить за нежелательными побочными эффектами. Например, если в результате вычисления выражения получится деление на ноль, возвращается ошибка.

Значение также может быть функцией Error, которая возвращает настраиваемую строку.

**Пример** <br> `Switch([city] = "London", "English", [city] = "Rome", "Italian", [city] = "Paris", "French", True, Error(“Unknown city”))` <br> Возвращает язык, на котором говорят в некоторых крупных городах, или возвращает ошибку.




----------
### Trim

**Описание** <br> Функция Trim удаляет пробелы в начале и конце строки.
 
**Синтаксис** <br> `str Trim(str value)` <br> `mvstr Trim(mvstr value)`
 
**Пример** <br> `Trim(“ Test ”)` <br> Возвращает значение Test.

`Trim([proxyAddresses])` <br> Удаляет начальные и конечные пробелы для каждого значения в атрибуте proxyAddress.




----------
### UCase

**Описание** <br> Функция UCase преобразует все символы в строке в верхний регистр.

**Синтаксис** <br> `str UCase(str string)`
 
**Пример** <br> `UCase(“TeSt”)` <br> Возвращает значение Test.
 
 


----------
### Word

**Описание**<br> Функция Word возвращает слова внутри строки с учетом параметров, описывающих разделители и количество слов для возврата.
 
**Синтаксис** <br> `str Word(str string, num WordNumber, str delimiters)`

- string: строка, из которой возвращаются слова.
- WordNumber: число, определяющее количество слов, которые должны быть возвращены. 
- delimiters: строка, представляющая разделители, которые должны использоваться для идентификации слов.
 
**Примечания** <br> Каждая строка символов в строке, разделенных одним из символов-разделителей, определяется как слово:

- если number < 1, возвращается пустая строка;
- если string имеет значение Null, возвращается пустая строка.

Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.
 

**Пример** <br> `Word(“The quick brown fox”,3,” “)` <br> Возвращает значение brown.

`Word(“This,string!has&many seperators”,3,”,!&#”)` <br> Возвратит слово has.


## Дополнительные ресурсы

* [Знакомство с выражениями декларативной подготовки.](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md)
* [Azure AD Connect Sync: настройка параметров синхронизации](active-directory-aadconnectsync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md)
 
 
<!--Image references-->

<!---HONumber=August15_HO7-->