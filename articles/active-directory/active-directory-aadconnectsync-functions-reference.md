<properties
	pageTitle="Служба синхронизации Azure AD Connect: справочник по функциям | Microsoft Azure"
	description="Общие сведения о выражениях декларативной подготовки в Azure AD Connect Sync"
	services="active-directory"
	documentationCenter=""
	authors="andkjell"
	manager="StevenPo"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="03/07/2016"
	ms.author="andkjell;markusvi"/>


# Синхронизация Azure AD Connect: справочник по функциям


В службе Azure Active Directory Sync функции используются для обработки значения атрибута во время синхронизации. Синтаксис функций выражается в следующем формате: `<output type> FunctionName(<input type> <position name>, ..)`

Если функция перегружена и принимает несколько вариантов синтаксиса, перечисляются все допустимые варианты синтаксиса. Функции являются строго типизированными и контролируют, чтобы переданный тип соответствовал задокументированному типу. Если тип не совпадает, выводится сообщение об ошибке.

Типы выражаются с помощью следующего синтаксиса:

- **bin** – двоичное значение
- **bool** — логическое значение
- **dt** — дата и время в формате UTC
- **enum** — перечисление известных констант
- **exp** — выражение, которое должно преобразовываться в логическое значение
- **mvbin** — двоичное значение с несколькими значениями
- **mvstr** — ссылка с несколькими значениями
- **num** — числовое значение
- **ref** — ссылка с одним значением
- **str** — строка с одним значением
- **var** — вариант (почти) любого другого типа
- **void** — не возвращает значение



## Справочник по функциям

----------
**Преобразование:**

[CBool](#cbool) &nbsp;&nbsp;&nbsp;&nbsp; [CDate](#cdate) &nbsp;&nbsp;&nbsp;&nbsp; [CGuid](#cguid) &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; [ConvertFromBase64](#convertfrombase64) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertToBase64](#converttobase64) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertFromUTF8Hex](#convertfromutf8hex) &nbsp;&nbsp;&nbsp;&nbsp; [ConvertToUTF8Hex](#converttoutf8hex) &nbsp;&nbsp;&nbsp;&nbsp; [CNum](#cnum) &nbsp;&nbsp;&nbsp;&nbsp; [CRef](#cref) &nbsp;&nbsp;&nbsp;&nbsp; [CStr](#cstr) &nbsp;&nbsp;&nbsp;&nbsp; [StringFromGuid](#StringFromGuid) &nbsp;&nbsp;&nbsp;&nbsp; [StringFromSid](#stringfromsid)

**Дата/время:**

[DateAdd](#dateadd) &nbsp;&nbsp;&nbsp;&nbsp; [DateFromNum](#datefromnum) &nbsp;&nbsp;&nbsp;&nbsp; [FormatDateTime](#formatdatetime) &nbsp;&nbsp;&nbsp;&nbsp; [Now](#now) &nbsp;&nbsp;&nbsp;&nbsp; [NumFromDate](#numfromdate)

**Каталог**

[DNComponent](#dncomponent) &nbsp;&nbsp;&nbsp;&nbsp; [DNComponentRev](#dncomponentrev) &nbsp;&nbsp;&nbsp;&nbsp; [EscapeDNComponent](#escapedncomponent)

**Оценка:**

[IsBitSet](#isbitset) &nbsp;&nbsp;&nbsp;&nbsp; [IsDate](#isdate) &nbsp;&nbsp;&nbsp;&nbsp; [IsEmpty](#isempty) &nbsp;&nbsp;&nbsp;&nbsp; [IsGuid](#isguid) &nbsp;&nbsp;&nbsp;&nbsp; [IsNull](#isnull) &nbsp;&nbsp;&nbsp;&nbsp; [IsNullOrEmpty](#isnullorempty) &nbsp;&nbsp;&nbsp;&nbsp; [IsNumeric](#isnumeric) &nbsp;&nbsp;&nbsp;&nbsp; [IsPresent](#ispresent) &nbsp;&nbsp;&nbsp;&nbsp; [IsString](#isstring)

**Математические функции:**

[BitAnd](#bitand) &nbsp;&nbsp;&nbsp;&nbsp; [BitOr](#bitor) &nbsp;&nbsp;&nbsp;&nbsp; [RandomNum](#randomnum)

**Функции с несколькими значениями:**

[Contains](#contains) &nbsp;&nbsp;&nbsp;&nbsp; [Count](#count) &nbsp;&nbsp;&nbsp;&nbsp; [Item](#item) &nbsp;&nbsp;&nbsp;&nbsp; [ItemOrNull](#itemornull) &nbsp;&nbsp;&nbsp;&nbsp; [Join](#join) &nbsp;&nbsp;&nbsp;&nbsp; [RemoveDuplicates](#removeduplicates) &nbsp;&nbsp;&nbsp;&nbsp; [Split](#split)

**Функции программного потока:**

[Error](#error) &nbsp;&nbsp;&nbsp;&nbsp; [IIF](#iif) &nbsp;&nbsp;&nbsp;&nbsp; [Switch](#switch)


**текст**

[GUID](#guid) &nbsp;&nbsp;&nbsp;&nbsp; [InStr](#instr) &nbsp;&nbsp;&nbsp;&nbsp; [InStrRev](#instrrev) &nbsp;&nbsp;&nbsp;&nbsp; [LCase](#lcase) &nbsp;&nbsp;&nbsp;&nbsp; [Left](#left) &nbsp;&nbsp;&nbsp;&nbsp; [Len](#len) &nbsp;&nbsp;&nbsp;&nbsp; [LTrim](#ltrim) &nbsp;&nbsp;&nbsp;&nbsp; [Mid](#mid) &nbsp;&nbsp;&nbsp;&nbsp; [PadLeft](#padleft) &nbsp;&nbsp;&nbsp;&nbsp; [PadRight](#padright) &nbsp;&nbsp;&nbsp;&nbsp; [PCase](#pcase) &nbsp;&nbsp;&nbsp;&nbsp; [Replace](#replace) &nbsp;&nbsp;&nbsp;&nbsp; [ReplaceChars](#replacechars) &nbsp;&nbsp;&nbsp;&nbsp; [Right](#right) &nbsp;&nbsp;&nbsp;&nbsp; [RTrim](rtrim) &nbsp;&nbsp;&nbsp;&nbsp; [Trim](#trim) &nbsp;&nbsp;&nbsp;&nbsp; [UCase](#ucase) &nbsp;&nbsp;&nbsp;&nbsp; [Word](#word)

----------
### BitAnd

**Описание.** Функция BitAnd задает конкретное значение для битов.

**Синтаксис** `num BitAnd(num value1, num value2)`

- value1, value2: числовые значения, которые должны быть соединены оператором AND.

**Примечания.** Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита следующие значения:

- 0 — если один или оба соответствующих бита в *маске* и *флаге* равны 0;
- 1 — если оба соответствующих бита равны 1.

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.

**Пример.** `BitAnd(&HF, &HF7)` Возвращает 7, поскольку шестнадцатеричные "F" и "F7" преобразовываются в это значение.

----------
### BitOr

**Описание.** Функция BitOr задает конкретное значение для битов.

**Синтаксис** `num BitOr(num value1, num value2)`

- value1, value2: числовые значения, которые должны быть соединены оператором OR.

**Примечания.** Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита значение 1, если один или оба соответствующих бита в маске и флаге равны 1, и устанавливает значение 0, если оба соответствующих бита равны 0. Другими словами, функция возвращает значение 1 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 0.

----------
### CBool

**Описание.** Функция CBool возвращает логическое значение на основе вычисленного выражения.

**Синтаксис** `bool CBool(exp Expression)`

**Примечания.** Если выражение преобразуется в ненулевое значение, функция CBool возвращает значение True, в противном случае она возвращает значение False.

**Пример** `CBool([attrib1] = [attrib2])`

Возвращает значение True, если оба атрибута имеют одинаковое значение.

----------
### CDate

**Описание.** Функция CDate возвращает из строки значение даты и времени в формате UTC. DateTime не является собственным типом атрибута синхронизации, но используется некоторыми функциями.

**Синтаксис** `dt CDate(str value)`

- Value: строка с датой, временем и (необязательно) часовым поясом.

**Примечания.** Строка всегда возвращается в формате UTC.

**Пример.** `CDate([employeeStartTime])` Возвращает объект DateTime с учетом времени начала работы сотрудника.

`CDate("2013-01-10 4:00 PM -8")` Возвращает объект DateTime, представляющий значение "2013-01-11 12:00 AM".

----------
### CGuid

**Описание.** Функция CGuid преобразует строковое представление идентификатора GUID в двоичное представление.

**Синтаксис** `bin CGuid(str GUID)`

- Строка отформатирована по следующему шаблону: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx или {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}

----------
### Содержит

**Описание.** Функция Contains находит строку внутри атрибута с несколькими значениями.

**Синтаксис.** `num Contains (mvstring attribute, str search)` — с учетом регистра `num Contains (mvstring attribute, str search, enum Casetype)` `num Contains (mvref attribute, str search)` — с учетом регистра

- attribute: атрибут с несколькими значениями для поиска.<br>
- search: строка для поиска в атрибуте.<br>
- Casetype: без учета регистра или с учетом регистра.<br>

Возвращает индекс в атрибут с несколькими значениями, в котором найдена строка. Если строка не найдена, возвращается 0.

**Примечания.** Для атрибутов со строкой с несколькими значениями search будет искать подстроки в значениях. Чтобы считаться соответствием в ссылочном атрибуте, искомая строка должна точно соответствовать значению.

**Пример.** `IIF(Contains([proxyAddresses],"SMTP:")>0,[proxyAddresses],Error("No primary SMTP address found."))` Если атрибут proxyAddresses имеет основной адрес электронной почты (обозначается буквами в верхнем регистре "SMTP:"), возвращается атрибут proxyAddress, в противном случае возвращается сообщение об ошибке.

----------
### ConvertFromBase64

**Описание.** Функция ConvertFromBase64 преобразует значение в кодировке Base64 в обычную строку.

**Синтаксис.** `str ConvertFromBase64(str source)` — здесь предполагается кодирование Юникод <br> `str ConvertFromBase64(str source, enum Encoding)`

- source: строка в кодировке Base64  
- Encoding: Юникод, ASCII, UTF8

**Пример** `ConvertFromBase64("SABlAGwAbABvACAAdwBvAHIAbABkACEA")` `ConvertFromBase64("SGVsbG8gd29ybGQh", UTF8)`

Оба примера возвращают сообщение "*Hello world!*".

----------
### ConvertFromUTF8Hex

**Описание.** Функция ConvertFromUTF8Hex преобразует значение в шестнадцатеричной кодировке UTF8 в обычную строку.

**Синтаксис** `str ConvertFromUTF8Hex(str source)`

- source: строка в двухбайтовой кодировке UTF8.

**Примечания.** Эта функция отличается от функции ConvertFromBase64(,UTF8) тем, что ее результат является понятным для атрибута различающегося имени. Azure Active Directory использует этот формат в качестве различающегося имени.

**Пример.** `ConvertFromUTF8Hex("48656C6C6F20776F726C6421")` Возвращает сообщение "*Hello world!*".

----------
### ConvertToBase64

**Описание.** Функция ConvertToBase64 преобразует строку в строку в кодировке base64 Юникода. Преобразует значение массива целых чисел в эквивалентное строковое представление в кодировке знаков base64.

**Синтаксис** `str ConvertToBase64(str source)`

**Пример.** `ConvertToBase64("Hello world!")` Возвращает "SABlAGwAbABvACAAdwBvAHIAbABkACEA".

----------
### ConvertToUTF8Hex

**Описание.** Функция ConvertToUTF8Hex преобразует значение в шестнадцатеричной кодировке UTF8.

**Синтаксис** `str ConvertToUTF8Hex(str source)`

**Примечания.** Azure Active Directory использует формат вывода этой функции в качестве формата атрибута различающегося имени.

**Пример.** `ConvertToUTF8Hex("Hello world!")` Возвращает 48656C6C6F20776F726C6421.

----------
### Count

**Описание.** Функция Count возвращает количество элементов в атрибуте с несколькими значениями.

**Синтаксис** `num Count(mvstr attribute)`

----------
### CNum

**Описание.** Функция CNum принимает строку и возвращает числовой тип данных.

**Синтаксис** `num CNum(str value)`

----------
### CRef

**Описание.** Преобразует строку в ссылочный атрибут.

**Синтаксис** `ref CRef(str value)`

**Пример** `CRef("CN=LC Services,CN=Microsoft,CN=lcspool01,CN=Pools,CN=RTC Service," & %Forest.LDAP%)`

----------
### CStr

**Описание.** Функция CStr преобразует данные в строковый тип данных.

**Синтаксис.** `str CStr(num value)` `str CStr(ref value)` `str CStr(bool value)`

- value: может быть числовым значением, ссылочным атрибутом или логическим значением.

**Пример.** `CStr([dn])` Может вернуть "cn=Joe,dc=contoso,dc=com".

----------
### DateAdd

**Описание.** Возвращает значение Date, содержащее дату, к которой добавлен указанный временной интервал.

**Синтаксис** `dt DateAdd(str interval, num value, dt date)`

- interval: строковое выражение, определяющее интервал времени, который нужно добавить. Строка должна иметь одно из следующих значений:
 - yyyy год
 - q квартал
 - m месяц
 - y день года
 - d день
 - w день недели
 - ww неделя
 - h час
 - n минута
 - s секунда
- value: количество единиц измерения, которое нужно добавить. Это значение может быть положительным (для получения дат в будущем) или отрицательным (для получения дат в прошлом).
- date: значение DateTime, представляющее собой дату, к которой добавлен интервал.

**Пример.** `DateAdd("m", 3, CDate("2001-01-01"))` Добавляет 3 месяца и возвращает значение DateTime "2001-04-01".

----------
### DateFromNum

**Описание.** Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.

**Синтаксис** `dt DateFromNum(num value)`

**Пример.** `DateFromNum([lastLogonTimestamp])` `DateFromNum(129699324000000000)` Возвращает значение DateTime, равное "2012-01-01 23:00:00".

----------
### DNComponent

**Описание.** Функция DNComponent возвращает значение указанного компонента различающегося имени начиная с левого края.

**Синтаксис** `str DNComponent(ref dn, num ComponentNumber)`

- dn: ссылочный атрибут для интерпретации.
- ComponentNumber: компонент в различающемся имени для возврата.

**Пример.** `DNComponent([dn],1)` Если значение различающегося имени равно "cn=Joe,ou=…", функция возвращает "Joe".

----------
### DNComponentRev

**Описание.** Функция DNComponentRev возвращает значение указанного компонента различающегося имени начиная с правого края (с конца).

**Синтаксис:** `str DNComponentRev(ref dn, num ComponentNumber)` `str DNComponentRev(ref dn, num ComponentNumber, enum Options)`

- dn: ссылочный атрибут для интерпретации.
- ComponentNumber: компонент в различающемся имени для возврата.
- Options: DC — игнорировать все компоненты с "dc=".

**Пример.** Если различающееся имя —"cn=Joe,ou=Atlanta,ou=GA,ou=US, dc=contoso,dc=com", `DNComponentRev([dn],3)` `DNComponentRev([dn],1,"DC")` оба вернут "США".

----------
### Ошибка

**Описание.** Функция Error используется для возвращения пользовательских ошибок.

**Синтаксис** `void Error(str ErrorMessage)`

**Пример.** `IIF(IsPresent([accountName]),[accountName],Error("AccountName is required"))` Если атрибут accountName отсутствует, в объекте возникает ошибка.

----------
### EscapeDNComponent

**Описание.** Функция EscapeDNComponent принимает один компонент различающегося имени и экранирует его таким образом, чтобы он мог быть представлен в виде LDAP.

**Синтаксис** `str EscapeDNComponent(str value)`

**Пример.** `EscapeDNComponent("cn=" & [displayName]) & "," & %ForestLDAP%)` Убедитесь, что объект может быть создан в каталоге LDAP, даже если атрибут displayName содержит символы, которые необходимо экранировать в LDAP.

----------
### FormatDateTime

**Описание.** Функция FormatDateTime используется для форматирования значения DateTime в строку в указанном формате.

**Синтаксис** `str FormatDateTime(dt value, str format)`

- value: значение в формате DateTime
- format: строка, представляющая формат для преобразования.

**Примечания.** Возможные значения для формата представлены здесь: [Определяемые пользователем форматы даты и времени (функция Format)](http://msdn2.microsoft.com/library/73ctwf33(VS.90).aspx).

**Пример**

`FormatDateTime(CDate("12/25/2007"),"yyyy-mm-dd")` Результат: "2007-12-25".

`FormatDateTime(DateFromNum([pwdLastSet]),"yyyyMMddHHmmss.0Z")` Может вернуть результат "20140905081453.0Z".

----------
### GUID

**Описание.** Функция GUID создает новый случайный идентификатор GUID.

**Синтаксис** `str GUID()`

----------
### IIF

**Описание.** Функция IIF возвращает один из наборов возможных значений на основе заданного условия.

**Синтаксис** `var IIF(exp condition, var valueIfTrue, var valueIfFalse)`

- condition: любое значение или выражение, которое может принять значение true или false.
- valueIfTrue: значение, возвращаемое, если условие принимает значение true.
- valueIfFalse: значение, возвращаемое, если условие принимает значение false.

**Пример.** `IIF([employeeType]="Intern","t-" & [alias],[alias])` Возвращает псевдоним пользователя с префиксом "t-", если пользователь является интерном, иначе возвращает псевдоним пользователя как есть.

----------
### InStr

**Описание.** Функция InStr находит первое вхождение подстроки в строке.

**Синтаксис**

`num InStr(str stringcheck, str stringmatch)` `num InStr(str stringcheck, str stringmatch, num start)` `num InStr(str stringcheck, str stringmatch, num start , enum compare)`

- stringcheck: строка для поиска
- stringmatch: строка, которая должна быть найдена
- start: начальная позиция для поиска подстроки
- compare: vbTextCompare или vbBinaryCompare.

**Примечания.** Возвращает позицию, в которой найдена подстрока, или значение "0", если подстрока не найдена.

**Пример.** `InStr("The quick brown fox","quick")` Принимает значение "5".

`InStr("repEated","e",3,vbBinaryCompare)` Принимает значение "7".

----------
### InStrRev

**Описание.** Функция InStrRev находит последнее вхождение подстроки в строке.

**Синтаксис.** `num InstrRev(str stringcheck, str stringmatch)` `num InstrRev(str stringcheck, str stringmatch, num start)` `num InstrRev(str stringcheck, str stringmatch, num start, enum compare)`

- stringcheck: строка для поиска
- stringmatch: строка, которая должна быть найдена
- start: начальная позиция для поиска подстроки
- compare: vbTextCompare или vbBinaryCompare.

**Примечания.** Возвращает позицию, в которой найдена подстрока, или значение "0", если подстрока не найдена.

**Пример.** `InStrRev("abbcdbbbef","bb")` Возвращает значение "7".

----------
### IsBitSet

**Описание.** Функция IsBitSet проверяет, задан ли бит.

**Синтаксис** `bool IsBitSet(num value, num flag)`

- value: числовое значение, которое представляет собой evaluated.flag, т. е. числовое значение, которое имеет бит для вычисления.

**Пример.** `IsBitSet(&HF,4)` Возвращает значение True, поскольку для бита "4" задано шестнадцатеричное значение "F".

----------
### IsDate

**Описание.** Функция IsDate возвращает значение True, если выражение может быть числовым значением типа DateTime.

**Синтаксис** `bool IsDate(var Expression)`

**Примечания.** Используется для определения, будет ли функция CDate() выполнена успешно.

----------
### IsEmpty

**Описание.** Функция IsEmpty возвращает значение True, если атрибут присутствует в CS или MV, но результатом вычисления является пустая строка.

**Синтаксис** `bool IsEmpty(var Expression)`

----------
### IsGuid

**Описание.** Функция IsGuid возвращает значение True, если строку можно преобразовать в идентификатор GUID.

**Синтаксис** `bool IsGuid(str GUID)`

**Примечания.** GUID представляет собой строку, созданную по одному из этих шаблонов: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx или {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}.

Используется для определения, будет ли функция CGuid() выполнена успешно.

**Пример.** `IIF(IsGuid([strAttribute]),CGuid([strAttribute]),NULL)` Если StrAttribute имеет формат GUID, возвращается двоичное представление идентификатора, если нет — возвращается значение NULL.

----------
### IsNull

**Описание.** Функция IsNull возвращает значение True, если выражение принимает значение NULL.

**Синтаксис** `bool IsNull(var Expression)`

**Примечания.** Значение NULL для атрибута выражается в отсутствии атрибута.

**Пример.** `IsNull([displayName])` Возвращает значение True, если атрибут не присутствует в CS или MV.

----------
### IsNullOrEmpty

**Описание.** Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение NULL или является пустой строкой.

**Синтаксис** `bool IsNullOrEmpty(var Expression)`

**Примечания.** Для атрибута это значение было бы True, если бы атрибут отсутствовал или присутствовал, но являлся пустой строкой.<br> Обратной функцией этой функции является IsPresent.

**Пример.** `IsNullOrEmpty([displayName])` Возвращает значение True, если атрибут не присутствует или является пустой строкой в CS или MV.

----------
### IsNumeric

**Описание.** Функция IsNumeric возвращает логическое значение, указывающее, можно ли вычислить выражение как числовой тип.

**Синтаксис** `bool IsNumeric(var Expression)`

**Примечания.** Используется для определения, сможет ли функция CNum() успешно проанализировать выражение.

----------
### IsString

**Описание.** Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.

**Синтаксис** `bool IsString(var expression)`

**Примечания.** Используется для определения, сможет ли функция CStr() успешно проанализировать выражение.

----------
### IsPresent

**Описание.** Функция IsPresent возвращает значение True, если выражение принимает значение строки, которая не имеет значение NULL и не является пустой.

**Синтаксис** `bool IsPresent(var expression)`

**Примечания.** Обратной функцией этой функции является IsNullOrEmpty.

**Пример** `Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])`

----------
### Элемент

**Описание.** Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.

**Синтаксис** `var Item(mvstr attribute, num index)`

- attribute: атрибут с несколькими значениями
- index: индекс элемента в строке с несколькими значениями.

**Примечания.** Функция Item используется вместе с функцией Contains, поскольку последняя функция возвращает индекс элементу в атрибуте с несколькими значениями.

Вызывает ошибку, если индекс выходит за допустимые пределы.

**Пример.** `Mid(Item([proxyAddress],Contains([proxyAddress], "SMTP:")),6)` Возвращает основной адрес электронной почты.

----------
### ItemOrNull

**Описание.** Функция ItemOrNull возвращает один элемент из строки или атрибута с несколькими значениями.

**Синтаксис** `var ItemOrNull(mvstr attribute, num index)`

- attribute: атрибут с несколькими значениями
- index: индекс элемента в строке с несколькими значениями.

**Примечания.** Функция ItemOrNull используется вместе с функцией Contains, поскольку последняя функция возвращает индекс элементу в атрибуте с несколькими значениями.

Возвращает значение Null, если индекс выходит за допустимые пределы.

----------
### Join

**Описание.** Функция Join принимает строку с несколькими значениями и возвращает строку с одним значением с указанным разделителем между элементами.

**Синтаксис** `str Join(mvstr attribute)` `str Join(mvstr attribute, str Delimiter)`

- attribute: атрибут с несколькими значениями, содержащий строки для объединения.
- delimiter: строка, используемая для разделения подстрок в составе возвращаемой строки. Если аргумент опущен, используется знак пробела (« »). Если разделитель является строкой нулевой длины («») или Nothing, все элементы списка объединяются без разделителей.

**Примечания.** Join и Split выполняют похожие функции. Функция Join принимает массив строк и объединяет их, используя строку-разделитель, чтобы вернуть одну строку. Функция Split принимает строку и разделяет ее по разделителям, чтобы вернуть массив строк. Эти функции различаются тем, что Join может объединять строки с любой строкой-разделителем, а Split может разделять строки с помощью одного символа-разделителя.

**Пример.** `Join([proxyAddresses],",")` Может вернуть: "SMTP:john.doe@contoso.com,smtp:jd@contoso.com"

----------
### LCase

**Описание.** Функция LCase преобразует все символы в строке в нижний регистр.

**Синтаксис** `str LCase(str value)`

**Пример.** `LCase("TeSt")` Возвращает значение "test".

----------
### Left

**Описание.** Функция Left возвращает указанное количество символов из левой части строки.

**Синтаксис** `str Left(str string, num NumChars)`

- string: строка, из которой возвращаются символы.
- NumChars: число, определяющее количество символов для возврата из начала строки (слева).

**Примечания.** Строка, содержащая первые numChars символов в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).

**Пример.** `Left("John Doe", 3)` Возвращает значение "Joh".

----------
### Len

**Описание.** Функция Len возвращает количество символов в строке.

**Синтаксис** `num Len(str value)`

**Пример.** `Len("John Doe")` Возвращает значение "8".

----------
### LTrim

**Описание.** Функция LTrim удаляет пробелы в начале строки.

**Синтаксис** `str LTrim(str value)`

**Пример.** `LTrim(" Test ")` Возвращает значение "Test".

----------
### Mid

**Описание.** Функция Mid возвращает указанное количество символов из указанной позиции строки.

**Синтаксис** `str Mid(str string, num start, num NumChars)`

- string: строка, из которой возвращаются символы.
- start: число, определяющее начальную позицию в строке для возврата символов из нее.
- NumChars: число, определяющее количество символов для возврата из позиции строки.

**Примечания.** Возвращает символы numChars, начиная с позиции start в строке. Строка, содержащая numChars символов начиная с позиции start в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если start > длины строки, возвращается строка ввода;
- если start < = 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если в строке не осталось numChar символов начиная с позиции start, возвращается столько символов, сколько может быть возвращено.

**Пример.** `Mid("John Doe", 3, 5)` Возвращает значение "hn Do".

`Mid("John Doe", 6, 999)` Возвращает значение "Doe".

----------
### Now

**Описание.** Функция Now возвращает значение DateTime, обозначающее текущую дату и время, установленные на компьютере.

**Синтаксис** `dt Now()`

----------
### NumFromDate

**Описание.** Функция NumFromDate возвращает дату в формате даты AD.

**Синтаксис** `num NumFromDate(dt value)`

**Пример.** `NumFromDate(CDate("2012-01-01 23:00:00"))` Возвращает значение "129699324000000000".

----------
### PadLeft

**Описание.** Функция PadLeft функции заполняет строку слева до заданной длины с помощью предоставленного знака заполнения.

**Синтаксис** `str PadLeft(str string, num length, str padCharacter)`

- string: строка для заполнения.
- length: целое число, представляющее требуемую длину строки.
- padCharacter: строка, состоящая из одного символа, используемого в качестве символа заполнения.

**Примечания:**

- Если длина строки меньше length, значение padCharacter многократно добавляется в начало (слева) строки, пока длина строки не будет равна length.
- Значение padCharacter может быть символом пробела, но оно не может иметь значение Null.
- Если длина строки равна или больше length, строка возвращается без изменений.
- Если длина строка больше или равна length, строка также возвращается без изменений.
- Если длина строки меньше length, возвращается новая строка требуемой длины, содержащая строку, дополненную padCharacter.
- Если строка имеет значение Null, функция возвращает пустую строку.

**Пример.** `PadLeft("User", 10, "0")` Возвращает значение "000000User".

----------
### PadRight

**Описание.** Функция PadRight заполняет строку справа до заданной длины с помощью предоставленного знака заполнения.

**Синтаксис** `str PadRight(str string, num length, str padCharacter)`

- string: строка для заполнения.
- length: целое число, представляющее требуемую длину строки.
- padCharacter: строка, состоящая из одного символа, используемого в качестве символа заполнения.

**Примечания.**

- Если длина строки меньше length, значение padCharacter многократно добавляется в конец (справа) строки, пока длина строки не будет равна length.
- Значение padCharacter может быть символом пробела, но оно не может иметь значение Null.
- Если длина строки равна или больше length, строка возвращается без изменений.
- Если длина строка больше или равна length, строка также возвращается без изменений.
- Если длина строки меньше length, возвращается новая строка требуемой длины, содержащая строку, дополненную padCharacter.
- Если строка имеет значение Null, функция возвращает пустую строку.

**Пример.** `PadRight("User", 10, "0")` Возвращает значение "User000000".

----------
### PCase

**Описание.** Функция PCase преобразует в верхний регистр первый символ каждого слова, отделенного пробелами, а все остальные символы преобразуются в нижний регистр.

**Синтаксис** `String PCase(string)`

**Пример.** `PCase("TEsT")` Возвращает значение "Test".

----------
### RandomNum

**Описание.** Функция RandomNum возвращает случайное число между заданными интервалами времени.

**Синтаксис** `num RandomNum(num start, num end)`

- start: число, определяющее нижний предел случайного значения, которое нужно создать.
- end: число, определяющее верхний предел случайного значения для создания.

**Пример.** `Random(100,999)` Может вернуть значение "734".

----------
### RemoveDuplicates

**Описание.** Функция RemoveDuplicates принимает строку с несколькими значениями и контролирует, чтобы каждое значение было уникальным.

**Синтаксис** `mvstr RemoveDuplicates(mvstr attribute)`

**Пример.** `RemoveDuplicates([proxyAddresses])` Возвращает подчищенный атрибут proxyAddress, из которого удалены все повторяющиеся значения.

----------
### Замените

**Описание.** Функция Replace заменяет все вхождения строки в другую строку.

**Синтаксис** `str Replace(str string, str OldValue, str NewValue)`

- string: строка, в которой заменяются значения.
- OldValue: строка для поиска и замены.
- NewValue: строка для замены.

**Примечания.** Функция распознает следующие специальные моникеры:

- \\n — новая строка;
- \\r — возврат каретки;
- \\t – символ табуляции.

**Пример.** `Replace([address],"\r\n",", ")` Заменяет CRLF запятой и пробелом, может привести к значению "One Microsoft Way, Redmond, WA, USA".

----------
### ReplaceChars

**Описание.** Функция ReplaceChars заменяет все вхождения символов, найденных в строке ReplacePattern.

**Синтаксис** `str ReplaceChars(str string, str ReplacePattern)`

- string: строка, в которой заменяются значения.
- ReplacePattern: строка, содержащая словарь с символами для замены.

Формат строки: {source1}: {target1}, {source2}: {target2}, {sourceN}, {targetN}, где source — это символ для поиска, а target — строка для замены.

**Примечания:**

- Функция принимает каждое вхождение определенных источников и заменяет их целевыми объектами.
- Источник должен состоять из ровно одного символа (в кодировке Юникод).
- Источник не может быть пустым или длиннее одного символа (ошибка разбора).
- Целевой объект может иметь несколько символов, например ö:oe, β:ss.
- Целевой объект может быть пустым, это будет означать, что символ должен быть удален.
- В источнике учитывается регистр, который должен точно совпадать.
- Символы «,» (запятая) и «:» (двоеточие) являются зарезервированными символами и не могут быть заменены с помощью этой функции.
- Пробелы и другие разделители в строке ReplacePattern игнорируются.

**Пример** `%ReplaceString% = ’:,Å:A,Ä:A,Ö:O,å:a,ä:a,ö,o`

`ReplaceChars("Räksmörgås",%ReplaceString%)` Возвращает значение "Raksmorgas".

`ReplaceChars("O’Neil",%ReplaceString%)` Возвращает значение "ONeil", апостроф определен как символ для удаления.

----------
### Right

**Описание.** Функция Right возвращает указанное количество символов из правой части (в конце) строки.

**Синтаксис** `str Right(str string, num NumChars)`

- string: строка, из которой возвращаются символы.
- NumChars: число, определяющее количество символов для возврата из конца строки (справа).

**Примечания.** Символы NumChars возвращаются из последней позиции строки.

Строка, содержащая последние numChars символов в строке:

- если numChars = 0, возвращается пустая строка;
- если numChars < 0, возвращается введенная строка;
- если строка имеет значение Null, возвращается пустая строка.

Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений.

**Пример.** `Right("John Doe", 3)` Возвращает значение "Doe".

----------
### RTrim

**Описание.** Функция RTrim удаляет пробелы в конце строки.

**Синтаксис** `str RTrim(str value)`

**Пример.** `RTrim(" Test ")` Возвращает значение " Test".

----------
### Разбить

**Описание.** Функция Split принимает строку с разделителями и преобразует ее в строку с несколькими значениями.

**Синтаксис** `mvstr Split(str value, str delimiter)` `mvstr Split(str value, str delimiter, num limit)`

- value: строка с символом разделителя для разделения.
- delimiter: один символ, используемый в качестве разделителя.
- limit: максимальное количество значений, которые будут возвращены.

**Пример.** `Split("SMTP:john.doe@contoso.com,smtp:jd@contoso.com",",")` Возвращает строку с несколькими значениями с двумя элементами, которые используются для атрибута proxyAddress.

----------
### StringFromGuid

**Описание.** Функция StringFromGuid принимает двоичный идентификатор GUID и преобразует его в строку.

**Синтаксис** `str StringFromGuid(bin GUID)`

----------
### StringFromSid

**Описание.** Функция StringFromSid преобразует массив байтов или массив байтов с несколькими значениями, содержащий идентификатор безопасности, в строку или строки с несколькими значениями.

**Синтаксис** `str StringFromSid(bin ObjectSID)` `mvstr StringFromSid(mvbin ObjectSID)`

----------
### Switch

**Описание.** Функция Switch используется для возвращения одного значения на основе вычисленных условий.

**Синтаксис** `var Switch(exp expr1, var value1[, exp expr2, var value … [, exp expr, var valueN]])`

- expr: выражение типа Variant, которое нужно вычислить.
- value: значение, которое должно быть возвращено, если соответствующее выражение имеет значение True.

**Примечания.** Список аргументов функции Switch состоит из пар выражений и значений. Выражения вычисляются слева направо, и возвращается значение, связанное с первым выражением, которое получает значение True. Если части неправильно распределены по парам, возникает ошибка среды выполнения.

Например, если expr1 имеет значение True, функция Switch возвращает value1. Если expr-1 имеет значение False, а expr-2 — True функция Switch возвращает значение value-2 и т. д.

Функция Switch возвращает Nothing при таких условиях:

- ни одно из выражений не имеет значение True;
- первое значение True имеет соответствующее значение, равное NULL.

Функция Switch вычисляет все выражения, хотя возвращает только одно из них. Поэтому необходимо следить за нежелательными побочными эффектами. Например, если в результате вычисления выражения получится деление на ноль, возвращается ошибка.

Значение также может быть функцией Error, которая возвращает настраиваемую строку.

**Пример.** `Switch([city] = "London", "English", [city] = "Rome", "Italian", [city] = "Paris", "French", True, Error("Unknown city"))` Возвращает язык, на котором говорят в некоторых крупных городах, или ошибку.

----------
### Trim

**Описание.** Функция Trim удаляет пробелы в начале и конце строки.

**Синтаксис** `str Trim(str value)` `mvstr Trim(mvstr value)`

**Пример.** `Trim(" Test ")` Возвращает значение "Test".

`Trim([proxyAddresses])` Удаляет начальные и конечные пробелы для каждого значения в атрибуте proxyAddress.

----------
### UCase

**Описание.** Функция UCase преобразует все символы в строке в верхний регистр.

**Синтаксис** `str UCase(str string)`

**Пример.** `UCase("TeSt")` Возвращает значение "TEST".

----------
### Word

**Описание.** Функция Word возвращает слова внутри строки с учетом параметров, описывающих разделители и количество слов для возврата.

**Синтаксис** `str Word(str string, num WordNumber, str delimiters)`

- string: строка, из которой возвращаются слова.
- WordNumber: число, определяющее количество слов, которые должны быть возвращены.
- delimiters: строка, представляющая разделители, которые должны использоваться для идентификации слов.

**Примечания.** Каждая строка символов в строке, разделенных одним из символов-разделителей, определяется как слово:

- если number < 1, возвращается пустая строка;
- если string имеет значение Null, возвращается пустая строка.

Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.

**Пример.** `Word("The quick brown fox",3," ")` Возвращает значение "brown".

`Word("This,string!has&many separators",3,",!&#")` Вернет "has".

## Дополнительные ресурсы

* [Знакомство с выражениями декларативной подготовки.](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md)
* [Azure AD Connect Sync: настройка параметров синхронизации](active-directory-aadconnectsync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md)

<!---HONumber=AcomDC_0309_2016-->