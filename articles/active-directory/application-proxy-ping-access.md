---
title: "PingAccess для прокси приложения Azure AD | Документация Майкрософт"
description: "Публикация приложений с использованием PingAccess и прокси приложения для реализации аутентификации на основе заголовка."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/21/2017
ms.author: kgremban
translationtype: Human Translation
ms.sourcegitcommit: 9553c9ed02fa198d210fcb64f4657f84ef3df801
ms.openlocfilehash: 173607c481d0ba7ceece6310fcd131ff622a0677
ms.lasthandoff: 03/23/2017

---

# <a name="publish-applications-that-support-header-based-authentication-with-pingaccess-for-azure-ad"></a>Публикация приложений с поддержкой аутентификации на основе заголовка с использованием PingAccess для Azure AD

Прокси приложения Active Directory и Azure PingAccess можно использовать для предоставления пользователям Azure Active Directory доступа к разным приложениям. PingAccess позволяет включить в [существующие предложения прокси приложения](active-directory-application-proxy-get-started.md) возможность удаленного доступа к приложениям, в которых используется аутентификация на основе заголовков. 

## <a name="what-is-pingaccess-for-azure-ad"></a>Что такое PingAccess для Azure AD?

Чтобы предоставить пользователям доступ к приложениям, в которых используется аутентификация на основе заголовков, вы можете опубликовать приложение, обеспечив возможность удаленного доступа к нему с помощью PingAccess и прокси приложения. Прокси приложения обрабатывает такие приложения, как и любые другие, используя Azure AD для аутентификации доступа и передавая трафик через службу соединителя. PingAccess находится перед приложением, преобразуя маркер доступа из Azure AD в заголовок. Таким образом приложение может выполнять аутентификацию в поддерживаемом формате. 

При этом при получении доступа к корпоративным приложениям пользователи не заметят никаких отличий в процедуре входа. Они по-прежнему смогут работать в любом расположении и на любом устройстве. Когда ваши пользователи в офисе, ни прокси приложения, ни PingAccess не перехватывают трафик, поэтому пользователи могут работать как обычно.

Так как соединители прокси приложения направляют удаленный трафик во все приложения независимо от поддерживаемого типа аутентификации, они также будут продолжать выполнять балансировку нагрузки. 

## <a name="how-do-i-get-access"></a>Как мне получить доступ?

Так как этот сценарий предоставляется при совместном использовании Azure Active Directory и PingAccess, вам понадобятся лицензии для двух этих служб. Так как подписки на Azure Active Directory Premium включают лицензию на PingAccess начального уровня, вы сможете настроить до 20 приложений. 

Дополнительные сведения см. в разделе [Выпуски Azure Active Directory](active-directory-editions.md).

## <a name="publish-your-first-application"></a>Публикация первого приложения

Эта статья предназначена для пользователей, которые еще не публиковали приложения. В ней рассказывается, как приступить к работе с прокси приложения и PingAccess, а также описываются этапы публикации. Если вы уже настроили обе службы, но хотите выполнить инструкции по публикации, вы можете пропустить два раздела, посвященные регистрации.

>[!NOTE]
>Так как этот сценарий предполагает совместное использование Azure AD и PingAccess, некоторые инструкции доступны на сайте Ping Identity. 

### <a name="install-an-application-proxy-connector"></a>Установка соединителя прокси приложения

Если вы уже включили прокси приложения и установили соединитель, эти действия можно пропустить.

Соединитель прокси приложения — это служба Windows Server, которая направляет трафик, поступающий от удаленных сотрудников к опубликованным приложениям. Дополнительные сведения об установке см. в статье [Включение прокси приложения на портале Azure](active-directory-application-proxy-enable.md).

1. Войдите на [портал Azure](https://portal.azure.com) как глобальный администратор. 
2. Выберите **Azure Active Directory** > **Прокси приложения**.
3. Щелкните **Скачать соединитель**, чтобы начать скачивание соединителя прокси приложения. Выполните инструкции по установке. 
4. После скачивания соединитель должен автоматически включить прокси приложения для каталога. В противном случае щелкните **Включить прокси приложения**. 

![Включение прокси приложения и скачивание соединителя](./media/application-proxy-ping-access/install-connector.png)

### <a name="add-your-app-to-azure-ad-with-application-proxy"></a>Добавление приложения в Azure AD с помощью прокси приложения

Этот раздел состоит из двух частей. Во-первых, вам нужно опубликовать приложение в Azure AD. Затем об этом приложении вам нужно собрать некоторые сведения, которые можно использовать при работе с PingAccess. 

#### <a name="publish-the-app"></a>Публикация приложения

1. Войдите на [портал Azure](https://portal.azure.com) как глобальный администратор, если вы не сделали это ранее. 
2. Выберите **Azure Active Directory** > **Корпоративные приложения**. 
3. Щелкните **Добавить** в верхней части колонки. 
4. Выберите **Локальное приложение**.
5. Введите в обязательные поля сведения о новом приложении. Вам нужно настроить следующие параметры.
  - **Внутренний URL-адрес** — обычно для приложения указывается URL-адрес страницы входа, на которую вы будете переходить во время работы в корпоративной сети. Для такого взаимодействия соединителю необходимо считать прокси-сервер PingAccess титульной страницей приложения. Используйте следующий формат: `https://<host name of your PA server>:<port>/<App path name>`. Порт 3000 используется по умолчанию, но его можно настроить в PingAccess.
  - **Метод предварительной аутентификации** — выберите Azure Active Directory.
  - **Преобразование URL-адреса в заголовок** — выберите значение "Нет".
6. Щелкните **Добавить** в нижней части колонки. Когда приложение будет добавлено, откроется меню быстрого запуска. 
7. В меню быстрого запуска выберите **Назначить пользователя для тестирования**, а затем назначьте для приложения хотя бы одного пользователя. Убедитесь, что у тестовой учетной записи есть доступ к локальному приложению. 
8. Щелкните **Назначить**, чтобы сохранить назначение тестового пользователя. 
9. В колонке управления приложением щелкните **Единый вход**. 
10. В раскрывающемся меню выберите **Единый вход на основе заголовка**. Щелкните **Сохранить**.

  ![Выбор единого входа на основе заголовка](./media/application-proxy-ping-access/sso-header.PNG)

11. Закройте колонку корпоративных приложений или прокрутите влево, чтобы вернуться в меню Azure Active Directory. 
12. Щелкните **Регистрация приложений**.
13. Выберите только что добавленное приложение и укажите **URL-адреса ответа**. 
14. Убедитесь, что в списке URL-адресов ответа отображается внешний URL-адрес, назначенный приложению на шаге 5. В противном случае добавьте этот URL-адрес. 
15. В колонке параметров приложения щелкните **Требуемые разрешения**. 
16. Выберите **Добавить**. В качестве API укажите **Windows Azure Active Directory** и щелкните **Выбрать**. В качестве разрешений укажите **Чтение и запись всех приложений** и **Вход и чтение профиля пользователя**, а затем щелкните **Выбрать** и **Готово**.  

  ![Выбор разрешений](./media/application-proxy-ping-access/select-permissions.png) 

#### <a name="collect-information-for-the-pingaccess-steps"></a>Сбор сведений об этапах PingAccess

1. В колонке параметров приложения щелкните **Свойства**. Сохраните значение **идентификатора приложения**. Оно используется в качестве идентификатора клиента при настройке PingAccess.
2. В колонке параметров щелкните **Ключи**. 
3. Создайте ключ. Для этого в раскрывающемся меню введите описание ключа и выберите дату окончания срока его действия. 
4. Щелкните **Сохранить**. В поле **Значение** отобразится идентификатор GUID. 

  Сохраните это значение. Закрыв это окно, вы больше не сможете его увидеть. 

5. Закройте колонку регистрации приложений или прокрутите влево, чтобы вернуться в меню Azure Active Directory.
6. Выберите **Свойства**.
7. Сохраните **идентификатор каталога** (GUID). 

### <a name="download-pingaccess-and-configure-your-app"></a>Скачивание PingAccess и настройка приложения

См. подробные инструкции по [настройке PingAccess для работы с Azure AD](https://docs.pingidentity.com/bundle/paaad_m_ConfigurePAforMSAzureADSolution_paaad43/page/pa_c_PAAzureSolutionOverview.html) в рамках этого сценария в документации по Ping Identity.

В этом руководстве описывается, как получить учетную запись PingAccess (если у вас ее еще нет), установить сервер PingAccess и создать подключение к поставщику Azure AD OIDC с использованием идентификатора каталога, скопированного на портале Azure. Затем с использованием ключа и идентификатора приложения вы создадите веб-сеанс PingAccess. После этого вы сможете настроить сопоставление удостоверений и создать виртуальный узел, сайт и приложение.

### <a name="test-your-app"></a>Тестирование приложения

Когда вы завершите выполнение этих шагов, ваше приложение будет настроено и запущено. Чтобы протестировать его, откройте браузер и перейдите по внешнему URL-адресу, созданному при публикации приложения в Azure. Войдите с помощью тестовой учетной записи, назначенной приложению. 

## <a name="next-steps"></a>Дальнейшие действия

- [Устранение неполадок прокси-сервера приложений](active-directory-application-proxy-troubleshoot.md)

