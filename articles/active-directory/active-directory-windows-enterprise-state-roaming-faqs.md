<properties
	pageTitle="Часто задаваемые вопросы о перемещении параметров и данных | Microsoft Azure"
	description="В статье содержится информация о синхронизации параметров и данных приложений, которая может быть полезной для ИТ-администраторов."
	services="active-directory"
    keywords="параметры enterprise state roaming, облако windows, часто задаваемые вопросы о решении enterprise state roaming"
	documentationCenter=""
	authors="femila"
	manager="stevenpo"
	editor="curtand"/>

<tags
	ms.service="active-directory"  
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="02/03/2016"
	ms.author="femila"/>

# Часто задаваемые вопросы о перемещении параметров и данных

В этой статье содержится информация о синхронизации параметров и данных приложений, которая может быть полезной для ИТ-администраторов.

## Какие данные перемещаются?
**Параметры Windows**: параметры компьютера, встроенные в операционную систему Windows. В целом, эти параметры позволяют настроить компьютер в соответствии с предпочтениями пользователя. Они включают такие основные категории:

- **Тема**: тема рабочего стола, параметры панели задач и т. д. 
- **Параметры Internet Explorer**: недавно открытые вкладки, избранное и т. д.
- **Параметры браузера Edge**: избранное, список для чтения.
- **Пароли**: пароли для доступа в Интернет, профили Wi-Fi и т. д. 
- **Языковые параметры**: раскладки клавиатуры, системный язык, дата, время и т. д. 
- **Специальные возможности**: высококонтрастная тема, экранный диктор, экранная лупа и т. д. 
- **Другие параметры Windows**: параметры командной строки, список приложений и т. д. 

**Данные приложений**: универсальные приложения Windows могут записывать данные параметров в папку Roaming. Все данные, записанные в эту папку, будут автоматически синхронизироваться. Такую возможность можно предусмотреть для приложения еще на этапе его проектирования. Дополнительные сведения о разработке универсальных приложений Windows с поддержкой перемещения см. в статье об [API хранилища данных приложения](https://msdn.microsoft.com/library/windows/apps/mt299098.aspx) и в блоге разработчиков Windows 8 о [перемещении данных приложения](http://blogs.msdn.com/b/windowsappdev/archive/2012/07/17/roaming-your-app-data.aspx).

## Какая учетная запись используется для синхронизации параметров?
В Windows 8 и Windows 8.1 при синхронизации параметров всегда использовались учетные записи Майкрософт. Корпоративные пользователи могли настроить синхронизацию параметров, подключив учетную запись Майкрософт к учетной записи домена Active Directory. В Windows 10 вместо приема с подключением учетной записи Майкрософт используются основная и дополнительная учетная записи.
 
Основная учетная запись — это учетная запись, используемая для входа в Windows. Это может быть учетная запись Майкрософт, учетная запись Azure Active Directory (Azure AD), учетная запись локальной службы Active Directory или локальная учетная запись. Кроме основной учетной записи пользователи Windows 10 могут добавить в своем устройстве одну или несколько дополнительных облачных учетных записей. Дополнительными учетными записями могут быть учетная запись Майкрософт, Azure Active Directory или другая (например, Gmail или Facebook). Хотя такие учетные записи и предоставляют доступ к дополнительным функциям и службам, включая единый вход и Магазин Windows, они не поддерживают синхронизацию параметров.

В Windows 10 для синхронизации параметров используется только основная учетная запись на устройстве (исключения см. в разделе "Как перейти от синхронизации параметров учетной записи Майкрософт в Windows 8 к синхронизации параметров Azure AD в Windows 10?").

Данные разных учетных записей на одном устройстве никогда не смешиваются. Есть два правила синхронизации параметров: 1) параметры Windows всегда перемещаются с использованием основной учетной записи; 2) в данные приложения добавляется информация об учетной записи, которая использовалась для получения приложения. Синхронизироваться будут данные только тех приложений, которые содержат информацию об основной учетной записи. Принадлежность приложения к той или иной учетной записи определяется при его установке из Магазина Windows или загрузке с помощью средств управления мобильными устройствами (MDM).

Если определить принадлежность приложения не удается, для перемещения данных используется основная учетная запись. Как правило, большинство приложений загружаются из Магазина Windows, а до версии Windows 10 учетные записи Azure AD не поддерживали работу с Магазином Windows. Поэтому, если ОС на устройстве обновить с версии Windows 8 или Windows 8.1 до версии Windows 10, все приложения будут отнесены к учетной записи Майкрософт. Если приложение устанавливается в автономном режиме с использованием лицензии, приложение будет отнесено к основной учетной записи на устройстве.

>[AZURE.NOTE]  
Возможность подключить учетную запись Майкрософт к учетной записи домена для синхронизации всех данных пользователя с учетной записью Майкрософт (перемещение данных в учетной записи Майкрософт посредством ее подключения к учетной записи Active Directory) не поддерживается на устройствах с Windows 10, подключенных к среде Active Directory или Azure AD.
 
## Как перейти от синхронизации параметров учетной записи Майкрософт в Windows 8 к синхронизации параметров Azure AD в Windows 10?
Когда пользователь Windows 8 или Windows 8.1 подключается к домену Active Directory с помощью своей учетной записи Майкрософт, синхронизация параметров выполняется с помощью этой учетной записи. После обновления до Windows 10 параметры подключенного к домену пользователя будут и дальше синхронизироваться через учетную запись Майкрософт при условии, что домен Active Directory не подключен к Azure AD. Если локальный домен Active Directory подключен к Azure AD, устройство пользователя будет пытаться синхронизировать параметры с помощью подключенной учетной записи Azure AD. Если администратор Azure AD не включит службу Enterprise State Roaming, пользователи с подключенной учетной записью Azure AD не смогут синхронизировать параметры. После включения синхронизации параметров через Azure AD пользователи Windows 10, которые входят в систему с удостоверением Azure AD, сразу же начнут синхронизировать параметры Windows с помощью Azure AD.

Пользователям, которые хранят личные данные на своих корпоративных устройствах, следует помнить, что параметры Windows и данные приложений будут синхронизироваться в среду Azure AD. Это связано со следующими факторами. 1) Параметры личных учетных записей Майкрософт будут со временем отличаться от параметров соответствующих рабочих или учебных учетных записей Azure AD, так как для синхронизации параметров учетных записей Майкрософт и Azure AD теперь используются отдельные учетные записи. 2) Личные данные, включая пароли Wi-Fi, данные для доступа в Интернет, а также избранное и вкладки, хранимые в браузере Internet Explorer, которые ранее синхронизировались через подключенную учетную запись Майкрософт, теперь будут синхронизироваться через Azure AD.


## Как взаимодействуют между собой учетная запись Майкрософт и служба Enterprise State Roaming в Azure AD? 
В выпусках Windows 10 за 2015 г. служба Enterprise State Roaming одновременно может использоваться только в одной учетной записи. Если пользователь входит в Windows с помощью рабочей или учебной учетной записи Azure AD, все данные будут синхронизироваться через Azure AD. Если пользователь входит в Windows с помощью личной учетной записи Майкрософт, все данные будут синхронизироваться через учетную запись Майкрософт. Если лицензия приложения "принадлежит" основной учетной записи на устройстве, данные приложений будут перемещаться с использованием этой учетной записи. Приложения, которые "принадлежат" дополнительным учетным записям, не будут синхронизировать свои данные в Windows 10.

## Поддерживается ли синхронизация параметров для учетных записей Azure AD из нескольких клиентов?
Если на устройстве есть несколько учетных записей Azure AD из разных клиентов Azure AD, необходимо обновить реестр устройства, чтобы каждый клиент Azure AD смог обмениваться данными со службой Azure Rights Management (Azure RMS).

1. Во-первых, вам понадобится идентификатор GUID для каждого клиента Azure AD. Перейдите на классический портал Azure и выберите клиент Azure AD. Идентификатор GUID клиента включен в URL-адрес, который отображается в адресной строке браузера: `https://manage.windowsazure.com/YourAccount.onmicrosoft.com#Workspaces/ActiveDirectoryExtension/Directory/Tenant GUID/directoryQuickStart`
2. Получив GUID, вам нужно добавить следующий раздел реестра: **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\SettingSync\\WinMSIPC<GUID клиента>**. В разделе <**GUID клиента**> создайте новый многостроковый параметр (REG-MULTI-SZ) с именем **AllowedRMSServerUrls**, а в качестве его данных укажите URL-адреса точек распространения лицензий других клиентов Azure, к которым подключается устройство. 
3. URL-адреса точек распространения лицензий можно получить, выполнив командлет **Get-AadrmConfiguration**. Если значения **LicensingIntranetDistributionPointUrl** и **LicenseingExtranetDistributionPointUrl** отличаются, укажите оба значения. Если значения совпадают, достаточно указать значение один раз.


## Можно ли перемещать параметры классических приложений Windows?
Перемещение работает только для универсальных приложений Windows. Для классических приложений Windows перемещение можно настроить двумя способами.

- С помощью набора средств Project Centennial можно быстро преобразовать классическое приложение Windows в универсальное. В этом случае для перемещения данных приложения в Azure AD разработчику приложения нужно внести минимальные изменения в код. Этот способ рекомендуется использовать, когда нужно настроить перемещение данных для приложений Win32. 
- С помощью генератора шаблонов [User Experience Virtualization (UE-V)](https://technet.microsoft.com/library/dn458947.aspx) можно создать пользовательский шаблон параметров. Затем этот шаблон можно использовать для приложения при каждом его запуске. В этом случае разработчику приложений не нужно изменять код приложения. Обратите внимание, что в выпусках Windows 10 за 2015 г. пользователи UE-V, которые приобрели пакет Microsoft Desktop Optimization Pack, могут перемещать данные только в локальной среде Active Directory. В будущем мы, возможно, подумаем над глубокой интеграцией UE-V в ОС Windows, чтобы реализовать возможность перемещения параметров через облако Azure AD. 

## Можно ли хранить синхронизируемые параметры и данные локально?
Служба Enterprise State Roaming предназначена для хранения данных параметров в облаке Azure, а UE-V — это локальное средство перемещения для Windows 10.

## Кто управляет перемещаемыми данными?
Данными управляет администратор клиента. Они хранятся в центре обработки данных Azure. Все данные пользователя шифруются как при передаче, так и при хранении в облаке с помощью службы Azure Rights Management (Azure RMS). Это гораздо лучше синхронизации параметров с использованием учетной записи Майкрософт, во время которой при передаче шифруются только определенные конфиденциальные данные, например учетные данные пользователя.

Корпорации Майкрософт очень серьезно относится к вопросу защиты пользовательских данных. Данные параметров корпоративного пользователя автоматически шифруются с помощью Azure RMS всякий раз, когда они передаются с устройства Windows 10. Это предотвращает считывание данных другими пользователями. Если у вашей организации есть платная подписка на Azure RMS, вы можете использовать другие функции этой службы, а именно: отслеживать и отзывать документы, автоматически защищать сообщения электронной почты с конфиденциальными сведениями, а также управлять собственными ключами (BYOK). Дополнительные сведения об этих функциях и принципах работы Azure RMS см. в статье [Что такое управление правами Azure?](https://technet.microsoft.com/jj585026.aspx)

## Можно ли управлять синхронизацией конкретного приложения или параметра?
В Windows 10 не предусмотрено использование MDM или параметров групповых политик, которые позволили бы отключить перемещение для отдельного приложения. Администраторы клиентов могут отключить синхронизацию данных только для всех приложений на управляемом устройстве. Более гибкого способа управления перемещением (на уровне приложения или в пределах приложения) нет.

## Как пользователь может включить или отключить перемещение?
В разделе "Параметры" выберите элементы "Учетные записи" -> "Синхронизация параметров". На этой странице можно увидеть, какая учетная запись используется для перемещения параметров, а также включить или отключить отдельные группы перемещаемых настроек.
 
##Какие решения Майкрософт рекомендует использовать для перемещения в Windows 10? 
Майкрософт предлагает несколько решений по перемещению параметров: перемещаемые профили пользователей, UE-V и перемещение в Azure AD. Если перемещение данных в облако по каким-то причинам не подходит для вашей организации, Майкрософт рекомендует использовать решение UE-V в качестве основной технологии перемещения. Если организации подходит перемещение в облако, но также требуется поддержка перемещения для классических приложений Windows, Майкрософт рекомендует использовать и синхронизацию корпоративных параметров, и UE-V. Хотя UE-V и синхронизация корпоративных параметров — это сходные технологии, они не заменяют друг друга. Более того, эти решения являются взаимодополняющими, гарантируя, что ваша организация предоставит пользователям необходимые им способы перемещения. Когда одновременно используются синхронизация корпоративных параметров и UE-V, действуют следующие правила.

- Enterprise State Roaming выступает в роли основного агента перемещения на устройстве. UE-V используется в качестве дополнения для работы с данными приложений Win32. 
- Перемещение параметров Windows и данных приложений UWP с помощью UE-V необходимо отключить, так как эти функции обеспечивает решение Enterprise State Roaming. 

## Что происходит, когда организация, в которой уже некоторое время работает перемещение данных и настроек, приобретает службу Azure RMS? 
Если ваша организация уже использует возможности перемещения в Windows 10 в рамках бесплатной подписки на Azure RMS, приобретение платной подписки на Azure RMS не повлияет на работу перемещения. ИТ-администратору даже не придется изменять настройки.

## Известные проблемы

- Вход в Windows с использованием смарт-карты или виртуальной смарт-карты приводит к остановке синхронизации параметров. При попытке войти в систему на устройстве с помощью смарт-карты или виртуальной смарт-карты синхронизация перестает работать. Эта проблема, возможно, будет решена в будущих обновлениях Windows 10.
- Также существует проблема с синхронизацией **избранного** в Internet Explorer. Синхронизация избранного IE временно отключена, чтобы предотвратить появление дальнейших проблем. Эта проблема будет решена в будущих обновлениях Windows 10.


## Связанные разделы
- [Обзор службы Enterprise State Roaming](active-directory-windows-enterprise-state-roaming-overview.md)
- [Включение службы Enterprise State Roaming в Azure Active Directory](active-directory-windows-enterprise-state-roaming-enable.md)
- [Group policy and MDM settings for settings sync (Параметры групповой политики и управления мобильными устройствами)](active-directory-windows-enterprise-state-roaming-group-policy-settings.md)
- [Справочник по перемещаемым параметрам в Windows 10](active-directory-windows-enterprise-state-roaming-windows-settings-reference.md)

<!---HONumber=AcomDC_0204_2016-->