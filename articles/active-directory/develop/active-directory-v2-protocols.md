---
title: Сведения о протоколах авторизации, поддерживаемых Azure AD версии 2.0 | Документация Майкрософт
description: Руководство по протоколам, поддерживаемым конечной точкой Azure AD версии 2.0.
services: active-directory
documentationcenter: ''
author: CelesteDG
manager: mtillman
editor: ''
ms.assetid: 5fb4fa1b-8fc4-438e-b3b0-258d8c145f22
ms.service: active-directory
ms.subservice: develop
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/01/2018
ms.author: celested
ms.reviewer: hirsin
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: ed27830aa1f4212e4bc26af8da4febc1b61a76cc
ms.sourcegitcommit: 301128ea7d883d432720c64238b0d28ebe9aed59
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/13/2019
ms.locfileid: "56175114"
---
# <a name="v20-protocols---oauth-20-and-openid-connect"></a>Протоколы версии 2.0: OAuth 2.0 и OpenID Connect

Конечная точка версии 2.0 может использовать Azure Active Directory (Azure AD) для предоставления "идентификации как услуги" с помощью стандартных отраслевых протоколов OpenID Connect и OAuth 2.0. Хотя эта служба соответствует стандартам, между любыми двумя реализациями этих протоколов могут быть незначительные различия. Сведения в этой статье могут оказаться полезными, если вы планируете писать код с использованием прямой отправки и обработки HTTP-запросов или сторонней библиотеки с открытым кодом вместо одной из наших [библиотек с открытым кодом](reference-v2-libraries.md).

> [!NOTE]
> Не все сценарии и компоненты Azure AD поддерживаются конечной точкой версии 2.0. Чтобы определить, следует ли вам использовать конечную точку 2.0, ознакомьтесь с [ограничениями версии 2.0](active-directory-v2-limitations.md).

## <a name="the-basics"></a>Основные сведения

Почти во всех потоках обмена данными в OAuth 2.0 и OpenID Connect участвуют четыре стороны.

![Роли OAuth 2.0](../../media/active-directory-v2-flows/protocols_roles.png)

* **Сервер авторизации** является конечной точкой 2.0 и отвечает за удостоверение пользователя, предоставление и блокировку доступа к ресурсам, а также предоставление маркеров. Кроме того, он выполняет роль поставщика удостоверений: он безопасным способом обрабатывает любые данные, связанные со сведениями о пользователе, его доступом и отношениями доверия между участниками потока.
* **Владелец ресурса** — это, как правило, пользователь. Это сторона, владеющая данными, которая может предоставлять третьим сторонам доступ к этим данным или ресурсу.
* **Клиент OAuth** — это приложение, определяемое идентификатором приложения. Обычно именно с этой стороной взаимодействует конечный пользователь. Клиент OAuth также запрашивает маркеры у сервера авторизации. Владелец ресурса должен предоставить клиенту разрешение на доступ к ресурсу.
* **Сервер ресурсов** — место размещения ресурса или данных. Он позволяет серверу авторизации выполнять безопасную проверку подлинности и авторизацию клиента OAuth и использует маркеры доступа носителя для обеспечения возможности предоставления доступа к ресурсу.

## <a name="app-registration"></a>Регистрация приложения
Каждое приложение, использующее конечную точку версии 2.0, должно быть зарегистрировано на [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) или с помощью нового интерфейса **регистрации приложений (предварительная версия)** [на портале Azure](https://portal.azure.com/?Microsoft_AAD_RegisteredApps=true#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade), прежде чем взаимодействовать с помощью OAuth или OpenID Connect. В процессе регистрации для приложения будет собрано и назначено несколько значений.

* **идентификатор приложения**, который определяет конкретное приложение;
* **Универсальный код ресурса (URI) перенаправления** или **Идентификатор пакета**, которые можно использовать для возврата ответов к приложению.
* Несколько других зависящих от сценария значений.

Дополнительные сведения см. в статье о [регистрации приложения](quickstart-v2-register-an-app.md).

## <a name="endpoints"></a>Конечные точки

После регистрации приложение взаимодействует с Azure AD, отправляя запросы к конечной точке версии 2.0:

```
https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize
https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
```

Где `{tenant}` может принимать одно из четырех значений:

| Значение | ОПИСАНИЕ |
| --- | --- |
| `common` | Позволяет пользователям с личными учетными записями Майкрософт и рабочими учетными записями Azure AD выполнять вход в приложение. |
| `organizations` | Позволяет выполнять вход в приложение только пользователям с рабочими учетными записями Azure AD. |
| `consumers` | Позволяет выполнять вход в приложение только пользователям с личными учетными записями Майкрософт. |
| `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` или `contoso.onmicrosoft.com` | Позволяет выполнять вход в приложение только пользователям с рабочими учетными записями определенного клиента Azure AD. Можно использовать понятное доменное имя клиента Azure AD или идентификатор GUID клиента. |

Чтобы узнать, как взаимодействовать с этими конечными точками, выберите определенный тип приложения в разделе [Протоколы](#protocols) и перейдите по ссылкам для получения дополнительной информации.

## <a name="tokens"></a>Маркеры

В реализации OAuth 2.0 и OpenID Connect в версии 2.0 широко используются маркеры носителя, включая маркеры носителя в виде JWT. Токен носителя — это упрощенный маркер безопасности, предоставляющий его носителя (предъявителю) доступ к защищенному ресурсу. В этом смысле предъявителем является любая сторона, которая может предъявить маркер. Несмотря на то, что для получения токена носителя сторона должны сначала пройти проверку подлинности в Azure AD, если действия, необходимые для защиты маркера при его передаче и хранении не выполняются, его может перехватить и использовать несанкционированная сторона. Хотя в некоторых маркерах безопасности для предотвращения несанкционированного использования применяется специальный встроенный механизм, в токенах носителя такого механизма нет, и они должны передаваться по защищенному каналу, например с использованием стандарта безопасности транспортного уровня (HTTPS). Если токен носителя передается в незашифрованном виде, злоумышленник может использовать атаку "злоумышленник в середине", чтобы получить токен и использовать его для несанкционированного доступа к защищенному ресурсу. Те же принципы безопасности применяются при сохранении или кэшировании маркеров носителя для последующего использования. Необходимо всегда проверять, что приложение передает и сохраняет токены носителя безопасным образом. Дополнительные сведения о безопасности в случае применения токенов носителя см. в [RFC 6750, раздел 5](https://tools.ietf.org/html/rfc6750).

Дополнительные сведения о различных типах маркеров, используемых в конечной точке 2.0, можно найти в [справочнике по маркерам конечной точки 2.0](v2-id-and-access-tokens.md).

## <a name="protocols"></a>Протоколы

Если вы готовы рассмотреть несколько примеров запросов, приступите к одному из учебников ниже. Каждый из них соответствует определенному сценарию аутентификации. Сведения о том, как выбрать правильный поток, см. в статье о [типах приложений, которые можно создать с помощью версии 2.0](v2-app-types.md).

* [Создание мобильного и собственного приложения с использованием OAuth 2.0](v2-oauth2-auth-code-flow.md)
* [Сборка веб-приложения с протоколом OpenID Connect](v2-protocols-oidc.md)
* [Создание одностраничных приложений с использованием неявной последовательности OAuth 2.0](v2-oauth2-implicit-grant-flow.md)
* [Создание управляющих программ или серверных процессов с использованием последовательности учетных данных клиентов OAuth 2.0](v2-oauth2-client-creds-grant-flow.md)
* [Получение маркеров в веб-API с помощью последовательности OAuth 2.0 On-Behalf-Of](v2-oauth2-on-behalf-of-flow.md)
