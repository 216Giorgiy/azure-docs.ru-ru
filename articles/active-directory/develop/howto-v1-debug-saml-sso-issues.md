---
title: Отладка единого входа на основе SAML в Azure Active Directory | Документы Майкрософт
description: Отладка единого входа на основе SAML в приложениях в Azure Active Directory.
services: active-directory
author: CelesteDG
documentationcenter: na
manager: mtillman
ms.service: active-directory
ms.component: develop
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 06/15/2018
ms.author: celested
ms.custom: aaddev
ms.reviewer: hirsin, dastrock, smalser
ms.openlocfilehash: 5895e918fbd3b67074069ccc81bd794a75725c9a
ms.sourcegitcommit: 35ceadc616f09dd3c88377a7f6f4d068e23cceec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/08/2018
ms.locfileid: "39620942"
---
# <a name="debug-saml-based-single-sign-on-to-applications-in-azure-active-directory"></a>Отладка единого входа на основе SAML в приложениях в Azure Active Directory

Узнайте, как найти и устранить проблемы с [единым входом](../manage-apps/what-is-single-sign-on.md) для приложений в Azure Active Directory (Azure AD) с поддержкой [языка разметки заявлений системы безопасности (SAML) 2.0](https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language). 

## <a name="before-you-begin"></a>Перед началом работы
Мы рекомендуем установить [расширение защищенного входа в мои приложения](../user-help/active-directory-saas-access-panel-user-help.md#i-am-having-trouble-installing-the-my-apps-secure-sign-in-extension). Это расширение браузера позволяет собирать сведения о запросах SAML и ответах SAML, необходимые для решения проблем с единым входом. Если вы не можете установить расширение, ознакомьтесь с этой статьей, которая описывает решение проблем при наличии или отсутствии этого расширения.

Перейдите по одной из следующих ссылок, чтобы загрузить и установить расширение защищенного входа в мои приложения.

- [Chrome](https://go.microsoft.com/fwlink/?linkid=866367)
- [Edge](https://go.microsoft.com/fwlink/?linkid=845176)
- [Firefox](https://go.microsoft.com/fwlink/?linkid=866366)


## <a name="test-saml-based-single-sign-on"></a>Тестирование единого входа на основе SAML

Тестирование единого входа на основе SAML между AAD и целевым приложением:

1.  Войдите на [портал Azure](https://portal.azure.com) как глобальный администратор или другой администратор с правами на управление приложениями.
2.  В левой колонке выберите **Azure Active Directory** и нажмите **Корпоративные приложения**. 
3.  Из списка корпоративных приложений выберите приложение, для которого хотите протестировать единый вход, а затем в параметрах слева нажмите **Единый вход**.
4.  Чтобы перейти в раздел тестирования единого входа на основе SAML, в разделе **Домен и URL-адреса** нажмите **Тестирование параметров SAML**. Если кнопка "Тестирование параметров SAML" неактивна, сначала укажите и сохраните необходимые атрибуты.
5.  В колонке **Тестирование единого входа** введите корпоративные учетные данные, чтобы войти в целевое приложение. Вы можете выполнить вход как текущий пользователь или как другой пользователь. Если вы войдете от имени другого пользователя, откроется окно проверки подлинности.

    ![Страница тестирования SAML](./media/howto-v1-debug-saml-sso-issues/testing.png)


Если вы успешно выполнили вход, тест пройден. В этом случае Azure AD выдает маркер ответа SAML приложению. Приложение использует маркер SAML, чтобы обработать ваш вход.

Если на странице входа компании или на странице приложения отображается ошибка, воспользуйтесь инструкциями из следующих разделов, чтобы решить ее.


## <a name="resolve-a-sign-in-error-on-your-company-sign-in-page"></a>Решение ошибки входа на странице входа компании

При попытке входа вы можете увидеть ошибку на странице входа компании. 

![Ошибка входа](./media/howto-v1-debug-saml-sso-issues/error.png)

Чтобы устранить эту ошибку, вам понадобится сообщение об ошибке и запрос SAML. Расширение защищенного входа в мои приложения автоматически собирает эту информацию и отображает инструкции по решению проблемы в Azure AD. 

Устранение ошибки входа с установленным расширением защищенного входа в мои приложения:

1.  В случае ошибки расширение перенаправляет вас обратно в колонку **Тестирование единого входа** в Azure AD. 
2.  В колонке **Тестирование единого входа** нажмите **Загрузить запрос SAML**. 
3.  Отобразятся инструкции по устранению в зависимости от ошибки и значений в запросе SAML. Прочитайте инструкции.

Устранение ошибки, когда расширение защищенного входа в мои приложения не установлено:

1. Скопируйте сообщение об ошибке в нижнем правом углу страницы. В сообщении об ошибке указывается:
    - CorrelationID и Timestamp. Эти значения важно указать при обращении в службу поддержки корпорации Майкрософт. Это поможет нашим инженерам быстрее определить проблему и найти ей решение.
    - Инструкция, определяющая первопричину проблемы.
2.  Вернитесь в Azure AD и найдите колонку **Тестирование единого входа**.
3.  В текстовое поле над пунктом **Получить рекомендации по устранению** вставьте сообщение об ошибке.
3.  Нажмите **Получить рекомендации по устранению**, чтобы просмотреть инструкции по устранению ошибки. Для рекомендаций может потребоваться информация из запроса SAML или ответа SAML. Если вы не используете расширение защищенного входа в мои приложения, вам потребуется другое средство, например [Fiddler](http://www.telerik.com/fiddler), чтобы получить запрос и ответ SAML.
4.  Назначение в запросе SAML должно совпадать с URL-адресом службы единого входа SAML, полученным из Azure Active Directory
5.  Издатель запроса SAML должен иметь тот же идентификатор, который вы настроили для этого приложения в Azure Active Directory. В Azure AD значение издателя используется для поиска приложения в каталоге.
6.  Значение AssertionConsumerServiceURL должно обозначать расположение, в котором приложение ожидает получить токен SAML от Azure Active Directory. Это значение можно настроить в Azure Active Directory, но оно не является обязательным элементом запроса SAML.


## <a name="resolve-a-sign-in-error-on-the-application-page"></a>Устранение ошибки входа на странице приложения

Ошибка на странице приложения может отображаться даже после успешного входа. Это происходит в случае, когда Azure AD выдает приложению маркер, но приложение не принимает ответ.   

Чтобы устранить эту ошибку, сделайте следующее:

1. Если приложение находится в коллекции Azure AD, убедитесь, что выполнили все инструкции по интеграции приложения с Azure AD. Инструкции по интеграции для приложения вы найдете в [руководствах по интеграции приложений SaaS](../saas-apps/tutorial-list.md).
2. Получите ответ SAML.
    - Если расширение защищенного входа в мои приложения установлено, в колонке **Тестирование единого входа** нажмите **Загрузить ответ SAML**.
    - Если расширение не установлено, получите ответ SAML с помощью дополнительного средства, например [Fiddler](http://www.telerik.com/fiddler). 
3. Обратите внимание на следующие элементы в маркере ответа SAML:
    - Уникальный идентификатор пользователя значения и формата NameID
    - Утверждения, выданные в маркере
    - Сертификат, использованный для подписи маркера. Сведения о том, как получить ответ SAML, см. в статье [Протокол единого входа SAML](single-sign-on-saml-protocol.md).
4. Дополнительные сведения об ответе SAM см. в статье [Протокол единого входа SAML](single-sign-on-saml-protocol.md).
5. Получив ответ SAML, перейдите в раздел [Ошибка на странице приложения после входа](../application-sign-in-problem-application-error.md) и ознакомьтесь с инструкциями по решению проблемы. 
6. Если вы по-прежнему не можете выполнить вход, обратитесь к поставщику приложения и узнайте, чего не хватает в ответе SAML.


## <a name="next-steps"></a>Дополнительная информация
Теперь, когда единый вход в приложение работает, перейдите к следующим разделам — [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](../active-directory-saas-app-provisioning.md) или [Начало работы с условным доступом](../conditional-access/app-based-conditional-access.md).


