---
title: Перенос виртуальных машин IaaS Azure в другой регион Azure с помощью службы Azure Site Recovery | Документация Майкрософт
description: Используйте службу Azure Site Recovery для переноса виртуальных машин IaaS Azure из одного региона Azure в другой.
services: site-recovery
author: rajani-janaki-ram
ms.service: site-recovery
ms.topic: tutorial
ms.date: 01/28/2019
ms.author: rajanaki
ms.custom: MVC
ms.openlocfilehash: 1560dad31e00b00a2d27cf1675e05901e6611825
ms.sourcegitcommit: f7be3cff2cca149e57aa967e5310eeb0b51f7c77
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2019
ms.locfileid: "56309868"
---
# <a name="move-azure-vms-to-another-region"></a>Перенос виртуальных машин Azure в другой регион

Azure активно развивается вместе с клиентской базой и добавляет поддержку новых регионов в соответствии с растущими требованиями. Кроме того, также в разных службах ежемесячно добавляются новые возможности. В связи с этим иногда требуется переместить виртуальные машины в другой регион или в Зоны доступности, чтобы повысить доступность.

В этом документе рассматриваются различные сценарии перемещения виртуальных машин, а также руководство по настройке архитектуры в целевом расположении для повышения доступности. 
> [!div class="checklist"]
> * [Зачем перемещать виртуальные машины Azure](#why-would-you-move-azure-vms)
> * [Перемещение виртуальных машин Azure](#how-to-move-azure-vms)
> * [Стандартные архитектуры](#typical-architectures-for-a-multi-tier-deployment)
> * [Перемещение виртуальных машин "как есть" в целевое расположение](#move-azure-vms-to-another-region)
> * [Перемещение виртуальных машин для повышения доступности](#move-vms-to-increase-availability)


## <a name="why-would-you-move-azure-vms"></a>Зачем перемещать виртуальные машины Azure

Клиенты перемещают виртуальные машины по следующим причинам:

- Если у вас уже есть развертывание в одном регионе и была добавлена поддержка нового региона, который ближе к пользователям вашего приложения или службы, то вы можете **переместить виртуальные машины "как есть" в новый регион**, чтобы уменьшить задержку. Такой же подход применяется, если требуется консолидировать подписки или существуют правила управления или организации, требующие перемещения. 
- Если ваша виртуальная машина была развернута как одноэкземплярная или как часть группы доступности и вы хотите расширить Соглашения об уровне обслуживания относительно доступности, вы можете **переместить виртуальные машины в зону доступности**. 

## <a name="how-to-move-azure-vms"></a>Перемещение виртуальных машин Azure
Для этого необходимо выполнить следующие шаги:

1. проверка предварительных требований; 
2. Подготовка исходных виртуальных машин. 
3. Подготовка целевого региона. 
4. Копирование данных в целевой регион — используйте технологию репликации Azure Site Recovery для копирования данных исходной виртуальной машины в целевой регион.
5. Тестирование конфигурации. Если репликация завершена, проверьте конфигурацию, выполнив тестовую отработку отказа в непроизводственной сети.
6. Выполнение перемещения. 
7. Отмена ресурсов в исходном регионе. 


> [!IMPORTANT]
> В настоящее время Azure Site Recovery поддерживает перемещение виртуальных машин из одного региона в другой и не поддерживает перемещение в пределах одного региона. 

> [!NOTE]
> Подробные указания по этим шагам приведены в документации по каждому из сценариев, как описано [здесь](#next-steps).

## <a name="typical-architectures-for-a-multi-tier-deployment"></a>Стандартные архитектуры для многоуровневого развертывания
В следующем разделе рассматриваются самые распространенные архитектуры развертывания, используемые клиентами для многоуровневого приложения в Azure. В качестве примера мы приводим трехуровневое приложение с общедоступным IP-адресом. Каждый из уровней (сеть, приложение и база данных) имеет по 2 виртуальные машины и подключен с помощью Load Balancer к другим уровням. Уровень базы данных использует репликацию с функцией SQL AlwaysOn между виртуальными машинами для обеспечения высокой доступности (HA).

1.  **Виртуальные машины с одним экземпляром, развернутые на различных уровнях** — каждая виртуальная машина на уровне настроена как виртуальная машина с одним экземпляром и подключена с помощью подсистем балансировки нагрузки к другим уровням. Это самая простая конфигурация, которую применяют клиенты.

       ![Сценарий с одной виртуальной машиной](media/move-vm-overview/regular-deployment.PNG)

2. **Виртуальные машины на каждом уровне, развернутые в группе доступности** — каждая виртуальная машина на уровне настраивается в группе доступности. [Группы доступности](https://docs.microsoft.com/azure/virtual-machines/windows/tutorial-availability-sets) распределяют развернутые в Azure виртуальные машины между несколькими изолированными аппаратными узлами в кластере. Таким образом, в случае сбоя оборудования или программного обеспечения в Azure затрагивается только подмножество виртуальных машин, а общее решение остается доступным для использования. 
   
      ![avset](media/move-vm-overview/AVset.PNG)

3. **Виртуальные машины на каждом уровне, развернутые в группе доступности** — каждая виртуальная машина на уровне настраивается в [Зонах доступности](https://docs.microsoft.com/azure/availability-zones/az-overview). Зона доступности в регионе Azure — это сочетание домена сбоя и домена обновления. Например, если вы создаете три или боле виртуальных машин в трех зонах в регионе Azure, виртуальные машины эффективно распределяются между тремя доменами сбоя и тремя доменами обновления. Платформа Azure поддерживает такое распределение между доменами обновления, чтобы виртуальные машины в различных зонах не обновлялись одновременно.

      ![zone-deploymnt](media/move-vm-overview/zone.PNG)



 ## <a name="move-vms-as-is-to-a-target-region"></a>Перемещение виртуальных машин "как есть" в целевое расположение

Здесь показано, как будут выглядеть развертывания после перемещения "как есть" в целевой регион с учетом вышеупомянутых [архитектур](#typical-architectures-for-a-multi-tier-deployment).


1. **Виртуальные машины с одним экземпляром, развернутые на различных уровнях** 

     ![single-zone.PNG](media/move-vm-overview/single-zone.PNG)

2. **Виртуальные машины на каждом уровне, развернутые в группе доступности**

     ![crossregionAset.PNG](media/move-vm-overview/crossregionAset.PNG)


3. **Виртуальные машины на каждом уровне, развернутые в зоне доступности**
      

     ![AzoneCross.PNG](media/move-vm-overview/AzoneCross.PNG)

## <a name="move-vms-to-increase-availability"></a>Перемещение виртуальных машин для повышения доступности

1. **Виртуальные машины с одним экземпляром, развернутые на различных уровнях** 

     ![single-zone.PNG](media/move-vm-overview/single-zone.PNG)

2. **Виртуальные машины на каждом уровне, развернутые в группе доступности**. Вы можете настроить размещение виртуальных машин в группе доступности в отдельных зонах доступности при включении репликации для виртуальной машины с помощью Azure Site Recovery. После перемещения в соответствии с Соглашением об уровне обслуживания будет обеспечиваться доступность на уровне 99,9 %.

     ![aset-Azone.PNG](media/move-vm-overview/aset-Azone.PNG)


## <a name="next-steps"></a>Дополнительная информация

В этом документе приведены общие рекомендации по перемещению виртуальных машин. Пошаговые инструкции см. в следующих статьях:


> [!div class="nextstepaction"]
> * [Перенос виртуальных машин Azure в другой регион](azure-to-azure-tutorial-migrate.md)

> * [Перенос виртуальных машин Azure в Зоны доступности](move-azure-VMs-AVset-Azone.md)

