<properties linkid="manage-linux-fundamentals-intro-to-linux" urlDisplayName="Введение в Linux" pageTitle="Введение в Linux в Azure — учебник по Azure" metaKeywords="Виртуальная машина Azure с Linux, dиртуальная машина Linux" description="Узнайте, как использовать виртуальные машины Linux в Azure." metaCanonical="" services="virtual-machines" documentationCenter="Python" title="Введение в Linux в Azure" authors=""  solutions="" writer="" manager="" editor=""  />





#Введение в Linux в Azure

В этом разделе содержится обзор некоторых аспектов использования виртуальных машин Linux в облаке Azure. Развертывание виртуальной машины Linux представляет собой простой процесс, если используется существующий образ из коллекции. 

## Оглавление ##

* [Проверка подлинности: имена пользователей, пароли и ключи SSH.](#authentication)
* [Создание и использование SSH-ключей для входа на виртуальные машины Linux.](#keygeneration)
* [Получение привилегий суперпользователя с помощью sudo](#superuserprivileges)
* [Настройка брандмауэра](#firewallconfiguration)
* [Изменения имени узла](#hostnamechanges)
* [Запись образа виртуальной машины](#virtualmachine)
* [Присоединение дисков](#attachingdisks)

<h2><a id="authentication"></a>Проверка подлинности: имена пользователей, пароли и ключи SSH </h2>

При создании виртуальной машины Linux с помощью портала управления Azure вам будет предложено указать имя пользователя, пароль и (при необходимости) открытый SSH-ключ. К имени пользователя при развертывании виртуальной машины Linux на платформе Azure применяются следующие ограничения: имена учетных записей, которые уже используются на виртуальной машине, не допускаются (например, root).  Если не предоставить открытый SSH-ключ, вы сможете войти на виртуальную машину, используя заданные имя пользователя и пароль. Если вы решите отправить открытый SSH-ключ на портал управления, проверка подлинности на основе пароля ключ и потребуется использовать соответствующий закрытый SSH-ключ для проверки подлинности на виртуальной машине и входа в систему.

<h2><a id="keygeneration"></a>Создание SSH-ключа </h2>

Текущая версия портала управления принимает только открытые ключи SSH, инкапсулированные в сертификате X509. Выполните следующие шаги для создания и использования ключей SSH с Azure.

1. Используйте openssl для создания сертификата X509 с парой ключей 2048-разрядных ключей RSA.
		
		openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout myPrivateKey.key -out myCert.pem

	Ответьте на несколько вопросов, которые запрашивает openssl (можете оставить их пустыми). Контент этих полей не используется платформой.

2. Измените разрешения для закрытого ключа, чтобы защитить его.

		chmod 600 myPrivateKey.key

3. Преобразуйте myCert.pem в myCert.cer (сертификат X 509 в кодировке DER)

		openssl  x509 -outform der -in myCert.pem -out myCert.cer

4. При создании виртуальной машины Linux загрузите myCert.cer. В процессе подготовки открытый ключ будет автоматически установлен в этом сертификате в файл authorized_keys для указанного пользователя в виртуальной машине.

5. Подключитесь к виртуальной машине Linux с помощью ssh.

		ssh -i  myPrivateKey.key -p port  username@servicename.cloudapp.net

	Будет предложено принять отпечаток пальца открытого ключа узла при первом входе.

6. При необходимости вы можете скопировать myPrivateKey.key в каталог ~/.ssh/id_rsa, чтобы клиент openssh смог автоматически получать это без использования параметра "-i".

<h2><a id="superuserprivileges"></a>Получение привилегий суперпользователя с помощью sudo</h2> 

Учетная запись пользователя, указанная во время развертывания экземпляра виртуальной машины в Azure, является привилегированной учетной записью. Эта учетная запись настраивается агентом Linux Azure, чтобы иметь возможность повысить привилегии до уровня root (учетная запись суперпользователя) с помощью средства sudo. После входа в систему с помощью этой учетной записи пользователя вы сможете выполнять команды от учетной записи root, используя команду "sudo". При необходимости можно получить доступ к оболочке root с помощью команды **sudo -s**.

<h2><a id="firewallconfiguration"></a>Настройка брандмауэра </h2>

Azure предоставляет фильтр входящих пакетов, который ограничивает возможности подключения к портам, указанным на портале управления. По умолчанию разрешен только порт SSH. Вы можете открыть доступ к дополнительным портам на виртуальной машине Linux, добавив правила на портале управления.

Образа Linux в коллекции не активируют брандмауэр iptables на виртуальных машинах Linux. При необходимости брандмауэр IPtables можно настроить для предоставления дополнительных возможностей.

<h2><a id="hostnamechanges"></a>Изменения имени узла </h2>

При начальном развертывании экземпляра образа Linux необходимо указать имя узла для виртуальной машины. После запуска виртуальной машины это имя узла публикуется на DNS-серверах платформы, чтобы несколько соединенных между собой виртуальных машин могли выполнять поиск IP-адресов с помощью имен узлов. При необходимости изменения имени узла после развертывания виртуальной машины рекомендуется использовать команду **hostname новое_имя**. Агент Linux Azure предоставляет функции автоматического обнаружения изменения имени узла и соответствующей настройки виртуальной машины для сохранения этого изменения и его публикации на DNS-серверах платформы. Дополнительные сведения и параметры конфигурации, связанные с этой функцией, см. в файле README агента Linux Azure.

<h2><a id="virtualmachine"></a>Запись образа виртуальной машины </h2>

Azure предоставляет возможность записи состояния существующей виртуальной машиной в образ, который впоследствии можно использовать для развертывания дополнительных экземпляров виртуальной машины. Агент Linux Azure может использоваться для отката некоторых настроек, которые были выполнены в процессе подготовки. Вы можете выполнить следующие действия, чтобы записать виртуальную машину в виде образа:

1. Выполните команду **waagent -deprovision** для отмены настройки подготовки. Или выполните команду **waagent -deprovision+user** при необходимости, чтобы удалить учетную запись пользователя, указанную во время подготовки, и все связанные с ней данные.

2. Завершите работу или выключите виртуальную машину с помощью портала или средств управления.

3. Нажмите кнопку "Запись" на портале управления или используйте средства командной строки, чтобы записать виртуальную машину в образ.

<h2><a id="attachingdisks"></a>Присоединение дисков </h2>

Это действие рассмотрено в учебнике по [созданию виртуальной машины Linux](../virtual-machine-from-gallery/).


