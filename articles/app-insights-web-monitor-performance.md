<properties 
	pageTitle="Отслеживание работоспособности и использования вашего приложения с помощью Application Insights" 
	description="Приступая к работе с Application Insights. Анализ использования, доступности и производительности локальных приложений или веб-приложений Microsoft Azure." 
	services="application-insights" 
	authors="alancameronwills" 
	manager="kamrani"/>

<tags 
	ms.service="application-insights" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="ibiza" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="2014-12-11" 
	ms.author="awills"/>
 
# Отслеживание производительности в веб-приложениях

*Служба Application Insights доступна в предварительной версии.*


Она позволяет удостовериться, что приложение работает с хорошей производительностью, и быстро выяснить, были ли сбои. [Application Insights][start] покажет все проблемы производительности и исключения, а также поможет найти и диагностировать их первопричины.

Служба Application Insights может отслеживать веб-приложения ASP.NET, размещенные в локальной среде или на виртуальных машинах, а также веб-сайты Microsoft Azure. 

* [Настройка мониторинга производительности](#setup)
* [Просмотр данных](#view)
* [Что все это означает?](#metrics)
* [Диагностические проблемы](#diagnosis)
* [Дальнейшие действия](#next)

## <a name="setup"></a>Настройка мониторинга производительности

Если вы еще не добавили Application Insights в проект (т. е. если в нем нет файла ApplicationInsights.config), вы можете приступить к работе с этой службой одним из следующих способов:

* [Добавьте Application Insights в проект своего приложения в среде Visual Studio][greenbrown] - рекомендуется. помимо пассивного мониторинга производительности, вы можете вести журналы диагностики и отслеживать использование;
* [Отслеживать производительность веб-сайта][redfield] - таким образом не потребуется обновлять проект приложения и повторно развертывать веб-сайт.
* [Для веб-сайта Microsoft Azure](insights-how-to-customize-monitoring.md)  уже можно наблюдать метрики в колонке мониторинга. 


## <a name="view"></a>Просмотр отчетов

Запустите приложение, нажав клавишу F5, и попробуйте открыть разные страницы.

В Visual Studio вы увидите число полученных событий.

![](./media/appinsights/appinsights-09eventcount.png)


Откройте Application Insights из проекта.

![Right-click your project and open the Azure portal](./media/appinsights/appinsights-04-openPortal.png)


Просмотр данных в заголовках **Работоспособности приложения**. Сначала вы увидите только одну или две точки. Например:

![Click through to more data](./media/appinsights/appinsights-41firstHealth.png)

При работе в режиме отладки телеметрия передается через конвейер, поэтому данные должны появиться в течение нескольких секунд. При развертывании приложения данные накапливаются медленнее.

Если данные сразу не отображаются, подождите минуту и нажмите Refresh (Обновить).

### Изучение метрик

Щелкните любой заголовок, чтобы увидеть результаты более подробно и за больший период. Например, щелкните плитку Requests (Запросы), а затем выберите временной диапазон:


![Click through to more data and select a time range](./media/appinsights/appinsights-48metrics.png)

Щелкните диаграмму, чтобы выбрать, какие метрики отображать, а также добавить новую диаграмму и выбрать метрики для нее.

![Click a graph to choose metrics](./media/appinsights/appinsights-61perfchoices.png)

> [AZURE.NOTE] **Отмените выбор всех метрик**, чтобы увидеть полный набор доступных метрик. Метрики разделены на группы: если выбран один из элементов группы, отображаются только другие метрики в той же группе.


## <a name="metrics"></a>Что все это значит? Плитки и отчеты о производительности

Существует множество различных метрик производительности. Начнем с тех, которые отображаются в колонке приложения по умолчанию.


### Requests (Запросы)

Число запросов HTTP, полученных за указанный период. Сравните это значение с результатами в других отчетах, чтобы узнать, как ведет себя приложение при изменении нагрузки.

HTTP-запросы включают в себя все запросы GET и POST для страниц, данных и изображений.

Чтобы просмотреть счетчики для конкретных URL-адресов, щелкните плитку.

### Average response time (Среднее время ответа)

Это время от поступления веб-запроса в приложение до возвращения ответа.

Точки показывают скользящее среднее. Если запросов много, для некоторых из них значения могут отклоняться от среднего, но при этом на графике не будет явных пиков или провалов.

Ищите аномальные всплески. Как правило, время ответа растет с увеличением числа запросов. Если этот рост непропорционален, возможно, приложение исчерпало какой-либо ресурс, например ЦП или емкость используемой службы.

Чтобы просмотреть значения для конкретных URL-адресов, щелкните плитку.

![](./media/appinsights/appinsights-42reqs.png)


### Slowest requests (Самые медленные запросы)

![](./media/appinsights/appinsights-44slowest.png)

Показывает, какие запросы могут потребовать оптимизации производительности.


### Failed requests (Неудачные запросы)

![](./media/appinsights/appinsights-46failed.png)

Это счетчик запросов, которые вызвали неперехваченные исключения.

Чтобы просмотреть подробные сведения о конкретных сбоях, щелкните плитку. Чтобы просмотреть подробные сведения об отдельном запросе, выберите его. 

Для детального изучения доступна только репрезентативная выборка сбоев.

### Другие метрики

Чтобы увидеть, какие еще метрики доступны, щелкните график и снимите все флажки метрик. Чтобы просмотреть определение конкретной метрики, щелкните значок (i).

![Deselect all metrics to see the whole set](./media/appinsights/appinsights-62allchoices.png)


Выбор любой метрики отключит остальные, и они не будут отображаться на этой диаграмме.

## Задайте предупреждения

Чтобы получать уведомления по электронной почте о нетипичных значениях любой метрики, добавьте предупреждение. Можно выбрать отправку либо по электронной почте администраторам учетной записи, либо на указанный электронный адрес.

![](./media/appinsights/appinsights-413setMetricAlert.png)

Выбирайте ресурс прежде других свойств. Не выбирайте ресурсы webtest, если нужно задать предупреждения метрик производительности или использования.

Аккуратно указывайте единицы измерения для пороговых значений.

*Я не вижу кнопку "Добавить предупреждение".* - Возможно, это из-за того, что у вас доступ только для чтения. 

## <a name="diagnosis"></a>Диагностика неполадок

Вот некоторые советы по выявлению и диагностике проблем с производительностью:

* Настройте [веб-тесты][availability], чтобы получать предупреждения, когда веб-сайт завершает работу или работает медленно или неверно. 
* сравните число запросов с другими метриками, чтобы узнать, не связаны ли сбои или медленный ответ с нагрузкой;
* [Вставляйте и ищите инструкции трассировки][diagnostic] в своем коде, что поможет выявить проблемы.

## <a name="next"></a>Дальнейшие действия

[Веб-тесты][availability] - веб-запросы отправляются вашему приложению через регулярные интервалы со всего мира.

[Захват и поиск диагностических трассировок][diagnostic] - вставляйте трассировки и просматривайте результаты для выявления проблем.

[Отслеживание использования][usage] - выясните, сколько пользователей у вашего приложения.

[Устранение неполадок][qna] и ответы на вопросы



[AZURE.INCLUDE [app-insights-learn-more](../includes/app-insights-learn-more.md)]




<!--HONumber=35.2-->

<!--HONumber=46--> 
