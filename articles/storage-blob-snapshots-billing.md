<properties 
	pageTitle="Общая информация о том, как моментальные снимки увеличивают плату" 
	description="Руководство для понимания выставления счетов за моментальные снимки больших двоичных объектов службы хранилища Azure" 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor=""/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/20/2015" 
	ms.author="tamram"/>

#Общая информация о том, как моментальные снимки увеличивают плату

Создание моментальных снимков, представляющих собой копии больших двоичных объектов с доступом только для чтения, может привести к дополнительной плате за хранение данных в вашей учетной записи. При проектировании приложения важно учитывать, как эта плата может накапливаться, чтобы минимизировать ненужные затраты.

##Важные вопросы о выставлении счетов

Следующий список включает ключевые пункты, которые следует рассмотреть при создании моментального снимка.

- Плата взимается за уникальные блоки и страницы независимо от того, где они находятся: в большом двоичном объекте или в моментальном снимке. Ваша учетная запись не влечет за собой дополнительных затрат на моментальные снимки, связанные с большим двоичным объектом, пока большой двоичный объект, на котором они основаны, не будет обновлен. После обновления базового большого двоичного объекта он расходится со своими моментальными снимками, и вам придется оплачивать уникальные блоки и страницы в каждом большом двоичном объекте или моментальном снимке.

- Когда вы заменяете блок в блочном большом двоичном объекте, за этот блок начинает взиматься плата как за уникальный. Это произойдет, даже если у блока тот же идентификатор блока и те же данные, что и в моментальном снимке. Как только блок фиксируется заново, он расходится со всеми своими дубликатами во всех моментальных снимках, и вы будете оплачивать его данные. Это же происходит и для страницы в страничном большом двоичном объекте, обновляемом идентичными данными.

- Замещение блочного большого двоичного объекта путем вызова метода UploadFile, UploadText, UploadStream или UploadByteArray заменяет все блоки в этом большом двоичном объекте. При наличии моментального снимка, связанного с этим большим двоичным объектом, все блоки в базовом большом двоичном объекте и моментальном снимке разойдутся, и вы будете оплачивать ресурсы всех блоков в обоих больших двоичных объектах. Это произойдет, даже если данные базового большого двоичного объекта и моментального снимка останутся идентичными.

- В службе BLOB-объектов Azure нет средств, позволяющих определить, содержат ли два блока идентичные данные. Каждый блок, который был загружен и зафиксирован, обрабатывается как уникальный, даже если он содержит те же данные и имеет тот же идентификатор блока. Так как плата добавляется за уникальные блоки, важно иметь в виду, что обновление большого двоичного объекта, содержащего моментальные снимки, приведет к появлению дополнительных уникальных блоков и дополнительным расходам.

> [AZURE.NOTE] Рекомендуется управлять моментальными снимками осторожно, чтобы избежать наценок. Мы советуем управлять моментальными снимками следующим образом.

> - Удаляйте и повторно создавайте моментальные снимки, связанные с большим двоичным объектом, при обновлении этого объекта, даже если вы обновляете его идентичными данными, если только структура вашего приложения не требует сохранения моментальных снимков. За счет удаления и повторного создания моментальных снимков больших двоичных объектов можно исключить расхождение большого двоичного объекта с моментальными снимками.

> - Если необходимо хранить моментальные снимки для больших двоичных объектов, старайтесь не вызывать UploadFile, UploadText, UploadStream или UploadByteArray, чтобы обновить большой двоичный объект, так как эти методы заменяют все блоки в большом двоичном объекте. Вместо этого обновляйте наименьшее возможное количество блоков с помощью методов PutBlock и PutBlockList.


##Сценарии выставления счетов за моментальные снимки


В следующих сценариях показано, как добавляется плата за большой двоичный объект и его моментальные снимки. 

В сценарии 1 базовый большой двоичный объект не обновлялся с момента создания моментального снимка, поэтому плата начисляется только за уникальные блоки 1, 2 и 3.

![Azure Storage Resources](./media/storage-blob-snapshots-billing/storage-blob-snapshots-billing-scenario-1.png)

В сценарии 2 базовый большой двоичный объект был обновлен, а моментальный снимок - нет. Блок 3 был обновлен, и, хотя он содержит такие же данные и тот же идентификатор, он отличается от блока 3 в моментальном снимке. В результате плата в учетной записи взимается за четыре блока.

![Azure Storage Resources](./media/storage-blob-snapshots-billing/storage-blob-snapshots-billing-scenario-2.png)

В сценарии 3 базовый большой двоичный объект был обновлен, а моментальный снимок - нет. Блок 3 был заменен блоком 4 в базовом большом двоичном объекте, но моментальный снимок по-прежнему отражает блок 3. В результате плата в учетной записи взимается за четыре блока.
 
![Azure Storage Resources](./media/storage-blob-snapshots-billing/storage-blob-snapshots-billing-scenario-3.png)

В сценарии 4 базовый большой двоичный объект был полностью обновлен и не содержит никаких первоначальных блоков. В результате плата в учетной записи взимается за все восемь уникальных блоков. Этот сценарий может произойти при использовании такого методов обновления, как UploadFile, UploadText, UploadFromStream или UploadByteArray, так как эти методы заменяют все содержимое больших двоичных объектов.

![Azure Storage Resources](./media/storage-blob-snapshots-billing/storage-blob-snapshots-billing-scenario-4.png)
<!--HONumber=47-->
