<properties 
	pageTitle="Настройка постоянного хранения для кэша Redis для Azure уровня Премиум" 
	description="Узнайте, как настроить постоянное хранение и управлять им для экземпляров кэша Redis для Azure уровня Премиум" 
	services="redis-cache" 
	documentationCenter="" 
	authors="steved0x" 
	manager="dwrede" 
	editor=""/>

<tags 
	ms.service="cache" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="cache-redis" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="09/30/2015" 
	ms.author="sdanie"/>

# Настройка постоянного хранения для кэша Redis для Azure уровня Премиум

Кэш Redis для Azure предлагает разные варианты кэша, которые обеспечивают гибкость в выборе размера и функций кэша, включая новый уровень Премиум, который на данный момент находится в предварительной версии.

Кэш Redis для Azure уровня Премиум включает кластеризацию, постоянное хранение данных и поддержку виртуальной сети. В этой статье описывается настройка постоянного хранения в экземпляре кэша Redis для Azure уровня Премиум.

Сведения об использовании других функций кэша уровня Премиум см. в статьях [Настройка кластеризации для кэша Redis для Azure уровня Премиум](cache-how-to-premium-clustering.md) и [Настройка поддержки виртуальной сети для кэша Redis для Azure уровня Премиум](cache-how-to-premium-vnet.md).

>[AZURE.NOTE]Кэш Redis для Azure уровня Премиум в данный момент находится в состоянии предварительной версии. В предварительной версии постоянное хранение нельзя использовать совместно с кластеризацией или виртуальными сетями.

## Что такое постоянное хранение?
Постоянное хранение Redis позволяет постоянно хранить данные, размещенные в Redis. Также можно создавать моментальные снимки и резервные копии данных, которые можно будет восстановить в случае сбоя оборудования. Это огромное преимущество по сравнению с уровнями Базовый и Стандартный, в которых все данные хранятся в памяти, и при сбое, когда узлы кэша становятся недоступными, может произойти потеря данных.

Кэш Redis для Azure предлагает постоянное хранение данных, при котором данные хранятся в учетной записи хранения Azure. Для общедоступной предварительной версии мы поддерживаем [модель RDB](http://redis.io/topics/persistence) и скоро будем поддерживать модель [AOF](http://redis.io/topics/persistence).

## Постоянное хранение
Если настроено постоянное хранение, кэш Redis для Azure будет сохранять моментальный снимок кэша Redis на диске в двоичном формате Redis в соответствии с настроенной частотой резервного копирования. В случае аварии, при которой становятся недоступными как основной экземпляр кэша, так и реплика кэша, кэш воссоздается на основе последнего моментального снимка.

Постоянное хранение настраивается во время создания кэша в колонке **Новый кэш Redis**. Для создания кэша войдите на [портал предварительной версии Azure](https://portal.azure.com), щелкните **Создать** -> **Данные + хранилище** > **Кэш Redis**.

![Создание кэша Redis][redis-cache-new-cache-menu]

Чтобы настроить постоянное хранение, сначала выберите один из кэшей уровня **Премиум** в колонке **Выбор ценовой категории**.

![Выберите ценовую категорию][redis-cache-premium-pricing-tier]

После выбора ценовой категории Премиум щелкните **Постоянное хранение Redis**.

![Постоянное хранение Redis][redis-cache-persistence]

Щелкните **Включено**, чтобы включить резервное копирование базы данных Redis.

В раскрывающемся списке выберите **Частоту резервного копирования**. Варианты включают **60 минут**, **6 часов**, **12 часов** и **24 часа**. Отсчет этого интервала начинается после успешного завершения предыдущей операции резервного копирования. По истечении этого интервала запускается новое резервное копирование.

Щелкните **Учетная запись хранения**, чтобы выбрать используемую учетную запись хранения. Поле **Ключ к хранилищу данных** заполняется автоматически, но если ключ для учетной записи хранения был создан повторно, вы можете обновить его в этом поле. Рекомендуется использовать **учетную запись хранения Премиум**, так как хранилище класса Premium имеет более высокую пропускную способность.

>[AZURE.NOTE]AOF не доступен для предварительной версии уровня Премиум, но команда разработчиков кэша работает над добавлением этой функции. Дополнительные сведения об RDB и AOF и преимуществах каждого см. в разделе [Постоянное хранение Redis](http://redis.io/topics/persistence).

![Постоянное хранение Redis][redis-cache-persistence-selected]

Щелкните **ОК** для сохранения конфигурации постоянного хранения.

После создания кэша первая резервная копия создается после истечения интервала резервного копирования.

## Часто задаваемые вопросы о постоянном хранении

Следующий список содержит ответы на часто задаваемые вопросы о постоянном хранении кэша Redis для Azure.

## Можно ли включить постоянное хранение для ранее созданного кэша?

В предварительной версии включить и настроить постоянное хранение можно только при создании кэша уровня Премиум. В общедоступной предварительной версии масштабирование с Базового и Стандартного уровня до уровня Премиум не поддерживается, но оно будет реализовано в ближайшее время.

## Можно ли изменить частоту резервного копирования после создания кэша?

В предварительной версии задать конфигурацию постоянного хранения можно только при создании кэша. Для изменения конфигурации постоянного хранения удалите кэш и создайте новый кэш с необходимыми настройками постоянного хранения. Это ограничение предварительной версии, и поддержка этой возможности ожидается в ближайшее время.

## Почему при установленной частоте резервного копирования 60 минут между созданием резервных копий проходит больше 60 минут?

Интервал резервного копирования не начинается, пока не завершится процесс предыдущего резервного копирования. Если интервал резервного копирования 60 минут и на процесс резервного копирования уходит 15 минут, следующее резервное копирование начнется не ранее чем через 75 минут после начала предыдущего резервного копирования.

## Что произойдет со старыми резервными копиями при создании новой?

Все резервные копии за исключением последней автоматически удаляются. Это удаление может происходить не сразу, но старые резервные копии не хранятся в течение неограниченного периода времени.

## Дальнейшие действия

Ознакомьтесь с другими функциями кэша уровня Премиум. – [Настройка кластеризации для кэша Redis для Azure уровня Премиум](cache-how-to-premium-clustering.md) – [Настройка поддержки виртуальной сети для кэша Redis для Azure уровня Премиум](cache-how-to-premium-vnet.md).
  
<!-- IMAGES -->

[redis-cache-new-cache-menu]: ./media/cache-how-to-premium-persistence/redis-cache-new-cache-menu.png

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-persistence/redis-cache-premium-pricing-tier.png

[redis-cache-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-persistence.png

[redis-cache-persistence-selected]: ./media/cache-how-to-premium-persistence/redis-cache-persistence-selected.png

<!---HONumber=Oct15_HO1-->