<properties 
	pageTitle="Настройка кластеризации для кэша Redis для Azure уровня Премиум" 
	description="Узнайте, как настроить кластеризацию и управлять ей для экземпляров кэша Redis для Azure уровня Премиум" 
	services="redis-cache" 
	documentationCenter="" 
	authors="steved0x" 
	manager="dwrede" 
	editor=""/>

<tags 
	ms.service="cache" 
	ms.workload="tbd" 
	ms.tgt_pltfrm="cache-redis" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="09/30/2015" 
	ms.author="sdanie"/>

# Настройка кластеризации для кэша Redis для Azure уровня Премиум
Кэш Redis для Azure предлагает разные варианты кэша, которые обеспечивают гибкость в выборе размера и функций кэша, включая новый уровень Премиум, который на данный момент находится в предварительной версии.

Кэш Redis для Azure уровня Премиум включает кластеризацию, постоянное хранение данных и поддержку виртуальной сети. В этой статье описывается настройка кластеризации в экземпляре кэша Redis для Azure уровня Премиум.

Сведения об использовании других функций кэша уровня Премиум см. в статьях [Настройка постоянного хранения для кэша Redis для Azure уровня Премиум](cache-how-to-premium-persistence.md) и [Настройка поддержки виртуальной сети для кэша Redis для Azure уровня Премиум](cache-how-to-premium-vnet.md).

>[AZURE.NOTE]Кэш Redis для Azure уровня Премиум в данный момент находится в состоянии предварительной версии.

## Что такое кластер Redis?
Кэш Redis для Azure предлагает кластер Redis в том виде, как это [реализовано в Redis](http://redis.io/topics/cluster-tutorial). При использовании кластера Redis вы получаете следующие преимущества.

-	Возможность автоматически разделить набор данных между несколькими узлами. 
-	Возможность продолжить работу, когда на подмножестве узлов возникают ошибки или они не могут обмениваться данными с остальной частью кластера. 
-	Более высокая пропускная способность: пропускная способность линейно увеличивается по мере увеличения числа сегментов. 
-	Больший объем памяти: объем памяти линейно увеличивается по мере увеличения числа сегментов.  

Дополнительные сведения о размере и пропускной способности для кэшей уровня Премиум см. в разделе [Часто задаваемые вопросы о кэше Redis для Azure](cache-faq.md#what-redis-cache-offering-and-size-should-i-use).

В Azure кластер Redis предоставляется в виде модели основного экземпляра и реплики. У каждого сегмента есть пара основного экземпляра и реплики. Репликацией управляет служба кэша Redis для Azure.

## Кластеризация
Кластер настраивается во время создания кэша в колонке **Новый кэш Redis**. Для создания кэша войдите на [портал предварительной версии Azure](https://portal.azure.com), щелкните **Создать** -> **Данные + хранилище** > **Кэш Redis**.

![Создание кэша Redis][redis-cache-new-cache-menu]

Чтобы настроить кластер, сначала выберите один из кэшей уровня **Премиум** в колонке **Выбор ценовой категории**.

![Выберите ценовую категорию][redis-cache-premium-pricing-tier]

Кластер настраивается в колонке **Кластер Redis**.

![Кластеризация][redis-cache-clustering]

Кластер может включать до 10 сегментов. Щелкните **Включено**, передвиньте ползунок или введите число от 1 до 10 для поля **Число сегментов** и нажмите кнопку **ОК**.

Каждый сегмент представляет собой пару основного экземпляра кэша и реплики кэша, которыми управляет Azure. Общий размер кэша вычисляется путем умножения количества сегментов на размер кэша, выбранный в ценовой категории.

![Кластеризация][redis-cache-clustering-selected]

После создания кэша вы подключаетесь к нему и пользуетесь им как некластеризованным кэшем, и Redis будет распространять данные по сегментам кэша.

## Часто задаваемые вопросы по кластеризации

В следующем списке приведены ответы на часто задаваемые вопросы о кластеризации кэша Redis для Azure.

## Каков максимальный размер кэша, который можно создать?

Максимальный размер кэша для уровня Премиум — 53 ГБ. Можно создать до 10 сегментов, таким образом общий максимальный размер составит 530 ГБ. Если требуется больший размер, вы можете [отправить запрос](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase) для получения дополнительного места. Дополнительные сведения см. в разделе [Цены на кэш Redis для Azure](https://azure.microsoft.com/pricing/details/cache/).

## Все ли клиенты Redis поддерживают кластеризацию?

В настоящее время не все клиенты Redis поддерживают кластеризацию. Например, ее не поддерживает StackExchange.Redis. Дополнительные сведения о других клиентах см. в разделе [Эксперименты с кластером](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) [Руководства по кластеру Redis](http://redis.io/topics/cluster-tutorial).

>[AZURE.NOTE]При использовании StackExchange.Redis в качестве клиента убедитесь, что используете [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 или более поздней версии для правильной работы кластеризации.

## Как подключиться к кэшу, если кластеризация включена?

К кэшу можно подключиться с теми же [конечными точками, портами и ключами](cache-configure.md#properties), которые используются для подключения к кэшу без кластеризации. Redis управляет кластеризацией на сервере, поэтому управлять ей из клиента не нужно.

## Можно ли напрямую подключаться к отдельным сегментам кэша?

Официально это не поддерживается. Тем не менее, каждый сегмент состоит основного кэша и реплики кэша, которые в совокупности называются экземпляром кэша. Подключиться к этим экземплярам кэша можно с помощью redis-cli.exe по следующей схеме.

Для non-ssl используйте следующие команды.

	Redis-cli.exe –h <<cachename>> -p 13000 (to connect to instance 0)
	Redis-cli.exe –h <<cachename>> -p 13001 (to connect to instance 1)
	Redis-cli.exe –h <<cachename>> -p 13002 (to connect to instance 2)
	...
	Redis-cli.exe –h <<cachename>> -p 1300N (to connect to instance N)

Для ssl замените `1300N` на `1500N`.

## Можно ли настроить кластеризацию для ранее созданного кэша?

В предварительной версии кластеризацию можно включить и настроить только при создании кэша.

## Можно ли настроить кластеризацию для кэша уровней Базовый и Стандартный?

Кластеризация доступна только для кэша уровня Премиум.

## Дальнейшие действия

Ознакомьтесь с другими функциями кэша уровня Премиум. – [Настройка постоянного хранения для кэша Redis для Azure уровня Премиум](cache-how-to-premium-persistence.md) – [Настройка поддержки виртуальной сети для кэша Redis для Azure уровня Премиум](cache-how-to-premium-vnet.md).
  
<!-- IMAGES -->

[redis-cache-new-cache-menu]: ./media/cache-how-to-premium-clustering/redis-cache-new-cache-menu.png

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-clustering/redis-cache-premium-pricing-tier.png

[NewCacheMenu]: ./media/cache-how-to-premium-clustering/redis-cache-new-cache-menu.png

[CacheCreate]: ./media/cache-how-to-premium-clustering/redis-cache-cache-create.png

[redis-cache-premium-pricing-group]: ./media/cache-how-to-premium-clustering/redis-cache-premium-pricing-group.png

[redis-cache-premium-features]: ./media/cache-how-to-premium-clustering/redis-cache-premium-features.png

[redis-cache-clustering]: ./media/cache-how-to-premium-clustering/redis-cache-clustering.png

[redis-cache-clustering-selected]: ./media/cache-how-to-premium-clustering/redis-cache-clustering-selected.png

<!---HONumber=Oct15_HO1-->