<properties 
   pageTitle="Настройка кэша Redis для Azure"
	description="Обзор конфигурации Redis по умолчанию для кэша Redis для Azure и описание способов настройки экземпляров кэша Redis для Azure"
	services="redis-cache"
	documentationCenter="na"
	authors="steved0x"
	manager="dwrede"
	editor="tysonn"/>
<tags 
   ms.service="cache"
	ms.devlang="na"
	ms.topic="article"
	ms.tgt_pltfrm="cache-redis"
	ms.workload="tbd"
	ms.date="08/25/2015"
	ms.author="sdanie"/>

# Настройка кэша Redis для Azure

В этом разделе рассказывается, как просмотреть и обновить конфигурацию экземпляров кэша Redis для Azure, и приводится конфигурация сервера Redis по умолчанию для экземпляров кэша Redis для Azure.

## Настройка параметров кэша Redis

Доступ к кэшу обеспечивается на [портале предварительной версии Azure](https://portal.azure.com) с помощью колонки **Обзор**.

![Колонка обзора кэша Redis для Azure](./media/cache-configure/IC796920.png)

Щелкните **Кэши Redis**, чтобы просмотреть свои экземпляры кэша.

![Список кэшей в обзоре кэша Redis для Azure](./media/cache-configure/IC796921.png)

Выберите необходимый кэш для просмотра его свойств.

![Все параметры кэша Redis](./media/cache-configure/IC808312.png)

Для просмотра и настройки кэша щелкните **Параметры** или **Все параметры**.

![Параметры кэша Redis](./media/cache-configure/IC808313.png)

## Свойства

Щелкните **Свойства** для просмотра сведений о вашем кэше, включая конечную точку и порты кэша.

![Свойства кэша Redis](./media/cache-configure/IC808314.png)

## Ключи доступа

Щелкните **Ключи доступа** для просмотра или повторного создания ключей доступа для вашего кэша. Эти ключи используются вместе с именем узла и портами из колонки **Свойства** клиентами, подключающимися к вашему кэшу.

![Ключи доступа кэша Redis](./media/cache-configure/IC808315.png)

## Порты доступа

Для новых кэшей без SSL порт по умолчанию отключен. Чтобы включить порт без SSL, щелкните колонку **Порты доступа**, а затем щелкните **Нет**.

![Порты доступа кэша Redis](./media/cache-configure/IC808316.png)

## Диагностика

Щелкните **Диагностика** для настройки учетной записи хранения, используемой для хранения диагностических данных по кэшу.

![Диагностика кэша Redis](./media/cache-configure/IC808317.png)

Дополнительную информацию см. в разделе [Мониторинг кэша Redis для Azure](cache-how-to-monitor.md).

## Политика максимальной памяти и зарезервированная максимальная память

Щелкните **Политика максимальной памяти**, чтобы настроить политики, связанные с памятью для кэша. Параметр **Политика максимальной памяти** определяет порядок удаления данных для кэша, а **Зарезервированная максимальная память** определяет объем памяти, зарезервированный для процессов, не связанных с кэшем.

![Политика максимальной памяти кэша Redis](./media/cache-configure/IC808318.png)

**Политика максимальной памяти** позволяет выбрать одну из следующих политик удаления данных.

-	volatile-lru — задано по умолчанию.
-	allkeys-lru
-	volatile-random
-	allkeys-random
-	volatile-ttl
-	noeviction

Дополнительные сведения о политиках максимальной памяти см. в разделе [Политики удаления данных](http://redis.io/topics/lru-cache#eviction-policies).

Параметр **зарезервированная максимальная память** определяет объем памяти в МБ, который резервируется для операций, не связанных с кэшем, таких как репликация при отработке отказов. Его можно использовать при высоком уровне фрагментации. Установка этого значения обеспечивает более согласованную работу сервера Redis при изменении нагрузки. Это значение должно быть выше при рабочих нагрузках с преобладанием записи. При резервировании памяти для таких операций она недоступна для хранения кэшированных данных.

>[AZURE.IMPORTANT]Параметр **зарезервированная максимальная память** доступен только для кэшей уровня Standard.

## Уведомления пространства ключей (дополнительные параметры)

Щелкните **Дополнительные параметры** для настройки уведомлений пространства ключей Redis. Уведомления пространства ключей позволяют клиентам получать уведомления при возникновении определенных событий.

![Дополнительные параметры кэша Redis](./media/cache-configure/IC808319.png)

>[AZURE.IMPORTANT]Уведомления пространства ключей и параметр **notify-keyspace-events** доступны только для кэшей уровня Standard.

Дополнительную информацию см. в разделе [Уведомления пространства ключей Redis](http://redis.io/topics/notifications). Пример кода см. в файле [KeySpaceNotifications.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/KeySpaceNotifications.cs), пример из [Hello world](https://github.com/rustd/RedisSamples/tree/master/HelloWorld).

## Пользователи и теги

![Пользователи и теги кэша Redis](./media/cache-configure/IC808320.png)

В разделе **Пользователи** предусматривается поддержка управления доступом на основе ролей (RBAC) на портале предварительной версии, чтобы помочь организациям просто и точно выполнять требования к управлению доступом. Дополнительные сведения см. в разделе [Управление доступом на основе ролей на портале предварительной версии Azure](http://go.microsoft.com/fwlink/?LinkId=512803).

Раздел **Теги** помогает в организации ресурсов. Дополнительные сведения см. в статье [Использование тегов для организации ресурсов Azure](../resource-group-using-tags.md).

## Конфигурация сервера Redis по умолчанию

Новые экземпляры кэша Redis для Azure имеют следующие значения конфигурации Redis по умолчанию.

>[AZURE.NOTE]Параметры в этом разделе нельзя изменить посредством метода `StackExchange.Redis.IServer.ConfigSet`. При вызове этого метода одной из команд в данном разделе, выдается исключение, аналогичное приведенным ниже:
>
>`StackExchange.Redis.RedisServerException: ERR unknown command 'CONFIG'`
>  
>Все настраиваемые значения, такие как **max-memory-policy**, настраиваются на портале предварительной версии.

|Настройка|Значение по умолчанию|Описание|
|---|---|---|
|databases|16|База данных по умолчанию — DB 0. Можно выбрать другую отдельно для каждого подключения с помощью connection.GetDataBase(dbid), где dbid — это число от 0 до 15.|
|maxclients|10 000|Это максимально допустимое количество одновременно подключенных клиентов. После достижения предела Redis закроет все новые подключения, отправив сообщение об ошибке "достигнуто максимальное количество клиентов".|
|maxmemory-policy|volatile-lru|Политика максимальной памяти — это параметр, определяющий то, как Redis будет выбирать, что следует удалить при достижении максимальной памяти (размер кэша, который предлагается задать при создании кэша). В случае с кэшем Redis для Azure значением по умолчанию является volatile-lru, когда удаляются ключи со сроком действия, устанавливаемым посредством алгоритма LRU. Этот параметр можно настроить на портале предварительной версии. Дополнительные сведения см. в разделе [Политика максимальной памяти и зарезервированная максимальная память](#maxmemory-policy-and-maxmemory-reserved).|
|maxmemory-samples|3|Алгоритмы LRU и минимальный TTL являются не точными, а аппроксимированными алгоритмами (в целях сохранения памяти), поэтому для проверки можно также выбрать размер образца. Например, по умолчанию Redis проверит три ключа и выберет один, использовавшийся наиболее давно.|
|lua-time-limit|5 000|Максимальное время выполнения сценария Lua в миллисекундах. При достижении максимального времени выполнения Redis сделает запись в журнале о нахождении данного сценария в процессе выполнения по истечении максимально допустимого времени и начнет отвечать на запросы ошибкой.|
|lua-event-limit|500|Это максимальный размер очереди событий сценариев.|
|client-output-buffer-limit normalclient-output-buffer-limit pubsub|0 0 032mb 8mb 60|Ограничения буферов вывода клиентов можно использовать для принудительного отключения клиентов, по каким-либо причинам недостаточно быстро считывающим данные с сервера (распространенной причиной является неспособность клиента Pub/Sub поглощать сообщения так же быстро, как их производит издатель). Дополнительные сведения см. в разделе [http://redis.io/topics/clients](http://redis.io/topics/clients).|

## Команды Redis не поддерживаются в кэше Redis для Azure

>[AZURE.IMPORTANT]Поскольку настройка и управление экземплярами кэша Redis для Azure осуществляется с помощью портала предварительной версии, следующие команды отключены. При попытке вызвать их вы получите сообщение об ошибке примерно следующего содержания: `"(error) ERR unknown command"`.
>
>-	BGREWRITEAOF
>-	BGSAVE
>-	CONFIG
>-	DEBUG
>-	MIGRATE
>-	СОХРАНИТЬ
>-	SHUTDOWN
>-	SLAVEOF

Дополнительные сведения о командах Redis см. на странице [http://redis.io/commands](http://redis.io/commands).

## Консоль Redis

В экземплярах кэша Redis для Azure можно безопасно выполнять команды с помощью **консоли Redis**, которая доступна для кэшей Standard. Для доступа к консоли Redis щелкните **Консоль** в колонке **Кэш Redis**.

![Консоль Redis](./media/cache-configure/redis-console-menu.png)

>[AZURE.IMPORTANT]Консоль Redis доступна только для кэшей Standard.

Чтобы выполнить команду в своем экземпляре кэша, просто введите нужную команду в консоль.

![Консоль Redis](./media/cache-configure/redis-console.png)

Список команд Redis, отключенных в кэше Redis для Azure, см. в предыдущем разделе [Команды Redis, не поддерживаемые в кэше Redis для Azure](#redis-commands-not-supported-in-azure-redis-cache). Дополнительные сведения о командах Redis см. на странице [http://redis.io/commands](http://redis.io/commands).

## Дальнейшие действия
-	Дополнительные сведения о работе с командами Redis см. в разделе [Как выполнять команды Redis?](cache-faq.md#how-can-i-run-redis-commands).

<!---HONumber=August15_HO9-->