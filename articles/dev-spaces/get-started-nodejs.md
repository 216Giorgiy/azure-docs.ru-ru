---
title: Создание среды разработки Node.js на основе Kubernetes в облаке с помощью VS Code | Документация Майкрософт
titleSuffix: Azure Dev Spaces
services: azure-dev-spaces
ms.service: azure-dev-spaces
ms.component: azds-kubernetes
author: ghogen
ms.author: ghogen
ms.date: 07/09/2018
ms.topic: tutorial
description: Быстрая разработка в Kubernetes с использованием контейнеров и микрослужб в Azure
keywords: Docker, Kubernetes, Azure, AKS, Azure Kubernetes Service, containers
manager: douge
ms.openlocfilehash: 76efbbb000635589af8e060bd30d62d021cee89c
ms.sourcegitcommit: 0a84b090d4c2fb57af3876c26a1f97aac12015c5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2018
ms.locfileid: "38623487"
---
# <a name="get-started-on-azure-dev-spaces-with-nodejs"></a>Начало работы в Azure Dev Spaces с Node.js

[!INCLUDE[](includes/learning-objectives.md)]

[!INCLUDE[](includes/see-troubleshooting.md)]

Теперь вы готовы создать среду разработки на основе Kubernetes в Azure.

[!INCLUDE[](includes/portal-aks-cluster.md)]

## <a name="install-the-azure-cli"></a>Установка Azure CLI
Для Azure Dev Spaces требуется минимальная настройка локального компьютера. Большая часть конфигурации среды разработки хранится в облаке и доступна для других пользователей. Начните со скачивания и запуска [Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest).

> [!IMPORTANT]
> Если интерфейс Azure CLI уже установлен, убедитесь, что используется версия 2.0.38 или выше.

[!INCLUDE[](includes/sign-into-azure.md)]

[!INCLUDE[](includes/use-dev-spaces.md)]

[!INCLUDE[](includes/install-vscode-extension.md)]

Ожидае создания кластера, можно начать писать код.

## <a name="create-a-nodejs-container-in-kubernetes"></a>Создание контейнера Node.js в Kubernetes

В этом разделе вы создадите веб-приложение Node.js и запустите его в контейнере в Kubernetes.

### <a name="create-a-nodejs-web-app"></a>Создание веб-приложения Node.js
Скачайте код из GitHub, перейдя по ссылке https://github.com/Azure/dev-spaces, и выберите **Clone or Download** (Клонировать или скачать), чтобы скачать репозиторий GitHub в локальную среду. Код для этого руководства находится в папке `samples/nodejs/getting-started/webfrontend`.

[!INCLUDE[](includes/azds-prep.md)]

[!INCLUDE[](includes/build-run-k8s-cli.md)]

### <a name="update-a-content-file"></a>Обновление файла содержимого
Azure Dev Spaces — это не просто среда выполнения кода в Kubernetes. Она позволяет быстро и итеративно видеть, как изменения вашего кода вступают в силу в среде Kubernetes в облаке.

1. Найдите файл `./public/index.html` и внесите изменения в HTML. Например, можно изменить цвет фона страницы на оттенок синего цвета:

    ```html
    <body style="background-color: #95B9C7; margin-left:10px; margin-right:10px;">
    ```

2. Сохраните файл. Через несколько мгновений в окне терминала вы увидите сообщение о том, что файл в запущенном контейнере обновлен.
1. Вернитесь в браузер и обновите страницу. Вы увидите обновление цвета.

Что произошло? Изменение файлов содержимого, таких как HTML и CSS, не требует перезапуска процесса Node.js, поэтому активная команда `azds up` автоматически синхронизирует любые измененные файлы содержимого непосредственно в запущенный контейнер в Azure, тем самым обеспечивая быстрый способ проверки изменений содержимого.

### <a name="test-from-a-mobile-device"></a>Тестирование с мобильного устройства
Откройте веб-приложение на мобильном устройстве с помощью общедоступного URL-адреса для webfrontend. Чтобы не вводить длинный адрес, можно скопировать и отправить URL-адрес с рабочего стола на устройство. Когда веб-приложение загрузится на мобильном устройстве, вы заметите, что пользовательский интерфейс не отображается должным образом на устройстве небольшого размера.

Чтобы устранить эту проблему, нужно добавить метатег `viewport`:
1. Откройте файл `./public/index.html`.
1. Добавьте метатег `viewport` в имеющийся элемент `head`:

    ```html
    <head>
        <!-- Add this line -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    ```

1. Сохраните файл.
1. Обновите браузер своего устройства. Теперь веб-приложение будет отображаться должным образом. 

Это пример того, как некоторые проблемы невозможно выявить, пока вы не протестируете приложение на устройствах, для которых оно предназначено. В Azure Dev Spaces вы можете быстро выполнять итерации кода и проверять любые изменения на целевых устройствах.

### <a name="update-a-code-file"></a>Обновление файла кода
Для обновления файлов кода на стороне сервера требуется немного больше работы, потому что приложение Node.js необходимо перезапустить.

1. В окне терминала нажмите клавишу `Ctrl+C` (чтобы остановить `azds up`).
1. Откройте файл кода с именем `server.js` и измените приветственное сообщение службы: 

    ```javascript
    res.send('Hello from webfrontend running in Azure!');
    ```

3. Сохраните файл.
1. Запустите `azds up` в окне терминала. 

Это перестроит образ контейнера и перераспределит диаграмму Helm. Перезагрузите страницу браузера, чтобы увидеть, как изменения вашего кода вступают в силу.

Но есть еще один *более быстрый метод* разработки кода, который вы рассмотрите в следующем разделе. 

## <a name="debug-a-container-in-kubernetes"></a>Отладка контейнера в Kubernetes

[!INCLUDE[](includes/debug-intro.md)]

[!INCLUDE[](includes/init-debug-assets-vscode.md)]

### <a name="select-the-azds-debug-configuration"></a>Выбор конфигурации отладки AZDS
1. Чтобы открыть представление отладки, щелкните значок "Отладка" на **панели действия** сбоку VS Code.
1. Выберите **Launch Program (AZDS)** (Запустить программу (AZDS)) как активную конфигурацию отладки.

![](media/get-started-node/debug-configuration-nodejs2.png)

> [!Note]
> Если вы не видите никаких команд Azure Dev Spaces на палитре команд, убедитесь, что вы [установили расширение VS Code для Azure Dev Spaces](get-started-nodejs.md#get-kubernetes-debugging-for-vs-code).

### <a name="debug-the-container-in-kubernetes"></a>Отладка контейнера в Kubernetes
Нажмите клавишу **F5**, чтобы отладить ваш код в Kubernetes.

Подобно команде `up`, код синхронизируется со средой разработки при запуске отладки, и выполняется сборка и развертывание контейнера в Kubernetes. На этот раз отладчик подключен к удаленному контейнеру.

[!INCLUDE[](includes/tip-vscode-status-bar-url.md)]

Установите точку останова в файле кода на стороне сервера, например в `app.get('/api'...` внутри `server.js`. Обновите страницу браузера или нажмите кнопку Say It Again (Повторить это), и вы достигнете точки останова и сможете осуществить пошаговое выполнение кода.

У вас есть полный доступ к отладочной информации, как если бы код выполнялся локально, например к стеку вызовов, локальным переменным, информации об исключениях и т. д.

### <a name="edit-code-and-refresh-the-debug-session"></a>Изменение кода и обновление сеанса отладки
Измените код при активном отладчике. Например, еще раз измените приветствие:

```javascript
app.get('/api', function (req, res) {
    res.send('**** Hello from webfrontend running in Azure! ****');
});
```

Сохраните файл и в области **действий отладки** нажмите кнопку **Обновить**. 

![](media/get-started-node/debug-action-refresh-nodejs.png)

Вместо повторной сборки и развертывания нового образа контейнера при каждой правке кода, что часто занимает немало времени, Azure Dev Spaces перезапустит процесс Node.js между сеансами отладки, чтобы ускорить цикл правки и отладки.

Обновите веб-приложение в браузере или нажмите кнопку *Say It Again* (Повторить это). Вы должны увидеть настраиваемое сообщение в пользовательском интерфейсе.

### <a name="use-nodemon-to-develop-even-faster"></a>Использование NodeMon для ускоренной разработки
*Nodemon* — это популярное средство, которое разработчики Node.js используют для быстрой разработки. Вместо того чтобы вручную перезапускать процесс Node при каждой правке кода на стороне сервера, разработчики часто настраивают в проекте Node средство *nodemon*, которое отслеживает изменения файла и автоматически перезапускает процесс сервера. В таком режиме работы разработчик просто обновляет браузер после внесения изменений в код.

В Azure Dev Spaces вы можете использовать много тех же рабочих процессов разработки, которые вы используете при локальной разработке. Чтобы проиллюстрировать этот принцип, в примере проекта `webfrontend` используется *nodemon* (он настроен как зависимость разработки в `package.json`).

Попробуйте сделать следующее.
1. Остановите отладчик VS Code.
1. Щелкните значок "Отладка" в **строке действий** в боковой части VS Code. 
1. Выберите **Attach (AZDS)** (Присоединить (AZDS)) как активную конфигурацию отладки.
1. Нажмите клавишу F5.

В этой конфигурации контейнер настроен запускать *nodemon*. При внесении изменений в код сервера *nodemon* автоматически перезапускает процесс Node, как при локальной разработке. 
1. Измените сообщение hello снова на `server.js` и сохраните файл.
1. Обновите браузер или нажмите кнопку *​​Say It Again* (Повторить это), чтобы увидеть свои изменения.

**Теперь у вас есть метод быстрой итерации кода и отладки непосредственно в Kubernetes**. Далее вы узнаете, как создать и вызвать второй контейнер.

## <a name="next-steps"></a>Дополнительная информация

> [!div class="nextstepaction"]
> [См. дополнительные сведения о коллективной разработке](team-development-nodejs.md)

