---
title: Обновление модулей Azure в службе автоматизации Azure
description: В этой статье описывается, как можно обновить общие модули Azure PowerShell, предоставленные по умолчанию в службе автоматизации Azure.
services: automation
ms.service: automation
ms.component: process-automation
author: georgewallace
ms.author: gwallace
ms.date: 09/19/2018
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: fbb57753117f3c60010fe910616b8d0af5178360
ms.sourcegitcommit: 7c4fd6fe267f79e760dc9aa8b432caa03d34615d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/28/2018
ms.locfileid: "47434829"
---
# <a name="how-to-update-azure-powershell-modules-in-azure-automation"></a>Как обновить модули Azure PowerShell в службе автоматизации Azure

Наиболее распространенные модули Azure PowerShell приведены в каждой учетной записи автоматизации по умолчанию. Группа разработчиков Azure регулярно обновляет модули Azure, поэтому в учетной записи службы автоматизации мы предоставляем способ обновления модулей в учетной записи, когда на портале доступны новые версии.

Так как модули регулярно обновляются специалистами группы продуктов, то изменения могут затронуть и входящие в них командлеты, что может негативно повлиять на работу модулей Runbook. Это зависит от типа изменения. Например, возможно переименование параметра или полное прекращение поддержки одного из командлетов. Чтобы избежать негативного влияния на модули runbook и автоматизируемые ими процессы, рекомендуется выполнять предварительное тестирование и проверку. Если у вас нет выделенной учетной записи службы автоматизации, предназначенной для этой цели, то рекомендуется ее создать, чтобы протестировать различные сценарии и перестановки в процессе разработки модулей Runbook, а также повторяющиеся изменения, такие как обновления модулей PowerShell. После проверки результатов и применения необходимых изменений можно перейти к процессу переноса измененных модулей runbook и выполнить следующее обновление в рабочей среде.

> [!NOTE]
> Новая учетная запись службы автоматизации может не содержать последние модули.

## <a name="updating-azure-modules"></a>Обновление модулей Azure

1. На странице "Модули" вашей учетной записи службы автоматизации есть параметр **Обновить модули Azure**. Он всегда включен.<br><br> ![Параметр "Обновить модули Azure" на странице "Модули"](media/automation-update-azure-modules/automation-update-azure-modules-option.png)

  > [!NOTE]
  > Перед обновлением модулей Azure рекомендуется обновить их в тестовой учетной записи автоматизации. Это позволит до обновления убедиться в том, что существующие скрипты работают ожидаемым образом.
  >
  > Кнопка **Обновить модули Azure** доступна только в общедоступном облаке. Она недоступна в [независимых регионах](https://azure.microsoft.com/global-infrastructure/). Дополнительные сведения см. в разделе [Альтернативные способы обновления модулей](#alternative-ways-to-update-your-modules).


2. Щелкните **Обновить модули Azure**, после чего появится уведомление с запросом о продолжении.<br><br> ![Уведомление об обновлении модулей Azure](media/automation-update-azure-modules/automation-update-azure-modules-popup.png)

3. Щелкните **Да**, чтобы начать процесс обновления модулей. Процесс обновления следующих модулей занимает около 15–20 минут:

  * Таблицы Azure
  * Azure.Storage;
  * AzureRm.Automation;
  * AzureRm.Compute;
  * AzureRm.Profile;
  * AzureRm.Resources;
  * AzureRm.Sql;
  * AzureRm.Storage.

    Если модули уже обновлены, процесс будет завершен через несколько секунд. После завершения процесса обновления вы получите уведомление.<br><br> ![Состояние обновления Update Azure Modules (Обновление модулей Azure)](media/automation-update-azure-modules/automation-update-azure-modules-updatestatus.png)

    Модули .NET Core AzureRm (AzureRm.*.Core) не поддерживаются в службе автоматизации Azure и не могут быть импортированы.

> [!NOTE]
> При запуске нового запланированного задания служба автоматизации Azure использует модули последней версии в вашей учетной записи службы автоматизации.  

При использовании командлетов из этих модулей Azure PowerShell в модулях runbook этот процесс обновления необходимо выполнять примерно каждый месяц, чтобы гарантировать наличие последних модулей. Служба автоматизации Azure использует подключение AzureRunAsConnection для проверки подлинности при обновлении модулей. Если срок действия субъекта-службы истек или он больше не существует на уровне подписки, обновление модуля завершится сбоем.

## <a name="alternative-ways-to-update-your-modules"></a>Альтернативные способы обновления модулей

Как уже упоминалось, кнопка **Обновить модули Azure** недоступна в независимых облаках. Она доступна только в глобальном облаке Azure. Это связано с тем фактом, что последняя версия модулей Azure PowerShell из коллекции PowerShell может не работать со службами Resource Manager, развернутыми в настоящее время в этих облаках.

Обновление модулей по-прежнему возможно путем импорта модуля Runbook [Update-AzureModule.ps1](https://github.com/azureautomation/runbooks/blob/master/Utility/ARM/Update-AzureModule.ps1) в учетную запись службы автоматизации и его запуска.

Для передачи нужной среды в модуль Runbook используйте параметр `AzureRmEnvironment`.  Приемлемые значения: **AzureCloud**, **AzureChinaCloud**, **AzureGermanCloud** и **AzureUSGovernmentCloud**. Если не передать значение этому параметру, модуль Runbook по умолчанию будет использовать общедоступное облако Azure **AzureCloud**.

Если нужно использовать конкретную версию модуля Azure PowerShell вместо последней доступной в коллекции PowerShell, передайте эти версии в необязательном параметре `ModuleVersionOverrides` модуля Runbook **Update-AzureModule**. Примеры см. в модуле Runbook [Update-AzureModule.ps1](https://github.com/azureautomation/runbooks/blob/master/Utility/ARM/Update-AzureModule.ps1). Модули Azure PowerShell, которые не упомянуты в параметре `ModuleVersionOverrides`, обновляются до последних версий из коллекции PowerShell. Если в параметре `ModuleVersionOverrides` не передано ничего, все модули обновляются последними версиями из коллекции PowerShell, как при нажатии кнопки **Обновить модули Azure**.

## <a name="next-steps"></a>Дополнительная информация

* Дополнительные сведения о модулях интеграции и создании настраиваемых модулей для дальнейшей интеграции службы автоматизации с другими системами, службами и решениями см. в статье [Модули интеграции службы автоматизации Azure](automation-integration-modules.md).

* Попробуйте интегрировать систему управления версиями с помощью [GitHub Enterprise](automation-scenario-source-control-integration-with-github-ent.md) или [Azure DevOps](automation-scenario-source-control-integration-with-vsts.md), чтобы централизованно управлять выпусками своих модулей Runbook службы автоматизации и набором конфигураций.  
