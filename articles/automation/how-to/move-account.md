---
title: Перемещение учетной записи службы автоматизации Azure в другую подписку
description: В этой статье описывается Перемещение учетной записи службы автоматизации в другую подписку
services: automation
ms.service: automation
ms.subservice: process-automation
author: georgewallace
ms.author: gwallace
ms.date: 03/11/2019
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: 01f3995a80375f2deada13c36c48600243a17623
ms.sourcegitcommit: 1902adaa68c660bdaac46878ce2dec5473d29275
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2019
ms.locfileid: "57733095"
---
# <a name="move-your-automation-account-to-another-subscription"></a>Перемещение учетной записи службы автоматизации в другую подписку

Azure предоставляет возможность переместить некоторые ресурсы в новую группу ресурсов или подписки с одним клиентом в исходном формате через портал Azure, PowerShell, Azure CLI или REST API. Дополнительные сведения о процессе, см. в разделе [перемещение ресурсов в новую группу ресурсов или подписки](../../azure-resource-manager/resource-group-move-resources.md). Учетные записи службы автоматизации, один из ресурсов, которые могут быть перемещены, но существуют особые действия, необходимые при перемещении учетной записи службы автоматизации.

Ниже перечислены основные действия по переносу учетной записи службы автоматизации для:

* Удаление решения
* Удалить связь с рабочей области
* Перемещение учетной записи службы автоматизации
* Удалите и создайте ее повторно с учетными записями
* Повторное включение решения

## <a name="remove-solutions"></a>Удаление решения

Чтобы отменить привязку рабочую область из учетной записи службы автоматизации, изменений и инвентаризации, управления обновлениями и запуск и остановка виртуальных машин в off часа решениях необходимо удалить из рабочей области.

В группе ресурсов, выберите каждую **решение** и нажмите кнопку **удалить**. На **удалить ресурсы** убедитесь, ресурсов, который необходимо удалить и нажмите кнопку **удалить**.

![Удаление решения с помощью портала Azure](../media/move-account/delete-solutions.png)

Можно выполнить ту же задачу с [Remove-AzureRmResource](/powershell/module/azurerm.resources/remove-azurermresource) командлета, как показано в следующем примере:

```azurepowershell-interactive
$workspaceName = <myWorkspaceName>
$resourceGroupName = <myResourceGroup>
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "ChangeTracking($workspaceName)" -ResourceGroupName $resourceGroupName
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "Updates($workspaceName)" -ResourceGroupName $resourceGroupName
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "Start-Stop-VM($workspaceName)" -ResourceGroupName $resourceGroupName
```

### <a name="additional-steps-for-startstop-vms"></a>Дополнительные действия для запуска и остановки виртуальных машин

Для **запуск и остановка виртуальной Машины** решение, необходимо также удалить правила генерации оповещений, созданных решением.

На портале Azure, перейдите к группе ресурсов и выберите **оповещения** под **мониторинг**. На **оповещения** выберите **Управление правилами генерации оповещений**

![Оповещения страницы, на которой показана нажатия на Управление предупреждениями правила](../media/move-account/alert-rules.png)

На **правила** страницы, вы должны увидеть список всех оповещений, настроенных в этой группе ресурсов. **Запуск и остановка виртуальных машин** решение создает 3 правила генерации оповещений

* AutoStop_VM_Child
* ScheduledStartStop_Parent
* SequencedStartStop_Parent

Выберите эти 3 правила генерации оповещений и нажмите кнопку **удалить**. Это действие удалит эти правила генерации оповещений.

![Правила страницы с правилами выбран и будет удален](../media/move-account/delete-rules.png)

> [!NOTE]
> Если вы не видите никаких правил оповещений на **правила** странице **состояние** Показать **отключена** оповещения, как вы выключены.

После удаления правила генерации оповещений, необходимо удалить группы действий, которая была создана для получения уведомлений для решения запуск и остановка виртуальной Машины.

На портале Azure перейдите к **монитор**выберите **оповещения**и нажмите кнопку **управлять группами действий**.

Выберите группу действий из списка, он будет иметь имя **StartStop_VM_Notification**. На странице группы "действие", нажмите кнопку **удалить**

![Страница группы действий, кнопку "Удалить"](../media/move-account/delete-action-group.png)

Аналогичным образом вы можете удалить группу действий с помощью PowerShell. Это действие выполняется с помощью [Remove-azurermactiongroup:](/powershell/module/azurerm.insights/remove-azurermactiongroup) командлет, как показано в следующем примере:

```azurepowershell-interactive
Remove-AzureRmActionGroup -ResourceGroupName <myResourceGroup> -Name StartStop_VM_Notification
```

## <a name="unlink-your-workspace"></a>Удалить связь с рабочей области

На портале Azure перейдите к вашей **учетной записи службы автоматизации**. В разделе **связанные ресурсы**, нажмите кнопку **рабочей области связанные**. Нажмите кнопку **связь с рабочей областью** связь с рабочей областью, из учетной записи службы автоматизации.

![Отмена связи рабочую область из учетной записи службы автоматизации](../media/move-account/unlink-workspace.png)

## <a name="move-your-automation-account"></a>Перемещение учетной записи службы автоматизации

После удаления всех предыдущих элементов, вы можете удалить учетную запись службы автоматизации и свои модули Runbook. На портале Azure перейдите к группе ресурсов из учетной записи службы автоматизации. Выберите **переместить** и затем **переместить в другую подписку**.

![Странице группы ресурсов, выбрав перемещения в другую подписку](../media/move-account/move-resources.png)

Выберите ресурсы в группе ресурсов, которую требуется переместить. Убедитесь, включены в **учетной записи службы автоматизации**, **Runbook**, и **рабочей области Log Analytics** ресурсы.

После завершения перемещения некоторые дополнительные действия, которые необходимо выполнить, чтобы подготовить систему к работе.

## <a name="recreate-run-as-accounts"></a>Повторное создание выполнения в качестве учетных записей

[Run As Accounts](../manage-runas-account.md) создать субъект-службу в Azure Active Directory для проверки подлинности с ресурсами Azure. При изменении подписки в существующей учетной записи запуска от имени больше не доступен для учетной записи службы автоматизации.

Перейдите к учетной записи службы автоматизации в новую подписку и выберите **выполняются с учетными записями** под **параметры учетной записи**. Вы увидите, что Run As Accounts Показать как незавершенная теперь.

![Run As Accounts отображается как не завершено](../media/move-account/run-as-accounts.png)

Нажмите кнопку каждого запуска в качестве учетной записи и на **свойства** щелкните **удалить** для удаления учетной записи запуска.

> ! [ПРИМЕЧАНИЕ] Если у вас нет разрешений для создания или просмотра запуска от имени учетных записей, вы увидите следующее сообщение `You do not have permissions to create an Azure Run As account (service principal) and grant the Contributor role to the service principal.`. Дополнительные сведения о разрешениях, необходимых для настройки учетной записи запуска от имени, см. в разделе [разрешения, необходимые для настройки учетных записей запуска от имени](../manage-runas-account.md#permissions).

После удаления записей, нажмите кнопку **создать** на **Azure запись запуска от имени**. На **добавить Azure учетной записи запуска** щелкните **создать** для создания учетной записи запуска и субъекта-службы. Повторите предыдущие шаги с **Azure классической учетной записи запуска от**.

## <a name="enable-solutions"></a>включение решений;

После Run As Accounts созданы заново, будет включена снова решения, которые необходимо удалить до перемещения. Чтобы включить **отслеживания изменений и инвентаризации** и **управления обновлениями**, выберите соответствующие возможности в учетной записи службы автоматизации. Выберите рабочую область Log Analytics, перемещении по и нажмите кнопку **включить**.

![Повторное включение решения в перемещенной учетной записи службы автоматизации](../media/move-account/reenable-solutions.png)

Компьютеры, которые будут подключены с решениями появится снова, так как вы подключаетесь существующую рабочую область Log Analytics.

Чтобы снова включить запуск и остановка виртуальных машин во время решения нерабочее время, необходимо повторно развернуть решение. В разделе **связанные ресурсы**выберите **запуск и остановка виртуальной Машины**. Нажмите кнопку **Получите подробные сведения и включите решение** и нажмите кнопку **создать** чтобы начать развертывание.

На **добавить решение** страницы, выбрать рабочую область Log Analytics и учетной записи службы автоматизации.  

![Run As Accounts отображается как не завершено](../media/move-account/add-solution-vm.png)

Подробные инструкции по настройке решения, см. в разделе [запуск и остановка виртуальных машин в нерабочее время решения в службе автоматизации Azure](../automation-solution-vm-management.md)

## <a name="post-move-verification"></a>Проверка перемещения POST

После завершения перемещения не забудьте проверить различные сценарии в вашей учетной записи службы автоматизации, чтобы убедиться, что все работает должным образом. Следующая таблица показывает список задач, которые необходимо проверить после завершения перемещения:

|Функция|Тесты|Устранение неполадок связи|
|---|---|---|
|Модули Runbook|Модуль Runbook можно успешно запустить и подключиться к ресурсам Azure.|[Устранение неполадок с модулями Runbook](../troubleshoot/runbooks.md)
| Система управления версиями|Необходимо выполнить синхронизацию вручную на вашего репозитория системы управления версиями.|[Интеграция системы управления версиями](../source-control-integration.md)|
|Отслеживание изменений и инвентаризация|Убедитесь, что вы видите текущие данные инвентаризации с машин.|[Устранение неполадок с отслеживанием изменений](../troubleshoot/change-tracking.md)|
|управление обновлениями;|Убедитесь, вы видите на компьютерах, и они Исправен</br>Выполните тестовое развертывание обновления программного обеспечения.|[Устранение неполадок управления обновлениями](../troubleshoot/update-management.md)|

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о перемещении ресурсов в Azure, см. в разделе [перемещение ресурсов в Azure](../../azure-resource-manager/move-support-resources.md)
