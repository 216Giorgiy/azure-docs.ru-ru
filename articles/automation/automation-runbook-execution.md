<properties
   pageTitle="Выполнение модуля Runbook в службе автоматизации Azure"
   description="Рассматривается обработка модуля Runbook в службе автоматизации Azure."
   services="automation"
   documentationCenter=""
   authors="bwren"
   manager="stevenka"
   editor="tysonn" />
<tags
   ms.service="automation"
   ms.devlang="na"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="04/28/2015"
   ms.author="bwren" />

# Выполнение модуля Runbook в службе автоматизации Azure


При запуске модуля Runbook в службе автоматизации Azure создается задание. Задание — это одиночный выполняемый экземпляр модуля Runbook. Рабочий процесс службы автоматизации Azure назначается для выполнения каждого задания. Пока рабочие процессы используются несколькими учетными записями Azure, задания от различных учетных записей службы автоматизации изолируются друг от друга. Вы не контролируете, какой рабочий процесс будет обслуживать запрос для вашего задания. В одном модуле Runbook могут иметься несколько запущенных заданий одновременно. При просмотре списка модулей Runbook на портале Azure в нем отобразится список состояний последнего задания для каждого модуля Runbook. Можно просматривать список заданий для каждого модуля Runbook и отслеживать состояние каждого из них. Описание различных состояний заданий см. в разделе [Состояния заданий](automation-viewing-the-status-of-a-runbook-job.md#job-statuses).

![Состояния заданий](./media/automation-runbook-execution/job-statuses.png)


Задания будут иметь доступ к ресурсам Azure за счет подключения к ресурсам подписки Azure. Задания получают доступ к ресурсам в центре обработки данных, если эти ресурсы доступны из общедоступного облака.

## Разрешения

Модулям Runbook службы автоматизации Azure необходим доступ к ресурсам по подписке Azure. В разделе [Проверка подлинности Azure при помощи Azure Active Directory](http://aka.ms/runbookauthor/authentication) рассматривается настройка Azure Active Directory и [учетные данные]() в службе автоматизации Azure для проверки подлинности в ресурсах Azure. В разделе также содержатся сведения об использовании [командлета Add-AzureAccount](http://aka.ms/runbookauthor/azurecmdlets/addazureaccount) для доступа к ресурсам Azure в создаваемых моделях Runbook. Требования к безопасности отдельных импортируемых модулей Runbook см. в документации к ним.

## Fair share

Для совместного использования ресурсов среди всех модулей Runbook в облаке служба автоматизации Azure временно выгружает любое задание после того, как его выполнение продолжалось в течение 3 часов, и запускает его с последней [контрольной точки](http://aka.ms/runbookauthor/checkpoints). В течение этого времени для задания отображается состояние "Выполнение, ожидание ресурсов". Если модуль Runbook не имеет контрольных точек или задание не дошло до первой контрольной точки перед выгрузкой, то оно будет перезапущено с самого начала.

Если модуль Runbook перезапускается с той же контрольной точки или с самого начала три раза подряд, его работа принудительно завершается и модулю присваивается состояние "Сбой, ожидание ресурсов". Это необходимо, чтобы защитить систему от постоянного перезапуска модулей Runbook без завершения их работы, поскольку они не смогут достигнуть следующей контрольной точки без повторной выгрузки. В этом случае возникает следующее исключение со сбоем.

Невозможно продолжить выполнение задания, поскольку оно было несколько раз прекращено до достижения контрольной точки. Убедитесь, что модуль Runbook не выполняет продолжительные операции без сохранения состояния.

При создании модуля Runbook следует убедиться, что время для выполнения всех действий между двумя контрольными точками не превышает 3 часов. При необходимости добавьте контрольные точки в модуль Runbook, чтобы выполнение задач в нем не превышало 3 часов. Разбейте на отдельные части те операции, выполнение которых занимает много времени. Например, модуль Runbook может выполнять повторную индексацию в крупной базе данных SQL. Если эта одиночная операция не завершится с учетом справедливого распределения ресурсов, то задание будет выгружено и перезапущено с самого начала. В этом случае следует разбить операцию повторного индексирования на несколько шагов, например повторное индексирование одной таблицы, после чего выполняется вставка контрольной точки после каждой операции, чтобы задание могло возобновиться после завершения последней операции.

## Связанные статьи

- [Запуск модуля Runbook в службе автоматизации Azure](automation-starting-a-runbook)
- [Просмотр состояния задания Runbook службы автоматизации Azure](automation-viewing-the-status-of-a-runbook-job)
 

<!---HONumber=58_postMigration-->