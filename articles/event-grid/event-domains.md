---
title: Домены событий в службе "Сетка событий Azure"
description: В этой статье описано использование Доменов событий для управления разделами в службе "Сетка событий Azure".
services: event-grid
author: banisadr
ms.service: event-grid
ms.author: babanisa
ms.topic: conceptual
ms.date: 10/30/2018
ms.openlocfilehash: fe66ca8b8f5b4474290e302f73b35868dce68caa
ms.sourcegitcommit: 6135cd9a0dae9755c5ec33b8201ba3e0d5f7b5a1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50669331"
---
# <a name="understand-event-domains-for-managing-event-grid-topics"></a>Сведения о Доменах событий, используемых для управления разделами службы "Сетка событий Azure"

В этой статье описывается, как использовать Домены событий для управления потоком настраиваемых событий для различных бизнес-организаций, клиентов или приложений. Домены событий можно использовать для выполнения следующих задач:

* Управление мультитенантными архитектурами обработки событий в масштабе.
* Управление аутентификацией и авторизацией.
* Распределение разделов без необходимости управлять каждым из них по отдельности.
* Избежание индивидуальной публикации в каждой конечной точке раздела.

[!INCLUDE [event-grid-preview-feature-note.md](../../includes/event-grid-preview-feature-note.md)]


## <a name="event-domains-overview"></a>Общие сведения о Доменах событий

Домен событий — это инструмент управления для большого количества разделов Сетки событий, связанных с одним и тем же приложением. Его можно считать метаразделом, который может содержать тысячи отдельных разделов.

Благодаря Доменам событий в архитектуре таких служб Azure, как служба хранилища и Центр Интернета вещей, появляется возможность публикации событий, чтобы вы могли использовать их в своей системе. Они позволяют публиковать события во множестве разделов. Домены также обеспечивают авторизацию и аутентификацию в каждом разделе, чтобы вы могли разделить свои клиенты.

### <a name="example-use-case"></a>Примеры использования

Работу Доменов событий можно легко объяснить с помощью примера. Допустим, вы запустили строительный механизм Contoso для производства тракторов, землеройного оборудования и другого тяжелого оборудования. В рамках ведения бизнеса вы отправляете клиентам сведения в режиме реального времени об обслуживании оборудования, работоспособности системы, обновлениях контрактов и т. д. Вся эта информация поступает на различные конечные точки, включая ваше приложение, конечные точки клиента и другие настроенные компоненты инфраструктуры.

Домены событий позволяют моделировать строительный механизм Contoso как единый объект событий. Каждый из ваших клиентов представлен как раздел в Домене, а аутентификация и авторизация обрабатывается с помощью Azure Active Directory. Каждый из этих клиентов может подписаться на свой раздел и настроить отправку событий в него. Благодаря управляемому доступу через Домен событий клиенты получают доступ только к своим разделам.

Вы также получаете единую конечную точку, в которой можете публиковать все ваши клиентские события. Служба "Сетка событий" уведомляет каждый раздел о событиях клиента.

![Пример конструкции Contoso](./media/event-domains/contoso-construction-example.png)

## <a name="access-management"></a>управление доступом

 Использование Домена гарантирует вам точное управление авторизацией и аутентификацией в каждом разделе за счет применения проверки доступа на основе ролей Azure (RBAC). С помощью этих ролей вы можете ограничивать каждого клиента в приложении для использования только тех разделов, к которым вы хотите предоставить доступ.

Проверка доступа на основе ролей (RBAC) в Доменах событий работает так же, как [управляемый контроль доступа](https://docs.microsoft.com/azure/event-grid/security-authentication#management-access-control) в остальной части Сетки событий и Azure. Используйте RBAC для создания и применения определений настраиваемых ролей в Доменах событий.

### <a name="built-in-roles"></a>Встроенные роли

В целях упрощения RBAC в службе "Сетка событий" доступны два определения встроенных ролей:

#### <a name="eventgrid-eventsubscription-contributor-preview"></a>участник EventGrid EventSubscription (предварительная версия)

```json
[
  {
    "Description": "Lets you manage EventGrid event subscription operations.",
    "IsBuiltIn": true,
    "Id": "428e0ff05e574d9ca2212c70d0e0a443",
    "Name": "EventGrid EventSubscription Contributor (Preview)",
    "IsServiceRole": false,
    "Permissions": [
      {
        "Actions": [
          "Microsoft.Authorization/*/read",
          "Microsoft.EventGrid/eventSubscriptions/*",
          "Microsoft.EventGrid/topicTypes/eventSubscriptions/read",
          "Microsoft.EventGrid/locations/eventSubscriptions/read",
          "Microsoft.EventGrid/locations/topicTypes/eventSubscriptions/read",
          "Microsoft.Insights/alertRules/*",
          "Microsoft.Resources/deployments/*",
          "Microsoft.Resources/subscriptions/resourceGroups/read",
          "Microsoft.Support/*"
        ],
        "NotActions": [],
        "DataActions": [],
        "NotDataActions": [],
        "Condition": null
      }
    ],
    "Scopes": [
      "/"
    ]
  }
]
```

#### <a name="eventgrid-eventsubscription-reader-preview"></a>и читатель EventGrid EventSubscription (предварительная версия).

```json
[
  {
    "Description": "Lets you read EventGrid event subscriptions.",
    "IsBuiltIn": true,
    "Id": "2414bbcf64974faf8c65045460748405",
    "Name": "EventGrid EventSubscription Reader (Preview)",
    "IsServiceRole": false,
    "Permissions": [
      {
        "Actions": [
          "Microsoft.Authorization/*/read",
          "Microsoft.EventGrid/eventSubscriptions/read",
          "Microsoft.EventGrid/topicTypes/eventSubscriptions/read",
          "Microsoft.EventGrid/locations/eventSubscriptions/read",
          "Microsoft.EventGrid/locations/topicTypes/eventSubscriptions/read",
          "Microsoft.Resources/subscriptions/resourceGroups/read"
        ],
        "NotActions": [],
        "DataActions": [],
        "NotDataActions": []
       }
    ],
    "Scopes": [
      "/"
    ]
  }
]
```

## <a name="subscribing-to-topics"></a>Подписка на разделы

Подписка на события в разделе в Домене событий похожа на [создание подписки на события в настраиваемом разделе](./custom-event-quickstart.md) или на подписку на любое из встроенных предложений издателей событий Azure.

### <a name="domain-scope-subscriptions"></a>Подписки на область Домена

Домены событий также позволяют оформить подписку на область Домена. В случае подписки на события в Домене событий вы получаете все события, отправленные в Домен, независимо от раздела, в который они отправляются. Подписки на область Домена могут быть необходимы для целей управления и аудита.

## <a name="publishing-to-an-event-domain"></a>Публикация в Домене событий

При создании Домена событий вам предоставляется конечная точка публикации точно так же, как при создании раздела в Сетке событий. 

Чтобы опубликовать события в любом разделе в Домене событий, отправьте события в конечную точку Домена [так же, как и для настраиваемого раздела](./post-to-custom-topic.md). Единственное различие заключается в том, что вы должны указать раздел, в который хотите отправить событие.

Например, при публикации следующего массива событий в раздел `foo` будет отправлено событие с `"id": "1111"`, в то время как событие с `"id": "2222"` будет отправлено в раздел `bar`:

```json
[{
  "topic": "foo",
  "id": "1111",
  "eventType": "maintenanceRequested",
  "subject": "myapp/vehicles/diggers",
  "eventTime": "2018-10-30T21:03:07+00:00",
  "data": {
    "make": "Contoso",
    "model": "Small Digger"
  },
  "dataVersion": "1.0"
},
{
  "topic": "bar",
  "id": "2222",
  "eventType": "maintenanceCompleted",
  "subject": "myapp/vehicles/tractors",
  "eventTime": "2018-10-30T21:04:12+00:00",
  "data": {
    "make": "Contoso",
    "model": "Big Tractor"
  },
  "dataVersion": "1.0"
}]
```

Домены событий выполняют публикацию в разделы за вас. Вместо того чтобы публиковать события в каждом управляемом вами разделе отдельно, вы можете опубликовать все свои события в конечной точке Домена, а Сетка событий позаботится о том, чтобы каждое событие было отправлено в нужный раздел.

## <a name="limits-and-quotas"></a>Ограничения и квоты

### <a name="control-plane"></a>Уровень управления

На этапе предварительной версии количество разделов в Доменах событий будет ограничено до 1000, а количество подписок на события в разделе — до 50. Количество подписок на область Домена событий также будет ограничено до 50.

### <a name="data-plane"></a>Плоскость данных

На этапе предварительной версии пропускная способность событий для Домена событий будет ограничена тем же самым количеством событий, что и настраиваемые разделы (5000 событий в секунду).

## <a name="pricing"></a>Цены

На этапе предварительной версии для Доменов событий будут применятся те же [цены на операции](https://azure.microsoft.com/pricing/details/event-grid/), что и для остальных функций в Сетке событий.

Операции работают в Доменах событий точно так же, как и в настраиваемых разделах. Каждое поступление события в Домене событий является операцией, и каждая попытка отправки события также является операцией.

## <a name="next-steps"></a>Дополнительная информация

* Сведения о настройке Доменов событий, создании разделов, оформлении подписок на события и публикации событий см. в статье [Manage topics and publish events using Event Domains](./how-to-event-domains.md) (Управление разделами и публикация событий с помощью Доменов событий).