---
title: "Краткое руководство по Azure Stack: создание виртуальной машины с помощью портала"
description: "Краткое руководство по Azure Stack: создание виртуальной машины Linux c помощью портала"
services: azure-stack
cloud: azure-stack
author: vhorne
manager: byronr
ms.service: azure-stack
ms.topic: quickstart
ms.date: 09/25/2017
ms.author: victorh
ms.custom: mvc
ms.openlocfilehash: a97372002052570ccad2bb8bc442eb0dd1ca76d9
ms.sourcegitcommit: b07d06ea51a20e32fdc61980667e801cb5db7333
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2017
---
# <a name="create-a-linux-virtual-machine-with-the-azure-stack-portal"></a>Создание виртуальной машины Linux с помощью портала Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

Виртуальные машины Azure Stack можно создать на портале Azure Stack. Он предоставляет пользовательский интерфейс в браузере для создания и настройки виртуальной машины и всех связанных с ней ресурсов. Из этого краткого руководства вы узнаете, как быстро создать виртуальную машину Linux и установить на ней веб-сервер.

## <a name="prerequisites"></a>предварительным требованиям

* **Образ Linux в Azure Stack Marketplace**.

   По умолчанию Azure Stack Marketplace не содержит образ Linux. Поэтому перед созданием виртуальной машины Linux оператор Azure Stack должен скачать образ **Ubuntu Server 16.04 LTS** в соответствии с инструкциями в статье [Скачивание элементов Marketplace из Azure в Azure Stack](../azure-stack-download-azure-marketplace-item.md).

* **Доступ к клиенту SSH**.

   Если вы используете Пакет средств разработки Azure Stack, клиент SSH в вашей среде может быть недоступен. В такой ситуации вам нужно выбрать один из пакетов, в которые включен клиент SSH. Например, можно установить программу PuTTY, в состав которой входит клиент SSH и генератор ключа SSH (puttygen.exe). Дополнительные сведения о возможных вариантах см. в статье об [использовании ключей SSH с Windows в Azure](https://docs.microsoft.com/azure/virtual-machines/linux/ssh-from-windows#windows-packages-and-ssh-clients).

   В этом кратком руководстве PuTTY используется для создания ключей SSH и подключения к виртуальной машине Linux. Чтобы загрузить и установить PuTTY, откройте страницу [http://www.putty.org/](http://www.putty.org).

## <a name="create-an-ssh-key-pair"></a>Создание пары ключей SSH

Для работы с этим руководством вам понадобится пара ключей SSH. Если у вас уже есть пара ключей SSH, этот шаг можно пропустить.

1. Перейдите в папку установки PuTTY (по умолчанию это ```C:\Program Files\PuTTY```) и запустите команду ```puttygen.exe```.
2. В окне генератора ключей PuTTY выберите для параметра **Type of key to generate** (Тип создаваемого ключа) значение **RSA**, а для **Number of bits in a generated key** (Количество битов в создаваемом ключе) — значение **2048**. Когда все будет готово, нажмите кнопку **Generate** (Создать).

   ![puttygen.exe](media/azure-stack-quick-linux-portal/Putty01.PNG)

3. Чтобы завершить процесс создания ключей, активно перемещайте курсор мыши в пределах окна генератора ключей PuTTY.
4. Когда создание ключа завершится, щелкните **Save public key** (Сохранить открытый ключ) и **Save private key** (Сохранить закрытый ключ), чтобы сохранить файлы открытого и закрытого ключей.

   ![Ключи puTTY](media/azure-stack-quick-linux-portal/Putty02.PNG)



## <a name="sign-in-to-the-azure-stack-portal"></a>Вход на портал Azure Stack

Войдите на портал Azure Stack. Адрес портала Azure Stack зависит от того, к какому продукту Azure Stack вы подключаетесь:

* При работе с Пакетом средств разработки Azure Stack (ASDK) перейдите по адресу https://portal.local.azurestack.external.
* При работе с интегрированной системой Azure Stack используйте URL-адрес, предоставленный оператором Azure Stack.

## <a name="create-the-virtual-machine"></a>Создание виртуальной машины

1. Щелкните кнопку **Создать** в верхнем левом углу портала Azure Stack.

2. Выберите **Вычисления**, а затем — **Сервер Ubuntu 16.04 LTS**.
3. Нажмите кнопку **Создать**.

4. Введите сведения о виртуальной машине. Для параметра **Тип проверки подлинности** выберите значение **Открытый ключ SSH**. При вставке открытого ключа SSH (который вы ранее сохранили в файл) обязательно удалите все начальные и конечные пробелы. По завершении нажмите кнопку **ОК**.

   ![Основная информация о виртуальной машине](media/azure-stack-quick-linux-portal/linux-01.PNG)

5. Выберите размер **D1_V2** для виртуальной машины.

   ![Размер машины](media/azure-stack-quick-linux-portal/linux-02.PNG)

6. На странице **параметров** оставьте значения по умолчанию и нажмите кнопку **OK**.

7. На странице **сводки** нажмите кнопку **OК**, чтобы начать развертывание виртуальной машины.


## <a name="connect-to-the-virtual-machine"></a>Подключение к виртуальной машине

1. На странице виртуальной машины щелкните **Подключить**. Появится строка подключения по протоколу SSH, при помощи которой вы можете подключиться к виртуальной машине.

   ![Подключение к виртуальной машине](media/azure-stack-quick-linux-portal/linux-03.PNG)

2. Откройте PuTTY.
3. На экране **PuTTY Configuration** (Конфигурация PuTTY) в разделе **Категория** разверните узел **SSH** и щелкните **Проверка подлинности**. Нажмите кнопку **Обзор** и выберите файл закрытого ключа, который вы сохранили ранее.

   ![Закрытый ключ PuTTY](media/azure-stack-quick-linux-portal/Putty03.PNG)
4. В разделе **Категория** прокрутите окно вверх и щелкните элемент **Сеанс**.
5. В поле **Host Name (or IP address)** (Имя узла или IP-адрес) вставьте строку подключения, которую вы ранее видели на портале Azure. В нашем примере строка имеет вид ```asadmin@192.168.102.34```.
 
   ![Сеанс puTTY](media/azure-stack-quick-linux-portal/Putty04.PNG)
6. Щелкните **Открыть**, чтобы создать сеанс подключения к виртуальной машине.

   ![Сессия Linus](media/azure-stack-quick-linux-portal/Putty05.PNG)

## <a name="install-nginx"></a>Установка nginx

Чтобы обновить на виртуальной машине источники пакетов и установить последнюю версию пакета nginx, используйте bash-скрипт ниже. 

```bash 
#!/bin/bash

# update package source
sudo apt-get -y update

# install NGINX
sudo apt-get -y install nginx
```

Когда процесс завершится, закройте сеанс SSH и вернитесь на страницу общей информации о виртуальной машине на портале Azure Stack.


## <a name="open-port-80-for-web-traffic"></a>Открытие порта 80 для веб-трафика 

Группа безопасности сети (NSG) защищает входящий и исходящий трафик. При создании виртуальной машины на портале Azure создается правило, разрешающее входящий трафик через порт 22 для SSH-подключений. Так как на этой виртуальной машине размещается веб-сервер, нужно еще и правило NSG для порта 80.

1. На странице **общей информации** о виртуальной машине щелкните имя **группы ресурсов**.
2. Выберите **группу безопасности сети** для виртуальной машины. NSG можно определить с помощью столбца **Тип**. 
3. В меню слева в разделе **Параметры** щелкните **Правила безопасности для входящего трафика**.
4. Щелкните **Добавить**.
5. В поле **Имя** введите **http**. Убедитесь, что для параметра **Диапазон портов** задано значение 80, а для параметра **Действие** — значение **Разрешить**. 
6. Последовательно выберите **ОК**.


## <a name="view-the-nginx-welcome-page"></a>Просмотр страницы приветствия nginx

Теперь на виртуальной машине установлен NGINX и открыт порт 80, а значит, веб-сервер должен открываться через общедоступный IP-адрес этой виртуальной машины. Общедоступный IP-адрес можно узнать на странице общих сведений о виртуальной машине на портале Azure Stack.

Откройте окно браузера и перейдите по адресу ```http://<public IP address>```.

![Сайт NGINX по умолчанию](media/azure-stack-quick-linux-portal/linux-04.PNG)


## <a name="clean-up-resources"></a>Очистка ресурсов

Ставшие ненужными группу ресурсов, виртуальную машину и все связанные ресурсы можно удалить, выполнив следующую команду. Для этого выберите группу ресурсов на странице виртуальной машины и нажмите кнопку **Удалить**.

## <a name="next-steps"></a>Дополнительная информация

Из этого краткого руководства вы узнали, как развернуть простую виртуальную машину Linux, ознакомились с правилами групп безопасности сети и особенностями установке веб-сервера. Дополнительные сведения о виртуальных машинах Azure Stack см. в [рекомендациях по работе с виртуальными машинами в Azure Stack](azure-stack-vm-considerations.md).

