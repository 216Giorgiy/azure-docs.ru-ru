---
title: Добавление узлов масштабирования в Azure Stack | Документация Майкрософт
description: Добавление узлов для единиц масштабирования в Azure Stack.
services: azure-stack
documentationcenter: ''
author: brenduns
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
pms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/24/2018
ms.author: brenduns
ms.reviewer: thoroet
ms.openlocfilehash: 15c46bb0fee4689b614636d8c9e01e36f7f0be3d
ms.sourcegitcommit: 44fa77f66fb68e084d7175a3f07d269dcc04016f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2018
ms.locfileid: "39227702"
---
# <a name="add-additional-scale-unit-nodes-in-azure-stack"></a>Добавление дополнительных узлов единиц масштабирования в Azure Stack

Операторы Azure Stack могут увеличить общую емкость существующей единицы масштабирования, добавив дополнительный физический компьютер. Физический компьютер также называется узлом единицы масштабирования. Каждый новый добавляемый узел единицы масштабирования должен быть однородным по типу процессора, памяти, номеру и размеру диска для узлов, которые уже присутствуют в единице масштабирования.  

> [!NOTE]  
Чтобы добавить дополнительные узлы единицы масштабирования, необходимо запустить Azure Stack 1807 или более поздней версии.

Чтобы добавить узел единицы масштабирования, войдите в Azure Stack и запустите средства от изготовителя оборудования (OEM). Инструментарий OEM работает на узле жизненного цикла оборудования (HLH), чтобы убедиться, что новый физический компьютер соответствует тому же уровню встроенного ПО, что и существующие узлы.

На блок-схеме ниже показан общий процесс добавления узла единицы масштабирования.

![Добавление последовательности единицы масштабирования](media/azure-stack-add-scale-node/add-node-flow.png) &#42; *Устанавливает ли поставщик оборудования OEM размещение стойки физического сервера и обновляет ли встроенное ПО, зависит от вашего контракта на поддержку.*

Операция добавления нового узла может занять несколько часов или дней.

## <a name="add-scale-unit-nodes"></a>Добавление узлов единиц масштабирования 
Следующие действия — это общий обзор того, как добавить узел. Не выполняйте приведенные ниже действия, не ознакомившись с документацией изготовителя оборудования об увеличении емкости.

1. Поместите новый физический сервер в стойке и подключите его соответствующим образом. 
2. Настройте правильный IP-адрес в контроллере управления основной платой (BMC) и примените все настройки BIOS в соответствии с документацией изготовителя.
3. Примените текущий базовый план встроенного ПО ко всем компонентам, используя инструменты, которые предоставляются производителем оборудования, работающим на HLH.
4. Запустите операцию "Добавить узел" на портале администратора Azure Stack.
5. Убедитесь, что операция добавления узла успешно завершена. Для этого проверьте [**Состояние** единицы масштабирования](#monitor-add-node-operations). 

## <a name="add-the-node"></a>Добавление узла 
Чтобы добавить новые узлы, можно использовать консоль администрирования или PowerShell. Операция добавления узла сначала добавляет новый узел единицы масштабирования в качестве доступной вычислительной емкости, а затем автоматически расширяет емкость хранилища. Емкость развертывается автоматически, так как Azure Stack — это гиперконвергентная система, где *вычисление* и *хранение* масштабируются вместе.

### <a name="use-the-admin-console"></a>Использование консоли администрирования
1. Войдите на портал администратора Azure Stack в качестве оператора Azure Stack.
2. Перейдите к **Управление регионами** > **Единицы масштабирования**, а затем выберите нужную единицу масштабирования, для которой требуется расширить возможности.  
   ![Выбор единицы масштабирования](media/azure-stack-add-scale-node/select-node1.png)

   ![Просмотр сведений о единице масштабирования](media/azure-stack-add-scale-node/select-node2.png)
 
3. Требуются следующие параметры.  
   - **IP-адрес контроллера BMC** для каждого добавляемого узла единицы масштабирования. (Один IP-адрес на строку.) ![Добавление узла](media/azure-stack-add-scale-node/add-node.png)

### <a name="use-powershell"></a>Использование PowerShell

Чтобы добавить один или несколько узлов, используйте командлет **New-AzsScaleUnitNodeObject**.  

Прежде чем использовать один из следующих сценариев PowerShell, замените значения *Имена узлов* и *IP-адреса* на значения из среды Azure Stack.

**Для одного узла:**
  ```powershell
  ## Add a single Node 
  $NewNode=New-AzsScaleUnitNodeObject -computername "<name_of_new_node>" -BMCIPv4Address "<BMCIP_address_of_new_node>" 
 
  Add-AzsScaleUnitNode -NodeList $NewNode -ScaleUnit "<name_of_scale_unit_cluster>" 
  ```  

**Добавление нескольких узлов:**
  ```powershell
  ## Add multiple nodes 
  $NewNode1=New-AzsScaleUnitNodeObject -computername "<name_of_new_node01>"  -BMCIPv4Address "<BMCIP_address_of_new_node01>" 
 
  $NewNode2=New-AzsScaleUnitNodeObject -computername "<name_of_new_node02>" -BMCIPv4Address “<BMCIP_address_of_new_node02>”$ 
 
  Add-AzsScaleUnitNode -NodeList @($NewNode1,$NewNode2) -ScaleUnit "<name_of_scale_unit_cluster>" 
  ```

## <a name="monitor-add-node-operations"></a>Мониторинг операций добавления узла 
Чтобы получить состояние операции добавления узла, можно использовать портал администратора или PowerShell. Операции добавления узлов могут длиться от нескольких часов до нескольких дней.

### <a name="use-the-admin-console"></a>Использование консоли администрирования 
Чтобы контролировать добавление нового узла, в обзоре портала администратора просмотрите единицу масштабирования или объекты узла единицы масштабирования. Для этого перейдите к **Управление регионами** > **Единицы масштабирования**. Затем выберите единицу масштабирования или узел единицы масштабирования, которую необходимо просмотреть. 

### <a name="use-powershell"></a>Использование PowerShell
Состояние единицы масштабирования и узлов единицы масштабирования можно получить с помощью PowerShell следующим образом.
  ```powershell
  #Retrieve Status for the Scale Unit
  Get-AzsScaleUnit|select name,state
 
  #Retrieve Status for each Scale Unit Node
  Get-AzsScaleUnitNode |Select Name, ScaleUnitNodeStatus
```

### <a name="status-for-the-add-node-operation"></a>Состояние операции добавления узла 
**Для единицы масштабирования.**
|Status               |ОПИСАНИЕ  |
|---------------------|---------|
|Выполнение              |Все узлы активно участвуют в единице масштабирования.|
|Остановлено              |Узел единицы масштабирования не работает или недоступен.|
|Развертывание            |В настоящее время в качестве вычислительной емкости добавляются один или несколько узлов единиц масштабирования.|
|Настройка хранилища  |Вычислительная емкость расширена и конфигурация хранилища запущена.|
|Требуется исправление |Обнаружена ошибка, требующая восстановления одного или нескольких узлов единиц масштабирования.|


**Для узла единицы масштабирования.**
|Status                |ОПИСАНИЕ  |
|----------------------|---------|
|Выполнение               |Узел активно участвует в единице масштабирования.|
|Остановлено               |Узел недоступен.|
|Добавление                |Узел активно добавляется в единицу масштабирования.|
|Восстановление             |Восстановление узла активно выполняется.|
|Обслуживание,            |Узел приостановлен, и нет запущенных активных пользовательских рабочих нагрузок. |
|Требуется исправление  |Обнаружена ошибка, требующая восстановления узла.|


## <a name="troubleshooting"></a>Устранение неполадок
Ниже приведены распространенные проблемы, возникающие при добавлении узла. 

**Сценарий 1.** Операция добавления узла единицы масштабирования прекращена, но один или несколько узлов имеют состояние "Остановлено".  
- Исправление. Используйте операцию восстановления, чтобы восстановить один или несколько узлов. За один раз можно выполнить только одну операцию восстановления.

**Сценарий 2.** Добавлено один или несколько узлов единиц масштабирования, но возникла ошибка расширения хранилища. В этом сценарии объект узла единицы масштабирования сообщает о состоянии "Выполнение", но задача настройки хранилища не запущена.  
- Исправление. Используйте привилегированную конечную точку для просмотра работоспособности хранилища, выполнив следующий командлет PowerShell.
 
**Сценарий 3.** Пришло оповещение, которое указывает, что задание горизонтального масштабирования хранилища не выполнено.  
- Исправление. В этом случае задача конфигурации хранилища не выполнена. С этой проблемой необходимо обратиться в службу поддержки.


## <a name="next-steps"></a>Дальнейшие действия 
См. [Действия с узлами](azure-stack-node-actions.md) 
