---
title: "Архитектура удостоверений Azure Stack | Документация Майкрософт"
description: "Сведения об архитектуре удостоверений, которые можно использовать с Azure Stack."
services: azure-stack
documentationcenter: 
author: brenduns
manager: femila
editor: 
ms.assetid: 
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/28/2018
ms.author: brenduns
ms.reviewer: 
ms.openlocfilehash: 7f2ec78da38f3c97fde810fb8fc965cfbb6fda08
ms.sourcegitcommit: 782d5955e1bec50a17d9366a8e2bf583559dca9e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2018
---
# <a name="identity-architecture-for-azure-stack"></a>Архитектура удостоверений Azure Stack
Прежде чем выбрать поставщик удостоверений для использования с Azure Stack, ознакомьтесь с существенными различиями между вариантами Azure Active Directory (Azure AD) и службы федерации Active Directory (AD FS). 

## <a name="capabilities-and-limitations"></a>Возможности и ограничения 
Выбранный поставщик удостоверений может ограничить некоторые возможности, включая поддержку мультитенантности. 

  

|Возможность или сценарий        |Azure AD  |AD FS  |
|------------------------------|----------|-------|
|С подключением к Интернету     |Yes       |Необязательно|
|Поддержка мультитенантности     |Yes       |Нет       |
|Синдикация Marketplace       |Yes       |Да. Требует использования инструмента [автономной синдикации Marketplace](azure-stack-download-azure-marketplace-item.md#download-marketplace-items-in-a-disconnected-or-a-partially-connected-scenario-with-limited-internet-connectivity).|
|Поддержка библиотеки проверки подлинности Active Directory (ADAL) |Yes |Yes|
|Поддержка таких средств, как интерфейс командной строки Azure (CLI), Visual Studio (VS) и PowerShell  |Yes |Yes|
|Создание субъектов-служб с помощью портала     |Yes |Нет |
|Создание субъектов-служб с помощью сертификатов      |Yes |Yes|
|Создание субъектов-служб с помощью секретов (ключей)    |Yes |Нет |
|Приложения могут использовать службу Graph           |Yes |Нет |
|Приложения могут использовать поставщика удостоверений для входа в систему |Yes |Да. Требует, чтобы приложения создавали федерацию с локальными службами федерации Active Directory (AD FS). |

## <a name="topologies"></a>Топологии
В следующих разделах содержатся сведения о доступных для использования топологиях удостоверений.

### <a name="azure-ad--single-tenant"></a>Azure Active Directory — один клиент 
По умолчанию при установке Azure Stack и использовании Azure AD Azure Stack использует однотенантную топологию. 

Однотенантная топология полезна в следующих случаях:
- Все пользователи входят в состав одного клиента.
- Экземпляр Azure Stack для организации размещен в поставщике услуг.  

![Топология Azure Stack, использующая однотенантную топологию с Azure AD](media/azure-stack-identity-architecture/single-tenant.png)

С использованием этой топологии:
- Azure Stack регистрирует все приложения и службы в одном каталоге клиента Azure AD. 
- Azure Stack проверяет подлинность пользователей и приложений из этого каталога, в частности маркеров. 
- Удостоверения администраторов (операторы облака) и пользователей находятся в одном клиенте каталога. 
- Чтобы предоставить пользователю из другого каталога доступ к среде Azure Stack, необходимо [пригласить пользователя в качестве гостя](azure-stack-identity-overview.md#guest-users) в каталог клиента.  

### <a name="azure-ad--multi-tenant"></a>Azure Active Directory — несколько клиентов
Операторы облака могут настроить Azure Stack, разрешив доступ к приложениям клиентам из одной или нескольких организаций. Пользователи получают доступ к приложениям через портал пользователей. В этой конфигурации портал администратора (используемый оператором облака) ограничен для пользователей из одного каталога. 

Топология с несколькими клиентами полезна, если:
- Поставщик услуг хочет предоставить доступ к Azure Stack пользователям из нескольких организаций.

![Топология Azure Stack, использующая многотенантную топологию с Azure AD](media/azure-stack-identity-architecture/multi-tenant.png)

С использованием этой топологии:
- Доступ к ресурсам необходимо предоставлять отдельно для каждой организации. 
- Пользователи из одной организации не должны предоставить доступ к ресурсам для пользователей, находящихся за пределами этой организации.  
- Удостоверения администраторов (операторов облака) и пользователей могут находится в разных клиентах каталога. Подобное разделение обеспечивает изоляцию учетной записи на уровне поставщика удостоверений. 
 
### <a name="ad-fs"></a>AD FS  
Топология AD FS необходима в следующих случаях:
- Azure Stack не подключен к Интернету.
- Azure Stack можно подключить к Интернету, однако вы решили использовать AD FS для поставщика удостоверений.
  
![Топология Azure Stack, использующая AD FS](media/azure-stack-identity-architecture/adfs.png)

С использованием этой топологии:
- Для поддержки использования в рабочей среде вы должны интегрировать встроенный экземпляр Azure Stack AD FS с имеющимся экземпляром AD FS, поддерживаемым Active Directory (AD) с помощью отношения доверия федерации. 
- Вы можете интегрировать службу Graph в Azure Stack с имеющейся службой Active Directory.  Кроме того, можно использовать протокол OData на основе службы API Graph, который поддерживает программные интерфейсы, совместимые с API Azure AD Graph.  

  Для взаимодействия с Active Directory API Graph требуются учетные данные пользователя из Active Directory, имеющие разрешение только на чтение в Active Directory. 
  - Встроенные службы федерации Active Directory основаны на Server 2016. 
  - Службы федерации Active Directory и Active Directory должны быть основаны на Server 2012 или более поздней версии.  
  
  Взаимодействие между Active Directory и встроенным AD FS не ограничено только OpenID Connect. Поэтому вы можете использовать любой поддерживаемый протокол.  
  - Учетные записи пользователей создаются и управляются в локальном Active Directory.
  - Субъекты-службы и регистрации для приложений управляются встроенным каталогом Active Directory.



## <a name="next-steps"></a>Дополнительная информация
- [Общие сведения об удостоверениях Azure Stack](azure-stack-identity-overview.md)   
- [Интеграция центра обработки данных Azure Stack: идентификация](azure-stack-integrate-identity.md)