---
title: "Делегирование предложений в Azure Stack | Документация Майкрософт"
description: "Узнайте, как привлечь других людей к созданию предложений и регистрации пользователей."
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: 157f0207-bddc-42e5-8351-197ec23f9d46
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/25/2017
ms.author: alfredop
ms.openlocfilehash: 48b75233e1a485e8fb3fbce9776a6ef398c4e99c
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="delegating-offers-in-azure-stack"></a>Делегирование предложений в Azure Stack

*Область применения: интегрированные системы Azure Stack и комплект разработки Azure Stack*

Оператору Azure Stack часто необходимо привлекать других людей к созданию предложений и регистрации пользователей. Например, если вы являетесь поставщиком услуг и вам необходимо, чтобы посредники регистрировали клиентов и управляли ими от вашего имени. Это может произойти и на предприятии, если вы входите в основную ИТ-группу и необходимо, чтобы подразделения или дочерние компании регистрировали пользователей без вашего вмешательства.

Делегирование помогает вам в решении этих задач, позволяя охватить и администрировать большее количество пользователей, чем это возможно напрямую. На следующем рисунке показан один уровень делегирования, хотя Azure Stack поддерживает несколько уровней. Делегированные поставщики могут, в свою очередь, делегировать обязанности другим поставщикам (возможно до пяти уровней).

![](media/azure-stack-delegated-provider/image1.png)

Операторы Azure Stack могут делегировать создание предложений и пользователей другим пользователям с помощью функции делегирования.

## <a name="roles-and-steps-in-delegation"></a>Роли и действия в делегировании
В рамках делегирования задействовано три роли:

* Оператор Azure Stack управляет инфраструктурой Azure Stack, создает шаблон предложения и делегирует другим пользователям возможность предлагать его своим пользователям.
* Делегированные операторы Azure Stack называются **делегированными поставщиками**. Они могут принадлежать к другим организациям (например, другим пользователям Azure Active Directory).
* **Пользователи** регистрируются для получения предложений и используют их для управления своими рабочими нагрузками, создания виртуальных машин, хранения данных и т. д.

Как показано на следующем рисунке, настройка делегирования включает в себя два шага.

1. **Определение делегированных поставщиков** путем подписки их на предложение на основе плана, который содержит только службу подписки.
   Пользователи, подписавшиеся на это предложение, получают некоторые возможности оператора Azure Stack, включая возможность расширения предложений и регистрации пользователей для их использования.
2. **Делегация предложения делегированному поставщику**. Это предложение работает в качестве шаблона того, что может предложить делегированный поставщик. Делегированный поставщик теперь может принимать предложение, выбирать для него имя (но не изменять его службы и квоты) и предлагать его клиентам.

![](media/azure-stack-delegated-provider/image2.png)

Чтобы выступать в роли делегированных поставщиков, пользователям необходимо установить связь с основным поставщиком, другими словами, им необходимо создать подписку. В этом сценарии эта подписка идентифицирует делегированного поставщика как имеющего право представлять предложения от имени основного поставщика.

После установления этой связи оператор Azure Stack может делегировать предложение делегированному поставщику. Делегированный поставщик теперь может принять предложение, переименовать его (но не изменять его содержание) и предложить своим клиентам.

В следующих разделах описывается, как создать делегированного поставщика, делегировать предложение и проверить, могут ли пользователи зарегистрироваться для его получения.

## <a name="set-up-roles"></a>Настройка ролей

Чтобы понять, что может делать делегированный поставщик, необходимо добавить дополнительные учетные записи Azure Active Directory в дополнение к учетной записи оператора Azure Stack. Если их нет, создайте две учетные записи. Они могут принадлежать любому пользователю AAD. Мы будем называть их делегированным поставщиком и пользователем.

| **Роль** | **Права в организации** |
| --- | --- |
| Делегированный поставщик |Пользователь |
| Пользователь |Пользователь |

## <a name="identify-the-delegated-providers"></a>Идентификация делегированных поставщиков
1. Войдите в качестве оператора Azure Stack.
2. Создайте предложение, позволяющее пользователям стать делегированными поставщиками. Для этого необходимо создать план и предложение на его основе.
   
   а.  [Создайте план](azure-stack-create-plan.md).
       Этот план должен содержать только службу подписки. В этой статье используется план с именем PlanForDelegation.
   
   b.  [Создайте предложение](azure-stack-create-offer.md) на основе этого плана. В этой статье используется предложение с именем OfferToDP.
   
   c.  После завершения создания предложения добавьте делегированного поставщика в качестве подписчика на это предложение, щелкнув **Подписки** &gt; **Добавить** &gt; **New Tenant Subscription** (Создать подписку клиента).
   
   ![](media/azure-stack-delegated-provider/image3.png)

> [!NOTE]
> Как и во всех предложениях Azure Stack, у вас есть возможность сделать предложение общедоступным и разрешить пользователям регистрироваться в нем или оставить его частным и позволить оператору Azure Stack управлять регистрациями. Делегированные поставщики, как правило, представляют собой небольшую группу, допуск в которую можно контролировать. Поэтому частный доступ к предложению имеет смысл в большинстве случаев.
> 
> 

## <a name="azure-stack-operator-creates-the-delegated-offer"></a>Создание делегированного предложения оператором Azure Stack

Итак, создан делегированный поставщик. Следующим шагом является создание плана и предложения, которое необходимо делегировать и которое будут использовать клиенты. Это предложение необходимо определить точно так, как его должны видеть клиенты, потому что делегированный поставщик не сможет изменить включаемые планы и квоты.

1. В качестве оператора Azure Stack [создайте план](azure-stack-create-plan.md) и [предложение](azure-stack-create-offer.md) на его основе. В этой статье используется предложение с именем DelegatedOffer.
   
   > [!NOTE]
   > Это предложение не обязательно должно быть общедоступным. При необходимости его можно сделать общедоступным, но в большинстве случаев нужно, чтобы доступ к нему имели только делегированные поставщики. После делегирования частного предложения, как описано в следующих шагах, делегированный поставщик получит доступ к нему.
   > 
   > 
1. Делегируйте предложение. Перейдите к DelegatedOffer и в области параметров щелкните **Delegated Providers** (Делегированные поставщики) &gt; **Добавить**.
2. Выберите подписку делегированного поставщика из раскрывающегося списка и нажмите кнопку **Делегировать**.

> ![](media/azure-stack-delegated-provider/image4.png)
> 
> 

## <a name="delegated-provider-customizes-the-offer"></a>Настройка предложения делегированным поставщиком

Войдите на портал пользователя в качестве делегированного поставщика и создайте предложение, используя делегированное предложение в качестве шаблона.

1. Щелкните **Создать** &gt; **Tenant Offers + Plans** (Предложения и планы клиента) &gt; **Предложение**.

    ![](media/azure-stack-delegated-provider/image5.png)


1. Присвойте имя предложению. Здесь используется ResellerOffer. Выберите делегированное предложение для использования в качестве основы, а затем нажмите кнопку **Создать**.
   
   ![](media/azure-stack-delegated-provider/image6.png)

    >[!NOTE] 
    > Обратите внимание, что по сравнению с созданием предложения в качестве оператора Azure Stack тут есть различие. Делегированный поставщик не создает предложение из базовых и дополнительных планов. Он может выбирать только те предложения, которые ему делегированы, и не может вносить изменения в эти предложения.

1. Сделайте предложение общедоступным, щелкнув **Обзор** &gt; **Предложения**, выберите предложение и щелкните **Change State** (Изменить состояние).
2. Делегированный поставщик предоставляет эти предложения через свой собственный URL-адрес портала. Они видимы только на делегированном портале. Чтобы найти и изменить этот URL-адрес:
   
    а.  Щелкните **Обзор** &gt; **Больше служб** &gt; **Подписки**, выберите подписку делегированного поставщика (в нашем случае это *DPSubscription*) и щелкните **Свойства**.
   
    b.  Скопируйте URL-адрес портала в отдельное расположение, например в Блокнот.
   
    ![](media/azure-stack-delegated-provider/dpportaluri.png)  
   
   Создание делегированного предложения в качестве делегированного поставщика успешно завершено. Выйдите из системы как делегированный поставщик. Закройте используемую вкладку браузера.

## <a name="sign-up-for-the-offer"></a>Регистрация для получения предложения
1. В новом окне браузера перейдите по URL-адресу делегированного портала, сохраненному на предыдущем шаге. Войдите на портал в качестве пользователя. (Используйте делегированный портал на этом шаге. В противном случае делегированное предложение не отобразится.)
2. На панели мониторинга щелкните **Получить подписку**. Вы увидите, что пользователь видит только делегированные предложения, созданные делегированным поставщиком:

> ![](media/azure-stack-delegated-provider/image8.png)
> 
> 

На этом завершается процесс делегирования предложения. Теперь пользователь может зарегистрироваться на это предложение, получив подписку на него.

## <a name="multiple-tier-delegation"></a>Многоуровневая делегация

Многоуровневая делегация позволяет делегированному поставщику делегировать предложение другим сущностям. Это позволяет, например, создавать более глубокие каналы торговых посредников, в которых поставщик, управляющий Azure Stack, делегирует предложение распространителю, который в свою очередь делегирует его посреднику.
Azure Stack поддерживает до пяти уровней делегирования.

Для создания нескольких уровней делегирования предложения делегированные поставщики в свою очередь делегируют предложение следующему поставщику. Процесс одинаков как для делегированного поставщика, так и для оператора Azure Stack (дополнительные сведения см. в разделе [Создание делегированного предложения оператором Azure Stack](#cloud-operator-creates-the-delegated-offer)).

## <a name="next-steps"></a>Дальнейшие действия
[Создание тестовой виртуальной машины в Azure Stack](azure-stack-provision-vm.md)

