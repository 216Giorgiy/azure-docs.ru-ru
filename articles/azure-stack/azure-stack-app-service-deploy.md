---
title: "Развертывание служб приложений в Azure Stack | Документация Майкрософт"
description: "Подробное руководство по развертыванию службы приложений в Azure Stack."
services: azure-stack
documentationcenter: 
author: apwestgarth
manager: stefsch
editor: 
ms.assetid: 
ms.service: azure-stack
ms.workload: app-service
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/10/2017
ms.author: anwestg
ms.openlocfilehash: db1b5c00f946b5945e15303683630d95339228e7
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="add-an-app-service-resource-provider-to-azure-stack"></a>Добавление поставщика ресурсов службы приложений в Azure Stack

Оператор облака Azure Stack может предоставить пользователям возможность создавать веб-приложения и приложения API. Чтобы сделать это, необходимо сначала добавить [поставщик ресурсов службы приложений](azure-stack-app-service-overview.md) к развертыванию Azure Stack, как описано в этой статье. Установив поставщик ресурсов службы приложений, можно включить его в предложения и планы. Затем пользователи смогут подписаться на службу и приступить к созданию приложений.

Чтобы добавить поставщик ресурсов службы приложений в развертывание Azure Stack, необходимо выполнить три задачи верхнего уровня:

1.  [Скачать и извлечь файлы установки и вспомогательные файлы](azure-stack-app-service-before-you-get-started.md).
2.  [Создать требуемые сертификаты](azure-stack-app-service-before-you-get-started.md#certificates-required-for-the-azure-stack-development-kit).
3.  Запустить установщик поставщика ресурсов службы приложений.

## <a name="run-the-app-service-resource-provider-installer"></a>Запуск установщика поставщика ресурсов службы приложений

Установка поставщика ресурсов службы приложений в среду Azure Stack может занять около часа. В ходе этого процесса установщик выполняет следующие действия:

* создание контейнера больших двоичных объектов в определенной учетной записи хранения Azure Stack;
* создание зоны DNS и записей для службы приложений;
* регистрацию поставщика ресурсов службы приложений;
* регистрацию элементов коллекции службы приложений.

Чтобы развернуть поставщик ресурсов службы приложений, выполните следующие действия:

1. Запустите файл appservice.exe от имени администратора (azurestack\AzureStackAdmin).

2. Щелкните **Развертывание службы приложений в вашем облаке Azure Stack**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image01.png)

3. Просмотрите и примите условия лицензионного соглашения об использовании программного обеспечения Майкрософт, а затем щелкните **Далее**.

4. Просмотрите и примите условия лицензии сторонних поставщиков и щелкните **Далее**.

5. Убедитесь, что сведения о конфигурации облачной службы приложений верны. Если во время развертывания комплекта разработки Azure Stack использовались значения по умолчанию, здесь также можно принять значения по умолчанию. Однако, если вы указали другие значения при развертывании Azure Stack, в этом окне необходимо изменить значения соответствующим образом. Например, если используется суффикс домена mycloud.com, нужно изменить конечную точку на management.mycloud.com. Проверив сведения, щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image02.png)

6. На следующей странице:
    1. Нажмите кнопку **Подключить** рядом с полем **Azure Stack Subscriptions** (Подписки Azure Stack).
        - При использовании Azure Active Directory (Azure AD) введите учетную запись администратора Azure AD и пароль, предоставленный при развертывании Azure Stack. Щелкните **Войти**.
        - При использовании служб федерации Active Directory (AD FS) предоставьте соответствующую учетную запись администратора. Например, azurestackadmin@azurestack.local. Введите пароль и нажмите кнопку **Войти**.
    2. В поле **Azure Stack Subscriptions** (Подписки Azure Stack) выберите подписку.
    3. В поле **Azure Stack Locations** (Расположения Azure Stack) выберите расположение, соответствующее региону, в который выполняется развертывание. Например, выберите **Локальные** при развертывании в комплект разработки Azure Stack.
    4. Введите **имя группы ресурсов** для развертывания службы приложений. По умолчанию присваивается имя **APPSERVICE\<РЕГИОН\>**.
    5. Введите **имя учетной записи хранения**, которую служба приложений должна создать в рамках установки. По умолчанию присваивается имя **appsvclocalstor**.
    6. Щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image03.png)

7. Введите данные для файлового ресурса и щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image04.png)

8. На следующей странице:
    1. В поле **Identity Application ID** (Идентификатор приложения идентификации) введите GUID приложения, используемого для идентификации.
    2. В поле **Identity Application certificate file** (Файл сертификата приложения идентификации) введите расположение файла сертификата или перейдите к нему.
    3. В поле **Identity Application certificate password** (Пароль сертификата приложения идентификации) введите пароль для сертификата. Нужно ввести пароль, записанный при использовании скрипта для создания сертификатов.
    4. В поле **Azure Resource Manager root certificate file** (Файл корневого сертификата Azure Resource Manager) введите расположение файла сертификата или перейдите к нему.
    5. Щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image05.png)

9. В каждом из трех полей файла сертификата щелкните **Обзор** и перейдите к нужному файлу сертификата. Необходимо также указать пароль для каждого сертификата. Это сертификаты, созданные на шаге [создания требуемых сертификатов](azure-stack-app-service-deploy.md#create-the-required-certificates). Когда вы введете всю информацию, щелкните **Далее**.

    | Box | Пример имени файла сертификата |
    | --- | --- |
    | **Файл SSL-сертификата по умолчанию службы приложений** | \_.appservice.local.AzureStack.external.pfx |
    | **Файл SSL-сертификата API службы приложений** | api.appservice.local.AzureStack.external.pfx |
    | **Файл SSL-сертификата издателя службы приложений** | ftp.appservice.local.AzureStack.external.pfx |

    Если при создании сертификатов использовался другой суффикс домена, имена файлов сертификатов не будут содержать *local.AzureStack.external*. Вместо этого используйте данные для личного домена.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image06.png)    

10. Введите сведения об SQL Server для экземпляра сервера, используемого для размещения баз данных поставщика ресурсов службы приложений, и щелкните **Далее**. Установщик проверит свойства подключения SQL.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image07.png)    

11. Просмотрите параметры номера SKU и экземпляра роли. По умолчанию указываются минимальные рекомендуемые SKU экземпляров для каждой роли. Ниже приведена сводка требований к ядрам и памяти, чтобы помочь вам спланировать развертывание. Выбрав необходимые значения, щелкните **Далее**.

    | Роль | Минимально рекомендуемые экземпляры | Минимально рекомендуемые номера SKU | Примечания |
    | --- | --- | --- | --- |
    | Controller | 1 | Standard_A1 (1 ядро, 1792 МБ) | Управляет состоянием работоспособности облачной службы приложений и поддерживает его. |
    | управления | 1 | Standard_A2 (2 ядра, 3584 МБ) | Управляет конечными точками API и Azure Resource Manager службы приложений, расширениями портала (администратора, клиента, портала Функций) и службой данных. Чтобы поддерживать отработку отказа, увеличьте рекомендуемые экземпляры до 2. |
    | Издатель | 1 | Standard_A1 (1 ядро, 1792 МБ) | Публикует содержимое через FTP и веб-развертывание. |
    | FrontEnd | 1 | Standard_A1 (1 ядро, 1792 МБ) | Направляет запросы в приложения службы приложений. |
    | Общая рабочая роль | 1 | Standard_A1 (1 ядро, 1792 МБ) | Размещает веб-приложения или приложения API и приложения Функций Azure. Может потребоваться добавить дополнительные экземпляры. Оператор может определить свое предложение и выбрать любой уровень SKU. Уровни должны иметь как минимум одно ядро. |

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image08.png)    

    > [!NOTE]
    > В технической предварительной версии установщик поставщика ресурсов службы приложений также развертывает экземпляр Standard A1 для работы в качестве простого файлового сервера для поддержки Azure Resource Manager. Этот экземпляр остается для комплекта разработки с одним узлом. Для производственных рабочих нагрузок в общедоступной версии установщик службы приложений позволяет использовать файловый сервер высокой доступности.

12. В поле **Select Platform Image** (Выбор образа платформы) выберите образ виртуальной машины Windows Server 2016 для развертывания из доступных в поставщике ресурсов вычислений для облачной службы приложений. Щелкните **Далее**.

13. На следующей странице:
     1. Введите имя администратора и пароль для виртуальной машины рабочей роли.
     2. Введите имя администратора и пароль для виртуальной машины других ролей.
     3. Щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image09.png)    

14. На странице "Сводка":
    1. Проверьте выбранные параметры. Чтобы внести изменения, используйте кнопки **Назад** для перехода на предыдущие страницы.
    2. Если настройки указаны правильно, установите флажок.
    3. Чтобы начать развертывание, щелкните **Далее**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image10.png)    

15. На следующей странице:
    1. Отслеживайте ход выполнения установки. Развертывание службы приложений в Azure Stack занимает до 60 минут, если выбраны значения по умолчанию.
    2. После успешного завершения установки щелкните **Выход**.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/image11.png)    


## <a name="validate-the-app-service-on-azure-stack-installation"></a>Проверка установки службы приложений в Azure Stack

1. На портале администрирования Azure Stack перейдите к группе ресурсов, созданной установщиком. По умолчанию эта группа называется **APPSERVICE-LOCAL**.

2. Найдите **CN0-VM**. Чтобы подключиться к виртуальной машине, в колонке **Виртуальная машина** щелкните **Подключение**.

3. На рабочем столе виртуальной машины дважды щелкните **Web Cloud Management Console** (Консоль управления веб-облаком).

4. Выберите **Managed Servers** (Управляемые серверы).

5. Если все серверы имеют состояние **Готово** для одной или нескольких рабочих ролей, перейдите к шагу 6.

6. Закройте машину с удаленным рабочим столом и вернитесь к машине, на которой выполнялся установщик службы приложений.

    ![Установщик службы приложений](media/azure-stack-app-service-deploy/managed-servers.png)    


## <a name="test-drive-app-service-on-azure-stack"></a>Тестирование службы приложений в Azure Stack

После развертывания и регистрации поставщика ресурсов службы приложений проверьте его, чтобы убедиться в том, что пользователи могут развертывать веб-приложения и приложения API.

> [!NOTE]
> Необходимо создать предложение, в плане которого есть пространство имен Microsoft.Web. Затем вам потребуется подписка клиента, которая подписывается на это предложение. Дополнительные сведения см. в статье [Create an offer in Azure Stack](azure-stack-create-offer.md) (Создание предложения в Azure Stack) и [Create a plan in Azure Stack](azure-stack-create-plan.md) (Создание плана в Azure Stack).
>
Для создания приложений, использующих службу приложений в Azure Stack, *необходимо* иметь подписку клиента. Операции, которые администратор службы может выполнить на портале администратора, связаны с администрированием поставщика ресурсов службы приложений. В частности, добавление емкости, настройка источников развертывания и добавление уровней рабочей роли и номеров SKU.
>
Начиная с третьей технической предварительной версии, для создания веб-приложения, приложения API и приложения Функций Azure необходимо использовать портал клиента и иметь подписку клиента.

1. На портале клиента Azure Stack щелкните **Создать** > **Интернет+мобильные устройства** > **Веб-приложение**.

2. В колонке **Веб-приложение** введите имя в поле **Веб-приложение**.

3. В разделе **Группа ресурсов** щелкните **Создать**. Введите имя в поле **Группа ресурсов**.

4. Щелкните **Расположение или план службы приложений** > **Создать**.

5. В колонке **План службы приложений** введите имя в поле **План службы приложений**.

6. Щелкните **Ценовая категория** > **Free-Shared** (Бесплатный — общий) или **Shared-Shared** (Общий — общий) > **Выбрать** > **ОК** > **Создать**.

7. Через минуту на панели инструментов появится плитка для нового веб-приложения. Щелкните плитку.

8. В колонке **Веб-приложение** щелкните **Обзор**, чтобы просмотреть веб-сайт по умолчанию для этого приложения.

## <a name="deploy-a-wordpress-dnn-or-django-website-optional"></a>Развертывание веб-сайта WordPress, DNN или Django (необязательно)

1. На портале клиента Azure Stack щелкните **+**, перейдите к Azure Marketplace, разверните веб-сайт Django и дождитесь его успешного завершения. Веб-платформа Django использует базу данных на основе файловой системы. Дополнительные поставщики ресурсов, такие как SQL или MySQL, не требуются.

2. Если вы также развернули поставщик ресурсов MySQL, можно развернуть веб-сайт WordPress из Marketplace. Когда появится запрос на ввод параметров базы данных, введите имя пользователя в формате *User1@Server1*, указав имя пользователя и имя сервера по своему усмотрению.

3. Если вы также развернули поставщик ресурсов SQL Server, можно развернуть веб-сайт DNN из Marketplace. Когда появится запрос на ввод параметров базы данных, выберите базу данных на компьютере под управлением SQL Server с подключением к поставщику ресурсов.

## <a name="next-steps"></a>Дальнейшие действия

Можно также попробовать другие [службы платформы как услуги (PaaS)](azure-stack-tools-paas-services.md).

- [Use SQL databases on Microsoft Azure Stack](azure-stack-sql-resource-provider-deploy.md) (Использование баз данных SQL в Microsoft Azure Stack)
- [Use MySQL databases on Microsoft Azure Stack](azure-stack-mysql-resource-provider-deploy.md) (Использование баз данных MySQL в Microsoft Azure Stack)

<!--Links-->
[Azure_Stack_App_Service_preview_installer]: http://go.microsoft.com/fwlink/?LinkID=717531
[App_Service_Deployment]: http://go.microsoft.com/fwlink/?LinkId=723982
[AppServiceHelperScripts]: http://go.microsoft.com/fwlink/?LinkId=733525
