<properties
   pageTitle="Устранение неполадок клиента Docker в Windows с помощью Visual Studio | Microsoft Azure"
   description="Устранение неполадок, которые возникают при использовании Visual Studio для создания и развертывания веб-приложений в Docker в Windows с помощью Visual Studio."
   services="visual-studio-online"
   documentationCenter="na"
   authors="TomArcher"
   manager="douge"
   editor="" />
<tags
   ms.service="multiple"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="multiple"
   ms.date="04/18/2016"
   ms.author="tarcher" />

# Устранение ошибок Docker

После настройки всех параметров контейнера Docker для вашего приложения следует убедиться, что параметры и пути указаны правильно. Это можно сделать с помощью кнопки "Проверить" в диалоговом окне "Опубликовать" в Visual Studio.

Этот раздел поможет вам обнаружить и устранить или временно решить наиболее распространенные проблемы, возникающие при размещении приложения Visual Studio в Docker. Дополнительные проблемы будут добавляться в этот раздел по мере обнаружения.

## Вы получили сообщение об ошибке в диалоговом окне "Публикация веб-приложения" при попытке проверить подключение к узлу Docker.

Ниже приведены несколько возможных решений этой проблемы.

- На вкладке **Подключение** диалогового окна **Публикация** убедитесь, что **URL-адрес сервера** указан правильно, а значение `:<port_number>` в конце **URL-адреса сервера** соответствует порту, от которого управляющая программа Docker ожидает передачи данных.

- На вкладке **Подключение** диалогового окна **Публикация** разверните раздел **Дополнительные параметры Docker** и убедитесь, что параметры **проверки подлинности** указаны правильно.
  - Если в управляющей программе Docker на сервере настроено использование безопасности TLS, интерфейс командной строки Docker в Windows (docker.exe) по умолчанию будет искать ключ клиента (key.pem) и сертификат (cert.pem) в папке `<%userprofile%>\.docker`. Если они отсутствуют, их нужно создать с помощью OpenSSL. Дополнительные сведения о настройке протокола TLS в Docker см. в статье [Защита сокета управляющей программы Docker с помощью HTTPS](https://docs.docker.com/articles/https/).

	Чтобы убедиться, что проверка подлинности Docker из клиента Windows для сервера Linux проходит успешно, можно скопировать содержимое текстового поля «Предварительный просмотр» в новое окно командной строки и изменить `<command>` на info, как показано ниже.

    ```
    // This example assumes the Docker daemon is configured to use the default port
    // of 2376 to listen for connections.docker.

    --tls -H tcp://contoso.cloudapp.net:2376 info
    ```

    Можно не копировать сертификат клиента и файлы ключей в папку .docker, а изменить параметры **Проверки подлинности**, добавив следующие параметры:

    ```
    --tls --tlscert=C:\mycert\cert.pem --tlskey=C:\mycert\key.pem
    ```
- Убедитесь, что управляющая программа Docker на компьютере узла Docker имеет версию 1.6 или более позднюю версию.

## Ошибка истечения времени ожидания при использовании собственных сертификатов без сертификата клиента в каталоге Docker

Если вы решили использовать собственные сертификаты при создании узла Docker в Visual Studio (т. е. сняли флажок **Автоматически создать сертификаты Docker** в диалоговом окне **Создание виртуальной машины в Microsoft Azure**), необходимо скопировать сертификат клиента и файлы ключей (cert.pem и key.pem) в папку Docker (`<%userprofile%>\.docker`). В противном случае при публикации проекта вы получите сообщение об истечении времени ожидания (по истечении одного часа) и публикация проекта завершится неудачно.

## Для публикации в контейнеры Docker необходима PowerShell 3.0.

Если вы используете Windows 7 или Windows Server 2008, то перед публикацией в контейнеры Docker необходимо установить PowerShell 3.0. PowerShell 3.0 входит в [Windows Management Framework 3.0](https://www.microsoft.com/ru-RU/download/details.aspx?id=34595). После установки необходимо перезагрузить систему.

В качестве альтернативного решения можно обновиться до Windows 8.1 или Windows 10, которые уже содержат PowerShell 3.0.

## Окно PowerShell не закрывается автоматически.

Иногда после создания виртуальной машины окно PowerShell не закрывается автоматически. Если закрыть это окно, то Visual Studio также закрывается. Поскольку это окно никак не влияет на Visual Studio и инструменты Docker, пожалуйста, оставьте его открытым до завершения работы.

## Часто задаваемые вопросы

Вопрос. Как создать новую виртуальную машину под управлением Linux с поддержкой Docker в Azure, используя средства Visual Studio?

Ответ. Сведения о том, как это сделать, приведены в статье [Размещение веб-приложений в Docker](vs-azure-tools-docker-hosting-web-apps-in-docker.md).

Вопрос. Какие шаблоны проектов Visual Studio поддерживаются для публикации в контейнер Docker в Linux?

Ответ. В настоящее время Visual Studio поддерживает консольное приложение C# (пакет) и предварительную версию шаблонов C# ASP.NET 5, включающих:

- Пусто

- Веб-интерфейс API

- Веб-приложение

Вопрос. Как опубликовать консольный проект или веб-проект ASP.NET 5 в Docker с помощью MSBuild из командной строки?

Ответ. Используйте следующую команду MSBuild:

    `msbuild <projectname.xproj> /p:deployOnBuild=true;publishProfile=<profilename>`

Вопрос. Как опубликовать консольный проект или веб-проект ASP.NET 5 в Docker с помощью PowerShell из командной строки?

Ответ. Используйте следующую команду PowerShell:

```
.\contoso-Docker-publish.ps1 -packOutput $env:USERPROFILE\AppData\Local\Temp\PublishTemp -pubxmlFile .\contoso-Docker.pubxml
```

Вопрос. У меня есть собственный сервер Linux с установленным программным обеспечением Docker. Как указать его в диалоговом окне **Публикация веб-проекта**?

Ответ. См. раздел **Создание пользовательского узла Docker** в статье [Размещение веб-приложений в Docker](vs-azure-tools-docker-hosting-web-apps-in-docker.md).

Вопрос. У меня есть собственный сервер Linux с установленным Docker. Как создать ключи и сертификаты для настройки проверки подлинности с использованием TLS?

Ответ. Для создания необходимых сертификатов и ключей для центра сертификации, сервера и клиента можно воспользоваться OpenSSL на сервере. Затем можно установить подключение SSH/SFTP с помощью сторонней программы и скопировать сертификаты на локальный компьютер Windows разработчика. По умолчанию интерфейс командной строки (CLI) Docker попытается использовать сертификаты, расположенные в папке `<userprofile>\.docker`.

Другой вариант — загрузить OpenSSL для Windows и создать необходимые сертификаты и ключи и затем загрузить ЦС, серверные сертификаты и ключи на компьютер Linux. Дополнительные сведения о настройке защищенного подключения к Docker см. в статье [Защита сокета управляющей программы Docker с помощью HTTPS](https://docs.docker.com/articles/https/).

<!---HONumber=AcomDC_0420_2016-->