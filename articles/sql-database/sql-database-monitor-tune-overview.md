---
title: Мониторинг и настройка производительности базы данных SQL Azure | Документация Майкрософт
description: Советы по настройке базы данных SQL Azure — оценка и улучшение производительности.
services: sql-database
ms.service: sql-database
ms.subservice: performance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: danimir
ms.author: v-daljep
ms.reviewer: carlrab
manager: craigg
ms.date: 07/16/2018
ms.openlocfilehash: c79285247950510791ede915fcf0e5373792044f
ms.sourcegitcommit: 51a1476c85ca518a6d8b4cc35aed7a76b33e130f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2018
ms.locfileid: "47165047"
---
# <a name="monitoring-and-performance-tuning"></a>Мониторинг и настройка производительности

База данных SQL Azure — это управляемая автоматически гибкая служба данных, позволяющая легко отслеживать использование, добавлять и удалять ресурсы (ЦП, памяти, ввода-вывода), находить рекомендации, которые могут повысить производительность базы данных, а также позволить базе данных адаптироваться к рабочей нагрузке и автоматически оптимизировать производительность.

## <a name="overview-of-monitoring-database-performance-in-azure-sql-database"></a>Общие сведения о производительности базы данных в Базе данных SQL Azure
Мониторинг производительности базы данных SQL в Azure начинается с мониторинга использования ресурсов в соответствии с выбранным уровнем производительности базы данных. С помощью мониторинга можно определить, является ли емкость базы данных избыточной или же проблема возникает из-за того, что ресурсы используются на пределе возможностей. Затем при необходимости можно изменить объем вычислительных ресурсов и уровень служб своей базы данных в [модели приобретения на основе DTU](sql-database-service-tiers-dtu.md) или [модели приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md). Вы можете выполнять мониторинг базы данных с помощью графических средств на [портале Azure](https://portal.azure.com) или с помощью [динамических административных представлений (DMV)](sql-database-monitoring-with-dmvs.md) SQL.

База данных SQL Azure позволяет выявить возможности для повышения и оптимизации производительности запросов без изменения ресурсов. Для этого достаточно изучить [рекомендации по настройке производительности](sql-database-advisor.md). Отсутствующие индексы и плохо оптимизированные запросы — распространенные причины низкой производительности баз данных. Можно применить эти рекомендации по настройке, чтобы повысить производительность рабочей нагрузки.
Можно также позволить Базе данных Azure SQL [автоматически оптимизировать производительность запросов](sql-database-automatic-tuning.md). В этом случае она будет применять все созданные рекомендации и проверять, действительно ли они повышают производительность базы данных. Доступны следующие возможности мониторинга и устранения неполадок производительности базы данных.

- На [портале Azure](https://portal.azure.com) щелкните **Базы данных SQL**, выберите базу данных и найдите ресурсы, приближающиеся к максимальной отметке, на диаграмме мониторинга. По умолчанию отображается процент использования DTU. Щелкните **Изменить** , чтобы изменить диапазон времени и отображаемые значения.
- На странице [Анализ производительности запросов](sql-database-query-performance.md) можно определить, какие запросы потребляют большую часть ресурсов.
- Используйте [Помощник по базам данных SQL](sql-database-advisor-portal.md), чтобы просматривать рекомендации по созданию и удалению индексов, параметризации запросов и устранению ошибок схемы.
- Используйте [Azure SQL Intelligent Insights](sql-database-intelligent-insights.md) для автоматического мониторинга производительности базы данных. После обнаружения проблемы с производительностью создается журнал диагностики, в который записываются сведения о проблеме и результат анализа ее первопричин (RCA). При возможности также приводятся рекомендации по повышению производительности.
- [Включите автоматическую настройку](sql-database-automatic-tuning-enable.md) и позвольте Базе данных SQL Azure автоматически исправлять выявленные проблемы производительности.
- Можно также использовать [динамические административные представления](sql-database-monitoring-with-dmvs.md), [расширенные события (`XEvents`)(sql-database/sql-database-xevent-db-diff-from-svr.md) и [хранилище запросов](https://docs.microsoft.com/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store), чтобы получать параметры производительности в режиме реального времени. В [этом руководстве по производительности](sql-database-performance-guidance.md) описаны методы, которые можно использовать, чтобы повысить производительность Базы данных SQL Azure, если вы обнаружили какие-либо проблемы с помощью этих отчетов или представлений.

## <a name="monitor-databases-using-the-azure-portal"></a>Мониторинг баз данных с помощью портала Azure
На [портале Azure](https://portal.azure.com/) можно отслеживать использование отдельной базы данных. Для этого нужно выбрать базу данных и щелкнуть диаграмму **Мониторинг**. Появится окно **Метрика**, которое можно изменить, нажав кнопку **Изменить диаграмму**. Добавьте следующие метрики:

* Процент использования ЦП
* Процент использования DTU
* Процент операций ввода/вывода данных
* Размер базы данных в процентах

После добавления этих метрик можно продолжить наблюдение за ними на диаграмме **Мониторинг** с более подробными сведениями в окне **Метрика**. Все четыре метрики показывают средний процент использования в соответствии с количеством единиц **DTU** для вашей базы данных. Узнайте больше об уровнях служб, ознакомившись с [моделью приобретения на основе DTU](sql-database-service-tiers-dtu.md) и [моделью приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md).  

![Мониторинг производительности базы данных для разных уровней служб.](./media/sql-database-single-database-monitoring/sqldb_service_tier_monitoring.png)

Также можно настроить оповещения для метрик производительности. В окне **Метрика** нажмите кнопку **Добавить оповещение**. Следуйте инструкциям мастера для настройки оповещения. Можно настроить предупреждение, информирующее либо о превышении показателями определенного порога, либо о падении показателей ниже определенного порога.

Например, если предполагается, что рабочая нагрузка базы данных будет расти, можно настроить отправку оповещения по электронной почте каждый раз, когда любой из показателей производительности для вашей базы данных достигнет 80%. Это оповещение можно использовать как предварительное предупреждение о том, что необходимо перейти на следующий, более высокий объем вычислительных ресурсов.

Метрики производительности также помогут определить, можете ли вы перейти на более низкий объем вычислительных ресурсов. Предположим, вы используете базу данных размера S2 уровня Стандартный, и все метрики производительности показывают, что база данных никогда не используется более чем на 10%. Вполне вероятно, что эта база данных будет хорошо работать с размером S1 уровня Стандартный. Однако перед переходом на более низкий уровень производительности следует учитывать скачки и колебания объема вычислительных ресурсов.

## <a name="improving-database-performance-with-more-resources"></a>Повышение производительности базы данных с помощью дополнительных ресурсов

Наконец, если для базы данных нет применимых рекомендаций по повышению производительности, можно изменить объем ресурсов, доступных в Базе данных SQL Azure. Можно назначить больше ресурсов, изменив [уровень служб на основе DTU](sql-database-service-tiers-dtu.md) отдельной базы данных или увеличив количество eDTU эластичного пула в любое время. Кроме того, если вы используете [модель приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md), вы можете изменить уровень служб или увеличить объем ресурсов, выделенных для базы данных. 
1. Для повышения производительности отдельных баз данных можно изменять [уровни служб](sql-database-service-tiers-dtu.md) или объем [вычислительных ресурсов](sql-database-service-tiers-vcore.md) по запросу.
2. Если баз данных несколько, можно включить автомасштабирование ресурсов, используя [пулы эластичных баз данных](sql-database-elastic-pool-guidance.md).

## <a name="tune-and-refactor-application-or-database-code"></a>Настройка и рефакторинг кода приложения или базы данных

Можно изменить код приложения для более оптимального использования базы данных, изменить индексы, принудительно применить планы или с помощью указаний вручную адаптировать базу данных для рабочей нагрузки. Рекомендации и советы по ручной настройке и изменению кода приведены в [этом разделе руководства по производительности](sql-database-performance-guidance.md).


## <a name="next-steps"></a>Дополнительная информация

- Дополнительные сведения о том, как включить автоматическую настройку в Базе данных SQL Azure и позволить ей полностью управлять рабочей нагрузкой, см. в [этой статье](sql-database-automatic-tuning-enable.md).
- Дополнительные сведения о ручной настройке для повышения производительности запросов см. в статье [Использование помощника по базам данных SQL на портале Azure](sql-database-advisor-portal.md).
- Изменить ресурсы, доступные в базе данных, можно, изменив [уровни служб Базы данных SQL Azure](sql-database-performance-guidance.md).
