---
title: Обнаружение угроз в Базе данных SQL Azure | Документация Майкрософт
description: Система обнаружения угроз определяет подозрительные действия базы данных, указывая на наличие потенциальных угроз безопасности в Базе данных SQL Azure.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: rmatchoro
ms.author: ronmat
ms.reviewer: vanto, carlrab
manager: craigg
ms.date: 02/04/2019
ms.openlocfilehash: 395bf57b967ebeefe0a4168b53a4341c304e3d4f
ms.sourcegitcommit: 3aa0fbfdde618656d66edf7e469e543c2aa29a57
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2019
ms.locfileid: "55729512"
---
# <a name="azure-sql-database-threat-detection"></a>Обнаружение угроз Базы данных SQL Azure

Система обнаружения угроз для [Базы данных SQL Azure](sql-database-technical-overview.md) и [Хранилища данных SQL](../sql-data-warehouse/sql-data-warehouse-overview-what-is.md) выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться ими.

Система обнаружения угроз входит в состав предложения [Расширенная защита данных](sql-database-advanced-data-security.md) (ADS), которое представляет собой единый пакет расширенных возможностей безопасности SQL. Доступ к системе обнаружения угроз можно получить через центральный портал SQL ADS. Там же ею можно управлять.

> [!NOTE]
> Этот раздел относится к Azure SQL Server, а также к базам данных SQL и хранилища данных SQL, создаваемым на сервере Azure SQL Server. Для простоты база данных SQL используется как для базы данных SQL, так и для хранилища данных SQL.

## <a name="what-is-threat-detection"></a>Что собой представляет обнаружение угроз

Благодаря оповещениям безопасности о подозрительной активности система обнаружения угроз формирует дополнительный уровень безопасности, который позволяет клиентам обнаруживать потенциальные угрозы по мере возникновения и реагировать на них. Пользователи получают оповещения о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных закономерностей в доступе к базам данных и шаблонам запросов. Система обнаружения угроз интегрирует оповещения с [Центром безопасности Azure](https://azure.microsoft.com/services/security-center/), который предоставляет сведения о подозрительных операциях и дает рекомендации о том, как определить причину угрозы и устранить ее. Система обнаружения угроз упрощает устранение потенциальных угроз безопасности базы данных, не требуя от пользователя экспертных навыков в сфере безопасности либо умения работать в сложных системах отслеживания угроз.

Чтобы воспользоваться всеми преимуществами исследования, советуем включить [аудит базы данных SQL](sql-database-auditing.md), при котором события базы данных записываются в журнал аудита вашей учетной записи хранения Azure.  

## <a name="threat-detection-alerts"></a>Оповещения об обнаружении угроз

Система обнаружения угроз Базы данных SQL Azure выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями. Она может активировать указанные ниже оповещения.

- **Уязвимость к атакам путем внедрения кода SQL.** Это предупреждение появляется, если приложение создает в базе данных инструкцию SQL с ошибкой. Оно может указывать на возможную уязвимость к атакам путем внедрения кода SQL. Существует две причины создания инструкции с ошибкой:

  - Дефект в коде приложения, который создает инструкцию SQL с ошибкой.
  - Код приложения или хранимые процедуры не очищают ввод данных пользователя при создании ошибочной инструкции SQL, которая может быть использована для внедрения кода SQL.
- **Потенциальная атака путем внедрения кода SQL.** Это предупреждение появляется при обнаружении активного эксплойта определенной уязвимости приложения к внедрению кода SQL. Это означает, что злоумышленник пытается внедрить вредоносные инструкции SQL с помощью кода уязвимого приложения или хранимых процедур.
- **Доступ из незнакомого расположения.** Это предупреждение появляется при изменении способа доступа к серверу SQL, если пользователь вошел на сервер SQL из необычного географического расположения. Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из необычного центра обработки данных Azure.** Это предупреждение появляется при изменении способа доступа к серверу SQL, если кто-то за последнее время выполнял вход на сервер SQL из необычного центра обработки данных Azure. Иногда предупреждение определяет допустимые действия (новое приложение в Azure, Power BI, редактор SQL-запросов Azure). В других случаях предупреждение обнаруживает угрозу от ресурса или службы Azure (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из незнакомого субъекта**. Это предупреждение появляется при изменении способа доступа к серверу SQL, если пользователь вошел на сервер SQL с помощью необычного субъекта (пользователя SQL). Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из потенциально опасного приложения**. Это предупреждение появляется, если для доступа к базе данных используется потенциально опасное приложение. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку с помощью обычных средств.
- **Подбор учетных данных SQL.** Это предупреждение появляется при большом количестве неудачных попыток входа с разными учетными данными. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку методом подбора.

## <a name="explore-anomalous-database-activities-upon-detection-of-a-suspicious-event"></a>Анализ подозрительной активности в базе данных при обнаружении подозрительного события

При обнаружении подозрительной активности в базе данных вы получите уведомление по электронной почте. В этом уведомлении содержится информация о подозрительном событии безопасности, в том числе характер подозрительных операций, имя базы данных, имя сервера, имя приложения, а также время, когда произошло событие. Кроме того, в уведомлении приводится информация о возможных причинах возникновения события, а также рекомендуемые действия по поиску и устранению потенциальной угрозы безопасности базы данных.

![Отчеты об аномальных действиях](./media/sql-database-threat-detection/anomalous_activity_report.png)

1. Щелкните ссылку **View recent SQL alerts** (Просмотр недавних оповещений SQL) в почтовом сообщении, чтобы запустить портал Azure и открыть страницу оповещений центра безопасности Azure. На этой странице содержится обзор активных угроз, обнаруженных в базе данных SQL.

   ![Угрозы, связанные с действиями](./media/sql-database-threat-detection/active_threats.png)

2. Щелкните определенное оповещение, чтобы отобразить дополнительные сведения и действия для изучения этой угрозы и устранения будущих угроз.

   Например, внедрение кода SQL — один из распространенных видов угроз безопасности веб-приложений в Интернете, используемый для получения несанкционированного доступа к приложениям, управляемым данными. Хакеры используют уязвимости приложения, чтобы ввести вредоносные инструкции SQL в поля ввода приложения, чтобы испортить или изменить данные в базе данных. В сведениях оповещений о внедрении кода SQL указывается уязвимая инструкция SQL, которая была использована.

   ![Определенное оповещение](./media/sql-database-threat-detection/specific_alert.png)

## <a name="explore-threat-detection-alerts-for-your-database-in-the-azure-portal"></a>Изучение оповещений об обнаружении угроз базы данных на портале Azure

Обнаружение угроз интегрирует оповещения с [Центром безопасности Azure](https://azure.microsoft.com/services/security-center/). Динамические плитки обнаружения угроз SQL в колонках базы данных и SQL ATP на портале Azure отслеживают состояние активных угроз.

Щелкните **Threat detection alert** (Оповещение об обнаружении угроз), чтобы запустить страницу оповещений центра безопасности Azure и получить обзор активных угроз SQL, обнаруженных в базе данных или хранилище данных.

   ![Оповещение об обнаружении угроз](./media/sql-database-threat-detection/threat_detection_alert.png)

   ![Оповещение об обнаружении угроз 2](./media/sql-database-threat-detection/threat_detection_alert_atp.png)

## <a name="next-steps"></a>Дополнительная информация

- Дополнительные сведения об обнаружении угроз в отдельной базе данных и в базе данных в составе пула см. [здесь](sql-database-threat-detection.md).
- Дополнительные сведения об [обнаружении угроз в управляемом экземпляре](sql-database-managed-instance-threat-detection.md).
- Дополнительные сведения о [расширенной защите данных](sql-database-advanced-data-security.md).
- Узнайте больше об аудите Базы данных SQL Azure [здесь](sql-database-auditing.md).
- Дополнительные сведения о [Центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro).
- Дополнительные сведения о [ценах на Базу данных SQL](https://azure.microsoft.com/pricing/details/sql-database/).  
