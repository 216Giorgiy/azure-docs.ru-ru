---
title: Обнаружение угроз для базы данных SQL Azure | Документация Майкрософт
description: Система обнаружения угроз определяет подозрительные действия в базе данных SQL Azure, указывающие на наличие потенциальных угроз безопасности.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: rmatchoro
ms.author: ronmat
ms.reviewer: vanto, carlrab
manager: craigg
ms.date: 10/25/2018
ms.openlocfilehash: f081ccc1eb6c414d62b1bd0e74b6023bc1f0faba
ms.sourcegitcommit: 2469b30e00cbb25efd98e696b7dbf51253767a05
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/06/2018
ms.locfileid: "53003434"
---
# <a name="azure-sql-database-threat-detection"></a>Обнаружение угроз базы данных SQL Azure

Система обнаружения угроз SQL Azure для служб [База данных SQL Azure](sql-database-technical-overview.md) и [Хранилище данных SQL](../sql-data-warehouse/sql-data-warehouse-overview-what-is.md) выявляет аномальные действия, указывающие на необычные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями.

Система обнаружения угроз входит в состав предложения [Расширенная защита от угроз SQL ](sql-advanced-threat-protection.md), которое представляет собой унифицированный пакет расширенных возможностей безопасности SQL. Доступ к системе обнаружения угроз можно получить через центральный портал SQL ATP. Там же ею можно управлять.

> [!NOTE] 
> Этот раздел относится к Azure SQL Server, а также к базам данных SQL и хранилища данных SQL, создаваемым на сервере Azure SQL Server. Для простоты база данных SQL используется как для базы данных SQL, так и для хранилища данных SQL.

За использование системы обнаружения угроз взимается плата в размере 15 долл. США в месяц за все базы данных для каждого логического сервера или управляемого экземпляра. При этом первые 30 дней системой можно пользоваться бесплатно.

## <a name="what-is-threat-detection"></a>Общие сведения о системе обнаружения угроз

Благодаря оповещениям безопасности о подозрительной активности система обнаружения угроз формирует дополнительный уровень безопасности, позволяющий клиентам обнаруживать потенциальные угрозы по мере возникновения и реагировать на них. Пользователи получают оповещения о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных закономерностей в доступе к базам данных и шаблонам запросов. Система обнаружения угроз SQL интегрирует оповещения с [центром безопасности Azure](https://azure.microsoft.com/services/security-center/), который предоставляет сведения о подозрительных операциях и дает рекомендации о том, как определить причину угрозы и устранить ее. Система обнаружения угроз SQL упрощает устранение потенциальных угроз безопасности базы данных, не требуя от пользователя экспертных навыков в сфере безопасности либо умения работать в сложных системах отслеживания угроз. 

Чтобы воспользоваться всеми преимуществами исследования, советуем включить [аудит базы данных SQL](sql-database-auditing.md), при котором события базы данных записываются в журнал аудита вашей учетной записи хранения Azure.  

## <a name="azure-sql-database-threat-detection-alerts"></a>Оповещение об обнаружении угроз базы данных SQL Azure 
Система обнаружения угроз службы "База данных SQL Azure" выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями. Она может активировать следующие оповещения:
- **Уязвимость к атакам путем внедрения кода SQL.** Это предупреждение появляется, если приложение создает в базе данных инструкцию SQL с ошибкой. Оно может указывать на возможную уязвимость к атакам путем внедрения кода SQL. Существует две причины создания инструкции с ошибкой:
   - Дефект в коде приложения, который создает инструкцию SQL с ошибкой.
   - Код приложения или хранимые процедуры не очищают ввод данных пользователя при создании ошибочной инструкции SQL, которая может быть использована для внедрения кода SQL.
- **Потенциальная атака путем внедрения кода SQL.** Это предупреждение появляется при обнаружении активного эксплойта определенной уязвимости приложения к внедрению кода SQL. Это означает, что злоумышленник пытается внедрить вредоносные инструкции SQL с помощью кода уязвимого приложения или хранимых процедур.
- **Доступ из незнакомого расположения.** Это предупреждение появляется при изменении способа доступа к серверу SQL, если пользователь вошел на сервер SQL из необычного географического расположения. Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из необычного центра обработки данных Azure.** Это предупреждение появляется при изменении способа доступа к серверу SQL, если кто-то за последнее время выполнял вход на сервер SQL из необычного центра обработки данных Azure. Иногда предупреждение определяет допустимые действия (новое приложение в Azure, Power BI, редактор SQL-запросов Azure). В других случаях предупреждение обнаруживает угрозу от ресурса или службы Azure (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из незнакомого субъекта.** Это предупреждение появляется при изменении способа доступа к серверу SQL, если пользователь вошел на сервер SQL с помощью необычного субъекта (пользователя SQL). Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из потенциально опасного приложения.** Это предупреждение появляется, если для доступа к базе данных используется потенциально опасное приложение. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку с помощью обычных средств.
- **Подбор учетных данных SQL.** Это предупреждение появляется при большом количестве неудачных попыток входа с разными учетными данными. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку методом подбора.

## <a name="explore-anomalous-database-activities-upon-detection-of-a-suspicious-event"></a>Анализ подозрительной активности в базе данных при обнаружении подозрительного события

При обнаружении подозрительной активности в базе данных вы получите уведомление по электронной почте. В этом уведомлении содержится информация о подозрительном событии безопасности, в том числе характер подозрительных операций, имя базы данных, имя сервера, имя приложения, а также время, когда произошло событие. Кроме того, в уведомлении приводится информация о возможных причинах возникновения события, а также рекомендуемые действия по поиску и устранению потенциальной угрозы безопасности базы данных.

![Отчеты об аномальных действиях](./media/sql-database-threat-detection/anomalous_activity_report.png)
     
1. Щелкните ссылку **View recent SQL alerts** (Просмотр недавних оповещений SQL) в почтовом сообщении, чтобы запустить портал Azure и открыть страницу оповещений центра безопасности Azure. На этой странице содержится обзор активных угроз, обнаруженных в базе данных SQL.

   ![Угрозы, связанные с действиями](./media/sql-database-threat-detection/active_threats.png)

2. Щелкните определенное оповещение, чтобы отобразить дополнительные сведения и действия для изучения этой угрозы и устранения будущих угроз.

   Например, внедрение кода SQL — один из распространенных видов угроз безопасности веб-приложений в Интернете, используемый для получения несанкционированного доступа к приложениям, управляемым данными. Хакеры используют уязвимости приложения, чтобы ввести вредоносные инструкции SQL в поля ввода приложения, чтобы испортить или изменить данные в базе данных. В сведениях оповещений о внедрении кода SQL указывается уязвимая инструкция SQL, которая была использована.

   ![Определенное оповещение](./media/sql-database-threat-detection/specific_alert.png)

## <a name="explore-threat-detection-alerts-for-your-database-in-the-azure-portal"></a>Изучение оповещений об обнаружении угроз базы данных на портале Azure

Оповещения об обнаружении угроз базы данных SQL интегрируются с [центром безопасности Azure](https://azure.microsoft.com/services/security-center/). На динамических плитках обнаружения угроз SQL в колонках базы данных и SQL ATP на портале Azure отображается состояние активных угроз.

Щелкните **Threat detection alert** (Оповещение об обнаружении угроз), чтобы запустить страницу оповещений центра безопасности Azure и получить обзор активных угроз SQL, обнаруженных в базе данных или хранилище данных.

   ![Оповещение об обнаружении угроз](./media/sql-database-threat-detection/threat_detection_alert.png)
   
   ![Оповещение об обнаружении угроз 2](./media/sql-database-threat-detection/threat_detection_alert_atp.png)

## <a name="next-steps"></a>Дополнительная информация

* Подробнее об [обнаружении угроз в отдельной базе данных](sql-database-threat-detection.md). 
* Подробнее об [обнаружении угроз в Управляемом экземпляре](sql-database-managed-instance-threat-detection.md). 
* Дополнительные сведения о службе "Расширенная защита от угроз SQL" см. в [этой статье](sql-advanced-threat-protection.md). 
* Узнайте больше об [аудите базы данных SQL Azure](sql-database-auditing.md).
* Узнайте больше о [центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro).
* Дополнительные сведения о ценах см. на [странице цен на базу данных SQL](https://azure.microsoft.com/pricing/details/sql-database/).  
