---
title: "Уровни служб. Производительность базы данных SQL | Документация Майкрософт"
description: "Сравнение уровней служб базы данных SQL."
keywords: "параметры базы данных, производительность базы данных"
services: sql-database
documentationcenter: 
author: janeng
manager: jhubbard
editor: 
ms.assetid: f5c5c596-cd1e-451f-92a7-b70d4916e974
ms.service: sql-database
ms.custom: resources
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
wms.date: 04/26/2017
ms.author: janeng
ms.translationtype: Human Translation
ms.sourcegitcommit: a3ca1527eee068e952f81f6629d7160803b3f45a
ms.openlocfilehash: 0ab804ee1dc25f1e44be856564ac8ffa87c54dea
ms.contentlocale: ru-ru
ms.lasthandoff: 04/27/2017


---
# <a name="sql-database-options-and-performance-understand-whats-available-in-each-service-tier"></a>Параметры базы данных SQL и производительность: возможности разных уровней служб

[База данных SQL Azure](sql-database-technical-overview.md) предлагает четыре уровня служб: **Базовый**, **Стандартный**, **Премиум** и **Premium RS**. Каждый из них обеспечивает несколько уровней производительности для разных рабочих нагрузок. Чем выше уровень производительности, тем больше он предоставляет ресурсов, предназначенных для повышения пропускной способности. Вы можете динамически изменять уровни служб и уровни производительности без простоев в работе. По условиям SLA, все уровни службы — "Базовый", "Стандартный" и "Премиум" — включают такие преимущества, как бесперебойная работа в течение 99,99 %, гибкие способы обеспечения непрерывности бизнес-процессов, функции безопасности и почасовая тарификация. Уровень Premium RS обеспечивает такие же уровни производительности, функции безопасности и возможности обеспечения непрерывности бизнеса, как и уровень "Премиум", но с меньшими значениями в соглашении об уровне обслуживания.

> [!IMPORTANT]
> Базы данных уровня Premium RS работают с меньшим числом избыточных копий, чем базы данных уровня "Премиум" или "Стандартный". Таким образом в случае сбоя службы может потребоваться восстановить базу данных из резервной копии с задержкой до 5 минут.
>

Вы можете создавать отдельные базы данных с выделенными ресурсами на уровне служб с выбранным [уровнем производительности](sql-database-service-tiers.md#single-database-service-tiers-and-performance-levels). Можно также создавать базы данных в [эластичном пуле](sql-database-service-tiers.md#elastic-pool-service-tiers-and-performance-in-edtus), где ресурсы совместно используются несколькими базами данных. Ресурсы, доступные для отдельных баз данных, выражаются в единицах транзакций базы данных (DTU), а ресурсы для эластичных пулов — в единицах транзакций эластичной базы данных (eDTU). Дополнительные сведения о единицах DTU см. в статье [Общие сведения об обычных единицах передачи данных (DTU) и единицах передачи данных в эластичной базе данных (eDTU)](sql-database-what-is-a-dtu.md). 

## <a name="choosing-a-service-tier"></a>Выбор уровня службы
В следующей таблице приведены примеры уровней службы, которые лучше всего подходят для рабочих нагрузок различных приложений.

| Уровень служб | Целевые рабочие нагрузки |
| :--- | --- |
| **базовая;** | Лучше всего подходит для небольшой базы данных, для которой в определенный момент времени обычно выполняется одна активная операция. В качестве примера можно привести базы данных, используемые для разработки или тестирования, или небольшие редко используемые приложения. |
| **Стандартный** |Оптимальный вариант для облачных приложений с низкими или средними требованиями к производительности операций ввода-вывода, поддерживающий несколько параллельных запросов. В качестве примера можно привести рабочую группу или веб-приложения. |
| **Премиальный** | Разработан для большого объема транзакций с высокими требованиями к производительности операций ввода-вывода. Поддерживается параллельная работа множества пользователей. В качестве примера можно привести базы данных для поддержки критически важных приложений. |
| **Premium RS** | Предназначен для рабочих нагрузок, интенсивно использующих ввод-вывод, но не требующих гарантий максимальной доступности. К примерам относятся тестовые высокопроизводительные рабочие нагрузки или рабочие нагрузки анализа, для которых база данных не является системой учета. |
|||

Сначала определите, требуется ли выполнять отдельную базу данных с определенным количеством выделенных ресурсов, или нужно, чтобы группа баз данных совместно использовала пул ресурсов. Просмотрите [рекомендации по пулам эластичных БД](sql-database-elastic-pool.md). Чтобы выбрать уровень службы, сначала определите минимальный набор необходимых функций базы данных:

| **Возможности уровня служб** | **базовая;** | **Стандартный** | **Премиальный** | **Premium RS**|
| :-- | --: | --: | --: | --: |
| Максимальный размер отдельной базы данных | 2 ГБ | 250 ГБ | 4 TБ*  | 500 ГБ  |
| Максимальный размер базы данных в эластичном пуле | 156 ГБ | 2,9 ТБ | 500 ГБ | 500 ГБ |
| Максимальное количество баз данных на пул | 500  | 500 | 100 | 100 |
| Срок хранения резервной копии | 7 дней | 35 дней | 35 дней | 35 дней |
||||||

> [!IMPORTANT]
> Сейчас эти дополнительные возможности для хранения доступны в следующих регионах: восточная часть США 2, западная часть США, Западная Европа, Юго-Восточная Азия, восточная Япония, восточная Австралия, Центральная Канада и Восточная Канада. См. [текущие ограничения в 4 ТБ](sql-database-service-tiers.md#current-limitations-of-p11-and-p15-databases-with-4-tb-maxsize).
>

Выбрав минимальный уровень службы, переходите к определению уровня производительности для базы данных (в единицах DTU). В качестве отправной точки можно использовать стандартные уровни производительности S2 и S3. Для баз данных с высокими требованиями к ЦП или операциям ввода-вывода рекомендуется начинать с уровней производительности "Премиум". На уровне "Премиум" предоставляется больше ресурсов ЦП и минимум в 10 раз больше операций ввода-вывода по сравнению с самой высокой производительностью на уровне "Стандартный".

## <a name="single-database-service-tiers-and-performance-levels"></a>Уровни служб для отдельной базы данных и уровни производительности
Для отдельных баз данных существует несколько уровней производительности в пределах каждого уровня обслуживания. У вас есть возможность выбирать уровень, который лучше всего соответствует требованиям рабочей нагрузки, с помощью портала Azure, [PowerShell](scripts/sql-database-monitor-and-scale-database-powershell.md), [Transact-SQL](https://docs.microsoft.com/sql/t-sql/statements/alter-database-azure-sql-database), C# и REST API.  

Вне зависимости от количества размещаемых баз данных, вашей базе данных будет выделен гарантированный набор ресурсов. Кроме того, ожидаемые показатели производительности этой базы данных останутся без изменений.

[!INCLUDE [SQL DB service tiers table](../../includes/sql-database-service-tiers-table.md)]

> [!NOTE]
> Подробное описание всех строк этой таблицы уровней служб см. в разделе [Возможности и ограничения уровней служб](sql-database-performance-guidance.md#service-tier-capabilities-and-limits).
> 

## <a name="scaling-up-or-scaling-down-a-single-database"></a>Увеличение или уменьшение масштаба отдельной базы данных

Изначально выбрав уровень служб и уровень производительности, вы сможете динамически увеличивать или уменьшать масштаб отдельной базы данных в процессе фактической работы. Если вам нужно увеличить или уменьшить масштаб, вы легко можете изменить уровни базы данных с помощью портала Azure, [PowerShell](scripts/sql-database-monitor-and-scale-database-powershell.md), [Transact-SQL](https://docs.microsoft.com/sql/t-sql/statements/alter-database-azure-sql-database), C# и REST API. 

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-dynamically-scale-up-or-scale-down/player]
>

При изменении уровня службы или уровня производительности базы данных создается реплика исходной базы данных с новым уровнем производительности, после чего устанавливаются подключения к реплике. Во время этого процесса данные не теряются, но в течение короткого периода, когда производится переподключение к реплике, соединения с базой данных становятся неактивны, поэтому некоторые текущие транзакции могут откатиться. Этот период может быть разным, но обычно он не превышает 4 секунд, а в более чем 99 % случаев его длительность составляет менее 30 секунд. Если в момент отключения подключений выполняется большое количество транзакций, этот период может быть длиннее.  

Длительность всего процесса вертикального масштабирования зависит от размера и уровня службы базы данных до и после изменения. Например, если база данных размером 250 ГБ переводится с уровня службы "Стандартный", на этот уровень или в его пределах, процесс должен завершиться в течение 6 часов. Если уровень производительности базы данных того же размера меняется в пределах уровня службы "Премиум", процесс должен завершиться в течение 3 часов.

* При снижении уровня базы данных ее размер не должен превышать максимально допустимый размер целевого уровня служб. 
* При обновлении базы данных с включенной [георепликацией](sql-database-geo-replication-portal.md) перед обновлением базы данных-источника необходимо сначала обновить базы данных-получатели до требуемого уровня производительности.
* При понижении от уровня обслуживания Premium необходимо сначала завершить все активные отношения георепликации. Чтобы остановить процесс репликации между базой данных-источником и активными базами данных-получателями, выполните действия, описанные в разделе [Восстановление после сбоя](sql-database-disaster-recovery.md) .
* Предложения службы восстановления отличаются для разных уровней служб. При переходе на более низкий уровень можно потерять возможность восстановления на момент времени или получить меньший срок хранения резервных копий. Дополнительные сведения см. в статье [Резервное копирование и восстановление Базы данных SQL Azure](sql-database-business-continuity.md).
* Новые свойства базы данных не применяются до тех пор, пока изменение не завершится.

## <a name="elastic-pool-service-tiers-and-performance-in-edtus"></a>Уровни службы пула эластичных баз данных и производительность в единицах eDTU

Благодаря пулам базы данных могут иметь общий доступ к ресурсам eDTU и совместно использовать их. При этом каждой базе данных в пуле не нужно назначать определенный уровень производительности. Например, отдельная база данных в пуле с уровнем обслуживания "Стандартный" может использовать от 0 до максимального количества единиц eDTU базы данных, которое вы задали в настройках пула. Пулы позволяют нескольким базам данных с меняющейся рабочей нагрузкой эффективно использовать ресурсы eDTU, доступные всему пулу. Дополнительные сведения см. в статье о [ценах и рекомендациях по производительности пула эластичных баз данных](sql-database-elastic-pool.md).

В следующей таблице описаны характеристики уровней обслуживания пула.

[!INCLUDE [SQL DB service tiers table for elastic pools](../../includes/sql-database-service-tiers-table-elastic-pools.md)]

Каждая база данных в пуле также соответствует характеристикам отдельной базы данных для этого пула. Например, для пулов уровня "Базовый" установлено предельное количество сеансов (4800–28 800 на пул), но для отдельных баз данных в этом пуле установлено ограничение в 300 сеансов на базу данных.

## <a name="scaling-up-or-scaling-down-an-elastic-pool"></a>Увеличение или уменьшение масштаба пула эластичных баз данных

Изначально выбрав уровень служб и уровень производительности, вы сможете динамически увеличивать или уменьшать масштаб пула эластичных баз данных в процессе фактической работы. 

* Изменение минимального или максимального числа eDTU для базы данных обычно завершается за 5 минут или быстрее.
* Время изменения размера пула (eDTU) зависит от общего размера всех баз данных в пуле. Изменение занимает порядка 90 минут или меньше на каждые 100 ГБ. Например, если общее пространство, используемое всеми базами данных в пуле, равно 200 ГБ, то ожидаемая задержка при изменении числа eDTU для пула составит до 3 часов.

Подробные инструкции см. в разделе [Создание эластичного пула и управление им на портале Azure](sql-database-elastic-pool-manage-portal.md), [Создание эластичного пула и управление им с помощью PowerShell](scripts/sql-database-monitor-and-scale-pool-powershell.md), [Мониторинг пула эластичных баз данных и управление им с помощью Transact-SQL](sql-database-elastic-pool-manage-tsql.md) или [Создание и администрирование эластичного пула с помощью C](sql-database-elastic-pool-manage-csharp.md).

## <a name="creating-or-upgrading-to-4tb"></a>Создание базы данных, которой предоставляется 4 ТБ, или обновление до нее

В следующих разделах рассматриваются особенности реализации возможности использовать хранилище объемом в 4 ТБ.

### <a name="creating-in-the-azure-portal"></a>Создание на портале Azure

При создании базы данных уровня производительности P11 или P15 уже выбран параметр хранилища по умолчанию, предоставляющий 1 ТБ. Для баз данных, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища до 4 ТБ. Во всех других регионах ползунок хранилища нельзя передвинуть. При выборе хранилища объемом в 4 ТБ цена не меняется.

### <a name="creating-using-powershell-or-transact-sql"></a>Создание с помощью PowerShell или Transact-SQL

При создании базы данных уровня производительности P11 или P15 можно задать значение maxsize, равное "1 TB" (по умолчанию) или "4 TB". Значения "1024 GB" и "4096 GB" также являются допустимыми. Если для параметра maxsize задано значение 4 ТБ, то команда create для создания подготовленной базы данных в неподдерживаемом регион завершится ошибкой.

### <a name="upgrading-to-4tb"></a>Обновление до базы данных, которой предоставляется 4 ТБ 

Для существующих баз данных уровня производительности P11 или P15, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища (maxsize) до 4 ТБ. Это можно сделать на портале Azure, в PowerShell или с помощью Transact-SQL. В следующем примере показано, как изменить значение maxsize с помощью команды ALTER DATABASE.

 ```sql
ALTER DATABASE <myDatabaseName> 
   MODIFY (MAXSIZE = 4096 GB);
```

Обновление существующей базы данных P11 или P15 может выполнить только учетная запись субъекта уровня сервера или участники роли базы данных dbmanager. При выполнении в поддерживаемом регионе конфигурация будет обновлена немедленно. Это можно проверить, выполнив команду [SELECT DATABASEPROPERTYEX](https://msdn.microsoft.com/library/ms186823.aspx) или просмотрев размер базы данных на портале Azure. Во время обновления база данных остается подключенной к сети. Тем не менее вы не сможете использовать все 4 ТБ хранилища, пока файлы базы данных не будут обновлены до нового максимального размера (maxsize). Требуемая продолжительность зависит от размера обновляемой базы данных.  

### <a name="error-messages"></a>Сообщения об ошибках
При создании или обновлении базы данных P11 либо P15 в неподдерживаемом регионе операция создания или обновления завершится со следующим сообщением об ошибке: **P11 and P15 database with up to 4TB of storage are available in US East 2, West US, South East Asia, West Europe, Canada East, Canada Central, Japan East, and Australia East** (Базы данных P11 и P15 с объемом хранилища до 4 ТБ доступны в регионах "Восточная часть США 2", "Западная часть США", "Юго-Восточная Азия", "Западная Европа", "Восточная Канада", "Центральная Канада", "Восточная Япония" и "Восточная Австралия").

## <a name="current-limitations-of-p11-and-p15-databases-with-4-tb-maxsize"></a>Текущие ограничения баз данных P11 и P15 с максимальным размером 4 ТБ

- При создании или обновлении базы данных P11 или P15 можно выбрать только одно из двух значений максимального размера хранилища (maxsize) — 1 ТБ или 4 ТБ. Промежуточные размеры сейчас не поддерживаются
- Если выбрано значение 4 ТБ, его нельзя изменить на 1 ТБ, даже если для хранения фактически используется меньше 1 ТБ. Таким образом, уровень производительности базы данных P11 (4 ТБ) или P15 (4 ТБ) нельзя понизить до P11 (1 ТБ), P15 (1 ТБ) или ниже (например, P1–P6), пока мы не предоставим дополнительные варианты хранилища для остальных уровней производительности. Это ограничение также применяется в сценариях восстановления и копирования, включая восстановление до точки во времени, геовосстановление, долгосрочное хранение резервных копий и копирование базы данных. После настройки базы данных со значением параметра maxsize 4 ТБ все операции восстановления этой базы данных должны выполняться на уровне P11 или P15 (4 ТБ).
- Для сценариев активной георепликации:
   - Настройка отношения георепликации. Если используется база данных-источник P11 или P15, уровень баз данных-получателей также должен быть P11 или P15. Базы данных более низкого уровня производительности отклоняются, так как они не поддерживают максимальный размер хранилища 4 ТБ.
   - Обновление базы данных-источника в отношениях георепликации. При изменении максимального размера на 4 ТБ в базе данных-источнике такие же изменения произойдут в базе данных-получателе. Чтобы изменения в базе данных-источнике вступили в силу, оба обновления должны быть успешными. При этом применяются ограничения по регионам для максимального размера 4 ТБ (см. выше). Если база-данных-получатель находится в регионе, не поддерживающем максимальный размер 4 TB, база данных-источник не будет обновлена.
- Использование службы импорта и экспорта для загрузки баз данных P11 (4 ТБ) и P15 (4 ТБ) не поддерживается. Для [импорта](sql-database-import.md) и [экспорта](sql-database-export.md) данных используйте файл SqlPackage.exe.

## <a name="next-steps"></a>Дальнейшие действия

* Ознакомьтесь с подробными сведениями о [пулах эластичных БД](sql-database-elastic-pool.md) и [целесообразности их использования](sql-database-elastic-pool.md).
* Узнайте, как [отслеживать пулы эластичных баз данных, управлять ими и изменять их размеры](sql-database-elastic-pool-manage-portal.md), а также как [отслеживать производительность отдельных баз данных](sql-database-single-database-monitor.md).
* Теперь, когда вы узнали об уровнях базы данных SQL, попробуйте [создать свою первую базу данных SQL](sql-database-get-started-portal.md) с помощью [бесплатной учетной записи](https://azure.microsoft.com/pricing/free-trial/).
* При миграции используйте [калькулятор DTU](http://dtucalculator.azurewebsites.net/), чтобы рассчитать приблизительное число необходимых единиц DTU. 


