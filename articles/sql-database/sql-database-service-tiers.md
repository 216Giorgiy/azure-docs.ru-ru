---
title: "Уровни служб и уровни производительности базы данных SQL | Документация Майкрософт"
description: "Сравнение уровней служб базы данных SQL и уровней производительности для отдельных баз данных, а также сведения об эластичных пулах SQL"
keywords: "параметры базы данных, производительность базы данных"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: f5c5c596-cd1e-451f-92a7-b70d4916e974
ms.service: sql-database
ms.custom: DBs & servers
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 06/30/2017
ms.author: carlrab
ms.translationtype: HT
ms.sourcegitcommit: 760543dc3880cb0dbe14070055b528b94cffd36b
ms.openlocfilehash: b25ff5331f119efd44c61808f7d1d5decb226bd6
ms.contentlocale: ru-ru
ms.lasthandoff: 08/10/2017

---
# <a name="what-performance-options-are-available-for-an-azure-sql-database"></a>Доступные параметры производительности базы данных SQL Azure

[База данных SQL Azure](sql-database-technical-overview.md) предлагает четыре уровня служб как для отдельных, так и для [объединенных в пулы](sql-database-elastic-pool.md) баз данных. Эти следующие уровни: **Базовый**, **Стандартный**, **Премиум** и **Премиум RS**. Каждый уровень службы характеризуется несколькими уровнями производительности (измеряется в [единицах DTU](sql-database-what-is-a-dtu.md)). Также доступны параметры хранения для обработки разных рабочих нагрузок и объемов данных. Чем выше уровень производительности, тем больше он предоставляет ресурсов вычислений и хранения для повышения пропускной способности и увеличения емкости. Вы можете динамически изменять уровни служб, уровни производительности и хранилище без простоев в работе. 
- В соответствии с соглашением об уровне обслуживания все уровни службы — **Базовый**, **Стандартный** и **Премиум** — включают такие преимущества, как бесперебойная работа в течение 99,99 % времени, гибкость в обеспечении непрерывности бизнес-процессов, функции безопасности и почасовая тарификация. 
- Уровень **Премиум RS** обеспечивает те же уровни производительности, что и уровень "Премиум", но с некоторыми ограничениями в рамках соглашения об уровне обслуживания. Он выполняется с меньшим числом избыточных копий, чем базы данных на других уровнях служб. Таким образом в случае сбоя службы может потребоваться восстановить базу данных из резервной копии с задержкой до 5 минут.

> [!IMPORTANT]
> Базе данных SQL Azure выделяется гарантированный набор ресурсов. Кроме того, на ожидаемые показатели ее производительности не влияет работа других баз данных в среде Azure. 

## <a name="choosing-a-service-tier"></a>Выбор уровня службы
В следующей таблице приведены примеры уровней службы, которые лучше всего подходят для рабочих нагрузок различных приложений.

| Уровень служб | Целевые рабочие нагрузки |
| :--- | --- |
| **базовая;** | Лучше всего подходит для небольшой базы данных, для которой в определенный момент времени обычно выполняется одна активная операция. В качестве примера можно привести базы данных, используемые для разработки или тестирования, или небольшие редко используемые приложения. |
| **Стандартный** |Оптимальный вариант для облачных приложений с низкими или средними требованиями к производительности операций ввода-вывода, поддерживающий несколько параллельных запросов. В качестве примера можно привести рабочую группу или веб-приложения. |
| **Премиальный** | Разработан для большого объема транзакций с высокими требованиями к производительности операций ввода-вывода. Поддерживается параллельная работа множества пользователей. В качестве примера можно привести базы данных для поддержки критически важных приложений. |
| **Premium RS** | Предназначен для рабочих нагрузок, интенсивно использующих ввод-вывод, но не требующих гарантий максимальной доступности. К примерам относятся тестовые высокопроизводительные рабочие нагрузки или рабочие нагрузки анализа, для которых база данных не является системой учета. |
|||

Вы можете создавать отдельные базы данных с выделенными ресурсами на уровне служб и выбранным [уровнем производительности](sql-database-service-tiers.md#single-database-service-tiers-and-performance-levels) или базы данных в [эластичном пуле SQL](sql-database-service-tiers.md#elastic-pool-service-tiers-and-performance-in-edtus). В эластичном пуле SQL ресурсы вычислений и хранения совместно используются несколькими базами данных в пределах одного логического сервера. 

Ресурсы, доступные для отдельных баз данных, выражаются в единицах транзакций базы данных (DTU), а ресурсы для эластичных пулов SQL — в единицах транзакций эластичной базы данных (eDTU). См. дополнительные сведения о [единицах DTU и eDTU](sql-database-what-is-a-dtu.md).

Чтобы выбрать уровень службы, сначала определите минимальный набор необходимых функций базы данных:

| **Возможности уровня служб** | **базовая;** | **Стандартный** | **Премиальный** | **Premium RS**|
| :-- | --: | --: | --: | --: |
| Максимальный размер отдельной базы данных | 2 ГБ | 250 ГБ | 4 TБ*  | 500 ГБ  |
| Максимальный размер эластичного пула | 156 ГБ | 2,9 ТБ | 4 TБ* | 750 ГБ |
| Максимальный размер базы данных в эластичном пуле | 2 ГБ | 250 ГБ | 500 ГБ | 500 ГБ |
| Максимальное количество баз данных на пул | 500  | 500 | 100 | 100 |
| Максимальное количество DTU отдельной базы данных | 5 | 100 | 4000 | 1000 |
| Максимальное количество DTU для одной базы данных в эластичном пуле | 5 | 3000 | 4000 | 1000 |
| Срок хранения резервной копии | 7 дней | 35 дней | 35 дней | 35 дней |
||||||

> [!IMPORTANT]
> Хранилище объемом до 4 ТБ сейчас предоставляется в следующих регионах: восточная часть США 2, западная часть США, Виргиния (для обслуживания государственных организаций США), Западная Европа, Центральная Германия, Юго-Восточная Азия, восточная Япония, восточная Австралия, Центральная Канада и Восточная Канада. См. [текущие ограничения в 4 ТБ](sql-database-service-tiers.md#current-limitations-of-p11-and-p15-databases-with-4-tb-maxsize).
>

Выбрав нужный уровень службы, переходите к определению уровня производительности (в единицах DTU) и объема хранилища базы данных. 

- В качестве отправной точки можно использовать значения производительности S2 и S3 уровня **Стандартный**. 
- Для баз данных с высокими требованиями к ресурсам ЦП или числу операций ввода-вывода рекомендуется начинать с уровней производительности **Премиум**. 
- На уровне **Премиум** предоставляется больше ресурсов ЦП и как минимум в 10 раз больше операций ввода-вывода по сравнению с самыми высокими показателями производительности на уровне **Стандартный**.
- Уровень **Премиум RS** обеспечивает производительность уровня **Премиум** при более низких затратах, но с некоторыми ограничениями в рамках соглашения об уровне обслуживания.

> [!IMPORTANT]
> См. дополнительные сведения об объединении баз данных в [эластичные пулы SQL](sql-database-elastic-pool.md) для совместного использования вычислительных ресурсов и ресурсов хранения. Оставшаяся часть этой статьи посвящена уровням служб и уровням производительности для отдельных баз данных.
>

## <a name="single-database-service-tiers-and-performance-levels"></a>Уровни служб для отдельной базы данных и уровни производительности
Для отдельных баз данных доступно несколько уровней производительности и объемов хранилищ в пределах каждого уровня служб. 

[!INCLUDE [SQL DB service tiers table](../../includes/sql-database-service-tiers-table.md)]

## <a name="scaling-up-or-scaling-down-a-single-database"></a>Увеличение или уменьшение масштаба отдельной базы данных

Изначально выбрав уровень служб и уровень производительности, вы сможете динамически увеличивать или уменьшать масштаб отдельной базы данных в процессе фактической работы.  

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-dynamically-scale-up-or-scale-down/player]
>

При изменении уровня службы или уровня производительности базы данных создается реплика исходной базы данных с новым уровнем производительности, после чего устанавливаются подключения к реплике. Во время этого процесса данные не теряются, но в течение короткого периода, когда производится переподключение к реплике, соединения с базой данных становятся неактивны, поэтому некоторые текущие транзакции могут откатиться. Интервал времени для переключения не фиксирован, но в 99 % случаев он находится в пределах 4 секунд до показателя в 30 секунд. Если в момент разрыва подключений выполняется большое число транзакций, период переключения может быть продолжительнее.  

Длительность всего процесса вертикального масштабирования зависит от размера и уровня службы базы данных до и после изменения. Например, если база данных размером 250 ГБ переводится с уровня службы "Стандартный", на этот уровень или в его пределах, процесс должен завершиться в течение 6 часов. Если уровень производительности базы данных того же размера меняется в пределах уровня службы "Премиум", процесс должен завершиться в течение 3 часов.

> [!TIP]
> Чтобы проверить состояние текущей операции масштабирования базы данных SQL, используйте следующий запрос: ```select * from sys.dm_operation_status```.
>

* При переходе к более высокому уровню службы или производительности максимальный размер базы данных не увеличивается, если явно не указать для него большее значение.
* При понижении уровня базы данных ее размер не должен превышать максимальный допустимый размер целевого уровня служб. 
* Если вы обновляете базу данных с включенной [георепликацией](sql-database-geo-replication-portal.md), перед обновлением базы данных-источника обновите базы данных-получатели до требуемого уровня производительности (общая рекомендация). Чтобы выполнить обновление до другого выпуска, сначала необходимо обновить базу данных-получатель. 
* Если вы понижаете уровень базы данных с включенной [георепликацией](sql-database-geo-replication-portal.md), перед понижением уровня базы данных-получателя сначала понизьте уровень ее базы данных-источника до требуемого уровня производительности (общая рекомендация). Чтобы снизить уровень до другого выпуска, сначала необходимо снизить уровень базы данных-получателя. 

* Предложения службы восстановления отличаются для разных уровней служб. При понижении до уровня **Базовый** уменьшится период удержания резервной копии. См. раздел [Подробнее о резервном копировании базы данных SQL](sql-database-automated-backups.md).
* Новые свойства базы данных не применяются до тех пор, пока изменение не завершится.


## <a name="current-limitations-of-p11-and-p15-databases-with-4-tb-maxsize"></a>Текущие ограничения баз данных P11 и P15 с максимальным размером 4 ТБ

Максимальный размер баз данных P11 и P15 (4 ТБ) поддерживается только в некоторых регионах (как указано выше). Рекомендации и ограничения для баз данных P11 и P15 с максимальным размером 4 ТБ

- Если для параметра maxsize задано значение 4 ТБ, выполнение команды create для создания подготовленной базы данных (с использованием значения 4 ТБ или 4096 ГБ) в неподдерживаемом регионе завершится ошибкой.
- Для существующих баз данных уровня производительности P11 или P15, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища (maxsize) до 4 ТБ. Это можно проверить, выполнив команду [SELECT DATABASEPROPERTYEX](https://msdn.microsoft.com/library/ms186823.aspx) или просмотрев размер базы данных на портале Azure. Обновление существующей базы данных P11 или P15 может выполнить только учетная запись субъекта уровня сервера или участники роли базы данных dbmanager. 
- При выполнении операции в поддерживаемом регионе конфигурация будет обновлена немедленно. Во время обновления база данных остается подключенной к сети. Тем не менее вы не сможете использовать все 4 ТБ хранилища, пока файлы базы данных не будут обновлены до нового максимального размера (maxsize). Требуемая продолжительность зависит от размера обновляемой базы данных.  
- При создании или обновлении базы данных P11 или P15 можно выбрать только одно из двух значений максимального размера хранилища (maxsize) — 1 ТБ или 4 ТБ. Промежуточные размеры сейчас не поддерживаются При создании базы данных уровня производительности P11 или P15 уже выбран размер хранилища по умолчанию — 1 ТБ. Для баз данных, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища — до 4 ТБ для отдельной новой или существующей базы данных. Для всех других регионов максимальный размер не может превышать 1 ТБ. При выборе хранилища объемом в 4 ТБ цена не меняется.
- Если выбрано значение 4 ТБ, его нельзя изменить на 1 ТБ, даже если для хранения фактически используется меньше 1 ТБ. Таким образом, уровень производительности базы данных P11 (4 ТБ) или P15 (4 ТБ) нельзя понизить до P11 (1 ТБ), P15 (1 ТБ) или ниже (например, P1–P6), пока мы не предоставим дополнительные варианты хранилища для остальных уровней производительности. Это ограничение также применяется в сценариях восстановления и копирования, включая восстановление до точки во времени, геовосстановление, долгосрочное хранение резервных копий и копирование базы данных. После настройки базы данных со значением параметра maxsize 4 ТБ все операции восстановления этой базы данных должны выполняться на уровне P11 или P15 (4 ТБ).
- При создании или обновлении базы данных P11 либо P15 в неподдерживаемом регионе операция создания или обновления завершится со следующим сообщением об ошибке: **P11 and P15 database with up to 4TB of storage are available in US East2, West US, US Gov Virginia, West Europe, Germany Central, South East Asia, Japan East, Australia East, Canada Central, and Canada East** (Базы данных P11 и P15 с объемом хранилища до 4 ТБ доступны в регионах "Восточная часть США 2", "Западная часть США", "Виргиния (для обслуживания государственных организаций США)", "Западная Европа", "Центральная Германия", "Юго-Восточная Азия", "восточная Япония", "восточная Австралия", "Центральная Канада" и "Восточная Канада").
- Для сценариев активной георепликации:
   - Настройка отношения георепликации. Если используется база данных-источник P11 или P15, уровень баз данных-получателей также должен быть P11 или P15. Базы данных более низкого уровня производительности отклоняются, так как они не поддерживают максимальный размер хранилища 4 ТБ.
   - Обновление базы данных-источника в отношениях георепликации. При изменении максимального размера на 4 ТБ в базе данных-источнике такие же изменения произойдут в базе данных-получателе. Чтобы изменения в базе данных-источнике вступили в силу, оба обновления должны быть успешными. При этом применяются ограничения по регионам для максимального размера 4 ТБ (см. выше). Если база-данных-получатель находится в регионе, не поддерживающем максимальный размер 4 TB, база данных-источник не обновляется.
- Использование службы импорта и экспорта для загрузки баз данных P11 (4 ТБ) и P15 (4 ТБ) не поддерживается. Для [импорта](sql-database-import.md) и [экспорта](sql-database-export.md) данных используйте файл SqlPackage.exe.

## <a name="manage-single-database-service-tiers-and-performance-levels-using-the-azure-portal"></a>Управление уровнями служб и производительности для отдельной базы данных с помощью портала Azure

Чтобы определить или изменить уровень служб, уровень производительности или объем хранилища для новой или существующей базы данных SQL Azure с помощью портала Azure, откройте окно **Настройка производительности** для этой базы данных, щелкнув **Ценовая категория (единицы масштабирования DTU)**, как показано на снимке экрана ниже. 

- Определите или измените уровень служб, выбрав его в соответствии со своей рабочей нагрузкой. 
- Определите или измените уровень производительности (**единицы DTU**) в пределах уровня служб с помощью ползунка **DTU**.
- Определите или измените объем хранилища для уровня производительности с помощью ползунка **Хранилище**. 

  ![Настройка уровня служб и производительности](./media/sql-database-service-tiers/service-tier-performance-level.png)

> [!IMPORTANT]
> Выбирая уровень служб P11 или P15, см. раздел [Текущие ограничения баз данных P11 и P15 с максимальным размером 4 ТБ](sql-database-service-tiers.md#current-limitations-of-p11-and-p15-databases-with-4-tb-maxsize).
>

## <a name="manage-single-database-service-tiers-and-performance-levels-using-powershell"></a>Управление уровнями служб и производительности для отдельной базы данных с помощью PowerShell

Чтобы определить или изменить уровни служб, уровни производительности и объем хранилища баз данных SQL Azure с помощью PowerShell, используйте следующие командлеты PowerShell. Если вам нужно выполнить установку или обновление PowerShell, см. статью [об установке модуля Azure PowerShell](/powershell/azure/install-azurerm-ps). 

| Командлет | Описание |
| --- | --- |
|[New-AzureRmSqlDatabase](/powershell/module/azurerm.sql/new-azurermsqldatabase)|Создает базу данных. |
|[Get-AzureRmSqlDatabase](/powershell/module/azurerm.sql/get-azurermsqldatabase)|Получает одну или несколько баз данных.|
|[Set-AzureRmSqlDatabase](/powershell/module/azurerm.sql/set-azurermsqldatabase)|Определяет свойства базы данных или перемещает ее в эластичный пул.|


> [!TIP]
> В этом примере скрипт PowerShell отслеживает метрики производительности базы данных, масштабирует ее до более высокого уровня производительности и создает правило генерации оповещений для одной из метрик производительности. См. дополнительные сведения о [мониторинге и масштабировании отдельной базы данных SQL с помощью PowerShell](scripts/sql-database-monitor-and-scale-database-powershell.md).

## <a name="manage-single-database-service-tiers-and-performance-levels-using-the-azure-cli"></a>Управление уровнями служб и производительности для отдельной базы данных с помощью Azure CLI

Чтобы определить или изменить уровни служб, уровни производительности и объем хранилища баз данных SQL Azure с помощью Azure CLI, используйте следующие команды [базы данных SQL в Azure CLI](/cli/azure/sql/db). Запускайте интерфейс командной строки в браузере с помощью [Cloud Shell](/azure/cloud-shell/overview) либо [установите](/cli/azure/install-azure-cli) его на платформе macOS, Linux или Windows. Изучите дополнительные сведения о создании [эластичных пулов SQL](sql-database-elastic-pool.md) и управлении ими.

| Командлет | Описание |
| --- | --- |
|[az sql db create](/cli/azure/sql/db#create) |Создает базу данных.|
|[az sql db list](/cli/azure/sql/db#list)|Выводит список всех баз данных и хранилищ данных на сервере или всех баз данных в эластичном пуле.|
|[az sql db list-editions](/cli/azure/sql/db#list-editions)|Выводит список доступных целевых служб и ограничений хранилища.|
|[az sql db list-usages](/cli/azure/sql/db#list-usages)|Возвращает данные об использовании баз данных.|
|[az sql db show](/cli/azure/sql/db#show)|Возвращает сведения о базе данных или хранилище данных.|
|[az sql db update](/cli/azure/sql/db#update)|Обновляет базу данных.|

> [!TIP]
> В этом примере скрипт Azure CLI масштабирует отдельную базу данных SQL Azure до другого уровня производительности после запроса на получение сведений о размере базы данных. См. дополнительные сведения об [использовании CLI для мониторинга и масштабирования отдельной базы данных SQL](scripts/sql-database-monitor-and-scale-database-cli.md).
>

## <a name="manage-single-database-service-tiers-and-performance-levels-using-transact-sql"></a>Управление уровнями служб и производительности для отдельной базы данных с помощью Transact-SQL

Чтобы определить или изменить уровни служб, уровни производительности и объем хранилища баз данных SQL Azure с помощью Transact-SQL, используйте следующие команды Transact-SQL. Можно выполнить эти команды на портале Azure, в [SQL Server Management Studio](/sql/ssms/use-sql-server-management-studio), [Visual Studio Code](https://code.visualstudio.com/docs) или любой другой программе, которая может подключаться к серверу базы данных SQL Azure и передавать команды Transact-SQL. 

| Команда | Описание |
| --- | --- |
|[CREATE DATABASE (база данных SQL Azure)](/sql/t-sql/statements/create-database-azure-sql-database)|Создает базу данных. Для создания базы данных требуется подключение к базе данных master.|
| [ALTER DATABASE (база данных SQL Azure)](/sql/t-sql/statements/alter-database-azure-sql-database) |Изменяет базу данных SQL Azure. |
|[sys.database_service_objectives (база данных SQL Azure)](/sql/relational-databases/system-catalog-views/sys-database-service-objectives-azure-sql-database)|Возвращает сведения о выпуске (уровень служб), целевой службе (ценовую категорию), а также имя эластичного пула (при наличии) для базы данных SQL Azure или хранилища данных SQL Azure. В системе базы данных master на сервере базы данных SQL Azure возвращает сведения обо всех базах данных. Для использования хранилища данных SQL Azure необходимо подключиться к базе данных master.|
|[sys.database_usage (база данных SQL Azure)](/sql/relational-databases/system-catalog-views/sys-database-usage-azure-sql-database)|Выводит список сведений о числе, типе и длительности существования баз данных на сервере базы данных SQL Azure.|

В следующем примере показано, как изменить значение maxsize с помощью команды ALTER DATABASE.

 ```sql
ALTER DATABASE <myDatabaseName> 
   MODIFY (MAXSIZE = 4096 GB);
```

## <a name="manage-single-databases-using-the-rest-api"></a>Управление отдельными базами данных с помощью API REST

Чтобы определить или изменить уровни служб, уровни производительности и объем хранилища баз данных SQL Azure с помощью API REST, см. сведения о [REST API базы данных SQL Azure](/rest/api/sql/).

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о единицах [DTU](sql-database-what-is-a-dtu.md).
* См. дополнительные сведения о [мониторинге использования и настройке производительности (DTU)](sql-database-troubleshoot-performance.md).


