<properties
   pageTitle="Непрерывность облачных бизнес-процессов за счет восстановления до точки во времени | Microsoft Azure"
   description="В этой статье описывается функция восстановления до точки во времени, позволяющая откатить Базу данных Azure SQL до состояния на момент времени в прошлом (до 35 дней)."
   services="sql-database"
   documentationCenter=""
   authors="stevestein"
   manager="jhubbard"
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-management"
   ms.date="05/10/2016"
   ms.author="sstein"/>

# Обзор. Функция восстановления до точки во времени в Базе данных SQL

Функция восстановления до точки во времени позволяет восстановить состояние базы данных до более ранней точки во времени.

Служба Базы данных SQL Azure обеспечивает защиту всех баз данных. Для этого она автоматически создает их резервную копию, которая хранится в течение 7 дней для уровня "Базовый", 14 дней для уровня "Стандартный" и 35 дней для уровня "Премиум". Восстановления до точки во времени предназначено для восстановления базы данных из этих резервных копий в случае непреднамеренного повреждения или удаления данных.

Резервные копии баз данных создаются автоматически без дополнительной платы. При этом участие пользователя не требуется. Автоматические резервные копии и восстановление до точки во времени — бесплатный способ защитить базы данных от случайного повреждения или удаления по какой-либо причине без участия администратора.


|Задача (портал) | PowerShell | REST |
|:--|:--|:--|
| [Восстановление состояния базы данных SQL на момент времени в прошлом](sql-database-point-in-time-restore-portal.md) | [PowerShell](sql-database-point-in-time-restore-powershell.md) | [REST (createMode=PointInTimeRestore)](https://msdn.microsoft.com/library/azure/mt163685.aspx) |
| [Восстановление удаленной базы данных SQL](sql-database-restore-deleted-database-portal.md) | [PowerShell](sql-database-restore-deleted-database-powershell.md) | [REST (createMode=Restore)](https://msdn.microsoft.com/library/azure/mt163685.aspx)|



## Общие сведения об автоматических резервных копиях

Все базы данных уровня "Базовый", "Стандартный" и "Премиум" защищаются за счет создания автоматических резервных копий. Полные резервные копии создаются каждую неделю, разностные резервные копии — каждый день, а резервные копии журналов — каждые 5 минут. Первое полное резервное копирование планируется сразу после создания базы данных. Обычно этот процесс завершается в течение 30 минут. Но он может занять больше времени. Если база данных большая, например, если она создана в результате копирования другой базы данных или восстановления из большей базы данных, тогда для завершения первого полного резервного копирования может понадобиться больше времени. После выполнения первой такой операции все последующие операции резервного копирования планируются автоматически и управляются без участия пользователя в фоновом режиме. Система сама определяет точное время полного и разностного резервного копирования, чтобы сбалансировать общую нагрузку. Файлы резервных копий хранятся в учетной записи геоизбыточного хранилища, для которой установлен доступ только для чтения (RA-GRS), чтобы обеспечить их доступность для аварийного восстановления.


## Время восстановления для восстановления до точки во времени

Время, необходимое для восстановления базы данных, зависит от многих факторов, включая размер базы данных, выбранную точку во времени и объем действий, которые нужно повторить, чтобы восстановить состояние до выбранной точки. Восстановление очень большой и/или активной базы данных может занять несколько часов. При каждом восстановлении базы данных создается новая база данных на том же сервере, что и исходная. Поэтому для восстановленной базы данных нужно указать новое имя.


Базу данных можно восстановить до любого уровня производительности и в любом пуле эластичных БД. Учитывая, что при восстановлении создается новая база данных, а уровень служб и производительности восстановленной базы данных может отличаться от текущего состояния динамической базы данных, необходимо убедиться, что у вас достаточно DTU на сервере или в пуле. Восстановленная база данных — это обычная полностью доступная оперативная база данных, пользование которой оплачивается по обычной тарификации на основе уровня служб и производительности. Восстановленную базу данных можно рассматривать как замену исходной базы данных или же использовать для получения данных, чтобы затем обновить исходную базу данных. Если восстановленная база данных предназначена для замены исходной базы данных, следует проверить, настроен ли для нее соответствующий уровень производительности и служб, и при необходимости масштабировать эту базу данных. Можно переименовать исходную базу данных, а затем присвоить восстановленной базе данных исходное имя с помощью команды ALTER DATABASE в T-SQL. Если планируется получать данные из восстановленной базы данных, необходимо будет отдельно написать и выполнить требуемые сценарии восстановления данных. Несмотря на то, что операция восстановления может занять много времени, база данных будет отображаться в списке баз данных на протяжении всего процесса. Если удалить базу данных во время восстановления, операция будет отменена и счет на оплату не будет выставлен.



## Восстановление недавно удаленной базы данных

Если удалить базу данных уровня "Базовый", "Стандартный" и "Премиум", то последняя резервная копия будет храниться в течение обычного периода хранения, чтобы позволить вам восстановить базу данных до состояния на момент ее удаления.

Точка восстановления удаленных баз данных определяется временем их удаления. Как и ранее, удаленную базу данных можно восстановить только на сервер, на котором находилась исходная база данных. Это следует учитывать при удалении сервера, так как после этого вы не сможете восстановить базы данных, которые на нем размещались ранее.

## Резервное копирование и восстановление по сравнению с копированием, экспортом и импортом

Восстановление до точки во времени — рекомендуемый подход для восстановления баз данных уровня "Базовый", "Стандартный" и "Премиум" от случайной потери или повреждения данных. Резервное копирование и восстановление дешевле, так как оплата начисляется только за избыточные резервные копии, а копирование баз данных всегда оплачивается, чтобы гарантировать транзакционно согласованный экспорт, как и хранение BACPAC-файла. Резервное копирование выполняется автоматически, а значит не требует вмешательства администратора, тогда как экспорт нужно планировать и управлять им самостоятельно. Восстановление можно выполнить до определенной точки во времени с большей степенью детализации (одна минута), чем это возможно при копировании, экспорте или импорте. Кроме того, восстановление из резервных копий обычно выполняется быстрее, чем импорт, который включает в себя такие действия, как создание схемы, отключение индексов, загрузка данных и включение индексов для каждой таблицы отдельно. Тем не менее копирование и экспорт — рекомендуемое решение для долгосрочной архивации, срок которой превышает срок хранения.


## Сводка

Автоматическое резервное копирование и восстановление до точки во времени позволяют защитить базы данных от случайного повреждения или удаления данных. Это бесплатное решение, которое не требует участия администратора и доступно для всех баз данных SQL. Решение резервного копирования и восстановления обеспечивает ряд преимуществ для краткосрочных нужд по восстановлению по сравнению с копированием, экспортом и импортом. Мы рекомендуем использовать восстановление до точки во времени как часть стратегии по обеспечению непрерывности бизнес-процессов. Экспорт следует проводить только для долгосрочной архивации или переноса данных.



## Дополнительные ресурсы

- [Общие сведения о непрерывности бизнес-процессов](sql-database-business-continuity.md)
- [Геовосстановление](sql-database-geo-restore.md)
- [Активная георепликация](sql-database-geo-replication-overview.md)
- [Проектирование приложений для аварийного восстановления в облаке](sql-database-designing-cloud-solutions-for-disaster-recovery.md)
- [Финализация восстановленной Базы данных SQL Azure](sql-database-recovered-finalize.md)

<!---HONumber=AcomDC_0511_2016-->