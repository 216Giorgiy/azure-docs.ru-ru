<properties
   pageTitle="Начало работы с динамическим маскированием данных в базе данных SQL (классический портал Azure)"
   description="Начало работы с динамическим маскированием данных в базе данных SQL (на классическом портале Azure)"
   services="sql-database"
   documentationCenter=""
   authors="ronitr"
   manager="jeffreyg"
   editor="v-romcal"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="10/20/2015"
   ms.author="ronitr; ronmat; v-romcal; sstein"/>

# Начало работы с динамическим маскированием данных в базе данных SQL (классический портал Azure)

> [AZURE.SELECTOR]
- [Dynamic Data Masking - Azure Portal](sql-database-dynamic-data-masking-get-started.md)

## Обзор

Динамическая маскировка данных в базе данных SQL ограничивает возможность раскрытия конфиденциальных данных, маскируя их для обычных пользователей. Динамическое маскирование данных поддерживается в версии 12 Базы данных SQL Azure.

Динамическая маскировка данных помогает предотвратить несанкционированный доступ к конфиденциальным данным, позволяя заказчикам самим определять, сколько конфиденциальных данных следует отображать, при минимальном влиянии на уровень приложения. Эта функция работает на основе политики безопасности, скрывая конфиденциальные данные в результирующем наборе запроса по заданным полям базы данных, не меняя сами данные в базе данных.

Например, представитель отдела обслуживания клиентов в центре обработки вызовов может идентифицировать абонентов по нескольким цифрам номера социального страхования или номера кредитной карты, но эти элементы данных не должны предоставляться ему полностью. Правило маскирования может быть задано таким образом, чтобы в результатах выполнения запросов маскировалось все, кроме последних четырех цифр номера социального страхования или кредитной карты. Еще один пример — защита персональных данных с помощью соответствующей маски. Разработчик может отправлять запросы в рабочие среды для устранения неполадок, не нарушая при этом нормативные правила.

## Основы динамической маскировки данных в базе данных SQL

Настройка политики динамического маскирования данных для вашей базы данных осуществляется на вкладке «Аудит и безопасность» классического портала Azure.


> [AZURE.NOTE]Сведения о настройке динамической маскировки данных на портале Azure см. в статье [Начало работы с динамической маскировкой данных в базе данных SQL (портал Azure)](sql-database-dynamic-data-masking-get-started.md).


### Разрешения для динамической маскировки данных

Динамическую маскировку данных может настраивать администратор базы данных Azure, администратор сервера или сотрудник службы безопасности.

### Политика динамической маскировки данных

* **Пользователи SQL, исключенные из маскирования** — ряд пользователей SQL или удостоверений AAD, при использовании которых с данных, полученных в результатах SQL-запросов, снимается маска. Обратите внимание на то, что пользователи с правами администратора исключаются из правил маскирования всегда и видят исходные данные без всякой маски.

* **Правила маскирования** — набор правил, определяющих поля, подлежащие маскированию, и используемую функцию маскирования. Задать такие поля можно с помощью имени схемы базы данных, имени таблицы и имени столбца.

* **Функции маскирования** — набор методов, управляющих доступностью данных для различных сценариев.

| Функция маскирования | Логика маскирования |
|----------|---------------|
| **По умолчанию** |**Полное маскирование в соответствии с типами данных в указанных полях**<br/><br/>• Используйте XXXX или меньше символов X, если размер поля меньше 4 символов для строковых типов данных (nchar, ntext, nvarchar).<br/>• Используйте нулевое значение для числовых типов данных (bigint, bit, decimal, int, money, numeric, smallint, smallmoney, tinyint, float, real).<br/>• Используйте 01-01-1900 для типов данных даты и времени (date, datetime2, datetime, datetimeoffset, smalldatetime, time).<br/>• Для варианта SQL используется значение по умолчанию текущего типа.<br/>• Для XML используется документ <masked/>.<br/>• Используйте пустое значение для специальных типов данных (таблица меток времени, hierarchyid, GUID, binary, image, пространственные типы varbinary).
| **Кредитная карта** |**Метод маскирования, который предоставляет последние четыре цифры предопределенных полей** и добавляет строковую константу в качестве префикса в формате номера кредитной карты.<br/><br/>XXXX-XXXX-XXXX-1234|
| **Номер социального страхования** |**Метод маскирования, который предоставляет четыре последние цифры предопределенных полей** и добавляет строковую константу в качестве префикса в формате номера социального страхования в США.<br/><br/>XXX-XX-1234 |
| **Электронная почта** | **Метод маскирования, который предоставляет первую букву и домен**, используя строковую константу в качестве префикса в формате электронного адреса.<br/><br/>aXX@XXXX.com |
| **Случайное число** | **Метод маскирования, который формирует случайное число** в соответствии с выбранными границами и типами фактических данных. Если установленные границы равны, функция маскирования будет постоянным числом.<br/><br/>![Область навигации](./media/sql-database-dynamic-data-masking-get-started-portal/1_DDM_Random_number.png) |
| **Пользовательский текст** | **Метод маскирования, при котором видны первая и последняя буквы** и добавляется пользовательская строка заполнения в середине. Если исходная строка короче открытых префикса и суффикса, будет использоваться только строка дополнения.<br/>prefix[padding]suffix<br/><br/>![Область навигации](./media/sql-database-dynamic-data-masking-get-started-portal/2_DDM_Custom_text.png) |


<a name="Anchor1"></a>

## Настройка динамической маскировки данных для базы данных с помощью классического портала Azure

1. Запустите классический портал Azure на странице [https://manage.windowsazure.com](https://manage.windowsazure.com).

2. Щелкните базу данных, которую нужно маскировать, а затем перейдите на вкладку **АУДИТ И БЕЗОПАСНОСТЬ**.

3. В разделе **Динамическое маскирование данных** щелкните **ВКЛЮЧЕНО**, чтобы включить функцию динамического маскирования данных.

4. Введите пользователей SQL или удостоверения AAD, у которых должен быть доступ к немаскированным конфиденциальным данным. Это должен быть список пользователей, разделенных точкой с запятой. Обратите внимание на то, что пользователи с правами администратора всегда видят исходные данные без всякой маски.

	>[AZURE.TIP]Чтобы на уровне приложений для привилегированных пользователей могли отображаться конфиденциальные данные, добавьте пользователя SQL или удостоверение AAD, которое используется приложением для отправки запросов к базе данных. Настоятельно рекомендуется, чтобы этот список содержал минимально необходимое количество привилегированных пользователей. Это сведет к минимуму риск раскрытия конфиденциальных данных.

	![Область навигации](./media/sql-database-dynamic-data-masking-get-started-portal/4_ddm_policy_classic_portal.png)

5. В нижней части страницы в строке меню щелкните **ДОБАВИТЬ МАСКУ**, чтобы открыть окно настройки правил маскирования.

6. В выпадающем списке выберите значение **Схема**, **Таблица** и **Столбец**, чтобы определить целевые поля, которые будут замаскированы.

7. Выберите значение **ФУНКЦИЯ МАСКИРОВАНИЯ** в списке категорий маскирования конфиденциальных данных.

	![Область навигации](./media/sql-database-dynamic-data-masking-get-started-portal/5_DDM_Add_Masking_Rule_Classic_Portal.png)

8. Щелкните **ОК** в окне правил маскирования данных, чтобы обновить набор правил в политике динамического маскирования данных.

9. Щелкните **СОХРАНИТЬ**, чтобы сохранить новое или обновленное правило маскирования.


## Настройка динамического маскирования данных для базы данных с помощью командлетов Powershell

См. статью [Командлеты Базы данных SQL Azure](https://msdn.microsoft.com/library/azure/mt574084.aspx).

## Настройка динамической маскировки данных для базы данных с помощью REST API

См. статью [Операции для Баз данных SQL Azure](https://msdn.microsoft.com/library/dn505719.aspx).

<!---HONumber=AcomDC_1203_2015-->