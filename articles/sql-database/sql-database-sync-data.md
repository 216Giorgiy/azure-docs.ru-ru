---
title: "Синхронизация данных (предварительная версия) | Документация Майкрософт"
description: "В этом обзоре представлена синхронизация данных SQL Azure (предварительная версия)."
services: sql-database
documentationcenter: 
author: douglaslms
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: load & move data
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: douglasl
ms.translationtype: Human Translation
ms.sourcegitcommit: 138f04f8e9f0a9a4f71e43e73593b03386e7e5a9
ms.openlocfilehash: 075b5563688158289d51f2f0b5da4a3441ddd13a
ms.contentlocale: ru-ru
ms.lasthandoff: 06/29/2017


---
# <a name="sync-data-across-multiple-cloud-and-on-premises-databases-with-sql-data-sync"></a>Синхронизация данных в нескольких облачных и локальных базах данных с помощью синхронизации данных SQL

Синхронизация данных SQL — это служба, созданная на основе базы данных SQL Azure, которая позволяет в двунаправленном режиме синхронизировать выбранные данные в нескольких базах данных SQL и экземплярах SQL Server.

В основе синхронизации данных лежит понятие группы синхронизации. Группа синхронизации — это группа баз данных, которые требуется синхронизировать.

Группа синхронизации имеет несколько свойств, включая следующие.

-   **Схема синхронизации**: описывает, какие данные синхронизируются.

-   **Направление синхронизации**: синхронизация может быть двунаправленной или выполняться в одном направлении. То есть синхронизация может выполняться *из центральной базы данных в член*, *из члена в центральную базу данных* или в обоих этих направлениях.

-   **Интервал синхронизации**: определяет, как часто выполняется синхронизация.

-   **Политика устранения конфликтов** — это политика уровня группы, которая может задавать режим *Выигрывает концентратор* или *Member wins* (Выигрывает член).

Служба синхронизации данных использует звездообразную топологию для синхронизации данных. Одну из баз данных в группе необходимо определить как центральную базу данных. Остальные базы данных являются рядовыми базами данных. Синхронизация происходит только между центральной базой данных и отдельными членами.
-   **Центральной базой данных** должна быть база данных SQL Azure.
-   **Рядовыми базами данных** могут быть базы данных SQL, локальные базы данных SQL Server или экземпляры SQL Server на виртуальных машинах Azure.
-   **База данных синхронизации** содержит метаданные и журнал синхронизации данных. Базой данных синхронизации должна быть база данных SQL Azure, которая находится в том же регионе, что и центральная база данных. База данных синхронизации создается клиентом и принадлежит ему.

> [!NOTE]
> Если вы используете локальную базу данных, необходимо [настроить локальный агент](https://docs.microsoft.com/en-us/azure/sql-database/sql-database-get-started-sql-data-sync).

![Синхронизация данных между базами данных](media/sql-database-sync-data/sync-data-overview.png)

## <a name="when-to-use-data-sync"></a>Когда следует использовать синхронизацию данных

Использовать синхронизацию данных удобно в случаях, когда требуется обеспечить актуальное состояние данных в нескольких базах данных SQL Azure или базах данных SQL Server. Ниже приведены основных варианты использования синхронизации данных.

-   **Гибридная синхронизация данных**. Можно обеспечить синхронизацию данных между локальными базами данных и базами данных SQL Azure, чтобы использовать гибридные приложения с собственным уровнем данных в SQL. Эта возможность может привлечь клиентов, которые рассматривают переход в облако и собираются поместить некоторые из своих приложений в Azure.

-   **Распределенные приложения**. Во многих случаях полезно разделить разные рабочие нагрузки на разные базы данных. Например, если у вас есть большая рабочая база данных, но необходимо также выполнять рабочую нагрузку для составления отчетов и анализа этих данных, удобно иметь вторую базу данных для этих целей. Такой подход сводит к минимуму влияние на производительность производственной рабочей нагрузки. Чтобы синхронизировать эти две базы данных, можно использовать службу синхронизации данных.

-   **Глобально распределенные приложения**. Многие организации охватывают несколько регионов и даже несколько стран. Чтобы свести к минимуму задержки в сети, рекомендуется хранить свои данные в регионе, ближайшем к вам. Используя синхронизацию данных, можно легко обеспечить синхронизацию баз данных в регионах по всему миру.

Мы не рекомендуем использовать синхронизацию данных в следующих сценариях:

-   Аварийное восстановление

-   масштаб чтения;

-   ETL (OLTP в OLAP);

-   перенос из локальной базы данных SQL Server в базу данных SQL Azure.

## <a name="how-does-data-sync-work"></a>Как работает синхронизация данных? 

-   **Отслеживание изменения данных**. Служба синхронизации данных отслеживают изменения при помощи триггеров вставки, обновления и удаления. Изменения записываются во вспомогательную таблицу в пользовательской базе данных.

-   **Синхронизация данных**. Служба синхронизации данных разработана на основе звездообразной модели. Центральная база данных синхронизируется с каждым членом по отдельности. Изменения в центральной базе данных передаются в член, после чего изменения из члена передаются в центральную базу данных.

-   **Устранение конфликтов**. Служба синхронизации данных предоставляет два параметра для устранения конфликтов, *Выигрывает концентратор* и *Member wins* (Выигрывает член).
    -   Если выбран параметр *Выигрывает концентратор*, то изменения в центральной базе данных всегда записываются поверх изменений в члене.
    -   Если выбран параметр *Member wins* (Выигрывает член), то изменения в члене всегда записываются поверх изменений в центральной базе данных. Если имеется несколько членов, то конечное значение зависит от того, какой член синхронизируется первым.

## <a name="limitations-and-considerations"></a>Ограничения и рекомендации

### <a name="performance-impact"></a>Влияние на производительность
Служба синхронизация данных использует триггеры вставки, обновления и удаления для отслеживания изменений. Она создает вспомогательные таблицы в пользовательской базе данных. Эти действия оказывают влияние на рабочую нагрузку базы данных, поэтому вам следует оценить текущий уровень служб и поднять его, если потребуется.

### <a name="eventual-consistency"></a>Итоговая согласованность
Так как синхронизация данных основана на триггерах, транзакционная согласованность не гарантируется. Корпорация Майкрософт гарантирует, что все изменения будут внесены в конечном счете и что синхронизация данных не приведет к потере данных.

### <a name="unsupported-data-types"></a>Неподдерживаемые типы данных

-   FileStream;

-   UDT SQL или CLR;

-   XMLSchemaCollection (поддерживается XML);

-   Cursor, Timestamp, Hierarchyid.

### <a name="requirements"></a>Требования

-   Каждая таблица должна иметь первичный ключ.

-   В таблице не должно быть столбцов идентификаторов, которые не являются первичным ключом.

-   Имя базы данных не должно содержать специальных знаков.

### <a name="limitations-on-service-and-database-dimensions"></a>Ограничения характеристик служб и баз данных

|                                                                 |                        |                             |
|-----------------------------------------------------------------|------------------------|-----------------------------|
| **Характеристики**                                                      | **Ограничение**              | **Возможное решение**              |
| Максимальное количество групп синхронизации, которым может принадлежать любая база данных       | 5                      |                             |
| Максимальное количество конечных точек в отдельной группе синхронизации              | 30                     | Создайте несколько групп синхронизации. |
| Максимальное количество локальных конечных точек в отдельной группе синхронизации | 5                      | Создайте несколько групп синхронизации. |
| Имена баз данных, таблиц, схем и столбцов                       | Имя может содержать до 50 знаков. |                             |
| Таблицы в группе синхронизации                                          | 500                    | Создайте несколько групп синхронизации. |
| Столбцы в таблице в группе синхронизации                              | 1000                   |                             |
| Размер строки данных в таблице                                        | 24 МБ                  |                             |
| Минимальный интервал синхронизации                                           | 5 мин              |                             |

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о базе данных SQL и синхронизации данных SQL:

-   [Приступая к работе с синхронизацией данных SQL Azure (предварительная версия)](sql-database-get-started-sql-data-sync.md)

-   [Загрузка технической документации по синхронизации данных SQL](https://github.com/Microsoft/sql-server-samples/raw/master/samples/features/sql-data-sync/Data_Sync_Preview_full_documentation.pdf?raw=true)

-   [Документация по REST API синхронизации данных SQL](https://github.com/Microsoft/sql-server-samples/raw/master/samples/features/sql-data-sync/Data_Sync_Preview_REST_API.pdf?raw=true)

-   [Обзор Базы данных SQL](sql-database-technical-overview.md)

-   [Управление жизненным циклом базы данных](https://msdn.microsoft.com/library/jj907294.aspx)



