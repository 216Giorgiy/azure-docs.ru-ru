<properties 
    pageTitle="Настройка георепликации для базы данных SQL Azure с помощью портала предварительной версии Azure | Microsoft Azure" 
    description="Настройка георепликации для базы данных SQL Azure с помощью портала предварительной версии Azure" 
    services="sql-database" 
    documentationCenter="" 
    authors="stevestein" 
    manager="jeffreyg" 
    editor=""/>

<tags
    ms.service="sql-database"
    ms.devlang="NA"
    ms.topic="article"
    ms.tgt_pltfrm="NA"
    ms.workload="data-management" 
    ms.date="11/10/2015"
    ms.author="sstein"/>

# Настройка георепликации для базы данных SQL Azure с помощью портала предварительной версии Azure


> [AZURE.SELECTOR]
- [Azure preview portal](sql-database-geo-replication-portal.md)
- [PowerShell](sql-database-geo-replication-powershell.md)
- [Transact-SQL](sql-database-geo-replication-transact-sql.md)


В этой статье показано, как настроить георепликацию для базы данных SQL Azure с помощью [портала предварительной версии Azure](https://portal.azure.com).

Георепликация позволяет создать до четырех реплик (баз данных-получателей) в различных местах (регионах) расположения центров баз данных. Базы данных-получатели могут создаваться при сбое центра обработки данных или невозможности подключения к базе данных-источнику.

Георепликация доступна только для баз данных Standard и Premium.

Базы данных Standard могут иметь одного не доступного для чтения получателя и должны использовать рекомендованный регион. Базы данных Premium могут иметь до четырех доступных для чтения получателей в любом доступном регионе.


Для настройки георепликации необходимо следующее:

- Подписка Azure. Если вам требуется подписка Azure, нажмите в верхней части этой страницы кнопку **БЕСПЛАТНАЯ ПРОБНАЯ ВЕРСИЯ**. Оформив подписку, вернитесь к этой статье.
- База данных SQL Azure — база данных-источник, которую необходимо реплицировать в другом географическом регионе.



## Добавление базы данных-получателя

Следующие действия позволяют создать новую базу данных-получателя в связи георепликации.

Добавить базу-данных-получатель может только владелец или совладелец подписки.

Базе данных-получатель присваивается такое же имя, как у базы данных-источника, и по умолчанию тот же уровень обслуживания. База данных-получатель может быть доступной (только для уровня Premium) или не доступной для чтения, одинарной или эластичной. Дополнительные сведения см. в статье [Уровни обслуживания](sql-database-service-tiers.md). После создания и заполнения базы данных-получателя начинается репликация данных из базы данных-источника в новую базу-данных-получателя.

> [AZURE.NOTE]Если партнерская база данных уже создана (например, в результате прекращения предыдущей связи георепликации), команда завершится неудачей.




### Добавление получателя

1. В [предварительной версии портала Azure](https://portal.azure.com) перейдите к базе данных, для которой нужно настроить георепликацию.
2. В колонке «База данных SQL» выберите **Все параметры** > **Георепликация**.
3. Выберите регион для создания базы данных-получателя. Базы данных Premium могут иметь получателей в любом регионе, а базы данных Standard — только в рекомендованном.


    ![Добавление получателя][1]


4. Настройте **Тип получателя** (**Доступно для чтения** или **Не доступно для чтения**). Получателей, доступных для чтения, можно выбрать только для баз данных Premium; для баз данных Standard можно выбрать только параметр **Не доступно для чтения**.
5. Выберите или настройте сервер для базы данных-получателя.

    ![Создать получателя][3]

5. По желанию добавьте базу данных-получателя в пул эластичных баз данных:

       - Щелкните **Пул эластичных баз данных** и выберите на целевом сервере пул, в котором будет создана база-данных получатель. Пул должен уже существовать на целевом сервере, так как этот рабочий процесс не создает новый пул.

6. Щелкните **Создать**, чтобы добавить базу данных-получатель.
 
6. После создания базы данных-получателя начнется процесс заполнения.
 
    ![заполнение][6]

7. Как только процесс заполнения будет закончен, база данных-получатель сменит статус на «Не доступно для чтения».

    ![получатель готов][9]



## Удаление базы данных-получателя

Данная операция безвозвратно отменяет репликацию в базу данных-получателя и превращает ее в обычную базу данных для чтения и записи. Если подключение к базе данных-получателю прервется, команда будет выполнена, но после восстановления связи база данных-получатель не станет доступной для чтения и записи.

1. В [предварительной версии портала Azure](https://portal.azure.com) перейдите к базе данных-источнику в связи георепликации.
2. В колонке «База данных SQL» выберите **Все параметры** > **Георепликация**.
3. В списке **Базы данных-получатели** выберите базу данных, которую нужно удалить из связи георепликации.
4. Щелкните **Остановить репликацию**.

    ![удалить получателя][7]


5. В открывшемся после выбора параметра **Отменить репликацию** окне подтверждения нажмите кнопку **Да**, чтобы удалить базу данных из связи георепликации (и сделать ее доступной для чтения и записи, не используемой в репликации).


    ![подтвердите удаление][8]



## Запуск отработки отказа

Базу данных-получатель можно сделать источником.

1. В [предварительной версии портала Azure](https://portal.azure.com) перейдите к базе данных-источнику в связи георепликации.
2. В колонке «База данных SQL» выберите **Все параметры** > **Георепликация**.
3. В списке **ПОЛУЧАТЕЛИ** выберите базу данных, которая должна стать источником.
4. Щелкните **Отработка отказа**.

    ![отработка отказа][10]

Эта команда выполняет следующий рабочий процесс:

1. Временно переключает репликацию в синхронный режим. При этом все незавершенные операции переводятся на получатель. 

2. Переключает роли источника и получателя баз данных в связи георепликации.

В случае плановой отработки отказа эта последовательность действий позволяет избежать потери данных. В течение короткого периода (от 0 до 25 секунд), пока переключаются роли, обе базы данных будут недоступны. Обычно вся операция занимает меньше минуты.

   

## Дальнейшие действия

- [Разработка облачных приложений для непрерывности бизнес-процессов с использованием георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md)
- [Отработка аварийного восстановления](sql-database-disaster-recovery-drills.md)


## Дополнительные ресурсы

- [Новые возможности активной георепликации](https://azure.microsoft.com/blog/spotlight-on-new-capabilities-of-azure-sql-database-geo-replication)
- [Разработка облачных приложений для непрерывности бизнес-процессов с использованием георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md)
- [Общие сведения о непрерывности бизнес-процессов](sql-database-business-continuity.md)
- [База данных SQL — документация](https://azure.microsoft.com/documentation/services/sql-database/)


<!--Image references-->
[1]: ./media/sql-database-geo-replication-portal/configure-geo-replication.png
[2]: ./media/sql-database-geo-replication-portal/add-secondary.png
[3]: ./media/sql-database-geo-replication-portal/create-secondary.png
[4]: ./media/sql-database-geo-replication-portal/secondary-type.png
[5]: ./media/sql-database-geo-replication-portal/create.png
[6]: ./media/sql-database-geo-replication-portal/seeding0.png
[7]: ./media/sql-database-geo-replication-portal/remove-secondary.png
[8]: ./media/sql-database-geo-replication-portal/stop-confirm.png
[9]: ./media/sql-database-geo-replication-portal/seeding-complete.png
[10]: ./media/sql-database-geo-replication-portal/failover.png

<!---HONumber=Nov15_HO3-->