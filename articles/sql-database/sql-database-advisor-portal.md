---
title: "Использование помощника по базам данных SQL Azure на портале Azure | Документация Майкрософт"
description: "Используя помощник по базам данных SQL Azure на портале Azure можно просматривать и реализовывать рекомендации для существующих баз данных SQL, которые могут повысить текущую производительность запросов."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: cda8a646-0584-4368-b28a-85cdd9b54fcd
ms.service: sql-database
ms.custom: monitor and tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 09/30/2016
ms.author: sstein
translationtype: Human Translation
ms.sourcegitcommit: 8d988aa55d053d28adcf29aeca749a7b18d56ed4
ms.openlocfilehash: f63bd47c15439e6fedc0f6edf579681697155592


---
# <a name="sql-database-advisor-using-the-azure-portal"></a>Использование помощника по базам данных SQL на портале Azure

Используя помощник по базам данных SQL Azure на портале Azure можно просматривать и реализовывать рекомендации для существующих баз данных SQL, которые могут повысить текущую производительность запросов.

## <a name="viewing-recommendations"></a>Просмотр рекомендаций
На странице рекомендаций приводится список основных предлагаемых рекомендаций с учетом их потенциального влияния на повышение производительности. Здесь же можно увидеть состояние последних операций. Выберите рекомендацию или состояние, чтобы увидеть дополнительные сведения.

Чтобы просмотреть и применить рекомендации, необходимо изменить разрешения [управления доступом на основе ролей](../active-directory/role-based-access-control-configure.md) в Azure. Разрешения **Читатель** и **Участник баз данных SQL** необходимы для просмотра рекомендаций, а разрешения **Владелец**, **Участник баз данных SQL** необходимы для выполнения действий: создание, удаление индекса и отмена создания индекса.

1. Войдите на [портал Azure](https://portal.azure.com/).
2. Щелкните **Больше служб** > **Базы данных SQL** и выберите свою базу данных.
3. Выберите **Рекомендации по производительности**, чтобы просмотреть доступные рекомендации для выбранной базы данных.

> [!NOTE]
> Чтобы рекомендации сформировались, база данных должна использоваться примерно один день и в ней должна быть активность. Кроме того, активность должна быть однообразной. Помощник по работе с базами данных SQL обеспечивает более эффективную оптимизацию при стабильном потоке запросов, чем на основе случайных всплесков активности. Если доступных рекомендаций нет, на странице **Рекомендации по производительности** будет указана причина.
> 
> 

![Рекомендации](./media/sql-database-advisor-portal/recommendations.png)

Ниже приведен пример рекомендаций по устранению ошибки схемы на портале Azure.

![Устранение ошибки схемы](./media/sql-database-advisor-portal/sql-database-advisor-schema-issue.png)

Рекомендации сортируются по их возможному влиянию на производительность и делятся на четыре категории:

| Влияние | Описание |
|:--- |:--- |
| Высокий |Рекомендации с высоким уровнем влияния должны обеспечить наиболее значимое изменение производительности. |
| Средний |Рекомендации со средним уровнем влияния должны улучшить производительность, но не существенным образом. |
| Низкий |Рекомендации с низким уровнем влияния должны улучшить производительность, но улучшения не будут значительными. |

### <a name="removing-recommendations-from-the-list"></a>Удаление рекомендаций из списка
Если какие-либо рекомендации в списке нужно удалить, отклоните соответствующую рекомендацию, выполнив описанные ниже действия.

1. Выберите рекомендацию из списка **Рекомендации**.
2. Щелкните **Отклонить** в колонке **Сведения**.

При необходимости отклоненные рекомендации можно вернуть в список **Рекомендации** , выполнив следующие действия.

1. В колонке **Рекомендации** щелкните **Представление отклонено**.
2. Выберите отклоненный элемент из списка, чтобы просмотреть сведения о нем.
3. При необходимости щелкните **Отменить отклонение**, чтобы вернуть индекс обратно в основной список рекомендаций в колонке **Рекомендации**.

## <a name="applying-recommendations"></a>Применение рекомендаций
Помощник по работе с базами данных SQL предоставляет полный контроль над применением рекомендаций с помощью следующих трех параметров: 

* применять отдельные рекомендаций по одной;
* разрешить помощнику автоматически применять рекомендации (в настоящее время применяется только к рекомендациям по индексам);
* запустить рекомендованный скрипт T-SQL для выполнения рекомендации в базе данных вручную.

Выберите рекомендацию, чтобы просмотреть ее описание, и щелкните **Показать скрипт**, чтобы узнать, как будет создана рекомендация.

Пока помощник применяет рекомендацию, база данных остается доступной — при работе помощника по базам данных SQL база данных никогда не оказывается вне сети.

### <a name="apply-an-individual-recommendation"></a>Применение отдельной рекомендации
Рекомендации можно просматривать и применять по одной.

1. В колонке **Рекомендации** щелкните рекомендацию.
2. В колонке **Сведения** щелкните **Применить**.
   
    ![Применить рекомендацию](./media/sql-database-advisor-portal/apply.png)

### <a name="enable-automatic-index-management"></a>Включение автоматического управления индексами
Помощник по работе с базами данных SQL можно настроить на автоматическое выполнение рекомендаций. В этом случае появляющиеся рекомендации будут применяться автоматически. Как и во всех остальных операциях с индексами, управляемых службой, если выполнение рекомендации ведет к ухудшению производительности, она отменяется.

1. В колонке **Рекомендации** щелкните **Автоматизация**.
   
    ![Настройки помощника](./media/sql-database-advisor-portal/settings.png)
2. Настройте помощник для автоматического **создания** или **удаления** индексов.
   
    ![Рекомендованные индексы](./media/sql-database-advisor-portal/automation.png)

### <a name="manually-run-the-recommended-t-sql-script"></a>Выполнение рекомендованного сценария T-SQL вручную
Выберите рекомендацию и щелкните **Показать скрипт**. Выполните этот сценарий для базы данных, чтобы применить рекомендацию вручную.

*Для индексов, созданных вручную, не выполняется мониторинг и проверка влияния на производительность службы,* поэтому после создания индекса убедитесь в том, что он действительно повысил производительность, и при необходимости измените или удалите этот индекс. Дополнительные сведения о создании индексов см. в статье [CREATE INDEX (Transact-SQL)](https://msdn.microsoft.com/library/ms188783.aspx).

### <a name="canceling-recommendations"></a>Отмена рекомендаций
Рекомендации с состоянием **Ожидание**, **Проверка** или **Успешно** можно отменить. Рекомендация с состоянием **Выполняется** не может быть отменена.

1. Выберите рекомендацию в области **Журнал настройки**, чтобы открыть колонку **сведений о рекомендации**.
2. Щелкните **Отменить** , чтобы прервать процесс применения рекомендации.

## <a name="monitoring-operations"></a>Мониторинг операций
Применение рекомендаций может происходить не мгновенно. Портал предоставляет сведения о состоянии операций с рекомендациями. Ниже перечислены состояния, в которых может находиться индекс.

| Состояние | Описание |
|:--- |:--- |
| Ожидает |Команда на применение рекомендации получена и запланирована для выполнения. |
| Выполняется |Идет применение рекомендации. |
| Успешно |Рекомендация была успешно применена. |
| Ошибка |В процессе применения рекомендации возникла ошибка. Это может быть временной проблемой, либо это может быть результатом изменения схемы, в результате чего скрипт больше не работает. |
| Возврат |Рекомендация была применена, но не дала существенного улучшения и была автоматически отменена. |
| Отмена |Рекомендация была отменена. |

Щелкните внутрипроцессную рекомендацию в списке, чтобы увидеть дополнительные сведения о ней:

![Рекомендованные индексы](./media/sql-database-advisor-portal/operations.png)

### <a name="reverting-a-recommendation"></a>Отмена рекомендации
Если для применения рекомендации использовался помощник (то есть вы не запускали сценарий T-SQL вручную), он автоматически отменит рекомендацию, ухудшившую производительность. Если по какой-то причине рекомендацию необходимо отменить, выполните указанные ниже действия.

1. Выберите успешно примененную рекомендацию в области **Журнал настройки** .
2. Щелкните **Отменить** в колонке **сведений о рекомендации**.

![Рекомендованные индексы](./media/sql-database-advisor-portal/details.png)

## <a name="monitoring-performance-impact-of-index-recommendations"></a>Мониторинг влияния рекомендаций по индексам на производительность
После успешного применения рекомендаций (в настоящее время доступны только рекомендации по операциям с индексами и параметризации запросов) щелкните **Подробные сведения о запросе** в колонке сведений о рекомендации, чтобы отобразить [анализ производительности запросов](sql-database-query-performance.md) и просмотреть влияние на производительность ваших основных запросов.

![Мониторинг влияния на производительность](./media/sql-database-advisor-portal/query-insights.png)

## <a name="summary"></a>Сводка
Помощник по работе с базами данных SQL предоставляет рекомендации по повышению производительности базы данных SQL. Предоставляя сценарии T-SQL, а также параметры индивидуального или полностью автоматизированного управления (в настоящее время только для индексов), помощник помогает оптимизировать базу данных и, таким образом, повысить производительность запросов.

## <a name="next-steps"></a>Дальнейшие действия
Отслеживайте рекомендации и продолжайте применять их для повышения производительности. Рабочие нагрузки базы данных являются динамическими и меняются непрерывно. Помощник по работе с базами данных SQL продолжит отслеживать работу и давать рекомендации, которые могут повысить производительность базы данных. 

* В разделе [Помощник по работе с базами данных SQL](sql-database-advisor.md) представлен обзор помощника по базам данных SQL.
* См. статью [Анализ производительности запросов базы данных Azure SQL](sql-database-query-performance.md), чтобы узнать о том, как просмотреть влияние на производительность основных запросов.

## <a name="additional-resources"></a>Дополнительные ресурсы
* [Хранилище запросов](https://msdn.microsoft.com/library/dn817826.aspx)
* [CREATE INDEX](https://msdn.microsoft.com/library/ms188783.aspx)
* [Контроль доступа на основе ролей](../active-directory/role-based-access-control-configure.md)




<!--HONumber=Feb17_HO3-->


