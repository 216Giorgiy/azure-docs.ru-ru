---
title: Ограничения ресурсов базы данных SQL Azure в модели приобретения на основе DTU — одиночные базы данных | Документы Майкрософт
description: На этой странице описаны некоторые общие ограничения ресурсов на основе единицы передачи данных для одиночных баз данных в базе данных SQL Azure.
services: sql-database
author: sachinpMSFT
manager: craigg
ms.service: sql-database
ms.custom: DBs & servers
ms.topic: conceptual
ms.date: 06/29/2018
ms.author: carlrab
ms.openlocfilehash: 2d6660e1064959f2d04424ae1c3e9bc668231c92
ms.sourcegitcommit: 5892c4e1fe65282929230abadf617c0be8953fd9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2018
ms.locfileid: "37131327"
---
# <a name="resource-limits-for-single-databases-using-the-dtu-based-purchasing-model"></a>Ограничения ресурсов для одиночных баз данных в модели приобретения на основе DTU 

Эта статья содержит подробные сведения об ограничениях для эластичных пулов в базе данных SQL Azure в модели приобретения на основе DTU.

Сведения об ограничениях ресурсов в модели приобретения на основе DTU для эластичных пулов см. в разделе [Ограничения ресурсов в модели приобретения на основе DTU — эластичные пулы](sql-database-vcore-resource-limits-elastic-pools.md). Сведения об ограничениях ресурсов в модели приобретения на основе виртуальных ядер см. в разделах [Ограничения ресурсов в модели приобретения на основе виртуальных ядер — одиночные базы данных](sql-database-vcore-resource-limits-single-databases.md) и [Ограничения ресурсов в модели приобретения на основе виртуальных ядер — эластичные пулы](sql-database-vcore-resource-limits-elastic-pools.md).

## <a name="single-database-storage-sizes-and-performance-levels"></a>Отдельная база данных: размеры хранилища и уровни производительности

В следующих таблицах приведены доступные ресурсы для отдельных баз данных на каждом уровне служб и уровне производительности. Уровень обслуживания, уровень производительности и объем хранилища для одиночной базы данных можно задать с помощью [портала Azure](sql-database-servers-databases-manage.md#azure-portal-manage-logical-servers-and-databases), [PowerShell](sql-database-servers-databases-manage.md#powershell-manage-logical-servers-and-databases), [Azure CLI](sql-database-servers-databases-manage.md#azure-cli-manage-logical-servers-and-databases) или [REST API](sql-database-servers-databases-manage.md#rest-api-manage-logical-servers-and-databases).

### <a name="basic-service-tier"></a>Уровень службы "Базовый"
| **Уровень производительности** | **базовая;** |
| :--- | --: |
| Максимальное количество DTU | 5 |
| Включенный объем хранилища (ГБ) | 2 |
| Варианты максимального объема хранилища (ГБ) | 2 |
| Максимальное хранилище OLTP в памяти (ГБ) |Недоступно |
| Максимальное количество одновременных рабочих ролей (запросов) | 30 |
| Максимальное количество параллельных сеансов | 300 |
|||

### <a name="standard-service-tier"></a>Уровень службы "Стандартный"
| **Уровень производительности** | **S0** | **S1** | **S2** | **S3** |
| :--- |---:| ---:|---:|---:|---:|
| Максимальное количество DTU | 10 | 20 | 50 | 100 |
| Включенный объем хранилища (ГБ) | 250 | 250 | 250 | 250 |
| Варианты максимального объема хранилища (ГБ) | 250 | 250 | 250 | 250, 500, 750, 1024 |
| Максимальное хранилище OLTP в памяти (ГБ) | Недоступно | Недоступно | Недоступно | Недоступно |
| Максимальное количество одновременных рабочих ролей (запросов)| 60 | 90 | 120 | 200 |
| Максимальное количество параллельных сеансов |600 | 900 | 1200 | 2400 |
||||||

### <a name="standard-service-tier-continued"></a>Уровень служб "Стандартный" (продолжение)
| **Уровень производительности** | **S4** | **S6** | **S7** | **S9** | **S12** |
| :--- |---:| ---:|---:|---:|---:|---:|
| Максимальное количество DTU | 200 | 400 | 800 | 1600 | 3000 |
| Включенный объем хранилища (ГБ) | 250 | 250 | 250 | 250 | 250 |
| Варианты максимального объема хранилища (ГБ) | 250, 500, 750, 1024 | 250, 500, 750, 1024 | 250, 500, 750, 1024 | 250, 500, 750, 1024 | 250, 500, 750, 1024 |
| Максимальное хранилище OLTP в памяти (ГБ) | Недоступно | Недоступно | Недоступно | Недоступно |Недоступно |
| Максимальное количество одновременных рабочих ролей (запросов)| 400 | 800 | 1600 | 3200 |6000 |
| Максимальное количество параллельных сеансов |4800 | 9600 | 19 200 | 30 000 |30 000 |
|||||||

### <a name="premium-service-tier"></a>Уровень службы "Премиум" 
| **Уровень производительности** | **P1** | **P2** | **P4** | **P6** | **P11** | **P15** | 
| :--- |---:|---:|---:|---:|---:|---:|
| Максимальное количество DTU | 125 | 250 | 500 | 1000 | 1750 | 4000 |
| Включенный объем хранилища (ГБ) | 500 | 500 | 500 | 500 | 4096 | 4096 |
| Варианты максимального объема хранилища (ГБ) | 500, 750, 1024 | 500, 750, 1024 | 500, 750, 1024 | 500, 750, 1024 | 4096 | 4096 |
| Максимальное хранилище OLTP в памяти (ГБ) | 1 | 2 | 4. | 8 | 14 | 32 |
| Максимальное количество одновременных рабочих ролей (запросов)| 200 | 400 | 800 | 1600 | 2400 | 6400 |
| Максимальное количество параллельных сеансов | 30 000 | 30 000 | 30 000 | 30 000 | 30 000 | 30 000 |
|||||||


> [!IMPORTANT]
> Хранилище ценовой категории "Премиум" объемом свыше 1 ТБ сейчас доступно во всех регионах, кроме следующих: центрально-западная часть США, Восточный Китай, центральный регион US DoD, Центральная Германия, восточный регион US DoD, юго-западный регион USGov, Северо-Восточная Германия, USGov — Айова, Северный Китай. В других регионах максимальный объем хранилища уровня "Премиум" равен 1 ТБ. См. [текущие ограничения для баз данных P11–P15](#single-database-limitations-of-p11-and-p15-when-the-maximum-size-greater-than-1-tb).  

## <a name="single-database-change-storage-size"></a>Отдельная база данных: изменение размера хранилища

- Цена DTU для отдельной базы данных включает в себя определенный объем хранилища, не требующий дополнительной платы. Дополнительный объем хранилища, сверх включенного, можно подготовить за дополнительную плату в пределах максимального допустимого размера с шагом в 250 ГБ при объеме хранилища до 1 ТБ и с шагом в 256 ГБ — при объеме более 1 ТБ. Сведения о включенном объеме хранилища и ограничениях максимального размера см. в разделе [Отдельная база данных: размеры хранилища и уровни производительности](#single-database-storage-sizes-and-performance-levels).
- Дополнительное хранилище для отдельной базы данных можно подготовить, увеличив ее максимальный размер с помощью [портала Azure](sql-database-servers-databases-manage.md#azure-portal-manage-logical-servers-and-databases), [Transact-SQL](/sql/t-sql/statements/alter-database-azure-sql-database#examples), [PowerShell](/powershell/module/azurerm.sql/set-azurermsqldatabase), [Azure CLI](/cli/azure/sql/db#az_sql_db_update) или [REST API](/rest/api/sql/databases/update).
- Стоимость дополнительного хранилища для отдельной базы данных равна его объему, умноженному на цену единицы хранения этого хранилища для уровня служб. Сведения о цене на дополнительное хранилище см. на [странице цен на Базу данных SQL](https://azure.microsoft.com/pricing/details/sql-database/).

## <a name="single-database-change-dtus"></a>Отдельная база данных: изменение числа DTU

После выбора первоначального уровня служб, уровня производительности и объема хранилища можно масштабировать отдельную базу данных динамически, исходя из ее фактического использования, с помощью [портала Azure](sql-database-servers-databases-manage.md#azure-portal-manage-logical-servers-and-databases), [Transact-SQL](/sql/t-sql/statements/alter-database-azure-sql-database#examples), [PowerShell](/powershell/module/azurerm.sql/set-azurermsqldatabase), [Azure CLI](/cli/azure/sql/db#az_sql_db_update) или [REST API](/rest/api/sql/databases/update). 

В следующем видео показано динамическое изменение уровня производительности для увеличения количества доступных DTU для отдельной базы данных.

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-dynamically-scale-up-or-scale-down/player]
>

При изменении уровня службы или уровня производительности базы данных создается реплика исходной базы данных с новым уровнем производительности, после чего устанавливаются подключения к реплике. Во время этого процесса данные не теряются, но в течение короткого периода, когда производится переподключение к реплике, соединения с базой данных становятся неактивны, поэтому некоторые текущие транзакции могут откатиться. Интервал времени для переключения не фиксирован, но в 99 % случаев он находится в пределах 30 секунд. Если в момент разрыва подключений выполняется большое число транзакций, период переключения может быть продолжительнее. 

Длительность всего процесса вертикального масштабирования зависит от размера и уровня службы базы данных до и после изменения. Например, если база данных размером 250 ГБ переводится с уровня службы "Стандартный", на этот уровень или в его пределах, процесс должен завершиться в течение шести часов. Если уровень производительности базы данных того же размера меняется в пределах уровня службы "Премиум", то увеличение масштаба должно завершиться в течение трех часов.

> [!TIP]
> Чтобы отслеживать выполняемые операции см. статью [Operations — List](/rest/api/sql/Operations/List) (Список операций), [az sql db op](/cli/azure/sql/db/op), [sys.dm_operation_status (Azure SQL Database)](/sql/relational-databases/system-dynamic-management-views/sys-dm-operation-status-azure-sql-database) (sys.dm_operation_status (база данных SQL Azure)) и эти две команды PowerShell: [Get-AzureRmSqlDatabaseActivity](/powershell/module/azurerm.sql/get-azurermsqldatabaseactivity) и [Stop-AzureRmSqlDatabaseActivity](/powershell/module/azurerm.sql/stop-azurermsqldatabaseactivity).

* При переходе к более высокому уровню служб или производительности максимальный размер базы данных не увеличивается, если явно не указать для него большее значение (maxsize).
* При понижении уровня базы данных используемое ею пространство не должно превышать максимальный допустимый размер целевых уровня служб и уровня производительности. 
* При понижении уровня **Премиум** до уровня **Стандартный** дополнительная плата взимается, если максимальный размер базы данных поддерживается в целевом уровне производительности и превышает объем включенного хранилища целевого уровня производительности. Например, если уровень базы данных P1 с максимальным размером в 500 ГБ понижается до уровня S3, то взимается плата за дополнительное хранилище, так как S3 поддерживает максимальный размер в 500 ГБ, а его включенный объем хранилища составляет только 250 ГБ. Поэтому дополнительный объем хранилища равен 500 – 250 = 250 ГБ. Чтобы узнать о ценах на дополнительное хранилище, ознакомьтесь с [ценами на Базу данных SQL](https://azure.microsoft.com/pricing/details/sql-database/). Если фактический объем пространства, которое используется, меньше, чем включенный объем хранилища, то этих дополнительных затрат можно избежать, уменьшив максимальный размер базы данных до включенного объема. 
* Если вы повышаете уровень базы данных с включенной [георепликацией](sql-database-geo-replication-portal.md), перед повышением уровня базы данных-источника сначала обновите базы данных-получатели до требуемого уровня производительности (общая рекомендация для оптимальной производительности). Чтобы выполнить обновление до другого выпуска, сначала необходимо обновить базу данных-получатель.
* Если вы понижаете уровень базы данных с включенной [георепликацией](sql-database-geo-replication-portal.md), перед понижением уровня базы данных-получателя сначала понизьте категорию ее базы данных-источника до требуемого уровня производительности (общая рекомендация для оптимальной производительности). Чтобы понизить уровень до другого выпуска, сначала необходимо понизить уровень базы данных-получателя.
* Предложения службы восстановления отличаются для разных уровней служб. При понижении до уровня **Базовый** уменьшится период удержания резервной копии. Прочитайте раздел [Подробнее об автоматически создаваемых резервных копиях в Базе данных SQL](sql-database-automated-backups.md).
* Новые свойства базы данных не применяются до тех пор, пока изменение не завершится.

## <a name="single-database-limitations-of-p11-and-p15-when-the-maximum-size-greater-than-1-tb"></a>Отдельная база данных: ограничения P11 и P15 при максимальном размере, превышающем 1 ТБ

Максимальный размер больше 1 ТБ, для базы данных P11 и P15 поддерживается в следующих регионах: Виргиния (для обслуживания государственных организаций США), восточная Австралия, восточная Канада, восточная часть США 2, восточная Япония, Западная Европа, западная часть Соединенного Королевства, западная часть США, западная Япония, Республика Корея, Северная Европа, северо-центральный регион США, центральная Германия, центральная Канада, Центральная Франция, центральная часть США, центральный регион, юго-восточная Австралия, Юго-Восточная Азия, юго-центральный регион США, южная Бразилия и южная часть Соединенного Королевства. Ниже приведены рекомендации и ограничения для баз данных P11 и P15 с максимальным размером, превышающим 1 ТБ.

- Если при создании базы данных выбрать максимальный размер больше 1 ТБ (указав значение 4 ТБ или 4096 ГБ), то выполнение команды create завершится ошибкой, если база данных подготавливается в неподдерживаемом регионе.
- Для существующих баз данных P11 или P15, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища до 4 ТБ с шагом в 256 ГБ. Чтобы узнать, поддерживается ли в вашем регионе больший размер, используйте функцию [DATABASEPROPERTYEX](/sql/t-sql/functions/databasepropertyex-transact-sql) или проверьте размер базы данных на портале Azure. Обновление существующей базы данных P11 или P15 может выполнить только учетная запись субъекта уровня сервера или участники роли базы данных dbmanager. 
- При выполнении операции в поддерживаемом регионе конфигурация будет обновлена немедленно. Во время обновления база данных остается подключенной к сети. Тем не менее вы не сможете использовать весь объем хранилища больше 1 ТБ, пока файлы базы данных не будут обновлены до нового максимального размера. Требуемая продолжительность зависит от размера обновляемой базы данных. 
- При создании или обновлении базы данных P11 или P15 можно выбрать максимальный размер хранилища только в пределах 1–4 ТБ с шагом в 256 ГБ. При создании базы данных уровня производительности P11 или P15 уже выбран размер хранилища по умолчанию — 1 ТБ. Для баз данных, расположенных в одном из поддерживаемых регионов, можно увеличить максимальный размер хранилища до 4 ТБ для новой или существующей отдельной базы данных. Для всех других регионов максимальный размер не может превышать 1 ТБ. При выборе хранилища объемом в 4 ТБ цена не меняется.
- Если максимальный размер базы данных имеет значение больше 1 ТБ, то его нельзя изменить на 1 ТБ, даже если для базы данных фактически используется меньше 1 ТБ. Таким образом невозможно понизить базу данных уровня P11 или P15 с максимальным размером более 1 ТБ до базы данных с максимальным размером в 1 ТБ уровня P11 или P15 либо более низкого уровня производительности, например P1–P6. Это ограничение также применяется в сценариях восстановления и копирования, включая восстановление до точки во времени, геовосстановление, долгосрочное хранение резервных копий и копирование базы данных. После настройки максимального размера базы данных больше 1 ТБ все операции восстановления этой базы данных должны выполняться на уровне P11 или P15 с максимальным размером больше 1 ТБ.
- Для сценариев активной георепликации:
   - Настройка отношения георепликации. Если используется база данных-источник P11 или P15, уровень баз данных-получателей также должен быть P11 или P15. Базы данных более низкого уровня производительности отклоняются, так как они не поддерживают максимальный размер больше 1 ТБ.
   - Обновление базы данных-источника в отношениях георепликации. При изменении максимального размера и указании значения больше 1 ТБ в базе данных-источнике такие же изменения произойдут в базе данных-получателе. Чтобы изменения в базе данных-источнике вступили в силу, оба обновления должны быть успешными. При этом применяются ограничения по регионам для максимального размера больше 1 ТБ. Если база данных-получатель находится в регионе, не поддерживающем максимальный размер больше 1 TB, то база данных-источник не обновляется.
- Использование службы импорта и экспорта для загрузки баз данных P11 и P15 с максимальным размером больше 1 ТБ не поддерживается. Для [импорта](sql-database-import.md) и [экспорта](sql-database-export.md) данных используйте файл SqlPackage.exe.

## <a name="next-steps"></a>Дополнительная информация

- См. [часто задаваемые вопросы о службе "База данных SQL"](sql-database-faq.md).
- Сведения об общих ограничениях Azure см. в разделе [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md).
- Сведения о DTU и eDTU см. в разделе [Общие сведения об обычных единицах передачи данных (DTU) и единицах передачи данных в эластичной базе данных (eDTU)](sql-database-service-tiers.md#what-are-database-transaction-units-dtus).
- Сведения об ограничениях на размер базы данных tempdb см. здесь: https://docs.microsoft.com/sql/relational-databases/databases/tempdb-database#tempdb-database-in-sql-database.
