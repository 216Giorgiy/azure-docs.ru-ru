<properties
   pageTitle="Перенос базы данных SQL Server в базу данных SQL Azure"
   description="База данных SQL Microsoft Azure, развертывание базы данных, миграция базы данных, импорт базы данных, экспорт базы данных, мастер миграции"
   services="sql-database"
   documentationCenter=""
   authors="carlrabeler"
   manager="jeffreyg"
   editor=""/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-management"
   ms.date="10/12/2015"
   ms.author="carlrab"/>

# Перенос базы данных SQL Server в базу данных SQL Azure

Сложность перемещения локальной базы данных в Базу данных SQL Azure может отличаться в зависимости от структуры базы данных и приложения, а также допустимого времени простоя. Для совместимых баз данных перенос в базу данных SQL Azure сводится к простой операции перемещения схемы и данных, не требующей изменения схемы или доработки приложений. [База данных SQL Azure версии 12](../sql-database-v12-whats-new.md) обеспечивает практически полную совместимость на уровне ядра с SQL Server 2014 и SQL Server 2016. Большинство инструкций SQL Server 2016 Transact-SQL полностью поддерживаются в Базе данных Microsoft SQL Azure. Сюда входят типы данных SQL Server, операторы, а также строковые, арифметические, логические функции, функции работы с курсором и другие элементы языка Transact-SQL, на которые полагается большинство приложений. Частично поддерживаемые или неподдерживаемые функции обычно связаны с различиями в том, как база данных SQL управляет базой данных (например, функции работы с файлами, функции обеспечения высокого уровня доступности и средства обеспечения безопасности), или со специальными функциями, такими как компонент Service Broker. Поскольку База данных SQL изолирует многие возможности от зависимостей в базе данных master, многие действия уровня сервера не поддерживаются или являются несоответствующими. Обычно функции, устаревшие в SQL Server, не поддерживаются в Базе данных SQL. Базы данных и приложения, опирающиеся на [частично или полностью неподдерживаемые функции](../sql-database-transact-sql-information.md), потребуют небольшой доработки перед их миграцией.

Рабочий процесс переноса базы данных SQL Server в базу данных SQL Azure состоит из следующих этапов.

 1. [Определение совместимости базы данных](#determine-if-your-database-is-compatible).
 2. [Устранение проблем совместимости, если база данных несовместима](#fix-database-compatibility-issues).
 3. [Перенос совместимой базы данных](#options-to-migrate-a-compatible-database-to-azure-sql-database).

>[AZURE.NOTE]Информацию о переносе других типов баз данных, в том числе Microsoft Access, Sybase, MySQL Oracle и DB2, в Базу данных SQL Azure см. в статье [Помощник по миграции SQL Server](http://blogs.msdn.com/b/ssma/).

## Определение совместимости базы данных
Существуют два основных метода определения совместимости исходной базы данных. Экспорт приложения уровня данных — этот метод использует мастер в среде Management Studio, чтобы проанализировать вашу базу данных и отобразить на консоли проблемы с совместимостью, если они есть. SQLPackage —этот метод использует служебную программу командной строки SQLPackage.exe ([sqlpackage.exe](https://msdn.microsoft.com/library/hh550080.aspx)), чтобы проанализировать вашу базу данных и создать отчет. SQLPackage поставляется вместе с Visual Studio и SQL Server.

> [AZURE.NOTE]Существует третий метод, который использует файлы трассировки как дополнительные исходные данные для проверки совместимости на уровне приложения, а также на уровне базы данных. Это [мастер миграции SQL Azure](http://sqlazuremw.codeplex.com/), бесплатное средство на сайте Codeplex. Однако это средство в настоящее время может обнаруживать проблемы совместимости, которые присутствовали в базе данных SQL Azure версии 11 и которые не являются проблемами в базе данных SQL Azure версии 12.

При обнаружении проблем совместимости базы данных их необходимо устранить до переноса базы данных в Базу данных SQL Azure. Руководство по устранению проблем совместимости базы данных см. в разделе [Устранение проблем совместимости базы данных](#fix-database-compatibility-issues).

> [AZURE.IMPORTANT]Эти способы не обнаруживают все проблемы совместимости между различными уровнями баз данных SQL Server (т. е. уровень 90, 100 и 110). Если перенос выполняется с более старой базы данных (уровень 80, 90, 100 и 110), то сначала необходимо выполнить обновление (по крайней мере в среде разработки). Как только будет выполнено обновление до SQL Server 2014 (или более поздней версии), тогда можно начинать перенос в базу данных SQL Azure.

## Определение совместимости базы данных с помощью служебной программы sqlpackage.exe

1. Откройте окно командной строки и измените каталог, содержащий самую последнюю версию sqlpackage.exe. Эта служебная программа поставляется вместе с Visual Studio и SQL Server. Можно также [скачать](https://msdn.microsoft.com/library/mt204009.aspx) последнюю версию SQL Server Data Tools для получения этой служебной программы.
2. Выполните следующую команду sqlpackage.exe со следующими аргументами для вашей среды:

	'sqlpackage.exe /Action:Export /ssn:< server_name > /sdn:< database_name > /tf:< target_file > /p:TableData=< schema_name.table_name > > < output_file > 2>&1'

	| Аргумент | Описание |
	|---|---|
	| < server_name > | имя исходного сервера |
	| < database_name > | имя исходной базы данных |
	| < target_file > | имя файла и расположение для файла BACPAC |
	| < schema_name.table_name > | таблицы, для которых данные будут выведены в конечный файл |
	| < output_file > | имя и расположение для выходного файла с ошибками, если таковые имеются |

	Аргумент /p:TableName используется потому, что нужно проверить только совместимость базы данных для экспорта в базу данных SQL Azure версии 12, а не экспортировать данные из всех таблиц. К сожалению, аргумент экспорта для sqlpackage.exe не поддерживает извлечение без таблицы, поэтому нужно указать одну небольшую таблицу. Аргумент < output_file > будет содержать отчет об ошибках. Строка «> 2>&1» выводит как стандартные выходные данные, так и стандартные ошибки, полученные в результате выполнения команды в указанный выходной файл.

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSQLPackage01.png)

3. Откройте выходной файл и просмотрите проблемы совместимости (если они есть). Руководство по устранению проблем совместимости базы данных см. в разделе [Устранение проблем совместимости базы данных](#fix-database-compatibility-issues).

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSQLPackage02.png)

## Определение совместимости базы данных с помощью экспорта приложения уровня данных

1. Убедитесь, что вы используете среду SQL Server Management Studio версии 13.0.600.65 или более поздней. Новые версии среды Management Studio обновляются ежемесячно для поддержания синхронизации с обновлениями портала Azure.

 	 >[AZURE.IMPORTANT]Загрузите [последнюю](https://msdn.microsoft.com/library/mt238290.aspx) версию среды SQL Server Management Studio. Мы рекомендуем всегда использовать самую последнюю версию среды Management Studio.

2. Откройте среду Management Studio и подключитесь к исходной базе данных в обозревателе объектов.
3. В обозревателе объектов щелкните правой кнопкой мыши исходную базу данных, наведите указатель мыши на пункт **Задачи** и выберите команду **Экспорт приложения уровня данных...**.

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS01.png)

4. В окне мастера экспорта щелкните **Далее** и на вкладке **Параметры** настройте сохранение BACPAC-файла на локальный диск или в большой двоичный объект Azure. BACPAC-файл будет сохранен, только если нет проблем совместимости базы данных. При наличии проблем совместимости они будут отображаться на консоли.

	![Параметры экспорта](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS02.png)

5. Перейдите на вкладку **Дополнительно** и снимите флажок **Выделить все**, чтобы пропустить экспорт данных. На этом этапе нашей целью является только проверка совместимости.

	![Параметры экспорта](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS03.png)

6. Нажмите кнопку **Далее**, а затем — кнопку **Готово**. При наличии проблем совместимости базы данных они отобразятся, после того как мастер проверит схему.

	![Параметры экспорта](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS04.png)

7. Если проблемы отсутствуют, значит база данных совместима и все готово к переносу. Если проблемы есть, их необходимо устранить. Чтобы просмотреть проблемы, нажмите ссылку **Ошибка** для соответствующей **Проверки схемы**. Сведения об устранении этих проблем см. в разделе [Устранение проблем совместимости базы данных](#fix-database-compatibility-issues).

	![Параметры экспорта](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS05.png)

8.	Если файл *. BACPAC успешно создан, то ваша база данных совместима с Базой данных SQL и вы готовы к миграции.

## Возможности переноса совместимой базы данных в базу данных SQL Azure

После проверки совместимости базы данных необходимо выбрать метод переноса. Во-первых, необходимо решить, можете ли вы вывести базу данных из рабочего процесса на время миграции. Если нет, используйте репликацию транзакций SQL Server, которая описана ниже. Если вы можете позволить себе некоторое время простоя или выполняете тестовую миграцию рабочей базы данных, которую позже можете перенести с помощью транзакционной репликации, рассмотрите один из следующих трех методов.

### Миграция совместимой базы данных с простоем   
В следующем списке представлены параметры для переноса совместимой базы данных в Базу данных SQL Azure в случае, когда вы можете себе позволить некоторое время простоя на время миграции и до того момента, когда вы сможете направить пользователей и приложения в перенесенную базу данных в SQL Azure. С помощью этих методов выполняется миграция базы данных в том виде, в котором она существует в определенный момент времени.

> [AZURE.WARNING]Для обеспечения согласованности транзакций во время миграции перед переносом базы данных с помощью любого из этих методов, убедитесь, что активные транзакции отсутствуют. Существует множество методов замораживания базы данных — от отключения возможности подключения клиента до создания [моментального снимка базы данных](https://msdn.microsoft.com/library/ms175876.aspx).

- Перенос малых и средних [совместимых](#determine-if-your-database-is-compatible) Баз данных SQL Server 2005 или более поздних версий выполняется просто и заключается в запуске [мастера по развертыванию базы данных в базе данных Microsoft Azure](#use-the-deploy-database-to-microsoft-azure-database-wizard) в среде SQL Server Management Studio. При наличии проблем с подключением (отсутствие подключения, низкая пропускная способность или проблемы из-за превышения времени ожидания) можно [использовать BACPAC-файл для переноса](#use-a-bacpac-to-migrate-a-database-to-azure-sql-database) Базы данных SQL Server в Базу данных SQL Azure.
- Для средних и больших баз данных или при наличии проблем с подключением [используйте BACPAC-файл для переноса](#use-a-bacpac-to-migrate-a-database-to-azure-sql-database) Базы данных SQL Server в Базу данных SQL Azure. Благодаря этому методу вы можете воспользоваться SQL Server Management Studio для экспорта данных и схемы в [BACPAC](https://msdn.microsoft.com/library/ee210546.aspx#Anchor_4)-файл (хранящийся локально или в большом двоичном объекте Azure), а затем импортировать BACPAC-файл в экземпляр Azure SQL. При хранении BACPAC-файла в большом двоичном объекте Azure вы также можете импортировать этот файл на [портале Azure](sql-database-import.md) или [с помощью PowerShell](sql-database-import-powershell.md).
- В больших базах данных можно достичь повышения производительности за счет отдельного переноса схемы и данных. С помощью этого метода создайте [BACPAC-файл без данных](#use-a-bacpac-to-migrate-a-database-to-azure-sql-database) и импортируйте этот BACPAC в Базу данных SQL Azure. После импорта схемы в Базу данных SQL Azure можно использовать служебную программу [BCP](https://msdn.microsoft.com/library/ms162802.aspx) для извлечения данных в неструктурированные файлы, а затем импортировать эти файлы в Базу данных SQL Azure.

	 ![Схема миграции среды SSMS](./media/sql-database-cloud-migrate/01SSMSDiagram_new.png)

### Миграция совместимой базы данных без простоя

Если вы не можете отключить Базу данных SQL Server от рабочих процессов на время миграции, вы можете воспользоваться транзакционной репликацией SQL Server в качестве решения для миграции. При транзакционной репликации все изменения данных или схемы, происходящие в промежутке между моментом запуска миграции и моментом ее завершения отобразятся в Базе данных SQL Azure. После завершения миграции необходимо просто изменить строку подключения ваших приложений, чтобы направить их в Базу данных SQL Azure, а не в локальную базу данных. После того как транзакционная репликация применила все изменения из вашей локальной базы данных и все приложения направлены к Базе данных Azure, вы можете безопасно удалить репликацию и оставить Базу данных SQL Azure в качестве производственной системы.

 ![Диаграмма SeedCloudTR](./media/sql-database-cloud-migrate/SeedCloudTR.png)


Транзакционная репликация — это технология, встроенная и интегрированная с SQL Server, начиная с версии SQL Server 6.5. Это надежная и проверенная технология, известная большинству администраторов баз данных. В [предварительной версии SQL Server 2016](http://www.microsoft.com/server-cloud/products/sql-server-2016/) теперь можно настроить Базу данных SQL Azure в виде [подписчика транзакционной репликации](https://msdn.microsoft.com/library/mt589530.aspx) на ваши локальные публикации. Процесс настройки из среды Management Studio точно такой же, как и процесс настройки подписчика транзакционной репликации на локальном сервере. Этот сценарий поддерживается со следующими версиями SQL Server:

 - SQL Server 2016 CTP3 (предварительная версия) и выше 
 - SQL Server 2014 с пакетом обновления 1 (SP1) и накопительным пакетом обновления 3 (CU3) и выше
 - SQL Server 2014 RTM с накопительным пакетом обновления 10 (CU10) и выше
 - SQL Server 2012 с пакетом обновления 2 (SP2) и накопительным пакетом обновления 8 (CU8) и выше
 - SQL Server 2013 с пакетом обновления 3 (SP3) после выхода

Транзакционную репликацию также можно использовать для переноса части вашей локальной базы данных. Публикации, которые вы реплицируете в Базу данных SQL Azure, могут быть ограничены подмножеством таблиц в реплицируемой базе данных. Кроме того, для каждой реплицируемой таблицы можно ограничить данные подмножеством строк или подмножеством столбцов.

## Использование мастера развертывания базы данных в базу данных Microsoft Azure

Мастер развертывания базы данных в базе данных Microsoft Azure в среде SQL Server Management Studio переносит [совместимую](#determine-if-your-database-is-compatible) Базу данных SQL Server 2005 (или более поздней версии) непосредственно в экземпляр логического сервера SQL Azure.

> [AZURE.NOTE]При выполнении указанных ниже действий предполагается, что вы уже [подготовили](../sql-database-get-started.md) логический экземпляр SQL Azure и у вас есть сведения о подключении.

1. Убедитесь, что вы используете среду SQL Server Management Studio версии 13.0.600.65 или более поздней. Новые версии среды Management Studio обновляются ежемесячно для поддержания синхронизации с обновлениями портала Azure.

	 >[AZURE.IMPORTANT]Загрузите [последнюю](https://msdn.microsoft.com/library/mt238290.aspx) версию среды SQL Server Management Studio. Мы рекомендуем всегда использовать самую последнюю версию среды Management Studio.

2. Откройте среду Management Studio и подключитесь к исходной базе данных в обозревателе объектов.
3. В обозревателе объектов щелкните правой кнопкой мыши исходную базу данных, наведите указатель мыши на пункт **Задачи** и выберите команду **Развернуть базу данных в Базу данных SQL Microsoft Azure…**.

	![Развертывание в Azure из меню "Задачи"](./media/sql-database-cloud-migrate/MigrateUsingDeploymentWizard01.png)

4.	В мастере развертывания щелкните **Далее** и **Подключиться**, чтобы настроить подключение к серверу Базы данных SQL Azure.

	![Развертывание в Azure из меню "Задачи"](./media/sql-database-cloud-migrate/MigrateUsingDeploymentWizard002.png)

5. В диалоговом окне «Подключение к серверу» введите сведения о подключении, чтобы подключиться к серверу Базы данных SQL Azure.

	![Развертывание в Azure из меню "Задачи"](./media/sql-database-cloud-migrate/MigrateUsingDeploymentWizard00.png)

5.	Укажите **Имя новой базы данных** для базы данных в Базе данных SQL Azure, установите параметры **Выпуск Базы данных SQL Microsoft Azure** (уровень службы), **Максимальный размер базы данных**, **Цель обслуживания** (уровень производительности) и **Имя временного файла** для BACPAC-файла, создаваемого мастером в процессе переноса. Дополнительные сведения об уровнях обслуживания и уровнях производительности см. в статье [Уровни служб в Базе данных SQL Azure](sql-database-service-tiers.md).

	![Параметры экспорта](./media/sql-database-cloud-migrate/MigrateUsingDeploymentWizard02.png)

6.	Завершите выполнение мастера, чтобы перенести базу данных. В зависимости от размера и сложности базы данных процесс развертывания может занять от нескольких минут до нескольких часов.
7.	В обозревателе объектов подключитесь к перенесенной базе данных на сервере базы данных SQL Azure.
8.	На портале Azure просмотрите базу данных и ее свойства.

## Использование BACPAC-файла для переноса базы данных SQL Server в базу данных SQL Azure

При переносе средних и больших баз данных или при наличии проблем с подключением процесс переноса можно разделить на два отдельных этапа. Схему и ее данные можно экспортировать в [BACPAC](https://msdn.microsoft.com/library/ee210546.aspx#Anchor_4)-файл с помощью одного или двух методов.

- [Экспорт в BACPAC-файл с помощью среды SQL Server Management Studio](#export-a-compatible-sql-server-database-to-a-bacpac-file-using-sql-server-management-studio)
- [Экспорт в BACPAC-файл с помощью SqlPackage](#export-a-compatible-sql-server-database-to-a-bacpac-file-using-sqlpackage)

Этот BACPAC-файл можно сохранить локально или в большом двоичном объекте Azure. Затем можно импортировать этот BACPAC-файл в базу данных SQL Azure, используя один из методов.

- [Импорт из BACPAC-файла в базу данных SQL Azure с помощью среды SQL Server Management Studio](#import-from-a-bacpac-file-into-azure-sql-database-using-sql-server-management-studio)
- [Импорт из BACPAC-файла в базу данных SQL Azure с помощью SqlPackage](#import-from-a-bacpac-file-into-azure-sql-database-using-sqlpackage)
- [Импорт из BACPAC-файла в базу данных SQL Azure с помощью портала Azure](sql-database-import.md)
- [Импорт из BACPAC-файла в базу данных SQL Azure с помощью PowerShell](sql-database-import-powershell.md)

## Экспорт совместимой базы данных SQL Server в BACPAC-файл с помощью SQL Server Management Studio

Выполните следующие действия для экспорта переносимой [совместимой](#determine-if-your-database-is-compatible) Базы данных SQL Server в BACPAC-файл с помощью среды Management Studio.

1. Убедитесь, что вы используете среду SQL Server Management Studio версии 13.0.600.65 или более поздней. Новые версии среды Management Studio обновляются ежемесячно для поддержания синхронизации с обновлениями портала Azure.

	 >[AZURE.IMPORTANT]Загрузите [последнюю](https://msdn.microsoft.com/library/mt238290.aspx) версию среды SQL Server Management Studio. Мы рекомендуем всегда использовать самую последнюю версию среды Management Studio.

2. Откройте среду Management Studio и подключитесь к исходной базе данных в обозревателе объектов.

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/MigrateUsingBACPAC01.png)

3. В обозревателе объектов щелкните правой кнопкой мыши исходную базу данных, наведите указатель мыши на пункт **Задачи** и выберите команду **Экспорт приложения уровня данных...**.

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSSMS01.png)

4. В окне мастера экспорта настройте сохранение BACPAC-файла на локальный диск или в большой двоичный объект Azure. Экспортированный файл BACPAC всегда содержит полную схему базы данных и по умолчанию данные из всех таблиц. Воспользуйтесь вкладкой "Дополнительно", если необходимо исключить данные из некоторых или всех таблиц. Например, можно экспортировать только данные для ссылочных таблиц, а не для всех таблиц.

	![Параметры экспорта](./media/sql-database-cloud-migrate/MigrateUsingBACPAC02.png)

## Экспорт совместимой базы данных SQL Server в BACPAC-файл с помощью SqlPackage

Выполните следующие действия для экспорта переносимой [совместимой](#determine-if-your-database-is-compatible) базы данных в BACPAC-файл с помощью служебной программы командной строки [SqlPackage.exe](https://msdn.microsoft.com/library/hh550080.aspx).

> [AZURE.NOTE]При выполнении описанных ниже действий предполагается, что вы уже подготовили сервер базы данных SQL Azure, имеете сведения о подключении и проверили совместимость исходной базы данных.

1. Откройте окно командной строки и измените каталог, содержащий служебную программу командной строки sqlpackage.exe. Эта служебная программа поставляется в комплекте с Visual Studio и SQL Server.
2. Выполните следующую команду sqlpackage.exe со следующими аргументами для вашей среды:

	'sqlpackage.exe /Action:Export /ssn:< server_name > /sdn:< database_name > /tf:< target_file >

	| Аргумент | Описание |
	|---|---|
	| < server_name > | имя исходного сервера |
	| < database_name > | имя исходной базы данных |
	| < target_file > | имя файла и расположение для файла BACPAC |

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSQLPackage01b.png)

## Импорт из BACPAC-файла в базу данных SQL Azure с помощью среды SQL Server Management Studio

Выполните описанные ниже действия для импорта из BACPAC-файла в базу данных SQL Azure.

> [AZURE.NOTE]При выполнении указанных ниже действий предполагается, что вы уже подготовили логический экземпляр SQL Azure и у вас есть сведения о подключении.

1. Убедитесь, что вы используете среду SQL Server Management Studio версии 13.0.600.65 или более поздней. Новые версии среды Management Studio обновляются ежемесячно для поддержания синхронизации с обновлениями портала Azure.

	> [AZURE.IMPORTANT]Загрузите [последнюю](https://msdn.microsoft.com/library/mt238290.aspx) версию среды SQL Server Management Studio. Мы рекомендуем всегда использовать самую последнюю версию среды Management Studio.

2. Откройте среду Management Studio и подключитесь к исходной базе данных в обозревателе объектов.

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/MigrateUsingBACPAC01.png)

3. После создания BACPAC-файла подключитесь к серверу Базы данных SQL Azure, щелкните правой кнопкой мыши папку **базы данных** и выберите команду **Импорт приложения уровня данных...**.

    ![Импорт пункта меню приложения уровня данных](./media/sql-database-cloud-migrate/MigrateUsingBACPAC03.png)

4.	В мастере импорта выберите файл BACPAC-файл, который вы экспортировали, для создания новой базы данных в Базе данных SQL Azure.

    ![Импорт параметров](./media/sql-database-cloud-migrate/MigrateUsingBACPAC04.png)

5.	Укажите **Имя новой базы данных** для базы данных в Базе данных SQL Azure, установите параметры **Выпуск Базы данных SQL Microsoft Azure** (уровень службы), **Максимальный размер базы данных** и **Цель обслуживания** (уровень производительности).

    ![Параметры базы данных](./media/sql-database-cloud-migrate/MigrateUsingBACPAC05.png)

6.	Нажмите кнопку **Далее**, а затем кнопку **Готово** для импорта BACPAC-файла в новую базу данных на сервере Базы данных SQL Azure.

7. В обозревателе объектов подключитесь к перенесенной базе данных на сервере базы данных SQL Azure.

8.	На портале Azure просмотрите базу данных и ее свойства.

## Импорт из BACPAC-файла в базу данных SQL Azure с помощью SqlPackage

Выполните следующие действия для импорта совместимой базы данных SQL Server (или Базы данных SQL Azure) из BACPAC-файла с помощью служебной программы командной строки [SqlPackage.exe](https://msdn.microsoft.com/library/hh550080.aspx).

> [AZURE.NOTE]При выполнении указанных ниже действий предполагается, что вы уже подготовили сервер базы данных SQL Azure и имеете сведения о подключении.

1. Откройте окно командной строки и измените каталог, содержащий служебную программу командной строки sqlpackage.exe. Эта служебная программа поставляется в комплекте с Visual Studio и SQL Server.
2. Выполните следующую команду sqlpackage.exe со следующими аргументами для вашей среды:

	'sqlpackage.exe /Action:Import /tsn:< server_name > /tdn:< database_name > /tu:< user_name > /tp:< password > /sf:< source_file >

	| Аргумент | Описание |
	|---|---|
	| < server_name > | имя конечного сервера |
	| < database_name > | имя конечной базы данных |
	| < user_name > | имя пользователя на конечном сервере |
	| < password > | пароль пользователя |
	| < source_file > | имя файла и расположение импортируемого файла BACPAC |

	![Экспорт приложения уровня данных из меню "Задачи"](./media/sql-database-cloud-migrate/TestForCompatibilityUsingSQLPackage01c.png)


## Устранение проблем совместимости базы данных

Есть несколько способов устранения проблем совместимости исходной Базы данных SQL Server, которые были [обнаружены ранее](#determine-if-your-database-is-compatible).

- Используйте [мастер миграции SQL Azure](http://sqlazuremw.codeplex.com/). Это средство Codeplex можно использовать для создание сценария T-SQL из несовместимой исходной базы данных, который затем преобразуется мастером, чтобы сделать его совместимым с базой данных SQL, а затем подключить к базе данных SQL Azure для выполнения сценария. Это средство также будет анализировать файлы трассировки, чтобы определить проблемы совместимости. Сценарии могут создаваться только со схемой или могут содержать данные в формате BCP. Дополнительная документация, в том числе пошаговые инструкции, доступна на сайте Codeplex в разделе [Мастер миграции SQL Azure](http://sqlazuremw.codeplex.com/).  

 ![Схема переноса SAMW](./media/sql-database-cloud-migrate/02SAMWDiagram.png)

 >[AZURE.NOTE]Обратите внимание, что не все несовместимые схемы, которые могут быть обнаружены с помощью мастера, подлежат обработке с помощью его встроенных средств преобразования. Если имеются несовместимые сценарии, которые не удается обработать, то о них будет сообщено как об ошибках. Такие сценарии будут внедрены в созданный сценарий с соответствующими комментариями. Если обнаружено много ошибок, используйте Visual Studio или SQL Server Management Studio для исправления каждой ошибки, которую невозможно исправить с помощью мастера миграции SQL Server.

- Используйте Visual Studio. Visual Studio можно использовать для импорта схемы базы данных в проект базы данных Visual Studio для анализа. Для анализа укажите целевую платформу для проекта как Базу данных SQL версии 12, а затем соберите проект. Если построение выполнено успешно, база данных совместима. Если построение завершается неудачей, можно устранить ошибки в SQL Server Data Tools для Visual Studio (SSDT). После успешного построения проекта, вы можете опубликовать его в качестве копии базы данных-источника, а затем использовать функцию сравнения данных в SSDT, чтобы скопировать данные из базы данных-источника в базу данных, совместимую с SQL Azure версии 12. Затем развертывание обновленной базы данных в Базе данных SQL Azure выполняется по плану, [описанному ранее](#options-to-migrate-a-compatible-database-to-azure-sql-database).

 ![Схема переноса VSSSDT](./media/sql-database-cloud-migrate/03VSSSDTDiagram.png)

 >[AZURE.NOTE]Если требуется перенести только схему, можно опубликовать ее в Базе данных SQL Azure непосредственно из Visual Studio. Этот метод используется, если схема баз данных требует больше изменений, чем может обработать мастер миграции.

- SQL Server Management Studio. Исправить ошибки можно в среде Management Studio с помощью команд Transact-SQL, таких как **ALTER DATABASE**.

<!---HONumber=Nov15_HO2-->