<properties
	pageTitle="Создание пула эластичных баз данных для базы данных SQL и управление им | Microsoft Azure"
	description="Создайте один пул ресурсов и используйте его в нескольких группах баз данных SQL Azure."
	services="sql-database"
	documentationCenter=""
	authors="stevestein"
	manager="jeffreyg"
	editor=""/>

<tags
	ms.service="sql-database"
	ms.devlang="NA"
	ms.date="08/13/2015"
	ms.author="sstein"
	ms.workload="data-management"
	ms.topic="article"
	ms.tgt_pltfrm="NA"/>


# Создание пула эластичных баз данных для базы данных SQL Azure и управление им

> [AZURE.SELECTOR]
- [Azure portal](sql-database-elastic-pool-portal.md)
- [C#](sql-database-client-library.md)
- [PowerShell](sql-database-elastic-pool-powershell.md)

В этой статье описано, как создать пул эластичных баз данных с помощью [портала предварительной версии Azure](https://portal.azure.com).

Пулы эластичных баз данных позволяют упростить процессы создания и обслуживания большого количества баз данных, а также контролировать их производительность и связанные с ними затраты.


> [AZURE.NOTE]Сейчас пулы эластичных баз данных предоставляются в виде предварительной версии, которая доступна только с серверами Базы данных SQL версии 12.




## Предварительные требования

Чтобы создать пул эластичных баз данных, вам потребуется:

- Подписка Azure. Если вам требуется подписка Azure, нажмите в верхней части этой страницы кнопку **БЕСПЛАТНАЯ ПРОБНАЯ ВЕРСИЯ**. Оформив подписку, вернитесь к этой статье.
- Сервер баз данных SQL Azure версии 12. Если у вас отсутствует сервер V12, создайте его в соответствии с инструкциями в следующей статье: [Создание первой базы данных SQL Azure](sql-database-get-started.md).



## Создание пула эластичных баз данных

Создайте пул эластичных баз данных путем добавления нового пула на сервер. На сервер можно добавить несколько пулов, но с каждым из них может быть связан только один (1) сервер. Кроме того, в пул можно добавить все или только некоторые базы данных на сервере.


1.	Выберите сервер баз данных SQL версии 12, содержащий базы, которые нужно добавить в пул.
2.	Создайте пул, нажав в верхней части колонки **SQL Server** кнопку **Добавить пул**.

   ![Создание эластичного пула][1]

## Настройка пула эластичных баз данных

Настройте пул, указав ценовую категорию, добавив базы данных и определив параметры производительности.

> [AZURE.NOTE]При выборе команды **Добавить пул** необходимо принять условия предоставления предварительной версии, выбрав пункт **УСЛОВИЯ ПРЕДВАРИТЕЛЬНОЙ ВЕРСИИ**, и заполнить содержимое колонки **Условия предварительной версии**. Условия принимаются только один раз для каждой подписки.

   ![Настройка эластичного пула][2]

## Настройка ценовой категории

Ценовая категория пула эластичных баз данных определяет функции, которые будут доступны для эластичных баз данных в пуле, максимальное количество единиц eDTU (eDTU MAX) и объем хранилища (в гигабайтах) для каждой базы данных. Дополнительные сведения см. в разделе [eDTU и размеры хранилища для эластичных пулов и эластичных баз данных](sql-database-elastic-pool-reference.md#edtu-and-storage-limits-for-elastic-pools-and-elastic-databases).

>[AZURE.NOTE]В настоящее время в предварительной версии недоступна возможность изменить ценовую категорию пула эластичных баз данных после ее создания. Чтобы изменить ценовую категорию для существующего пула эластичных баз данных, создайте пул эластичных баз данных в нужной ценовой категории и перенесите эластичные базы данных в этот пул.

   ![Ценовая категория][9]


## Рекомендации по выбору ценовой категории для пула эластичных баз данных

Служба Базы данных SQL оценивает историю использования и рекомендует один или несколько пулов эластичных баз данных, когда это более экономично по сравнению с использованием отдельных баз данных. Ценовые категории, отмеченные звездочкой (![звезда][10]), рекомендуются на основе рабочей нагрузки на базы данных.

Если рекомендуется несколько ценовых категорий, это означает, что следует создать несколько пулов эластичных баз данных. Для предоставления каждой рекомендации используется уникальное подмножество баз данных на сервере, которое лучше всего подходит для формирования пула.

Помимо простого предложения ценовой категории пула эластичных баз данных каждая рекомендация пула содержит следующие элементы:

- ценовая категория для пула (Basic, Standard или Premium);
- соответствующий объем единиц eDTU пула;
- минимальные и максимальные настройки единиц eDTU для БД;  
- список рекомендуемых баз данных.

При рекомендации пула эластичных баз данных служба учитывает данные телеметрии за последние 30 дней. Чтобы база данных рассматривалась для включения в пул эластичных баз данных, она должна существовать не менее 7 дней. Базы данных, которые уже находятся в пуле эластичных баз данных, не рассматриваются в качестве кандидатов для рекомендуемого добавления в пул.

Служба оценивает потребность в ресурсах и экономичность перемещения каждой отдельной базы данных на каждом уровне службы в пулы эластичных баз данных того же уровня. Например, все базы данных Standard на сервере оцениваются на предмет возможности их добавления в пул эластичных баз данных уровня Standard. Это означает, что служба не предоставляет кросс-уровневые рекомендации, такие как перемещение базы данных Standard в пул Premium.

>[AZURE.NOTE]Базы данных уровней Web и Business сопоставляются с одним из новых уровней Basic, Standard или Premium на основе истории их использования и размера базы данных. При сопоставлении с новыми уровнями базы данных уровней Web и Business рекомендуются для подходящего пула.


### Добавление баз данных

Базы данных, которые нужно добавить в пул, можно выбрать в любой момент. При создании нового пула служба Azure рекомендует базы данных, которые можно включить в пул, и автоматически отмечает их для добавления. В пул можно добавить все базы данных на сервере или же добавить только часть из исходного списка.

   ![Добавление баз данных][5]

При добавлении баз данных в пул необходимо учитывать следующее:

- В пуле должно быть место для добавляемой базы данных (следите за максимальным количеством баз данных в пуле). В частности, пул должен иметь достаточное количество единиц eDTU, чтобы обеспечить гарантированное количество единиц eDTU для каждой базы данных (например, если для группы гарантированное количество единиц eDTU равно 400, а для каждой базы данных — 10, то максимальное количество баз данных в пуле равно 40 (400 eDTU / 10 eDTU = 40 баз данных).
- В пуле должны быть доступны все функции, которые используются в базе данных.


### Настройка производительности

При настройке производительности пула вы задаете параметры быстродействия как для пула, так и для эластичных баз данных в нем. Помните, что **параметры эластичных баз данных** влияют на все базы данных в пуле.

   ![Настройка эластичного пула][3]

Производительность пула определяется тремя настраиваемыми параметрами: гарантированным количеством eDTU для пула и eDTU MIN и eDTU MAX для эластичных баз данных в пуле. В таблице ниже приведено описание каждого из этих параметров, а также рекомендации по их настройке. Параметры для определенного доступного значения см. в [справочнике по пулу эластичных баз данных](sql-database-elastic-pool-reference.md).

| Параметр производительности | Описание |
| :--- | :--- |
| **POOL eDTU** — гарантированное количество eDTU для пула | Гарантированное количество eDTU для пула — это гарантированное количество единиц eDTU, которые совместно используются всеми базами данных в пуле. <br> Гарантированное количество eDTU для группы следует задавать, исходя из статистических данных об использовании единиц eDTU в группе. Этот параметр также можно определить, исходя из требуемого гарантированного количества eDTU на базу данных и количества одновременно используемых баз. Гарантированное количество eDTU для пула также коррелирует с объемом хранилища пула: на каждую единицу передаваемых данных, которую вы выделяете для пула, вы получаете фиксированный объем хранилища базы данных. <br> **Какое значение нужно установить для гарантированного количества eDTU для пула?** <br>Минимальное значение можно определить по такой формуле: [количество баз данных] x [среднее количество используемых DTU на одну базу данных]. |
| **eDTU MIN** — гарантированное количество eDTU для каждой базы данных | Гарантированное количество eDTU на базу данных — это количество единиц eDTU, которое гарантируется отдельной базе данных в пуле. Например, в пулах уровня Standard для этого параметра можно задавать значения 0, 10, 20, 50 или 100. Значение 0 означает, что для баз данных в группе не установлено гарантированное количество eDTU. <br> **Какое значение нужно установить для гарантированного количества eDTU на базу данных?** <br>Как правило, гарантированное количество eDTU на базу данных (eDTU MIN) может быть любым числом в диапазоне от 0 до ([среднее использование на одну базу данных]). Гарантированное количество eDTU на базу данных — глобальный параметр, который влияет на все базы данных пула. |
| **eDTU MAX** — максимально возможное количество eDTU для одной базы данных | eDTU MAX для базы данных — это максимальное число единиц eDTU, которое может использовать отдельная база данных в пуле. Максимальное количество eDTU для одной базы данных должно быть достаточно большим, чтобы позволить ей обрабатывать пиковые количества запросов. Для этого параметра можно установить максимально возможное значение, которое зависит от ценовой категории пула (1000 eDTU для категории Premium). Значение этого параметра должно позволить базам данных в группе выдерживать пиковые нагрузки. Значение параметра для группы рекомендуется немного увеличить, так как использование пула предполагает обращение к более и менее активным базам данных в условиях, когда не все базы одновременно обрабатывают пиковое количество запросов.<br> **Какое ограничение на количество eDTU нужно установить для каждой базы данных?** <br> Установите ограничение на количество eDTU (eDTU MAX) в размере пиковой нагрузки на базу данных. Предположим, например, что пиковая нагрузка одной базы данных равна 50 DTU и только 20 % из 100 баз данных в группе одновременно работают с такой нагрузкой. Если в качестве максимального количества eDTU на базу данных задано значение 50, то для группы (POOL eDTU) целесообразно увеличить гарантированное количество eDTU в 5 раз (1000 eDTU). Кроме того, обратите внимание, что максимальное количество eDTU не следует рассматривать как гарантированное количество ресурсов для базы данных. Это всего лишь значение, которое может быть достигнуто в случае наличия свободных ресурсов. |


## Добавление баз данных в пул эластичных баз данных

Создав пул, вы можете добавлять в него базы данных, а также удалять их из него. Для этого установите или снимите флажки для требуемых баз данных на странице **Добавление баз данных**.


## Мониторинг пула эластичных баз данных и управление им

Создав пул эластичных баз данных, вы можете отслеживать его и управлять им прямо на портале. Для этого нужно открыть список существующих пулов и выбрать нужный пул.

В созданном пуле появляется ряд возможностей.

- **Настроить пул**. Позволяет изменять количество DTU для пула и одной базы данных.
- **Создать задание**. Позволяет управлять базами данных в пуле путем создания эластичных заданий. Эластичные задания позволяют легко и быстро выполнять скрипты Transact-SQL в любом количестве баз данных в пуле. Дополнительные сведения см. в статье [Обзор службы заданий эластичной базы данных](sql-database-elastic-jobs-overview.md).
- **Управление заданиями**. Позволяет администрировать существующие эластичные задания.



![Мониторинг эластичного пула][8]




![Мониторинг эластичного пула][4]

При выборе существующего пула появляются сведения об использовании его ресурсов. Щелкните диаграмму **Использование ресурсов**, чтобы открыть колонку **Метрика**. Здесь можно настроить отображение диаграммы и задать параметры оповещений.


![Использование ресурсов][6]

Щелкните **Изменить диаграмму** и добавьте нужные параметры. Это позволит быстро просматривать данные телеметрии для этого пула.


![Изменение диаграммы][7]




## Дальнейшие действия
После создания пула эластичных баз данных вы можете управлять эластичными базами данных в пуле путем создания заданий обработки эластичных баз данных. Эластичные задания позволяют легко и быстро выполнять скрипты Transact-SQL в любом количестве баз данных в пуле. Дополнительные сведения можно узнать в статье [Обзор службы заданий эластичной базы данных](sql-database-elastic-jobs-overview.md).



## Дополнительные ресурсы

- [Эластичный пул баз данных SQL](sql-database-elastic-pool.md)
- [Создание эластичного пула баз данных SQL с помощью PowerShell](sql-database-elastic-pool-powershell.md)
- [Создание Базы данных SQL и управление ей с помощью C#](sql-database-client-library.md)
- [Справка по эластичным базам данных](sql-database-elastic-pool-reference.md)


<!--Image references-->
[1]: ./media/sql-database-elastic-pool-portal/new-elastic-pool.png
[2]: ./media/sql-database-elastic-pool-portal/configure-elastic-pool.png
[3]: ./media/sql-database-elastic-pool-portal/configure-performance.png
[4]: ./media/sql-database-elastic-pool-portal/monitor-elastic-pool.png
[5]: ./media/sql-database-elastic-pool-portal/add-databases.png
[6]: ./media/sql-database-elastic-pool-portal/metric.png
[7]: ./media/sql-database-elastic-pool-portal/edit-chart.png
[8]: ./media/sql-database-elastic-pool-portal/configure-pool.png
[9]: ./media/sql-database-elastic-pool-portal/pricing-tier.png
[10]: ./media/sql-database-elastic-pool-portal/star.png

<!---HONumber=August15_HO8-->