<properties 
	title="Elastic database jobs overview" 
	pageTitle="Обзор заданий обработки эластичных баз данных" 
	description="Описание службы заданий обработки эластичных баз данных" 
	metaKeywords="azure sql database elastic databases" 
	services="sql-database" documentationCenter=""  
	manager="jeffreyg" 
	authors="sidneyh"/>

<tags 
	ms.service="sql-database" 
	ms.workload="sql-database" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="07/21/2015" 
	ms.author="ddove; sidneyh" />

# Обзор заданий обработки эластичных баз данных

**Задания эластичной базы данных** позволяют надежно выполнять скрипт Transact-SQL (T-SQL) или применять DACPAC к группе баз данных, включая настраиваемую коллекцию баз данных, все базы данных в [пуле эластичных баз данных (предварительная версия)](sql-database-elastic-pool.md) или набор сегментов (созданный с помощью [клиентской библиотеки эластичных баз данных](sql-database-elastic-database-client-library.md)). В предварительной версии **задания обработки эластичных баз данных** являются размещаемой у клиента облачной службой Azure, которая позволяет выполнять динамические и запланированные административные задачи, которые называются заданиями. С помощью этой функции можно без проблем управлять Базой данных SQL Azure в целой группе баз данных, запуская сценарии Transact-SQL для выполнения таких административных задач, как смена схем, управление учетными данными, обновления ссылочных данных, сбор данных о производительности и сбор телеметрии клиентов. Как правило, чтобы выполнять инструкции Transact-SQL или другие административные задачи, к каждой базе данных необходимо подключаться отдельно. Служба **заданий обработки эластичных баз данных** автоматически обрабатывает задачу входа, корректно выполняет сценарий и записывает в журнал данные о состоянии выполнения для каждой базы данных. Инструкции по установке см. в статье [Установка компонентов службы заданий обработки эластичных баз данных](sql-database-elastic-jobs-service-installation.md).

![Служба заданий обработки эластичных баз данных][1]

## Преимущества
* Определение пользовательских групп в Базах данных SQL Azure
* Определение, поддержка и сохранение сценариев Transact-SQL, которые могут выполняться в группе баз данных SQL Azure. 
* Развертывание приложения на уровне данных (DACPAC)
* Выполнение сценариев Transact-SQL и надежное применение файлов DACPAC с автоматическими повторными попытками и в широких масштабах
* Отслеживание состояний выполнения заданий.
* Определение расписаний выполнения
* Сбор данных из семейства баз данных SQL Azure с сохранением результатов в одну целевую таблицу

> [AZURE.NOTE]Функции **заданий обработки эластичных баз данных** на портале Azure ограничены пулами эластичных баз данных SQL Azure. Чтобы получить полный набор доступных на данный момент возможностей, используйте API-интерфейсы PowerShell.

## Сценарии

* Выполнение административных задач, таких как развертывание новой схемы.
* Обновление эталонных данных (например, сведений о продукте, общих для всех баз данных) и использование расписаний для автоматизации обновлений каждый будний день после работы.
* Перестроение индексов для повышения скорости обработки запросов. Вы можете настроить регулярное перестроение в семействе баз данных, например во время низкой нагрузки.
* Собирайте результаты запросов из набора баз данных в центральную таблицу на постоянной основе. Запросы производительности могут выполняться непрерывно и вызывать дополнительные задачи.
* Выполняйте запросы обработки данных с повышенным временем выполнения для большого набора баз данных, например коллекции телеметрии клиентов. Результаты собираются в одну целевую таблицу для дальнейшего анализа.

## Простой просмотр заданий обработки эластичных баз данных
1.	Установка компонентов **заданий обработки эластичных баз данных**. Дополнительные сведения см. в статье [Установка заданий обработки эластичных баз данных](sql-database-elastic-jobs-service-installation.md). Если во время установки произошла ошибка, [удалите установленные компоненты](sql-database-elastic-jobs-uninstall.md).
2.	Используйте API-интерфейсы PowerShell, чтобы получить дополнительные возможности, например создание пользовательских семейств баз данных, добавление расписаний и/или сбор наборов результатов. Используйте портал для простой установки, а также создания и отслеживания заданий, выполнение которых ограничено **пулом эластичных баз данных**. 
3.	Создавайте зашифрованные учетные данные для выполнения задач [добавьте пользователя (или роль) к каждой базе данных в группе](sql-database-elastic-jobs-add-logins-to-dbs.md).
4.	Создайте сложный сценарий T-SQL, который можно запускать для каждой базы данных в группе.
5.	Для запуска сценария выполните следующие действия: [Создание заданий обработки эластичных баз данных и управление ими](sql-database-elastic-jobs-create-and-manage.md) 

## Компоненты и цены 
Ниже перечислены компоненты, которые вместе формируют облачную службу Azure, позволяющую в любой момент выполнять административные задания. Компоненты устанавливаются и настраиваются в вашей подписке автоматически во время установки. Эти службы можно легко идентифицировать — все они имеют одно и тоже автоматически сгенерированное уникальное имя, которое состоит из префикса edj и 21 произвольного символа.

* **Облачная служба Azure**. Служба заданий обработки эластичных баз данных (предварительная версия) поставляется как облачная служба Azure, размещаемая клиентом для выполнения требуемых задачи. На портале служба развертывается и размещается в вашей подписке Microsoft Azure. По умолчанию развернутая служба выполняется как минимум с двумя рабочими ролями, что обеспечивает высокую доступность службы. Каждая роль стандартного размера (ElasticDatabaseJobWorker) работает на экземпляре A0. Сведения о ценах на облачные службы см. [здесь](http://azure.microsoft.com/pricing/details/cloud-services/). 
* **База данных SQL Azure**. Также называется **управляющей базой данных**. Используется для хранения всех метаданных заданий. По умолчанию используется уровень служб S0. Сведения о ценах на базы данных SQL см. [здесь](http://azure.microsoft.com/pricing/details/sql-database/).
* **Служебная шина Azure**. Используется для координации работы в облачной службе Azure. Сведения о ценах на служебную шину см. [здесь](http://azure.microsoft.com/pricing/details/service-bus/).
* **Хранилище Azure**. Для хранения диагностических сведений используется учетная запись хранилища Azure. Эти данные могут понадобиться в случае, если для решения проблемы потребуется дальнейшая отладка (общепринятая практика для [системы диагностики Azure](../cloud-services-dotnet-diagnostics.md)). Сведения о ценах на хранилище Azure см. [здесь](http://azure.microsoft.com/pricing/details/storage/).

## Как работают задания обработки эластичных баз данных
1.	Базе данных SQL Azure назначается управляющая база данных, в которой хранятся все метаданные и сведения о состоянии.
2.	Служба **заданий обработки эластичных баз данных** обращается к управляющей базе данных для запуска и отслеживания выполняемых заданий.
3.	С управляющей базой данных связываются две роли: 
	* Контроллер: определяет, каким заданиям для выполнения требуются задачи, и повторно запускает невыполненные задания, создавая новые задачи.
	* Выполнение задач: выполняет задачи.

### Типы задач
Существует несколько типов задач, которые выполняют задания:

* ShardMapRefresh: отправляет карте сегментов запрос, чтобы определить все базы данных, используемые как сегменты
* ScriptSplit: разбивает сценарий на группы между инструкциями GO
* ExpandJob: создает дочерние задачи для каждой базы данных из задачи, которая направлена на группу баз данных
* ScriptExecution: выполняет сценарий для определенной базы данных с использованием заданных учетных данных
* Dacpac: применяет DACPAC к определенной базе данных с использованием определенных учетных данных

## Рабочий процесс выполнения заданий
1.	С помощью портала или API PowerShell задание вставляется в **управляющую базу данных**. Задание требует выполнения сценарий Transact-SQL для группы баз данных с использованием определенных учетных данных.
2.	Контроллер определяет новое задание. Создаются и выполняются задачи для разделения сценария и обновления баз данных группы. Напоследок создается и выполняется новое задание для расширения задания и создания дочерних заданий, каждое из которых выполняет сценарий Transact-SQL для отдельной базы данных в группе.
3.	Контроллер определяет созданные дочерние задания. Для каждого задания контроллер создает и запускает задачу для выполнения сценария в базе данных. 
4.	После завершения задач контроллер задает состояние завершения заданий. Во время выполнения задания в любой момент можно использовать API PowerShell для просмотра текущего состояния его выполнения. Время, возвращаемое API-интерфейсами PowerShell, представлено в формате UTC. При желании можно отправить запрос на отмену, чтобы остановить задание. 

## Дальнейшие действия
[Установите компоненты](sql-database-elastic-jobs-service-installation.md) и [добавьте учетные данные для входа для каждой базы данных в группе](sql-database-elastic-jobs-add-logins-to-dbs.md). Дополнительные сведения о создании заданий и управлении ими см. в статье [Создание заданий обработки эластичных баз данных и управление ими](sql-database-elastic-jobs-create-and-manage.md).

[AZURE.INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]: ./media/sql-database-elastic-jobs-overview/elastic-jobs.png
<!--anchors-->

<!---HONumber=Nov15_HO1-->