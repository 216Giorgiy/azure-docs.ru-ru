<properties 
   pageTitle="Разработка базы данных SQL с учетом требований непрерывности бизнес-процессов" 
   description="Рекомендации по выбору. В этом разделе представлены рекомендации по выбору функций аварийного восстановления и обеспечения непрерывности бизнес-процессов. Также описаны возможности, предоставляемые для всех баз данных SQL автоматически."
   services="sql-database" 
   documentationCenter="" 
   authors="elfisher" 
   manager="jhubbard" 
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-management" 
   ms.date="04/25/2016"
   ms.author="elfish"/>

#Разработка с учетом требований непрерывности бизнес-процессов

Чтобы разработать приложение с учетом требований непрерывности бизнес-процессов, вам нужно ответить на следующие вопросы:

1. Какая функция обеспечения непрерывности бизнес-процессов подходит для защиты вашего приложения в случае сбоя?
2. Какой уровень избыточности и какую топологию репликации вы используете?

##Когда следует использовать геовосстановление

База данных SQL по умолчанию обеспечивает базовую защиту каждой базы данных. Ее суть состоит в хранении резервных копий баз данных в геоизбыточном хранилище Azure. Такая защита не требует специальной настройки или выделения дополнительных ресурсов. Используя резервные копии, вы можете восстановить базу данных в любом регионе с помощью команды геовосстановления. Для получения дополнительных сведений о геовосстановлении приложения см. статью [Восстановление после сбоя](sql-database-disaster-recovery.md).

Встроенную защиту следует использовать в том случае, если приложение удовлетворяет следующим требованиям:

1. Приложение не является критически важным. На него не распространяется действие соглашений об уровне обслуживания; перерыв в работе на 24 часа и более не повлечет финансовых последствий.
2. Скорость изменения данных низкая (например, количество транзакций в час). При RPO в 1 час не будут утрачены большие объемы данных.
3. Бюджет приложения ограничен и не предусматривает дополнительных расходов на георепликацию. 

> [AZURE.NOTE] Геовосстановление не предусматривает предварительного выделения вычислительных ресурсов в каком-либо конкретном регионе для восстановления активных баз данных из резервной копии во время сбоя. Чтобы уменьшить воздействие на уже развернутые в регионе базы данных, служба будет управлять нагрузкой, связанной с запросами на геовосстановление. Ранее развернутые базы данных будут получать вычислительные ресурсы в приоритетном порядке. Поэтому время восстановления вашей базы данных будет зависеть от того, сколько других баз данных будет проходить процедуру восстановления в том же регионе одновременно с вашей.

##Когда следует использовать георепликацию

Функция георепликации создает реплику базы данных (базу данных-получатель) в регионе, отличном от того, где развернута основная база данных. Это гарантирует, что после восстановления у вашей базы данных будет достаточно данных и вычислительных ресурсов, чтобы поддержать рабочую нагрузку приложения. Дополнительные сведения об отработке отказа см. в статье [Восстановление после сбоя](sql-database-disaster-recovery.md).

Георепликацию следует использовать в том случае, если ваше приложение удовлетворяет следующим требованиям:

1. Оно является критически важным. На него распространяется действие соглашения об уровне обслуживания с высокими требованиями к RPO и RTO. Потеря данных и понижение уровня обслуживания приведут к финансовым последствиям. 
2. Высокая скорость изменения данных (например, количество транзакций в минуту или за несколько секунд). Значение RPO в 1 час, предлагаемое в рамках стандартной защиты, приведет к потере слишком большого объема данных.
3. Затраты, связанные с георепликацией, значительно ниже, чем потенциальные убытки или риск потери клиентов.


> [AZURE.NOTE] Активная георепликация также поддерживает доступ только для чтения к базе данных-получателю, предоставляя дополнительные вычислительные ресурсы для операций чтения.

##Как включить георепликацию

Георепликацию можно включить тремя способами: с помощью классического портала Azure, REST API или команды PowerShell.

###Портал Azure

[AZURE.VIDEO sql-database-enable-geo-replication-in-azure-portal]

1. Войдите на [портал Azure](https://portal.Azure.com).
2. В левой части экрана выберите **ОБЗОР**, а затем — **Базы данных SQL**.
3. В колонке вашей базы данных выберите **Карта георепликации** и нажмите кнопку **Настроить георепликацию**.
4. Перейдите к колонке "Георепликация". Выберите целевой регион. 
5. Перейдите к колонке "Создание базы данных-получателя". Выберите существующий сервер в целевом регионе или создайте новый.
6. Выберите тип базы данных-получателя (*Доступно для чтения* или *Недоступно для чтения*).
7. Щелкните **Создать**, чтобы завершить настройку.

> [AZURE.NOTE] Связанный регион для аварийного восстановления будет отмечен как *рекомендуемый* в колонке "Георепликация", но при желании можно выбрать другой регион.


###PowerShell

Чтобы создать конфигурацию георепликации, используйте командлет PowerShell [New-AzureRmSqlDatabaseSecondary](https://msdn.microsoft.com/library/mt603689.aspx). Эта синхронная команда, которая возвращает результат, когда база данных-источник и база данных-получатель синхронизированы.

Чтобы настроить георепликацию с недоступной для чтения базой данных-получателем, выполните следующие действия:
		
    $database = Get-AzureRmSqlDatabase –DatabaseName "mydb"
    $secondaryLink = $database | New-AzureRmSqlDatabaseSecondary –PartnerResourceGroupName "rg2" –PartnerServerName "srv2" -AllowConnections "None"

Чтобы настроить георепликацию с доступной для чтения базой данных-получателем, выполните следующие действия:

    $database = Get-AzureRmSqlDatabase –DatabaseName "mydb"
    $secondaryLink = $database | New-AzureRmSqlDatabaseSecondary –PartnerResourceGroupName "rg2" –PartnerServerName "srv2" -AllowConnections "All"
		 

###Интерфейс REST API 

Используйте API [Create Database](https://msdn.microsoft.com/library/mt163685.aspx) с *createMode* со значением *NonReadableSecondary* или *Secondary*, чтобы программно создать базу данных-получатель георепликации.

Эта команда является асинхронной. После ее завершения проверьте состояние операции, используя API [Get Replication Link](https://msdn.microsoft.com/library/mt600778.aspx). В случае выполнения поле *replicationState* в теле ответа будет иметь значение CATCHUP.


##Как выбрать конфигурацию отработки отказа 

При разработке приложений с учетом требований непрерывности бизнес-процессов следует рассмотреть несколько вариантов конфигурации. Выбор будет зависеть от топологии развертывания приложения и того, какие его компоненты больше всего пострадают в случае сбоя. Подробные инструкции и рекомендации см. в статье [Разработка облачных решений для аварийного восстановления с помощью георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md).

<!---HONumber=AcomDC_0504_2016-->