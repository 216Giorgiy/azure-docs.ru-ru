<properties 
   pageTitle="Разработка базы данных SQL с учетом требований непрерывности бизнес-процессов" 
   description="Рекомендации по выбору. В этом разделе представлены рекомендации по выбору функций аварийного восстановления и обеспечения непрерывности бизнес-процессов. Также описаны возможности, предоставляемые для всех баз данных SQL автоматически."
   services="sql-database" 
   documentationCenter="" 
   authors="elfisher" 
   manager="jeffreyg" 
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-management" 
   ms.date="04/13/2015"
   ms.author="elfish"/>

#Разработка с учетом требований непрерывности бизнес-процессов

Чтобы разработать приложение с учетом требований непрерывности бизнес-процессов, вам нужно ответить на следующие вопросы:

1. Какая функция обеспечения непрерывности бизнес-процессов подходит для защиты вашего приложения в случае сбоя?
2. Какой уровень избыточности и какую топологию репликации вы используете?

##Когда следует использовать геовосстановление

База данных SQL по умолчанию обеспечивает базовую защиту каждой базы данных. Ее суть состоит в хранении резервных копий баз данных в геоизбыточном хранилище Azure. Такая защита не требует специальной настройки или выделения дополнительных ресурсов. Используя резервные копии, вы можете восстановить базу данных в любом регионе с помощью команды геовосстановления. Для получения дополнительных сведений о геовосстановлении приложения см. статью [Восстановление после сбоя](sql-database-disaster-recovery.md).

Встроенную защиту следует использовать в том случае, если приложение удовлетворяет следующим требованиям:

1. Приложение не является критически важным. На него не распространяется действие соглашений об уровне обслуживания; перерыв в работе на 24 часа и более не повлечет финансовых последствий.
2. Скорость изменения данных низкая (например, количество транзакций в час). При RPO в 1 час не будут утрачены большие объемы данных.
3. Бюджет приложения ограничен и не предусматривает дополнительных расходов на георепликацию. 

> [AZURE.NOTE]Геовосстановление не предусматривает предварительного выделения вычислительных ресурсов в каком-либо конкретном регионе для восстановления активных баз данных из резервной копии во время сбоя. Чтобы уменьшить воздействие на уже развернутые в регионе базы данных, служба будет управлять нагрузкой, связанной с запросами на геовосстановление. Ранее развернутые базы данных будут получать вычислительные ресурсы в приоритетном порядке. Поэтому время восстановления вашей базы данных будет зависеть от того, сколько других баз данных будет проходить процедуру восстановления в том же регионе одновременно с вашей.

##Когда следует использовать георепликацию

Функция георепликации создает реплику базы данных (базу данных-получатель) в регионе, отличном от того, где развернута основная база данных. Это гарантирует, что после восстановления у вашей базы данных будет достаточно данных и вычислительных ресурсов, чтобы поддержать рабочую нагрузку приложения. Дополнительные сведения об отработке отказа см. в статье [Восстановление после сбоя](sql-database-disaster-recovery.md).

Георепликацию следует использовать в том случае, если ваше приложение удовлетворяет следующим требованиям:

1. Оно является критически важным. На него распространяется действие соглашения об уровне обслуживания с высокими требованиями к RPO и RTO. Потеря данных и понижение уровня обслуживания приведут к финансовым последствиям. 
2. Высокая скорость изменения данных (например, количество транзакций в минуту или за несколько секунд). Значение RPO в 1 час, предлагаемое в рамках стандартной защиты, приведет к потере слишком большого объема данных.
3. Затраты, связанные с георепликацией, значительно ниже, чем потенциальные убытки или риск потери клиентов.

> [AZURE.NOTE]Георепликация не поддерживается для приложений, использующих базы данных уровня Basic.

##Сравнение стандартной и активной георепликации

Для баз данных уровня Standard активная георепликация не предусмотрена, поэтому если ваше приложение использует такие базы данных и соответствует перечисленным выше требованиям, следует активировать стандартную георепликацию. Для баз данных уровня Premium, в свою очередь, можно выбрать любой вариант. Стандартная георепликация разработана как относительно простое и недорогое решение для аварийного восстановления. Она в первую очередь рассчитана на приложения, для которых требуется только защита от незапланированных событий, таких как перебои в электроснабжении. Стандартная георепликация позволяет использовать для восстановления только связанный регион и не предусматривает возможности создания дополнительных реплик. Последнее очень важно при развертывании обновлений для приложения, поэтому если этот сценарий является для вас критичным, то следует выбрать активную георепликацию. Дополнительные сведения см. в статье [Обновление приложений без простоев](sql-database-business-continuity-application-upgrade.md).

> [AZURE.NOTE]Активная георепликация также поддерживает доступ только для чтения к базе данных-получателю, предоставляя дополнительные вычислительные ресурсы для операций чтения.

##Как включить георепликацию

Георепликацию можно включить тремя способами: с помощью портала Azure, API-интерфейса REST или команды PowerShell.

###Портал Azure

1. Войдите на [портал Azure](https://portal.Azure.com).
2. В левой части экрана выберите **ОБЗОР**, а затем — **Базы данных SQL**.
3. В колонке вашей базы данных выберите **Карта георепликации** и нажмите кнопку **Настроить георепликацию**.
4. Перейдите к колонке «Георепликация». Выберите целевой регион. 
5. Перейдите к колонке «Создание базы данных-получателя». Выберите существующий сервер в целевом регионе или создайте новый.
6. Выберите тип базы данных-получателя (*Доступно для чтения* или *Недоступно для чтения*).
7. Щелкните **Создать**, чтобы завершить настройку.

> [AZURE.NOTE]Связанный регион для аварийного восстановления будет отмечен в колонке «Георепликация» как *рекомендуемый*. Если вы используете базу данных уровня Premium, можно выбрать другой регион. При работе с базой данных уровня Standard изменить его нельзя. Для базы данных уровня Premium можно выбрать тип базы данных-получателя (*Доступно для чтения* или *Недоступно для чтения*). Для базы данных Standard доступен только вариант *Недоступно для чтения*.
 
###PowerShell

Чтобы автоматизировать настройку георепликации, используйте командлет PowerShell [Start-AzureSqlDatabaseCopy](https://msdn.microsoft.com/library/dn720220.aspx).

Чтобы создать георепликацию с недоступной для чтения базой данных-получателем Premium или Standard:
		
		Start-AzureSqlDatabaseCopy -ServerName "SecondaryServerName" -DatabaseName "SecondaryDatabaseName" -PartnerServer "PartnerServerName" –ContinuousCopy -OfflineSecondary
Чтобы создать георепликацию с доступной для чтения базой данных-получателем Premium:

		Start-AzureSqlDatabaseCopy -ServerName "SecondaryServerName" -DatabaseName "SecondaryDatabaseName" -PartnerServer "PartnerServerName" –ContinuousCopy
		 
Эта команда является асинхронной. После ее завершения проверьте статус выполнения операции, используя командлет [Get AzureSqlDatabaseCopy](https://msdn.microsoft.com/library/dn720235.aspx). В случае выполнения поле ReplicationState возвращаемого объекта будет иметь значение CATCH_UP.

		Get-AzureSqlDatabaseCopy -ServerName "PrimaryServerName" -DatabaseName "PrimaryDatabaseName" -PartnerServer "SecondaryServerName"


###REST API 

Чтобы настроить георепликацию программным способом, используйте API-команду [Запустить копирование базы данных](https://msdn.microsoft.com/library/azure/dn509576.aspx).

Эта команда является асинхронной. После ее завершения проверьте статус выполнения операции, используя API-команду [Получить копию базы данных](https://msdn.microsoft.com/library/azure/dn509570.aspx). В случае выполнения поле ReplicationState в теле ответа будет иметь значение CATCH_UP.


##Как выбрать конфигурацию отработки отказа 

При разработке приложений с учетом требований непрерывности бизнес-процессов следует рассмотреть несколько вариантов конфигурации. Выбор будет зависеть от топологии развертывания приложения и того, какие его компоненты больше всего пострадают в случае сбоя. Подробные инструкции и рекомендации см. в статье [Разработка облачных решений для аварийного восстановления с помощью активной георепликации](https://msdn.microsoft.com/library/azure/dn741328.aspx).

<!---HONumber=58--> 