<properties
   pageTitle="Непрерывность облачных бизнес-процессов — восстановление базы данных — база данных SQL | Microsoft Azure"
   description="Узнайте, как базы данных SQL Azure поддерживают непрерывное выполнение облачных бизнес-процессов и восстановление баз данных, а также помогают обеспечить выполнение важных облачных приложений."
   keywords="непрерывность бизнес-процессов, непрерывность облачных бизнес-процессов, аварийное восстановление базы данных, восстановление базы данных"
   services="sql-database"
   documentationCenter=""
   authors="carlrabeler"
   manager="jhubbard"
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="sqldb-bcdr"
   ms.date="06/09/2016"
   ms.author="carlrab"/>

# Обеспечение непрерывности бизнес-процессов с помощью базы данных SQL Azure

База данных SQL Azure предоставляет ряд решений для обеспечения непрерывности бизнес-процессов. Непрерывность бизнес-процессов в первую очередь подразумевает разработку, развертывание и запуск приложения таким образом, чтобы в случае запланированных перерывов или незапланированных аварийных событий не возникало временных или постоянных нарушений выполняемых им функций. К незапланированным событиям относятся как ошибки, связанные с человеческим фактором, так и временные или постоянные сбои и природные катаклизмы, которые приводят к масштабным разрушениям помещений или оборудования Azure в каком-либо регионе. Запланированные события включают вторичное развертывание приложения в другом регионе и его обновление. Цель обеспечения непрерывности бизнес-процессов заключается в том, чтобы приложение продолжало работать во время таких событий практически без уменьшения объема предоставляемых функций.

Прежде чем переходить к обзору решений базы данных SQL для обеспечения непрерывности облачных бизнес-процессов, необходимо ознакомиться с несколькими понятиями. а именно:

* **Аварийное восстановление (DR)** — это процесс восстановления нормального режима работы приложения.

* **Предполагаемое время восстановления (ERT)** — расчетная продолжительность восстановления 100%-ной доступности базы данных после получения запроса на восстановление или на отработку отказа.

* **Целевое время восстановления (RTO)** — максимальный приемлемый срок до полного восстановления приложения после аварийного события. RTO указывает максимально допустимую потерю доступности во время сбоев.

* **Целевая точка восстановления (RPO)** — максимальный срок, за который приложение может потерять данные к моменту, когда оно будет полностью восстановлено после аварийного события. RTO указывает максимально допустимую потерю данных во время сбоев.


## Сценарии обеспечения непрерывности облачных бизнес-процессов в базе данных SQL

Ниже перечислены основные сценарии, которые необходимо учесть при планировании непрерывности бизнес-процессов и восстановления баз данных.

### Проектирование приложений для непрерывного выполнения бизнес-процессов

Приложение, над которым я работаю, является критически важным для моего бизнеса. Я хочу разработать и настроить его так, чтобы в случае масштабной аварии в регионе, где предоставляется служба, оно могло продолжать работать. Я знаю требования к показателям RPO и RTO для моего приложения и выберу конфигурацию, которая будет им соответствовать.

### Восстановление после ошибки, связанной с человеческим фактором

У меня есть права администратора и доступ к рабочей версии приложения. Во время планового обслуживания я ошибся и удалил некоторые критически важные данные в рабочей среде. Мне необходимо быстро восстановить их, чтобы сгладить последствия ошибки.

### Восстановление после сбоя

Мое приложение выполняется в рабочей среде, и я получаю сообщение о том, что в регионе, где оно развернуто, произошел серьезный сбой. Я хочу инициировать процесс восстановления и развернуть приложение в другом регионе, чтобы уменьшить влияние сбоя на бизнес.

### Отработка аварийного восстановления

Так как при восстановлении после сбоя слой данных переносится в другой регион, я хочу время от времени тестировать процесс восстановления и оценивать возможные последствия для работы приложения, чтобы быть готовым к неожиданностям.

### Обновление приложений без простоев

Я планирую выпустить новую версию своего приложения. Она включает изменение схемы базы данных, добавление новых хранимых процедур и т. д. Для обновления необходимо временно закрыть доступ пользователей к базе данных. В то же время я хочу убедиться, что оно не приведет к длительному прерыванию бизнес-операций.

## Функции базы данных SQL для обеспечения непрерывности бизнес-процессов

В следующей таблице показаны функции базы данных SQL для обеспечения непрерывности бизнес-процессов и различия между ними на разных [уровнях служб](sql-database-service-tiers.md).

| Функция | Уровень Basic | Уровень Standard |Уровень Premium
| --- |--- | --- | ---
| Восстановление на момент времени | Все точки восстановления в течение 7 дней | Все точки восстановления в течение 35 дней | Все точки восстановления в течение 35 дней
| Геовосстановление | ERT < 12 ч, RPO < 1 ч | ERT < 12 ч, RPO < 1 ч | ERT < 12 ч, RPO < 1 ч
| Активная георепликация | ERT < 30 с, RPO < 5 с | ERT < 30 с, RPO < 5 с | ERT < 30 с, RPO < 5 с

Эти функции используются в описанных выше сценариях.

> [AZURE.NOTE] Значения ERT и RPO отображают инженерные цели и используются только для справки. Они не входят в [соглашение об уровне обслуживания для базы данных SQL](https://azure.microsoft.com/support/legal/sla/sql-database/v1_0/)


###Восстановление состояния системы в определенной временной точке

Функция [восстановления до точки во времени](sql-database-recovery-using-backups.md#point-in-time-restore) позволяет восстановить более раннее состояние базы данных. Она использует резервные копии базы данных, включая добавочные, и архивы журналов транзакций, которые служба автоматически ведет для каждой пользовательской базы данных. Восстановление на момент времени доступно для всех уровней служб. Уровень "Базовый" позволяет вернуться на 7 дней назад, а уровни "Стандартный" и "Премиум" — на 35.

### Геовосстановление

Функция [геовосстановления](sql-database-recovery-using-backups.md#geo-restore) также доступна для баз данных уровней "Базовый", "Стандартный" и "Премиум". Она используется по умолчанию, когда база данных недоступна из-за происшествия в регионе, где она размещена. Как и функция восстановления на момент времени, геовосстановление использует резервные копии базы данных из геоизбыточного хранилища Azure. Восстановление выполняется на основе резервной копии из удаленного хранилища, что позволяет защитить базу данных от сбоев в регионе развертывания основной базы.

### Активная георепликация

[Активная георепликация](sql-database-geo-replication-overview.md) доступна для всех уровней баз данных. Она рассчитана на приложения, которые предъявляют более высокие требования к восстановлению по сравнению с теми, которые может обеспечить обычное геовосстановление. Активная георепликация позволяет создавать до четырех доступных для чтения реплик баз данных на серверах в разных регионах. Отработку отказа можно выполнить на любую из баз данных-получателей. Кроме того, активная георепликация применяется при [обновлении приложений и их перемещении](sql-database-manage-application-rolling-upgrade.md), а также для балансировки рабочих нагрузок операций чтения.

## Выбор функции обеспечения непрерывности бизнес-процессов

Чтобы разработать приложение с учетом требований непрерывности бизнес-процессов, вам нужно ответить на следующие вопросы:

1. Какая функция обеспечения непрерывности бизнес-процессов подходит для защиты вашего приложения в случае сбоя?
2. Какой уровень избыточности и какую топологию репликации вы используете?

### Когда следует использовать геовосстановление

[Геовосстановление](sql-database-recovery-using-backups.md#geo-restore) используется по умолчанию, когда база данных недоступна из-за инцидента в регионе, где она размещена. База данных SQL по умолчанию обеспечивает встроенную базовую защиту каждой базы данных. Ее суть состоит в создании и хранении [резервных копий баз данных](sql-database-automated-backups.md) в геоизбыточном хранилище Azure. Такая защита не требует специальной настройки или выделения дополнительных ресурсов. Можно восстановить базу данных в любом регионе, выполнив восстановление из этих автоматически созданных геоизбыточных резервных копий в новую базу данных.

Встроенную защиту следует использовать в том случае, если приложение удовлетворяет следующим требованиям:

1. Приложение не является критически важным. На него не распространяется действие соглашений об уровне обслуживания; перерыв в работе на 24 часа и более не повлечет финансовых последствий.
2. Скорость изменения данных низкая (например, количество транзакций в час). При RPO в 1 час не будут утрачены большие объемы данных.
3. Бюджет приложения ограничен и не предусматривает дополнительных расходов на георепликацию.

> [AZURE.NOTE] Геовосстановление не предусматривает предварительного выделения вычислительных ресурсов в каком-либо конкретном регионе для восстановления активных баз данных из резервной копии во время сбоя. Чтобы уменьшить воздействие на уже развернутые в регионе базы данных, служба будет управлять нагрузкой, связанной с запросами на геовосстановление. Ранее развернутые базы данных будут получать вычислительные ресурсы в приоритетном порядке. Поэтому время восстановления вашей базы данных будет зависеть от того, сколько других баз данных будет проходить процедуру восстановления в том же регионе одновременно с вашей, а также ее размера, числа журналов транзакций, пропускной способности сети и т. п.

### Когда следует использовать активную георепликацию

[Активная георепликация](sql-database-geo-replication-overview.md) обеспечивает создание и обслуживание баз данных, доступных для чтения (получателей), в регионе, отличном от основного, поддерживая их в актуальном состоянии с помощью механизма асинхронной репликации. Это гарантирует, что после восстановления у вашей базы данных будет достаточно данных и вычислительных ресурсов, чтобы поддержать рабочую нагрузку приложения.

Активную георепликацию следует использовать в том случае, если ваше приложение удовлетворяет следующим требованиям.

1. Оно является критически важным. На него распространяется действие соглашения об уровне обслуживания с высокими требованиями к RPO и RTO. Потеря данных и понижение уровня обслуживания приведут к финансовым последствиям.
2. Высокая скорость изменения данных (например, количество транзакций в минуту или за несколько секунд). Значение RPO в 1 час, предлагаемое в рамках стандартной защиты, приведет к потере слишком большого объема данных.
3. Затраты, связанные с георепликацией, значительно ниже, чем потенциальные убытки или риск потери клиентов.

## Разработка облачных решений для аварийного восстановления 

При разработке приложений с учетом требований непрерывности бизнес-процессов следует рассмотреть несколько вариантов конфигурации. Выбор будет зависеть от топологии развертывания приложения и того, какие его компоненты больше всего пострадают в случае сбоя. Подробные инструкции и рекомендации см. в статье [Разработка облачных решений для аварийного восстановления с помощью георепликации](sql-database-designing-cloud-solutions-for-disaster-recovery.md).

Подробное описание стратегий восстановления при использовании пула эластичных БД см. в разделе [Стратегии аварийного восстановления для приложений с использованием пула эластичных баз данных SQL](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).

## Дальнейшие действия

- Чтобы узнать об автоматически создаваемых резервных копиях базы данных SQL Azure, ознакомьтесь с разделом [Общие сведения об автоматическом резервном копировании базы данных SQL](sql-database-automated-backups.md).
- Чтобы изучить сценарии проектирования и восстановления непрерывности бизнес-процессов, ознакомьтесь со [сценариями обеспечения непрерывности](sql-database-business-continuity-scenarios.md).
- Чтобы узнать об использовании создаваемых автоматически резервных копий для восстановления, ознакомьтесь с [восстановлением базы данных из резервных копий, инициируемых службой](sql-database-recovery-using-backups.md).
- Чтобы узнать о более быстрых вариантах восстановления, ознакомьтесь с [активной георепликацией](sql-database-geo-replication-overview.md).
- Чтобы узнать об использовании создаваемых автоматически резервных копий для архивации, ознакомьтесь с [копированием базы данных](sql-database-copy.md).

<!---HONumber=AcomDC_0706_2016-->