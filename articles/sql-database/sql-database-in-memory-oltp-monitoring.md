<properties
	pageTitle="Отслеживание хранилища XTP In-Memory | Microsoft Azure"
	description="Сведения об оценке и мониторинге использования и мощности хранилища XTP In-Memory и об устранении нехватки памяти 41805."
	services="sql-database"
	documentationCenter=""
	authors="jodebrui"
	manager="jeffreyg"
	editor=""/>


<tags
	ms.service="sql-database"
	ms.workload="data-management"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="hero-article"
	ms.date="10/28/2015"
	ms.author="jodebrui"/>


# Мониторинг хранилища XTP In-Memory

Сведения об уровнях служб и хранилище см. в статье [Уровни служб базы данных SQL](sql-database-service-tiers.md).

При использовании технологий [In-Memory](sql-database-in-memory.md), данные в таблицах, оптимизированных для памяти, и переменные таблиц находятся в хранилище XTP In-Memory. Для каждого уровня службы категории «Премиум» установлен максимальный объем хранилища In-Memory. При превышении этого ограничения операции вставки и обновления могут завершаться сбоем (ошибка 41805). В таком случае вам придется либо удалить данные, чтобы освободить память, либо повысить уровень производительности базы данных.

## Как определить, соответствует ли объем данных ограничениям хранилища In-Memory

Оценка требований к памяти для таблицы, оптимизированной для памяти, выполняется одинаково как на сервере SQL Server, так и в базе данных SQL Azure. Потратьте несколько минут, чтобы прочесть эту статью в библиотеке [MSDN](https://msdn.microsoft.com/library/dn282389.aspx).

Обратите внимание, что, когда определяется максимальный размер данных пользователя, учитываются строки таблиц, табличных переменных и индексы. Кроме того, инструкции ALTER TABLE нужно достаточно места для создания новой версии всей таблицы и ее индексов.

##### Максимальный размер хранилища XTP In-Memory для уровней служб категории «Премиум»



Вы можете отслеживать использование хранилища In-Memory на [портале](http://portal.azure.com/) Azure:

- В колонке «База данных» найдите поле «Использование ресурсов» и щелкните «Изменить».
- Затем выберите процент метрики хранилища XTP In-Memory.

Или используйте следующий запрос, чтобы отобразить использование хранилища In-Memory:

    select xtp_storage_percent from sys.dm_db_resource_stats

## Исправление ситуаций с нехваткой памяти (ошибка 41805)

Нехватка памяти приводит к тому, что операции вставки, обновления и создания завершаются сбоем с сообщением об ошибке 41805.

Сообщение об ошибке 41805 указывает, что превышен максимальный размер оптимизированных для памяти таблиц и табличных переменных.

Чтобы устранить эту ошибку, выполните одно из следующих действий.


- Удалите данные из таблиц, оптимизированных для памяти. Это позволит разгрузить данные с помощью традиционных дисковых таблиц.
- Если вам необходимо сохранить данные в таблицах, оптимизированных для памяти, повысьте уровень обслуживания, чтобы получить достаточный объем хранилища In-Memory.

## Дальнейшие действия
Дополнительные сведения о [мониторинге базы данных SQL Azure с помощью динамических административных представлений](sql-database-monitoring-with-dmvs.md)

<!---HONumber=Nov15_HO1-->