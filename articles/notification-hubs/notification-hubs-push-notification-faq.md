---
title: "Концентраторы уведомлений Azure — часто задаваемые вопросы"
description: "Часто задаваемые вопросы по разработке и реализации решений в концентраторах уведомлений"
services: notification-hubs
documentationcenter: mobile
author: ysxu
manager: erikre
keywords: "отправка push-уведомлений, push-уведомления, push-уведомления iOS, push-уведомления android, push-уведомления ios, push-уведомления android"
editor: 
ms.assetid: 7b385713-ef3b-4f01-8b1f-ffe3690bbd40
ms.service: notification-hubs
ms.workload: mobile
ms.tgt_pltfrm: mobile-multiple
ms.devlang: multiple
ms.topic: article
ms.date: 10/03/2016
ms.author: yuaxu
translationtype: Human Translation
ms.sourcegitcommit: dcda8b30adde930ab373a087d6955b900365c4cc
ms.openlocfilehash: 7f76f8786bf08e4aacc63758260202fe7e1a832f


---
# <a name="push-notifications-with-azure-notification-hubs---frequently-asked-questions"></a>Отправка push-уведомлений с помощью концентраторов уведомлений Azure — часто задаваемые вопросы
## <a name="general"></a>Общие сведения
### <a name="1----what-is-the-price-model-for-notification-hubs"></a>1.    Как определяется цена на концентраторы уведомлений?
Концентраторы уведомлений предлагаются в трех ценовых категориях.

* **Бесплатный** — до 1 миллиона отправок push-уведомлений на подписку в месяц.
* **Базовый** — 10 миллионов отправок push-уведомлений на подписку в месяц в качестве базового предложения с возможностями увеличения квоты.
* **Стандартный** — 10 миллионов отправок push-уведомлений на подписку в месяц в качестве базового предложения с возможностями увеличения квоты плюс широкие функции телеметрии.

Последние сведения можно найти на странице [ценами на Центры уведомлений] . Цены устанавливаются на уровне подписки и зависят от количества отправок push-уведомлений, поэтому количество созданных пространств имен или концентраторов уведомлений не имеет значения.

Уровень **Бесплатный** предоставляется для целей разработки без каких-либо гарантий, предусмотренных соглашением об уровне обслуживания. Этот уровень может быть хорошей отправной точкой для тех, кто хочет изучить возможности отправки push-уведомлений через концентраторы уведомлений. Однако он может оказаться не лучшим выбором для средних и крупных приложений.

Уровни **Базовый** и  & **Стандартный** предназначены для использования в рабочей среде. Указанные ниже основные возможности включены *только для уровня "Стандартный"*.

* *Расширенные возможности телеметрии.* Центры уведомлений предлагают ряд возможностей для экспорта данных телеметрии, а также для отправки сведений о регистрации push-уведомлений для автономного просмотра и анализа.
* *Мультитенантность.* Идеально подходит для создания мобильного приложения, использующего Центры уведомлений для поддержки нескольких клиентов. Он позволяет задать учетные данные службы push-уведомлений (PNS) на уровне пространства имен концентратора уведомлений для приложения, а затем разделить клиентов, предоставляя им отдельные концентраторы под этим общим пространством имен. Это упрощает обслуживание, позволяя хранить ключи SAS для отправки и получения push-уведомлений из концентраторов уведомлений, выделенных для каждого клиента, что, в свою очередь, предотвращает их перекрытие.
* *Запланированные push-уведомления.* Вы можете запланировать отправку push-уведомлений, поставив их в очередь.
* *Пакетный импорт.* Вы можете использовать пакетный импорт данных регистрации.

### <a name="2----what-is-the-notification-hubs-sla"></a>2.    Что такое соглашение об уровне обслуживания для концентраторов уведомлений?
Для уровней Центров уведомлений **Базовый** и **Стандартный** мы гарантируем, что как минимум 99,9 % времени правильно настроенные приложения смогут отправлять push-уведомления и выполнять операции управления регистрацией через Центр уведомлений, развернутый на поддерживаемом уровне. Дополнительные сведения о соглашении об уровне обслуживания см. на [этой странице].

> [!NOTE]
> Обратите внимание, что в соглашении об уровне обслуживания нет гарантий касательно участка между службой уведомлений платформы и устройством, так как доставка push-уведомления на устройство из концентратора уведомлений зависит от внешних поставщиков платформы.
> 
> 

### <a name="3----which-customers-are-using-notification-hubs"></a>3.    Какие клиенты используют концентраторы уведомлений
Наши концентраторы уведомлений использует множество крупных клиентов. Ниже приведены самые главные из них.

* Sochi 2014 — сотни групп интересов, более 3 миллионов устройств, более 150 миллионов уведомлений, отправленных за 2 недели. [Анализ примера — Sochi]
* Skanska — [анализ примера — Skanska]
* Seattle Times — [анализ примера — Seattle Times]
* Mural.ly — [анализ примера — Mural.ly]
* 7Digital — [анализ примера — 7Digital]
* Приложения Bing — десятки миллионов устройств, отправляющих 3 миллиона уведомлений ежедневно.

### <a name="4-how-do-i-upgrade-or-downgrade-my-notification-hubs-to-change-my-service-tier"></a>4. Как повысить или понизить уровень моих концентраторов уведомлений для изменения уровня служб?
Перейдите на [классический портал Azure], щелкните «Служебная шина», а затем выберите пространство имен и центр уведомлений. На вкладке "Масштаб" можно изменить уровень служб концентраторов уведомлений.

![](./media/notification-hubs-faq/notification-hubs-classic-portal-scale.png)

## <a name="design--development"></a>Проектирование и разработка
### <a name="1----which-server-side-platforms-do-you-support"></a>1.    Какие платформы на стороне сервера вы поддерживаете?
Мы предоставляем пакеты SDK и [полные примеры] для .NET, Java, PHP, Python и Node.js, чтобы можно было настроить серверную часть приложения для взаимодействия с концентраторами уведомлений с помощью любой из этих платформ. API концентраторов уведомлений основаны на интерфейсе REST, поэтому если вы не хотите добавлять дополнительную зависимость, вы можете взаимодействовать непосредственно с ними. Дополнительные сведения можно найти на странице [Использование API REST концентраторов уведомлений] .

### <a name="2----which-client-platforms-do-you-support"></a>2.    Какие клиентские платформы вы поддерживаете?
Мы поддерживаем отправку push-уведомлений на платформы [Apple iOS](notification-hubs-ios-apple-push-notification-apns-get-started.md), [Android](notification-hubs-android-push-notification-google-gcm-get-started.md), [Windows Universal](notification-hubs-windows-store-dotnet-get-started-wns-push-notification.md), [Windows Phone](notification-hubs-windows-mobile-push-notifications-mpns.md), [Kindle](notification-hubs-kindle-amazon-adm-push-notification.md), [Android China (через Baidu)](notification-hubs-baidu-china-android-notifications-get-started.md), Xamarin ([iOS](xamarin-notification-hubs-ios-push-notification-apns-get-started.md)  & и [Android](xamarin-notification-hubs-push-notifications-android-gcm.md)) и платформы приложений [Chrome](notification-hubs-chrome-push-notifications-get-started.md) и [Safari](https://github.com/Azure/azure-notificationhubs-samples/tree/master/PushToSafari). Полный список руководств по началу работы с пошаговыми указаниями по отправке push-уведомлений для этих платформ см. на странице [Отправка push-уведомлений с помощью центров уведомлений Azure в iOS].

### <a name="3----do-you-support-smsemailweb-notifications"></a>3.    Поддерживаются ли уведомления по SMS и электронной почте, а также веб-уведомления?
Концентраторы уведомлений в первую очередь созданы для отправки уведомлений в мобильные приложения с использованием вышеперечисленных платформ. Мы пока не предоставляем возможность отправки уведомлений по почте или SMS-оповещений, однако сторонние платформы, которые предоставляют эти возможности, можно интегрировать вместе с концентраторами уведомлений для отправки системных push-уведомлений с помощью [мобильных приложений Azure].

Кроме того, концентраторы уведомлений также не предоставляют возможность отправки push-уведомлений в браузере по умолчанию. Клиенты могут внедрить эту функцию с помощью SignalR на базе поддерживаемых серверных платформ. Если вы хотите отправлять уведомления в приложения браузера в изолированной среде Chrome, ознакомьтесь с [учебником по приложениям Chrome].

### <a name="4----what-is-the-relation-between-azure-mobile-apps-and-azure-notification-hubs-and-when-do-i-use-what"></a>4.    Как связаны мобильные приложения Azure и концентраторы уведомлений Azure и в каких случаях их нужно использовать?
Если у вас есть существующая серверная часть мобильного приложения и вам требуется добавить возможность для отправки push-уведомлений, используйте для этого концентраторы уведомлений Azure. Если вам требуется настроить серверную часть мобильного приложения с нуля, следует использовать мобильные приложения Azure. Мобильные приложения Azure автоматически подготавливают концентратор уведомлений, чтобы вы могли легко отправлять push-уведомления из серверной части мобильного приложения. Цена за использование мобильных приложений Azure включает базовую стоимость использования концентратора уведомлений. Вы платите только при превышении количества отправляемых push-уведомлений. Дополнительные сведения о стоимости см. на странице с [ценами на службу приложений].

### <a name="5----how-many-devices-can-i-support-if-i-send-push-notifications-via-notification-hubs"></a>5.    Сколько устройств может поддерживаться при отправке push-уведомлений через концентраторы уведомлений?
Сведения о поддерживаемых устройствах см. на странице с [ценами на Центры уведомлений].

Если в определенных случаях необходима поддержка более 10 000 000 зарегистрированных устройств, [свяжитесь с нами](https://azure.microsoft.com/overview/contact-us/) напрямую и мы поможем вам расширить решение.

### <a name="6----how-many-push-notifications-can-i-send-out"></a>6.    Сколько push-уведомлений я могу отправить?
В зависимости от выбранной категории масштабирование выполняется автоматически на основе количества уведомлений, проходящих через систему.

> [!NOTE]
> Цены зависят от количества доставленных push-уведомлений. Ознакомьтесь с существующими ограничениями для категорий на странице [ценами на Центры уведомлений] .
> 
> 

Наши существующие клиенты отправляют миллионы push-уведомлений в день с помощью концентраторов уведомлений. Пока вы используете концентраторы уведомлений Azure, вам не нужно предпринимать специальные действия для масштабирования решения по отправке push-уведомлений.

### <a name="7----how-long-does-it-take-for-sent-push-notifications-to-reach-my-device"></a>7.    Как скоро push-уведомления доставляются на мое устройство?
При обычном использовании с более или менее согласованной входящей нагрузкой и отсутствием пиков концентраторы уведомлений Azure могут обрабатывать по крайней мере **1 миллион отправленных push-уведомлений в минуту** . Такая скорость может меняться в зависимости от количества тегов, характера входящих данных и других внешних факторов.

В течение предполагаемого времени доставки мы можем вычислить целевые объекты для соответствующей платформы и направить сообщения соответствующим службам доставки push-уведомлений на основе зарегистрированных тегов и выражений тегов. На этом этапе службы рush-уведомлений (PNS) отвечают за отправку уведомления на устройство.

Службы рush-уведомлений не предоставляют никаких гарантий по доставке уведомлений, предусмотренных соглашением об уровне обслуживания. Однако обычно подавляющая часть рush-уведомлений доставляется на устройства в течение нескольких минут (как правило, в диапазоне 10 минут) с момента их отправки на нашу платформу. Могут возникать некоторые выбросы, занимающие больше времени.

> [!NOTE]
> Кроме того, в концентраторе уведомлений Azure предусмотрена политика для удаления любых рush-уведомлений, которые не были доставлены в PNS в течение 30 минут. Эта задержка может произойти по ряду причин, чаще всего потому, что служба PNS регулирует работу приложения.
> 
> 

### <a name="8----is-there-any-latency-guarantee"></a>8.    Предоставляются ли какие-либо гарантии по задержкам?
Из-за характера доставки push-уведомлений (они доставляются внешней службой рush-уведомлений для определенной платформы) гарантии по задержкам не предоставляются. Как правило, большая часть рush-уведомлений доставляется в течение нескольких минут.

### <a name="9----what-are-the-considerations-i-need-to-take-into-account-when-designing-a-solution-with-namespaces-and-notification-hubs"></a>9.    Какие моменты нужно учитывать при разработке решения в пространствах имен и концентраторах уведомлений?
#### <a name="mobile-appenvironment"></a>Мобильное приложение и среда
* Следует использовать один концентратор уведомлений для мобильного приложения в среде.
* В мультитенантном сценарии для каждого клиента должен быть отдельный концентратор.
* Никогда не используйте один и тот же концентратор уведомлений в тестовой и рабочей средах, так как это может вызвать проблемы в дальнейшем при отправке уведомлений. Например, Apple предлагает конечные точки Sandbox и Production Push с отдельными учетными данными для каждой из них.
* По умолчанию тестовые уведомления можно отправлять на зарегистрированные устройства с портала Azure или с помощью интегрированного компонента Azure в Visual Studio. Существует пороговое значение в 10 устройств, которые случайным образом выбираются из пула регистрации.

> [!NOTE]
> Если для концентратора был изначально настроен сертификат "песочницы" Apple, а затем — сертификат рабочей среды Apple, старые маркеры устройств с новым сертификатом станут недействительными, что может привести к сбою отправки push-уведомлений. Лучше использовать рабочую и тестовую среду по отдельности и использовать разные концентраторы для разных сред.
> 
> 

#### <a name="pns-credentials"></a>Учетные данные PNS
При регистрации мобильного приложения на портале разработчиков платформы (например, Apple или Google и т. д.) вы получаете идентификатор приложения и маркеры безопасности, необходимые серверной части приложения для предоставления службам рush-уведомлений платформы, чтобы последние могли отправлять push-уведомления на устройства. Эти маркеры безопасности, которые могут быть представлены в виде сертификатов (например, для Apple iOS или Windows Phone) или ключей безопасности (Google Android, Windows и т. д.), требуется настроить в концентраторах уведомлений. Как правило, это осуществляется на уровне концентратора уведомлений, а также на уровне пространства имен в мультитенантном сценарии.

#### <a name="namespaces"></a>Пространства имен
Пространства имен могут также использоваться для группирования развертываний.  Кроме того, с их помощью можно представить все концентраторы уведомлений для всех клиентов одного приложения в мультитенантном сценарии.

#### <a name="geo-distribution"></a>Географическое распределение
Географическое распределение не всегда является критически важным для push-уведомлений. Кроме того, следует иметь в виду, что различные службы рush-уведомлений (например APNS, GCM и т. д.), которые в основном доставляют push-уведомления на устройства, распределены неравномерно.

Однако при наличии приложения, которое используется во всем мире, вы можете создать несколько концентраторов в разных пространствах имен и воспользоваться преимуществами доступности службы концентраторов уведомлений в разных регионах Azure по всему миру.

> [!NOTE]
> Это приведет к увеличению затрат на управление, особенно затрат на регистрацию. Так что мы не советуем так делать, за исключением случаев крайней необходимости.
> 
> 

### <a name="10----should-i-do-registrations-from-the-app-backend-or-directly-through-client-devices"></a>10.    Где следует выполнять регистрацию: в серверной части приложения или непосредственно на клиентских устройствах?
Выполняйте регистрацию в серверной части приложения в тех случаях, когда необходимо выполнить аутентификацию клиента перед созданием регистрации или при наличии тегов, которые должны быть созданы и изменены серверной частью приложения на основе определенной логики приложения. Дополнительные сведения см. на страницах [Регистрация из внутренней службы приложения] и [Управление регистрацией].

### <a name="11----what-is-the-push-notification-delivery-security-model"></a>11.    Какая модель безопасности доставки push-уведомлений используется?
Центры уведомлений Azure используют модель безопасности на основе [подписанного URL-адреса (SAS)](../storage/storage-dotnet-shared-access-signature-part-1.md). Маркеры SAS можно использовать на уровне корневого пространства имен или на детализированном уровне концентраторов уведомлений. Для этих маркеров SAS можно задать различные правила авторизации, например разрешения для отправки сообщений, прослушивания уведомлений и т. д. Дополнительные сведения см. в документе [Безопасность].

### <a name="12----how-should-i-handle-sensitive-payload-in-the-push-notifications"></a>12.    Как обрабатываются конфиденциальные полезные данные в push-уведомлениях?
Все уведомления доставляются на целевые устройства службами рush-уведомлений (PNS) платформы. При отправке уведомления в концентратор уведомлений Azure оно обрабатывается и передается в соответствующую службу PNS.

Передача уведомлений от отправителя в концентраторы уведомлений Azure, а затем в службу PNS осуществляется по протоколу HTTPS.

> [!NOTE]
> Концентраторы уведомлений Azure никак не регистрируют полезные данные сообщения.
> 
> 

Однако для отправки конфиденциальных полезных данных мы советуем использовать шаблон безопасных push-уведомлений. Его суть заключается в том, что отправитель посылает ping-уведомление для проверки связи с идентификатором сообщения на устройство без конфиденциальных полезных данных, и когда приложение на устройстве получает эти полезные данные, оно может напрямую вызвать безопасный API, чтобы получить информацию о сообщении. Руководство по реализации описанной выше схемы см. на странице [Безопасные push-уведомления для Центров уведомлений Azure].

## <a name="operations"></a>Операции
### <a name="1----what-is-the-disaster-recovery-dr-story"></a>1.    Какие особенности аварийного восстановления?
Мы предоставляем аварийное восстановление метаданных со своей стороны (имя концентратора уведомлений, строка подключения и другие важные данные). В случае аварийного восстановления данные регистрации являются **единственным сегментом** инфраструктуры центров уведомлений, который будет утерян. Поэтому вам потребуется способ, позволяющий повторно заполнить новый концентратор этими данными после восстановления.

* *Шаг 1.* Создайте дополнительный центр уведомлений в другом центре обработки данных. Его можно создать непосредственно при аварийном восстановлении или с самого начала. Не имеет значения, какой способ вы выберете, ведь подготовка концентратора уведомлений занимает всего несколько секунд. Мы настоятельно рекомендуем создать концентратор уведомлений с самого начала, так как это позволит предотвратить влияние на возможности управления в случае аварийного восстановления.
* *Шаг 2.* Заполните дополнительный центр уведомлений данными регистрации из основного центра уведомлений. Не рекомендуется хранить регистрации в обоих концентраторах или мгновенно синхронизировать их по мере поступления, так как это приводит к негативным последствиям из-за специфического характера регистраций, срок действия которых истекает в зависимости от службы PNS. Концентраторы уведомлений удаляют их по мере получения отзывов службы PNS о регистрациях с истекшим сроком действия или недействительных регистрациях.  

Рекомендуется использовать серверную часть приложения, которая:

* хранит заданный набор регистраций со своей стороны для выполнения массовой вставки в дополнительный концентратор уведомлений в случае аварийного восстановления

**OR**

* получает регулярный дамп регистраций из основного концентратора в качестве резервной копии, а затем выполняет массовую вставку в дополнительный концентратор.

> [!NOTE]
> Функции экспорта и импорта регистраций, доступные для уровня "Стандартный", описаны в документе [Экспорт и импорт регистраций] .
> 
> 

Если у вас нет серверной части, при запуске приложений на устройствах они создадут новую регистрацию в дополнительном концентраторе уведомлений. В конечном итоге этот концентратор уведомлений зарегистрирует все активные устройства.

Однако недостатком является то, что в течение определенного периода времени устройства, на которых не открыты приложения, не будут получать уведомления.

### <a name="2----is-there-any-audit-log-capability"></a>2.    Предусмотрена ли возможность ведения журнала аудита?
Все операции по управлению концентраторами уведомлений регистрируются в журналах операций, которые представлены на [классический портал Azure].

## <a name="monitoring--troubleshooting"></a>Мониторинг и устранение неполадок
### <a name="1----what-troubleshooting-capabilities-are-available"></a>1.    Какие возможности для устранения неполадок доступны?
Концентраторы уведомлений Azure предоставляют несколько функциональных возможностей для стандартного устранения неполадок, особенно в наиболее распространенном случае удаления уведомлений. Дополнительные сведения см. в техническом документе [Центры уведомлений Azure — рекомендации по диагностике].

### <a name="2----what-telemetry-features-are-available"></a>2.    Какие телеметрические функции доступны?
Центры уведомлений Microsoft Azure позволяют просматривать данные телеметрии на [классический портал Azure]. Дополнительные сведения о доступных метриках см. в статье [Метрики].

> [!NOTE]
> Успешная доставка уведомлений означает только то, что push-уведомления доставлены во внешнюю службу push-уведомлений (например APNS для Apple, GCM для Google и т. д). Доставлять уведомления на целевые устройства должна служба PNS. Как правило, служба PNS не предоставляет метрики доставки третьим лицам.  
> 
> 

Центры уведомлений также предоставляют возможность экспортировать данные телеметрии программным путем (на уровне **Стандартный**). Дополнительные сведения см. в статье [Fetch Notification Hubs Telemetry Programmatically] (Получение данных телеметрии Центров уведомлений программным путем).

[классический портал Azure]: https://manage.windowsazure.com
[ценами на Центры уведомлений]: http://azure.microsoft.com/pricing/details/notification-hubs/
[этой странице]: http://azure.microsoft.com/support/legal/sla/
[Анализ примера — Sochi]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=7942
[анализ примера — Skanska]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=5847
[анализ примера — Seattle Times]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=8354
[анализ примера — Mural.ly]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=11592
[анализ примера — 7Digital]: https://customers.microsoft.com/Pages/CustomerStory.aspx?recid=3684
[Использование API REST концентраторов уведомлений]: https://msdn.microsoft.com/library/azure/dn530746.aspx
[Отправка push-уведомлений с помощью центров уведомлений Azure в iOS]: http://azure.microsoft.com/documentation/articles/notification-hubs-ios-get-started/
[учебником по приложениям Chrome]: http://azure.microsoft.com/documentation/articles/notification-hubs-chrome-get-started/
[Mobile Services Pricing]: http://azure.microsoft.com/pricing/details/mobile-services/
[Регистрация из внутренней службы приложения]: https://msdn.microsoft.com/library/azure/dn743807.aspx
[Управление регистрацией]: https://msdn.microsoft.com/library/azure/dn530747.aspx
[Безопасность]: https://msdn.microsoft.com/library/azure/dn495373.aspx
[Безопасные push-уведомления для Центров уведомлений Azure]: http://azure.microsoft.com/documentation/articles/notification-hubs-aspnet-backend-ios-secure-push/
[Центры уведомлений Azure — рекомендации по диагностике]: http://azure.microsoft.com/documentation/articles/notification-hubs-diagnosing/
[Метрики]: https://msdn.microsoft.com/library/dn458822.aspx
[Fetch Notification Hubs Telemetry Programmatically]: https://github.com/Azure/azure-notificationhubs-samples/tree/master/FetchNHTelemetryInExcel (Получение данных телеметрии Центров уведомлений программным путем)
[Экспорт и импорт регистраций]: https://msdn.microsoft.com/library/dn790624.aspx
[Azure Portal]: https://portal.azure.com
[полные примеры]: https://github.com/Azure/azure-notificationhubs-samples
[мобильных приложений Azure]: https://azure.microsoft.com/en-us/services/app-service/mobile/
[ценами на службу приложений]: https://azure.microsoft.com/en-us/pricing/details/app-service/



<!--HONumber=Dec16_HO2-->


