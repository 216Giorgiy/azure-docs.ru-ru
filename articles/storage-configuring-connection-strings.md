<properties 
	pageTitle="Настройка строк подключения для Azure" 
	description="Узнайте, как настроить строки подключения к учетной записи хранения в Azure." 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor="cgronlun"/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/20/2015" 
	ms.author="tamram"/>

# Настройка строк подключения для Azure

## Обзор
Строка подключения содержит параметры, необходимые для доступа к вашей учетной записи хранения в Azure. Строку подключения можно настроить любым из приведенных ниже способов:

- Подключиться к эмулятору хранения Azure при локальном тестировании службы или приложения.

- Подключиться к учетной записи хранения в Azure с помощью конечных точек по умолчанию для служб хранилища.

- Подключиться к учетной записи хранения в Azure с помощью явно заданных точек для служб хранилища.

Если приложение - это облачная служба, запущенная в Azure, то самое удобное место для хранения строки подключения - [схема конфигурации службы Azure (CSCFG-файл)](https://msdn.microsoft.com/library/ee758710.aspx). Если приложение запущено в другой среде (например, на настольном ПК), то строка подключения, вероятно, будет храниться в файле app.config или другом файле конфигурации. Для доступа к строке подключения во время выполнения независимо от используемой среды можно использовать класс Azure CloudConfigurationManagerДля.

##Подключение к эмулятору хранения

Эмулятор хранения - это локальная учетная запись с известным именем и ключом. Так как имя и ключ учетной записи одинаковы для всех пользователей, то для обращения к эмулятору хранения в строке подключения можно использовать сокращенный формат строки. Задайте строке подключения значение `UseDevelopmentStorage=true`.

Если вы тестируете службу на эмуляторе хранения, можно также указать прокси-сервер HTTP. Это может быть полезно для отслеживания HTTP-запросов и ответов при отладке операций со службами хранилища. Чтобы задать прокси-сервер, добавьте параметр DevelopmentStorageProxyUri в строку подключения и укажите в нем универсальный код ресурса (URI) прокси-сервера. В качестве примера приведена строка подключения, которая указывает эмулятор хранения и задает прокси-сервер HTTP:

    UseDevelopmentStorage=true;DevelopmentStorageProxyUri=http://myProxyUri

##Подключение к учетной записи хранения в Azure

Строку подключения к учетной записи хранения в Azure можно задать любым из приведенных ниже способов:

- Предположить наличие конечных точек по умолчанию для служб хранилища. Это самый простой вариант создания строки подключения. Если используется этот формат строки подключения, необходимо 

- Указать явно заданные конечные точки служб хранилища. В этом случае можно создать более сложную строку подключения. Если используется этот формат строки, можно указать конечные точки службы хранилища, включающие в себя пользовательское доменное имя, или минимизировать доступность сведений для строки подключения общего доступа на основе подписанного URL-адреса.


> [AZURE.NOTE] Службы хранилища Azure поддерживают как протокол HTTP, так и протокол HTTPS, однако настоятельно рекомендуется использовать протокол HTTPS.

##Создание строки подключения с конечными точками по умолчанию

Чтобы создать строку подключения, которая будет обращаться к конечным точкам по умолчанию службы хранилища, используйте приведенный ниже формат. Укажите, следует ли подключиться к учетной записи хранения с помощью протокола HTTP или HTTPS, задайте вместо параметра myAccountName имя учетной записи хранения, а вместо параметра myAccountKey - свой ключ доступа к учетной записи:

    DefaultEndpointsProtocol=[http|https];AccountName=myAccountName;AccountKey=myAccountKey

Созданная строка подключения должна выглядеть так, как строка из следующего примера:

    DefaultEndpointsProtocol=https;AccountName=storagesample;AccountKey=KWPLd0rpW2T0U7K2pVpF8rYr1BgYtR7wYQk33AYiXeUoquiaY6o0TWqduxmPHlqeCNZ3LU0DHptbeIHy5l/Yhg==

##Создание строки подключения с явно заданными конечными точками

Вам может понадобиться явно указать в строке подключения конечные точки службы по следующим причинам:

- Вы зарегистрировали собственное доменное имя для учетной записи хранения в службе BLOB-объектов.

- У вас есть подписанный URL-адрес для доступа к ресурсам хранилища.

###Указание конечной точки большого двоичного объекта с пользовательским доменным именем 
Если вы зарегистрировали собственное доменное имя для использования со службой BLOB-объектов, то можно явным образом указать в строке подключения конечную точку большого двоичного объекта. Значение конечной точки из строки подключения применяется для создания универсальных кодов ресурса (URI) к службе BLOB-объектов, а также определяет форму любых универсальных кодов ресурса (URI), возвращаемых в код. 

Чтобы создать строку подключения, определяющую явные конечные точки, укажите полную конечную точку для каждой службы, включая спецификацию протокола (HTTP или HTTPS), в следующем формате:

    BlobEndpoint=myBlobEndpoint;QueueEndpoint=myQueueEndpoint;TableEndpoint=myTableEndpoint;[credentials]

При явном указании конечных точек службы учетные данные можно указать двумя способами. Вы можете указать имя учетной записи и ключ (`AccountName=myAccountName;AccountKey=myAccountKey`), как описано в предыдущем разделе, или вы можете **указать подписанный URL-адрес**, как описано в разделе "Указание конечных точек с помощью подписанного URL-адреса". Если вы указываете имя учетной записи и ключ, то полностью строка будет выглядеть следующим образом:
    BlobEndpoint=myBlobEndpoint;QueueEndpoint=myQueueEndpoint;TableEndpoint=myTableEndpoint;AccountName=myAccountName;AccountKey=myAccountKey

В строке подключения можно указать конечные точки для большого двоичного объекта, таблицы и очереди. Вы должны указать хотя бы одну конечную точку, но не обязательно все три из них. Например, если вы создаете строку подключения для использования с пользовательской конечной точкой большого двоичного объекта, можно не указывать конечные точки для очереди и таблицы. Обратите внимание, что если вы решили не указывать в строке подключения конечные точки очередей и таблиц, вы не сможете получить доступ к службам очередей и таблиц из кода, используя эту строку подключения.

###Указание конечных точек с помощью подписанного URL-адреса 
Вы можете создать строку подключения с явно заданными конечными точками для доступа к ресурсам хранилища с помощью подписанного URL-адреса. В этом случае можно указать подписанный URL-адрес как часть строки подключения, а не как часть учетных данных имени и ключа учетной записи. Маркер подписанного URL-адреса инкапсулирует данные о запрашиваемом ресурсе, периоде, во время которого он доступен, и имеющихся разрешениях. Дополнительную информацию о подписанных URL-адресах см. в разделе [Делегирование доступа с использованием подписанного URL-адреса](https://msdn.microsoft.com/library/ee395415.aspx).

Чтобы создать строку подключения, содержащую подписанный URL-адрес, задайте ее в следующем формате:

    BlobEndpoint=myBlobEndpoint; QueueEndpoint=myQueueEndpoint;TableEndpoint=myTableEndpoint;SharedAccessSignature=base64Signature

Конечная точка может быть конечной точкой службы по умолчанию или пользовательской конечной точкой. Значение `base64Signature` соответствует подписи в подписанном URL-адресе. Подпись представляет собой код HMAC, рассчитанный по алгоритму SHA256 с использованием ключа и преобразования строки в символы. Полученное значение преобразуется в кодировку Base64.

<!--HONumber=47-->
