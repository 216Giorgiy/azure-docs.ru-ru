---
title: Как преобразовать для просмотра пользовательские данные на растровой карте в Azure Maps | Документация Майкрософт
description: Преобразование пользовательских данных для просмотра на растровой карте в Azure Maps.
author: walsehgal
ms.author: v-musehg
ms.date: 02/12/2019
ms.topic: conceptual
ms.service: azure-maps
services: azure-maps
manager: timlt
ms.custom: mvc
ms.openlocfilehash: 9b3c0f7b1ff56cb269f6852be8fd2affeca8b8f1
ms.sourcegitcommit: fec0e51a3af74b428d5cc23b6d0835ed0ac1e4d8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2019
ms.locfileid: "56119158"
---
# <a name="render-custom-data-on-raster-map"></a>Преобразование пользовательских данных для просмотра на растровой карте

В этой статье показано, как использовать [службу статического изображения](https://docs.microsoft.com/rest/api/maps/render/getmapimage) с функцией создания изображения для наложения на растровую карту. Создание изображения включает возможность возвращения элемента растра с дополнительными данными, такими как вешки, метки и геометрические наложения. Для подготовки к просмотру пользовательских вешек, меток и геометрии мы будем использовать приложение Postman. Откройте приложение Postman и в раскрывающемся списке "New" (Создать) щелкните "Create New" (Создать), выберите коллекцию или папку для сохранения и назовите ее, а потом щелкните "Сохранить".

Мы будем использовать [API службы данных](https://docs.microsoft.com/rest/api/maps/data) Azure Maps для хранения и преобразования для просмотра наложений. 


## <a name="prerequisites"></a>Предварительные требования

### <a name="create-an-azure-maps-account"></a>создание учетной записи службы "Карты Azure"; 

Для выполнения заданий из этого руководства сначала необходимо ознакомиться со статьей [Управление учетной записью и ключами службы Azure Maps](how-to-manage-account-keys.md), чтобы создать подписку учетной записи ценовой категории S1 и управлять ею.

## <a name="render-pushpins-with-labels-and-custom-image"></a>Визуализация вешек с метками и пользовательского образа

> [!Note]
> В этом примере требуется учетная запись Azure Maps с ценовой категорией S0 или S1. 

Учетная запись Azure Maps с номером SKU S0 поддерживает только один экземпляр параметра `pins`, позволяя пользователям преобразовать для просмотра 5 вешек, указанных в URL-запросе с пользовательским образом.

Чтобы преобразовать вешки с метками и пользовательским изображением, выполните следующие действия:

1. Откройте приложение Postman и в раскрывающемся списке "New" (Создать) щелкните "Create New" (Создать) и выберите "Request" (Запрос). Введите имя запроса, чтобы отобразить вешки, выберите коллекцию или папку, в которую нужно их сохранить, и щелкните "Сохранить".
    
    ![Отправка данных о геозоне с помощью Postman](./media/tutorial-geofence/postman-new.png)

2. Выберите метод GET HTTP на вкладке конструктора и введите следующий URL-адрес для выполнения запроса GET.

    ```HTTP
    https://atlas.microsoft.com/map/static/png?subscription-key={subscription-key}&api-version=1.0&layer=basic&style=main&zoom=12&center=-73.98,%2040.77&pins=custom%7Cla15+50%7Cls12%7Clc003b61%7C%7C%27CentralPark%27-73.9657974+40.781971%7C%7Chttp%3A%2F%2Fazuremapscodesamples.azurewebsites.net%2FCommon%2Fimages%2Fpushpins%2Fylw-pushpin.png
    ```
    Ниже приведен получаемый образ ответа.

    ![визуализация пользовательских вешек с метками](./media/how-to-render-custom-data/render-pins.png)


## <a name="get-data-from-azure-maps-data-storage"></a>Получение данных из хранилища данных Azure Maps

> [!Note]
> В этом примере требуется учетная запись Azure Maps с ценовой категорией S1.

Информацию про путь и расположение кнопок можно также получить с помощью [API отправки данных](https://docs.microsoft.com/rest/api/maps/mapdata/upload). Выполните следующие действия, чтобы отправить данные пути и кнопок.

1. В приложении Postman откройте новую вкладку в ранее созданной коллекции. Выберите метод POST HTTP на вкладке конструктора и введите следующий URL-адрес для выполнения запроса POST.

    ```HTTP
    https://atlas.microsoft.com/mapData/upload?subscription-key={subscription-key}&api-version=1.0&dataFormat=geojson
    ```

2. Щелкните "Params" (Параметры) и введите следующие пары "ключ — значение" для URL-адреса запроса POST. Замените значение ключа подписки своим ключом подписки на Azure Maps.
    
    ![Пары "ключ — значение" на вкладке параметров приложения Postman](./media/how-to-render-custom-data/postman-key-vals.png)

3. Перейдите на вкладку **Body** (Текст) и выберите необработанный формат входных данных, а затем в раскрывающемся списке — JSON в качестве формата входных данных. Введите следующие данные для отправки в формате JSON:
    
    ```JSON
    {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {},
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  -73.98235,
                  40.76799
                ],
                [
                  -73.95785,
                  40.80044
                ],
                [
                  -73.94928,
                  40.7968
                ],
                [
                  -73.97317,
                  40.76437
                ],
                [
                  -73.98235,
                  40.76799
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [
                -73.97624731063843,
                40.76560773817073
              ],
              [
                -73.97914409637451,
                40.766826609362575
              ],
              [
                -73.98513078689575,
                40.7585866048861
              ]
            ]
          }
        }
      ]
    }
    ```

4. Отправьте данные и проверьте заголовок ответа. Заголовок со сведениями о расположении будет содержать URI для доступа к данным или их отправки впоследствии. Он также будет включать уникальное значение `udId` для отправленных данных.   

  ```HTTP
  https://atlas.microsoft.com/mapData/{udId}/status?api-version=1.0&subscription-key={Subscription-key}
  ```



5. Используйте значение `udid`, полученное из API отправки данных для преобразования компонентов на карте. Для этого откройте новую вкладку в ранее созданной коллекции. Выберите метод GET HTTP на вкладке конструктора и введите следующий URL-адрес для выполнения запроса GET.

    ```HTTP
    https://atlas.microsoft.com/map/static/png?subscription-key={subscription-key}&api-version=1.0&layer=basic&style=main&zoom=12&center=-73.96682739257812%2C40.78119135317995&pins=default|la-35+50|ls12|lc003C62|co9B2F15||'Times Square'-73.98516297340393 40.758781646381024|'Central Park'-73.96682739257812 40.78119135317995&path=lc0000FF|fc0000FF|lw3|la0.80|fa0.30||udid-{udId}
    ```

6. Полученное в ответ изображение должно выглядеть следующим образом.

    ![преобразование отправленных данных](./media/how-to-render-custom-data/uploaded-path.png)

## <a name="render-polygon-with-color-and-opacity"></a>Преобразование многоугольника для просмотра с использованием функций цвета и прозрачности

> [!Note]
> В этом примере требуется учетная запись Azure Maps с ценовой категорией S1.

Вы можете изменить внешний вид многоугольника с помощью модификаторов стиля с [параметром пути](https://docs.microsoft.com/rest-staging/api/maps/render/getmapimage#uri-parameters).

1. В приложении Postman откройте новую вкладку в ранее созданной коллекции. Выберите метод GET HTTP на вкладке конструктора и введите следующий URL-адрес для выполнения запроса GET для преобразования многоугольника для просмотра с использованием функций цвета и прозрачности.
    
    ```HTTP
    https://atlas.microsoft.com/map/static/png?api-version=1.0&style=main&layer=basic&sku=S1&zoom=14&height=500&Width=500&center=-74.040701, 40.698666&path=lc0000FF|fc0000FF|lw3|la0.80|fa0.50||-74.03995513916016 40.70090237454063|-74.04082417488098 40.70028420372218|-74.04113531112671 40.70049568385827|-74.04298067092896 40.69899904076542|-74.04271245002747 40.69879568992435|-74.04367804527283 40.6980961582905|-74.04364585876465 40.698055487620714|-74.04368877410889 40.698022951066996|-74.04168248176573 40.696444909137|-74.03901100158691 40.69837271818651|-74.03824925422668 40.69837271818651|-74.03809905052185 40.69903971085914|-74.03771281242369 40.699340668780984|-74.03940796852112 40.70058515602143|-74.03948307037354 40.70052821920425|-74.03995513916016 40.70090237454063
    &subscription-key={subscription--key}
    ```

Полученное в ответ изображение должно выглядеть следующим образом.

![преобразование непрозрачного многоугольника](./media/how-to-render-custom-data/opaque-polygon.png)


## <a name="render-polygon-with-circle-and-push-pins-with-custom-labels"></a>Преобразование многоугольника для просмотра с помощью круговых кнопок и вешек с пользовательскими метками

> [!Note]
> В этом примере требуется учетная запись Azure Maps с ценовой категорией S1.

Вы можете увеличивать или уменьшать вешки и их метки с помощью модификатора стиля для масштабирования "sc". Это значение больше нуля. Значение 1 — это стандартный масштаб. Значения, превышающие 1, будут увеличивать кнопки, а меньше 1 будут их уменьшать. Дополнительные сведения о модификаторах стиля см. в разделе о [параметрах пути службы статического изображения](https://docs.microsoft.com/rest/api/maps/render/getmapimage#uri-parameters).

Следуйте шагам ниже, чтобы преобразовать многоугольник для просмотра с помощью круговых кнопок и вешек с пользовательскими метками.

1. В приложении Postman откройте новую вкладку в ранее созданной коллекции. Выберите метод GET HTTP на вкладке конструктора и введите следующий URL-адрес для выполнения запроса GET.

    ```HTTP
    https://atlas.microsoft.com/map/static/png?api-version=1.0&style=main&layer=basic&zoom=14&height=700&Width=700&center=-122.13230609893799,47.64599069048016&path=lcFF0000|lw2|la0.60|ra1000||-122.13230609893799 47.64599069048016&pins=default|la15+50|al0.66|lc003C62|co002D62||'Microsoft Corporate Headquarters'-122.14131832122801  47.64690503939462|'Microsoft Visitor Center'-122.136828 47.642224|'Microsoft Conference Center'-122.12552547454833 47.642940335653996|'Microsoft The Commons'-122.13687658309935  47.64452336193245&subscription-key={subscription-key}
    ```

Полученное в ответ изображение должно выглядеть следующим образом.

![преобразование круга для просмотра с помощью пользовательских кнопок](./media/how-to-render-custom-data/circle-custom-pins.png)

## <a name="next-steps"></a>Дополнительная информация

* Ознакомьтесь с документацией по [API получения изображения карты в службе Azure Maps](https://docs.microsoft.com/rest/api/maps/search).
* Дополнительные сведения о возможностях службы данных Azure Maps см. в [документации службы](https://docs.microsoft.com/rest/api/maps/data).