<properties 
	pageTitle="Анализ оттока клиентов с помощью машинного обучения Microsoft | Azure" 
	description="Пример разработки интегрированной модели для анализа и оценки ухода клиентов" 
	services="machine-learning" 
	documentationCenter="" 
	authors="" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="08/06/2014" 
	ms.author="barga"/>

# Анализ оттока клиентов с помощью машинного обучения Microsoft Azure


В данном документе содержатся сведения об эталонной реализации проекта анализа оттока клиентов, созданного в среде Azure Machine Learning Studio, и о связанных моделях для решения проблем оборота промышленных клиентов. Здесь также измеряется точность моделей, построенных с использованием сервиса машинного обучения Azure Machine Learning, и оцениваются направления дальнейшего развития.  

##Проблема оттока клиентов
Компаниям на потребительском рынке и во всех сегментах корпоративного рынка приходится иметь дело с проблемой оттока клиентов. Иногда показатели оттока слишком велики и влияют на принятие политических решений. Традиционным решением является прогнозирование клиентов с высокой предрасположенностью к уходу и удовлетворение их потребностей за счет внедрения служб поддержки, проведения маркетинговых кампаний или путем применения специальных положений. В каждой отрасли могут существовать собственные подходы. Следует отметить, что они зависят даже от конкретной потребительской категории в рамках одного направления (например, в области телекоммуникаций). Все предприятия объединяет одно - необходимость минимизации особых усилий по удержанию клиентов. Таким образом, абсолютно естественным вариантом будет оценка каждого клиента на предмет склонности к оттоку и принятие соответствующих мер к самым важным из них. Крупные клиенты могут быть наиболее выгодными. В более сложных сценариях выбор кандидатов для предоставления специальных условий осуществляется на основе уровня их прибыльности. Однако эти аспекты являются лишь частью целостной стратегии по борьбе с оттоком. Компании также должны принимать во внимание риск (и связанную рискоустойчивость), уровень и стоимость вмешательства и обоснованную сегментацию клиентов.  

##Отраслевые перспективы и подходы
Сложные решения в процессе работы с оттоком клиентов являются признаком зрелой отрасли. Классическим примером является сфера телекоммуникаций, где абоненты, как известно, часто переходят от одного провайдера к другому. Такой добровольный отток является главной заботой компаний, предоставляющих услуги связи. Кроме того, поставщики накопили большой багаж знаний о *движущих силах оттока*, которые заставляют клиентов переключаться на продукты и услуги то одних, то других производителей. Например, на рынке мобильных телефонов хорошо известным фактором оттока является выбор нового устройства. В результате начинает действовать популярная политика, а именно субсидирование цен на телефоны для новых абонентов и взимание полной стоимости обновления с существующих клиентов. Исторически сложилось, что такая линия поведения политика способствует переходам клиентов от одного поставщика услуг к другому с целью получить новую скидку, что, в свою очередь, стимулирует последних на совершенствование стратегий. Высокий уровень подверженности резким колебаниям на рынке мобильных телефонов очень быстро сводит на нет модели оттока, связанные с использованием текущих моделей телефонов. Кроме того, мобильные телефоны - это не только телекоммуникационные устройства. Они выступают в роли модного аксессуара или тренда (вспомните iPhone). Эти социальные прогностические факторы находятся вне сферы действия стандартных наборов данных в области телекоммуникаций. Конечным результатом моделирования является невозможность разработки обоснованной политики только путем устранения известных причин оттока. Фактически, **необходимо** придерживаться непрерывной стратегии моделирования, включая классические модели количественной оценки категориальных переменных (например, дерево принятия решения).

Используя большие наборы данных, собранные о клиентах, организации анализируют большие объемы информации (в частности, для выявления причин оттока), реализуя, тем самым, эффективный подход к решению проблемы. Более подробные сведения о реализации подхода обработки больших объемов данных для устранения проблемы с оттоком клиентов см. в разделе рекомендаций по ETL-процессам.  

##Методика моделирования процесса оттока клиентов
Общий процесс решения проблем, связанных с оттоком клиентов, представлен на схемах 1-3.  

1.	Модель риска позволяет узнать, каким образом действия влияют на вероятность и риск.
2.	Модель вмешательства позволяет узнать, каким образом уровень вмешательства может повлиять на вероятность оттока и значение показателя ценности жизненного цикла клиента (CLV).
3.	Этот анализ способствует проведению качественного анализа, выходящего на уровень активной маркетинговой кампании, целью которой является предоставление клиентам оптимальных предложений.  

![][1]

Такой рассчитанный на перспективу подход остается оптимальным способом решения вопросов оттока. Однако его реализация связана с определенной сложностью: требуется разработать многомодельный архетип и отследить зависимости между моделями. Взаимодействие между моделями может выглядеть следующим образом.  

![][2]
 
*Рис. 4: Объединенный многомодельный архетип*  

Если речь идет о формировании целостного подхода к удержанию клиентов, ключевым моментом в его функционировании являются взаимодействия между различными моделями.  С течением времени рабочие характеристики каждой модели обязательно ухудшаются. Поэтому архитектура представляет собой неявный цикл (аналогично архетипу, заданному по стандарту интеллектуального анализа данных CRISP-DM [[***3***]]).  
 
Для общего цикла сегментации и декомпозиции "риск-решение-маркетинг" по-прежнему поддерживается обобщенная структура, которая применима ко многим бизнес-задачам. Мощным представителем этой группы проблем выступает анализ оттока, так как он обладает всеми характеристиками сложной бизнес-задачи, для выполнения которой не допускается действие упрощенного прогнозного решения. Несмотря на то, что социальные аспекты современного подхода к вопросу оттока клиентов на обозначены особым образом, они содержатся в смоделированном архетипе так, как если бы они входили в состав любой другой модели.  

Интересным дополнением является анализ больших объемов данных. Современные телекоммуникационные компании и предприятия розничной торговли собирают исчерпывающие данные о своих клиентах. Учитывая новые направления, такие как Интернет вещей и широкое распространение устройств, позволяющих работать с интеллектуальными решениями на разных уровнях, можно без труда предположить, что потребность многомодельного взаимодействия станет общей тенденцией.  

 
#Реализация архетипа моделирования в среде Microsoft Azure ML Studio 
Каким образом можно реализовать интегрированный подход моделирования и оценки, принимая во внимание только что описанную проблему? В этом разделе будет показано выполнение данной задачи с помощью среды Microsoft Azure Cloud ML Studio.  

Многомодельный подход является неотъемлемой частью процесса разработки глобального архетипа оттока. Многомодельность должна поддерживаться даже в оценочной (прогнозной) части подхода.  

На следующей схеме показан созданный прототип, в котором в среде Cloud ML Studio для прогнозирования оттока используется четыре различных алгоритма оценки. Причиной внедрения многомодельного подхода является не только необходимость создания классификатора множества для повышения уровня точности, но и обеспечение защиты от чрезмерно близкой подгонки, а также улучшение выбора функций директивного характера.  

![][3]
 
*Рис. 5: Прототип метода моделирования оттока*  

В следующих разделах содержатся более подробные сведения о прототипе модели оценки, реализованном с помощью среды Cloud ML Studio.  

##Выбор и подготовка данных
Данные, используемые для построения моделей и оценки клиентов, были получены из вертикального решения CRM. В целях обеспечения конфиденциальности клиентов их персональные данные были скрыты. В данные входят сведения о 8000 подписках в США и объединены три источника: данные о передаче (метаданные подписки), данные о деятельности (использование системы), а также данные о поддержке клиентов. Сюда не включена бизнес-информация, имеющая отношение к клиентам (например, метаданные о лояльности или оценка кредитоспособности).  

В целях упрощения в рамки проекта не входят процессы ETL и очистки данных, поскольку предполагается, что подготовка данных уже выполнена.   

Выбор функций для моделирования основан на предварительной оценке значимости множества прогностических факторов, включенных в процесс с помощью модуля алгоритма случайного леса. Для реализации в среде Cloud ML Studio было рассчитано среднее значение, медиана и диапазон для репрезентативных функций. Например, были добавлены совокупности для качественных данных, таких как минимальные и максимальные значения для пользовательской активности.    

Была собрана временная информация за последние 6 месяцев. Во внимание принимались только последние шесть месяцев, потому что в результате анализа данных за один год было установлено, что даже при наличии статистически значимых тенденций влияние на отток значительно уменьшается по истечении шести месяцев.  

И самый существенный момент: весь процесс, включая процедуры ETL (извлечения, преобразования и загрузки данных), выбор функций и моделирование, был реализован в среде Cloud ML Studio с использованием источников данных в Microsoft Azure.   

На следующей схеме показаны использовавшиеся данные.  

![][4]
 
*Рис. 6: Фрагмент источника данных (скрыт)*  

![][5]

 
*Рис. 7: Функции, извлеченные из источника данных*
 
##Алгоритмы, используемые в прототипе

Для создания прототипа (без настройки) использовались следующие четыре алгоритма машинного обучения.  

1.	Логистическая регрессия (LR).
2.	Увеличивающееся дерево решений (BT). 
3.	Усредненное восприятие (AP). 
4.	Метод опорных векторов (SVM).  


На следующей схеме показана часть экспериментальной поверхности разработки с последовательностью создания моделей.  

![][6]  

 
*Рис. 8: Создание моделей машинного обучения в среде Cloud ML Studio*  

##Методы количественной оценки
Для оценки четырех моделей использовался маркированный учебный набор данных.  

Оцениваемый набор данных также отправлялся в сопоставимую модель, созданную с помощью SAS Enterprise Miner 12 для настольных систем. Была измерена точность модели SAS и всех четырех моделей Azure Cloud ML.  

#Результат 
В этом разделе представлены выводы о точности моделей, сделанные на основе набора данных для количественной оценки.  

##Точность и презиционность оценки
Как правило, точность реализации в Azure Cloud ML отстает от аналогичного показателя в SAS примерно на 10-15% (AUC).  

Однако наиболее важным показателем оттока является коэффициент неправильной классификации: то есть, сколько из N основных склонных к оттоку клиентов, предсказанных классификатором, на самом деле **не** ушли, но, тем не менее, получили особое внимание.  На следующей схеме приводится сравнение коэффициента неправильной классификации для всех моделей.  

![][7]

 
*Рис. 9: Прототип Passau: площадь под кривой* 

###Использование AUC для сравнения результатов
Площадь под кривой (AUC) - это показатель, представляющий глобальную меру *разделимости* между распределениями оценок для положительных и отрицательных значений. Он похож на стандартный график зависимости чувствительности от частоты ложно-положительных заключений (ROC). Необходимо отменить одно важное отличие - для показателя AUC не требуется выбирать пороговое значение. Он суммирует результаты по **всем** возможным вариантам. При этом на стандартном графике ROC положительный показатель представлен на вертикальной оси, коэффициент ложноположительных срабатываний - на горизонтальной оси. На основании этих данных отображается меняющееся пороговое значение.   

AUC обычно используется в качестве меры ценности различных алгоритмов (или разных систем), поскольку позволяет сравнивать модели с помощью их значений AUC. Этот подход распространен в области метеорологии, биологических наук и многих других отраслях. Таким образом, AUC представляет собой популярный инструмент для оценки производительности классификатора.  

###Сравнение коэффициентов неправильной классификации
Мы сравнили коэффициенты неправильных классификаций в рассматриваемом наборе данных с помощью данных CRM из приблизительно 8000 подписок.  

-	Коэффициент неправильной классификации SAS - 10-15%.
-	Коэффициент неправильной классификации машинного обучения Azure для основных 200-300 клиентов, предрасположенных к уходу, составил 15-20%.  

В сфере телекоммуникаций очень важно уделять внимание только клиентам с самым высоким уровнем риска оттока. Для этого им предлагаются услуги поддержки или другие специальные режимы и условия. В этом отношении реализация сервиса Azure Cloud ML достигает таких же результатов, что и модель SAS.  

К тому же, точность гораздо важнее прецизионности, потому что наибольший интерес в данном случае вызывает правильность классификации потенциальных клиентов, предрасположенных к оттоку.  

На следующей схеме из Википедии это отношение представлено в яркой и простой для понимания форме.  

![][8]
 
*Рис. 10: Компромисс между точностью и прецизионностью*

###Результаты точности и прецизионности для модели увеличивающегося дерева  

В следующей таблице показаны необработанные результаты оценки с использованием прототипа сервиса Azure Cloud ML для модели двухклассового увеличивающегося дерева принятия решения, которая оказалась самой точной из четырех.  

![][9]

Рис. 11. Характеристики увеличивающегося дерева

##Сравнение производительности 
Было проведено сравнение скорости оценки данных с использованием моделей Azure Cloud ML и сопоставимой модели, созданной с помощью SAS Enterprise Miner 12.1 для настольных систем.  

В следующей таблице обобщаются результаты производительности алгоритмов.  

Таблица 1. Общая производительность (точность) алгоритмов 

**LR**|	**BT**|	**AP**|	**SVM**|
--|--|--|--|
Средняя модель|	Оптимальная модель|	Модель с показателями|	ниже среднего

Модели, размещенные в сервисе Azure Cloud ML, превзошли SAS на 15-25% по скорости исполнения, а уровень точности в целом был одинаковым.  

#Обсуждение и рекомендации
В телекоммуникационной отрасли существует несколько методик по анализу оттока.  

-	Получение показателей для четырех основных категорий:
	-	**Объект (например, подписка)**. Предоставление основной информации о подписке и (или) клиенте, являющегося предметом оттока.
	-	**Деятельность**. Получение всех возможных сведений об использовании, связанных с объектом. Например, количество входов и т. д.
	-	**Поддержка клиентов**. Сбор информаций из журналов поддержки клиентов для определения проблем с подпиской или обращений в службу поддержки клиентов. 
	-	**Конкурентные данные и бизнес-данные**. Получение любых сведений о клиенте (данные могут быть недоступными или трудно отслеживаемыми).
-	Использование значимости процесса выбора функций. Это означает, что модель увеличивающегося дерева или случайного леса всегда является перспективным подходом.  

Использование четырех приведенных выше категорий создает впечатление, что для определения клиентов, подверженных риску оттока, будет достаточно простого *детерминистского* подхода на основе индексов, сформированных на базе разумных факторов в каждой категории. К сожалению, несмотря на кажущуюся правдоподобность, это ложное понимание. Дело в том, что отток является временным эффектом, а факторам, способствующим оттоку, обычно присущи переходные состояния. Причины, по которым происходит отток клиентов сегодня, могут отличаться от завтрашних и, конечно, будут совершенно иными через шесть месяцев. Поэтому следует признать необходимость *вероятностной* модели.  
 
Это важное наблюдение часто упускается из виду в бизнесе, где, как правило, предпочтение отдается бизнес-аналитике, которую легче продать и проще автоматизировать.  

Тем не менее, аналитика с поддержкой самообслуживания на базе Azure Cloud ML обещает, что четыре категории информации, сгруппированные по подразделениям или отделам, станут ценным источником для машинного обучения в области оттока клиентов.  
 
Еще одним интересным преимуществом широкой реализации Azure Cloud ML является возможность добавления настраиваемого модуля в репозиторий уже имеющихся предопределенных модулей. Она, по сути, позволяет выбрать библиотеки и создавать шаблоны для вертикальных рынков. Благодаря ей сервис Azure Cloud ML занимает выгодную позицию на рынке специализированных решений.  

Надеемся, что эта тема будет рассмотрена в ближайшем будущем, особенно с точки зрения аналитики больших объемов данных.
  
#Заключение
В этой статье описывается разумный подход к решению распространенной проблемы, связанной с оттоком клиентов, на основе единой схемы. Мы рассмотрели прототип для моделей количественной оценки и реализовали его помощью сервиса Microsoft Azure Cloud ML. Наконец, мы оценили точность и производительность решения прототипа на уровне сопоставимых алгоритмов в SAS.  

**Дополнительные сведения**  

Оказался ли этот документ полезным для Вас? Отправьте нам свои отзывы. Как бы вы оценили этот документ по шкале от 1 (плохо) до 5 (отлично)? Например:   

-	Ваша высокая оценка связана с приведенным в документе актуальными примерами, отличными скриншотами, четкостью изложения или с другой причиной? 
-	Вы дали низкую оценку из-за неподходящих примеров, нечетких скриншотов или непонятного описания?  

Ваши отзывы помогут нам повысить качество наших изданий.   

[Отправить отзыв](mailto:sqlfback@microsoft.com).
 
#Ссылки
[1]. Predictive analytics: beyond the predictions, W. McKnight, Information Management, июль-август 2011 г., стр.18-20.  

[2]. http://en.wikipedia.org/wiki/Accuracy_and_precision   
 
[3]. http://www.the-modeling-agency.com/crisp-dm.pdf   

[4]. Маркетинг в области больших объемов данных.  

[5]. http://www.amazon.com/Big-Data-Marketing-Customers-Effectively/dp/1118733894/ref=sr_1_12?ie=UTF8&qid=1387541531&sr=8-12&keywords=customer+churn
 
#Приложение

![][10]
 
*Рис. 12. Снимок экрана с представлением прототипа оттока*
  

[1]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-1.png
[2]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-2.png
[3]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-3.png
[4]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-4.png
[5]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-5.png
[6]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-6.png
[7]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-7.png
[8]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-8.png
[9]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-9.png
[10]: ./media/machine-learning-azure-ml-customer-churn-scenario/churn-10.png

<!--HONumber=46--> 
