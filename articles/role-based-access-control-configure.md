<properties title="Role Based Access Control in Azure Preview Portal" pageTitle="Управление доступом на основе ролей на предварительной версии портала Azure" description="Describes how role based access control works and how to set it up" metaKeywords="" services="multiple" solutions="" documentationCenter="" authors="justinha" videoId="" scriptId="" manager="terrylan" />

<tags ms.service="multiple" ms.devlang="dotnet" ms.topic="article" ms.tgt_pltfrm="Ibiza" ms.workload="infrastructure-services" ms.date="09/12/2014" ms.author="justinha;Justinha@microsoft.com" />

<!--This is a basic template that shows you how to use mark down to create a topic that includes a TOC, sections with subheadings, links to other azure.microsoft.com topics, links to other sites, bold text, italic text, numbered and bulleted lists, code snippets, and images. For fancier markdown, find a published topic and copy the markdown or HTML you want. For more details about using markdown, see http://sharepoint/sites/azurecontentguidance/wiki/Pages/Content%20Guidance%20Wiki%20Home.aspx.-->

<!--Properties section (above): this is required in all topics. Please fill it out!-->

<!--The next line, with one pound sign at the beginning, is the page title--> 
# Управление доступом на основе ролей на портале предварительной версии Azure 

<p> Мы добавили поддержку управления доступом на основе ролей (RBAC) на портале предварительной версии Azure, чтобы помочь организациям легко и в точности выполнить требования по управлению доступом. В <a href="http://go.microsoft.com/fwlink/?LinkId=511576" target="_blank">этой записи блога</a> вы найдете краткую вводную информацию, которая поможет вам приступить к использованию этой функции. В данном разделе приведены подробные сведения о ней и описаны дополнительные варианты использования. 

<!--Table of contents for topic, the words in brackets must match the heading wording exactly-->

##Оглавление ##

* [Управление доступом на основе ролей в Azure](#whatisrbac) 
* [Сосуществование управления доступом на основе ролей и соадминистраторов подписки](#coexist)
* [Предоставление прав на управление и операции с данными](#authmgmt)
* [Предоставление и запрет доступа](#addremoveaccess)
* [Известные проблемы при использовании управления доступом на основе ролей](#knownissues)
* [Предоставление отзыва](#feedback)
* [Дальнейшие действия](#next)

<h2><a id="whatisrbac"></a>Управление доступом на основе ролей в Azure</h2>
                                                                   
Каждая подписка Azure связана с Azure Active Directory. Пользователи и службы, получающие доступ к подписке с помощью портала управления Azure или API диспетчера ресурсов Azure, сначала должны пройти проверку в Azure Active Directory.

![][1] 

	Функция управления доступом на основе ролей для Azure позволяет раздавать права доступа для пользователей Azure AD, групп и служб, назначая им роли в подписке или ресурсной группе, или на уровне индивидуальных ресурсов. Назначенная роль определяет уровень доступа пользователя, группы или службы к ресурсу Azure. 

### Роль

Роль - это набор действий, которые можно выполнить над ресурсами Azure. Пользователю или службе разрешается выполнить действие над ресурсом Azure, если ему/ей назначена роль, содержащая такое действие.

#### Встроенные роли

В первой предварительной версии управления доступом на основе ролей в Azure предусмотрены три встроенные роли, которые можно назначать пользователям, группам и службам.

+ **Владелец**: имеет полный контроль над ресурсами Azure. Владелец может выполнять любые операции управления ресурсом, включая управление доступом. 
+ **Участник**: может выполнять любые операции управления, кроме управления доступом. Следовательно, участник не может предоставлять доступ другим пользователям.
+ **Читатель**: может только просматривать ресурсы. Читатель не сможет просматривать секреты, связанные с ресурсом. 

Изменить определение встроенных ролей нельзя. В выходящей скоро версии Azure RBAC вы сможете определять пользовательские роли, создавая наборы действий из списка доступных действий, выполняемых над ресурсами Azure.

#### Разрешенные и запрещенные действия

Свойство **action** в определении роли указывает, какие действия можно выполнять над ресурсами Azure. В строках действий можно использовать подстановочные знаки. Свойство **Not actions** (Запрещенные действия) определения роли указывает на действия, которые должны быть исключены из списка разрешенных. 

**Встроенная роль**  | Действия  | Не действия	
------------- | -------------  | ------------
Владелец (разрешить все действия)  | *  | 
Участник (разрешить все, кроме записи и удаления назначения ролей)  | *  | Microsoft.Authorization/ * /запись, Microsoft.Authorization/ * /Удаление
Читатель (разрешить все действия по чтению)  | */Чтение  | 

### Назначение роли

Доступ предоставляется пользователям Azure AD и службам, назначая им соответствующие роли на ресурсе Azure. 

#### Субъекты безопасности Azure AD

Роли можно назначать субъектам безопасности Azure AD описанных ниже типов.

+ **Пользователи**: роли можно назначать пользователям организации, включенным в каталог Azure AD, с которым связана подписка Azure. Роли можно также назначать пользователям внешних учетных записей Майкрософт (например, joe@outlook.com), используя действие "Пригласить" для назначения пользователя на роль на портале предварительной версии Azure. При этом в Azure AD для такого пользователя создается учетная запись гостя. Если эта гостевая учетная запись отключена в каталоге, то внешний пользователь не сможет реализовать свое право на доступ к какому-либо из ресурсов Azure.
+ **Группы**: роли можно назначать группам безопасности Azure AD. Пользователю автоматически предоставляется доступ к ресурсу, когда он становится членом группы, у которой есть доступ к этому ресурсу. Аналогично после удаления из группы пользователь автоматически теряет доступ к ресурсу. Управлять доступом рекомендуется путем назначения ролей группам и добавления пользователей в эти группы, а не путем назначения ролей отдельным пользователям. Управление доступом на основе ролей для Azure RBAC не позволяет назначать роли для списков распределения.
Способность назначать роли группам позволяет организации расширять ее существующую модель контроля доступа от своего локального каталога к облаку, и группы прав доступа, уже настроенные для управления доступом к локальным ресурсам, могут быть использованы и для контроля доступа к ресурсам на портале предварительной версии Azure. Дополнительные сведения о различных вариантах синхронизации пользователей и групп из локального каталога см. в статье [Общие сведения об интеграции каталогов](http://technet.microsoft.com/library/jj573653.aspx). Azure AD Premium также предлагает [возможность делегированного управления группами](http://msdn.microsoft.com/library/azure/dn641267.aspx), позволяющую делегировать возможность создания групп и управления ими пользователям из Azure AD, не имеющим прав администратора.
+ **Субъекты-службы**: удостоверения служб представлены в каталоге как субъекты-службы. Они проходят проверку подлинности в Azure AD и безопасно взаимодействуют друг с другом. Службе можно предоставить доступ к ресурсам Azure путем назначения ролей субъекту-службе Azure AD, представляющему данную службу, с помощью модуля Azure для Windows PowerShell. 

#### Область ресурсов

Доступ не обязательно предоставляется для всей подписки. Роли также можно назначать для отдельных ресурсов или их групп. В RBAC Azure дочерний ресурс наследует назначения ролей от родительского. По этой причине, если пользователю, группе или службе предоставлен доступ только к определенной группе ресурсов в подписке, то доступ будет разрешен только к ней и входящим в нее ресурсам, но не к другим группам ресурсов в подписке. Кроме этого, в роль читателя для группы ресурсов можно добавить группу прав доступа.

![][2]

<h2><a id="coexist"></a>Сосуществование управления доступом на основе ролей и соадминистраторов подписки</h2>

Администратор и соадминистраторы подписки будут по-прежнему иметь полный доступ к порталам и API управления Azure. В модели RBAC им назначается роль владельца на уровне подписки.  
При этом новая модель RBAC поддерживается только порталом предварительной версии Azure и API диспетчера ресурсов Azure. Пользователи и службы, которым назначены роли RBAC, не могут получать доступ к порталу управления Azure и интерфейсам API управления службами Azure. Добавление пользователя к роли владельца подписки в портале предварительной версии Azure не делает этого пользователя соадминистратором подписки в портале полной версии Azure.

Если нужно дать пользователю доступ к ресурсу Azure, недоступному для управления через портал предварительной версии Azure, то этого пользователя надо добавить в соадминистраторы подписки, используя портал полной версии Azure. Service Bus и облачные службы - примеры ресурсов, которыми сейчас нельзя управлять с использованием RBAC.

<h2><a id="authmgmt"></a>Предоставление прав на управление и операции с данными</h2>

Управление доступом на основе ролей поддерживается только для операций управления ресурсами Azure на портале предварительной версии Azure и API диспетчера ресурсов Azure. С помощью RBAC можно разрешить доступ не ко всем операциям на уровне данных для ресурсов Azure. Например, с помощью RBAC можно управлять разрешениями на создание, чтение, обновление и удаление учетных записей хранения. Однако на сегодняшний день невозможно применять RBAC для управления разрешениями на создание, чтение, обновление и удаление BLOB-объектов или таблиц в учетной записи хранения. Аналогичным образом, созданием, чтением, обновлением и удалением базы данных SQL DB можно управлять с помощью RBAC, но созданием, чтением, обновлением и удалением таблиц SQL в базе данных управлять через RBAC пока еще нельзя.

<h2><a id="addremoveaccess"></a>Предоставление и запрет доступа</h2>

Рассмотрим пример того, как владелец ресурса в организации может управлять доступом. В этом сценарии имеется множество сотрудников, занятых в различных тестовых и рабочих проектах, которые выполняются с помощью ресурсов Azure. Вы намереваетесь следовать рекомендуемым правилам управления доступом. Пользователи должны иметь доступ ко всем необходимым им ресурсам, но доступ к остальным ресурсам должен быть закрыт. Вы хотите воспользоваться всеми процессами и средствами, в которые уже были сделаны инвестиции, и применить группы безопасности, настроенные в локальной службе каталогов Active Directory. В этих разделах рассмотрена настройка доступа к ресурсам:

* [Предоставление доступа](#add)
* [Запрет доступа](#remove)
* [Предоставление или запрет доступа для внешнего пользователя](#addremoveext)

<h3><a id="add"></a>Предоставление доступа</h2>

В таблице ниже перечислены требуемые права доступа и указаны способы их настройки в Azure.

Пользователь/группа  | Требование доступа  | Роль и область для доступа	
------------- | -------------  | ------------
Вся команда Джилл Сантос  | Чтение всех ресурсов Azure  | Добавить группу AD, представляющую команду Джилл Сантос, в роль читателя для подписки Azure
Вся команда Джилл Сантос  | Создание и управление всеми ресурсами группы ресурсов Test | Добавить группу AD, представляющую команду Джилл Сантос, в роль участника для группы ресурсов Test
Брок | Создание и управление всеми ресурсами группы ресурсов Prod | Добавить Брока в роль участника для группы ресурсов Prod


Сначала добавим доступ для чтения для всех ресурсов подписки. Щелкните **Обзор > Все > Подписки**.

![][3] 

Щелкните *имя своей подписки* ** > Читатель > Добавить**. Выберите имя из списка пользователей и групп или введите имя группы Active Directory.

![][4]

Затем добавьте ту же самую команду в роль участника группы ресурсов Test. Щелкните группу ресурсов, чтобы открыть колонку с ее свойствами. В разделе **Роли** щелкните **Участник > Добавить** и введите имя команды.

![][5]

Чтобы добавить Брока в роль участника для группы ресурсов Prod, щелкните группу ресурсов, щелкните **Участник > Добавить** и введите имя Брока. 

![][6]

Назначение ролей можно также выполнять с помощью модуля Microsoft Azure для Windows PowerShell. Ниже показан пример добавления учетной записи Брока с использованием комнадлета New-AzureRoleAssignment вместо портала:

	PS C:\> New-AzureRoleAssignment -Mail brockh@contoso.com -RoleDefinitionName Contributor -ResourceGroupName ProdDB

Подробные сведения об использовании Windows PowerShell для добавления и удаления доступа см. в разделе [Управление доступом на основе ролей с помощью Windows PowerShell](http://azure.microsoft.com/ru-ru/documentation/articles/role-based-access-control-powershell/). 

<h3><a id="remove"></a>Запрет доступа</h2>

Назначения также можно с легкостью удалять. Допустим, нужно удалить пользователя по имени Брэд Адамс из роли читателя для группы ресурсов под названием TestDB. Откройте панель группы ресурсов, щелкните **Читатель > Брэд Адамс > Удалить**.

![][7]

В этом примере показано, как удалить Артема Кузнецова с помощью командлета Remove-AzureRoleAssignment:

	PS C:\> Remove-AzureRoleAssignment -Mail badams@contoso.com -RoleDefinitionName Reader -ResourceGroupName TestDB

<h3><a id="addremoveext"></a>Предоставление или запрет доступа для внешнего пользователя</h2>

На вкладке **Конфигурация** находятся параметры управления доступом для внешних пользователей. Эти параметры можно менять только в интерфейсе пользователя (методы Windows PowerShell или API для этого отсутствуют) на портале полной версии Azure глобальным администратором каталога. 
Чтобы открыть вкладку **Конфигурация** на портале полной версии Azure, щелкните **Active Directory** а затем имя каталога.

![][10]

Теперь можно изменить параметры контроля доступа для внешних пользователей. 

![][8]

По умолчанию гости не могут выводить список содержимого каталога, поэтому пользователи и группы в **Списке членов** им не видны. Они могут найти пользователя, введя его полный адрес электронной почты, а затем предоставить ему доступ. Набор стандартных ограничений для гостей таков:

- они не могут получить перечень пользователей и групп в каталоге;
- они могут просматривать ограниченные сведения о пользователе, если знают его адрес электронной почты;
- они могут просматривать ограниченные сведения о группе, если знают ее имя.

Способность гостей видеть ограниченные сведения о пользователе или группе позволяет им приглашать других пользователей и видеть сведения о пользователях, с которыми они сотрудничают.  

Воспроизведем процедуру добавления доступа для внешнего пользователя. Добавим внешнего пользователя в ту же роль читателя для группы ресурсов TestDB, чтобы он мог помогать в отладке ошибок. Откройте вкладку группы ресурсов, щелкните **Читатель > Добавить > Пригласить** и введите адрес электронной почти пользователя, которого нужно добавить. 

![][9]

При добавлении внешнего пользователя в каталоге создается гостевая учетная запись. Затем этого гостя можно добавить в группу или удалить из нее, а также добавить в отдельную роль и удалить из нее так же, как любого другого пользователя в каталоге. 

Гостя можно удалить из любой роли точно так же, как и любого пользователя. При удалении из роли для конкретного ресурса гость не будет удален из каталога. 
 
<h2><a id="knownissues"></a>Известные проблемы при использовании управления доступом на основе ролей</h2>

Если возникли проблемы при использовании функции управления доступом на основе ролей в предварительной версии, см. возможные варианты решения в разделе [Решение проблем управления доступом на основе ролей](http://azure.microsoft.com/ru-ru/documentation/articles/role-based-access-control-troubleshooting/).


<h2><a id="feedback"></a>Предоставление отзыва</h2>

Опробуйте Azure RBAC и отправьте нам [feedback](http://aka.ms/azurerbacfeedback). 


<h2><a id="next"></a>Дальнейшие действия</h2>

Дополнительные ресурсы для работы с управлением доступом на основе ролей: 

+ [Управление доступом на основе ролей с помощью Windows PowerShell](http://azure.microsoft.com/ru-ru/documentation/articles/role-based-access-control-powershell/)
+ [Управление доступом на основе ролей с помощью межплатформенного интерфейса командной строки](http://azure.microsoft.com/ru-ru/documentation/articles/role-based-access-control-xplat-cli/)
+ [Устранение неполадок при управлении доступом на основе ролей](http://azure.microsoft.com/ru-ru/documentation/articles/role-based-access-control-troubleshooting/)
+ [Azure Active Directory](http://msdn.microsoft.com/library/azure/jj673460.aspx)
+ [Azure Active Directory Premium и Basic](http://msdn.microsoft.com/ru-ru/library/azure/dn532272.aspx)
+ [Как подписки Azure связаны с Azure AD](http://msdn.microsoft.com/ru-ru/library/azure/dn629581.aspx)
+ Введение в управление группы самообслуживания для групп управления доступом см. в [Блоге команды Active Directory](http://blogs.technet.com/b/ad/archive/2014/02/24/more-preview-enhancements-for-windows-azure-ad-premium.aspx)



<!--Image references-->
[1]: ./media/role-based-access-control-configure/RBACSubAuthDir.png
[2]: ./media/role-based-access-control-configure/RBACAssignmentScopes.png
[3]: ./media/role-based-access-control-configure/RBACSubscriptionBlade.png
[4]: ./media/role-based-access-control-configure/RBACAddSubReader_NEW.png
[5]: ./media/role-based-access-control-configure/RBACAddRGContributor_NEW.png
[6]: ./media/role-based-access-control-configure/RBACAddProdContributor_NEW.png
[7]: ./media/role-based-access-control-configure/RBACRemoveRole.png
[8]: ./media/role-based-access-control-configure/RBACGuestAccessControls.png
[9]: ./media/role-based-access-control-configure/RBACInviteExtUser_NEW.png
[10]: ./media/role-based-access-control-configure/RBACDirConfigTab.png


